<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.328">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SGC-X - 14&nbsp; Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../analysis/SGC4B/1_sgc4B_introduction.html" rel="next">
<link href="../../analysis/SGC4A/3_sgc4A_description.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/modelling_ref.html" class="sidebar-item-text sidebar-link">Modelling Reference</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC2</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/3_sgc2_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_lab_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">(Lab) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">(Lab) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_ospan_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">(Online) Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/3_sgc4A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/4_sgc4A_hypotesting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">SGC4C</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/1_sgc4C_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/2_sgc4C_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">SGC5A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/1_sgc5A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/2_sgc5A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section"></a></li>
  <li><a href="#h1a-overall-task-accuracy" id="toc-h1a-overall-task-accuracy" class="nav-link" data-scroll-target="#h1a-overall-task-accuracy">H1A | OVERALL TASK ACCURACY</a>
  <ul class="collapse">
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#describe" id="toc-describe" class="nav-link" data-scroll-target="#describe">Describe</a></li>
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests">TESTS</a>
  <ul class="collapse">
  <li><a href="#aligned-ranks-transformation" id="toc-aligned-ranks-transformation" class="nav-link" data-scroll-target="#aligned-ranks-transformation">Aligned Ranks Transformation</a></li>
  <li><a href="#kruskal-wallis-test" id="toc-kruskal-wallis-test" class="nav-link" data-scroll-target="#kruskal-wallis-test">Kruskal Wallis Test</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  </ul></li>
  <li><a href="#mixed-logistic-regression" id="toc-mixed-logistic-regression" class="nav-link" data-scroll-target="#mixed-logistic-regression">MIXED LOGISTIC REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#describe-1" id="toc-describe-1" class="nav-link" data-scroll-target="#describe-1">Describe</a></li>
  <li><a href="#todo-inference" id="toc-todo-inference" class="nav-link" data-scroll-target="#todo-inference">TODO Inference</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo">TODO</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#h1a-overall-interpretation-state" id="toc-h1a-overall-interpretation-state" class="nav-link" data-scroll-target="#h1a-overall-interpretation-state">H1A | OVERALL INTERPRETATION STATE</a>
  <ul class="collapse">
  <li><a href="#setup-1" id="toc-setup-1" class="nav-link" data-scroll-target="#setup-1">Setup</a></li>
  <li><a href="#mixed-multinomial-regression" id="toc-mixed-multinomial-regression" class="nav-link" data-scroll-target="#mixed-multinomial-regression">MIXED MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#todo-fit-model-mblogit" id="toc-todo-fit-model-mblogit" class="nav-link" data-scroll-target="#todo-fit-model-mblogit">TODO Fit Model [mblogit]</a></li>
  <li><a href="#todo-inference-1" id="toc-todo-inference-1" class="nav-link" data-scroll-target="#todo-inference-1">TODO Inference</a></li>
  <li><a href="#fit-model-brms" id="toc-fit-model-brms" class="nav-link" data-scroll-target="#fit-model-brms">Fit Model [brms]</a></li>
  <li><a href="#todo-inference-2" id="toc-todo-inference-2" class="nav-link" data-scroll-target="#todo-inference-2">TODO Inference</a></li>
  <li><a href="#compare" id="toc-compare" class="nav-link" data-scroll-target="#compare">COMPARE</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#h1b-q1-accuracy" id="toc-h1b-q1-accuracy" class="nav-link" data-scroll-target="#h1b-q1-accuracy">H1B | Q1 ACCURACY</a>
  <ul class="collapse">
  <li><a href="#setup-2" id="toc-setup-2" class="nav-link" data-scroll-target="#setup-2">Setup</a></li>
  <li><a href="#describe-2" id="toc-describe-2" class="nav-link" data-scroll-target="#describe-2">Describe</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">LOGISTIC REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1">Fit Model</a></li>
  <li><a href="#describe-3" id="toc-describe-3" class="nav-link" data-scroll-target="#describe-3">Describe</a></li>
  <li><a href="#todo-inference-3" id="toc-todo-inference-3" class="nav-link" data-scroll-target="#todo-inference-3">TODO Inference</a></li>
  <li><a href="#visualize-2" id="toc-visualize-2" class="nav-link" data-scroll-target="#visualize-2">Visualize</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#h1b-q1-interpretation-state" id="toc-h1b-q1-interpretation-state" class="nav-link" data-scroll-target="#h1b-q1-interpretation-state">H1B | Q1 INTERPRETATION STATE</a>
  <ul class="collapse">
  <li><a href="#setup-3" id="toc-setup-3" class="nav-link" data-scroll-target="#setup-3">Setup</a></li>
  <li><a href="#describe-4" id="toc-describe-4" class="nav-link" data-scroll-target="#describe-4">Describe</a></li>
  <li><a href="#multinomial-regression" id="toc-multinomial-regression" class="nav-link" data-scroll-target="#multinomial-regression">MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model-2" id="toc-fit-model-2" class="nav-link" data-scroll-target="#fit-model-2">Fit Model</a></li>
  <li><a href="#describe-5" id="toc-describe-5" class="nav-link" data-scroll-target="#describe-5">Describe</a></li>
  <li><a href="#todo-inference-4" id="toc-todo-inference-4" class="nav-link" data-scroll-target="#todo-inference-4">TODO Inference</a></li>
  <li><a href="#visualize-3" id="toc-visualize-3" class="nav-link" data-scroll-target="#visualize-3">Visualize</a></li>
  <li><a href="#diagnostics-2" id="toc-diagnostics-2" class="nav-link" data-scroll-target="#diagnostics-2">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-SGC4A-hypotesting" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Study SGC4A | Hypothesis Testing</p>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<p><strong>TODO</strong></p>
<p><em>The purpose of this notebook is test the hypotheses that determined the designs of the SGC4A studies.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UTILITIES</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy model output</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#favstats</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(modelr)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># library(jtools)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pwr) #power analysis</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZATION</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr) #arrange plots</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cowplot) #arrange shift function plots</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcd) #mosaic plots</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcdExtra) #mosaic plots</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves) <span class="co"># plots. in half</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># violin plot stuffs</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with stats</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#latex tables for models!</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELLING</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ARTool) <span class="co">#nonparametric anova</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstatix) #helpful testing functions incl wilcoxon, etc</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#easystats model summary and vis</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qqplotr) #confint on qq plot</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gmodels) #contingency table and CHISQR</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic) #extract model equation</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pscl) #zeroinfl / hurdle models </span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects) #visualization log regr models</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">#MULTINOMIAL </span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression [not mixed] #no p values</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#frequentist mixed multinomial logistic regression [mblogit] #gives p values</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr) <span class="co">#executing stan</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#bayesian mixed multinomials [+ other bayesian reg models]</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_minimal()) </span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_clean</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Research Questions</strong></p>
<p><strong>Experimental Hypothesis</strong><br>
</p>
<p><strong>Null Hypothesis</strong><br>
</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #HACK WD FOR LOCAL RUNNING?</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>imac <span class="ot">=</span> <span class="st">"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(imac)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC4A/data/2-scored-data/sgc4a_scored_participants.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">task_percent =</span> DV_percent_NABS</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC4A/data/2-scored-data/sgc4a_scored_items.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span> (</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.factor</span>(q), </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.factor</span>(subject),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS TRI-LIKE</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state = recode_factor(score_SCALED, #for ordinal</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-1" = "orth-like",</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-0.5" = "unknown",</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0" = "unknown",</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0.5" = "tri-like",</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "1" = "tri-like"),</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS OTHER</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orthogonal"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"triangular"</span>),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">as.ordered</span>(state)) </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">#SEPARATE INTO PARTS 1 AND 2</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># sgc4a &lt;- df_subjects %&gt;% filter(condition %in% c(111,113)) %&gt;% droplevels()</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co"># sgc4b &lt;- df_subjects %&gt;% filter(condition %in% c(111,114,115)) %&gt;% filter(mode=="asynch") %&gt;% droplevels()</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co"># sgc4a_items &lt;- df_items %&gt;% filter( subject %in% sgc4a$subject) %&gt;% droplevels()</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># sgc4b_items &lt;- df_items %&gt;% filter( subject %in% sgc4b$subject) %&gt;% droplevels()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
</section>
<section id="h1a-overall-task-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="h1a-overall-task-accuracy">H1A | OVERALL TASK ACCURACY</h2>
<section id="setup" class="level4">
<h4 class="anchored" data-anchor-id="setup">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, accuracy, subject,q)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>df_s <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, task_percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe" class="level4">
<h4 class="anchored" data-anchor-id="describe">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Accuracy"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/DESC-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df_items <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>q) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accuracy by Question"</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Q6 and Q9 are non-discriminative"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/DESC-ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: FACETED HISTOGRAM</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_s <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(task_percent))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>task_percent,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_s) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gf_facet_grid(pretty_condition ~ pretty_mode) %&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_condition) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Overall Absolute Score (% Correct)"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/DESC-ACC-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct)"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span>task_percent, <span class="at">data =</span> df_s) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct)</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.154 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.184 </td>
   <td style="text-align:right;"> 0.324 </td>
   <td style="text-align:right;"> 480 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> pretty_condition </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Orth-Full </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.169 </td>
   <td style="text-align:right;"> 0.319 </td>
   <td style="text-align:right;"> 150 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Orth-Sparse </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.154 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.202 </td>
   <td style="text-align:right;"> 0.350 </td>
   <td style="text-align:right;"> 88 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Orth-Grid </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.101 </td>
   <td style="text-align:right;"> 0.233 </td>
   <td style="text-align:right;"> 98 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Tri-Sparse </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.538 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.245 </td>
   <td style="text-align:right;"> 0.355 </td>
   <td style="text-align:right;"> 144 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="tests" class="level4">
<h4 class="anchored" data-anchor-id="tests">TESTS</h4>
<section id="aligned-ranks-transformation" class="level5">
<h5 class="anchored" data-anchor-id="aligned-ranks-transformation">Aligned Ranks Transformation</h5>
<!-- https://rcompanion.org/handbook/F_16.html -->
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>m.art <span class="ot">=</span> <span class="fu">art</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m.art)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance of Aligned Rank Transformed Data

Table Type: Anova Table (Type III tests) 
Model: No Repeated Measures (lm)
Response: art(task_percent)

                   Df Df.res F value Pr(&gt;F)  
1 pretty_condition  3    476  2.9176   0.03 *
---
Signif. codes:   0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </code></pre>
</div>
</div>
</section>
<section id="kruskal-wallis-test" class="level5">
<h5 class="anchored" data-anchor-id="kruskal-wallis-test">Kruskal Wallis Test</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(k <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(df_s<span class="sc">$</span>task_percent <span class="sc">~</span> df_s<span class="sc">$</span>pretty_condition))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  df_s$task_percent by df_s$pretty_condition
Kruskal-Wallis chi-squared = 9, df = 3, p-value = 0.03</code></pre>
</div>
</div>
</section>
<section id="visualize" class="level5">
<h5 class="anchored" data-anchor-id="visualize">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> statsExpressions<span class="sc">::</span><span class="fu">oneway_anova</span>(<span class="at">data =</span> df_s, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> pretty_condition, <span class="at">y =</span> task_percent,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">alternative =</span> <span class="st">"less"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 15
  parameter1   parameter2  statistic df.error p.value method effectsize estimate
  &lt;chr&gt;        &lt;chr&gt;           &lt;dbl&gt;    &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;
1 task_percent pretty_con…      8.65        3  0.0343 Krusk… Epsilon2 …   0.0181
# … with 7 more variables: conf.level &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;,
#   conf.method &lt;chr&gt;, conf.iterations &lt;int&gt;, n.obs &lt;int&gt;, expression &lt;list&gt;</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STATSPLOT | VIOLIN</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> task_percent, <span class="at">x =</span> pretty_condition, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df_s, <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/TEST-VIZ-ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="mixed-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="mixed-logistic-regression">MIXED LOGISTIC REGRESSION</h4>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.</em></p>
<section id="fit-model" class="level5">
<h5 class="anchored" data-anchor-id="fit-model">Fit Model</h5>
<p>TODO model with item as random doesn’t converge unless use bobyqa optimizer. ::: {.cell}</p>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SETUP</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm 13 items [all discriminating items]</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_i) <span class="sc">/</span> <span class="fu">nrow</span>(df_s) <span class="sc">==</span> <span class="dv">13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm all factors </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df_i<span class="sc">$</span>q) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>subject) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>pretty_condition) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>accuracy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Empty fixed model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Empty fixed model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df_i) </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject intercept random model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject intercept random model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.rS)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name  |    Model | df | df_diff |    Chi2 |      p
--------------------------------------------------
m0    |      glm |  1 |         |         |       
mm.rS | glmerMod |  2 |       1 | 3019.81 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + ITEM</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject Intercept + Item intercept random model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject Intercept + Item intercept random model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>, <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="fl">2e5</span>)))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.rSQ)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS, mm.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical and probably only vary in
  their random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |   Chi2 |      p
--------------------------------------------------
mm.rS  | glmerMod |  2 |         |        |       
mm.rSQ | glmerMod |  3 |       1 | 282.10 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS, mm.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical and probably only vary in
  their random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  2.61584550644328e-63"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT CONDITION</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Item random intercepts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FIXED Condition + Subject &amp; Item random intercepts"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> binomial,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>, <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="fl">2e5</span>)))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.CrSQ)</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model FALSE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name    |    Model | df | df_diff | Chi2 |     p
------------------------------------------------
mm.rSQ  | glmerMod |  3 |         |      |      
mm.CrSQ | glmerMod |  6 |       3 | 2.55 | 0.466</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.466121170373078"</code></pre>
</div>
<p>:::</p>
</section>
<section id="describe-1" class="level5">
<h5 class="anchored" data-anchor-id="describe-1">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.CrSQ</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition + (1 | subject) + (1 | q)
   Data: df_i
Control: glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 200000))

     AIC      BIC   logLik deviance df.resid 
    2662     2702    -1325     2650     6234 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-10.213  -0.032  -0.010  -0.004   8.369 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 88.403   9.402   
 q       (Intercept)  0.658   0.811   
Number of obs: 6240, groups:  subject, 480; q, 13

Fixed effects:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -10.212      0.671  -15.22   &lt;2e-16 ***
pretty_conditionOrth-Sparse    0.440      0.814    0.54     0.59    
pretty_conditionTri-Sparse     0.914      0.749    1.22     0.22    
pretty_conditionOrth-Grid     -0.311      0.780   -0.40     0.69    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) pr_O-S pr_T-S
prtty_cnO-S -0.400              
prtty_cnT-S -0.375  0.391       
prtty_cnO-G -0.466  0.367  0.395</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFICANCE TEST [non directional]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGNIFICANCE TEST [non directional]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: accuracy
                 Chisq Df Pr(&gt;Chisq)
pretty_condition  2.51  3       0.47</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: MANUAL ONE-SIDED SIGTEST </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#note: anova and chi square are always one-tailed, but that is independent of being one-sided</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tt &lt;- 2*pnorm(summary(m)$coefficients[2,3], lower.tail = F)</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("p value for two-tailed test, null B = 0 : ",round(tt,5))</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ot &lt;- pnorm(summary(m)$coefficients[2,3], lower.tail = F)</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("BUT we want a one  directional, null: B &lt;= 0: ",round(ot,5))</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO POSTHOCS</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># table of estimates with 95% CI</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("LOG ODDS")</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m), </span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se, </span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("ODDS RATIOS")</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="todo-inference" class="level5">
<h5 class="anchored" data-anchor-id="todo-inference">TODO Inference</h5>
<p><strong>TODO REDO UPDATE THIS</strong></p>
<p>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects and items; to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(4): 11.02, p &lt; 0.001); and the total explanatory power is substantial (conditional R2 = 0.82) and the part related to the fixed effects (marginal R2) is 0.02. Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 2.8 over the control condition <span class="math inline">\(e^{\beta_1}\)</span> = 2.80, 95% CI [1.54, 5.09], p &lt; 0.001.</p>
</section>
<section id="visualize-1" class="level5">
<h5 class="anchored" data-anchor-id="visualize-1">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.95</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Estimate | Odds Ratio"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="co">#why no error bars? problem with model?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-ACC-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-ACC-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'y' is already present. Adding another scale for 'y', which will
replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-ACC-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DIAGNOSTICS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DIAGNOSTICS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="todo" class="level5">
<h5 class="anchored" data-anchor-id="todo">TODO</h5>
<p>Model with random intercept of Question doesn’t want to converge unless I use the optimizer, which also throws warnings. Maybe jsut use random subject? (hint… yes…) Otherwise, try the bayesian version ##### BAYESIAN For some reason there are convergence difficulties. Try again with the brms version</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.integer</span>(accuracy)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO bernoulli or binomial?</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>B.mm.acc.CrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q),</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># family = "binomial",</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4A/models/sgc4a_brms_B.mm.acc.CrSQ.rds"</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(B.mm.acc.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: as.integer(accuracy) ~ pretty_condition + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 6240) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~q (Number of levels: 13) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.11      0.04     0.05     0.19 1.00     1659     1997

~subject (Number of levels: 480) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.70      0.04     0.63     0.77 1.00     1561     2218

Population-Level Effects: 
                            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                       0.40      0.07     0.26     0.54 1.00     1192
pretty_conditionOrthMSparse     0.09      0.10    -0.11     0.29 1.00     1097
pretty_conditionTriMSparse      0.18      0.09     0.00     0.37 1.00     1070
pretty_conditionOrthMGrid      -0.17      0.10    -0.36     0.02 1.00     1246
                            Tail_ESS
Intercept                       1824
pretty_conditionOrthMSparse     2165
pretty_conditionTriMSparse      1844
pretty_conditionOrthMGrid       1992

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(B.mm.acc.CrSQ, <span class="at">show.values =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">pd</span>(B.mm.acc.CrSQ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(equivalence_test(B.mm.acc.CrSQ))</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(B.mm.acc.CrSQ, <span class="at">type =</span> <span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using the maximum response value as the number of trials.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using 'binomial' families without specifying 'trials' on the left-hand
side of the model formula is deprecated.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in max(out$Y, na.rm = TRUE): no non-missing arguments to max; returning
-Inf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="h1a-overall-interpretation-state" class="level2">
<h2 class="anchored" data-anchor-id="h1a-overall-interpretation-state">H1A | OVERALL INTERPRETATION STATE</h2>
<ul>
<li><p><strong>“orthogonal”</strong> [reference category] includes orthogonal and satisficing responses ==&gt; indicates a primarily <em>orthogonal</em> state of coordinate system understanding</p></li>
<li><p><strong>“other”</strong> includes: blank, reference point, responses that can’t be classified (including selecting all datapoints), =&gt; indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly <em>not</em> orthogonal nor triangular</p></li>
<li><p><strong>“angular”</strong> includes ‘lines connecting’ responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
<li><p><strong>“triangular”</strong> includes correct triangular and ‘lines connecting’ responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="header">
<th>Research Question</th>
<th>Does Ss in the impasse condition produce less orthogonal responses across questions?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the IMPASSE condition will have a higher likelihood of producing unknown and triangle-like response states across all items</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td><ul>
<li>data: <code>df_items</code> where <code>q nin 6,9</code> (13 discriminant test phase items)</li>
<li>outcome: <code>state</code> ( 3 level factor from high_interpretation )</li>
<li>predictor: <code>condition</code> [between-subjects factor]</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>MIXED Multinomial (Logistic) Regression on state predicted by condition</li>
</ol>
<p>Alternative:</p>
<ul>
<li>MIXED Ordinal regression on state (doesn’t meet proportional odds assumption-I think)</li>
<li>MIXED Multinomial or Ordinal regression on high_interpretation (some cells are 0, produces problems)</li>
</ul></td>
</tr>
</tbody>
</table>
<section id="setup-1" class="level4">
<h4 class="anchored" data-anchor-id="setup-1">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,subject,state,pretty_condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation across all Questions"</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>q) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation by Question"</span>,</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             Orth-Full Orth-Sparse Tri-Sparse Orth-Grid    Sum
  orthogonal    0.6728      0.6442     0.5743    0.7017 0.6439
  other         0.1215      0.1241     0.1357    0.1664 0.1354
  tri-like      0.0210      0.0210     0.0342    0.0235 0.0255
  triangular    0.1846      0.2107     0.2559    0.1083 0.1952
  Sum           1.0000      1.0000     1.0000    1.0000 1.0000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             Orth-Full Orth-Sparse Tri-Sparse Orth-Grid  Sum
  orthogonal      1312         737       1075       894 4018
  other            237         142        254       212  845
  tri-like          41          24         64        30  159
  triangular       360         241        479       138 1218
  Sum             1950        1144       1872      1274 6240</code></pre>
</div>
</div>
</section>
<section id="mixed-multinomial-regression" class="level4">
<h4 class="anchored" data-anchor-id="mixed-multinomial-regression">MIXED MULTINOMIAL REGRESSION</h4>
<p><em>Does condition affect the response state of of items across the task?</em></p>
<section id="todo-fit-model-mblogit" class="level5">
<h5 class="anchored" data-anchor-id="todo-fit-model-mblogit">TODO Fit Model [mblogit]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TRY AGAIN... MAYBE HUNG? </span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #"baseline category logit" model matches multinom()</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #check reference level </span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Categories (first is reference)")</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co"># levels(df_i$state)</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIT EMPTY MODEL</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # print("EMPTY MODEL")</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co"># m.mbl0 &lt;- mblogit(state ~ pretty_condition ,  #no random intercepts; fixed only model </span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   data = df_i)</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co"># #summary(m.mbl0)</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIT PREDICTOR MODEL</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="co"># # print("PREDICTOR MODEL")</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="co"># m.mbl1 &lt;- mblogit(state ~ pretty_condition , </span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                   random = list( ~ 1|subject, ~1|q), </span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                   data = df_i)</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # summary(m.mbl1)</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="co"># #COMPARE MODEL FIT</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("AIC wth predictor is lower than empty model?", AIC(m.mbl0) &gt; AIC(m.mbl1))</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a><span class="co"># test_lrt(m.mbl0, m.mbl1)</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="co"># #DESCRIBE MODEL</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m.mbl1)</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a><span class="co"># #INTERPRET COEFFICIENTS</span></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a><span class="co"># cint &lt;- confint(m.mbl1, level = 0.95)</span></span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a><span class="co"># print("ODDS RATIO")</span></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m.mbl1)), exp(cint))) #exponentiated, adjusted</span></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a><span class="co"># #PERFORMANCE</span></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m.mbl1)</span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a><span class="co"># #TABLE</span></span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m.mbl1, transform = "exp", title = "Model Predicted Odds Ratio")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="todo-inference-1" class="level5">
<h5 class="anchored" data-anchor-id="todo-inference-1">TODO Inference</h5>
</section>
<section id="fit-model-brms" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-brms">Fit Model [brms]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #HACK WD FOR LOCAL RUNNING?</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>imac <span class="ot">=</span> <span class="st">"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(imac)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>mm.cat.CrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4A/models/sgc4a_brms_mixedcat_state.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set model </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.cat.CrSQ</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: categorical 
  Links: muother = logit; mutrilike = logit; mutriangular = logit 
Formula: state ~ pretty_condition + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 6994) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~q (Number of levels: 13) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muother_Intercept)          1.65      0.36     1.10     2.51 1.00      936
sd(mutrilike_Intercept)        2.41      0.70     1.40     4.15 1.00     1257
sd(mutriangular_Intercept)     1.64      0.41     1.07     2.58 1.01     1172
                           Tail_ESS
sd(muother_Intercept)          1638
sd(mutrilike_Intercept)        2219
sd(mutriangular_Intercept)     1716

~subject (Number of levels: 538) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muother_Intercept)          1.83      0.10     1.63     2.03 1.00     1373
sd(mutrilike_Intercept)        2.99      0.29     2.46     3.61 1.00     1085
sd(mutriangular_Intercept)     5.27      0.32     4.65     5.92 1.00      928
                           Tail_ESS
sd(muother_Intercept)          2313
sd(mutrilike_Intercept)        2028
sd(mutriangular_Intercept)     1829

Population-Level Effects: 
                                         Estimate Est.Error l-95% CI u-95% CI
muother_Intercept                           -2.70      0.51    -3.72    -1.66
mutrilike_Intercept                         -6.71      0.91    -8.58    -4.97
mutriangular_Intercept                      -4.46      0.69    -5.85    -3.12
muother_pretty_conditionOrthMSparse          0.12      0.28    -0.44     0.67
muother_pretty_conditionOrthMGrid            0.48      0.26    -0.03     0.99
muother_pretty_conditionTriMSparse           0.69      0.27     0.17     1.22
mutrilike_pretty_conditionOrthMSparse        0.19      0.59    -0.97     1.32
mutrilike_pretty_conditionOrthMGrid          0.12      0.57    -1.04     1.22
mutrilike_pretty_conditionTriMSparse         1.49      0.53     0.48     2.53
mutriangular_pretty_conditionOrthMSparse     0.21      0.74    -1.20     1.67
mutriangular_pretty_conditionOrthMGrid      -1.43      0.77    -2.98     0.04
mutriangular_pretty_conditionTriMSparse      1.54      0.69     0.26     2.97
                                         Rhat Bulk_ESS Tail_ESS
muother_Intercept                        1.00      571     1157
mutrilike_Intercept                      1.01      735     1277
mutriangular_Intercept                   1.00      470     1017
muother_pretty_conditionOrthMSparse      1.00     1214     2044
muother_pretty_conditionOrthMGrid        1.00     1189     2075
muother_pretty_conditionTriMSparse       1.00     1237     1993
mutrilike_pretty_conditionOrthMSparse    1.00     1606     2707
mutrilike_pretty_conditionOrthMGrid      1.00     1531     2119
mutrilike_pretty_conditionTriMSparse     1.00     1426     2399
mutriangular_pretty_conditionOrthMSparse 1.01      440      764
mutriangular_pretty_conditionOrthMGrid   1.01      497      729
mutriangular_pretty_conditionTriMSparse  1.01      394      617

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red", </span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.1, #manually adjust to account for directional test</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.90 ) + #manually adjusted for directional test   </span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Model Estimate | Odds Ratio",</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "",</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition")</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-BRMS-STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- simulate_parameters(m)</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE)</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check posterior</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m, <span class="at">ndraws=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-BRMS-STATE-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0783</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4800 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-BRMS-STATE-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-BRMS-STATE-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-BRMS-STATE-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="eff",</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co"># #PLOT MODEL PREDICTION</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Note: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-BRMS-STATE-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="todo-inference-2" class="level5">
<h5 class="anchored" data-anchor-id="todo-inference-2">TODO Inference</h5>
</section>
<section id="compare" class="level5">
<h5 class="anchored" data-anchor-id="compare">COMPARE</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare_models(m.mbl1, mm.cat.CrSQ)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="h1b-q1-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="h1b-q1-accuracy">H1B | Q1 ACCURACY</h2>
<p>The graph comprehension task includes 15 questions completed in sequence. But the first question the reader encounters (Q1) is the most important, as it is their <em>first exposure</em> to the unconventional triangular coordinate system.</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 90%">
</colgroup>
<thead>
<tr class="header">
<th>Research Question</th>
<th>Does the frequency of correct (vs) incorrect responses on the first question differ by condition? [Is response accuracy independent of condition?]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the TRI condition will have a higher likelihood of correctly responding to the first question than those in the CONTROL condition</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td><ul>
<li>data: <code>df_items</code> where <code>q == 1</code></li>
<li>outcome: <em>accuracy</em> ( factor(incorrect/correct) from <code>score_niceABS</code> [absolute score]</li>
<li>predictor: <code>condition</code> [between-subjects factor]</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>Logistic Regression on <code>accuracy</code> predicted by <code>condition</code>
<ul>
<li>account for difference in odds of correct score by condition</li>
</ul></li>
</ol>
<p>Alternatives:</p>
<ul>
<li>Chi-Square test of independence on outcome <code>accuracy</code> by <code>condition</code></li>
</ul></td>
</tr>
<tr class="even">
<td><strong>Notes</strong></td>
<td><ul>
<li>CHIQ SQR is simplest method to examine independence of two categorical factors; LOGISTIC REGRESSION is recommended for binomial ~ continuous; though with regression we can quantify the size of the effect and overall model fit</li>
<li>independence assumption : (CHI SQR) as we only consider responses on the first question, each observation corresponds to an individual subject, and are thus independent</li>
<li>cell frequency : (CHI SQR) expected frequency in each cell of the contingency table is greater than 5 (more than 5 correct , more than 5 incorrect responses)</li>
</ul></td>
</tr>
</tbody>
</table>
<section id="setup-2" class="level4">
<h4 class="anchored" data-anchor-id="setup-2">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy, pretty_condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-2" class="level4">
<h4 class="anchored" data-anchor-id="describe-2">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Accuracy"</span>,</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: BARSTATS</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>( <span class="at">data =</span> df, <span class="at">y =</span> pretty_condition, <span class="at">x =</span> accuracy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-Q1ACC-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Proportions of Correct Responses by Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Proportions of Correct Responses by Condition"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            Orth-Full Orth-Sparse Tri-Sparse Orth-Grid    Sum
  incorrect    0.9000      0.8864     0.8542    0.9592 0.8958
  correct      0.1000      0.1136     0.1458    0.0408 0.1042
  Sum          1.0000      1.0000     1.0000    1.0000 1.0000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Number of Correct Responses by Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of Correct Responses by Condition"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            Orth-Full Orth-Sparse Tri-Sparse Orth-Grid Sum
  incorrect       135          78        123        94 430
  correct          15          10         21         4  50
  Sum             150          88        144        98 480</code></pre>
</div>
</div>
</section>
<section id="logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression">LOGISTIC REGRESSION</h4>
<p>Fit a logistic regression predicting accuracy (absolute score) (n = 480) by condition (k = 2).<br>
</p>
<ul>
<li>Parameter estimate: <span class="math inline">\(\beta_{0}\)</span> = Log Odds of (correct) responses in CONTROL condition</li>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> = ODDS of correct response in CONTROL condition</li>
<li>Parameter estimate: <span class="math inline">\(\beta_{1}\)</span> = <span class="math inline">\(\beta_{1impasse}\)</span> Log Odds (Log OR; change in odds for correct response in impasse (vs) control [log scale])</li>
<li><span class="math inline">\(e^{\beta_{1}}\)</span> = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</li>
<li><strong>Null hypothesis</strong>:<span class="math inline">\(\beta_{impasse} \le 0\)</span> the odds for a correct response does not change, or decreases</li>
<li><strong>Alternative hypothesis:</strong> <span class="math inline">\(\beta_{impasse} \gt 0\)</span> the odds of a correct response increases</li>
</ul>
<section id="fit-model-1" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-1">Fit Model</h5>
<p><em>First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING ::::::::</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.561  -0.561  -0.459  -0.289   2.529  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -2.197      0.272   -8.07  6.9e-16 ***
pretty_conditionOrth-Sparse    0.143      0.432    0.33    0.741    
pretty_conditionTri-Sparse     0.430      0.360    1.19    0.233    
pretty_conditionOrth-Grid     -0.960      0.578   -1.66    0.097 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 320.78  on 479  degrees of freedom
Residual deviance: 312.90  on 476  degrees of freedom
AIC: 320.9

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: accuracy
                 LR Chisq Df Pr(&gt;Chisq)  
pretty_condition     7.88  3      0.049 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name | Model | df | df_diff | Chi2 |     p
------------------------------------------
m0   |   glm |  1 |         |      |      
m1   |   glm |  4 |       3 | 7.88 | 0.049</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0486364443240912"</code></pre>
</div>
</div>
<p><em>The Condition predictor decreases AIC, but the Likelihood Ratio Test is marginal. We proceed to examine the predictor model, as we plan to do a 1-tailed NHST .</em></p>
</section>
<section id="describe-3" class="level5">
<h5 class="anchored" data-anchor-id="describe-3">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL [default two-tailed sig test]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL [default two-tailed sig test]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.561  -0.561  -0.459  -0.289   2.529  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -2.197      0.272   -8.07  6.9e-16 ***
pretty_conditionOrth-Sparse    0.143      0.432    0.33    0.741    
pretty_conditionTri-Sparse     0.430      0.360    1.19    0.233    
pretty_conditionOrth-Grid     -0.960      0.578   -1.66    0.097 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 320.78  on 479  degrees of freedom
Residual deviance: 312.90  on 476  degrees of freedom
AIC: 320.9

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: accuracy
                 LR Chisq Df Pr(&gt;Chisq)  
pretty_condition     7.88  3      0.049 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"p value for two-tailed test, null B = 0 : "</span>,<span class="fu">round</span>(tt,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p value for two-tailed test, null B = 0 :  0.741"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>ot <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"BUT we want a one tailed directional, null: B &lt;= 0: "</span>,<span class="fu">round</span>(ot,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BUT we want a one tailed directional, null: B &lt;= 0:  0.37"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"adjusted confint for directional hypothesis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "adjusted confint for directional hypothesis"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>(dcint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1, <span class="at">level =</span> <span class="fl">0.90</span>)) <span class="co"># get 90% for right side))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               5 %    95 %
(Intercept)                 -2.674 -1.7741
pretty_conditionOrth-Sparse -0.587  0.8464
pretty_conditionTri-Sparse  -0.158  1.0329
pretty_conditionOrth-Grid   -2.009 -0.0704</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval —- LOG ODDS")</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(confint(m1)))) #exponentiated, not adjusted</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(dcint))) <span class="co">#exponentiated, adjusted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                    5 %  95 %
(Intercept)                 0.111 0.069 0.170
pretty_conditionOrth-Sparse 1.154 0.556 2.331
pretty_conditionTri-Sparse  1.537 0.853 2.809
pretty_conditionOrth-Grid   0.383 0.134 0.932</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PREDICTIONS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pred.control &lt;- predict(m1,data.frame(pretty_condition="control"),type="response")</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #this should match : plogis(intercept coefficient)</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Probability of success in control,", pred.control)</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pred.impasse &lt;- predict(m1,data.frame(pretty_condition="impasse"),type="response")</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #this should match : plogis(intercept coefficient + predictor coeff)</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Probability of success in impasse,", pred.impasse)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="todo-inference-3" class="level5">
<h5 class="anchored" data-anchor-id="todo-inference-3">TODO Inference</h5>
</section>
<section id="visualize-2" class="level5">
<h5 class="anchored" data-anchor-id="visualize-2">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SET MODEL</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m1</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span> <span class="co">#remove to put on log scale x axis </span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c("control","impasse"))+</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"pred"</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="co">#scale y axis to actual range</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL PREDICTION  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of correct response on Q1"</span>,</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06&nbsp;–&nbsp;0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Orth-Sparse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.48&nbsp;–&nbsp;2.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.741</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Tri-Sparse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.54</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.76&nbsp;–&nbsp;3.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.233</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Orth-Grid]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.11&nbsp;–&nbsp;1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.097</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">480</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.015</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-1" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># report::report(m)</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print("MODEL PERFORMANCE")</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL DIAGNOSTICS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-DIAG-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="h1b-q1-interpretation-state" class="level2">
<h2 class="anchored" data-anchor-id="h1b-q1-interpretation-state">H1B | Q1 INTERPRETATION STATE</h2>
<p>While absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesn’t allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subject’s response, and determine if these interpretations differ by experimental condition. State is a 3-category derived response variable that groups the following interpretations:</p>
<ul>
<li><p><strong>“orthogonal”</strong> [reference category] includes orthogonal and satisficing responses ==&gt; indicates a primarily <em>orthogonal</em> state of coordinate system understanding</p></li>
<li><p><strong>“other”</strong> includes: blank, reference point, responses that can’t be classified (including selecting all datapoints), =&gt; indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly <em>not</em> orthogonal nor triangular</p></li>
<li><p><strong>“angular”</strong> includes ‘lines connecting’ responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
<li><p><strong>“triangular”</strong> includes correct triangular and ‘lines connecting’ responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th>Research Question</th>
<th>Does Ss in the impasse condition produce less orthogonal responses on the first question?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the IMPASSE condition will have a higher likelihood of producing unknown and and triangle-like response states, relative to orthogonal response states, on the first question</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td><ul>
<li>data: <code>df_items</code> where <code>q == 1</code></li>
<li>outcome: <code>state</code> ( 4 level factor from 5 level high_interpretation )</li>
<li>predictor: <code>condition</code> [between-subjects factor]</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>Multinomial (Logistic) Regression on state predicted by condition</li>
</ol>
<p>Alternative:</p>
<ul>
<li>Ordinal regression on state; but model doesn’t satisfy proportional odds assumption (parallel slopes)</li>
<li>Multinomial or Ordinal regression on high_interpretation (5 category interpretation state which distinguishes between uncertain (blank, reference) unclassifiable, triangle-like and true triangular.) There are some cells with zeros, however (no uncertain responses in control) which means the model can’t accurately estimate those comparisons</li>
</ul></td>
</tr>
</tbody>
</table>
<section id="setup-3" class="level4">
<h4 class="anchored" data-anchor-id="setup-3">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-4" class="level4">
<h4 class="anchored" data-anchor-id="describe-4">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-Q1STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: BARSTATS</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>( <span class="at">data =</span> df, <span class="at">y =</span> pretty_condition, <span class="at">x =</span> state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/VIS-Q1STATE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             Orth-Full Orth-Sparse Tri-Sparse Orth-Grid     Sum
  orthogonal   0.86000     0.81818    0.72917   0.91837 0.82500
  other        0.02667     0.03409    0.03472   0.02041 0.02917
  tri-like     0.00667     0.03409    0.09028   0.02041 0.03958
  triangular   0.10667     0.11364    0.14583   0.04082 0.10625
  Sum          1.00000     1.00000    1.00000   1.00000 1.00000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             Orth-Full Orth-Sparse Tri-Sparse Orth-Grid Sum
  orthogonal       129          72        105        90 396
  other              4           3          5         2  14
  tri-like           1           3         13         2  19
  triangular        16          10         21         4  51
  Sum              150          88        144        98 480</code></pre>
</div>
</div>
</section>
<section id="multinomial-regression" class="level4">
<h4 class="anchored" data-anchor-id="multinomial-regression">MULTINOMIAL REGRESSION</h4>
<section id="fit-model-2" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-2">Fit Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categories (first is reference)"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "orthogonal" "other"      "tri-like"   "triangular"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  8 (3 variable)
initial  value 665.421293 
iter  10 value 301.363054
iter  10 value 301.363052
iter  10 value 301.363052
final  value 301.363052 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>catm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  20 (12 variable)
initial  value 665.421293 
iter  10 value 289.824282
iter  20 value 288.928010
final  value 288.928004 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm)</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, catm<span class="fl">.0</span><span class="sc">$</span>AIC <span class="sc">&gt;</span> catm<span class="sc">$</span>AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |  Chi2 |     p
------------------------------------------------
catm.0 | multinom |  3 |         |       |      
catm   | multinom | 12 |       9 | 24.87 | 0.003</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state2 ~ pretty_condition, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat)</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state2 ~ pretty_condition , data = df)</span></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.</em></p>
</section>
<section id="describe-5" class="level5">
<h5 class="anchored" data-anchor-id="describe-5">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> catm</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL SUMMARY"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = state ~ pretty_condition, data = df, model = TRUE)

Coefficients:
           (Intercept) pretty_conditionOrth-Sparse pretty_conditionTri-Sparse
other            -3.47                       0.295                      0.429
tri-like         -4.86                       1.682                      2.771
triangular       -2.09                       0.113                      0.478
           pretty_conditionOrth-Grid
other                         -0.333
tri-like                       1.053
triangular                    -1.026

Std. Errors:
           (Intercept) pretty_conditionOrth-Sparse pretty_conditionTri-Sparse
other            0.508                       0.778                      0.684
tri-like         1.004                       1.164                      1.046
triangular       0.265                       0.429                      0.357
           pretty_conditionOrth-Grid
other                          0.877
tri-like                       1.232
triangular                     0.576

Residual Deviance: 578 
AIC: 602 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  8 (3 variable)
initial  value 665.421293 
iter  10 value 301.363054
iter  10 value 301.363052
iter  10 value 301.363052
final  value 301.363052 
converged</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: state
                 LR Chisq Df Pr(&gt;Chisq)   
pretty_condition     24.9  9     0.0031 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(m)<span class="sc">$</span>standard.errors</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>(p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           p..Intercept. p.pretty_conditionOrth.Sparse
other           7.82e-12                         0.704
tri-like        1.29e-06                         0.149
triangular      3.33e-15                         0.792
           p.pretty_conditionTri.Sparse p.pretty_conditionOrth.Grid
other                           0.53022                      0.7039
tri-like                        0.00808                      0.3928
triangular                      0.18066                      0.0746</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>coefficients))</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           OR..Intercept. OR.pretty_conditionOrth.Sparse
other             0.03101                           1.34
tri-like          0.00775                           5.37
triangular        0.12403                           1.12
           OR.pretty_conditionTri.Sparse OR.pretty_conditionOrth.Grid
other                               1.54                        0.717
tri-like                           15.97                        2.867
triangular                          1.61                        0.358
           p..Intercept. p.pretty_conditionOrth.Sparse
other           7.82e-12                         0.704
tri-like        1.29e-06                         0.149
triangular      3.33e-15                         0.792
           p.pretty_conditionTri.Sparse p.pretty_conditionOrth.Grid
other                           0.53022                      0.7039
tri-like                        0.00808                      0.3928
triangular                      0.18066                      0.0746</code></pre>
</div>
</div>
</section>
<section id="todo-inference-4" class="level5">
<h5 class="anchored" data-anchor-id="todo-inference-4">TODO Inference</h5>
</section>
<section id="visualize-3" class="level5">
<h5 class="anchored" data-anchor-id="visualize-3">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() + #remove to put on log scale x axis </span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c("control","impasse"))+</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-Q1STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL PREDICTION  | Q1 State ~ condition"</span>,</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of more accurate response states Q1"</span>,</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'y' is already present. Adding another scale for 'y', which will
replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4A_hypotesting_files/figure-html/MODEL-VIS-Q1STATE-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MANUALLY BUILD PREDICTION PLOT FACET BY CONDITION RATHER THAN STATE</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;-plot_model(m, type="eff")[[1]]</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- ggplot_build(p)[[1]]  </span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co"># points &lt;- d[[2]]</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="co"># points &lt;- points %&gt;% mutate(</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   state = recode(PANEL, "1" ="orth", "2"="other", "3" = "trilike", "4"="tri"),</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   condition = recode(x, "1"="control","2"="impasse"),</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   prob = y</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_point( prob ~ state, group = ~x, data = points) + </span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_errorbar(aes( x = state, ymin = ymin, ymax = ymax)) + facet_grid(~condition) +ylim(0,1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Response</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Orth-Sparse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.29&nbsp;–&nbsp;6.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.704</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Tri-Sparse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.54</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.40&nbsp;–&nbsp;5.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.531</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Orth-Grid]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.13&nbsp;–&nbsp;4.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.704</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">tri-like</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Orth-Sparse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.55&nbsp;–&nbsp;52.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.149</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">tri-like</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Tri-Sparse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">15.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.04&nbsp;–&nbsp;124.76</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.008</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">tri-like</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Orth-Grid]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.87</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.25&nbsp;–&nbsp;32.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.393</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">tri-like</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.07&nbsp;–&nbsp;0.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Orth-Sparse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.48&nbsp;–&nbsp;2.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.792</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Tri-Sparse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.80&nbsp;–&nbsp;3.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.181</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[Orth-Grid]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.12&nbsp;–&nbsp;1.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.075</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">480</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.041 / 0.038</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(mixcat.1, s)</span></span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-2" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-2">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test &lt;- data.frame(pretty_condition = c("control", "impasse"))</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pred &lt;- predict(catm, newdata = test, "probs")</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Predicted Probability of Being in Each State")</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ( x &lt;- cbind(test, pred))</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(catm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma
-----------------------------------------------------
601.856 | 651.941 | 0.041 |     0.038 | 0.273 | 1.111</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(catm, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  McFadden   CoxSnell Nagelkerke 
    0.0413     0.0505     0.0706 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(generalhoslem)</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="co">#logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.test(df$state, predict(catm)) #actual states VS predicted states</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The chi-square test tests the decrease in unexplained variance from the baseline model to the final model</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL DIAGNOSTICS")</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m) can't do overall diagnostics, have to do them on individual model equations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../analysis/SGC4A/3_sgc4A_description.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Description</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb200" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'Study SGC4A | Hypothesis Testing'</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis Testing {#sec-SGC4A-hypotesting}</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>**TODO**</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>*The purpose of this notebook is test the hypotheses that determined the designs of the SGC4A studies.*</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a><span class="co">#UTILITIES</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy model output</span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#favstats</span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a><span class="co"># library(modelr)</span></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a><span class="co"># library(jtools)</span></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pwr) #power analysis</span></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZATION</span></span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr) #arrange plots</span></span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cowplot) #arrange shift function plots</span></span>
<span id="cb200-32"><a href="#cb200-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb200-33"><a href="#cb200-33" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcd) #mosaic plots</span></span>
<span id="cb200-34"><a href="#cb200-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcdExtra) #mosaic plots</span></span>
<span id="cb200-35"><a href="#cb200-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables</span></span>
<span id="cb200-36"><a href="#cb200-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb200-37"><a href="#cb200-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz</span></span>
<span id="cb200-38"><a href="#cb200-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves) <span class="co"># plots. in half</span></span>
<span id="cb200-39"><a href="#cb200-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># violin plot stuffs</span></span>
<span id="cb200-40"><a href="#cb200-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions)</span>
<span id="cb200-41"><a href="#cb200-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with stats</span></span>
<span id="cb200-42"><a href="#cb200-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#latex tables for models!</span></span>
<span id="cb200-43"><a href="#cb200-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-44"><a href="#cb200-44" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELLING</span></span>
<span id="cb200-45"><a href="#cb200-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ARTool) <span class="co">#nonparametric anova</span></span>
<span id="cb200-46"><a href="#cb200-46" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstatix) #helpful testing functions incl wilcoxon, etc</span></span>
<span id="cb200-47"><a href="#cb200-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb200-48"><a href="#cb200-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb200-49"><a href="#cb200-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb200-50"><a href="#cb200-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#easystats model summary and vis</span></span>
<span id="cb200-51"><a href="#cb200-51" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qqplotr) #confint on qq plot</span></span>
<span id="cb200-52"><a href="#cb200-52" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gmodels) #contingency table and CHISQR</span></span>
<span id="cb200-53"><a href="#cb200-53" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic) #extract model equation</span></span>
<span id="cb200-54"><a href="#cb200-54" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pscl) #zeroinfl / hurdle models </span></span>
<span id="cb200-55"><a href="#cb200-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models</span></span>
<span id="cb200-56"><a href="#cb200-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer</span></span>
<span id="cb200-57"><a href="#cb200-57" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects) #visualization log regr models</span></span>
<span id="cb200-58"><a href="#cb200-58" aria-hidden="true" tabindex="-1"></a><span class="co">#MULTINOMIAL </span></span>
<span id="cb200-59"><a href="#cb200-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression [not mixed] #no p values</span></span>
<span id="cb200-60"><a href="#cb200-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#frequentist mixed multinomial logistic regression [mblogit] #gives p values</span></span>
<span id="cb200-61"><a href="#cb200-61" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN</span></span>
<span id="cb200-62"><a href="#cb200-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr) <span class="co">#executing stan</span></span>
<span id="cb200-63"><a href="#cb200-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#bayesian mixed multinomials [+ other bayesian reg models]</span></span>
<span id="cb200-64"><a href="#cb200-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) </span>
<span id="cb200-65"><a href="#cb200-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-66"><a href="#cb200-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb200-67"><a href="#cb200-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-68"><a href="#cb200-68" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb200-69"><a href="#cb200-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb200-70"><a href="#cb200-70" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb200-71"><a href="#cb200-71" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb200-72"><a href="#cb200-72" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb200-73"><a href="#cb200-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-74"><a href="#cb200-74" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb200-75"><a href="#cb200-75" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_minimal()) </span></span>
<span id="cb200-76"><a href="#cb200-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-77"><a href="#cb200-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb200-78"><a href="#cb200-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed</span></span>
<span id="cb200-79"><a href="#cb200-79" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb200-80"><a href="#cb200-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb200-81"><a href="#cb200-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb200-82"><a href="#cb200-82" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb200-83"><a href="#cb200-83" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb200-84"><a href="#cb200-84" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb200-85"><a href="#cb200-85" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb200-86"><a href="#cb200-86" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb200-87"><a href="#cb200-87" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb200-88"><a href="#cb200-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-89"><a href="#cb200-89" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_clean</span>())</span>
<span id="cb200-90"><a href="#cb200-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-91"><a href="#cb200-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-92"><a href="#cb200-92" aria-hidden="true" tabindex="-1"></a>**Research Questions**</span>
<span id="cb200-93"><a href="#cb200-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-94"><a href="#cb200-94" aria-hidden="true" tabindex="-1"></a>**Experimental Hypothesis**\</span>
<span id="cb200-95"><a href="#cb200-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-96"><a href="#cb200-96" aria-hidden="true" tabindex="-1"></a>**Null Hypothesis**\</span>
<span id="cb200-97"><a href="#cb200-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-100"><a href="#cb200-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-101"><a href="#cb200-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb200-102"><a href="#cb200-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb200-103"><a href="#cb200-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb200-104"><a href="#cb200-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-105"><a href="#cb200-105" aria-hidden="true" tabindex="-1"></a><span class="co"># #HACK WD FOR LOCAL RUNNING?</span></span>
<span id="cb200-106"><a href="#cb200-106" aria-hidden="true" tabindex="-1"></a>imac <span class="ot">=</span> <span class="st">"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb200-107"><a href="#cb200-107" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(imac)</span>
<span id="cb200-108"><a href="#cb200-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-109"><a href="#cb200-109" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb200-110"><a href="#cb200-110" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC4A/data/2-scored-data/sgc4a_scored_participants.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb200-111"><a href="#cb200-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb200-112"><a href="#cb200-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">task_percent =</span> DV_percent_NABS</span>
<span id="cb200-113"><a href="#cb200-113" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb200-114"><a href="#cb200-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-115"><a href="#cb200-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-116"><a href="#cb200-116" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC4A/data/2-scored-data/sgc4a_scored_items.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb200-117"><a href="#cb200-117" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span> (</span>
<span id="cb200-118"><a href="#cb200-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.factor</span>(q), </span>
<span id="cb200-119"><a href="#cb200-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.factor</span>(subject),</span>
<span id="cb200-120"><a href="#cb200-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb200-121"><a href="#cb200-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS TRI-LIKE</span></span>
<span id="cb200-122"><a href="#cb200-122" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state = recode_factor(score_SCALED, #for ordinal</span></span>
<span id="cb200-123"><a href="#cb200-123" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-1" = "orth-like",</span></span>
<span id="cb200-124"><a href="#cb200-124" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-0.5" = "unknown",</span></span>
<span id="cb200-125"><a href="#cb200-125" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0" = "unknown",</span></span>
<span id="cb200-126"><a href="#cb200-126" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0.5" = "tri-like",</span></span>
<span id="cb200-127"><a href="#cb200-127" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "1" = "tri-like"),</span></span>
<span id="cb200-128"><a href="#cb200-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS OTHER</span></span>
<span id="cb200-129"><a href="#cb200-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb200-130"><a href="#cb200-130" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orthogonal"</span>,</span>
<span id="cb200-131"><a href="#cb200-131" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb200-132"><a href="#cb200-132" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb200-133"><a href="#cb200-133" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>,</span>
<span id="cb200-134"><a href="#cb200-134" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"triangular"</span>),</span>
<span id="cb200-135"><a href="#cb200-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">as.ordered</span>(state)) </span>
<span id="cb200-136"><a href="#cb200-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-137"><a href="#cb200-137" aria-hidden="true" tabindex="-1"></a><span class="co">#SEPARATE INTO PARTS 1 AND 2</span></span>
<span id="cb200-138"><a href="#cb200-138" aria-hidden="true" tabindex="-1"></a><span class="co"># sgc4a &lt;- df_subjects %&gt;% filter(condition %in% c(111,113)) %&gt;% droplevels()</span></span>
<span id="cb200-139"><a href="#cb200-139" aria-hidden="true" tabindex="-1"></a><span class="co"># sgc4b &lt;- df_subjects %&gt;% filter(condition %in% c(111,114,115)) %&gt;% filter(mode=="asynch") %&gt;% droplevels()</span></span>
<span id="cb200-140"><a href="#cb200-140" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-141"><a href="#cb200-141" aria-hidden="true" tabindex="-1"></a><span class="co"># sgc4a_items &lt;- df_items %&gt;% filter( subject %in% sgc4a$subject) %&gt;% droplevels()</span></span>
<span id="cb200-142"><a href="#cb200-142" aria-hidden="true" tabindex="-1"></a><span class="co"># sgc4b_items &lt;- df_items %&gt;% filter( subject %in% sgc4b$subject) %&gt;% droplevels()</span></span>
<span id="cb200-143"><a href="#cb200-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-144"><a href="#cb200-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-145"><a href="#cb200-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-146"><a href="#cb200-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb200-147"><a href="#cb200-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-148"><a href="#cb200-148" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1A \| OVERALL TASK  ACCURACY</span></span>
<span id="cb200-149"><a href="#cb200-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-150"><a href="#cb200-150" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb200-153"><a href="#cb200-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-154"><a href="#cb200-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-ACC</span></span>
<span id="cb200-155"><a href="#cb200-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-156"><a href="#cb200-156" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb200-157"><a href="#cb200-157" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, accuracy, subject,q)</span>
<span id="cb200-158"><a href="#cb200-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-159"><a href="#cb200-159" aria-hidden="true" tabindex="-1"></a>df_s <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb200-160"><a href="#cb200-160" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, task_percent)</span>
<span id="cb200-161"><a href="#cb200-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-162"><a href="#cb200-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-163"><a href="#cb200-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-164"><a href="#cb200-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-165"><a href="#cb200-165" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe</span></span>
<span id="cb200-168"><a href="#cb200-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-169"><a href="#cb200-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-ACC</span></span>
<span id="cb200-170"><a href="#cb200-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-171"><a href="#cb200-171" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb200-172"><a href="#cb200-172" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb200-173"><a href="#cb200-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-174"><a href="#cb200-174" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb200-175"><a href="#cb200-175" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb200-176"><a href="#cb200-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-177"><a href="#cb200-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb200-178"><a href="#cb200-178" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb200-179"><a href="#cb200-179" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Accuracy"</span>,</span>
<span id="cb200-180"><a href="#cb200-180" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-181"><a href="#cb200-181" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-182"><a href="#cb200-182" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb200-183"><a href="#cb200-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-184"><a href="#cb200-184" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb200-185"><a href="#cb200-185" aria-hidden="true" tabindex="-1"></a>df_items <span class="sc">%&gt;%</span> </span>
<span id="cb200-186"><a href="#cb200-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-187"><a href="#cb200-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb200-188"><a href="#cb200-188" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb200-189"><a href="#cb200-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-190"><a href="#cb200-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb200-191"><a href="#cb200-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>q) <span class="sc">+</span></span>
<span id="cb200-192"><a href="#cb200-192" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accuracy by Question"</span>,</span>
<span id="cb200-193"><a href="#cb200-193" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-194"><a href="#cb200-194" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-195"><a href="#cb200-195" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Q6 and Q9 are non-discriminative"</span>)</span>
<span id="cb200-196"><a href="#cb200-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-197"><a href="#cb200-197" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: FACETED HISTOGRAM</span></span>
<span id="cb200-198"><a href="#cb200-198" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_s <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(task_percent))</span>
<span id="cb200-199"><a href="#cb200-199" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>task_percent,</span>
<span id="cb200-200"><a href="#cb200-200" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_s) <span class="sc">%&gt;%</span></span>
<span id="cb200-201"><a href="#cb200-201" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gf_facet_grid(pretty_condition ~ pretty_mode) %&gt;%</span></span>
<span id="cb200-202"><a href="#cb200-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_condition) <span class="sc">%&gt;%</span></span>
<span id="cb200-203"><a href="#cb200-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb200-204"><a href="#cb200-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb200-205"><a href="#cb200-205" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb200-206"><a href="#cb200-206" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Overall Absolute Score (% Correct)"</span>,</span>
<span id="cb200-207"><a href="#cb200-207" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb200-208"><a href="#cb200-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-209"><a href="#cb200-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-212"><a href="#cb200-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-213"><a href="#cb200-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC2-ACC</span></span>
<span id="cb200-214"><a href="#cb200-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-215"><a href="#cb200-215" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct)"</span></span>
<span id="cb200-216"><a href="#cb200-216" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span>task_percent, <span class="at">data =</span> df_s) </span>
<span id="cb200-217"><a href="#cb200-217" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb200-218"><a href="#cb200-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-219"><a href="#cb200-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-220"><a href="#cb200-220" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION"</span></span>
<span id="cb200-221"><a href="#cb200-221" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb200-222"><a href="#cb200-222" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb200-223"><a href="#cb200-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-224"><a href="#cb200-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-225"><a href="#cb200-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-226"><a href="#cb200-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-227"><a href="#cb200-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-228"><a href="#cb200-228" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TESTS</span></span>
<span id="cb200-229"><a href="#cb200-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-230"><a href="#cb200-230" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Aligned Ranks Transformation</span></span>
<span id="cb200-231"><a href="#cb200-231" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- https://rcompanion.org/handbook/F_16.html --&gt;</span></span>
<span id="cb200-234"><a href="#cb200-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-235"><a href="#cb200-235" aria-hidden="true" tabindex="-1"></a>m.art <span class="ot">=</span> <span class="fu">art</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s)</span>
<span id="cb200-236"><a href="#cb200-236" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m.art)</span>
<span id="cb200-237"><a href="#cb200-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-238"><a href="#cb200-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-239"><a href="#cb200-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-240"><a href="#cb200-240" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Kruskal Wallis Test</span></span>
<span id="cb200-243"><a href="#cb200-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-244"><a href="#cb200-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: </span><span class="al">TEST</span><span class="co">-ACC</span></span>
<span id="cb200-245"><a href="#cb200-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-246"><a href="#cb200-246" aria-hidden="true" tabindex="-1"></a>(k <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(df_s<span class="sc">$</span>task_percent <span class="sc">~</span> df_s<span class="sc">$</span>pretty_condition))</span>
<span id="cb200-247"><a href="#cb200-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-248"><a href="#cb200-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-249"><a href="#cb200-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-250"><a href="#cb200-250" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb200-251"><a href="#cb200-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-254"><a href="#cb200-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-255"><a href="#cb200-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: </span><span class="al">TEST</span><span class="co">-VIZ-ACC</span></span>
<span id="cb200-256"><a href="#cb200-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-257"><a href="#cb200-257" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> statsExpressions<span class="sc">::</span><span class="fu">oneway_anova</span>(<span class="at">data =</span> df_s, </span>
<span id="cb200-258"><a href="#cb200-258" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> pretty_condition, <span class="at">y =</span> task_percent,</span>
<span id="cb200-259"><a href="#cb200-259" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">alternative =</span> <span class="st">"less"</span>))</span>
<span id="cb200-260"><a href="#cb200-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-261"><a href="#cb200-261" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STATSPLOT | VIOLIN</span></span>
<span id="cb200-262"><a href="#cb200-262" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> task_percent, <span class="at">x =</span> pretty_condition, </span>
<span id="cb200-263"><a href="#cb200-263" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df_s, <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span>
<span id="cb200-264"><a href="#cb200-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-265"><a href="#cb200-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-266"><a href="#cb200-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-267"><a href="#cb200-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-268"><a href="#cb200-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-269"><a href="#cb200-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-270"><a href="#cb200-270" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MIXED LOGISTIC REGRESSION</span></span>
<span id="cb200-271"><a href="#cb200-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-272"><a href="#cb200-272" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.*</span>
<span id="cb200-273"><a href="#cb200-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-274"><a href="#cb200-274" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb200-275"><a href="#cb200-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-276"><a href="#cb200-276" aria-hidden="true" tabindex="-1"></a>TODO model with item as random doesn't converge unless use bobyqa optimizer. </span>
<span id="cb200-279"><a href="#cb200-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-280"><a href="#cb200-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-FIT-ACC</span></span>
<span id="cb200-281"><a href="#cb200-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-282"><a href="#cb200-282" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SETUP</span></span>
<span id="cb200-283"><a href="#cb200-283" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm 13 items [all discriminating items]</span></span>
<span id="cb200-284"><a href="#cb200-284" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_i) <span class="sc">/</span> <span class="fu">nrow</span>(df_s) <span class="sc">==</span> <span class="dv">13</span></span>
<span id="cb200-285"><a href="#cb200-285" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm all factors </span></span>
<span id="cb200-286"><a href="#cb200-286" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df_i<span class="sc">$</span>q) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>subject) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>pretty_condition) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>accuracy)</span>
<span id="cb200-287"><a href="#cb200-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-288"><a href="#cb200-288" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb200-289"><a href="#cb200-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-290"><a href="#cb200-290" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb200-291"><a href="#cb200-291" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Empty fixed model"</span>)</span>
<span id="cb200-292"><a href="#cb200-292" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df_i) </span>
<span id="cb200-293"><a href="#cb200-293" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb200-294"><a href="#cb200-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-295"><a href="#cb200-295" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb200-296"><a href="#cb200-296" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject intercept random model"</span>)</span>
<span id="cb200-297"><a href="#cb200-297" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb200-298"><a href="#cb200-298" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.rS)</span></span>
<span id="cb200-299"><a href="#cb200-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-300"><a href="#cb200-300" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb200-301"><a href="#cb200-301" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span>
<span id="cb200-302"><a href="#cb200-302" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb200-303"><a href="#cb200-303" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb200-304"><a href="#cb200-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-305"><a href="#cb200-305" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + ITEM</span></span>
<span id="cb200-306"><a href="#cb200-306" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject Intercept + Item intercept random model"</span>)</span>
<span id="cb200-307"><a href="#cb200-307" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb200-308"><a href="#cb200-308" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>, <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="fl">2e5</span>)))</span>
<span id="cb200-309"><a href="#cb200-309" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.rSQ)</span></span>
<span id="cb200-310"><a href="#cb200-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-311"><a href="#cb200-311" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb200-312"><a href="#cb200-312" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)))</span>
<span id="cb200-313"><a href="#cb200-313" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS, mm.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb200-314"><a href="#cb200-314" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS, mm.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb200-315"><a href="#cb200-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-316"><a href="#cb200-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-317"><a href="#cb200-317" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT CONDITION</span></span>
<span id="cb200-318"><a href="#cb200-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-319"><a href="#cb200-319" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Item random intercepts"</span>)</span>
<span id="cb200-320"><a href="#cb200-320" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb200-321"><a href="#cb200-321" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> binomial,</span>
<span id="cb200-322"><a href="#cb200-322" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>, <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="fl">2e5</span>)))</span>
<span id="cb200-323"><a href="#cb200-323" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.CrSQ)</span></span>
<span id="cb200-324"><a href="#cb200-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-325"><a href="#cb200-325" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) )</span>
<span id="cb200-326"><a href="#cb200-326" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb200-327"><a href="#cb200-327" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb200-328"><a href="#cb200-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-329"><a href="#cb200-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-330"><a href="#cb200-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-331"><a href="#cb200-331" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb200-332"><a href="#cb200-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-335"><a href="#cb200-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-336"><a href="#cb200-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-ACC</span></span>
<span id="cb200-337"><a href="#cb200-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-338"><a href="#cb200-338" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb200-339"><a href="#cb200-339" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.CrSQ</span>
<span id="cb200-340"><a href="#cb200-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-341"><a href="#cb200-341" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb200-342"><a href="#cb200-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-343"><a href="#cb200-343" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb200-344"><a href="#cb200-344" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb200-345"><a href="#cb200-345" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFICANCE TEST [non directional]"</span>)</span>
<span id="cb200-346"><a href="#cb200-346" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb200-347"><a href="#cb200-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-348"><a href="#cb200-348" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: MANUAL ONE-SIDED SIGTEST </span></span>
<span id="cb200-349"><a href="#cb200-349" aria-hidden="true" tabindex="-1"></a><span class="co">#note: anova and chi square are always one-tailed, but that is independent of being one-sided</span></span>
<span id="cb200-350"><a href="#cb200-350" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half</span></span>
<span id="cb200-351"><a href="#cb200-351" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb200-352"><a href="#cb200-352" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb200-353"><a href="#cb200-353" aria-hidden="true" tabindex="-1"></a><span class="co"># tt &lt;- 2*pnorm(summary(m)$coefficients[2,3], lower.tail = F)</span></span>
<span id="cb200-354"><a href="#cb200-354" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("p value for two-tailed test, null B = 0 : ",round(tt,5))</span></span>
<span id="cb200-355"><a href="#cb200-355" aria-hidden="true" tabindex="-1"></a><span class="co"># ot &lt;- pnorm(summary(m)$coefficients[2,3], lower.tail = F)</span></span>
<span id="cb200-356"><a href="#cb200-356" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("BUT we want a one  directional, null: B &lt;= 0: ",round(ot,5))</span></span>
<span id="cb200-357"><a href="#cb200-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-358"><a href="#cb200-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-359"><a href="#cb200-359" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO POSTHOCS</span></span>
<span id="cb200-360"><a href="#cb200-360" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb200-361"><a href="#cb200-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-362"><a href="#cb200-362" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb200-363"><a href="#cb200-363" aria-hidden="true" tabindex="-1"></a><span class="co"># table of estimates with 95% CI</span></span>
<span id="cb200-364"><a href="#cb200-364" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("LOG ODDS")</span></span>
<span id="cb200-365"><a href="#cb200-365" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m), </span></span>
<span id="cb200-366"><a href="#cb200-366" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se, </span></span>
<span id="cb200-367"><a href="#cb200-367" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb200-368"><a href="#cb200-368" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("ODDS RATIOS")</span></span>
<span id="cb200-369"><a href="#cb200-369" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb200-370"><a href="#cb200-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-371"><a href="#cb200-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-372"><a href="#cb200-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-373"><a href="#cb200-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-374"><a href="#cb200-374" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO Inference</span></span>
<span id="cb200-375"><a href="#cb200-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-376"><a href="#cb200-376" aria-hidden="true" tabindex="-1"></a>**TODO REDO UPDATE THIS**</span>
<span id="cb200-377"><a href="#cb200-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-378"><a href="#cb200-378" aria-hidden="true" tabindex="-1"></a>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects and items; to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(4): 11.02, p <span class="sc">\&lt;</span> 0.001); and the total explanatory power is substantial (conditional R2 = 0.82) and the part related to the fixed effects (marginal R2) is 0.02. Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 2.8 over the control condition $e^{\beta_1}$ = 2.80, 95% CI <span class="sc">\[</span>1.54, 5.09<span class="sc">\]</span>, p <span class="sc">\&lt;</span> 0.001.</span>
<span id="cb200-379"><a href="#cb200-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-380"><a href="#cb200-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-381"><a href="#cb200-381" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb200-382"><a href="#cb200-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-385"><a href="#cb200-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-386"><a href="#cb200-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-ACC</span></span>
<span id="cb200-387"><a href="#cb200-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-388"><a href="#cb200-388" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb200-389"><a href="#cb200-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-390"><a href="#cb200-390" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb200-391"><a href="#cb200-391" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb200-392"><a href="#cb200-392" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb200-393"><a href="#cb200-393" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb200-394"><a href="#cb200-394" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb200-395"><a href="#cb200-395" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.95</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb200-396"><a href="#cb200-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Estimate | Odds Ratio"</span>,</span>
<span id="cb200-397"><a href="#cb200-397" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb200-398"><a href="#cb200-398" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="co">#why no error bars? problem with model?</span></span>
<span id="cb200-399"><a href="#cb200-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-400"><a href="#cb200-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-401"><a href="#cb200-401" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb200-402"><a href="#cb200-402" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb200-403"><a href="#cb200-403" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-404"><a href="#cb200-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-405"><a href="#cb200-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-406"><a href="#cb200-406" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb200-407"><a href="#cb200-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-408"><a href="#cb200-408" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb200-409"><a href="#cb200-409" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-410"><a href="#cb200-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-411"><a href="#cb200-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-412"><a href="#cb200-412" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb200-413"><a href="#cb200-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-414"><a href="#cb200-414" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb200-415"><a href="#cb200-415" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>,</span>
<span id="cb200-416"><a href="#cb200-416" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb200-417"><a href="#cb200-417" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb200-418"><a href="#cb200-418" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb200-419"><a href="#cb200-419" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb200-420"><a href="#cb200-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-421"><a href="#cb200-421" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb200-422"><a href="#cb200-422" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb200-423"><a href="#cb200-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) </span>
<span id="cb200-424"><a href="#cb200-424" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb200-425"><a href="#cb200-425" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb200-426"><a href="#cb200-426" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb200-427"><a href="#cb200-427" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb200-428"><a href="#cb200-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-429"><a href="#cb200-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-430"><a href="#cb200-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-431"><a href="#cb200-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-432"><a href="#cb200-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-433"><a href="#cb200-433" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb200-434"><a href="#cb200-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-437"><a href="#cb200-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-438"><a href="#cb200-438" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb200-439"><a href="#cb200-439" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb200-440"><a href="#cb200-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-441"><a href="#cb200-441" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DIAGNOSTICS"</span>)</span>
<span id="cb200-442"><a href="#cb200-442" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span>
<span id="cb200-443"><a href="#cb200-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-444"><a href="#cb200-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-445"><a href="#cb200-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-446"><a href="#cb200-446" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO</span></span>
<span id="cb200-447"><a href="#cb200-447" aria-hidden="true" tabindex="-1"></a>Model with random intercept of Question doesn't want to converge unless I use the optimizer, which also throws warnings. Maybe jsut use random subject?</span>
<span id="cb200-448"><a href="#cb200-448" aria-hidden="true" tabindex="-1"></a>(hint... yes...) Otherwise, try the bayesian version</span>
<span id="cb200-449"><a href="#cb200-449" aria-hidden="true" tabindex="-1"></a><span class="fu">##### BAYESIAN </span></span>
<span id="cb200-450"><a href="#cb200-450" aria-hidden="true" tabindex="-1"></a>For some reason there are convergence difficulties. Try again with the brms version</span>
<span id="cb200-451"><a href="#cb200-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-454"><a href="#cb200-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-455"><a href="#cb200-455" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb200-456"><a href="#cb200-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-457"><a href="#cb200-457" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb200-458"><a href="#cb200-458" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.integer</span>(accuracy)</span>
<span id="cb200-459"><a href="#cb200-459" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb200-460"><a href="#cb200-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-461"><a href="#cb200-461" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO bernoulli or binomial?</span></span>
<span id="cb200-462"><a href="#cb200-462" aria-hidden="true" tabindex="-1"></a>B.mm.acc.CrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q),</span>
<span id="cb200-463"><a href="#cb200-463" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i,</span>
<span id="cb200-464"><a href="#cb200-464" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># family = "binomial",</span></span>
<span id="cb200-465"><a href="#cb200-465" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb200-466"><a href="#cb200-466" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb200-467"><a href="#cb200-467" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb200-468"><a href="#cb200-468" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb200-469"><a href="#cb200-469" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4A/models/sgc4a_brms_B.mm.acc.CrSQ.rds"</span>)</span>
<span id="cb200-470"><a href="#cb200-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-471"><a href="#cb200-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-472"><a href="#cb200-472" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(B.mm.acc.CrSQ)</span>
<span id="cb200-473"><a href="#cb200-473" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(B.mm.acc.CrSQ, <span class="at">show.values =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-474"><a href="#cb200-474" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">pd</span>(B.mm.acc.CrSQ))</span>
<span id="cb200-475"><a href="#cb200-475" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(equivalence_test(B.mm.acc.CrSQ))</span></span>
<span id="cb200-476"><a href="#cb200-476" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(B.mm.acc.CrSQ, <span class="at">type =</span> <span class="st">"pred"</span>)</span>
<span id="cb200-477"><a href="#cb200-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-478"><a href="#cb200-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-479"><a href="#cb200-479" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1A \| OVERALL INTERPRETATION STATE</span></span>
<span id="cb200-480"><a href="#cb200-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-481"><a href="#cb200-481" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"orthogonal"** <span class="sc">\[</span>reference category<span class="sc">\]</span> includes orthogonal and satisficing responses ==<span class="sc">\&gt;</span> indicates a primarily *orthogonal* state of coordinate system understanding</span>
<span id="cb200-482"><a href="#cb200-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-483"><a href="#cb200-483" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"other"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =<span class="sc">\&gt;</span> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular</span>
<span id="cb200-484"><a href="#cb200-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-485"><a href="#cb200-485" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"angular"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb200-486"><a href="#cb200-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-487"><a href="#cb200-487" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"triangular"** includes correct triangular and 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb200-488"><a href="#cb200-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-489"><a href="#cb200-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-490"><a href="#cb200-490" aria-hidden="true" tabindex="-1"></a>+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-491"><a href="#cb200-491" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does Ss in the impasse condition produce less orthogonal responses across questions?                                          |</span>
<span id="cb200-492"><a href="#cb200-492" aria-hidden="true" tabindex="-1"></a>+=======================+=================================================================================================================================================+</span>
<span id="cb200-493"><a href="#cb200-493" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the IMPASSE condition will have a higher likelihood of producing unknown and triangle-like response states across all items |</span>
<span id="cb200-494"><a href="#cb200-494" aria-hidden="true" tabindex="-1"></a>+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-495"><a href="#cb200-495" aria-hidden="true" tabindex="-1"></a>| **Data**              | -   data: <span class="in">`df_items`</span> where <span class="in">`q nin 6,9`</span> (13 discriminant test phase items)                                                              |</span>
<span id="cb200-496"><a href="#cb200-496" aria-hidden="true" tabindex="-1"></a>|                       | -   outcome: <span class="in">`state`</span> ( 3 level factor from high_interpretation )                                                                                |</span>
<span id="cb200-497"><a href="#cb200-497" aria-hidden="true" tabindex="-1"></a>|                       | -   predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                          |</span>
<span id="cb200-498"><a href="#cb200-498" aria-hidden="true" tabindex="-1"></a>+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-499"><a href="#cb200-499" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  MIXED Multinomial (Logistic) Regression on state predicted by condition                                                                     |</span>
<span id="cb200-500"><a href="#cb200-500" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                 |</span>
<span id="cb200-501"><a href="#cb200-501" aria-hidden="true" tabindex="-1"></a>|                       | Alternative:                                                                                                                                    |</span>
<span id="cb200-502"><a href="#cb200-502" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                 |</span>
<span id="cb200-503"><a href="#cb200-503" aria-hidden="true" tabindex="-1"></a>|                       | -   MIXED Ordinal regression on state (doesn't meet proportional odds assumption-I think)                                                       |</span>
<span id="cb200-504"><a href="#cb200-504" aria-hidden="true" tabindex="-1"></a>|                       | -   MIXED Multinomial or Ordinal regression on high_interpretation (some cells are 0, produces problems)                                        |</span>
<span id="cb200-505"><a href="#cb200-505" aria-hidden="true" tabindex="-1"></a>+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-506"><a href="#cb200-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-507"><a href="#cb200-507" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb200-508"><a href="#cb200-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-511"><a href="#cb200-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-512"><a href="#cb200-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-STATE</span></span>
<span id="cb200-513"><a href="#cb200-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-514"><a href="#cb200-514" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb200-515"><a href="#cb200-515" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,subject,state,pretty_condition)</span>
<span id="cb200-516"><a href="#cb200-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-517"><a href="#cb200-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-520"><a href="#cb200-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-521"><a href="#cb200-521" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb200-522"><a href="#cb200-522" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb200-523"><a href="#cb200-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-524"><a href="#cb200-524" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb200-525"><a href="#cb200-525" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb200-526"><a href="#cb200-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-527"><a href="#cb200-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb200-528"><a href="#cb200-528" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb200-529"><a href="#cb200-529" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation across all Questions"</span>,</span>
<span id="cb200-530"><a href="#cb200-530" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-531"><a href="#cb200-531" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-532"><a href="#cb200-532" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb200-533"><a href="#cb200-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-534"><a href="#cb200-534" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb200-535"><a href="#cb200-535" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb200-536"><a href="#cb200-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-537"><a href="#cb200-537" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb200-538"><a href="#cb200-538" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb200-539"><a href="#cb200-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-540"><a href="#cb200-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb200-541"><a href="#cb200-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>q) <span class="sc">+</span></span>
<span id="cb200-542"><a href="#cb200-542" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation by Question"</span>,</span>
<span id="cb200-543"><a href="#cb200-543" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-544"><a href="#cb200-544" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-545"><a href="#cb200-545" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb200-546"><a href="#cb200-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-547"><a href="#cb200-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-548"><a href="#cb200-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-549"><a href="#cb200-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-552"><a href="#cb200-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-553"><a href="#cb200-553" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb200-554"><a href="#cb200-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-555"><a href="#cb200-555" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb200-556"><a href="#cb200-556" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb200-557"><a href="#cb200-557" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb200-558"><a href="#cb200-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-559"><a href="#cb200-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-560"><a href="#cb200-560" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb200-561"><a href="#cb200-561" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb200-562"><a href="#cb200-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-563"><a href="#cb200-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-564"><a href="#cb200-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-565"><a href="#cb200-565" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MIXED MULTINOMIAL REGRESSION</span></span>
<span id="cb200-566"><a href="#cb200-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-567"><a href="#cb200-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-568"><a href="#cb200-568" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of of items across the task?*</span>
<span id="cb200-569"><a href="#cb200-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-570"><a href="#cb200-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-571"><a href="#cb200-571" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO Fit Model \[mblogit\]</span></span>
<span id="cb200-572"><a href="#cb200-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-575"><a href="#cb200-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-576"><a href="#cb200-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-MBLOGIT-STATE</span></span>
<span id="cb200-577"><a href="#cb200-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-578"><a href="#cb200-578" aria-hidden="true" tabindex="-1"></a><span class="co"># TRY AGAIN... MAYBE HUNG? </span></span>
<span id="cb200-579"><a href="#cb200-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-580"><a href="#cb200-580" aria-hidden="true" tabindex="-1"></a><span class="co"># #https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb200-581"><a href="#cb200-581" aria-hidden="true" tabindex="-1"></a><span class="co"># #"baseline category logit" model matches multinom()</span></span>
<span id="cb200-582"><a href="#cb200-582" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-583"><a href="#cb200-583" aria-hidden="true" tabindex="-1"></a><span class="co"># #check reference level </span></span>
<span id="cb200-584"><a href="#cb200-584" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Categories (first is reference)")</span></span>
<span id="cb200-585"><a href="#cb200-585" aria-hidden="true" tabindex="-1"></a><span class="co"># levels(df_i$state)</span></span>
<span id="cb200-586"><a href="#cb200-586" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-587"><a href="#cb200-587" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIT EMPTY MODEL</span></span>
<span id="cb200-588"><a href="#cb200-588" aria-hidden="true" tabindex="-1"></a><span class="co"># # print("EMPTY MODEL")</span></span>
<span id="cb200-589"><a href="#cb200-589" aria-hidden="true" tabindex="-1"></a><span class="co"># m.mbl0 &lt;- mblogit(state ~ pretty_condition ,  #no random intercepts; fixed only model </span></span>
<span id="cb200-590"><a href="#cb200-590" aria-hidden="true" tabindex="-1"></a><span class="co">#                   data = df_i)</span></span>
<span id="cb200-591"><a href="#cb200-591" aria-hidden="true" tabindex="-1"></a><span class="co"># #summary(m.mbl0)</span></span>
<span id="cb200-592"><a href="#cb200-592" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-593"><a href="#cb200-593" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIT PREDICTOR MODEL</span></span>
<span id="cb200-594"><a href="#cb200-594" aria-hidden="true" tabindex="-1"></a><span class="co"># # print("PREDICTOR MODEL")</span></span>
<span id="cb200-595"><a href="#cb200-595" aria-hidden="true" tabindex="-1"></a><span class="co"># m.mbl1 &lt;- mblogit(state ~ pretty_condition , </span></span>
<span id="cb200-596"><a href="#cb200-596" aria-hidden="true" tabindex="-1"></a><span class="co">#                   random = list( ~ 1|subject, ~1|q), </span></span>
<span id="cb200-597"><a href="#cb200-597" aria-hidden="true" tabindex="-1"></a><span class="co">#                   data = df_i)</span></span>
<span id="cb200-598"><a href="#cb200-598" aria-hidden="true" tabindex="-1"></a><span class="co"># # summary(m.mbl1)</span></span>
<span id="cb200-599"><a href="#cb200-599" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-600"><a href="#cb200-600" aria-hidden="true" tabindex="-1"></a><span class="co"># #COMPARE MODEL FIT</span></span>
<span id="cb200-601"><a href="#cb200-601" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("AIC wth predictor is lower than empty model?", AIC(m.mbl0) &gt; AIC(m.mbl1))</span></span>
<span id="cb200-602"><a href="#cb200-602" aria-hidden="true" tabindex="-1"></a><span class="co"># test_lrt(m.mbl0, m.mbl1)</span></span>
<span id="cb200-603"><a href="#cb200-603" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-604"><a href="#cb200-604" aria-hidden="true" tabindex="-1"></a><span class="co"># #DESCRIBE MODEL</span></span>
<span id="cb200-605"><a href="#cb200-605" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m.mbl1)</span></span>
<span id="cb200-606"><a href="#cb200-606" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-607"><a href="#cb200-607" aria-hidden="true" tabindex="-1"></a><span class="co"># #INTERPRET COEFFICIENTS</span></span>
<span id="cb200-608"><a href="#cb200-608" aria-hidden="true" tabindex="-1"></a><span class="co"># cint &lt;- confint(m.mbl1, level = 0.95)</span></span>
<span id="cb200-609"><a href="#cb200-609" aria-hidden="true" tabindex="-1"></a><span class="co"># print("ODDS RATIO")</span></span>
<span id="cb200-610"><a href="#cb200-610" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m.mbl1)), exp(cint))) #exponentiated, adjusted</span></span>
<span id="cb200-611"><a href="#cb200-611" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-612"><a href="#cb200-612" aria-hidden="true" tabindex="-1"></a><span class="co"># #PERFORMANCE</span></span>
<span id="cb200-613"><a href="#cb200-613" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m.mbl1)</span></span>
<span id="cb200-614"><a href="#cb200-614" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-615"><a href="#cb200-615" aria-hidden="true" tabindex="-1"></a><span class="co"># #TABLE</span></span>
<span id="cb200-616"><a href="#cb200-616" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m.mbl1, transform = "exp", title = "Model Predicted Odds Ratio")</span></span>
<span id="cb200-617"><a href="#cb200-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-618"><a href="#cb200-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-619"><a href="#cb200-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-620"><a href="#cb200-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-621"><a href="#cb200-621" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO Inference</span></span>
<span id="cb200-622"><a href="#cb200-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-623"><a href="#cb200-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-624"><a href="#cb200-624" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model \[brms\]</span></span>
<span id="cb200-625"><a href="#cb200-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-628"><a href="#cb200-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-629"><a href="#cb200-629" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-BRMS-STATE</span></span>
<span id="cb200-630"><a href="#cb200-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-631"><a href="#cb200-631" aria-hidden="true" tabindex="-1"></a><span class="co"># #HACK WD FOR LOCAL RUNNING?</span></span>
<span id="cb200-632"><a href="#cb200-632" aria-hidden="true" tabindex="-1"></a>imac <span class="ot">=</span> <span class="st">"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb200-633"><a href="#cb200-633" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(imac)</span>
<span id="cb200-634"><a href="#cb200-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-635"><a href="#cb200-635" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb200-636"><a href="#cb200-636" aria-hidden="true" tabindex="-1"></a>mm.cat.CrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb200-637"><a href="#cb200-637" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb200-638"><a href="#cb200-638" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb200-639"><a href="#cb200-639" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb200-640"><a href="#cb200-640" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb200-641"><a href="#cb200-641" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb200-642"><a href="#cb200-642" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4A/models/sgc4a_brms_mixedcat_state.rds"</span>)</span>
<span id="cb200-643"><a href="#cb200-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-644"><a href="#cb200-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-645"><a href="#cb200-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-648"><a href="#cb200-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-649"><a href="#cb200-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-BRMS-STATE</span></span>
<span id="cb200-650"><a href="#cb200-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-651"><a href="#cb200-651" aria-hidden="true" tabindex="-1"></a><span class="co">#set model </span></span>
<span id="cb200-652"><a href="#cb200-652" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.cat.CrSQ</span>
<span id="cb200-653"><a href="#cb200-653" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb200-654"><a href="#cb200-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-655"><a href="#cb200-655" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb200-656"><a href="#cb200-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-657"><a href="#cb200-657" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb200-658"><a href="#cb200-658" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red", </span></span>
<span id="cb200-659"><a href="#cb200-659" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb200-660"><a href="#cb200-660" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb200-661"><a href="#cb200-661" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.1, #manually adjust to account for directional test</span></span>
<span id="cb200-662"><a href="#cb200-662" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.90 ) + #manually adjusted for directional test   </span></span>
<span id="cb200-663"><a href="#cb200-663" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Model Estimate | Odds Ratio",</span></span>
<span id="cb200-664"><a href="#cb200-664" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "",</span></span>
<span id="cb200-665"><a href="#cb200-665" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition")</span></span>
<span id="cb200-666"><a href="#cb200-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-667"><a href="#cb200-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-668"><a href="#cb200-668" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb200-669"><a href="#cb200-669" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb200-670"><a href="#cb200-670" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-671"><a href="#cb200-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-672"><a href="#cb200-672" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- simulate_parameters(m)</span></span>
<span id="cb200-673"><a href="#cb200-673" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE)</span></span>
<span id="cb200-674"><a href="#cb200-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-675"><a href="#cb200-675" aria-hidden="true" tabindex="-1"></a><span class="co">#check posterior</span></span>
<span id="cb200-676"><a href="#cb200-676" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m, <span class="at">ndraws=</span><span class="dv">1000</span>)</span>
<span id="cb200-677"><a href="#cb200-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-678"><a href="#cb200-678" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb200-679"><a href="#cb200-679" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb200-680"><a href="#cb200-680" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-681"><a href="#cb200-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-682"><a href="#cb200-682" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb200-683"><a href="#cb200-683" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-684"><a href="#cb200-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-685"><a href="#cb200-685" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m)</span>
<span id="cb200-686"><a href="#cb200-686" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-687"><a href="#cb200-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-688"><a href="#cb200-688" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb200-689"><a href="#cb200-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-690"><a href="#cb200-690" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb200-691"><a href="#cb200-691" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="eff",</span></span>
<span id="cb200-692"><a href="#cb200-692" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb200-693"><a href="#cb200-693" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb200-694"><a href="#cb200-694" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb200-695"><a href="#cb200-695" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb200-696"><a href="#cb200-696" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-697"><a href="#cb200-697" aria-hidden="true" tabindex="-1"></a><span class="co"># #PLOT MODEL PREDICTION</span></span>
<span id="cb200-698"><a href="#cb200-698" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)</span>
<span id="cb200-699"><a href="#cb200-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-700"><a href="#cb200-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-701"><a href="#cb200-701" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb200-702"><a href="#cb200-702" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb200-703"><a href="#cb200-703" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m)</span></span>
<span id="cb200-704"><a href="#cb200-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-705"><a href="#cb200-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-706"><a href="#cb200-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-707"><a href="#cb200-707" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO Inference</span></span>
<span id="cb200-708"><a href="#cb200-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-709"><a href="#cb200-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-710"><a href="#cb200-710" aria-hidden="true" tabindex="-1"></a><span class="fu">##### COMPARE</span></span>
<span id="cb200-711"><a href="#cb200-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-714"><a href="#cb200-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-715"><a href="#cb200-715" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: COMPARE-STATE-MODELS</span></span>
<span id="cb200-716"><a href="#cb200-716" aria-hidden="true" tabindex="-1"></a><span class="co"># compare_models(m.mbl1, mm.cat.CrSQ)</span></span>
<span id="cb200-717"><a href="#cb200-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-718"><a href="#cb200-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-719"><a href="#cb200-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-720"><a href="#cb200-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-721"><a href="#cb200-721" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1B \| Q1 ACCURACY</span></span>
<span id="cb200-722"><a href="#cb200-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-723"><a href="#cb200-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-724"><a href="#cb200-724" aria-hidden="true" tabindex="-1"></a>The graph comprehension task includes 15 questions completed in sequence. But the first question the reader encounters (Q1) is the most important, as it is their *first exposure* to the unconventional triangular coordinate system.</span>
<span id="cb200-725"><a href="#cb200-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-726"><a href="#cb200-726" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-727"><a href="#cb200-727" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does the frequency of correct (vs) incorrect responses on the first question differ by condition? <span class="sc">\[</span>Is response accuracy independent of condition?<span class="sc">\]</span>                                                                                   |</span>
<span id="cb200-728"><a href="#cb200-728" aria-hidden="true" tabindex="-1"></a>+=======================+========================================================================================================================================================================================================================================+</span>
<span id="cb200-729"><a href="#cb200-729" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the TRI condition will have a higher likelihood of correctly responding to the first question than those in the CONTROL condition                                                                                     |</span>
<span id="cb200-730"><a href="#cb200-730" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-731"><a href="#cb200-731" aria-hidden="true" tabindex="-1"></a>| **Data**              | -   data: <span class="in">`df_items`</span> where <span class="in">`q == 1`</span>                                                                                                                                                                                                    |</span>
<span id="cb200-732"><a href="#cb200-732" aria-hidden="true" tabindex="-1"></a>|                       | -   outcome: *accuracy* ( factor(incorrect/correct) from <span class="in">`score_niceABS`</span> <span class="sc">\[</span>absolute score<span class="sc">\]</span>                                                                                                                                            |</span>
<span id="cb200-733"><a href="#cb200-733" aria-hidden="true" tabindex="-1"></a>|                       | -   predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                                                                                                 |</span>
<span id="cb200-734"><a href="#cb200-734" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-735"><a href="#cb200-735" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Logistic Regression on <span class="in">`accuracy`</span> predicted by <span class="in">`condition`</span>                                                                                                                                                                         |</span>
<span id="cb200-736"><a href="#cb200-736" aria-hidden="true" tabindex="-1"></a>|                       |     -   account for difference in odds of correct score by condition                                                                                                                                                                   |</span>
<span id="cb200-737"><a href="#cb200-737" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb200-738"><a href="#cb200-738" aria-hidden="true" tabindex="-1"></a>|                       | Alternatives:                                                                                                                                                                                                                          |</span>
<span id="cb200-739"><a href="#cb200-739" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb200-740"><a href="#cb200-740" aria-hidden="true" tabindex="-1"></a>|                       | -   Chi-Square test of independence on outcome <span class="in">`accuracy`</span> by <span class="in">`condition`</span>                                                                                                                                                               |</span>
<span id="cb200-741"><a href="#cb200-741" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-742"><a href="#cb200-742" aria-hidden="true" tabindex="-1"></a>| **Notes**             | -   CHIQ SQR is simplest method to examine independence of two categorical factors; LOGISTIC REGRESSION is recommended for binomial \~ continuous; though with regression we can quantify the size of the effect and overall model fit |</span>
<span id="cb200-743"><a href="#cb200-743" aria-hidden="true" tabindex="-1"></a>|                       | -   independence assumption : (CHI SQR) as we only consider responses on the first question, each observation corresponds to an individual subject, and are thus independent                                                           |</span>
<span id="cb200-744"><a href="#cb200-744" aria-hidden="true" tabindex="-1"></a>|                       | -   cell frequency : (CHI SQR) expected frequency in each cell of the contingency table is greater than 5 (more than 5 correct , more than 5 incorrect responses)                                                                      |</span>
<span id="cb200-745"><a href="#cb200-745" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-746"><a href="#cb200-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-747"><a href="#cb200-747" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb200-750"><a href="#cb200-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-751"><a href="#cb200-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1ACC</span></span>
<span id="cb200-752"><a href="#cb200-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-753"><a href="#cb200-753" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb200-754"><a href="#cb200-754" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy, pretty_condition)</span>
<span id="cb200-755"><a href="#cb200-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-756"><a href="#cb200-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-757"><a href="#cb200-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-758"><a href="#cb200-758" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe </span></span>
<span id="cb200-761"><a href="#cb200-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-762"><a href="#cb200-762" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-Q1ACC</span></span>
<span id="cb200-763"><a href="#cb200-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-764"><a href="#cb200-764" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb200-765"><a href="#cb200-765" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb200-766"><a href="#cb200-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-767"><a href="#cb200-767" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb200-768"><a href="#cb200-768" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb200-769"><a href="#cb200-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-770"><a href="#cb200-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb200-771"><a href="#cb200-771" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb200-772"><a href="#cb200-772" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb200-773"><a href="#cb200-773" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Accuracy"</span>,</span>
<span id="cb200-774"><a href="#cb200-774" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-775"><a href="#cb200-775" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-776"><a href="#cb200-776" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb200-777"><a href="#cb200-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-778"><a href="#cb200-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-779"><a href="#cb200-779" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: BARSTATS</span></span>
<span id="cb200-780"><a href="#cb200-780" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>( <span class="at">data =</span> df, <span class="at">y =</span> pretty_condition, <span class="at">x =</span> accuracy)</span>
<span id="cb200-781"><a href="#cb200-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-782"><a href="#cb200-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-783"><a href="#cb200-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-784"><a href="#cb200-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-787"><a href="#cb200-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-788"><a href="#cb200-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-Q1ACC</span></span>
<span id="cb200-789"><a href="#cb200-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-790"><a href="#cb200-790" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb200-791"><a href="#cb200-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-792"><a href="#cb200-792" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Proportions of Correct Responses by Condition"</span>)</span>
<span id="cb200-793"><a href="#cb200-793" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb200-794"><a href="#cb200-794" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb200-795"><a href="#cb200-795" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb200-796"><a href="#cb200-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-797"><a href="#cb200-797" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Number of Correct Responses by Condition"</span>)</span>
<span id="cb200-798"><a href="#cb200-798" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb200-799"><a href="#cb200-799" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb200-800"><a href="#cb200-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-801"><a href="#cb200-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-802"><a href="#cb200-802" aria-hidden="true" tabindex="-1"></a><span class="fu">#### LOGISTIC REGRESSION</span></span>
<span id="cb200-803"><a href="#cb200-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-804"><a href="#cb200-804" aria-hidden="true" tabindex="-1"></a>Fit a logistic regression predicting accuracy (absolute score) (n = <span class="in">`r nrow(df)`</span>) by condition (k = 2).\</span>
<span id="cb200-805"><a href="#cb200-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-806"><a href="#cb200-806" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{0}$ = Log Odds of (correct) responses in CONTROL condition</span>
<span id="cb200-807"><a href="#cb200-807" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$e^{\beta_{0}}$ = ODDS of correct response in CONTROL condition</span>
<span id="cb200-808"><a href="#cb200-808" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{1}$ = $\beta_{1impasse}$ Log Odds (Log OR; change in odds for correct response in impasse (vs) control <span class="sc">\[</span>log scale<span class="sc">\]</span>)</span>
<span id="cb200-809"><a href="#cb200-809" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$e^{\beta_{1}}$ = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</span>
<span id="cb200-810"><a href="#cb200-810" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Null hypothesis**:$\beta_{impasse} \le 0$ the odds for a correct response does not change, or decreases</span>
<span id="cb200-811"><a href="#cb200-811" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Alternative hypothesis:** $\beta_{impasse} \gt 0$ the odds of a correct response increases</span>
<span id="cb200-812"><a href="#cb200-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-813"><a href="#cb200-813" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb200-814"><a href="#cb200-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-815"><a href="#cb200-815" aria-hidden="true" tabindex="-1"></a>*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*</span>
<span id="cb200-816"><a href="#cb200-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-819"><a href="#cb200-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-820"><a href="#cb200-820" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-FIT-Q1ACC</span></span>
<span id="cb200-821"><a href="#cb200-821" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb200-822"><a href="#cb200-822" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb200-823"><a href="#cb200-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-824"><a href="#cb200-824" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING ::::::::</span></span>
<span id="cb200-825"><a href="#cb200-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-826"><a href="#cb200-826" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb200-827"><a href="#cb200-827" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb200-828"><a href="#cb200-828" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb200-829"><a href="#cb200-829" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb200-830"><a href="#cb200-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-831"><a href="#cb200-831" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb200-832"><a href="#cb200-832" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb200-833"><a href="#cb200-833" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb200-834"><a href="#cb200-834" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb200-835"><a href="#cb200-835" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m1)</span>
<span id="cb200-836"><a href="#cb200-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-837"><a href="#cb200-837" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb200-838"><a href="#cb200-838" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span>
<span id="cb200-839"><a href="#cb200-839" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb200-840"><a href="#cb200-840" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb200-841"><a href="#cb200-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-842"><a href="#cb200-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-843"><a href="#cb200-843" aria-hidden="true" tabindex="-1"></a>*The Condition predictor decreases AIC, but the Likelihood Ratio Test is marginal. We proceed to examine the predictor model, as we plan to do a 1-tailed NHST .*</span>
<span id="cb200-844"><a href="#cb200-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-845"><a href="#cb200-845" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb200-846"><a href="#cb200-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-849"><a href="#cb200-849" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-850"><a href="#cb200-850" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-Q1ACC</span></span>
<span id="cb200-851"><a href="#cb200-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-852"><a href="#cb200-852" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb200-853"><a href="#cb200-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-854"><a href="#cb200-854" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL [default two-tailed sig test]"</span>)</span>
<span id="cb200-855"><a href="#cb200-855" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb200-856"><a href="#cb200-856" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m1)</span>
<span id="cb200-857"><a href="#cb200-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-858"><a href="#cb200-858" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb200-859"><a href="#cb200-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-860"><a href="#cb200-860" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb200-861"><a href="#cb200-861" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb200-862"><a href="#cb200-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-863"><a href="#cb200-863" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb200-864"><a href="#cb200-864" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb200-865"><a href="#cb200-865" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"p value for two-tailed test, null B = 0 : "</span>,<span class="fu">round</span>(tt,<span class="dv">3</span>))</span>
<span id="cb200-866"><a href="#cb200-866" aria-hidden="true" tabindex="-1"></a>ot <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb200-867"><a href="#cb200-867" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"BUT we want a one tailed directional, null: B &lt;= 0: "</span>,<span class="fu">round</span>(ot,<span class="dv">3</span>))</span>
<span id="cb200-868"><a href="#cb200-868" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"adjusted confint for directional hypothesis"</span>)</span>
<span id="cb200-869"><a href="#cb200-869" aria-hidden="true" tabindex="-1"></a>(dcint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1, <span class="at">level =</span> <span class="fl">0.90</span>)) <span class="co"># get 90% for right side))</span></span>
<span id="cb200-870"><a href="#cb200-870" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb200-871"><a href="#cb200-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-872"><a href="#cb200-872" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb200-873"><a href="#cb200-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-874"><a href="#cb200-874" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval —- LOG ODDS")</span></span>
<span id="cb200-875"><a href="#cb200-875" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb200-876"><a href="#cb200-876" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span>
<span id="cb200-877"><a href="#cb200-877" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(confint(m1)))) #exponentiated, not adjusted</span></span>
<span id="cb200-878"><a href="#cb200-878" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(dcint))) <span class="co">#exponentiated, adjusted</span></span>
<span id="cb200-879"><a href="#cb200-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-880"><a href="#cb200-880" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span>
<span id="cb200-881"><a href="#cb200-881" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb200-882"><a href="#cb200-882" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb200-883"><a href="#cb200-883" aria-hidden="true" tabindex="-1"></a><span class="co"># pred.control &lt;- predict(m1,data.frame(pretty_condition="control"),type="response")</span></span>
<span id="cb200-884"><a href="#cb200-884" aria-hidden="true" tabindex="-1"></a><span class="co"># #this should match : plogis(intercept coefficient)</span></span>
<span id="cb200-885"><a href="#cb200-885" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Probability of success in control,", pred.control)</span></span>
<span id="cb200-886"><a href="#cb200-886" aria-hidden="true" tabindex="-1"></a><span class="co"># pred.impasse &lt;- predict(m1,data.frame(pretty_condition="impasse"),type="response")</span></span>
<span id="cb200-887"><a href="#cb200-887" aria-hidden="true" tabindex="-1"></a><span class="co"># #this should match : plogis(intercept coefficient + predictor coeff)</span></span>
<span id="cb200-888"><a href="#cb200-888" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Probability of success in impasse,", pred.impasse)</span></span>
<span id="cb200-889"><a href="#cb200-889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-890"><a href="#cb200-890" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO Inference</span></span>
<span id="cb200-891"><a href="#cb200-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-892"><a href="#cb200-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-893"><a href="#cb200-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-894"><a href="#cb200-894" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb200-895"><a href="#cb200-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-898"><a href="#cb200-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-899"><a href="#cb200-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-Q1ACC</span></span>
<span id="cb200-900"><a href="#cb200-900" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb200-901"><a href="#cb200-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb200-902"><a href="#cb200-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-903"><a href="#cb200-903" aria-hidden="true" tabindex="-1"></a><span class="co">#SET MODEL</span></span>
<span id="cb200-904"><a href="#cb200-904" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m1</span>
<span id="cb200-905"><a href="#cb200-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-906"><a href="#cb200-906" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb200-907"><a href="#cb200-907" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb200-908"><a href="#cb200-908" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb200-909"><a href="#cb200-909" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb200-910"><a href="#cb200-910" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb200-911"><a href="#cb200-911" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb200-912"><a href="#cb200-912" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb200-913"><a href="#cb200-913" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb200-914"><a href="#cb200-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span> <span class="co">#remove to put on log scale x axis </span></span>
<span id="cb200-915"><a href="#cb200-915" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c("control","impasse"))+</span></span>
<span id="cb200-916"><a href="#cb200-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb200-917"><a href="#cb200-917" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb200-918"><a href="#cb200-918" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb200-919"><a href="#cb200-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-920"><a href="#cb200-920" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-921"><a href="#cb200-921" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb200-922"><a href="#cb200-922" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"pred"</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb200-923"><a href="#cb200-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="co">#scale y axis to actual range</span></span>
<span id="cb200-924"><a href="#cb200-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL PREDICTION  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb200-925"><a href="#cb200-925" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of correct response on Q1"</span>,</span>
<span id="cb200-926"><a href="#cb200-926" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb200-927"><a href="#cb200-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-928"><a href="#cb200-928" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-929"><a href="#cb200-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-932"><a href="#cb200-932" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-933"><a href="#cb200-933" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-Q1ACC</span></span>
<span id="cb200-934"><a href="#cb200-934" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb200-935"><a href="#cb200-935" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb200-936"><a href="#cb200-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-937"><a href="#cb200-937" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb200-938"><a href="#cb200-938" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb200-939"><a href="#cb200-939" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb200-940"><a href="#cb200-940" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb200-941"><a href="#cb200-941" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb200-942"><a href="#cb200-942" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-943"><a href="#cb200-943" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb200-944"><a href="#cb200-944" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb200-945"><a href="#cb200-945" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb200-946"><a href="#cb200-946" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb200-947"><a href="#cb200-947" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb200-948"><a href="#cb200-948" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb200-949"><a href="#cb200-949" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb200-950"><a href="#cb200-950" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb200-951"><a href="#cb200-951" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb200-952"><a href="#cb200-952" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb200-953"><a href="#cb200-953" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb200-954"><a href="#cb200-954" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb200-955"><a href="#cb200-955" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb200-956"><a href="#cb200-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-957"><a href="#cb200-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-958"><a href="#cb200-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-959"><a href="#cb200-959" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb200-960"><a href="#cb200-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-963"><a href="#cb200-963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-964"><a href="#cb200-964" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DIAG-Q1ACC</span></span>
<span id="cb200-965"><a href="#cb200-965" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb200-966"><a href="#cb200-966" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb200-967"><a href="#cb200-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-968"><a href="#cb200-968" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb200-969"><a href="#cb200-969" aria-hidden="true" tabindex="-1"></a><span class="co"># report::report(m)</span></span>
<span id="cb200-970"><a href="#cb200-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-971"><a href="#cb200-971" aria-hidden="true" tabindex="-1"></a><span class="co">#print("MODEL PERFORMANCE")</span></span>
<span id="cb200-972"><a href="#cb200-972" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb200-973"><a href="#cb200-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-974"><a href="#cb200-974" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span>
<span id="cb200-975"><a href="#cb200-975" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span>
<span id="cb200-976"><a href="#cb200-976" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-977"><a href="#cb200-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-978"><a href="#cb200-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-979"><a href="#cb200-979" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1B \| Q1 INTERPRETATION STATE</span></span>
<span id="cb200-980"><a href="#cb200-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-981"><a href="#cb200-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-982"><a href="#cb200-982" aria-hidden="true" tabindex="-1"></a>While absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesn't allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subject's response, and determine if these interpretations differ by experimental condition. State is a 3-category derived response variable that groups the following interpretations:</span>
<span id="cb200-983"><a href="#cb200-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-984"><a href="#cb200-984" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"orthogonal"** <span class="sc">\[</span>reference category<span class="sc">\]</span> includes orthogonal and satisficing responses ==<span class="sc">\&gt;</span> indicates a primarily *orthogonal* state of coordinate system understanding</span>
<span id="cb200-985"><a href="#cb200-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-986"><a href="#cb200-986" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"other"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =<span class="sc">\&gt;</span> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular</span>
<span id="cb200-987"><a href="#cb200-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-988"><a href="#cb200-988" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"angular"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb200-989"><a href="#cb200-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-990"><a href="#cb200-990" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"triangular"** includes correct triangular and 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb200-991"><a href="#cb200-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-992"><a href="#cb200-992" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-993"><a href="#cb200-993" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does Ss in the impasse condition produce less orthogonal responses on the first question?                                                                                                                                                                                                                                                                 |</span>
<span id="cb200-994"><a href="#cb200-994" aria-hidden="true" tabindex="-1"></a>+=======================+===========================================================================================================================================================================================================================================================================================================================================================+</span>
<span id="cb200-995"><a href="#cb200-995" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the IMPASSE condition will have a higher likelihood of producing unknown and and triangle-like response states, relative to orthogonal response states, on the first question                                                                                                                                                                |</span>
<span id="cb200-996"><a href="#cb200-996" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-997"><a href="#cb200-997" aria-hidden="true" tabindex="-1"></a>| **Data**              | -   data: <span class="in">`df_items`</span> where <span class="in">`q == 1`</span>                                                                                                                                                                                                                                                                                                                       |</span>
<span id="cb200-998"><a href="#cb200-998" aria-hidden="true" tabindex="-1"></a>|                       | -   outcome: <span class="in">`state`</span> ( 4 level factor from 5 level high_interpretation )                                                                                                                                                                                                                                                                                  |</span>
<span id="cb200-999"><a href="#cb200-999" aria-hidden="true" tabindex="-1"></a>|                       | -   predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                                                                                                                                                                                                                    |</span>
<span id="cb200-1000"><a href="#cb200-1000" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-1001"><a href="#cb200-1001" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Multinomial (Logistic) Regression on state predicted by condition                                                                                                                                                                                                                                                                                     |</span>
<span id="cb200-1002"><a href="#cb200-1002" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                                                                                           |</span>
<span id="cb200-1003"><a href="#cb200-1003" aria-hidden="true" tabindex="-1"></a>|                       | Alternative:                                                                                                                                                                                                                                                                                                                                              |</span>
<span id="cb200-1004"><a href="#cb200-1004" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                                                                                           |</span>
<span id="cb200-1005"><a href="#cb200-1005" aria-hidden="true" tabindex="-1"></a>|                       | -   Ordinal regression on state; but model doesn't satisfy proportional odds assumption (parallel slopes)                                                                                                                                                                                                                                                 |</span>
<span id="cb200-1006"><a href="#cb200-1006" aria-hidden="true" tabindex="-1"></a>|                       | -   Multinomial or Ordinal regression on high_interpretation (5 category interpretation state which distinguishes between uncertain (blank, reference) unclassifiable, triangle-like and true triangular.) There are some cells with zeros, however (no uncertain responses in control) which means the model can't accurately estimate those comparisons |</span>
<span id="cb200-1007"><a href="#cb200-1007" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb200-1008"><a href="#cb200-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1009"><a href="#cb200-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup </span></span>
<span id="cb200-1012"><a href="#cb200-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1013"><a href="#cb200-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1STATE</span></span>
<span id="cb200-1014"><a href="#cb200-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1015"><a href="#cb200-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb200-1016"><a href="#cb200-1016" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, state)</span>
<span id="cb200-1017"><a href="#cb200-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1018"><a href="#cb200-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1019"><a href="#cb200-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1020"><a href="#cb200-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1021"><a href="#cb200-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe </span></span>
<span id="cb200-1024"><a href="#cb200-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1025"><a href="#cb200-1025" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-Q1STATE</span></span>
<span id="cb200-1026"><a href="#cb200-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1027"><a href="#cb200-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb200-1028"><a href="#cb200-1028" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb200-1029"><a href="#cb200-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-1030"><a href="#cb200-1030" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb200-1031"><a href="#cb200-1031" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb200-1032"><a href="#cb200-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-1033"><a href="#cb200-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb200-1034"><a href="#cb200-1034" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb200-1035"><a href="#cb200-1035" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb200-1036"><a href="#cb200-1036" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb200-1037"><a href="#cb200-1037" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-1038"><a href="#cb200-1038" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-1039"><a href="#cb200-1039" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb200-1040"><a href="#cb200-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1041"><a href="#cb200-1041" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: BARSTATS</span></span>
<span id="cb200-1042"><a href="#cb200-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>( <span class="at">data =</span> df, <span class="at">y =</span> pretty_condition, <span class="at">x =</span> state)</span>
<span id="cb200-1043"><a href="#cb200-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1044"><a href="#cb200-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1045"><a href="#cb200-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1046"><a href="#cb200-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1047"><a href="#cb200-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1050"><a href="#cb200-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1051"><a href="#cb200-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-Q1STATE</span></span>
<span id="cb200-1052"><a href="#cb200-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1053"><a href="#cb200-1053" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb200-1054"><a href="#cb200-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1055"><a href="#cb200-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb200-1056"><a href="#cb200-1056" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb200-1057"><a href="#cb200-1057" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb200-1058"><a href="#cb200-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1059"><a href="#cb200-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1060"><a href="#cb200-1060" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb200-1061"><a href="#cb200-1061" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb200-1062"><a href="#cb200-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1063"><a href="#cb200-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1064"><a href="#cb200-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1065"><a href="#cb200-1065" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MULTINOMIAL REGRESSION</span></span>
<span id="cb200-1066"><a href="#cb200-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1067"><a href="#cb200-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1068"><a href="#cb200-1068" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb200-1069"><a href="#cb200-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1072"><a href="#cb200-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1073"><a href="#cb200-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-FIT-Q1STATE</span></span>
<span id="cb200-1074"><a href="#cb200-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1075"><a href="#cb200-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb200-1076"><a href="#cb200-1076" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span>
<span id="cb200-1077"><a href="#cb200-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span>
<span id="cb200-1078"><a href="#cb200-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1079"><a href="#cb200-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb200-1080"><a href="#cb200-1080" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb200-1081"><a href="#cb200-1081" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb200-1082"><a href="#cb200-1082" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb200-1083"><a href="#cb200-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1084"><a href="#cb200-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb200-1085"><a href="#cb200-1085" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb200-1086"><a href="#cb200-1086" aria-hidden="true" tabindex="-1"></a>catm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-1087"><a href="#cb200-1087" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm)</span></span>
<span id="cb200-1088"><a href="#cb200-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1089"><a href="#cb200-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb200-1090"><a href="#cb200-1090" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, catm<span class="fl">.0</span><span class="sc">$</span>AIC <span class="sc">&gt;</span> catm<span class="sc">$</span>AIC)</span>
<span id="cb200-1091"><a href="#cb200-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm)</span>
<span id="cb200-1092"><a href="#cb200-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1093"><a href="#cb200-1093" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb200-1094"><a href="#cb200-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb200-1095"><a href="#cb200-1095" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state2 ~ pretty_condition, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb200-1096"><a href="#cb200-1096" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb200-1097"><a href="#cb200-1097" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat)</span></span>
<span id="cb200-1098"><a href="#cb200-1098" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb200-1099"><a href="#cb200-1099" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb200-1100"><a href="#cb200-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1101"><a href="#cb200-1101" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb200-1102"><a href="#cb200-1102" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb200-1103"><a href="#cb200-1103" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb200-1104"><a href="#cb200-1104" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state2 ~ pretty_condition , data = df)</span></span>
<span id="cb200-1105"><a href="#cb200-1105" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb200-1106"><a href="#cb200-1106" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span>
<span id="cb200-1107"><a href="#cb200-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1108"><a href="#cb200-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1109"><a href="#cb200-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1110"><a href="#cb200-1110" aria-hidden="true" tabindex="-1"></a>*AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*</span>
<span id="cb200-1111"><a href="#cb200-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1112"><a href="#cb200-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb200-1113"><a href="#cb200-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1116"><a href="#cb200-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1117"><a href="#cb200-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-Q1STATE</span></span>
<span id="cb200-1118"><a href="#cb200-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1119"><a href="#cb200-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb200-1120"><a href="#cb200-1120" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> catm</span>
<span id="cb200-1121"><a href="#cb200-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1122"><a href="#cb200-1122" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb200-1123"><a href="#cb200-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span>
<span id="cb200-1124"><a href="#cb200-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb200-1125"><a href="#cb200-1125" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m)</span>
<span id="cb200-1126"><a href="#cb200-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1127"><a href="#cb200-1127" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb200-1128"><a href="#cb200-1128" aria-hidden="true" tabindex="-1"></a>z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(m)<span class="sc">$</span>standard.errors</span>
<span id="cb200-1129"><a href="#cb200-1129" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb200-1130"><a href="#cb200-1130" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb200-1131"><a href="#cb200-1131" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb200-1132"><a href="#cb200-1132" aria-hidden="true" tabindex="-1"></a>(p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values)))</span>
<span id="cb200-1133"><a href="#cb200-1133" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb200-1134"><a href="#cb200-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1135"><a href="#cb200-1135" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb200-1136"><a href="#cb200-1136" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>coefficients))</span>
<span id="cb200-1137"><a href="#cb200-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb200-1138"><a href="#cb200-1138" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span>
<span id="cb200-1139"><a href="#cb200-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1140"><a href="#cb200-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1141"><a href="#cb200-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO Inference</span></span>
<span id="cb200-1142"><a href="#cb200-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1143"><a href="#cb200-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1144"><a href="#cb200-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb200-1145"><a href="#cb200-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1148"><a href="#cb200-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1149"><a href="#cb200-1149" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-Q1STATE</span></span>
<span id="cb200-1150"><a href="#cb200-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1151"><a href="#cb200-1151" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb200-1152"><a href="#cb200-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1153"><a href="#cb200-1153" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb200-1154"><a href="#cb200-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb200-1155"><a href="#cb200-1155" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb200-1156"><a href="#cb200-1156" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb200-1157"><a href="#cb200-1157" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb200-1158"><a href="#cb200-1158" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb200-1159"><a href="#cb200-1159" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb200-1160"><a href="#cb200-1160" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb200-1161"><a href="#cb200-1161" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() + #remove to put on log scale x axis </span></span>
<span id="cb200-1162"><a href="#cb200-1162" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c("control","impasse"))+</span></span>
<span id="cb200-1163"><a href="#cb200-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb200-1164"><a href="#cb200-1164" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb200-1165"><a href="#cb200-1165" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb200-1166"><a href="#cb200-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1167"><a href="#cb200-1167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-1168"><a href="#cb200-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb200-1169"><a href="#cb200-1169" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb200-1170"><a href="#cb200-1170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb200-1171"><a href="#cb200-1171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL PREDICTION  | Q1 State ~ condition"</span>,</span>
<span id="cb200-1172"><a href="#cb200-1172" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of more accurate response states Q1"</span>,</span>
<span id="cb200-1173"><a href="#cb200-1173" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb200-1174"><a href="#cb200-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1175"><a href="#cb200-1175" aria-hidden="true" tabindex="-1"></a><span class="co"># #MANUALLY BUILD PREDICTION PLOT FACET BY CONDITION RATHER THAN STATE</span></span>
<span id="cb200-1176"><a href="#cb200-1176" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;-plot_model(m, type="eff")[[1]]</span></span>
<span id="cb200-1177"><a href="#cb200-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- ggplot_build(p)[[1]]  </span></span>
<span id="cb200-1178"><a href="#cb200-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># points &lt;- d[[2]]</span></span>
<span id="cb200-1179"><a href="#cb200-1179" aria-hidden="true" tabindex="-1"></a><span class="co"># points &lt;- points %&gt;% mutate(</span></span>
<span id="cb200-1180"><a href="#cb200-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#   state = recode(PANEL, "1" ="orth", "2"="other", "3" = "trilike", "4"="tri"),</span></span>
<span id="cb200-1181"><a href="#cb200-1181" aria-hidden="true" tabindex="-1"></a><span class="co">#   condition = recode(x, "1"="control","2"="impasse"),</span></span>
<span id="cb200-1182"><a href="#cb200-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#   prob = y</span></span>
<span id="cb200-1183"><a href="#cb200-1183" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb200-1184"><a href="#cb200-1184" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_point( prob ~ state, group = ~x, data = points) + </span></span>
<span id="cb200-1185"><a href="#cb200-1185" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_errorbar(aes( x = state, ymin = ymin, ymax = ymax)) + facet_grid(~condition) +ylim(0,1)</span></span>
<span id="cb200-1186"><a href="#cb200-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1187"><a href="#cb200-1187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1188"><a href="#cb200-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1191"><a href="#cb200-1191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1192"><a href="#cb200-1192" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-Q1STATE</span></span>
<span id="cb200-1193"><a href="#cb200-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1194"><a href="#cb200-1194" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb200-1195"><a href="#cb200-1195" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb200-1196"><a href="#cb200-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1197"><a href="#cb200-1197" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb200-1198"><a href="#cb200-1198" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb200-1199"><a href="#cb200-1199" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb200-1200"><a href="#cb200-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb200-1201"><a href="#cb200-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb200-1202"><a href="#cb200-1202" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-1203"><a href="#cb200-1203" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb200-1204"><a href="#cb200-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb200-1205"><a href="#cb200-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb200-1206"><a href="#cb200-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb200-1207"><a href="#cb200-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb200-1208"><a href="#cb200-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb200-1209"><a href="#cb200-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb200-1210"><a href="#cb200-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb200-1211"><a href="#cb200-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb200-1212"><a href="#cb200-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb200-1213"><a href="#cb200-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb200-1214"><a href="#cb200-1214" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb200-1215"><a href="#cb200-1215" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb200-1216"><a href="#cb200-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1217"><a href="#cb200-1217" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(mixcat.1, s)</span></span>
<span id="cb200-1218"><a href="#cb200-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb200-1219"><a href="#cb200-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb200-1220"><a href="#cb200-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1221"><a href="#cb200-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1222"><a href="#cb200-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1223"><a href="#cb200-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1224"><a href="#cb200-1224" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb200-1225"><a href="#cb200-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1228"><a href="#cb200-1228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1229"><a href="#cb200-1229" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DIAG-Q1STATE</span></span>
<span id="cb200-1230"><a href="#cb200-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1231"><a href="#cb200-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb200-1232"><a href="#cb200-1232" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb200-1233"><a href="#cb200-1233" aria-hidden="true" tabindex="-1"></a><span class="co"># test &lt;- data.frame(pretty_condition = c("control", "impasse"))</span></span>
<span id="cb200-1234"><a href="#cb200-1234" aria-hidden="true" tabindex="-1"></a><span class="co"># pred &lt;- predict(catm, newdata = test, "probs")</span></span>
<span id="cb200-1235"><a href="#cb200-1235" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Predicted Probability of Being in Each State")</span></span>
<span id="cb200-1236"><a href="#cb200-1236" aria-hidden="true" tabindex="-1"></a><span class="co"># ( x &lt;- cbind(test, pred))</span></span>
<span id="cb200-1237"><a href="#cb200-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1238"><a href="#cb200-1238" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb200-1239"><a href="#cb200-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(catm)</span>
<span id="cb200-1240"><a href="#cb200-1240" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(catm, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span>
<span id="cb200-1241"><a href="#cb200-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1242"><a href="#cb200-1242" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb200-1243"><a href="#cb200-1243" aria-hidden="true" tabindex="-1"></a><span class="co">#library(generalhoslem)</span></span>
<span id="cb200-1244"><a href="#cb200-1244" aria-hidden="true" tabindex="-1"></a><span class="co">#logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb200-1245"><a href="#cb200-1245" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb200-1246"><a href="#cb200-1246" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb200-1247"><a href="#cb200-1247" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.test(df$state, predict(catm)) #actual states VS predicted states</span></span>
<span id="cb200-1248"><a href="#cb200-1248" aria-hidden="true" tabindex="-1"></a><span class="co"># The chi-square test tests the decrease in unexplained variance from the baseline model to the final model</span></span>
<span id="cb200-1249"><a href="#cb200-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1250"><a href="#cb200-1250" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL DIAGNOSTICS")</span></span>
<span id="cb200-1251"><a href="#cb200-1251" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m) can't do overall diagnostics, have to do them on individual model equations</span></span>
<span id="cb200-1252"><a href="#cb200-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1253"><a href="#cb200-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>