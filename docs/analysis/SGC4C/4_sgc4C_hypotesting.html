<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.328">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SGC-X - 20&nbsp; Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../analysis/SGC4D/1_sgc4D_introduction.html" rel="next">
<link href="../../analysis/SGC4C/2_sgc4C_scoring.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC2</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/3_sgc2_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/4_sgc2_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_lab_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">SGC3A (Lab) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SGC3A (Replication) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_ospan_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">SGC3 (OSPAN) Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/4_sgc3B_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">SGC3B (Impasse * Explicit) Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/3_sgc4A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">SGC4C</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/1_sgc4C_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/2_sgc4C_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/4_sgc4C_hypotesting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">SGC4D</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4D/1_sgc4D_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4D/2_sgc4D_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4D/4_sgc4D_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sample" id="toc-sample" class="nav-link active" data-scroll-target="#sample">SAMPLE</a>
  <ul class="collapse">
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">Data Collection</a></li>
  <li><a href="#participants" id="toc-participants" class="nav-link" data-scroll-target="#participants">Participants</a></li>
  </ul></li>
  <li><a href="#overall-accuracy" id="toc-overall-accuracy" class="nav-link" data-scroll-target="#overall-accuracy">OVERALL ACCURACY</a>
  <ul class="collapse">
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a>
  <ul class="collapse">
  <li><a href="#explore" id="toc-explore" class="nav-link" data-scroll-target="#explore">Explore</a></li>
  <li><a href="#present" id="toc-present" class="nav-link" data-scroll-target="#present">Present</a></li>
  </ul></li>
  <li><a href="#describe" id="toc-describe" class="nav-link" data-scroll-target="#describe">Describe</a>
  <ul class="collapse">
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests">TESTS</a>
  <ul class="collapse">
  <li><a href="#aligned-ranks-transformation" id="toc-aligned-ranks-transformation" class="nav-link" data-scroll-target="#aligned-ranks-transformation">Aligned Ranks Transformation</a></li>
  <li><a href="#kruskal-wallis-test" id="toc-kruskal-wallis-test" class="nav-link" data-scroll-target="#kruskal-wallis-test">Kruskal Wallis Test</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  </ul></li>
  <li><a href="#mixed-logistic-regression" id="toc-mixed-logistic-regression" class="nav-link" data-scroll-target="#mixed-logistic-regression">MIXED LOGISTIC REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#describe-1" id="toc-describe-1" class="nav-link" data-scroll-target="#describe-1">Describe</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">INFERENCE</a></li>
  <li><a href="#marginal-effects" id="toc-marginal-effects" class="nav-link" data-scroll-target="#marginal-effects">Marginal Effects</a></li>
  <li><a href="#todo-print" id="toc-todo-print" class="nav-link" data-scroll-target="#todo-print">TODO Print</a></li>
  <li><a href="#visualize-2" id="toc-visualize-2" class="nav-link" data-scroll-target="#visualize-2">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#overall-interpretation-state" id="toc-overall-interpretation-state" class="nav-link" data-scroll-target="#overall-interpretation-state">OVERALL INTERPRETATION STATE</a>
  <ul class="collapse">
  <li><a href="#setup-1" id="toc-setup-1" class="nav-link" data-scroll-target="#setup-1">Setup</a></li>
  <li><a href="#visualize-3" id="toc-visualize-3" class="nav-link" data-scroll-target="#visualize-3">Visualize</a></li>
  <li><a href="#describe-2" id="toc-describe-2" class="nav-link" data-scroll-target="#describe-2">Describe</a></li>
  <li><a href="#mixed-multinomial-regression" id="toc-mixed-multinomial-regression" class="nav-link" data-scroll-target="#mixed-multinomial-regression">MIXED MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model-brms" id="toc-fit-model-brms" class="nav-link" data-scroll-target="#fit-model-brms">Fit Model [brms]</a></li>
  <li><a href="#describe-3" id="toc-describe-3" class="nav-link" data-scroll-target="#describe-3">Describe</a></li>
  <li><a href="#todo-inference" id="toc-todo-inference" class="nav-link" data-scroll-target="#todo-inference">TODO INFERENCE</a></li>
  <li><a href="#bayes-factor" id="toc-bayes-factor" class="nav-link" data-scroll-target="#bayes-factor">Bayes Factor</a></li>
  <li><a href="#interactions" id="toc-interactions" class="nav-link" data-scroll-target="#interactions">Interactions</a></li>
  <li><a href="#print" id="toc-print" class="nav-link" data-scroll-target="#print">Print</a></li>
  <li><a href="#visualize-4" id="toc-visualize-4" class="nav-link" data-scroll-target="#visualize-4">Visualize</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cumulative-progress" id="toc-cumulative-progress" class="nav-link" data-scroll-target="#cumulative-progress">CUMULATIVE PROGRESS</a>
  <ul class="collapse">
  <li><a href="#visualize-progress-over-task" id="toc-visualize-progress-over-task" class="nav-link" data-scroll-target="#visualize-progress-over-task">Visualize Progress over Task</a></li>
  </ul></li>
  <li><a href="#explore-specific-question-e.g.-q-10" id="toc-explore-specific-question-e.g.-q-10" class="nav-link" data-scroll-target="#explore-specific-question-e.g.-q-10">EXPLORE specific question (e.g.&nbsp;Q 10)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-SGC4C-hypotesting" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Study SGC4C | Hypothesis Testing</p>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<p><em>The purpose of this notebook is test the hypotheses that determined the design of the SGC4C study.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UTILITIES</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy model output</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed models</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#favstats</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite) <span class="co">#saving plots as svg</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZATION</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr) #arrange plots</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cowplot) #arrange shift function plots</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcd) #mosaic plots</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcdExtra) #mosaic plots</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr) <span class="co">#needed for ggdist</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves) <span class="co"># plots. in half</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># violin plot stuffs</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with stats</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#latex tables for models!</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange plots</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELLING</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstatix) #helpful testing functions incl wilcoxon, etc</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#easystats model summary and vis</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects) <span class="co">#contrasts on brms multinomials </span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qqplotr) #confint on qq plot</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gmodels) #contingency table and CHISQR</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic) #extract model equation</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pscl) #zeroinfl / hurdle models </span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools) <span class="co">#predictInterval</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co">#estimated marginal effects and posthocs on interactions</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects) #visualization log regr models</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">#MULTINOMIAL </span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression [not mixed] #no p values</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#frequentist mixed multinomial logistic regression [mblogit] #gives p values</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr) <span class="co">#executing stan</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#bayesian mixed multinomials [+ other bayesian reg models]</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_minimal()) </span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_clean</span>())</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="do">##IMPORT CUSTOM COLOR PALETTES</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"analysis/utils/foxy_palettes.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/SETUP-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In SGC4C we set out to answer the following question: Does ROTATING the TM graph improve performance on the interval graph comprehension task? We test this hypothesis on both the orthogonal and triangular axes versions of the graph.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC4C/data/2-scored-data/sgc4c_scored_participants.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">task_percent =</span> DV_percent_NABS</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC4C/data/2-scored-data/sgc4c_scored_items.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span> (</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.factor</span>(q), </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.factor</span>(subject),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS TRI-LIKE</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state = recode_factor(score_SCALED, #for ordinal</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-1" = "orth-like",</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-0.5" = "unknown",</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0" = "unknown",</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0.5" = "tri-like",</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "1" = "tri-like"),</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS OTHER</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orthogonal"</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"angular"</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"triangular"</span>),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">as.ordered</span>(state))</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#validations</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_items)<span class="sc">/</span><span class="dv">15</span> <span class="sc">==</span> <span class="fu">nrow</span>(df_subjects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df_items<span class="sc">$</span>subject <span class="sc">%in%</span> df_subjects<span class="sc">$</span>subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<section id="sample" class="level2">
<h2 class="anchored" data-anchor-id="sample">SAMPLE</h2>
<section id="data-collection" class="level3">
<h3 class="anchored" data-anchor-id="data-collection">Data Collection</h3>
<p>Data was collected (online, via PROLIFIC) in Summer 2022. Data from the rotation (45, 90) conditions were joined with previously collected (online) data for for non-rotation conditions.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Participants by Condition and Data Collection Period"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Total for Period"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">table</span>(df_subjects<span class="sc">$</span>pretty_condition)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>cont <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>() <span class="sc">%&gt;%</span> <span class="fu">kbl</span>(<span class="at">caption =</span> title, <span class="at">col.names =</span> cols ) <span class="sc">%&gt;%</span>  <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Participants by Condition and Data Collection Period</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Condition </th>
   <th style="text-align:right;"> Total for Period </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ORTH-0 </td>
   <td style="text-align:right;"> 68 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TRI-0 </td>
   <td style="text-align:right;"> 86 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ORTH-45 </td>
   <td style="text-align:right;"> 69 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TRI-45 </td>
   <td style="text-align:right;"> 61 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ORTH-90 </td>
   <td style="text-align:right;"> 61 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TRI-90 </td>
   <td style="text-align:right;"> 67 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sum </td>
   <td style="text-align:right;"> 412 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="participants" class="level3">
<h3 class="anchored" data-anchor-id="participants">Participants</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Describe participants</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>subject.stats <span class="ot">&lt;-</span>df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(age) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.male <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">"Male"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.female <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">"Female"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.other <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"Female"</span>,<span class="st">"Male"</span>)) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Participant Age and Gender"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>subject.stats <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Age in Years"</span>, </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">general_title =</span> <span class="st">"Note: "</span>,<span class="at">footnote_as_chunk =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>Descriptive Statistics of Participant Age and Gender</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
   <th style="text-align:right;"> percent.male </th>
   <th style="text-align:right;"> percent.female </th>
   <th style="text-align:right;"> percent.other </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 37 </td>
   <td style="text-align:right;"> 79 </td>
   <td style="text-align:right;"> 30.3 </td>
   <td style="text-align:right;"> 13.9 </td>
   <td style="text-align:right;"> 412 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.408 </td>
   <td style="text-align:right;"> 0.563 </td>
   <td style="text-align:right;"> 0.029 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> Age in Years</td></tr></tfoot>
</table>

</div>
</div>
<p><strong>TODO</strong></p>
<p><strong>Overall</strong> 412 participants (41 % male, 56 % female, 3 % other) undergraduate STEM majors at a public American University participated in exchange for course credit (age: 18 - 79 years).</p>
</section>
</section>
<section id="overall-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="overall-accuracy">OVERALL ACCURACY</h2>
<section id="setup" class="level4">
<h4 class="anchored" data-anchor-id="setup">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, accuracy, subject, q, SHAPE, ROTATION )</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df_s <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, task_percent, SHAPE, ROTATION)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize" class="level4">
<h4 class="anchored" data-anchor-id="visualize">Visualize</h4>
<section id="explore" class="level5">
<h5 class="anchored" data-anchor-id="explore">Explore</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( q <span class="sc">~</span> SHAPE) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accuracy by Question"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Q6 and Q9 are non-discriminative"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: FACETED HISTOGRAM</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>task_percent,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_s) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(SHAPE <span class="sc">~</span> ROTATION) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Overall Absolute Score (% Correct)"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="present" class="level5">
<h5 class="anchored" data-anchor-id="present">Present</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">grouped_ggbetweenstats</span>(<span class="at">data =</span> df_s,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> task_percent, <span class="at">x =</span> SHAPE, <span class="at">grouping.var =</span> ROTATION,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.type =</span> <span class="st">"box"</span>, <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">results.subtitle =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.point.args =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">1</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>               <span class="co"># point.args = list(alpha=0), #suppress points</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggplot.component =</span> <span class="do">## modify further with `{ggplot2}` functions</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Percentage of correct responses across task"</span>, <span class="at">x =</span> <span class="st">""</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># aes(color = pretty_condition, fill = pretty_condition),</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">scale_fill_grey</span>(), <span class="fu">scale_color_grey</span>()</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 3)),</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_fill_manual(values = paletteer::paletteer_c("viridis::viridis", 3))</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># theme(axis.text.x = element_text(angle = 90)</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                )) </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>   ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>   ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p[[<span class="dv">3</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across both Graph Shapes, Partial Rotation improves performance"</span>) <span class="sc">+</span> </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span> ggeasy<span class="sc">::</span><span class="fu">easy_remove_axes</span>(<span class="at">which =</span> <span class="st">"x"</span>) <span class="sc">+</span> ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p3, p2, p1, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>pg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> SHAPE,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">width =</span> <span class="fl">0.75</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_foxy</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="st">"accuracy"</span>)  <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 2))+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ROTATION)<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION | Question Accuracy"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Across both Graph Shapes, Partial Rotation improves performance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/DESC-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i %&gt;% mutate(</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = fct_rev(accuracy)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )  </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE PLOT WITH LABELS</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- grouped_ggbarstats(data = temp, x = accuracy, y = pretty_condition,</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                grouping.var = ospan_split,</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 2))</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                ))  + theme_clean() </span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIX LABELS</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- p[[1]] +  labs(</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   subtitle = "Impasse is particularly effective for subjects with high-working memory",</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response"</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;-   p[[2]] + labs(</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response",</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "   "</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") +</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggeasy::easy_remove_axes(which="y", what=c("text","title"))</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   # ggeasy::easy_remove_axes(which="y", what= ""))</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE ROW</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_row &lt;- plot_grid(p1,p2, rel_widths = c(1,0.85))</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co"># title &lt;- ggdraw() + </span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   draw_label(</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     fontface = 'bold',</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0,</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     hjust = 0</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     # add margin on the left of the drawing canvas,</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     # so title is aligned with left edge of first plot</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot.margin = margin(0, 0, 0, 7)</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="co"># pg &lt;- plot_grid(</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   title,</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_row,</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   ncol = 1,</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   # rel_heights values control vertical title margins</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   rel_heights = c(0.1, 1)</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean()</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="co"># pg</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(pg, filename = "figures/SGC4C_OSPAN_Accuracy.png", width = 6, height =4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="describe" class="level3">
<h3 class="anchored" data-anchor-id="describe">Describe</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct)"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span>task_percent, <span class="at">data =</span> df_s) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct)</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.154 </td>
   <td style="text-align:right;"> 0.692 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.33 </td>
   <td style="text-align:right;"> 0.368 </td>
   <td style="text-align:right;"> 412 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> pretty_condition </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ORTH-0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.154 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.163 </td>
   <td style="text-align:right;"> 0.315 </td>
   <td style="text-align:right;"> 68 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TRI-0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 0.596 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.257 </td>
   <td style="text-align:right;"> 0.355 </td>
   <td style="text-align:right;"> 86 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ORTH-45 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.231 </td>
   <td style="text-align:right;"> 0.538 </td>
   <td style="text-align:right;"> 0.846 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.507 </td>
   <td style="text-align:right;"> 0.348 </td>
   <td style="text-align:right;"> 69 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TRI-45 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.462 </td>
   <td style="text-align:right;"> 0.692 </td>
   <td style="text-align:right;"> 0.846 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.644 </td>
   <td style="text-align:right;"> 0.297 </td>
   <td style="text-align:right;"> 61 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ORTH-90 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.154 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.173 </td>
   <td style="text-align:right;"> 0.298 </td>
   <td style="text-align:right;"> 61 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TRI-90 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 0.500 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.266 </td>
   <td style="text-align:right;"> 0.327 </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><strong>TODO</strong></p>
<p>Across both conditions, overall accuracy on the task ranges from 0 to 100 with a mean of 32.972.</p>
<p>Task level accuracy on the graph comprehension task follows the same pattern of behaviour observed in Study 4C: the distribution is bimodal. Total scores were higher in the impasse condition (M = 35%, SD = 41%, n = 65) than control condition (M = 15%, SD = 30%, n = 68), implying a likely main effect of scaffold condition. Comparing total scores across the median split on the OSPAN task (high working memory (vs) low working memory), we see readers with high working memory (M = 31 %, SD = 41%, n = 66) performed better than readers with low working memory (M = 19 %, SD = 31%, n = 67). In Figure <span class="math inline">\(\ref{fig_3C_ospan_raw_accuracy}\)</span> we see that while readers in the impasse condition performed consistently better than those in the control condition, the effect is particularly pronounced for readers with high-working memory, implying a potential interaction between condition and working memory.</p>
<section id="tests" class="level4">
<h4 class="anchored" data-anchor-id="tests">TESTS</h4>
<section id="aligned-ranks-transformation" class="level5">
<h5 class="anchored" data-anchor-id="aligned-ranks-transformation">Aligned Ranks Transformation</h5>
<!-- https://rcompanion.org/handbook/F_16.html -->
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ARTool)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>m.art <span class="ot">=</span> <span class="fu">art</span>(task_percent <span class="sc">~</span> SHAPE<span class="sc">*</span>ROTATION, <span class="at">data =</span> df_s)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m.art)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance of Aligned Rank Transformed Data

Table Type: Anova Table (Type III tests) 
Model: No Repeated Measures (lm)
Response: art(task_percent)

                 Df Df.res F value Pr(&gt;F)    
1 SHAPE           1    406  4.0864   0.04   *
2 ROTATION        2    406 57.6235 &lt;2e-16 ***
3 SHAPE:ROTATION  2    406  3.7072   0.03   *
---
Signif. codes:   0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </code></pre>
</div>
</div>
</section>
<section id="kruskal-wallis-test" class="level5">
<h5 class="anchored" data-anchor-id="kruskal-wallis-test">Kruskal Wallis Test</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(k <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(df_s<span class="sc">$</span>task_percent <span class="sc">~</span> df_s<span class="sc">$</span>pretty_condition))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  df_s$task_percent by df_s$pretty_condition
Kruskal-Wallis chi-squared = 95, df = 5, p-value &lt;2e-16</code></pre>
</div>
</div>
</section>
<section id="visualize-1" class="level5">
<h5 class="anchored" data-anchor-id="visualize-1">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STATSPLOT | VIOLIN</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbetweenstats</span>(<span class="at">y =</span> task_percent, <span class="at">x =</span> SHAPE, <span class="at">grouping.var =</span> ROTATION,  </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df_s, <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/TEST-VIZ-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbetweenstats</span>(<span class="at">y =</span> task_percent, <span class="at">x =</span> ROTATION, <span class="at">grouping.var =</span> SHAPE,  </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df_s, <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/TEST-VIZ-ACC-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="mixed-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="mixed-logistic-regression">MIXED LOGISTIC REGRESSION</h4>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.</em></p>
<section id="fit-model" class="level5">
<h5 class="anchored" data-anchor-id="fit-model">Fit Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SETUP</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm 13 items [all discriminating items]</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_i) <span class="sc">/</span> <span class="fu">nrow</span>(df_s) <span class="sc">==</span> <span class="dv">13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm all factors </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df_i<span class="sc">$</span>q) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>subject) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>pretty_condition) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>accuracy) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>ROTATION) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>SHAPE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM EFFECTS</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + ITEM</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject Intercept + Item intercept random model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject Intercept + Item intercept random model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.rSQ)</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SIMPLE FLAT CONDITION MODEL</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Item random intercepts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FIXED Condition + Subject &amp; Item random intercepts"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.CrSQ)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.CrSQ)</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD MAIN EFFECTS  SHAPE</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Rotation + FIXED Shape + Subject &amp; Item random intercepts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FIXED Rotation + FIXED Shape + Subject &amp; Item random intercepts"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mm.R.S.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> ROTATION <span class="sc">+</span> SHAPE <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.R.S.rSQ)</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.R.S.rSQ)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.R.S.rSQ)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.R.S.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name       |    Model | df | df_diff |   Chi2 |      p
------------------------------------------------------
mm.rSQ     | glmerMod |  3 |         |        |       
mm.R.S.rSQ | glmerMod |  6 |       3 | 105.93 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.R.S.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  8.24713063077672e-23"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#adding shape predictor improves fit</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 | ADD INTERACTION TERM,</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Rotation * Shape + Subject &amp; Item random intercepts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FIXED Rotation * Shape + Subject &amp; Item random intercepts"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mm.RSrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> ROTATION <span class="sc">*</span> SHAPE  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.RSrSQ)</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.RSrSQ)</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERACTION TERM IS NOT SIGNIFICANT. </span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.R.S.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.RSrSQ)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model FALSE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.R.S.rSQ,mm.RSrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name       |    Model | df | df_diff | Chi2 |     p
---------------------------------------------------
mm.R.S.rSQ | glmerMod |  6 |         |      |      
mm.RSrSQ   | glmerMod |  8 |       2 | 0.18 | 0.914</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.R.S.rSQ,mm.RSrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.913980259095259"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood ratio and AIC indicate that adding interaction term is not justified"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood ratio and AIC indicate that adding interaction term is not justified"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model Performance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model Performance"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(mm.R.S.rSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma | Log_loss | Score_log | Score_spherical
-------------------------------------------------------------------------------------------------------------------------
3867.070 | 3867.086 | 3906.586 |      0.796 |      0.195 | 0.746 | 0.280 | 1.000 |    0.253 |      -Inf |           0.002</code></pre>
</div>
</div>
<p><strong>ADD TO DISSERTATION</strong></p>
<p>To explore the effect of working memory capacity on ACCURACY, we fit a mixed effects logistic regression model with random intercepts for subjects and questions, with SHAPE AND ROTATION as fixed effects A likelihood ratio test indicates that a model including these main effects explains significantly more variance in the data than an intercepts-only baseline model (<span class="math inline">\(\chi^2 (3,6) = 105.93, p &lt; 0.001\)</span>). We also fit a model including an interaction term between SHAPE and ROTATION, however a likelihood ratio test indicated that adding the interaction term did not improve model fit (<span class="math inline">\(\chi^2 (6,8) = 0.18, p = 0.91\)</span>) Therefore we chose the simple main effects model (with random intercepts) as the final model.</p>
<p>The explanatory power of the entire model is substantial (<span class="math inline">\(conditional \ R^2 = 0.80\)</span>) and the part related to the fixed effects SHAPE and ROTATION (<span class="math inline">\(marginal \ R^2\)</span>) explains 20% of variance.</p>
</section>
<section id="describe-1" class="level5">
<h5 class="anchored" data-anchor-id="describe-1">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.R.S.rSQ <span class="co">#MAIN EFFECTS MODEL</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>m <span class="sc">%&gt;%</span> <span class="fu">write_rds</span>(<span class="at">file =</span> <span class="st">"analysis/SGC4C/models/sgc4c_glmer_acc_mm.R.S.rSQ.rds"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ ROTATION + SHAPE + (1 | subject) + (1 | q)
   Data: df_i

     AIC      BIC   logLik deviance df.resid 
    3867     3907    -1928     3855     5350 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.947 -0.252 -0.100  0.281  4.443 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 9.25     3.04    
 q       (Intercept) 0.41     0.64    
Number of obs: 5356, groups:  subject, 412; q, 13

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -4.004      0.431   -9.29   &lt;2e-16 ***
ROTATION45     3.900      0.435    8.97   &lt;2e-16 ***
ROTATION90     0.504      0.436    1.16    0.248    
SHAPETRI       1.145      0.349    3.28    0.001 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
           (Intr) ROTATION4 ROTATION9
ROTATION45 -0.629                    
ROTATION90 -0.517  0.497             
SHAPETRI   -0.511  0.124     0.040   </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFICANCE TEST [non directional]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGNIFICANCE TEST [non directional]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">2</span>) <span class="co">#TYPE 3 SS FOR main effects</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: accuracy
         Chisq Df Pr(&gt;Chisq)    
ROTATION  94.9  2     &lt;2e-16 ***
SHAPE     10.8  1      0.001 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m),</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se,</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6  9
  effect   group term  estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;  (Int   -4.00      0.431     -9.29  1.49e-20   -4.85      -3.16
2 fixed    &lt;NA&gt;  ROTA    3.90      0.435      8.97  3.04e-19    3.05       4.75
3 fixed    &lt;NA&gt;  ROTA    0.504     0.436      1.16  2.48e- 1   -0.350      1.36
4 fixed    &lt;NA&gt;  SHAP    1.15      0.349      3.28  1.02e- 3    0.462      1.83
5 ran_pars subj sd__    3.04     NA         NA    NA          NA         NA   
6 ran_pars q     sd__    0.640    NA         NA    NA          NA         NA   </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6  9
  effect   group term  estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;  (Int   0.0182   0.00786     -9.29  1.49e-20  0.00784    0.0424
2 fixed    &lt;NA&gt;  ROTA  49.4     21.5          8.97  3.04e-19 21.1      116.    
3 fixed    &lt;NA&gt;  ROTA   1.66     0.722        1.16  2.48e- 1  0.704      3.89  
4 fixed    &lt;NA&gt;  SHAP   3.14     1.10         3.28  1.02e- 3  1.59       6.22  
5 ran_pars subj sd__   3.04    NA           NA    NA        NA         NA     
6 ran_pars q     sd__   0.640   NA           NA    NA        NA         NA     </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PROBABILITIES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#probability control = plogis(intercept)</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co">#probability impasse = plogis(intercept + coefficient)</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM predict()</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co"># newdata &lt;- df_i %&gt;% dplyr::select(pretty_condition, subject, q)</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- predict(m, newdata = newdata, type = "response")</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- cbind(newdata, preds)</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- preds %&gt;% </span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, preds) %&gt;% </span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition) %&gt;% </span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     median = median(preds),</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     se = sd(preds)/sqrt(n()),</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     lwr = median - 1.96*se,</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     upr = median + 1.96*se)</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM merTools</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(ROTATION, SHAPE, subject, q)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="co">#make predictions</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predictInterval</span>(m, <span class="at">newdata =</span> newdata,</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>                              <span class="at">which =</span> <span class="st">"fixed"</span>, <span class="co">#full, fixed or random for those only</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"probability"</span>, <span class="co">#linear.prediction</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>                              <span class="at">stat =</span> <span class="st">"median"</span>,</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n.sims =</span> <span class="dv">1000</span>,</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>                              <span class="at">level =</span> <span class="fl">0.80</span>) <span class="co">#width of prediction interval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: executing %dopar% sequentially: no parallel backend registered</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#join predictions to the new dataframe</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>(summ_preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ROTATION, SHAPE, fit, lwr, upr) <span class="sc">%&gt;%</span> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ROTATION, SHAPE) <span class="sc">%&gt;%</span> </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(fit),</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">median</span>(lwr),</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">median</span>(upr)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6  5
# Groups:   ROTATION [3]
  ROTATION SHAPE median   lower  upper
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 0        ORTH  0.0177 0.00450 0.0672
2 0        TRI   0.0544 0.0145  0.185 
3 45       ORTH  0.473  0.187   0.780 
4 45       TRI   0.743  0.423   0.918 
5 90       ORTH  0.0293 0.00748 0.108 
6 90       TRI   0.0877 0.0237  0.275 </code></pre>
</div>
</div>
</section>
<section id="inference" class="level5">
<h5 class="anchored" data-anchor-id="inference">INFERENCE</h5>
<p><strong>ADD TO DISSERTATION</strong></p>
<p>Although Wald Chi-Square tests revealed significant main effects of both SHAPE (<span class="math inline">\(\chi^2 (1) = 10.8, p &lt; 0.001\)</span>) and ROTATION (<span class="math inline">\(\chi^2 (1) = 94.9, p &lt; 0.001\)</span>).</p>
<p>The model predicts that, for ORTHOGONAL shaped graphs, rotating the graph from 0 to 45 degrees increases the probability of a correct response from 1% to 47%. Further rotating the graph to 90 degrees however, results in a probability of only 3%. Posthoc comparisons indicate that the difference between 0 and 90 degree rotation is not significant (OR = 0.60, SE = 0.26 , p = 0.24)</p>
<p>The model predicts that, for TRIANGULAR shaped graphs, rotating the graph from 0 to 45 degrees increases the probability of a correct response from 5% to 74%. Further rotating the graph to 90 degrees however, results in a probability of only 9%. Posthoc comparisons indicate that the difference between 0 and 90 degree rotation is not significant (OR = 0.60, SE = 0.26 = 0.25).</p>
<p>Across both graph shapes, rotating the graph from 0 to 90 degrees results in a minor improvement in accuracy, while rotating the graph halfway between results in a substantial improvement in accuracy. Posthoc comparisons also reveal that across all levels of rotation, the triangular shape was significantly better than the orthogonal shape.</p>
</section>
<section id="marginal-effects" class="level5">
<h5 class="anchored" data-anchor-id="marginal-effects">Marginal Effects</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html#simple</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.oarc.ucla.edu/stata/faq/how-can-i-understand-a-categorical-by-categorical-interaction-in-logistic-regression-stata-12/</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.oarc.ucla.edu/stata/seminars/deciphering-interactions-in-logistic-regression/</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check reference grid</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ref_grid</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'emmGrid' object with variables:
    ROTATION = 0, 45, 90
    SHAPE = ORTH, TRI
Transformation: "logit" </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PRINT ESTIMATED MARGINAL MEANS</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#should be same as summ_preds</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m,  <span class="sc">~</span> ROTATION <span class="sc">+</span> SHAPE, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> ROTATION SHAPE  prob     SE  df asymp.LCL asymp.UCL
 0        ORTH  0.018 0.0076 Inf     0.008     0.041
 45       ORTH  0.474 0.0930 Inf     0.302     0.652
 90       ORTH  0.029 0.0121 Inf     0.013     0.065
 0        TRI   0.054 0.0201 Inf     0.026     0.110
 45       TRI   0.739 0.0734 Inf     0.573     0.857
 90       TRI   0.087 0.0318 Inf     0.041     0.173

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">##POST-HOC COMPARISONS</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"POSTHOC COMPARISONS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "POSTHOC COMPARISONS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m,  pairwise <span class="sc">~</span> ROTATION <span class="sc">+</span> SHAPE, </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"response"</span> , <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="co">#sidak, tukey</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 ROTATION SHAPE  prob     SE  df asymp.LCL asymp.UCL
 0        ORTH  0.018 0.0076 Inf     0.008     0.041
 45       ORTH  0.474 0.0930 Inf     0.302     0.652
 90       ORTH  0.029 0.0121 Inf     0.013     0.065
 0        TRI   0.054 0.0201 Inf     0.026     0.110
 45       TRI   0.739 0.0734 Inf     0.573     0.857
 90       TRI   0.087 0.0318 Inf     0.041     0.173

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale 

$contrasts
 contrast                          odds.ratio    SE  df null z.ratio p.value
 ROTATION0 ORTH / ROTATION45 ORTH        0.02  0.01 Inf    1  -8.970  &lt;.0001
 ROTATION0 ORTH / ROTATION90 ORTH        0.60  0.26 Inf    1  -1.160  0.2475
 ROTATION0 ORTH / ROTATION0 TRI          0.32  0.11 Inf    1  -3.280  0.0010
 ROTATION0 ORTH / ROTATION45 TRI         0.01  0.00 Inf    1  -8.550  &lt;.0001
 ROTATION0 ORTH / ROTATION90 TRI         0.19  0.11 Inf    1  -2.900  0.0038
 ROTATION45 ORTH / ROTATION90 ORTH      29.83 13.03 Inf    1   7.780  &lt;.0001
 ROTATION45 ORTH / ROTATION0 TRI        15.71  8.21 Inf    1   5.270  &lt;.0001
 ROTATION45 ORTH / ROTATION45 TRI        0.32  0.11 Inf    1  -3.280  0.0010
 ROTATION45 ORTH / ROTATION90 TRI        9.49  5.08 Inf    1   4.200  &lt;.0001
 ROTATION90 ORTH / ROTATION0 TRI         0.53  0.29 Inf    1  -1.170  0.2413
 ROTATION90 ORTH / ROTATION45 TRI        0.01  0.01 Inf    1  -7.820  &lt;.0001
 ROTATION90 ORTH / ROTATION90 TRI        0.32  0.11 Inf    1  -3.280  0.0010
 ROTATION0 TRI / ROTATION45 TRI          0.02  0.01 Inf    1  -8.970  &lt;.0001
 ROTATION0 TRI / ROTATION90 TRI          0.60  0.26 Inf    1  -1.160  0.2475
 ROTATION45 TRI / ROTATION90 TRI        29.83 13.03 Inf    1   7.780  &lt;.0001

Tests are performed on the log odds ratio scale </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT INTERACTION</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalent to plot_model, type = "int"</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># emmip(m, SHAPE * ROTATION ,</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#       type = "response",</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co">#       CIs = TRUE,</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">#       linearg = list(linetype = "dashed"),</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co">#       engine = "ggplot")</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT PROBABILITY</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ref_grid</span>(m), <span class="at">by =</span> <span class="st">"SHAPE"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="todo-print" class="level5">
<h5 class="anchored" data-anchor-id="todo-print">TODO Print</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># title = "Study 4C | Question Accuracy | Mixed Logistic Regression"</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              paste("n = ",n_obs(m), "R^2(Conditional) =", round(r2(m)[[1]],2),</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                    "R^2(Marginal) =", round(r2(m)[[2]],2)),</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              "Accuracy  ~ Condition * OSPAN +  (1 | subject) + (1 | q)")</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = title,</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "tables/SGC3C_OSPAN_GLMER_OverallAccuracy.tex")</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="co">#              # coef_omit = "Intercept",</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a><span class="co"># extract_eq(m, use_coefs = TRUE, wrap = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-2" class="level5">
<h5 class="anchored" data-anchor-id="visualize-2">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Estimate | Odds Ratio"</span>,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/MODEL-VIS-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m, exponentiate = TRUE, component = "all")</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/MODEL-VIS-ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="int",</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"SHAPE"</span>, <span class="st">"ROTATION"</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/MODEL-VIS-ACC-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"eff"</span>,  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"SHAPE"</span>, <span class="st">"ROTATION"</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/MODEL-VIS-ACC-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co">#GGDIST | MODEL | PREDICTED PROBABILITIES</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co"># preds %&gt;% </span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes( x = fit, y = ROTATION, fill = SHAPE)) + </span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye(alpha = 0.5, normalize = "panels") + </span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim(0,0.3) + theme_clean() + labs(</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model PREDICTION | Probability of Accurate Response",</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "TODO check preds to see if fixed or includes random"</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## PLOT INTERACTION</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggeffects'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:cowplot':

    get_title</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelr':

    data_grid</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"ROTATION"</span>,<span class="st">"SHAPE"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">connect.lines =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">fct_rev</span>(paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"nbapalettes::bulls"</span>)))<span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = paletteer::paletteer_d("awtools::gpalette",3))+</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 3))+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 2)) + </span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"MODEL | Predicted probability of correct response"</span>,</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"ROTATION"</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'colour' is already present. Adding another scale for 'colour',
which will replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="diagnostics" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PERFORMANCE")</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DIAGNOSTICS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DIAGNOSTICS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/MODEL-DIAG-ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="overall-interpretation-state" class="level2">
<h2 class="anchored" data-anchor-id="overall-interpretation-state">OVERALL INTERPRETATION STATE</h2>
<ul>
<li><p><strong>orthogonal</strong> [reference category] includes orthogonal and satisficing responses ==&gt; indicates a primarily <em>orthogonal</em> state of coordinate system understanding</p></li>
<li><p><strong>other</strong> includes: blank, reference point, responses that cant be classified (including selecting all datapoints), =&gt; indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly <em>not</em> orthogonal nor triangular</p></li>
<li><p><strong>angular</strong> includes lines connecting responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
<li><p><strong>triangular</strong> includes correct triangular =&gt; indicates a correct triangular coordinate understanding</p></li>
</ul>
<section id="setup-1" class="level4">
<h4 class="anchored" data-anchor-id="setup-1">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,subject,state,pretty_condition, ROTATION, SHAPE) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-3" class="level4">
<h4 class="anchored" data-anchor-id="visualize-3">Visualize</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ROTATION,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>SHAPE) <span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation across all Questions"</span>,</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ROTATION,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_brewer(palette = "Set1")  +</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(q <span class="sc">~</span> SHAPE) <span class="sc">+</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation by Question"</span>,</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ROTATION,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_foxy</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="st">"state"</span>)  <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>SHAPE) <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION | Interpretation"</span>,</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i %&gt;% mutate(</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   state = fct_rev(state)</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )  </span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;-   grouped_ggbarstats(data = temp, x = state, y = pretty_condition,</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                           grouping.var = ospan_split,</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 4))</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                ))  + theme_clean() + theme(legend.position = "bottom")</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- p + labs(title = "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="co">#          y = "Proportion of Questions", x = "Condition",</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="co">#          subtitle = "Impasse condition yields more correct responses")</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="co"># p</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(p, filename = "figures/SGC4C_LAB_Accuracy.png", width = 6, height =4)</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i </span></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a><span class="co"># # %&gt;% mutate(</span></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a><span class="co"># #   accuracy = fct_rev(accuracy)</span></span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a><span class="co"># # )</span></span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE PLOT WITH LABELS</span></span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- grouped_ggbarstats(data = temp, x = state, y = pretty_condition,</span></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                grouping.var = ospan_split,</span></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 4))</span></span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                )) </span></span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIX LABELS</span></span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- p[[1]] +  labs(</span></span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   subtitle = "Impasse is particularly effective for subjects with high-working memory",</span></span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response"</span></span>
<span id="cb103-45"><a href="#cb103-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") </span></span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;-   p[[2]] + labs(</span></span>
<span id="cb103-48"><a href="#cb103-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response",</span></span>
<span id="cb103-49"><a href="#cb103-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "   "</span></span>
<span id="cb103-50"><a href="#cb103-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") +</span></span>
<span id="cb103-51"><a href="#cb103-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggeasy::easy_remove_axes(which="y", what=c("text","title"))</span></span>
<span id="cb103-52"><a href="#cb103-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   # ggeasy::easy_remove_axes(which="y", what= ""))</span></span>
<span id="cb103-53"><a href="#cb103-53" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-54"><a href="#cb103-54" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE ROW</span></span>
<span id="cb103-55"><a href="#cb103-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-56"><a href="#cb103-56" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_row &lt;- plot_grid(p1,p2, rel_widths = c(1,0.85))</span></span>
<span id="cb103-57"><a href="#cb103-57" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-58"><a href="#cb103-58" aria-hidden="true" tabindex="-1"></a><span class="co"># title &lt;- ggdraw() + </span></span>
<span id="cb103-59"><a href="#cb103-59" aria-hidden="true" tabindex="-1"></a><span class="co">#   draw_label(</span></span>
<span id="cb103-60"><a href="#cb103-60" aria-hidden="true" tabindex="-1"></a><span class="co">#     "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb103-61"><a href="#cb103-61" aria-hidden="true" tabindex="-1"></a><span class="co">#     fontface = 'bold',</span></span>
<span id="cb103-62"><a href="#cb103-62" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0,</span></span>
<span id="cb103-63"><a href="#cb103-63" aria-hidden="true" tabindex="-1"></a><span class="co">#     hjust = 0</span></span>
<span id="cb103-64"><a href="#cb103-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb103-65"><a href="#cb103-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb103-66"><a href="#cb103-66" aria-hidden="true" tabindex="-1"></a><span class="co">#     # add margin on the left of the drawing canvas,</span></span>
<span id="cb103-67"><a href="#cb103-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     # so title is aligned with left edge of first plot</span></span>
<span id="cb103-68"><a href="#cb103-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot.margin = margin(0, 0, 0, 7)</span></span>
<span id="cb103-69"><a href="#cb103-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb103-70"><a href="#cb103-70" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-71"><a href="#cb103-71" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-72"><a href="#cb103-72" aria-hidden="true" tabindex="-1"></a><span class="co"># pg &lt;- plot_grid(</span></span>
<span id="cb103-73"><a href="#cb103-73" aria-hidden="true" tabindex="-1"></a><span class="co">#   title,</span></span>
<span id="cb103-74"><a href="#cb103-74" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_row,</span></span>
<span id="cb103-75"><a href="#cb103-75" aria-hidden="true" tabindex="-1"></a><span class="co">#   ncol = 1,</span></span>
<span id="cb103-76"><a href="#cb103-76" aria-hidden="true" tabindex="-1"></a><span class="co">#   # rel_heights values control vertical title margins</span></span>
<span id="cb103-77"><a href="#cb103-77" aria-hidden="true" tabindex="-1"></a><span class="co">#   rel_heights = c(0.1, 1)</span></span>
<span id="cb103-78"><a href="#cb103-78" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean()</span></span>
<span id="cb103-79"><a href="#cb103-79" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb103-80"><a href="#cb103-80" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-81"><a href="#cb103-81" aria-hidden="true" tabindex="-1"></a><span class="co"># update_geom_defaults("text", list(colour = "grey20", family = theme_get()$text$family))</span></span>
<span id="cb103-82"><a href="#cb103-82" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-83"><a href="#cb103-83" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-84"><a href="#cb103-84" aria-hidden="true" tabindex="-1"></a><span class="co"># pg</span></span>
<span id="cb103-85"><a href="#cb103-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-86"><a href="#cb103-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-87"><a href="#cb103-87" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(pg, filename = "figures/SGC4C_OSPAN_Accuracy.png", width = 6, height =4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-2" class="level4">
<h4 class="anchored" data-anchor-id="describe-2">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             ORTH-0  TRI-0 ORTH-45 TRI-45 ORTH-90 TRI-90    Sum
  orthogonal 0.6640 0.5572  0.2274 0.0908  0.5195 0.3720 0.4149
  other      0.1324 0.1351  0.1605 0.1639  0.2106 0.2342 0.1705
  angular    0.0407 0.0510  0.1048 0.1009  0.0971 0.1274 0.0850
  triangular 0.1629 0.2567  0.5072 0.6444  0.1728 0.2664 0.3297
  Sum        1.0000 1.0000  1.0000 1.0000  1.0000 1.0000 1.0000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>ROTATION, df_i<span class="sc">$</span>SHAPE) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = ORTH

            
                0   45   90  Sum
  orthogonal  587  204  412 1203
  other       117  144  167  428
  angular      36   94   77  207
  triangular  144  455  137  736
  Sum         884  897  793 2574

, ,  = TRI

            
                0   45   90  Sum
  orthogonal  623   72  324 1019
  other       151  130  204  485
  angular      57   80  111  248
  triangular  287  511  232 1030
  Sum        1118  793  871 2782</code></pre>
</div>
</div>
</section>
<section id="mixed-multinomial-regression" class="level4">
<h4 class="anchored" data-anchor-id="mixed-multinomial-regression">MIXED MULTINOMIAL REGRESSION</h4>
<p><em>Does condition affect the response state of of items across the task?</em></p>
<p><em>Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).</em></p>
<section id="fit-model-brms" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-brms">Fit Model [brms]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="do">##1. In order to set priors, first fit default priors model, then get prior description</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="do">## in order to get class and dpar names </span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># FLAT MODEL</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># flat &lt;- brm( state ~ ROTATION+SHAPE + (1|subject) + (1|q),</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = df_i,</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                  family = "categorical",</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                  chains = 4, iter = 2000, warmup = 1000,</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                  cores = 4, seed = 1234,</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                  save_pars = save_pars(all = TRUE),</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co"># control = list(adapt_delta = 0.98),  # to deal with divergent transitions</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                  backend = "cmdstanr")</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="co"># prior_summary(flat)</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>inf_priors_maineffects <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS </span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on COEFFICIENT</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coefficient level rotation 45</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coefficient level rotation 90</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coeficient level shape tri</span></span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a>inf_priors_ixn <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS</span></span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on CONDITION COEFFICIENT</span></span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>   <span class="co">#coefficient level rotation 45</span></span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coefficient level rotation 90</span></span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-52"><a href="#cb108-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-53"><a href="#cb108-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb108-54"><a href="#cb108-54" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coeficient level shape tri</span></span>
<span id="cb108-55"><a href="#cb108-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-56"><a href="#cb108-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-57"><a href="#cb108-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb108-58"><a href="#cb108-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on IXN COEFFICIENT</span></span>
<span id="cb108-59"><a href="#cb108-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb108-60"><a href="#cb108-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-61"><a href="#cb108-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-62"><a href="#cb108-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb108-63"><a href="#cb108-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-64"><a href="#cb108-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on IXN COEFFICIENT</span></span>
<span id="cb108-65"><a href="#cb108-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb108-66"><a href="#cb108-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb108-67"><a href="#cb108-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb108-68"><a href="#cb108-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb108-69"><a href="#cb108-69" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-70"><a href="#cb108-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-71"><a href="#cb108-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-72"><a href="#cb108-72" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN RANDOM ONLY</span></span>
<span id="cb108-73"><a href="#cb108-73" aria-hidden="true" tabindex="-1"></a>Bmm.cat.rSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb108-74"><a href="#cb108-74" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb108-75"><a href="#cb108-75" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb108-76"><a href="#cb108-76" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb108-77"><a href="#cb108-77" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb108-78"><a href="#cb108-78" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb108-79"><a href="#cb108-79" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb108-80"><a href="#cb108-80" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.rSQ.rds"</span>)</span>
<span id="cb108-81"><a href="#cb108-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-82"><a href="#cb108-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-83"><a href="#cb108-83" aria-hidden="true" tabindex="-1"></a><span class="co"># MAIN EFFECTSONLY MODEL</span></span>
<span id="cb108-84"><a href="#cb108-84" aria-hidden="true" tabindex="-1"></a>Bmm.cat.R.SrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> ROTATION <span class="sc">+</span> SHAPE <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb108-85"><a href="#cb108-85" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb108-86"><a href="#cb108-86" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> inf_priors_maineffects,</span>
<span id="cb108-87"><a href="#cb108-87" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb108-88"><a href="#cb108-88" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb108-89"><a href="#cb108-89" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb108-90"><a href="#cb108-90" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb108-91"><a href="#cb108-91" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb108-92"><a href="#cb108-92" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb108-93"><a href="#cb108-93" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.R.S.rSQ.rds"</span>)</span>
<span id="cb108-94"><a href="#cb108-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-95"><a href="#cb108-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-96"><a href="#cb108-96" aria-hidden="true" tabindex="-1"></a><span class="do">##MODEL COMPARISON</span></span>
<span id="cb108-97"><a href="#cb108-97" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL COMPARISON: random effects (vs) CONDITION")</span></span>
<span id="cb108-98"><a href="#cb108-98" aria-hidden="true" tabindex="-1"></a>(bf1 <span class="ot">&lt;-</span>  <span class="fu">bayesfactor</span>(Bmm.cat.rSQ, Bmm.cat.R.SrSQ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Bayes factors might not be precise.
For precise Bayes factors, sampling at least 40,000 posterior samples is recommended.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computation of Bayes factors: estimating marginal likelihood, please wait...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: logml could not be estimated within maxiter, rerunning with adjusted starting value. 
Estimate might be more variable than usual.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Recompiling the model with 'rstan'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
clang -mmacosx-version-min=10.13 -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG   -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/unsupported"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/BH/include" -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
In file included from &lt;built-in&gt;:1:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Dense:1:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Core:88:
/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace'
namespace Eigen {
^
/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator
namespace Eigen {
               ^
               ;
In file included from &lt;built-in&gt;:1:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Dense:1:
/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found
#include &lt;complex&gt;
         ^~~~~~~~~
3 errors generated.
make: *** [foo.o] Error 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Recompilation done</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: logml could not be estimated within maxiter, rerunning with adjusted starting value. 
Estimate might be more variable than usual.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factors for Model Comparison

    Model                                            BF
[2] ROTATION + SHAPE + (1 | subject) + (1 | q) 2.96e+55

* Against Denominator: [1] 1 + (1 | subject) + (1 | q)
*   Bayes Factor Type: marginal likelihoods (bridgesampling)</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#substantial evidence in favor of conditon model over random only BF 1.64e+16</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # INTERACTION MODEL</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>Bmm.cat.RSrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> ROTATION<span class="sc">*</span>SHAPE <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q),</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> inf_priors_ixn,</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.RSrSQ.rds"</span>)</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co"># describe_posterior(Bmm.cat.RSrSQ)</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="do">##MODEL COMPARISON</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"IS FACTORIAL better than MAIN EFFECTS model?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IS FACTORIAL better than MAIN EFFECTS model?"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>(bf2 <span class="ot">&lt;-</span> <span class="fu">bayesfactor</span>(Bmm.cat.R.SrSQ, Bmm.cat.RSrSQ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Bayes factors might not be precise.
For precise Bayes factors, sampling at least 40,000 posterior samples is recommended.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computation of Bayes factors: estimating marginal likelihood, please wait...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Recompiling the model with 'rstan'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
clang -mmacosx-version-min=10.13 -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG   -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/unsupported"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/BH/include" -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/"  -I"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
In file included from &lt;built-in&gt;:1:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Dense:1:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Core:88:
/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace'
namespace Eigen {
^
/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator
namespace Eigen {
               ^
               ;
In file included from &lt;built-in&gt;:1:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Dense:1:
/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found
#include &lt;complex&gt;
         ^~~~~~~~~
3 errors generated.
make: *** [foo.o] Error 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Recompilation done</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: logml could not be estimated within maxiter, rerunning with adjusted starting value. 
Estimate might be more variable than usual.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: logml could not be estimated within maxiter, rerunning with adjusted starting value. 
Estimate might be more variable than usual.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factors for Model Comparison

    Model                                            BF
[2] ROTATION * SHAPE + (1 | subject) + (1 | q) 5.19e-18

* Against Denominator: [1] ROTATION + SHAPE + (1 | subject) + (1 | q)
*   Bayes Factor Type: marginal likelihoods (bridgesampling)</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(Bmm.cat.R.SrSQ, Bmm.cat.RSrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_muother_ROTATION90:SHAPETRI and b_muother_ROTATION90 (r = 0.71), b_muangular_ROTATION90:SHAPETRI and b_muangular_ROTATION90 (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                        |       Bmm.cat.R.SrSQ |        Bmm.cat.RSrSQ
------------------------------------------------------------------------------
muother_Intercept                | -2.61 (-3.51, -1.71) | -2.40 (-3.30, -1.49)
muangular_Intercept              | -4.18 (-5.23, -3.14) | -4.06 (-5.18, -2.96)
mutriangular_Intercept           | -3.72 (-4.66, -2.84) | -3.56 (-4.63, -2.57)
muother_ROTATION45               |  2.15 ( 1.71,  2.61) |  1.73 ( 1.13,  2.34)
muother_ROTATION90               |  1.23 ( 0.83,  1.65) |  0.95 ( 0.38,  1.55)
muother_SHAPETRI                 |  0.66 ( 0.32,  1.01) |  0.26 (-0.31,  0.81)
muangular_ROTATION45             |  2.99 ( 2.40,  3.60) |  2.73 ( 1.92,  3.59)
muangular_ROTATION90             |  1.58 ( 1.02,  2.16) |  1.40 ( 0.57,  2.25)
muangular_SHAPETRI               |  0.92 ( 0.45,  1.41) |  0.67 (-0.13,  1.47)
mutriangular_ROTATION45          |  4.85 ( 3.95,  5.79) |  4.56 ( 3.33,  5.86)
mutriangular_ROTATION90          |  0.84 (-0.09,  1.76) |  0.66 (-0.61,  1.97)
mutriangular_SHAPETRI            |  1.49 ( 0.69,  2.28) |  1.18 (-0.02,  2.35)
muangular_ROTATION90:SHAPETRI    |                      |  0.34 (-0.75,  1.45)
mutriangular_ROTATION90:SHAPETRI |                      |  0.39 (-1.30,  2.05)
muother_ROTATION45:SHAPETRI      |                      |  0.94 ( 0.05,  1.84)
muother_ROTATION90:SHAPETRI      |                      |  0.53 (-0.28,  1.32)
mutriangular_ROTATION45:SHAPETRI |                      |  0.76 (-0.95,  2.41)
muangular_ROTATION45:SHAPETRI    |                      |  0.59 (-0.56,  1.75)
------------------------------------------------------------------------------
Observations                     |                 5356 |                 5356</code></pre>
</div>
</div>
<p><strong>TODO</strong></p>
<p>To quantify the effect of working memory capacity on INTERPRETATION, we fit a (bayesian) mixed multinomial regression model with random intercepts for subjects and questions.</p>
<p>A Bayes Factor model comparison (against a random intercepts only model) indicates extreme evidence for the final model including fixed (main) effects of ROTATION, SHAPE (BF = 1.99e+54). A Bayes Factor model comparison (against a model including an interaction term) indicates extreme evidence in favor of the final model including main effects only (BF = 2.10e-24).</p>
<p>(note, the BF may change as it is estimated via simulation each time)</p>
</section>
<section id="describe-3" class="level5">
<h5 class="anchored" data-anchor-id="describe-3">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> Bmm.cat.R.SrSQ <span class="co">#main effects model</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: categorical 
  Links: muother = logit; muangular = logit; mutriangular = logit 
Formula: state ~ ROTATION + SHAPE + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 5356) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~q (Number of levels: 13) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muother_Intercept)          1.50      0.35     0.99     2.32 1.00     3402
sd(muangular_Intercept)        1.66      0.41     1.05     2.63 1.00     4270
sd(mutriangular_Intercept)     0.72      0.18     0.45     1.16 1.00     4157
                           Tail_ESS
sd(muother_Intercept)          6170
sd(muangular_Intercept)        6662
sd(mutriangular_Intercept)     6629

~subject (Number of levels: 412) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muother_Intercept)          1.39      0.09     1.21     1.58 1.00     4720
sd(muangular_Intercept)        1.83      0.14     1.57     2.12 1.00     4015
sd(mutriangular_Intercept)     3.49      0.20     3.12     3.91 1.00     3756
                           Tail_ESS
sd(muother_Intercept)          7878
sd(muangular_Intercept)        7252
sd(mutriangular_Intercept)     6881

Population-Level Effects: 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
muother_Intercept          -2.61      0.45    -3.51    -1.71 1.00     2074
muangular_Intercept        -4.18      0.53    -5.23    -3.14 1.00     2924
mutriangular_Intercept     -3.73      0.46    -4.66    -2.84 1.00     2581
muother_ROTATION45          2.15      0.23     1.71     2.61 1.00     6650
muother_ROTATION90          1.23      0.21     0.83     1.65 1.00     5407
muother_SHAPETRI            0.67      0.18     0.32     1.01 1.00     6596
muangular_ROTATION45        2.99      0.31     2.40     3.60 1.00     6161
muangular_ROTATION90        1.58      0.29     1.02     2.16 1.00     6286
muangular_SHAPETRI          0.93      0.24     0.45     1.41 1.00     6395
mutriangular_ROTATION45     4.85      0.47     3.95     5.79 1.00     2285
mutriangular_ROTATION90     0.84      0.48    -0.09     1.76 1.00     2432
mutriangular_SHAPETRI       1.49      0.40     0.69     2.28 1.00     2012
                        Tail_ESS
muother_Intercept           4022
muangular_Intercept         4812
mutriangular_Intercept      4958
muother_ROTATION45          8893
muother_ROTATION90          8250
muother_SHAPETRI            8720
muangular_ROTATION45        8189
muangular_ROTATION90        8377
muangular_SHAPETRI          8544
mutriangular_ROTATION45     4547
mutriangular_ROTATION90     4222
mutriangular_SHAPETRI       3853

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(<span class="at">ci=</span>.<span class="dv">95</span>, m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Posterior Distribution

Parameter               | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS
--------------------------------------------------------------------------------------------------------
muother_Intercept       |  -2.61 | [-3.51, -1.71] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2036.00
muangular_Intercept     |  -4.18 | [-5.23, -3.14] |   100% | [-0.18, 0.18] |        0% | 1.000 | 2922.00
mutriangular_Intercept  |  -3.72 | [-4.66, -2.84] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2578.00
muother_ROTATION45      |   2.15 | [ 1.71,  2.61] |   100% | [-0.18, 0.18] |        0% | 1.001 | 6637.00
muother_ROTATION90      |   1.23 | [ 0.83,  1.65] |   100% | [-0.18, 0.18] |        0% | 1.001 | 5393.00
muother_SHAPETRI        |   0.66 | [ 0.32,  1.01] | 99.98% | [-0.18, 0.18] |        0% | 1.000 | 6588.00
muangular_ROTATION45    |   2.99 | [ 2.40,  3.60] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6152.00
muangular_ROTATION90    |   1.58 | [ 1.02,  2.16] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6263.00
muangular_SHAPETRI      |   0.92 | [ 0.45,  1.41] | 99.99% | [-0.18, 0.18] |        0% | 1.000 | 6382.00
mutriangular_ROTATION45 |   4.85 | [ 3.95,  5.79] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2276.00
mutriangular_ROTATION90 |   0.84 | [-0.09,  1.76] | 96.17% | [-0.18, 0.18] |     6.10% | 1.002 | 2427.00
mutriangular_SHAPETRI   |   1.49 | [ 0.69,  2.28] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2000.00</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"BAYES FACTOR [comparison to RANDOM ONLY model]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BAYES FACTOR [comparison to RANDOM ONLY model]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#think of this like the anova(model) to get p values for each predictor</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co">#has to recompile the models with rstan. total drag</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co">#already calculated bayes factor above, this just interprets it</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_bf</span>(<span class="fu">exp</span>(bf1<span class="sc">$</span>log_BF), <span class="at">include_value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "no evidence (BF = 1.00) against or in favour of"
[2] "extreme evidence (BF = 2.96e+55) in favour of"  
(Rules: jeffreys1961)</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DESCRIBE POSTERIOR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DESCRIBE POSTERIOR"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>(l <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Posterior Distribution

Parameter               | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS
--------------------------------------------------------------------------------------------------------
muother_Intercept       |  -2.61 | [-3.51, -1.71] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2036.00
muangular_Intercept     |  -4.18 | [-5.23, -3.14] |   100% | [-0.18, 0.18] |        0% | 1.000 | 2922.00
mutriangular_Intercept  |  -3.72 | [-4.66, -2.84] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2578.00
muother_ROTATION45      |   2.15 | [ 1.71,  2.61] |   100% | [-0.18, 0.18] |        0% | 1.001 | 6637.00
muother_ROTATION90      |   1.23 | [ 0.83,  1.65] |   100% | [-0.18, 0.18] |        0% | 1.001 | 5393.00
muother_SHAPETRI        |   0.66 | [ 0.32,  1.01] | 99.98% | [-0.18, 0.18] |        0% | 1.000 | 6588.00
muangular_ROTATION45    |   2.99 | [ 2.40,  3.60] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6152.00
muangular_ROTATION90    |   1.58 | [ 1.02,  2.16] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6263.00
muangular_SHAPETRI      |   0.92 | [ 0.45,  1.41] | 99.99% | [-0.18, 0.18] |        0% | 1.000 | 6382.00
mutriangular_ROTATION45 |   4.85 | [ 3.95,  5.79] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2276.00
mutriangular_ROTATION90 |   0.84 | [-0.09,  1.76] | 96.17% | [-0.18, 0.18] |     6.10% | 1.002 | 2427.00
mutriangular_SHAPETRI   |   1.49 | [ 0.69,  2.28] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2000.00</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (tm &lt;- tidy(m,   conf.int = TRUE))</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter               | Median |          95% CI |     pd | % in ROPE |  Rhat |     ESS
-----------------------------------------------------------------------------------------
muother_Intercept       |   0.07 | [ 0.03,   0.18] |   100% |        0% | 1.003 | 2036.00
muangular_Intercept     |   0.02 | [ 0.01,   0.04] |   100% |        0% | 1.000 | 2922.00
mutriangular_Intercept  |   0.02 | [ 0.01,   0.06] |   100% |        0% | 1.003 | 2578.00
muother_ROTATION45      |   8.59 | [ 5.51,  13.54] |   100% |        0% | 1.001 | 6637.00
muother_ROTATION90      |   3.43 | [ 2.28,   5.23] |   100% |        0% | 1.001 | 5393.00
muother_SHAPETRI        |   1.94 | [ 1.37,   2.75] | 99.98% |        0% | 1.000 | 6588.00
muangular_ROTATION45    |  19.84 | [10.99,  36.70] |   100% |        0% | 1.000 | 6152.00
muangular_ROTATION90    |   4.88 | [ 2.77,   8.66] |   100% |        0% | 1.000 | 6263.00
muangular_SHAPETRI      |   2.52 | [ 1.57,   4.10] | 99.99% |        0% | 1.000 | 6382.00
mutriangular_ROTATION45 | 127.28 | [51.81, 326.93] |   100% |        0% | 1.002 | 2276.00
mutriangular_ROTATION90 |   2.33 | [ 0.91,   5.78] | 96.17% |     6.10% | 1.002 | 2427.00
mutriangular_SHAPETRI   |   4.42 | [ 1.99,   9.77] |   100% |        0% | 1.002 | 2000.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a MCMC distribution approximation.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PROBABILITIES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICT METHOD</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(ROTATION, SHAPE, subject, q)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> newdata, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lengthen data frame to handle multinomial</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>subject, <span class="sc">-</span>q) <span class="sc">%&gt;%</span> <span class="co">#marginalize over subject and q</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>ROTATION <span class="sc">&amp;</span> <span class="sc">!</span>SHAPE,</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"preds"</span>,</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"state"</span>,</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ROTATION, SHAPE, state ) <span class="sc">%&gt;%</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(preds),</span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(preds)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwr =</span> median <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">upr =</span> median <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24  7
# Groups:   ROTATION, SHAPE [6]
   ROTATION SHAPE state             median      se       lwr    upr
   &lt;fct&gt;    &lt;fct&gt; &lt;chr&gt;              &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;
 1 0        ORTH  P(Y = angular)    0.0160 0.00219  0.0117   0.0202
 2 0        ORTH  P(Y = orthogonal) 0.783  0.00995  0.763    0.802 
 3 0        ORTH  P(Y = other)      0.0741 0.00486  0.0646   0.0836
 4 0        ORTH  P(Y = triangular) 0.0193 0.00997 -0.000204 0.0389
 5 0        TRI   P(Y = angular)    0.0237 0.00214  0.0195   0.0279
 6 0        TRI   P(Y = orthogonal) 0.654  0.00976  0.635    0.673 
 7 0        TRI   P(Y = other)      0.0820 0.00469  0.0729   0.0912
 8 0        TRI   P(Y = triangular) 0.0383 0.0101   0.0184   0.0581
 9 45       ORTH  P(Y = angular)    0.0452 0.00455  0.0363   0.0542
10 45       ORTH  P(Y = orthogonal) 0.113  0.00853  0.0962   0.130 
#  with 14 more rows</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="do">##DRAWS METHOD</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE draws from model</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% write_rds(file = "analysis/SGC4C/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="co"># #OR load from file</span></span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws &lt;- read_rds(file = "analysis/SGC4C/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # SUMMARIZE draws from model</span></span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a><span class="co"># (k &lt;- kable(draws %&gt;%</span></span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition, .category) %&gt;%</span></span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   median_hdci(.value), digits = 4, col.names =</span></span>
<span id="cb156-20"><a href="#cb156-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     c("Condition","Category", "Probability","Lower Cred.I","Upper Cred.I", "CI Width", "Point Type", "Interval Type")) %&gt;%</span></span>
<span id="cb156-21"><a href="#cb156-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   kable_styling())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="todo-inference" class="level5">
<h5 class="anchored" data-anchor-id="todo-inference">TODO INFERENCE</h5>
</section>
<section id="bayes-factor" class="level5">
<h5 class="anchored" data-anchor-id="bayes-factor">Bayes Factor</h5>
<ul>
<li>https://easystats.github.io/bayestestR/articles/bayes_factors.html</li>
</ul>
<p>Compute bayes factor for model parameters</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define null on the log odds scale as the range from -0.4 to 0.4, a 1.5X increase or decrease in odds </span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>(coef_bf <span class="ot">&lt;-</span> <span class="fu">bayesfactor</span>(m, <span class="at">null =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling priors, please wait...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factor (Null-Interval)

Parameter               |       BF
----------------------------------
muother_Intercept       | 3.27e+03
muangular_Intercept     | 3.34e+05
mutriangular_Intercept  | 1.68e+07
muother_ROTATION45      | 3.85e+07
muother_ROTATION90      | 1.56e+03
muother_SHAPETRI        |     2.04
muangular_ROTATION45    | 7.83e+09
muangular_ROTATION90    | 1.71e+03
muangular_SHAPETRI      |     9.60
mutriangular_ROTATION45 | 1.65e+10
mutriangular_ROTATION90 |    0.719
mutriangular_SHAPETRI   |    40.73

* Evidence Against The Null: [-0.400, 0.400]</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot bayes factors</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coef_bf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co">#interpretation guidelines</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_bf</span>(<span class="fu">exp</span>(coef_bf<span class="sc">$</span>log_BF), <span class="at">include_value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "extreme evidence (BF = 3.27e+03) in favour of" 
 [2] "extreme evidence (BF = 3.34e+05) in favour of" 
 [3] "extreme evidence (BF = 1.68e+07) in favour of" 
 [4] "extreme evidence (BF = 3.85e+07) in favour of" 
 [5] "extreme evidence (BF = 1.56e+03) in favour of" 
 [6] "anecdotal evidence (BF = 2.04) in favour of"   
 [7] "extreme evidence (BF = 7.83e+09) in favour of" 
 [8] "extreme evidence (BF = 1.71e+03) in favour of" 
 [9] "moderate evidence (BF = 9.60) in favour of"    
[10] "extreme evidence (BF = 1.65e+10) in favour of" 
[11] "anecdotal evidence (BF = 1/1.39) against"      
[12] "very strong evidence (BF = 40.73) in favour of"
(Rules: jeffreys1961)</code></pre>
</div>
</div>
<p><strong>TODO</strong></p>
<p>The model predicts similar probabilities for orthogonal, other, and angular interpretations by high vs.&nbsp;low working memory participants. It is only the (correct) triangular interpretation in which we have evidence for a reliable interaction between OSPAN and CONDITION.</p>
<p>It is only the (correct) triangular interpretation in which we have moderate evidence for a reliable interaction between OSPAN and CONDITION ($e^{_{interaction}} = 15.73, &nbsp; 95 % &nbsp;CI &nbsp; [0.89, 249.91], &nbsp;pd = 97.3%, BF = 3.86 $)</p>
<p>Much like the pattern of results for accuracy, it is high working memory participants with higher probability of triangular responses, but only in impasse condition.</p>
</section>
<section id="interactions" class="level5">
<h5 class="anchored" data-anchor-id="interactions">Interactions</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EMMEANS doesn't support multinomial brms models. BUMMER</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="co">#BUT brms has some built in stuffs. </span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="co"># FOR MAIN EFFECTS PLOTS </span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MAIN EFFECTS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MAIN EFFECTS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(m, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"INTERACTION PLOT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "INTERACTION PLOT"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">&lt;-</span> <span class="fu">make_conditions</span>(m, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"SHAPE"</span>))</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(m, <span class="st">"ROTATION"</span>, <span class="at">conditions =</span> conditions,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print("INTERACTION PLOT")</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="int")</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="do">## MARGINAL EFFECTS</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from easystats </span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="co"># library(modelbased)</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="co"># uses emmeans, doesn't support brms categorical </span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate_contrasts(m, test = "bf", bf_prior = m)</span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a><span class="co"># library(marginaleffects)</span></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a><span class="co"># https://vincentarelbundock.github.io/marginaleffects/articles/brms.html</span></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a><span class="do">## takes a really long time... maybe hangs machine??</span></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="co"># (mfx &lt;- marginaleffects::marginaleffects(m))</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mfx)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="print" class="level5">
<h5 class="anchored" data-anchor-id="print">Print</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="co">#model summary doesn't work for brms multinomial</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="co"># DOESN'T WORK FOR BRMS</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a><span class="co"># extract_eq(m, use_coefs = TRUE, wrap = TRUE)</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="co"># #GET MODEL ESTIMATES</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a><span class="co"># t &lt;- as.data.frame(model_parameters(m, exponentiate = TRUE))</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # #REFORMAT</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- t %&gt;%</span></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     Parameter = str_remove_all(Parameter,"_pretty"),</span></span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     Parameter = str_remove_all(Parameter,"b_mu"),</span></span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     Interpretation = word(Parameter, 1, sep = "_"),</span></span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     Interpretation = fct_relevel(Interpretation, levels = c("other","angular","triangular")),</span></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     Factor = word(Parameter, 2, sep = "_"),</span></span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     Factor = recode_factor(Factor,</span></span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "Intercept" = "(Intercept)",</span></span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "conditionimpasse" = "Condition[impasse]",</span></span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ospan" = "OSPAN[high-memory]",</span></span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "conditionimpasse:ospan" = "Condition:OSPAN"),</span></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     Median = round(Median,2),</span></span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     CI_low = round(CI_low,2),</span></span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     CI_high = round(CI_high,2),</span></span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     pd = round(pd,2),</span></span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     ROPE_Percentage = round(ROPE_Percentage,2)) %&gt;%</span></span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(Interpretation) %&gt;%</span></span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(-CI, -Rhat, -ESS) %&gt;%</span></span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename( "%_in_ROPE"="ROPE_Percentage",</span></span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   "(Odds Ratio)" = "Median") %&gt;%</span></span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(Interpretation, Factor, `(Odds Ratio)`, CI_low, CI_high, pd, `%_in_ROPE`)</span></span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # #KNIT</span></span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a><span class="co"># title = "Study 3C (OSPAN) | Question Interpretation | Mixed Multinomial Regression"</span></span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a><span class="co"># tab &lt;- kbl(x, format = "latex", caption = title,</span></span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a><span class="co">#            booktabs = FALSE) %&gt;% kable_classic() %&gt;%</span></span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a><span class="co"># footnote(general = paste("Model Interpretation ~ ",b$Model[2], "Bayes Factor ", format( exp(b$log_BF[2]), digits =2 ) ), footnote_as_chunk = T, general_title = "")</span></span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a><span class="co"># writeLines(tab, "tables/SGC3C_OSPAN_BRMS_state.tex")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-4" class="level5">
<h5 class="anchored" data-anchor-id="visualize-4">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="do">## PLOT INTERACTION</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"ROTATION"</span>,<span class="st">"SHAPE"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">connect.lines =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">fct_rev</span>(paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"nbapalettes::bulls"</span>)))<span class="sc">+</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = paletteer::paletteer_d("awtools::gpalette",3))+</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 3))+</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 2)) + </span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"MODEL | Predicted probability of correct response"</span>,</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Condition"</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Note: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'colour' is already present. Adding another scale for 'colour',
which will replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red", </span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.1, #manually adjust to account for directional test</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.90 ) + #manually adjusted for directional test   </span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Model Estimate | Odds Ratio",</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "",</span></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition")</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">TRUE</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/VIS-BRMS-STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># + theme_clean()</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0392</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 14400 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/VIS-BRMS-STATE-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/VIS-BRMS-STATE-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO see documentation for removing, reorganizing parameters</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m, <span class="at">effects =</span> <span class="st">"fixed"</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">FALSE</span>,</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">n_columns =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/VIS-BRMS-STATE-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="int",</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")  </span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "eff")  </span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="do">##WORKING</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://mjskay.github.io/ggdist/reference/stat_slab.html</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="do">## VIS probability of correct response</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REALLY LONG TIME</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co">#1 | get draws</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, ospan_split, subject, q) %&gt;%</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_epred_draws(m,</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # ndraws = 100, # n = 100,</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                    transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;% write_rds(file = "analysis/SGC4C/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds")</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a><span class="co">#OR load from file</span></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- read_rds(file = "analysis/SGC4C/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds")</span></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a><span class="co">#2| VISUALIZE PREDICTIONS | GGDIST</span></span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO figure out height normalization.</span></span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a><span class="do">##do it with much smaller number of draws </span></span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REAAALY LONG TIME</span></span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- </span></span>
<span id="cb181-28"><a href="#cb181-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-29"><a href="#cb181-29" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- draws %&gt;% sample_n(10) %&gt;% </span></span>
<span id="cb181-30"><a href="#cb181-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .epred,  y = pretty_condition, fill = ospan_split)) +</span></span>
<span id="cb181-31"><a href="#cb181-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab(width = c(.95), alpha = 0.5, normalize="xy") +</span></span>
<span id="cb181-32"><a href="#cb181-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~.category) +</span></span>
<span id="cb181-33"><a href="#cb181-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   #   #normalize = all, panels, xy, groups, none</span></span>
<span id="cb181-34"><a href="#cb181-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim(0,1) + labs(</span></span>
<span id="cb181-35"><a href="#cb181-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Predicted Probability of Correct Response",</span></span>
<span id="cb181-36"><a href="#cb181-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "probability of correct response",</span></span>
<span id="cb181-37"><a href="#cb181-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "Interpretation"</span></span>
<span id="cb181-38"><a href="#cb181-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb181-39"><a href="#cb181-39" aria-hidden="true" tabindex="-1"></a><span class="co"># # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb181-40"><a href="#cb181-40" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb181-41"><a href="#cb181-41" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(d, filename = "figures/sgc4c_BBm.cat.CrSQ_lab_posterior.svg", width = 6, height =4)</span></span>
<span id="cb181-42"><a href="#cb181-42" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Posterior Distribution

Parameter               | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS
--------------------------------------------------------------------------------------------------------
muother_Intercept       |  -2.61 | [-3.51, -1.71] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2036.00
muangular_Intercept     |  -4.18 | [-5.23, -3.14] |   100% | [-0.18, 0.18] |        0% | 1.000 | 2922.00
mutriangular_Intercept  |  -3.72 | [-4.66, -2.84] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2578.00
muother_ROTATION45      |   2.15 | [ 1.71,  2.61] |   100% | [-0.18, 0.18] |        0% | 1.001 | 6637.00
muother_ROTATION90      |   1.23 | [ 0.83,  1.65] |   100% | [-0.18, 0.18] |        0% | 1.001 | 5393.00
muother_SHAPETRI        |   0.66 | [ 0.32,  1.01] | 99.98% | [-0.18, 0.18] |        0% | 1.000 | 6588.00
muangular_ROTATION45    |   2.99 | [ 2.40,  3.60] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6152.00
muangular_ROTATION90    |   1.58 | [ 1.02,  2.16] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6263.00
muangular_SHAPETRI      |   0.92 | [ 0.45,  1.41] | 99.99% | [-0.18, 0.18] |        0% | 1.000 | 6382.00
mutriangular_ROTATION45 |   4.85 | [ 3.95,  5.79] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2276.00
mutriangular_ROTATION90 |   0.84 | [-0.09,  1.76] | 96.17% | [-0.18, 0.18] |     6.10% | 1.002 | 2427.00
mutriangular_SHAPETRI   |   1.49 | [ 0.69,  2.28] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2000.00</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="do">###VISUALIZE</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="co">#make predictions</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predictions</span>(m)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="co">#get draws</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">posteriordraws</span>(pred)</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot draws</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT ANGULAR</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">1000</span>), <span class="fu">aes</span>(<span class="at">x =</span> draw, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SHAPE <span class="sc">~</span> ROTATION) <span class="sc">+</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted probability"</span>,</span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"INTERPRETATION"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="do">## AS DENSITY RIDGES</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws <span class="sc">%&gt;%</span> <span class="fu">sample</span>(<span class="dv">100000</span>), <span class="fu">aes</span>(<span class="at">x =</span> draw, <span class="at">y =</span> ROTATION, <span class="at">fill =</span> SHAPE)) <span class="sc">+</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">rel_min_height =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(group <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted probability"</span>,</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0136</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0448</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0296</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0451</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="diagnostics-1" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK Fit of posterior predictive to data</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m, <span class="at">ndraws=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK posterior vs. priors</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">estimate_density</span>(m)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">stack =</span> <span class="cn">FALSE</span>, <span class="at">priors=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK model</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="cumulative-progress" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-progress">CUMULATIVE PROGRESS</h2>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>df_scaled <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'analysis/SGC4C/data/2-scored-data/sgc4c_scaled_progress.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5356 Columns: 7
 Column specification 
Delimiter: ","
chr (4): subject, mode, pretty_condition, SHAPE
dbl (3): question, score, ROTATION

 Use `spec()` to retrieve the full column specification for this data.
 Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>df_absolute <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'analysis/SGC4C/data/2-scored-data/sgc4c_absolute_progress.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5356 Columns: 7
 Column specification 
Delimiter: ","
chr (4): subject, mode, pretty_condition, SHAPE
dbl (3): question, score, ROTATION

 Use `spec()` to retrieve the full column specification for this data.
 Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<section id="visualize-progress-over-task" class="level3">
<h3 class="anchored" data-anchor-id="visualize-progress-over-task">Visualize Progress over Task</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE progress over time SCALED score </span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_scaled, <span class="fu">aes</span>(<span class="at">x =</span> question, <span class="at">y =</span> score, <span class="at">group =</span> subject, <span class="at">alpha =</span> <span class="fl">0.01</span>, <span class="at">color =</span> pretty_condition)) <span class="sc">+</span> </span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">w=</span><span class="fl">0.10</span>, <span class="at">h=</span><span class="fl">0.0</span>), <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_line( size=1) +</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">facet_wrap</span>(SHAPE <span class="sc">~</span> ROTATION) <span class="sc">+</span> </span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"Cumulative Scaled Score over sequence of task"</span>, <span class="at">x =</span> <span class="st">"Question"</span> , <span class="at">y =</span> <span class="st">"Cumulative Scaled Score"</span>) <span class="sc">+</span> </span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_y_continuous(lim=c(-13,13))+</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE progress over time SCALED score </span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_absolute, <span class="fu">aes</span>(<span class="at">x =</span> question, <span class="at">y =</span> score, <span class="at">group =</span> subject, <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">color =</span> pretty_condition)) <span class="sc">+</span> </span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_line(position=position_jitter(w=0.15, h=0.15), size=0.5) +</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">w=</span><span class="fl">0.15</span>, <span class="at">h=</span><span class="fl">0.15</span>), <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_line( size=1) +</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">facet_wrap</span>(SHAPE <span class="sc">~</span> ROTATION) <span class="sc">+</span> </span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"Cumulative Scaled Score over sequence of task"</span>, <span class="at">x =</span> <span class="st">"Question"</span> , <span class="at">y =</span> <span class="st">"Cumulative Scaled Score"</span>) <span class="sc">+</span> </span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_y_continuous(lim=c(0,13))+</span></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="explore-specific-question-e.g.-q-10" class="level2">
<h2 class="anchored" data-anchor-id="explore-specific-question-e.g.-q-10">EXPLORE specific question (e.g.&nbsp;Q 10)</h2>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">10</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbarstats</span>( <span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> SHAPE, <span class="at">grouping.var =</span> ROTATION)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbarstats</span>( <span class="at">data =</span> df, <span class="at">x =</span> state, <span class="at">y =</span> SHAPE, <span class="at">grouping.var =</span> ROTATION)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../analysis/SGC4C/2_sgc4C_scoring.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Response Scoring</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC4D/1_sgc4D_introduction.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb200" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'Study SGC4C | Hypothesis Testing'</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co"># YAML FOR generating modelsummary tables</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment to run those  cells only </span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="co"># \usepackage{booktabs}</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="co"># \usepackage{siunitx}</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="co"># \newcolumntype{d}{S[input-symbols = ()]}</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis Testing {#sec-SGC4C-hypotesting}</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>*The purpose of this notebook is test the hypotheses that determined the design of the SGC4C study.*</span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a><span class="co">#UTILITIES</span></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy model output</span></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed models</span></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#favstats</span></span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite) <span class="co">#saving plots as svg</span></span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-32"><a href="#cb200-32" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZATION</span></span>
<span id="cb200-33"><a href="#cb200-33" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr) #arrange plots</span></span>
<span id="cb200-34"><a href="#cb200-34" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cowplot) #arrange shift function plots</span></span>
<span id="cb200-35"><a href="#cb200-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb200-36"><a href="#cb200-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) </span>
<span id="cb200-37"><a href="#cb200-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcd) #mosaic plots</span></span>
<span id="cb200-38"><a href="#cb200-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcdExtra) #mosaic plots</span></span>
<span id="cb200-39"><a href="#cb200-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables</span></span>
<span id="cb200-40"><a href="#cb200-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb200-41"><a href="#cb200-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz</span></span>
<span id="cb200-42"><a href="#cb200-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr) <span class="co">#needed for ggdist</span></span>
<span id="cb200-43"><a href="#cb200-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves) <span class="co"># plots. in half</span></span>
<span id="cb200-44"><a href="#cb200-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># violin plot stuffs</span></span>
<span id="cb200-45"><a href="#cb200-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions)</span>
<span id="cb200-46"><a href="#cb200-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with stats</span></span>
<span id="cb200-47"><a href="#cb200-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#latex tables for models!</span></span>
<span id="cb200-48"><a href="#cb200-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange plots</span></span>
<span id="cb200-49"><a href="#cb200-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-50"><a href="#cb200-50" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELLING</span></span>
<span id="cb200-51"><a href="#cb200-51" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstatix) #helpful testing functions incl wilcoxon, etc</span></span>
<span id="cb200-52"><a href="#cb200-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb200-53"><a href="#cb200-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb200-54"><a href="#cb200-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb200-55"><a href="#cb200-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#easystats model summary and vis</span></span>
<span id="cb200-56"><a href="#cb200-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects) <span class="co">#contrasts on brms multinomials </span></span>
<span id="cb200-57"><a href="#cb200-57" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qqplotr) #confint on qq plot</span></span>
<span id="cb200-58"><a href="#cb200-58" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gmodels) #contingency table and CHISQR</span></span>
<span id="cb200-59"><a href="#cb200-59" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic) #extract model equation</span></span>
<span id="cb200-60"><a href="#cb200-60" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pscl) #zeroinfl / hurdle models </span></span>
<span id="cb200-61"><a href="#cb200-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models</span></span>
<span id="cb200-62"><a href="#cb200-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer</span></span>
<span id="cb200-63"><a href="#cb200-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools) <span class="co">#predictInterval</span></span>
<span id="cb200-64"><a href="#cb200-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co">#estimated marginal effects and posthocs on interactions</span></span>
<span id="cb200-65"><a href="#cb200-65" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects) #visualization log regr models</span></span>
<span id="cb200-66"><a href="#cb200-66" aria-hidden="true" tabindex="-1"></a><span class="co">#MULTINOMIAL </span></span>
<span id="cb200-67"><a href="#cb200-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression [not mixed] #no p values</span></span>
<span id="cb200-68"><a href="#cb200-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#frequentist mixed multinomial logistic regression [mblogit] #gives p values</span></span>
<span id="cb200-69"><a href="#cb200-69" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN</span></span>
<span id="cb200-70"><a href="#cb200-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr) <span class="co">#executing stan</span></span>
<span id="cb200-71"><a href="#cb200-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#bayesian mixed multinomials [+ other bayesian reg models]</span></span>
<span id="cb200-72"><a href="#cb200-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) </span>
<span id="cb200-73"><a href="#cb200-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb200-74"><a href="#cb200-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb200-75"><a href="#cb200-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-76"><a href="#cb200-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb200-77"><a href="#cb200-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-78"><a href="#cb200-78" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb200-79"><a href="#cb200-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb200-80"><a href="#cb200-80" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb200-81"><a href="#cb200-81" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb200-82"><a href="#cb200-82" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb200-83"><a href="#cb200-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-84"><a href="#cb200-84" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb200-85"><a href="#cb200-85" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_minimal()) </span></span>
<span id="cb200-86"><a href="#cb200-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-87"><a href="#cb200-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb200-88"><a href="#cb200-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed</span></span>
<span id="cb200-89"><a href="#cb200-89" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb200-90"><a href="#cb200-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb200-91"><a href="#cb200-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb200-92"><a href="#cb200-92" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb200-93"><a href="#cb200-93" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb200-94"><a href="#cb200-94" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb200-95"><a href="#cb200-95" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb200-96"><a href="#cb200-96" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb200-97"><a href="#cb200-97" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb200-98"><a href="#cb200-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-99"><a href="#cb200-99" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_clean</span>())</span>
<span id="cb200-100"><a href="#cb200-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-101"><a href="#cb200-101" aria-hidden="true" tabindex="-1"></a><span class="do">##IMPORT CUSTOM COLOR PALETTES</span></span>
<span id="cb200-102"><a href="#cb200-102" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"analysis/utils/foxy_palettes.R"</span>)</span>
<span id="cb200-103"><a href="#cb200-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-104"><a href="#cb200-104" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb200-105"><a href="#cb200-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-106"><a href="#cb200-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-107"><a href="#cb200-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-108"><a href="#cb200-108" aria-hidden="true" tabindex="-1"></a>In SGC4C we set out to answer the following question: Does ROTATING the TM graph improve performance on the interval graph comprehension task? We test this hypothesis on both the orthogonal and triangular axes versions of the graph. </span>
<span id="cb200-109"><a href="#cb200-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-112"><a href="#cb200-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-113"><a href="#cb200-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb200-114"><a href="#cb200-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb200-115"><a href="#cb200-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb200-116"><a href="#cb200-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-117"><a href="#cb200-117" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb200-118"><a href="#cb200-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-119"><a href="#cb200-119" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC4C/data/2-scored-data/sgc4c_scored_participants.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb200-120"><a href="#cb200-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">task_percent =</span> DV_percent_NABS</span>
<span id="cb200-121"><a href="#cb200-121" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb200-122"><a href="#cb200-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-123"><a href="#cb200-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-124"><a href="#cb200-124" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC4C/data/2-scored-data/sgc4c_scored_items.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb200-125"><a href="#cb200-125" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span> (</span>
<span id="cb200-126"><a href="#cb200-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.factor</span>(q), </span>
<span id="cb200-127"><a href="#cb200-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.factor</span>(subject),</span>
<span id="cb200-128"><a href="#cb200-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb200-129"><a href="#cb200-129" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS TRI-LIKE</span></span>
<span id="cb200-130"><a href="#cb200-130" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state = recode_factor(score_SCALED, #for ordinal</span></span>
<span id="cb200-131"><a href="#cb200-131" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-1" = "orth-like",</span></span>
<span id="cb200-132"><a href="#cb200-132" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-0.5" = "unknown",</span></span>
<span id="cb200-133"><a href="#cb200-133" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0" = "unknown",</span></span>
<span id="cb200-134"><a href="#cb200-134" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0.5" = "tri-like",</span></span>
<span id="cb200-135"><a href="#cb200-135" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "1" = "tri-like"),</span></span>
<span id="cb200-136"><a href="#cb200-136" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS OTHER</span></span>
<span id="cb200-137"><a href="#cb200-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb200-138"><a href="#cb200-138" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orthogonal"</span>,</span>
<span id="cb200-139"><a href="#cb200-139" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb200-140"><a href="#cb200-140" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb200-141"><a href="#cb200-141" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"angular"</span>,</span>
<span id="cb200-142"><a href="#cb200-142" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"triangular"</span>),</span>
<span id="cb200-143"><a href="#cb200-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">as.ordered</span>(state))</span>
<span id="cb200-144"><a href="#cb200-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-145"><a href="#cb200-145" aria-hidden="true" tabindex="-1"></a><span class="co">#validations</span></span>
<span id="cb200-146"><a href="#cb200-146" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_items)<span class="sc">/</span><span class="dv">15</span> <span class="sc">==</span> <span class="fu">nrow</span>(df_subjects)</span>
<span id="cb200-147"><a href="#cb200-147" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df_items<span class="sc">$</span>subject <span class="sc">%in%</span> df_subjects<span class="sc">$</span>subject)</span>
<span id="cb200-148"><a href="#cb200-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb200-149"><a href="#cb200-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-150"><a href="#cb200-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-151"><a href="#cb200-151" aria-hidden="true" tabindex="-1"></a><span class="fu">## SAMPLE</span></span>
<span id="cb200-152"><a href="#cb200-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-153"><a href="#cb200-153" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Collection</span></span>
<span id="cb200-154"><a href="#cb200-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-155"><a href="#cb200-155" aria-hidden="true" tabindex="-1"></a>Data was collected (online, via PROLIFIC) in Summer 2022. Data from the rotation (45, 90) conditions were joined with previously collected (online) data for for non-rotation conditions.</span>
<span id="cb200-156"><a href="#cb200-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-159"><a href="#cb200-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-160"><a href="#cb200-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : DESC-DATA-COLLECTION</span></span>
<span id="cb200-161"><a href="#cb200-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-162"><a href="#cb200-162" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Participants by Condition and Data Collection Period"</span></span>
<span id="cb200-163"><a href="#cb200-163" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Total for Period"</span>)</span>
<span id="cb200-164"><a href="#cb200-164" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">table</span>(df_subjects<span class="sc">$</span>pretty_condition)</span>
<span id="cb200-165"><a href="#cb200-165" aria-hidden="true" tabindex="-1"></a>cont <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>() <span class="sc">%&gt;%</span> <span class="fu">kbl</span>(<span class="at">caption =</span> title, <span class="at">col.names =</span> cols ) <span class="sc">%&gt;%</span>  <span class="fu">kable_classic</span>()</span>
<span id="cb200-166"><a href="#cb200-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-167"><a href="#cb200-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-168"><a href="#cb200-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-169"><a href="#cb200-169" aria-hidden="true" tabindex="-1"></a><span class="fu">### Participants</span></span>
<span id="cb200-170"><a href="#cb200-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-173"><a href="#cb200-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-174"><a href="#cb200-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-PARTICIPANTS</span></span>
<span id="cb200-175"><a href="#cb200-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-176"><a href="#cb200-176" aria-hidden="true" tabindex="-1"></a><span class="co">#Describe participants</span></span>
<span id="cb200-177"><a href="#cb200-177" aria-hidden="true" tabindex="-1"></a>subject.stats <span class="ot">&lt;-</span>df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(age) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>()</span>
<span id="cb200-178"><a href="#cb200-178" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.male <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">"Male"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb200-179"><a href="#cb200-179" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.female <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">"Female"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb200-180"><a href="#cb200-180" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.other <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"Female"</span>,<span class="st">"Male"</span>)) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb200-181"><a href="#cb200-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-182"><a href="#cb200-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-183"><a href="#cb200-183" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Participant Age and Gender"</span></span>
<span id="cb200-184"><a href="#cb200-184" aria-hidden="true" tabindex="-1"></a>subject.stats <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb200-185"><a href="#cb200-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Age in Years"</span>, </span>
<span id="cb200-186"><a href="#cb200-186" aria-hidden="true" tabindex="-1"></a>           <span class="at">general_title =</span> <span class="st">"Note: "</span>,<span class="at">footnote_as_chunk =</span> T) </span>
<span id="cb200-187"><a href="#cb200-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-188"><a href="#cb200-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-189"><a href="#cb200-189" aria-hidden="true" tabindex="-1"></a>**TODO**</span>
<span id="cb200-190"><a href="#cb200-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-191"><a href="#cb200-191" aria-hidden="true" tabindex="-1"></a>**Overall** <span class="in">`r subject.stats$n`</span> participants (<span class="in">`r round((subject.stats$percent.male),2) * 100`</span> % male, <span class="in">`r round((subject.stats$percent.female),2) * 100`</span> % female, <span class="in">`r round((subject.stats$percent.other),2) * 100`</span> % other) undergraduate STEM majors at a public American University participated in exchange for course credit (age: <span class="in">`r (subject.stats$min)`</span> - <span class="in">`r (subject.stats$max)`</span> years).</span>
<span id="cb200-192"><a href="#cb200-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-193"><a href="#cb200-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## OVERALL ACCURACY</span></span>
<span id="cb200-194"><a href="#cb200-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-195"><a href="#cb200-195" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb200-196"><a href="#cb200-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-199"><a href="#cb200-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-200"><a href="#cb200-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-ACC</span></span>
<span id="cb200-201"><a href="#cb200-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-202"><a href="#cb200-202" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb200-203"><a href="#cb200-203" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, accuracy, subject, q, SHAPE, ROTATION )</span>
<span id="cb200-204"><a href="#cb200-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-205"><a href="#cb200-205" aria-hidden="true" tabindex="-1"></a>df_s <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb200-206"><a href="#cb200-206" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, task_percent, SHAPE, ROTATION)</span>
<span id="cb200-207"><a href="#cb200-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-208"><a href="#cb200-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-209"><a href="#cb200-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-210"><a href="#cb200-210" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb200-211"><a href="#cb200-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-212"><a href="#cb200-212" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Explore</span></span>
<span id="cb200-213"><a href="#cb200-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-216"><a href="#cb200-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-217"><a href="#cb200-217" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb200-218"><a href="#cb200-218" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb200-219"><a href="#cb200-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-220"><a href="#cb200-220" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb200-221"><a href="#cb200-221" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb200-222"><a href="#cb200-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-223"><a href="#cb200-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb200-224"><a href="#cb200-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( q <span class="sc">~</span> SHAPE) <span class="sc">+</span></span>
<span id="cb200-225"><a href="#cb200-225" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accuracy by Question"</span>,</span>
<span id="cb200-226"><a href="#cb200-226" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-227"><a href="#cb200-227" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-228"><a href="#cb200-228" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Q6 and Q9 are non-discriminative"</span>)</span>
<span id="cb200-229"><a href="#cb200-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-230"><a href="#cb200-230" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: FACETED HISTOGRAM</span></span>
<span id="cb200-231"><a href="#cb200-231" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>task_percent,</span>
<span id="cb200-232"><a href="#cb200-232" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_s) <span class="sc">%&gt;%</span></span>
<span id="cb200-233"><a href="#cb200-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(SHAPE <span class="sc">~</span> ROTATION) <span class="sc">+</span></span>
<span id="cb200-234"><a href="#cb200-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb200-235"><a href="#cb200-235" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb200-236"><a href="#cb200-236" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Overall Absolute Score (% Correct)"</span>,</span>
<span id="cb200-237"><a href="#cb200-237" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb200-238"><a href="#cb200-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-239"><a href="#cb200-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-240"><a href="#cb200-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-241"><a href="#cb200-241" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Present</span></span>
<span id="cb200-242"><a href="#cb200-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-245"><a href="#cb200-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-246"><a href="#cb200-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb200-247"><a href="#cb200-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb200-248"><a href="#cb200-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-249"><a href="#cb200-249" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">grouped_ggbetweenstats</span>(<span class="at">data =</span> df_s,</span>
<span id="cb200-250"><a href="#cb200-250" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> task_percent, <span class="at">x =</span> SHAPE, <span class="at">grouping.var =</span> ROTATION,</span>
<span id="cb200-251"><a href="#cb200-251" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.type =</span> <span class="st">"box"</span>, <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb200-252"><a href="#cb200-252" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb200-253"><a href="#cb200-253" aria-hidden="true" tabindex="-1"></a>               <span class="at">results.subtitle =</span> <span class="cn">FALSE</span>,</span>
<span id="cb200-254"><a href="#cb200-254" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.point.args =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">1</span>),</span>
<span id="cb200-255"><a href="#cb200-255" aria-hidden="true" tabindex="-1"></a>               <span class="co"># point.args = list(alpha=0), #suppress points</span></span>
<span id="cb200-256"><a href="#cb200-256" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggplot.component =</span> <span class="do">## modify further with `{ggplot2}` functions</span></span>
<span id="cb200-257"><a href="#cb200-257" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(</span>
<span id="cb200-258"><a href="#cb200-258" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Percentage of correct responses across task"</span>, <span class="at">x =</span> <span class="st">""</span>),</span>
<span id="cb200-259"><a href="#cb200-259" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># aes(color = pretty_condition, fill = pretty_condition),</span></span>
<span id="cb200-260"><a href="#cb200-260" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">scale_fill_grey</span>(), <span class="fu">scale_color_grey</span>()</span>
<span id="cb200-261"><a href="#cb200-261" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 3)),</span></span>
<span id="cb200-262"><a href="#cb200-262" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_fill_manual(values = paletteer::paletteer_c("viridis::viridis", 3))</span></span>
<span id="cb200-263"><a href="#cb200-263" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># theme(axis.text.x = element_text(angle = 90)</span></span>
<span id="cb200-264"><a href="#cb200-264" aria-hidden="true" tabindex="-1"></a>                )) </span>
<span id="cb200-265"><a href="#cb200-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-266"><a href="#cb200-266" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb200-267"><a href="#cb200-267" aria-hidden="true" tabindex="-1"></a>   ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb200-268"><a href="#cb200-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-269"><a href="#cb200-269" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb200-270"><a href="#cb200-270" aria-hidden="true" tabindex="-1"></a>   ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb200-271"><a href="#cb200-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-272"><a href="#cb200-272" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p[[<span class="dv">3</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb200-273"><a href="#cb200-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb200-274"><a href="#cb200-274" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across both Graph Shapes, Partial Rotation improves performance"</span>) <span class="sc">+</span> </span>
<span id="cb200-275"><a href="#cb200-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span> ggeasy<span class="sc">::</span><span class="fu">easy_remove_axes</span>(<span class="at">which =</span> <span class="st">"x"</span>) <span class="sc">+</span> ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb200-276"><a href="#cb200-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-277"><a href="#cb200-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-278"><a href="#cb200-278" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p3, p2, p1, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb200-279"><a href="#cb200-279" aria-hidden="true" tabindex="-1"></a>pg</span>
<span id="cb200-280"><a href="#cb200-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-281"><a href="#cb200-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-282"><a href="#cb200-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-285"><a href="#cb200-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-286"><a href="#cb200-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-ACC</span></span>
<span id="cb200-287"><a href="#cb200-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-288"><a href="#cb200-288" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb200-289"><a href="#cb200-289" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb200-290"><a href="#cb200-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-291"><a href="#cb200-291" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> SHAPE,</span>
<span id="cb200-292"><a href="#cb200-292" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb200-293"><a href="#cb200-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">width =</span> <span class="fl">0.75</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-294"><a href="#cb200-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_foxy</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="st">"accuracy"</span>)  <span class="sc">+</span></span>
<span id="cb200-295"><a href="#cb200-295" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 2))+</span></span>
<span id="cb200-296"><a href="#cb200-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ROTATION)<span class="sc">+</span></span>
<span id="cb200-297"><a href="#cb200-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb200-298"><a href="#cb200-298" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION | Question Accuracy"</span>,</span>
<span id="cb200-299"><a href="#cb200-299" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-300"><a href="#cb200-300" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb200-301"><a href="#cb200-301" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-302"><a href="#cb200-302" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Across both Graph Shapes, Partial Rotation improves performance"</span>)</span>
<span id="cb200-303"><a href="#cb200-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-304"><a href="#cb200-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-305"><a href="#cb200-305" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb200-306"><a href="#cb200-306" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-307"><a href="#cb200-307" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i %&gt;% mutate(</span></span>
<span id="cb200-308"><a href="#cb200-308" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = fct_rev(accuracy)</span></span>
<span id="cb200-309"><a href="#cb200-309" aria-hidden="true" tabindex="-1"></a><span class="co"># )  </span></span>
<span id="cb200-310"><a href="#cb200-310" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-311"><a href="#cb200-311" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE PLOT WITH LABELS</span></span>
<span id="cb200-312"><a href="#cb200-312" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- grouped_ggbarstats(data = temp, x = accuracy, y = pretty_condition,</span></span>
<span id="cb200-313"><a href="#cb200-313" aria-hidden="true" tabindex="-1"></a><span class="co">#                grouping.var = ospan_split,</span></span>
<span id="cb200-314"><a href="#cb200-314" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb200-315"><a href="#cb200-315" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb200-316"><a href="#cb200-316" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb200-317"><a href="#cb200-317" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 2))</span></span>
<span id="cb200-318"><a href="#cb200-318" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb200-319"><a href="#cb200-319" aria-hidden="true" tabindex="-1"></a><span class="co">#                ))  + theme_clean() </span></span>
<span id="cb200-320"><a href="#cb200-320" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-321"><a href="#cb200-321" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIX LABELS</span></span>
<span id="cb200-322"><a href="#cb200-322" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- p[[1]] +  labs(</span></span>
<span id="cb200-323"><a href="#cb200-323" aria-hidden="true" tabindex="-1"></a><span class="co">#   subtitle = "Impasse is particularly effective for subjects with high-working memory",</span></span>
<span id="cb200-324"><a href="#cb200-324" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response"</span></span>
<span id="cb200-325"><a href="#cb200-325" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") </span></span>
<span id="cb200-326"><a href="#cb200-326" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb200-327"><a href="#cb200-327" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;-   p[[2]] + labs(</span></span>
<span id="cb200-328"><a href="#cb200-328" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response",</span></span>
<span id="cb200-329"><a href="#cb200-329" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "   "</span></span>
<span id="cb200-330"><a href="#cb200-330" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") +</span></span>
<span id="cb200-331"><a href="#cb200-331" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggeasy::easy_remove_axes(which="y", what=c("text","title"))</span></span>
<span id="cb200-332"><a href="#cb200-332" aria-hidden="true" tabindex="-1"></a><span class="co">#   # ggeasy::easy_remove_axes(which="y", what= ""))</span></span>
<span id="cb200-333"><a href="#cb200-333" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-334"><a href="#cb200-334" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE ROW</span></span>
<span id="cb200-335"><a href="#cb200-335" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-336"><a href="#cb200-336" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_row &lt;- plot_grid(p1,p2, rel_widths = c(1,0.85))</span></span>
<span id="cb200-337"><a href="#cb200-337" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-338"><a href="#cb200-338" aria-hidden="true" tabindex="-1"></a><span class="co"># title &lt;- ggdraw() + </span></span>
<span id="cb200-339"><a href="#cb200-339" aria-hidden="true" tabindex="-1"></a><span class="co">#   draw_label(</span></span>
<span id="cb200-340"><a href="#cb200-340" aria-hidden="true" tabindex="-1"></a><span class="co">#     "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb200-341"><a href="#cb200-341" aria-hidden="true" tabindex="-1"></a><span class="co">#     fontface = 'bold',</span></span>
<span id="cb200-342"><a href="#cb200-342" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0,</span></span>
<span id="cb200-343"><a href="#cb200-343" aria-hidden="true" tabindex="-1"></a><span class="co">#     hjust = 0</span></span>
<span id="cb200-344"><a href="#cb200-344" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb200-345"><a href="#cb200-345" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb200-346"><a href="#cb200-346" aria-hidden="true" tabindex="-1"></a><span class="co">#     # add margin on the left of the drawing canvas,</span></span>
<span id="cb200-347"><a href="#cb200-347" aria-hidden="true" tabindex="-1"></a><span class="co">#     # so title is aligned with left edge of first plot</span></span>
<span id="cb200-348"><a href="#cb200-348" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot.margin = margin(0, 0, 0, 7)</span></span>
<span id="cb200-349"><a href="#cb200-349" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb200-350"><a href="#cb200-350" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-351"><a href="#cb200-351" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-352"><a href="#cb200-352" aria-hidden="true" tabindex="-1"></a><span class="co"># pg &lt;- plot_grid(</span></span>
<span id="cb200-353"><a href="#cb200-353" aria-hidden="true" tabindex="-1"></a><span class="co">#   title,</span></span>
<span id="cb200-354"><a href="#cb200-354" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_row,</span></span>
<span id="cb200-355"><a href="#cb200-355" aria-hidden="true" tabindex="-1"></a><span class="co">#   ncol = 1,</span></span>
<span id="cb200-356"><a href="#cb200-356" aria-hidden="true" tabindex="-1"></a><span class="co">#   # rel_heights values control vertical title margins</span></span>
<span id="cb200-357"><a href="#cb200-357" aria-hidden="true" tabindex="-1"></a><span class="co">#   rel_heights = c(0.1, 1)</span></span>
<span id="cb200-358"><a href="#cb200-358" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean()</span></span>
<span id="cb200-359"><a href="#cb200-359" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb200-360"><a href="#cb200-360" aria-hidden="true" tabindex="-1"></a><span class="co"># pg</span></span>
<span id="cb200-361"><a href="#cb200-361" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(pg, filename = "figures/SGC4C_OSPAN_Accuracy.png", width = 6, height =4)</span></span>
<span id="cb200-362"><a href="#cb200-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-363"><a href="#cb200-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-364"><a href="#cb200-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-365"><a href="#cb200-365" aria-hidden="true" tabindex="-1"></a><span class="fu">### Describe</span></span>
<span id="cb200-366"><a href="#cb200-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-369"><a href="#cb200-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-370"><a href="#cb200-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC2-ACC</span></span>
<span id="cb200-371"><a href="#cb200-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-372"><a href="#cb200-372" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct)"</span></span>
<span id="cb200-373"><a href="#cb200-373" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span>task_percent, <span class="at">data =</span> df_s) </span>
<span id="cb200-374"><a href="#cb200-374" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb200-375"><a href="#cb200-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-376"><a href="#cb200-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-377"><a href="#cb200-377" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION"</span></span>
<span id="cb200-378"><a href="#cb200-378" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb200-379"><a href="#cb200-379" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb200-380"><a href="#cb200-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-381"><a href="#cb200-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-382"><a href="#cb200-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-383"><a href="#cb200-383" aria-hidden="true" tabindex="-1"></a>**TODO**</span>
<span id="cb200-384"><a href="#cb200-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-385"><a href="#cb200-385" aria-hidden="true" tabindex="-1"></a>Across both conditions, overall accuracy on the task ranges from <span class="in">`r tbl1$min *100`</span> to <span class="in">`r tbl1$max *100`</span> with a mean of <span class="in">`r tbl1$mean * 100`</span>. </span>
<span id="cb200-386"><a href="#cb200-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-387"><a href="#cb200-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-388"><a href="#cb200-388" aria-hidden="true" tabindex="-1"></a>Task level accuracy on the graph comprehension task follows the same pattern of behaviour observed in Study 4C: the distribution is bimodal. Total scores were higher in the impasse condition (M = 35%, SD = 41%, n = 65) than control condition (M = 15%, SD = 30%, n = 68), implying a likely main effect of scaffold condition. Comparing total scores across the median split on the OSPAN task (high working memory (vs) low working memory), we see readers with high working memory (M = 31 %, SD = 41%, n = 66) performed better than readers with low working memory (M = 19 %, SD = 31%, n = 67). In Figure \ref{fig_3C_ospan_raw_accuracy} we see that while readers in the impasse condition performed consistently better than those in the control condition, the effect is particularly pronounced for readers with high-working memory, implying a potential interaction between condition and working memory.</span>
<span id="cb200-389"><a href="#cb200-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-390"><a href="#cb200-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-391"><a href="#cb200-391" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TESTS</span></span>
<span id="cb200-392"><a href="#cb200-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-393"><a href="#cb200-393" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Aligned Ranks Transformation</span></span>
<span id="cb200-394"><a href="#cb200-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-395"><a href="#cb200-395" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- https://rcompanion.org/handbook/F_16.html --&gt;</span></span>
<span id="cb200-396"><a href="#cb200-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-399"><a href="#cb200-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-400"><a href="#cb200-400" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ARTool)</span>
<span id="cb200-401"><a href="#cb200-401" aria-hidden="true" tabindex="-1"></a>m.art <span class="ot">=</span> <span class="fu">art</span>(task_percent <span class="sc">~</span> SHAPE<span class="sc">*</span>ROTATION, <span class="at">data =</span> df_s)</span>
<span id="cb200-402"><a href="#cb200-402" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m.art)</span>
<span id="cb200-403"><a href="#cb200-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-404"><a href="#cb200-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-405"><a href="#cb200-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-406"><a href="#cb200-406" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Kruskal Wallis Test</span></span>
<span id="cb200-407"><a href="#cb200-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-410"><a href="#cb200-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-411"><a href="#cb200-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: </span><span class="al">TEST</span><span class="co">-ACC</span></span>
<span id="cb200-412"><a href="#cb200-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-413"><a href="#cb200-413" aria-hidden="true" tabindex="-1"></a>(k <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(df_s<span class="sc">$</span>task_percent <span class="sc">~</span> df_s<span class="sc">$</span>pretty_condition))</span>
<span id="cb200-414"><a href="#cb200-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-415"><a href="#cb200-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-416"><a href="#cb200-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-417"><a href="#cb200-417" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb200-418"><a href="#cb200-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-421"><a href="#cb200-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-422"><a href="#cb200-422" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: </span><span class="al">TEST</span><span class="co">-VIZ-ACC</span></span>
<span id="cb200-423"><a href="#cb200-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-424"><a href="#cb200-424" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STATSPLOT | VIOLIN</span></span>
<span id="cb200-425"><a href="#cb200-425" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbetweenstats</span>(<span class="at">y =</span> task_percent, <span class="at">x =</span> SHAPE, <span class="at">grouping.var =</span> ROTATION,  </span>
<span id="cb200-426"><a href="#cb200-426" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df_s, <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span>
<span id="cb200-427"><a href="#cb200-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-428"><a href="#cb200-428" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbetweenstats</span>(<span class="at">y =</span> task_percent, <span class="at">x =</span> ROTATION, <span class="at">grouping.var =</span> SHAPE,  </span>
<span id="cb200-429"><a href="#cb200-429" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df_s, <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span>
<span id="cb200-430"><a href="#cb200-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-431"><a href="#cb200-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-432"><a href="#cb200-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-433"><a href="#cb200-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-434"><a href="#cb200-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-435"><a href="#cb200-435" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MIXED LOGISTIC REGRESSION </span></span>
<span id="cb200-436"><a href="#cb200-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-437"><a href="#cb200-437" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.*</span>
<span id="cb200-438"><a href="#cb200-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-439"><a href="#cb200-439" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb200-440"><a href="#cb200-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-443"><a href="#cb200-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-444"><a href="#cb200-444" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-FIT-ACC</span></span>
<span id="cb200-445"><a href="#cb200-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-446"><a href="#cb200-446" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SETUP</span></span>
<span id="cb200-447"><a href="#cb200-447" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm 13 items [all discriminating items]</span></span>
<span id="cb200-448"><a href="#cb200-448" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_i) <span class="sc">/</span> <span class="fu">nrow</span>(df_s) <span class="sc">==</span> <span class="dv">13</span></span>
<span id="cb200-449"><a href="#cb200-449" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm all factors </span></span>
<span id="cb200-450"><a href="#cb200-450" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df_i<span class="sc">$</span>q) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>subject) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>pretty_condition) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>accuracy) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>ROTATION) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>SHAPE)</span>
<span id="cb200-451"><a href="#cb200-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-452"><a href="#cb200-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-453"><a href="#cb200-453" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM EFFECTS</span></span>
<span id="cb200-454"><a href="#cb200-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-455"><a href="#cb200-455" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + ITEM</span></span>
<span id="cb200-456"><a href="#cb200-456" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject Intercept + Item intercept random model"</span>)</span>
<span id="cb200-457"><a href="#cb200-457" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb200-458"><a href="#cb200-458" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.rSQ)</span></span>
<span id="cb200-459"><a href="#cb200-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-460"><a href="#cb200-460" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SIMPLE FLAT CONDITION MODEL</span></span>
<span id="cb200-461"><a href="#cb200-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-462"><a href="#cb200-462" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Item random intercepts"</span>)</span>
<span id="cb200-463"><a href="#cb200-463" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb200-464"><a href="#cb200-464" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb200-465"><a href="#cb200-465" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.CrSQ)</span></span>
<span id="cb200-466"><a href="#cb200-466" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.CrSQ)</span></span>
<span id="cb200-467"><a href="#cb200-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-468"><a href="#cb200-468" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD MAIN EFFECTS  SHAPE</span></span>
<span id="cb200-469"><a href="#cb200-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-470"><a href="#cb200-470" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Rotation + FIXED Shape + Subject &amp; Item random intercepts"</span>)</span>
<span id="cb200-471"><a href="#cb200-471" aria-hidden="true" tabindex="-1"></a>mm.R.S.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> ROTATION <span class="sc">+</span> SHAPE <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb200-472"><a href="#cb200-472" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb200-473"><a href="#cb200-473" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.R.S.rSQ)</span></span>
<span id="cb200-474"><a href="#cb200-474" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.R.S.rSQ)</span></span>
<span id="cb200-475"><a href="#cb200-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-476"><a href="#cb200-476" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.R.S.rSQ)) )</span>
<span id="cb200-477"><a href="#cb200-477" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.R.S.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb200-478"><a href="#cb200-478" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.R.S.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb200-479"><a href="#cb200-479" aria-hidden="true" tabindex="-1"></a><span class="co">#adding shape predictor improves fit</span></span>
<span id="cb200-480"><a href="#cb200-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-481"><a href="#cb200-481" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 | ADD INTERACTION TERM,</span></span>
<span id="cb200-482"><a href="#cb200-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-483"><a href="#cb200-483" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Rotation * Shape + Subject &amp; Item random intercepts"</span>)</span>
<span id="cb200-484"><a href="#cb200-484" aria-hidden="true" tabindex="-1"></a>mm.RSrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> ROTATION <span class="sc">*</span> SHAPE  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb200-485"><a href="#cb200-485" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb200-486"><a href="#cb200-486" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.RSrSQ)</span></span>
<span id="cb200-487"><a href="#cb200-487" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.RSrSQ)</span></span>
<span id="cb200-488"><a href="#cb200-488" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERACTION TERM IS NOT SIGNIFICANT. </span></span>
<span id="cb200-489"><a href="#cb200-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-490"><a href="#cb200-490" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.R.S.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.RSrSQ)) )</span>
<span id="cb200-491"><a href="#cb200-491" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.R.S.rSQ,mm.RSrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb200-492"><a href="#cb200-492" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.R.S.rSQ,mm.RSrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb200-493"><a href="#cb200-493" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood ratio and AIC indicate that adding interaction term is not justified"</span>)</span>
<span id="cb200-494"><a href="#cb200-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-495"><a href="#cb200-495" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model Performance"</span>)</span>
<span id="cb200-496"><a href="#cb200-496" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(mm.R.S.rSQ)</span>
<span id="cb200-497"><a href="#cb200-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-498"><a href="#cb200-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-499"><a href="#cb200-499" aria-hidden="true" tabindex="-1"></a>**ADD TO DISSERTATION**</span>
<span id="cb200-500"><a href="#cb200-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-501"><a href="#cb200-501" aria-hidden="true" tabindex="-1"></a>To explore the effect of working memory capacity on ACCURACY, we fit a mixed effects logistic regression model with random intercepts for subjects and questions, with SHAPE AND ROTATION as  fixed effects A likelihood ratio test indicates that a model including these main effects explains significantly more variance in the data than an intercepts-only baseline model ($\chi^2 (3,6) = 105.93, p &lt; 0.001$). We also fit a model including an interaction term between SHAPE and ROTATION, however a likelihood ratio test indicated that adding the interaction term did not improve model fit ($\chi^2 (6,8) = 0.18, p = 0.91$) Therefore we chose the simple main effects model (with random intercepts) as the final model. </span>
<span id="cb200-502"><a href="#cb200-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-503"><a href="#cb200-503" aria-hidden="true" tabindex="-1"></a> The explanatory power of the entire model is substantial ($conditional \ R^2 = 0.80$) and the part related to the fixed effects SHAPE and ROTATION ($marginal \ R^2$) explains 20% of variance.</span>
<span id="cb200-504"><a href="#cb200-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-505"><a href="#cb200-505" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb200-506"><a href="#cb200-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-509"><a href="#cb200-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-510"><a href="#cb200-510" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-ACC</span></span>
<span id="cb200-511"><a href="#cb200-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-512"><a href="#cb200-512" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb200-513"><a href="#cb200-513" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.R.S.rSQ <span class="co">#MAIN EFFECTS MODEL</span></span>
<span id="cb200-514"><a href="#cb200-514" aria-hidden="true" tabindex="-1"></a>m <span class="sc">%&gt;%</span> <span class="fu">write_rds</span>(<span class="at">file =</span> <span class="st">"analysis/SGC4C/models/sgc4c_glmer_acc_mm.R.S.rSQ.rds"</span>)</span>
<span id="cb200-515"><a href="#cb200-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-516"><a href="#cb200-516" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb200-517"><a href="#cb200-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-518"><a href="#cb200-518" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb200-519"><a href="#cb200-519" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb200-520"><a href="#cb200-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-521"><a href="#cb200-521" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFICANCE TEST [non directional]"</span>)</span>
<span id="cb200-522"><a href="#cb200-522" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">2</span>) <span class="co">#TYPE 3 SS FOR main effects</span></span>
<span id="cb200-523"><a href="#cb200-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-524"><a href="#cb200-524" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb200-525"><a href="#cb200-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-526"><a href="#cb200-526" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span>
<span id="cb200-527"><a href="#cb200-527" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb200-528"><a href="#cb200-528" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m),</span></span>
<span id="cb200-529"><a href="#cb200-529" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se,</span></span>
<span id="cb200-530"><a href="#cb200-530" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb200-531"><a href="#cb200-531" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>)</span>
<span id="cb200-532"><a href="#cb200-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-533"><a href="#cb200-533" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb200-534"><a href="#cb200-534" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb200-535"><a href="#cb200-535" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-536"><a href="#cb200-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-537"><a href="#cb200-537" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span>
<span id="cb200-538"><a href="#cb200-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-539"><a href="#cb200-539" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check</span></span>
<span id="cb200-540"><a href="#cb200-540" aria-hidden="true" tabindex="-1"></a><span class="co">#probability control = plogis(intercept)</span></span>
<span id="cb200-541"><a href="#cb200-541" aria-hidden="true" tabindex="-1"></a><span class="co">#probability impasse = plogis(intercept + coefficient)</span></span>
<span id="cb200-542"><a href="#cb200-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-543"><a href="#cb200-543" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM predict()</span></span>
<span id="cb200-544"><a href="#cb200-544" aria-hidden="true" tabindex="-1"></a><span class="co"># newdata &lt;- df_i %&gt;% dplyr::select(pretty_condition, subject, q)</span></span>
<span id="cb200-545"><a href="#cb200-545" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- predict(m, newdata = newdata, type = "response")</span></span>
<span id="cb200-546"><a href="#cb200-546" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- cbind(newdata, preds)</span></span>
<span id="cb200-547"><a href="#cb200-547" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- preds %&gt;% </span></span>
<span id="cb200-548"><a href="#cb200-548" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, preds) %&gt;% </span></span>
<span id="cb200-549"><a href="#cb200-549" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition) %&gt;% </span></span>
<span id="cb200-550"><a href="#cb200-550" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(</span></span>
<span id="cb200-551"><a href="#cb200-551" aria-hidden="true" tabindex="-1"></a><span class="co">#     median = median(preds),</span></span>
<span id="cb200-552"><a href="#cb200-552" aria-hidden="true" tabindex="-1"></a><span class="co">#     se = sd(preds)/sqrt(n()),</span></span>
<span id="cb200-553"><a href="#cb200-553" aria-hidden="true" tabindex="-1"></a><span class="co">#     lwr = median - 1.96*se,</span></span>
<span id="cb200-554"><a href="#cb200-554" aria-hidden="true" tabindex="-1"></a><span class="co">#     upr = median + 1.96*se)</span></span>
<span id="cb200-555"><a href="#cb200-555" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb200-556"><a href="#cb200-556" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-557"><a href="#cb200-557" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM merTools</span></span>
<span id="cb200-558"><a href="#cb200-558" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(ROTATION, SHAPE, subject, q)</span>
<span id="cb200-559"><a href="#cb200-559" aria-hidden="true" tabindex="-1"></a><span class="co">#make predictions</span></span>
<span id="cb200-560"><a href="#cb200-560" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predictInterval</span>(m, <span class="at">newdata =</span> newdata,</span>
<span id="cb200-561"><a href="#cb200-561" aria-hidden="true" tabindex="-1"></a>                              <span class="at">which =</span> <span class="st">"fixed"</span>, <span class="co">#full, fixed or random for those only</span></span>
<span id="cb200-562"><a href="#cb200-562" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"probability"</span>, <span class="co">#linear.prediction</span></span>
<span id="cb200-563"><a href="#cb200-563" aria-hidden="true" tabindex="-1"></a>                              <span class="at">stat =</span> <span class="st">"median"</span>,</span>
<span id="cb200-564"><a href="#cb200-564" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n.sims =</span> <span class="dv">1000</span>,</span>
<span id="cb200-565"><a href="#cb200-565" aria-hidden="true" tabindex="-1"></a>                              <span class="at">level =</span> <span class="fl">0.80</span>) <span class="co">#width of prediction interval</span></span>
<span id="cb200-566"><a href="#cb200-566" aria-hidden="true" tabindex="-1"></a><span class="co">#join predictions to the new dataframe</span></span>
<span id="cb200-567"><a href="#cb200-567" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb200-568"><a href="#cb200-568" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize</span></span>
<span id="cb200-569"><a href="#cb200-569" aria-hidden="true" tabindex="-1"></a>(summ_preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb200-570"><a href="#cb200-570" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ROTATION, SHAPE, fit, lwr, upr) <span class="sc">%&gt;%</span> </span>
<span id="cb200-571"><a href="#cb200-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ROTATION, SHAPE) <span class="sc">%&gt;%</span> </span>
<span id="cb200-572"><a href="#cb200-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb200-573"><a href="#cb200-573" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(fit),</span>
<span id="cb200-574"><a href="#cb200-574" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">median</span>(lwr),</span>
<span id="cb200-575"><a href="#cb200-575" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">median</span>(upr)</span>
<span id="cb200-576"><a href="#cb200-576" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb200-577"><a href="#cb200-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-578"><a href="#cb200-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-579"><a href="#cb200-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-580"><a href="#cb200-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-581"><a href="#cb200-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-582"><a href="#cb200-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-583"><a href="#cb200-583" aria-hidden="true" tabindex="-1"></a><span class="fu">##### INFERENCE</span></span>
<span id="cb200-584"><a href="#cb200-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-585"><a href="#cb200-585" aria-hidden="true" tabindex="-1"></a>**ADD TO DISSERTATION**</span>
<span id="cb200-586"><a href="#cb200-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-587"><a href="#cb200-587" aria-hidden="true" tabindex="-1"></a>Although Wald Chi-Square tests revealed significant main effects of both SHAPE ($\chi^2 (1) = 10.8, p &lt; 0.001$) and ROTATION ($\chi^2 (1) = 94.9, p &lt; 0.001$). </span>
<span id="cb200-588"><a href="#cb200-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-589"><a href="#cb200-589" aria-hidden="true" tabindex="-1"></a>The model predicts that, for ORTHOGONAL shaped graphs, rotating the graph from 0 to 45 degrees increases the probability of a correct response from 1% to 47%. Further rotating the graph to 90 degrees however, results in a probability of only 3%.  Posthoc comparisons indicate that the difference between 0 and 90 degree rotation is not significant (OR = 0.60, SE = 0.26 , p = 0.24)</span>
<span id="cb200-590"><a href="#cb200-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-591"><a href="#cb200-591" aria-hidden="true" tabindex="-1"></a>The model predicts that, for TRIANGULAR shaped graphs, rotating the graph from 0 to 45 degrees increases the probability of a correct response from 5% to 74%. Further rotating the graph to 90 degrees however, results in a probability of only 9%. Posthoc comparisons indicate that the difference between 0 and 90 degree rotation is not significant (OR = 0.60, SE = 0.26 = 0.25).</span>
<span id="cb200-592"><a href="#cb200-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-593"><a href="#cb200-593" aria-hidden="true" tabindex="-1"></a>Across both graph shapes, rotating the graph from 0 to 90 degrees results in a minor improvement in accuracy, while rotating the graph halfway between results in a substantial improvement in accuracy. Posthoc comparisons also reveal that across all levels of rotation, the triangular shape was significantly better than the orthogonal shape. </span>
<span id="cb200-594"><a href="#cb200-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-595"><a href="#cb200-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-596"><a href="#cb200-596" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Marginal Effects</span></span>
<span id="cb200-597"><a href="#cb200-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-600"><a href="#cb200-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-601"><a href="#cb200-601" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html#simple</span></span>
<span id="cb200-602"><a href="#cb200-602" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.oarc.ucla.edu/stata/faq/how-can-i-understand-a-categorical-by-categorical-interaction-in-logistic-regression-stata-12/</span></span>
<span id="cb200-603"><a href="#cb200-603" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.oarc.ucla.edu/stata/seminars/deciphering-interactions-in-logistic-regression/</span></span>
<span id="cb200-604"><a href="#cb200-604" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-605"><a href="#cb200-605" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb200-606"><a href="#cb200-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-607"><a href="#cb200-607" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check reference grid</span></span>
<span id="cb200-608"><a href="#cb200-608" aria-hidden="true" tabindex="-1"></a><span class="fu">ref_grid</span>(m)</span>
<span id="cb200-609"><a href="#cb200-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-610"><a href="#cb200-610" aria-hidden="true" tabindex="-1"></a><span class="co">#PRINT ESTIMATED MARGINAL MEANS</span></span>
<span id="cb200-611"><a href="#cb200-611" aria-hidden="true" tabindex="-1"></a><span class="co">#should be same as summ_preds</span></span>
<span id="cb200-612"><a href="#cb200-612" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m,  <span class="sc">~</span> ROTATION <span class="sc">+</span> SHAPE, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb200-613"><a href="#cb200-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-614"><a href="#cb200-614" aria-hidden="true" tabindex="-1"></a><span class="do">##POST-HOC COMPARISONS</span></span>
<span id="cb200-615"><a href="#cb200-615" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"POSTHOC COMPARISONS"</span>)</span>
<span id="cb200-616"><a href="#cb200-616" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m,  pairwise <span class="sc">~</span> ROTATION <span class="sc">+</span> SHAPE, </span>
<span id="cb200-617"><a href="#cb200-617" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"response"</span> , <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="co">#sidak, tukey</span></span>
<span id="cb200-618"><a href="#cb200-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-619"><a href="#cb200-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-620"><a href="#cb200-620" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT INTERACTION</span></span>
<span id="cb200-621"><a href="#cb200-621" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalent to plot_model, type = "int"</span></span>
<span id="cb200-622"><a href="#cb200-622" aria-hidden="true" tabindex="-1"></a><span class="co"># emmip(m, SHAPE * ROTATION ,</span></span>
<span id="cb200-623"><a href="#cb200-623" aria-hidden="true" tabindex="-1"></a><span class="co">#       type = "response",</span></span>
<span id="cb200-624"><a href="#cb200-624" aria-hidden="true" tabindex="-1"></a><span class="co">#       CIs = TRUE,</span></span>
<span id="cb200-625"><a href="#cb200-625" aria-hidden="true" tabindex="-1"></a><span class="co">#       linearg = list(linetype = "dashed"),</span></span>
<span id="cb200-626"><a href="#cb200-626" aria-hidden="true" tabindex="-1"></a><span class="co">#       engine = "ggplot")</span></span>
<span id="cb200-627"><a href="#cb200-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-628"><a href="#cb200-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-629"><a href="#cb200-629" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT PROBABILITY</span></span>
<span id="cb200-630"><a href="#cb200-630" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ref_grid</span>(m), <span class="at">by =</span> <span class="st">"SHAPE"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb200-631"><a href="#cb200-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-632"><a href="#cb200-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-633"><a href="#cb200-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-634"><a href="#cb200-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-635"><a href="#cb200-635" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO Print</span></span>
<span id="cb200-636"><a href="#cb200-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-639"><a href="#cb200-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-640"><a href="#cb200-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-ACC</span></span>
<span id="cb200-641"><a href="#cb200-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-642"><a href="#cb200-642" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb200-643"><a href="#cb200-643" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb200-644"><a href="#cb200-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-645"><a href="#cb200-645" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb200-646"><a href="#cb200-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-647"><a href="#cb200-647" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb200-648"><a href="#cb200-648" aria-hidden="true" tabindex="-1"></a><span class="co"># title = "Study 4C | Question Accuracy | Mixed Logistic Regression"</span></span>
<span id="cb200-649"><a href="#cb200-649" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb200-650"><a href="#cb200-650" aria-hidden="true" tabindex="-1"></a><span class="co">#              paste("n = ",n_obs(m), "R^2(Conditional) =", round(r2(m)[[1]],2),</span></span>
<span id="cb200-651"><a href="#cb200-651" aria-hidden="true" tabindex="-1"></a><span class="co">#                    "R^2(Marginal) =", round(r2(m)[[2]],2)),</span></span>
<span id="cb200-652"><a href="#cb200-652" aria-hidden="true" tabindex="-1"></a><span class="co">#              "Accuracy  ~ Condition * OSPAN +  (1 | subject) + (1 | q)")</span></span>
<span id="cb200-653"><a href="#cb200-653" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-654"><a href="#cb200-654" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb200-655"><a href="#cb200-655" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb200-656"><a href="#cb200-656" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb200-657"><a href="#cb200-657" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb200-658"><a href="#cb200-658" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb200-659"><a href="#cb200-659" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb200-660"><a href="#cb200-660" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb200-661"><a href="#cb200-661" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb200-662"><a href="#cb200-662" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb200-663"><a href="#cb200-663" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = title,</span></span>
<span id="cb200-664"><a href="#cb200-664" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb200-665"><a href="#cb200-665" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "tables/SGC3C_OSPAN_GLMER_OverallAccuracy.tex")</span></span>
<span id="cb200-666"><a href="#cb200-666" aria-hidden="true" tabindex="-1"></a><span class="co">#              # coef_omit = "Intercept",</span></span>
<span id="cb200-667"><a href="#cb200-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-668"><a href="#cb200-668" aria-hidden="true" tabindex="-1"></a><span class="co"># extract_eq(m, use_coefs = TRUE, wrap = TRUE)</span></span>
<span id="cb200-669"><a href="#cb200-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-670"><a href="#cb200-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-671"><a href="#cb200-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-672"><a href="#cb200-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-673"><a href="#cb200-673" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb200-674"><a href="#cb200-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-677"><a href="#cb200-677" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-678"><a href="#cb200-678" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-ACC</span></span>
<span id="cb200-679"><a href="#cb200-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-680"><a href="#cb200-680" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb200-681"><a href="#cb200-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-682"><a href="#cb200-682" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb200-683"><a href="#cb200-683" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb200-684"><a href="#cb200-684" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb200-685"><a href="#cb200-685" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb200-686"><a href="#cb200-686" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb200-687"><a href="#cb200-687" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb200-688"><a href="#cb200-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Estimate | Odds Ratio"</span>,</span>
<span id="cb200-689"><a href="#cb200-689" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb200-690"><a href="#cb200-690" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb200-691"><a href="#cb200-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-692"><a href="#cb200-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-693"><a href="#cb200-693" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb200-694"><a href="#cb200-694" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m, exponentiate = TRUE, component = "all")</span></span>
<span id="cb200-695"><a href="#cb200-695" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb200-696"><a href="#cb200-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-697"><a href="#cb200-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-698"><a href="#cb200-698" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb200-699"><a href="#cb200-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-700"><a href="#cb200-700" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb200-701"><a href="#cb200-701" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-702"><a href="#cb200-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-703"><a href="#cb200-703" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb200-704"><a href="#cb200-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-705"><a href="#cb200-705" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb200-706"><a href="#cb200-706" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="int",</span></span>
<span id="cb200-707"><a href="#cb200-707" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb200-708"><a href="#cb200-708" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb200-709"><a href="#cb200-709" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb200-710"><a href="#cb200-710" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb200-711"><a href="#cb200-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-712"><a href="#cb200-712" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb200-713"><a href="#cb200-713" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"SHAPE"</span>, <span class="st">"ROTATION"</span>))  </span>
<span id="cb200-714"><a href="#cb200-714" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"eff"</span>,  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"SHAPE"</span>, <span class="st">"ROTATION"</span>))  </span>
<span id="cb200-715"><a href="#cb200-715" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb200-716"><a href="#cb200-716" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb200-717"><a href="#cb200-717" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb200-718"><a href="#cb200-718" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb200-719"><a href="#cb200-719" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb200-720"><a href="#cb200-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-721"><a href="#cb200-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-722"><a href="#cb200-722" aria-hidden="true" tabindex="-1"></a><span class="co">#GGDIST | MODEL | PREDICTED PROBABILITIES</span></span>
<span id="cb200-723"><a href="#cb200-723" aria-hidden="true" tabindex="-1"></a><span class="co"># preds %&gt;% </span></span>
<span id="cb200-724"><a href="#cb200-724" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes( x = fit, y = ROTATION, fill = SHAPE)) + </span></span>
<span id="cb200-725"><a href="#cb200-725" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye(alpha = 0.5, normalize = "panels") + </span></span>
<span id="cb200-726"><a href="#cb200-726" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim(0,0.3) + theme_clean() + labs(</span></span>
<span id="cb200-727"><a href="#cb200-727" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model PREDICTION | Probability of Accurate Response",</span></span>
<span id="cb200-728"><a href="#cb200-728" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "TODO check preds to see if fixed or includes random"</span></span>
<span id="cb200-729"><a href="#cb200-729" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb200-730"><a href="#cb200-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-731"><a href="#cb200-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-732"><a href="#cb200-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-735"><a href="#cb200-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-736"><a href="#cb200-736" aria-hidden="true" tabindex="-1"></a><span class="do">## PLOT INTERACTION</span></span>
<span id="cb200-737"><a href="#cb200-737" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb200-738"><a href="#cb200-738" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"ROTATION"</span>,<span class="st">"SHAPE"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb200-739"><a href="#cb200-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">connect.lines =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb200-740"><a href="#cb200-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">fct_rev</span>(paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"nbapalettes::bulls"</span>)))<span class="sc">+</span></span>
<span id="cb200-741"><a href="#cb200-741" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = paletteer::paletteer_d("awtools::gpalette",3))+</span></span>
<span id="cb200-742"><a href="#cb200-742" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 3))+</span></span>
<span id="cb200-743"><a href="#cb200-743" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 2)) + </span></span>
<span id="cb200-744"><a href="#cb200-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb200-745"><a href="#cb200-745" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"MODEL | Predicted probability of correct response"</span>,</span>
<span id="cb200-746"><a href="#cb200-746" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"ROTATION"</span></span>
<span id="cb200-747"><a href="#cb200-747" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb200-748"><a href="#cb200-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-749"><a href="#cb200-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-750"><a href="#cb200-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-751"><a href="#cb200-751" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb200-752"><a href="#cb200-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-755"><a href="#cb200-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-756"><a href="#cb200-756" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DIAG-ACC</span></span>
<span id="cb200-757"><a href="#cb200-757" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb200-758"><a href="#cb200-758" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb200-759"><a href="#cb200-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-760"><a href="#cb200-760" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb200-761"><a href="#cb200-761" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb200-762"><a href="#cb200-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-763"><a href="#cb200-763" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PERFORMANCE")</span></span>
<span id="cb200-764"><a href="#cb200-764" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb200-765"><a href="#cb200-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-766"><a href="#cb200-766" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DIAGNOSTICS"</span>)</span>
<span id="cb200-767"><a href="#cb200-767" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span>
<span id="cb200-768"><a href="#cb200-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-769"><a href="#cb200-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-770"><a href="#cb200-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-771"><a href="#cb200-771" aria-hidden="true" tabindex="-1"></a><span class="fu">## OVERALL INTERPRETATION STATE</span></span>
<span id="cb200-772"><a href="#cb200-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-773"><a href="#cb200-773" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"orthogonal"** <span class="sc">\[</span>reference category<span class="sc">\]</span> includes orthogonal and satisficing responses ==<span class="sc">\&gt;</span> indicates a primarily *orthogonal* state of coordinate system understanding</span>
<span id="cb200-774"><a href="#cb200-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-775"><a href="#cb200-775" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"other"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =<span class="sc">\&gt;</span> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular</span>
<span id="cb200-776"><a href="#cb200-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-777"><a href="#cb200-777" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"angular"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb200-778"><a href="#cb200-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-779"><a href="#cb200-779" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"triangular"** includes correct triangular =<span class="sc">\&gt;</span> indicates a correct triangular coordinate understanding</span>
<span id="cb200-780"><a href="#cb200-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-781"><a href="#cb200-781" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb200-782"><a href="#cb200-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-785"><a href="#cb200-785" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-786"><a href="#cb200-786" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-STATE</span></span>
<span id="cb200-787"><a href="#cb200-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-788"><a href="#cb200-788" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,subject,state,pretty_condition, ROTATION, SHAPE) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb200-789"><a href="#cb200-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-790"><a href="#cb200-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-791"><a href="#cb200-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-792"><a href="#cb200-792" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb200-793"><a href="#cb200-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-796"><a href="#cb200-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-797"><a href="#cb200-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb200-798"><a href="#cb200-798" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb200-799"><a href="#cb200-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-800"><a href="#cb200-800" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb200-801"><a href="#cb200-801" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb200-802"><a href="#cb200-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-803"><a href="#cb200-803" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ROTATION,</span>
<span id="cb200-804"><a href="#cb200-804" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb200-805"><a href="#cb200-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-806"><a href="#cb200-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb200-807"><a href="#cb200-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>SHAPE) <span class="sc">+</span></span>
<span id="cb200-808"><a href="#cb200-808" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation across all Questions"</span>,</span>
<span id="cb200-809"><a href="#cb200-809" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-810"><a href="#cb200-810" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-811"><a href="#cb200-811" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb200-812"><a href="#cb200-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-813"><a href="#cb200-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-814"><a href="#cb200-814" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb200-815"><a href="#cb200-815" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb200-816"><a href="#cb200-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-817"><a href="#cb200-817" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ROTATION,</span>
<span id="cb200-818"><a href="#cb200-818" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb200-819"><a href="#cb200-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-820"><a href="#cb200-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb200-821"><a href="#cb200-821" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_brewer(palette = "Set1")  +</span></span>
<span id="cb200-822"><a href="#cb200-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(q <span class="sc">~</span> SHAPE) <span class="sc">+</span></span>
<span id="cb200-823"><a href="#cb200-823" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation by Question"</span>,</span>
<span id="cb200-824"><a href="#cb200-824" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb200-825"><a href="#cb200-825" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-826"><a href="#cb200-826" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb200-827"><a href="#cb200-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-828"><a href="#cb200-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-829"><a href="#cb200-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-832"><a href="#cb200-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-833"><a href="#cb200-833" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb200-834"><a href="#cb200-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-835"><a href="#cb200-835" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb200-836"><a href="#cb200-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb200-837"><a href="#cb200-837" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ROTATION,</span>
<span id="cb200-838"><a href="#cb200-838" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb200-839"><a href="#cb200-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb200-840"><a href="#cb200-840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_foxy</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="st">"state"</span>)  <span class="sc">+</span></span>
<span id="cb200-841"><a href="#cb200-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>SHAPE) <span class="sc">+</span></span>
<span id="cb200-842"><a href="#cb200-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION | Interpretation"</span>,</span>
<span id="cb200-843"><a href="#cb200-843" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb200-844"><a href="#cb200-844" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb200-845"><a href="#cb200-845" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb200-846"><a href="#cb200-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-847"><a href="#cb200-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-848"><a href="#cb200-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-849"><a href="#cb200-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-852"><a href="#cb200-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-853"><a href="#cb200-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb200-854"><a href="#cb200-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb200-855"><a href="#cb200-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-856"><a href="#cb200-856" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb200-857"><a href="#cb200-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-858"><a href="#cb200-858" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i %&gt;% mutate(</span></span>
<span id="cb200-859"><a href="#cb200-859" aria-hidden="true" tabindex="-1"></a><span class="co">#   state = fct_rev(state)</span></span>
<span id="cb200-860"><a href="#cb200-860" aria-hidden="true" tabindex="-1"></a><span class="co"># )  </span></span>
<span id="cb200-861"><a href="#cb200-861" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-862"><a href="#cb200-862" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;-   grouped_ggbarstats(data = temp, x = state, y = pretty_condition,</span></span>
<span id="cb200-863"><a href="#cb200-863" aria-hidden="true" tabindex="-1"></a><span class="co">#                           grouping.var = ospan_split,</span></span>
<span id="cb200-864"><a href="#cb200-864" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb200-865"><a href="#cb200-865" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb200-866"><a href="#cb200-866" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb200-867"><a href="#cb200-867" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 4))</span></span>
<span id="cb200-868"><a href="#cb200-868" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb200-869"><a href="#cb200-869" aria-hidden="true" tabindex="-1"></a><span class="co">#                ))  + theme_clean() + theme(legend.position = "bottom")</span></span>
<span id="cb200-870"><a href="#cb200-870" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-871"><a href="#cb200-871" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- p + labs(title = "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb200-872"><a href="#cb200-872" aria-hidden="true" tabindex="-1"></a><span class="co">#          y = "Proportion of Questions", x = "Condition",</span></span>
<span id="cb200-873"><a href="#cb200-873" aria-hidden="true" tabindex="-1"></a><span class="co">#          subtitle = "Impasse condition yields more correct responses")</span></span>
<span id="cb200-874"><a href="#cb200-874" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-875"><a href="#cb200-875" aria-hidden="true" tabindex="-1"></a><span class="co"># p</span></span>
<span id="cb200-876"><a href="#cb200-876" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(p, filename = "figures/SGC4C_LAB_Accuracy.png", width = 6, height =4)</span></span>
<span id="cb200-877"><a href="#cb200-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-878"><a href="#cb200-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-879"><a href="#cb200-879" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb200-880"><a href="#cb200-880" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-881"><a href="#cb200-881" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i </span></span>
<span id="cb200-882"><a href="#cb200-882" aria-hidden="true" tabindex="-1"></a><span class="co"># # %&gt;% mutate(</span></span>
<span id="cb200-883"><a href="#cb200-883" aria-hidden="true" tabindex="-1"></a><span class="co"># #   accuracy = fct_rev(accuracy)</span></span>
<span id="cb200-884"><a href="#cb200-884" aria-hidden="true" tabindex="-1"></a><span class="co"># # )</span></span>
<span id="cb200-885"><a href="#cb200-885" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-886"><a href="#cb200-886" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE PLOT WITH LABELS</span></span>
<span id="cb200-887"><a href="#cb200-887" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- grouped_ggbarstats(data = temp, x = state, y = pretty_condition,</span></span>
<span id="cb200-888"><a href="#cb200-888" aria-hidden="true" tabindex="-1"></a><span class="co">#                grouping.var = ospan_split,</span></span>
<span id="cb200-889"><a href="#cb200-889" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb200-890"><a href="#cb200-890" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb200-891"><a href="#cb200-891" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb200-892"><a href="#cb200-892" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 4))</span></span>
<span id="cb200-893"><a href="#cb200-893" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb200-894"><a href="#cb200-894" aria-hidden="true" tabindex="-1"></a><span class="co">#                )) </span></span>
<span id="cb200-895"><a href="#cb200-895" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-896"><a href="#cb200-896" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIX LABELS</span></span>
<span id="cb200-897"><a href="#cb200-897" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- p[[1]] +  labs(</span></span>
<span id="cb200-898"><a href="#cb200-898" aria-hidden="true" tabindex="-1"></a><span class="co">#   subtitle = "Impasse is particularly effective for subjects with high-working memory",</span></span>
<span id="cb200-899"><a href="#cb200-899" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response"</span></span>
<span id="cb200-900"><a href="#cb200-900" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") </span></span>
<span id="cb200-901"><a href="#cb200-901" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb200-902"><a href="#cb200-902" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;-   p[[2]] + labs(</span></span>
<span id="cb200-903"><a href="#cb200-903" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response",</span></span>
<span id="cb200-904"><a href="#cb200-904" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "   "</span></span>
<span id="cb200-905"><a href="#cb200-905" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") +</span></span>
<span id="cb200-906"><a href="#cb200-906" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggeasy::easy_remove_axes(which="y", what=c("text","title"))</span></span>
<span id="cb200-907"><a href="#cb200-907" aria-hidden="true" tabindex="-1"></a><span class="co">#   # ggeasy::easy_remove_axes(which="y", what= ""))</span></span>
<span id="cb200-908"><a href="#cb200-908" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-909"><a href="#cb200-909" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE ROW</span></span>
<span id="cb200-910"><a href="#cb200-910" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-911"><a href="#cb200-911" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_row &lt;- plot_grid(p1,p2, rel_widths = c(1,0.85))</span></span>
<span id="cb200-912"><a href="#cb200-912" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-913"><a href="#cb200-913" aria-hidden="true" tabindex="-1"></a><span class="co"># title &lt;- ggdraw() + </span></span>
<span id="cb200-914"><a href="#cb200-914" aria-hidden="true" tabindex="-1"></a><span class="co">#   draw_label(</span></span>
<span id="cb200-915"><a href="#cb200-915" aria-hidden="true" tabindex="-1"></a><span class="co">#     "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb200-916"><a href="#cb200-916" aria-hidden="true" tabindex="-1"></a><span class="co">#     fontface = 'bold',</span></span>
<span id="cb200-917"><a href="#cb200-917" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0,</span></span>
<span id="cb200-918"><a href="#cb200-918" aria-hidden="true" tabindex="-1"></a><span class="co">#     hjust = 0</span></span>
<span id="cb200-919"><a href="#cb200-919" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb200-920"><a href="#cb200-920" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb200-921"><a href="#cb200-921" aria-hidden="true" tabindex="-1"></a><span class="co">#     # add margin on the left of the drawing canvas,</span></span>
<span id="cb200-922"><a href="#cb200-922" aria-hidden="true" tabindex="-1"></a><span class="co">#     # so title is aligned with left edge of first plot</span></span>
<span id="cb200-923"><a href="#cb200-923" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot.margin = margin(0, 0, 0, 7)</span></span>
<span id="cb200-924"><a href="#cb200-924" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb200-925"><a href="#cb200-925" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-926"><a href="#cb200-926" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-927"><a href="#cb200-927" aria-hidden="true" tabindex="-1"></a><span class="co"># pg &lt;- plot_grid(</span></span>
<span id="cb200-928"><a href="#cb200-928" aria-hidden="true" tabindex="-1"></a><span class="co">#   title,</span></span>
<span id="cb200-929"><a href="#cb200-929" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_row,</span></span>
<span id="cb200-930"><a href="#cb200-930" aria-hidden="true" tabindex="-1"></a><span class="co">#   ncol = 1,</span></span>
<span id="cb200-931"><a href="#cb200-931" aria-hidden="true" tabindex="-1"></a><span class="co">#   # rel_heights values control vertical title margins</span></span>
<span id="cb200-932"><a href="#cb200-932" aria-hidden="true" tabindex="-1"></a><span class="co">#   rel_heights = c(0.1, 1)</span></span>
<span id="cb200-933"><a href="#cb200-933" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean()</span></span>
<span id="cb200-934"><a href="#cb200-934" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb200-935"><a href="#cb200-935" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-936"><a href="#cb200-936" aria-hidden="true" tabindex="-1"></a><span class="co"># update_geom_defaults("text", list(colour = "grey20", family = theme_get()$text$family))</span></span>
<span id="cb200-937"><a href="#cb200-937" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-938"><a href="#cb200-938" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-939"><a href="#cb200-939" aria-hidden="true" tabindex="-1"></a><span class="co"># pg</span></span>
<span id="cb200-940"><a href="#cb200-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-941"><a href="#cb200-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-942"><a href="#cb200-942" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(pg, filename = "figures/SGC4C_OSPAN_Accuracy.png", width = 6, height =4)</span></span>
<span id="cb200-943"><a href="#cb200-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-944"><a href="#cb200-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-945"><a href="#cb200-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-946"><a href="#cb200-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-947"><a href="#cb200-947" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe</span></span>
<span id="cb200-948"><a href="#cb200-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-951"><a href="#cb200-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-952"><a href="#cb200-952" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb200-953"><a href="#cb200-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-954"><a href="#cb200-954" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb200-955"><a href="#cb200-955" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb200-956"><a href="#cb200-956" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb200-957"><a href="#cb200-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-958"><a href="#cb200-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-959"><a href="#cb200-959" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>ROTATION, df_i<span class="sc">$</span>SHAPE) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb200-960"><a href="#cb200-960" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb200-961"><a href="#cb200-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-962"><a href="#cb200-962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-963"><a href="#cb200-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-964"><a href="#cb200-964" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MIXED MULTINOMIAL REGRESSION</span></span>
<span id="cb200-965"><a href="#cb200-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-966"><a href="#cb200-966" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of of items across the task?*</span>
<span id="cb200-967"><a href="#cb200-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-968"><a href="#cb200-968" aria-hidden="true" tabindex="-1"></a>*Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).*</span>
<span id="cb200-969"><a href="#cb200-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-970"><a href="#cb200-970" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model \[brms\]</span></span>
<span id="cb200-971"><a href="#cb200-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-974"><a href="#cb200-974" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-975"><a href="#cb200-975" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-BRMS-STATE</span></span>
<span id="cb200-976"><a href="#cb200-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-977"><a href="#cb200-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-978"><a href="#cb200-978" aria-hidden="true" tabindex="-1"></a><span class="do">##1. In order to set priors, first fit default priors model, then get prior description</span></span>
<span id="cb200-979"><a href="#cb200-979" aria-hidden="true" tabindex="-1"></a><span class="do">## in order to get class and dpar names </span></span>
<span id="cb200-980"><a href="#cb200-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-981"><a href="#cb200-981" aria-hidden="true" tabindex="-1"></a><span class="co"># FLAT MODEL</span></span>
<span id="cb200-982"><a href="#cb200-982" aria-hidden="true" tabindex="-1"></a><span class="co"># flat &lt;- brm( state ~ ROTATION+SHAPE + (1|subject) + (1|q),</span></span>
<span id="cb200-983"><a href="#cb200-983" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = df_i,</span></span>
<span id="cb200-984"><a href="#cb200-984" aria-hidden="true" tabindex="-1"></a><span class="co">#                  family = "categorical",</span></span>
<span id="cb200-985"><a href="#cb200-985" aria-hidden="true" tabindex="-1"></a><span class="co">#                  chains = 4, iter = 2000, warmup = 1000,</span></span>
<span id="cb200-986"><a href="#cb200-986" aria-hidden="true" tabindex="-1"></a><span class="co">#                  cores = 4, seed = 1234,</span></span>
<span id="cb200-987"><a href="#cb200-987" aria-hidden="true" tabindex="-1"></a><span class="co">#                  save_pars = save_pars(all = TRUE),</span></span>
<span id="cb200-988"><a href="#cb200-988" aria-hidden="true" tabindex="-1"></a><span class="co"># control = list(adapt_delta = 0.98),  # to deal with divergent transitions</span></span>
<span id="cb200-989"><a href="#cb200-989" aria-hidden="true" tabindex="-1"></a><span class="co">#                  backend = "cmdstanr")</span></span>
<span id="cb200-990"><a href="#cb200-990" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb200-991"><a href="#cb200-991" aria-hidden="true" tabindex="-1"></a><span class="co"># prior_summary(flat)</span></span>
<span id="cb200-992"><a href="#cb200-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-993"><a href="#cb200-993" aria-hidden="true" tabindex="-1"></a>inf_priors_maineffects <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb200-994"><a href="#cb200-994" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS </span></span>
<span id="cb200-995"><a href="#cb200-995" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb200-996"><a href="#cb200-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-997"><a href="#cb200-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-998"><a href="#cb200-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb200-999"><a href="#cb200-999" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on COEFFICIENT</span></span>
<span id="cb200-1000"><a href="#cb200-1000" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb200-1001"><a href="#cb200-1001" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coefficient level rotation 45</span></span>
<span id="cb200-1002"><a href="#cb200-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1003"><a href="#cb200-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1004"><a href="#cb200-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb200-1005"><a href="#cb200-1005" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coefficient level rotation 90</span></span>
<span id="cb200-1006"><a href="#cb200-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1007"><a href="#cb200-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1008"><a href="#cb200-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb200-1009"><a href="#cb200-1009" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coeficient level shape tri</span></span>
<span id="cb200-1010"><a href="#cb200-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1011"><a href="#cb200-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1012"><a href="#cb200-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb200-1013"><a href="#cb200-1013" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb200-1014"><a href="#cb200-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1015"><a href="#cb200-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1016"><a href="#cb200-1016" aria-hidden="true" tabindex="-1"></a>inf_priors_ixn <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb200-1017"><a href="#cb200-1017" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS</span></span>
<span id="cb200-1018"><a href="#cb200-1018" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb200-1019"><a href="#cb200-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1020"><a href="#cb200-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1021"><a href="#cb200-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb200-1022"><a href="#cb200-1022" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on CONDITION COEFFICIENT</span></span>
<span id="cb200-1023"><a href="#cb200-1023" aria-hidden="true" tabindex="-1"></a>   <span class="co">#coefficient level rotation 45</span></span>
<span id="cb200-1024"><a href="#cb200-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1025"><a href="#cb200-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1026"><a href="#cb200-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb200-1027"><a href="#cb200-1027" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coefficient level rotation 90</span></span>
<span id="cb200-1028"><a href="#cb200-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1029"><a href="#cb200-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1030"><a href="#cb200-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb200-1031"><a href="#cb200-1031" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coeficient level shape tri</span></span>
<span id="cb200-1032"><a href="#cb200-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1033"><a href="#cb200-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1034"><a href="#cb200-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb200-1035"><a href="#cb200-1035" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on IXN COEFFICIENT</span></span>
<span id="cb200-1036"><a href="#cb200-1036" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb200-1037"><a href="#cb200-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1038"><a href="#cb200-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1039"><a href="#cb200-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION45:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb200-1040"><a href="#cb200-1040" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-1041"><a href="#cb200-1041" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on IXN COEFFICIENT</span></span>
<span id="cb200-1042"><a href="#cb200-1042" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb200-1043"><a href="#cb200-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb200-1044"><a href="#cb200-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb200-1045"><a href="#cb200-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ROTATION90:SHAPETRI"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb200-1046"><a href="#cb200-1046" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb200-1047"><a href="#cb200-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1048"><a href="#cb200-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1049"><a href="#cb200-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN RANDOM ONLY</span></span>
<span id="cb200-1050"><a href="#cb200-1050" aria-hidden="true" tabindex="-1"></a>Bmm.cat.rSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb200-1051"><a href="#cb200-1051" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb200-1052"><a href="#cb200-1052" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb200-1053"><a href="#cb200-1053" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb200-1054"><a href="#cb200-1054" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb200-1055"><a href="#cb200-1055" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb200-1056"><a href="#cb200-1056" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb200-1057"><a href="#cb200-1057" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.rSQ.rds"</span>)</span>
<span id="cb200-1058"><a href="#cb200-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1059"><a href="#cb200-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1060"><a href="#cb200-1060" aria-hidden="true" tabindex="-1"></a><span class="co"># MAIN EFFECTSONLY MODEL</span></span>
<span id="cb200-1061"><a href="#cb200-1061" aria-hidden="true" tabindex="-1"></a>Bmm.cat.R.SrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> ROTATION <span class="sc">+</span> SHAPE <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb200-1062"><a href="#cb200-1062" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb200-1063"><a href="#cb200-1063" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> inf_priors_maineffects,</span>
<span id="cb200-1064"><a href="#cb200-1064" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb200-1065"><a href="#cb200-1065" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb200-1066"><a href="#cb200-1066" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb200-1067"><a href="#cb200-1067" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb200-1068"><a href="#cb200-1068" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb200-1069"><a href="#cb200-1069" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb200-1070"><a href="#cb200-1070" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.R.S.rSQ.rds"</span>)</span>
<span id="cb200-1071"><a href="#cb200-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1072"><a href="#cb200-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1073"><a href="#cb200-1073" aria-hidden="true" tabindex="-1"></a><span class="do">##MODEL COMPARISON</span></span>
<span id="cb200-1074"><a href="#cb200-1074" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL COMPARISON: random effects (vs) CONDITION")</span></span>
<span id="cb200-1075"><a href="#cb200-1075" aria-hidden="true" tabindex="-1"></a>(bf1 <span class="ot">&lt;-</span>  <span class="fu">bayesfactor</span>(Bmm.cat.rSQ, Bmm.cat.R.SrSQ))</span>
<span id="cb200-1076"><a href="#cb200-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#substantial evidence in favor of conditon model over random only BF 1.64e+16</span></span>
<span id="cb200-1077"><a href="#cb200-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1078"><a href="#cb200-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1079"><a href="#cb200-1079" aria-hidden="true" tabindex="-1"></a><span class="co"># # INTERACTION MODEL</span></span>
<span id="cb200-1080"><a href="#cb200-1080" aria-hidden="true" tabindex="-1"></a>Bmm.cat.RSrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> ROTATION<span class="sc">*</span>SHAPE <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q),</span>
<span id="cb200-1081"><a href="#cb200-1081" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i,</span>
<span id="cb200-1082"><a href="#cb200-1082" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> inf_priors_ixn,</span>
<span id="cb200-1083"><a href="#cb200-1083" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb200-1084"><a href="#cb200-1084" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb200-1085"><a href="#cb200-1085" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb200-1086"><a href="#cb200-1086" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb200-1087"><a href="#cb200-1087" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb200-1088"><a href="#cb200-1088" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb200-1089"><a href="#cb200-1089" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.RSrSQ.rds"</span>)</span>
<span id="cb200-1090"><a href="#cb200-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># describe_posterior(Bmm.cat.RSrSQ)</span></span>
<span id="cb200-1091"><a href="#cb200-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1092"><a href="#cb200-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1093"><a href="#cb200-1093" aria-hidden="true" tabindex="-1"></a><span class="do">##MODEL COMPARISON</span></span>
<span id="cb200-1094"><a href="#cb200-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"IS FACTORIAL better than MAIN EFFECTS model?"</span>)</span>
<span id="cb200-1095"><a href="#cb200-1095" aria-hidden="true" tabindex="-1"></a>(bf2 <span class="ot">&lt;-</span> <span class="fu">bayesfactor</span>(Bmm.cat.R.SrSQ, Bmm.cat.RSrSQ))</span>
<span id="cb200-1096"><a href="#cb200-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(Bmm.cat.R.SrSQ, Bmm.cat.RSrSQ)</span>
<span id="cb200-1097"><a href="#cb200-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1098"><a href="#cb200-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1099"><a href="#cb200-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1100"><a href="#cb200-1100" aria-hidden="true" tabindex="-1"></a>**TODO**</span>
<span id="cb200-1101"><a href="#cb200-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1102"><a href="#cb200-1102" aria-hidden="true" tabindex="-1"></a>To quantify the effect of working memory capacity on INTERPRETATION, we fit a (bayesian) mixed multinomial regression model with random intercepts for subjects and questions.</span>
<span id="cb200-1103"><a href="#cb200-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1104"><a href="#cb200-1104" aria-hidden="true" tabindex="-1"></a>A Bayes Factor model comparison (against a random intercepts only model) indicates extreme evidence for the final model including fixed (main) effects of ROTATION, SHAPE (BF = 1.99e+54). A Bayes Factor model comparison (against a model including an interaction term) indicates extreme evidence in favor of the final model including main effects only (BF = 2.10e-24). </span>
<span id="cb200-1105"><a href="#cb200-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1106"><a href="#cb200-1106" aria-hidden="true" tabindex="-1"></a>(note, the BF may change as it is estimated via simulation each time)</span>
<span id="cb200-1107"><a href="#cb200-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1108"><a href="#cb200-1108" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb200-1109"><a href="#cb200-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1112"><a href="#cb200-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1113"><a href="#cb200-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-BRMS-STATE</span></span>
<span id="cb200-1114"><a href="#cb200-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1115"><a href="#cb200-1115" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb200-1116"><a href="#cb200-1116" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> Bmm.cat.R.SrSQ <span class="co">#main effects model</span></span>
<span id="cb200-1117"><a href="#cb200-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1118"><a href="#cb200-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb200-1119"><a href="#cb200-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1120"><a href="#cb200-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb200-1121"><a href="#cb200-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb200-1122"><a href="#cb200-1122" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(<span class="at">ci=</span>.<span class="dv">95</span>, m))</span>
<span id="cb200-1123"><a href="#cb200-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1124"><a href="#cb200-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"BAYES FACTOR [comparison to RANDOM ONLY model]"</span>)</span>
<span id="cb200-1125"><a href="#cb200-1125" aria-hidden="true" tabindex="-1"></a><span class="co">#think of this like the anova(model) to get p values for each predictor</span></span>
<span id="cb200-1126"><a href="#cb200-1126" aria-hidden="true" tabindex="-1"></a><span class="co">#has to recompile the models with rstan. total drag</span></span>
<span id="cb200-1127"><a href="#cb200-1127" aria-hidden="true" tabindex="-1"></a><span class="co">#already calculated bayes factor above, this just interprets it</span></span>
<span id="cb200-1128"><a href="#cb200-1128" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_bf</span>(<span class="fu">exp</span>(bf1<span class="sc">$</span>log_BF), <span class="at">include_value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-1129"><a href="#cb200-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1130"><a href="#cb200-1130" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DESCRIBE POSTERIOR"</span>)</span>
<span id="cb200-1131"><a href="#cb200-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1132"><a href="#cb200-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb200-1133"><a href="#cb200-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1134"><a href="#cb200-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span>
<span id="cb200-1135"><a href="#cb200-1135" aria-hidden="true" tabindex="-1"></a>(l <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(m))</span>
<span id="cb200-1136"><a href="#cb200-1136" aria-hidden="true" tabindex="-1"></a><span class="co"># (tm &lt;- tidy(m,   conf.int = TRUE))</span></span>
<span id="cb200-1137"><a href="#cb200-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1138"><a href="#cb200-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb200-1139"><a href="#cb200-1139" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>))</span>
<span id="cb200-1140"><a href="#cb200-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1141"><a href="#cb200-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span>
<span id="cb200-1142"><a href="#cb200-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1143"><a href="#cb200-1143" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICT METHOD</span></span>
<span id="cb200-1144"><a href="#cb200-1144" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(ROTATION, SHAPE, subject, q)</span>
<span id="cb200-1145"><a href="#cb200-1145" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> newdata, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb200-1146"><a href="#cb200-1146" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb200-1147"><a href="#cb200-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># lengthen data frame to handle multinomial</span></span>
<span id="cb200-1148"><a href="#cb200-1148" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span></span>
<span id="cb200-1149"><a href="#cb200-1149" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>subject, <span class="sc">-</span>q) <span class="sc">%&gt;%</span> <span class="co">#marginalize over subject and q</span></span>
<span id="cb200-1150"><a href="#cb200-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb200-1151"><a href="#cb200-1151" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>ROTATION <span class="sc">&amp;</span> <span class="sc">!</span>SHAPE,</span>
<span id="cb200-1152"><a href="#cb200-1152" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"preds"</span>,</span>
<span id="cb200-1153"><a href="#cb200-1153" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"state"</span>,</span>
<span id="cb200-1154"><a href="#cb200-1154" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb200-1155"><a href="#cb200-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1156"><a href="#cb200-1156" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span></span>
<span id="cb200-1157"><a href="#cb200-1157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ROTATION, SHAPE, state ) <span class="sc">%&gt;%</span></span>
<span id="cb200-1158"><a href="#cb200-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb200-1159"><a href="#cb200-1159" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(preds),</span>
<span id="cb200-1160"><a href="#cb200-1160" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(preds)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb200-1161"><a href="#cb200-1161" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwr =</span> median <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb200-1162"><a href="#cb200-1162" aria-hidden="true" tabindex="-1"></a>    <span class="at">upr =</span> median <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se))</span>
<span id="cb200-1163"><a href="#cb200-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1164"><a href="#cb200-1164" aria-hidden="true" tabindex="-1"></a><span class="do">##DRAWS METHOD</span></span>
<span id="cb200-1165"><a href="#cb200-1165" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE draws from model</span></span>
<span id="cb200-1166"><a href="#cb200-1166" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb200-1167"><a href="#cb200-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb200-1168"><a href="#cb200-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb200-1169"><a href="#cb200-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb200-1170"><a href="#cb200-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb200-1171"><a href="#cb200-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb200-1172"><a href="#cb200-1172" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb200-1173"><a href="#cb200-1173" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% write_rds(file = "analysis/SGC4C/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb200-1174"><a href="#cb200-1174" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-1175"><a href="#cb200-1175" aria-hidden="true" tabindex="-1"></a><span class="co"># #OR load from file</span></span>
<span id="cb200-1176"><a href="#cb200-1176" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws &lt;- read_rds(file = "analysis/SGC4C/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb200-1177"><a href="#cb200-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-1178"><a href="#cb200-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># # SUMMARIZE draws from model</span></span>
<span id="cb200-1179"><a href="#cb200-1179" aria-hidden="true" tabindex="-1"></a><span class="co"># (k &lt;- kable(draws %&gt;%</span></span>
<span id="cb200-1180"><a href="#cb200-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb200-1181"><a href="#cb200-1181" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition, .category) %&gt;%</span></span>
<span id="cb200-1182"><a href="#cb200-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#   median_hdci(.value), digits = 4, col.names =</span></span>
<span id="cb200-1183"><a href="#cb200-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#     c("Condition","Category", "Probability","Lower Cred.I","Upper Cred.I", "CI Width", "Point Type", "Interval Type")) %&gt;%</span></span>
<span id="cb200-1184"><a href="#cb200-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#   kable_styling())</span></span>
<span id="cb200-1185"><a href="#cb200-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1186"><a href="#cb200-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1187"><a href="#cb200-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1188"><a href="#cb200-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO INFERENCE</span></span>
<span id="cb200-1189"><a href="#cb200-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1190"><a href="#cb200-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Bayes Factor</span></span>
<span id="cb200-1191"><a href="#cb200-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1192"><a href="#cb200-1192" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://easystats.github.io/bayestestR/articles/bayes_factors.html</span>
<span id="cb200-1193"><a href="#cb200-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1194"><a href="#cb200-1194" aria-hidden="true" tabindex="-1"></a>Compute bayes factor for model parameters</span>
<span id="cb200-1195"><a href="#cb200-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1198"><a href="#cb200-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1199"><a href="#cb200-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#define null on the log odds scale as the range from -0.4 to 0.4, a 1.5X increase or decrease in odds </span></span>
<span id="cb200-1200"><a href="#cb200-1200" aria-hidden="true" tabindex="-1"></a>(coef_bf <span class="ot">&lt;-</span> <span class="fu">bayesfactor</span>(m, <span class="at">null =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>)))</span>
<span id="cb200-1201"><a href="#cb200-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1202"><a href="#cb200-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#plot bayes factors</span></span>
<span id="cb200-1203"><a href="#cb200-1203" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coef_bf)</span>
<span id="cb200-1204"><a href="#cb200-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1205"><a href="#cb200-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#interpretation guidelines</span></span>
<span id="cb200-1206"><a href="#cb200-1206" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_bf</span>(<span class="fu">exp</span>(coef_bf<span class="sc">$</span>log_BF), <span class="at">include_value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-1207"><a href="#cb200-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1208"><a href="#cb200-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1209"><a href="#cb200-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1210"><a href="#cb200-1210" aria-hidden="true" tabindex="-1"></a>**TODO**</span>
<span id="cb200-1211"><a href="#cb200-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1212"><a href="#cb200-1212" aria-hidden="true" tabindex="-1"></a>The model predicts similar probabilities for orthogonal, other, and angular interpretations by high vs. low working memory participants. It is only the (correct) triangular interpretation in which we have evidence for a reliable interaction between OSPAN and CONDITION.</span>
<span id="cb200-1213"><a href="#cb200-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1214"><a href="#cb200-1214" aria-hidden="true" tabindex="-1"></a>It is only the (correct) triangular interpretation in which we have moderate evidence for a reliable interaction between OSPAN and CONDITION (\$e\^{\beta<span class="sc">\_</span>{interaction}} = 15.73, &nbsp; 95 % &nbsp;CI &nbsp; <span class="sc">\[</span>0.89, 249.91<span class="sc">\]</span>, &nbsp;pd = 97.3%, BF = 3.86 \$)</span>
<span id="cb200-1215"><a href="#cb200-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1216"><a href="#cb200-1216" aria-hidden="true" tabindex="-1"></a>Much like the pattern of results for accuracy, it is high working memory participants with higher probability of triangular responses, but only in impasse condition.</span>
<span id="cb200-1217"><a href="#cb200-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1218"><a href="#cb200-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Interactions</span></span>
<span id="cb200-1219"><a href="#cb200-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1222"><a href="#cb200-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1223"><a href="#cb200-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#EMMEANS doesn't support multinomial brms models. BUMMER</span></span>
<span id="cb200-1224"><a href="#cb200-1224" aria-hidden="true" tabindex="-1"></a><span class="co">#BUT brms has some built in stuffs. </span></span>
<span id="cb200-1225"><a href="#cb200-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1226"><a href="#cb200-1226" aria-hidden="true" tabindex="-1"></a><span class="co"># FOR MAIN EFFECTS PLOTS </span></span>
<span id="cb200-1227"><a href="#cb200-1227" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MAIN EFFECTS"</span>)</span>
<span id="cb200-1228"><a href="#cb200-1228" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(m, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-1229"><a href="#cb200-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1230"><a href="#cb200-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1231"><a href="#cb200-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"INTERACTION PLOT"</span>)</span>
<span id="cb200-1232"><a href="#cb200-1232" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">&lt;-</span> <span class="fu">make_conditions</span>(m, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"SHAPE"</span>))</span>
<span id="cb200-1233"><a href="#cb200-1233" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(m, <span class="st">"ROTATION"</span>, <span class="at">conditions =</span> conditions,</span>
<span id="cb200-1234"><a href="#cb200-1234" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-1235"><a href="#cb200-1235" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb200-1236"><a href="#cb200-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1237"><a href="#cb200-1237" aria-hidden="true" tabindex="-1"></a><span class="co"># print("INTERACTION PLOT")</span></span>
<span id="cb200-1238"><a href="#cb200-1238" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="int")</span></span>
<span id="cb200-1239"><a href="#cb200-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1240"><a href="#cb200-1240" aria-hidden="true" tabindex="-1"></a><span class="do">## MARGINAL EFFECTS</span></span>
<span id="cb200-1241"><a href="#cb200-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1242"><a href="#cb200-1242" aria-hidden="true" tabindex="-1"></a><span class="co"># from easystats </span></span>
<span id="cb200-1243"><a href="#cb200-1243" aria-hidden="true" tabindex="-1"></a><span class="co"># library(modelbased)</span></span>
<span id="cb200-1244"><a href="#cb200-1244" aria-hidden="true" tabindex="-1"></a><span class="co"># uses emmeans, doesn't support brms categorical </span></span>
<span id="cb200-1245"><a href="#cb200-1245" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate_contrasts(m, test = "bf", bf_prior = m)</span></span>
<span id="cb200-1246"><a href="#cb200-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1247"><a href="#cb200-1247" aria-hidden="true" tabindex="-1"></a><span class="co"># library(marginaleffects)</span></span>
<span id="cb200-1248"><a href="#cb200-1248" aria-hidden="true" tabindex="-1"></a><span class="co"># https://vincentarelbundock.github.io/marginaleffects/articles/brms.html</span></span>
<span id="cb200-1249"><a href="#cb200-1249" aria-hidden="true" tabindex="-1"></a><span class="do">## takes a really long time... maybe hangs machine??</span></span>
<span id="cb200-1250"><a href="#cb200-1250" aria-hidden="true" tabindex="-1"></a><span class="co"># (mfx &lt;- marginaleffects::marginaleffects(m))</span></span>
<span id="cb200-1251"><a href="#cb200-1251" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mfx)</span></span>
<span id="cb200-1252"><a href="#cb200-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1253"><a href="#cb200-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1254"><a href="#cb200-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1255"><a href="#cb200-1255" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Print</span></span>
<span id="cb200-1256"><a href="#cb200-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1259"><a href="#cb200-1259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1260"><a href="#cb200-1260" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-STATE</span></span>
<span id="cb200-1261"><a href="#cb200-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1262"><a href="#cb200-1262" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb200-1263"><a href="#cb200-1263" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb200-1264"><a href="#cb200-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1265"><a href="#cb200-1265" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb200-1266"><a href="#cb200-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#model summary doesn't work for brms multinomial</span></span>
<span id="cb200-1267"><a href="#cb200-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1268"><a href="#cb200-1268" aria-hidden="true" tabindex="-1"></a><span class="co"># DOESN'T WORK FOR BRMS</span></span>
<span id="cb200-1269"><a href="#cb200-1269" aria-hidden="true" tabindex="-1"></a><span class="co"># extract_eq(m, use_coefs = TRUE, wrap = TRUE)</span></span>
<span id="cb200-1270"><a href="#cb200-1270" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-1271"><a href="#cb200-1271" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-1272"><a href="#cb200-1272" aria-hidden="true" tabindex="-1"></a><span class="co"># #GET MODEL ESTIMATES</span></span>
<span id="cb200-1273"><a href="#cb200-1273" aria-hidden="true" tabindex="-1"></a><span class="co"># t &lt;- as.data.frame(model_parameters(m, exponentiate = TRUE))</span></span>
<span id="cb200-1274"><a href="#cb200-1274" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb200-1275"><a href="#cb200-1275" aria-hidden="true" tabindex="-1"></a><span class="co"># # #REFORMAT</span></span>
<span id="cb200-1276"><a href="#cb200-1276" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- t %&gt;%</span></span>
<span id="cb200-1277"><a href="#cb200-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb200-1278"><a href="#cb200-1278" aria-hidden="true" tabindex="-1"></a><span class="co">#     Parameter = str_remove_all(Parameter,"_pretty"),</span></span>
<span id="cb200-1279"><a href="#cb200-1279" aria-hidden="true" tabindex="-1"></a><span class="co">#     Parameter = str_remove_all(Parameter,"b_mu"),</span></span>
<span id="cb200-1280"><a href="#cb200-1280" aria-hidden="true" tabindex="-1"></a><span class="co">#     Interpretation = word(Parameter, 1, sep = "_"),</span></span>
<span id="cb200-1281"><a href="#cb200-1281" aria-hidden="true" tabindex="-1"></a><span class="co">#     Interpretation = fct_relevel(Interpretation, levels = c("other","angular","triangular")),</span></span>
<span id="cb200-1282"><a href="#cb200-1282" aria-hidden="true" tabindex="-1"></a><span class="co">#     Factor = word(Parameter, 2, sep = "_"),</span></span>
<span id="cb200-1283"><a href="#cb200-1283" aria-hidden="true" tabindex="-1"></a><span class="co">#     Factor = recode_factor(Factor,</span></span>
<span id="cb200-1284"><a href="#cb200-1284" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "Intercept" = "(Intercept)",</span></span>
<span id="cb200-1285"><a href="#cb200-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "conditionimpasse" = "Condition[impasse]",</span></span>
<span id="cb200-1286"><a href="#cb200-1286" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ospan" = "OSPAN[high-memory]",</span></span>
<span id="cb200-1287"><a href="#cb200-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "conditionimpasse:ospan" = "Condition:OSPAN"),</span></span>
<span id="cb200-1288"><a href="#cb200-1288" aria-hidden="true" tabindex="-1"></a><span class="co">#     Median = round(Median,2),</span></span>
<span id="cb200-1289"><a href="#cb200-1289" aria-hidden="true" tabindex="-1"></a><span class="co">#     CI_low = round(CI_low,2),</span></span>
<span id="cb200-1290"><a href="#cb200-1290" aria-hidden="true" tabindex="-1"></a><span class="co">#     CI_high = round(CI_high,2),</span></span>
<span id="cb200-1291"><a href="#cb200-1291" aria-hidden="true" tabindex="-1"></a><span class="co">#     pd = round(pd,2),</span></span>
<span id="cb200-1292"><a href="#cb200-1292" aria-hidden="true" tabindex="-1"></a><span class="co">#     ROPE_Percentage = round(ROPE_Percentage,2)) %&gt;%</span></span>
<span id="cb200-1293"><a href="#cb200-1293" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(Interpretation) %&gt;%</span></span>
<span id="cb200-1294"><a href="#cb200-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(-CI, -Rhat, -ESS) %&gt;%</span></span>
<span id="cb200-1295"><a href="#cb200-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename( "%_in_ROPE"="ROPE_Percentage",</span></span>
<span id="cb200-1296"><a href="#cb200-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#   "(Odds Ratio)" = "Median") %&gt;%</span></span>
<span id="cb200-1297"><a href="#cb200-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(Interpretation, Factor, `(Odds Ratio)`, CI_low, CI_high, pd, `%_in_ROPE`)</span></span>
<span id="cb200-1298"><a href="#cb200-1298" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-1299"><a href="#cb200-1299" aria-hidden="true" tabindex="-1"></a><span class="co"># # #KNIT</span></span>
<span id="cb200-1300"><a href="#cb200-1300" aria-hidden="true" tabindex="-1"></a><span class="co"># title = "Study 3C (OSPAN) | Question Interpretation | Mixed Multinomial Regression"</span></span>
<span id="cb200-1301"><a href="#cb200-1301" aria-hidden="true" tabindex="-1"></a><span class="co"># tab &lt;- kbl(x, format = "latex", caption = title,</span></span>
<span id="cb200-1302"><a href="#cb200-1302" aria-hidden="true" tabindex="-1"></a><span class="co">#            booktabs = FALSE) %&gt;% kable_classic() %&gt;%</span></span>
<span id="cb200-1303"><a href="#cb200-1303" aria-hidden="true" tabindex="-1"></a><span class="co"># footnote(general = paste("Model Interpretation ~ ",b$Model[2], "Bayes Factor ", format( exp(b$log_BF[2]), digits =2 ) ), footnote_as_chunk = T, general_title = "")</span></span>
<span id="cb200-1304"><a href="#cb200-1304" aria-hidden="true" tabindex="-1"></a><span class="co"># writeLines(tab, "tables/SGC3C_OSPAN_BRMS_state.tex")</span></span>
<span id="cb200-1305"><a href="#cb200-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1306"><a href="#cb200-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1307"><a href="#cb200-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1308"><a href="#cb200-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1309"><a href="#cb200-1309" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb200-1310"><a href="#cb200-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1313"><a href="#cb200-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1314"><a href="#cb200-1314" aria-hidden="true" tabindex="-1"></a><span class="do">## PLOT INTERACTION</span></span>
<span id="cb200-1315"><a href="#cb200-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb200-1316"><a href="#cb200-1316" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"ROTATION"</span>,<span class="st">"SHAPE"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb200-1317"><a href="#cb200-1317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">connect.lines =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb200-1318"><a href="#cb200-1318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">fct_rev</span>(paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"nbapalettes::bulls"</span>)))<span class="sc">+</span></span>
<span id="cb200-1319"><a href="#cb200-1319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = paletteer::paletteer_d("awtools::gpalette",3))+</span></span>
<span id="cb200-1320"><a href="#cb200-1320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 3))+</span></span>
<span id="cb200-1321"><a href="#cb200-1321" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 2)) + </span></span>
<span id="cb200-1322"><a href="#cb200-1322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb200-1323"><a href="#cb200-1323" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"MODEL | Predicted probability of correct response"</span>,</span>
<span id="cb200-1324"><a href="#cb200-1324" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Condition"</span></span>
<span id="cb200-1325"><a href="#cb200-1325" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb200-1326"><a href="#cb200-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1327"><a href="#cb200-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1328"><a href="#cb200-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1331"><a href="#cb200-1331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1332"><a href="#cb200-1332" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-BRMS-STATE</span></span>
<span id="cb200-1333"><a href="#cb200-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1334"><a href="#cb200-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1335"><a href="#cb200-1335" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb200-1336"><a href="#cb200-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1337"><a href="#cb200-1337" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb200-1338"><a href="#cb200-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red", </span></span>
<span id="cb200-1339"><a href="#cb200-1339" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb200-1340"><a href="#cb200-1340" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb200-1341"><a href="#cb200-1341" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.1, #manually adjust to account for directional test</span></span>
<span id="cb200-1342"><a href="#cb200-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.90 ) + #manually adjusted for directional test   </span></span>
<span id="cb200-1343"><a href="#cb200-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Model Estimate | Odds Ratio",</span></span>
<span id="cb200-1344"><a href="#cb200-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "",</span></span>
<span id="cb200-1345"><a href="#cb200-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition")</span></span>
<span id="cb200-1346"><a href="#cb200-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1347"><a href="#cb200-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1348"><a href="#cb200-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb200-1349"><a href="#cb200-1349" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb200-1350"><a href="#cb200-1350" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">TRUE</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>) </span>
<span id="cb200-1351"><a href="#cb200-1351" aria-hidden="true" tabindex="-1"></a><span class="co"># + theme_clean()</span></span>
<span id="cb200-1352"><a href="#cb200-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1353"><a href="#cb200-1353" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb200-1354"><a href="#cb200-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1355"><a href="#cb200-1355" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb200-1356"><a href="#cb200-1356" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-1357"><a href="#cb200-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1358"><a href="#cb200-1358" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb200-1359"><a href="#cb200-1359" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb200-1360"><a href="#cb200-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1361"><a href="#cb200-1361" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO see documentation for removing, reorganizing parameters</span></span>
<span id="cb200-1362"><a href="#cb200-1362" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m, <span class="at">effects =</span> <span class="st">"fixed"</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb200-1363"><a href="#cb200-1363" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">FALSE</span>,</span>
<span id="cb200-1364"><a href="#cb200-1364" aria-hidden="true" tabindex="-1"></a>     <span class="at">n_columns =</span> <span class="dv">3</span>)</span>
<span id="cb200-1365"><a href="#cb200-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1366"><a href="#cb200-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1367"><a href="#cb200-1367" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb200-1368"><a href="#cb200-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1369"><a href="#cb200-1369" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb200-1370"><a href="#cb200-1370" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="int",</span></span>
<span id="cb200-1371"><a href="#cb200-1371" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb200-1372"><a href="#cb200-1372" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb200-1373"><a href="#cb200-1373" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb200-1374"><a href="#cb200-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb200-1375"><a href="#cb200-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1376"><a href="#cb200-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb200-1377"><a href="#cb200-1377" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")  </span></span>
<span id="cb200-1378"><a href="#cb200-1378" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "eff")  </span></span>
<span id="cb200-1379"><a href="#cb200-1379" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb200-1380"><a href="#cb200-1380" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb200-1381"><a href="#cb200-1381" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb200-1382"><a href="#cb200-1382" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb200-1383"><a href="#cb200-1383" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb200-1384"><a href="#cb200-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1385"><a href="#cb200-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1386"><a href="#cb200-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1389"><a href="#cb200-1389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1390"><a href="#cb200-1390" aria-hidden="true" tabindex="-1"></a><span class="co">#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE</span></span>
<span id="cb200-1391"><a href="#cb200-1391" aria-hidden="true" tabindex="-1"></a><span class="do">##WORKING</span></span>
<span id="cb200-1392"><a href="#cb200-1392" aria-hidden="true" tabindex="-1"></a><span class="co"># https://mjskay.github.io/ggdist/reference/stat_slab.html</span></span>
<span id="cb200-1393"><a href="#cb200-1393" aria-hidden="true" tabindex="-1"></a><span class="do">## VIS probability of correct response</span></span>
<span id="cb200-1394"><a href="#cb200-1394" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REALLY LONG TIME</span></span>
<span id="cb200-1395"><a href="#cb200-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1396"><a href="#cb200-1396" aria-hidden="true" tabindex="-1"></a><span class="co">#1 | get draws</span></span>
<span id="cb200-1397"><a href="#cb200-1397" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb200-1398"><a href="#cb200-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, ospan_split, subject, q) %&gt;%</span></span>
<span id="cb200-1399"><a href="#cb200-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_epred_draws(m,</span></span>
<span id="cb200-1400"><a href="#cb200-1400" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # ndraws = 100, # n = 100,</span></span>
<span id="cb200-1401"><a href="#cb200-1401" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb200-1402"><a href="#cb200-1402" aria-hidden="true" tabindex="-1"></a><span class="co">#                    transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb200-1403"><a href="#cb200-1403" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb200-1404"><a href="#cb200-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1405"><a href="#cb200-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1406"><a href="#cb200-1406" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;% write_rds(file = "analysis/SGC4C/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds")</span></span>
<span id="cb200-1407"><a href="#cb200-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1408"><a href="#cb200-1408" aria-hidden="true" tabindex="-1"></a><span class="co">#OR load from file</span></span>
<span id="cb200-1409"><a href="#cb200-1409" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- read_rds(file = "analysis/SGC4C/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds")</span></span>
<span id="cb200-1410"><a href="#cb200-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1411"><a href="#cb200-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#2| VISUALIZE PREDICTIONS | GGDIST</span></span>
<span id="cb200-1412"><a href="#cb200-1412" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO figure out height normalization.</span></span>
<span id="cb200-1413"><a href="#cb200-1413" aria-hidden="true" tabindex="-1"></a><span class="do">##do it with much smaller number of draws </span></span>
<span id="cb200-1414"><a href="#cb200-1414" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb200-1415"><a href="#cb200-1415" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REAAALY LONG TIME</span></span>
<span id="cb200-1416"><a href="#cb200-1416" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- </span></span>
<span id="cb200-1417"><a href="#cb200-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1418"><a href="#cb200-1418" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- draws %&gt;% sample_n(10) %&gt;% </span></span>
<span id="cb200-1419"><a href="#cb200-1419" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .epred,  y = pretty_condition, fill = ospan_split)) +</span></span>
<span id="cb200-1420"><a href="#cb200-1420" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab(width = c(.95), alpha = 0.5, normalize="xy") +</span></span>
<span id="cb200-1421"><a href="#cb200-1421" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~.category) +</span></span>
<span id="cb200-1422"><a href="#cb200-1422" aria-hidden="true" tabindex="-1"></a><span class="co">#   #   #normalize = all, panels, xy, groups, none</span></span>
<span id="cb200-1423"><a href="#cb200-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim(0,1) + labs(</span></span>
<span id="cb200-1424"><a href="#cb200-1424" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Predicted Probability of Correct Response",</span></span>
<span id="cb200-1425"><a href="#cb200-1425" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "probability of correct response",</span></span>
<span id="cb200-1426"><a href="#cb200-1426" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "Interpretation"</span></span>
<span id="cb200-1427"><a href="#cb200-1427" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb200-1428"><a href="#cb200-1428" aria-hidden="true" tabindex="-1"></a><span class="co"># # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb200-1429"><a href="#cb200-1429" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb200-1430"><a href="#cb200-1430" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(d, filename = "figures/sgc4c_BBm.cat.CrSQ_lab_posterior.svg", width = 6, height =4)</span></span>
<span id="cb200-1431"><a href="#cb200-1431" aria-hidden="true" tabindex="-1"></a>d</span>
<span id="cb200-1432"><a href="#cb200-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1433"><a href="#cb200-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1436"><a href="#cb200-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1437"><a href="#cb200-1437" aria-hidden="true" tabindex="-1"></a><span class="do">###VISUALIZE</span></span>
<span id="cb200-1438"><a href="#cb200-1438" aria-hidden="true" tabindex="-1"></a><span class="co">#make predictions</span></span>
<span id="cb200-1439"><a href="#cb200-1439" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predictions</span>(m)</span>
<span id="cb200-1440"><a href="#cb200-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1441"><a href="#cb200-1441" aria-hidden="true" tabindex="-1"></a><span class="co">#get draws</span></span>
<span id="cb200-1442"><a href="#cb200-1442" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">posteriordraws</span>(pred)</span>
<span id="cb200-1443"><a href="#cb200-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1444"><a href="#cb200-1444" aria-hidden="true" tabindex="-1"></a><span class="co">#plot draws</span></span>
<span id="cb200-1445"><a href="#cb200-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1446"><a href="#cb200-1446" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT ANGULAR</span></span>
<span id="cb200-1447"><a href="#cb200-1447" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">1000</span>), <span class="fu">aes</span>(<span class="at">x =</span> draw, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb200-1448"><a href="#cb200-1448" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb200-1449"><a href="#cb200-1449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SHAPE <span class="sc">~</span> ROTATION) <span class="sc">+</span></span>
<span id="cb200-1450"><a href="#cb200-1450" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted probability"</span>,</span>
<span id="cb200-1451"><a href="#cb200-1451" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb200-1452"><a href="#cb200-1452" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"INTERPRETATION"</span>)</span>
<span id="cb200-1453"><a href="#cb200-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1454"><a href="#cb200-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1455"><a href="#cb200-1455" aria-hidden="true" tabindex="-1"></a><span class="do">## AS DENSITY RIDGES</span></span>
<span id="cb200-1456"><a href="#cb200-1456" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws <span class="sc">%&gt;%</span> <span class="fu">sample</span>(<span class="dv">100000</span>), <span class="fu">aes</span>(<span class="at">x =</span> draw, <span class="at">y =</span> ROTATION, <span class="at">fill =</span> SHAPE)) <span class="sc">+</span></span>
<span id="cb200-1457"><a href="#cb200-1457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">rel_min_height =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb200-1458"><a href="#cb200-1458" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(group <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb200-1459"><a href="#cb200-1459" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted probability"</span>,</span>
<span id="cb200-1460"><a href="#cb200-1460" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb200-1461"><a href="#cb200-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1462"><a href="#cb200-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1463"><a href="#cb200-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1464"><a href="#cb200-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1465"><a href="#cb200-1465" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb200-1466"><a href="#cb200-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1469"><a href="#cb200-1469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1470"><a href="#cb200-1470" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK Fit of posterior predictive to data</span></span>
<span id="cb200-1471"><a href="#cb200-1471" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m, <span class="at">ndraws=</span><span class="dv">1000</span>)</span>
<span id="cb200-1472"><a href="#cb200-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1473"><a href="#cb200-1473" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK posterior vs. priors</span></span>
<span id="cb200-1474"><a href="#cb200-1474" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">estimate_density</span>(m)</span>
<span id="cb200-1475"><a href="#cb200-1475" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">stack =</span> <span class="cn">FALSE</span>, <span class="at">priors=</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-1476"><a href="#cb200-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1477"><a href="#cb200-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK model</span></span>
<span id="cb200-1478"><a href="#cb200-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span>
<span id="cb200-1479"><a href="#cb200-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1480"><a href="#cb200-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1481"><a href="#cb200-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1482"><a href="#cb200-1482" aria-hidden="true" tabindex="-1"></a><span class="fu">## CUMULATIVE PROGRESS</span></span>
<span id="cb200-1483"><a href="#cb200-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1486"><a href="#cb200-1486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1487"><a href="#cb200-1487" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP</span></span>
<span id="cb200-1488"><a href="#cb200-1488" aria-hidden="true" tabindex="-1"></a>df_scaled <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'analysis/SGC4C/data/2-scored-data/sgc4c_scaled_progress.csv'</span>)</span>
<span id="cb200-1489"><a href="#cb200-1489" aria-hidden="true" tabindex="-1"></a>df_absolute <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'analysis/SGC4C/data/2-scored-data/sgc4c_absolute_progress.csv'</span>)</span>
<span id="cb200-1490"><a href="#cb200-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1491"><a href="#cb200-1491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1492"><a href="#cb200-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1493"><a href="#cb200-1493" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualize Progress over Task</span></span>
<span id="cb200-1494"><a href="#cb200-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1497"><a href="#cb200-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1498"><a href="#cb200-1498" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE progress over time SCALED score </span></span>
<span id="cb200-1499"><a href="#cb200-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_scaled, <span class="fu">aes</span>(<span class="at">x =</span> question, <span class="at">y =</span> score, <span class="at">group =</span> subject, <span class="at">alpha =</span> <span class="fl">0.01</span>, <span class="at">color =</span> pretty_condition)) <span class="sc">+</span> </span>
<span id="cb200-1500"><a href="#cb200-1500" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">w=</span><span class="fl">0.10</span>, <span class="at">h=</span><span class="fl">0.0</span>), <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb200-1501"><a href="#cb200-1501" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_line( size=1) +</span></span>
<span id="cb200-1502"><a href="#cb200-1502" aria-hidden="true" tabindex="-1"></a> <span class="fu">facet_wrap</span>(SHAPE <span class="sc">~</span> ROTATION) <span class="sc">+</span> </span>
<span id="cb200-1503"><a href="#cb200-1503" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"Cumulative Scaled Score over sequence of task"</span>, <span class="at">x =</span> <span class="st">"Question"</span> , <span class="at">y =</span> <span class="st">"Cumulative Scaled Score"</span>) <span class="sc">+</span> </span>
<span id="cb200-1504"><a href="#cb200-1504" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb200-1505"><a href="#cb200-1505" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_y_continuous(lim=c(-13,13))+</span></span>
<span id="cb200-1506"><a href="#cb200-1506" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb200-1507"><a href="#cb200-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1508"><a href="#cb200-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1509"><a href="#cb200-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1510"><a href="#cb200-1510" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE progress over time SCALED score </span></span>
<span id="cb200-1511"><a href="#cb200-1511" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_absolute, <span class="fu">aes</span>(<span class="at">x =</span> question, <span class="at">y =</span> score, <span class="at">group =</span> subject, <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">color =</span> pretty_condition)) <span class="sc">+</span> </span>
<span id="cb200-1512"><a href="#cb200-1512" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_line(position=position_jitter(w=0.15, h=0.15), size=0.5) +</span></span>
<span id="cb200-1513"><a href="#cb200-1513" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">w=</span><span class="fl">0.15</span>, <span class="at">h=</span><span class="fl">0.15</span>), <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb200-1514"><a href="#cb200-1514" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_line( size=1) +</span></span>
<span id="cb200-1515"><a href="#cb200-1515" aria-hidden="true" tabindex="-1"></a> <span class="fu">facet_wrap</span>(SHAPE <span class="sc">~</span> ROTATION) <span class="sc">+</span> </span>
<span id="cb200-1516"><a href="#cb200-1516" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"Cumulative Scaled Score over sequence of task"</span>, <span class="at">x =</span> <span class="st">"Question"</span> , <span class="at">y =</span> <span class="st">"Cumulative Scaled Score"</span>) <span class="sc">+</span> </span>
<span id="cb200-1517"><a href="#cb200-1517" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb200-1518"><a href="#cb200-1518" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_y_continuous(lim=c(0,13))+</span></span>
<span id="cb200-1519"><a href="#cb200-1519" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb200-1520"><a href="#cb200-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1521"><a href="#cb200-1521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb200-1522"><a href="#cb200-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1523"><a href="#cb200-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1524"><a href="#cb200-1524" aria-hidden="true" tabindex="-1"></a><span class="fu">## EXPLORE specific question (e.g. Q 10)</span></span>
<span id="cb200-1525"><a href="#cb200-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1528"><a href="#cb200-1528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb200-1529"><a href="#cb200-1529" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">10</span>)</span>
<span id="cb200-1530"><a href="#cb200-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1531"><a href="#cb200-1531" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbarstats</span>( <span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> SHAPE, <span class="at">grouping.var =</span> ROTATION)</span>
<span id="cb200-1532"><a href="#cb200-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1533"><a href="#cb200-1533" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbarstats</span>( <span class="at">data =</span> df, <span class="at">x =</span> state, <span class="at">y =</span> SHAPE, <span class="at">grouping.var =</span> ROTATION)</span>
<span id="cb200-1534"><a href="#cb200-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-1535"><a href="#cb200-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>