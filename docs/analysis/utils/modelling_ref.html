<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.328">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SGC-X - Modelling Reference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../analysis/SGC2/1_sgc2_introduction.html" rel="next">
<link href="../../analysis/utils/scoring.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Modelling Reference</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/modelling_ref.html" class="sidebar-item-text sidebar-link active">Modelling Reference</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC2</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/3_sgc2_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/4_sgc2_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_lab_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">SGC3A (Lab) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SGC3A (Replication) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_ospan_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">SGC3 (OSPAN) Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/4_sgc3B_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">SGC3B (Impasse * Explicit) Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/3_sgc4A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">SGC4C</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/1_sgc4C_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/2_sgc4C_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">SGC5A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/1_sgc5A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/2_sgc5A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#independent-samples" id="toc-independent-samples" class="nav-link active" data-scroll-target="#independent-samples"> <span class="header-section-number">4</span> INDEPENDENT SAMPLES</a>
  <ul class="collapse">
  <li><a href="#continuous-outcome" id="toc-continuous-outcome" class="nav-link" data-scroll-target="#continuous-outcome">CONTINUOUS OUTCOME</a>
  <ul class="collapse">
  <li><a href="#independent-samples-t-test-students-t" id="toc-independent-samples-t-test-students-t" class="nav-link" data-scroll-target="#independent-samples-t-test-students-t">Independent Samples T-Test (Student’s T)</a></li>
  <li><a href="#independent-samples-t-test-welchs-t" id="toc-independent-samples-t-test-welchs-t" class="nav-link" data-scroll-target="#independent-samples-t-test-welchs-t">Independent Samples T-Test (Welch’s T)</a></li>
  <li><a href="#yuens-t-test-trimmed-means" id="toc-yuens-t-test-trimmed-means" class="nav-link" data-scroll-target="#yuens-t-test-trimmed-means">Yuen’s T-Test (Trimmed Means)</a></li>
  <li><a href="#wilcoxon-rank-sum-mann-whitney-test" id="toc-wilcoxon-rank-sum-mann-whitney-test" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-mann-whitney-test">Wilcoxon Rank Sum (Mann-Whitney Test)</a></li>
  <li><a href="#floorceiling-corrections-wilcoxon-rank-sum" id="toc-floorceiling-corrections-wilcoxon-rank-sum" class="nav-link" data-scroll-target="#floorceiling-corrections-wilcoxon-rank-sum">Floor/Ceiling Corrections + Wilcoxon Rank Sum</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#censored-tobit-regression" id="toc-censored-tobit-regression" class="nav-link" data-scroll-target="#censored-tobit-regression">Censored (Tobit) Regression</a></li>
  </ul></li>
  <li><a href="#count-outcome" id="toc-count-outcome" class="nav-link" data-scroll-target="#count-outcome">COUNT OUTCOME</a>
  <ul class="collapse">
  <li><a href="#poisson-regression" id="toc-poisson-regression" class="nav-link" data-scroll-target="#poisson-regression">Poisson Regression</a></li>
  <li><a href="#negative-binomial-regression" id="toc-negative-binomial-regression" class="nav-link" data-scroll-target="#negative-binomial-regression">Negative Binomial Regression</a></li>
  </ul></li>
  <li><a href="#mixture-models" id="toc-mixture-models" class="nav-link" data-scroll-target="#mixture-models">MIXTURE MODELS</a>
  <ul class="collapse">
  <li><a href="#zero-inflated-poisson" id="toc-zero-inflated-poisson" class="nav-link" data-scroll-target="#zero-inflated-poisson">Zero Inflated Poisson</a></li>
  <li><a href="#zero-inflated-negative-binomial-regression" id="toc-zero-inflated-negative-binomial-regression" class="nav-link" data-scroll-target="#zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</a></li>
  <li><a href="#hurdle-model" id="toc-hurdle-model" class="nav-link" data-scroll-target="#hurdle-model">Hurdle Model</a></li>
  </ul></li>
  <li><a href="#beta-regression" id="toc-beta-regression" class="nav-link" data-scroll-target="#beta-regression">BETA REGRESSION</a>
  <ul class="collapse">
  <li><a href="#beta-distribution" id="toc-beta-distribution" class="nav-link" data-scroll-target="#beta-distribution">BETA Distribution</a></li>
  <li><a href="#beta-regression-1" id="toc-beta-regression-1" class="nav-link" data-scroll-target="#beta-regression-1">BETA Regression</a>
  <ul class="collapse">
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#interpret" id="toc-interpret" class="nav-link" data-scroll-target="#interpret">Interpret</a></li>
  <li><a href="#compare" id="toc-compare" class="nav-link" data-scroll-target="#compare">Compare</a></li>
  <li><a href="#bayesian-version" id="toc-bayesian-version" class="nav-link" data-scroll-target="#bayesian-version">bayesian version</a></li>
  <li><a href="#bayesian-predictions" id="toc-bayesian-predictions" class="nav-link" data-scroll-target="#bayesian-predictions">Bayesian predictions</a></li>
  </ul></li>
  <li><a href="#zero-inflated-beta" id="toc-zero-inflated-beta" class="nav-link" data-scroll-target="#zero-inflated-beta">ZERO INFLATED BETA</a></li>
  <li><a href="#zero-one-inflated-beta-regression" id="toc-zero-one-inflated-beta-regression" class="nav-link" data-scroll-target="#zero-one-inflated-beta-regression">ZERO-ONE INFLATED BETA Regression</a></li>
  <li><a href="#hurdle-neg-binom-bayesian" id="toc-hurdle-neg-binom-bayesian" class="nav-link" data-scroll-target="#hurdle-neg-binom-bayesian">HURDLE + NEG BINOM (bayesian)</a></li>
  <li><a href="#mixed-zero-one-inflated-beta-regression" id="toc-mixed-zero-one-inflated-beta-regression" class="nav-link" data-scroll-target="#mixed-zero-one-inflated-beta-regression">MIXED ZERO-ONE-INFLATED BETA Regression</a></li>
  <li><a href="#beta-hurdle-regression-frequentist" id="toc-beta-hurdle-regression-frequentist" class="nav-link" data-scroll-target="#beta-hurdle-regression-frequentist">BETA HURDLE Regression (Frequentist)</a></li>
  </ul></li>
  <li><a href="#binomial-outcome" id="toc-binomial-outcome" class="nav-link" data-scroll-target="#binomial-outcome">BINOMIAL OUTCOME</a>
  <ul class="collapse">
  <li><a href="#chi-square" id="toc-chi-square" class="nav-link" data-scroll-target="#chi-square">CHI SQUARE</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">LOGISTIC REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#learning-notes" id="toc-learning-notes" class="nav-link" data-scroll-target="#learning-notes">Learning Notes</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ordinal-outcome" id="toc-ordinal-outcome" class="nav-link" data-scroll-target="#ordinal-outcome">ORDINAL OUTCOME</a>
  <ul class="collapse">
  <li><a href="#ordinal-regression-cumulative-link-proportional-odds" id="toc-ordinal-regression-cumulative-link-proportional-odds" class="nav-link" data-scroll-target="#ordinal-regression-cumulative-link-proportional-odds">ORDINAL REGRESSION — Cumulative Link; Proportional Odds</a>
  <ul class="collapse">
  <li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1">Fit Model</a></li>
  <li><a href="#inference-1" id="toc-inference-1" class="nav-link" data-scroll-target="#inference-1">Inference</a></li>
  <li><a href="#visualize-model" id="toc-visualize-model" class="nav-link" data-scroll-target="#visualize-model">Visualize Model</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#categorical-outcome" id="toc-categorical-outcome" class="nav-link" data-scroll-target="#categorical-outcome">CATEGORICAL OUTCOME</a>
  <ul class="collapse">
  <li><a href="#chi-square-1" id="toc-chi-square-1" class="nav-link" data-scroll-target="#chi-square-1">CHI SQUARE</a></li>
  <li><a href="#multinomial-regression" id="toc-multinomial-regression" class="nav-link" data-scroll-target="#multinomial-regression">MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model-2" id="toc-fit-model-2" class="nav-link" data-scroll-target="#fit-model-2">Fit Model</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#inference-2" id="toc-inference-2" class="nav-link" data-scroll-target="#inference-2">Inference</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  <li><a href="#diagnostics-2" id="toc-diagnostics-2" class="nav-link" data-scroll-target="#diagnostics-2">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#mixed-repeated-measures" id="toc-mixed-repeated-measures" class="nav-link" data-scroll-target="#mixed-repeated-measures"> <span class="header-section-number">5</span> MIXED (Repeated Measures)</a>
  <ul class="collapse">
  <li><a href="#mixed-continuous" id="toc-mixed-continuous" class="nav-link" data-scroll-target="#mixed-continuous">MIXED — CONTINUOUS</a></li>
  <li><a href="#mixed-binomial" id="toc-mixed-binomial" class="nav-link" data-scroll-target="#mixed-binomial">MIXED — BINOMIAL</a>
  <ul class="collapse">
  <li><a href="#mixed-logistic-regression" id="toc-mixed-logistic-regression" class="nav-link" data-scroll-target="#mixed-logistic-regression">Mixed Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#fit-model-3" id="toc-fit-model-3" class="nav-link" data-scroll-target="#fit-model-3">Fit Model</a></li>
  <li><a href="#visualize-2" id="toc-visualize-2" class="nav-link" data-scroll-target="#visualize-2">Visualize</a></li>
  <li><a href="#diagnostics-3" id="toc-diagnostics-3" class="nav-link" data-scroll-target="#diagnostics-3">Diagnostics</a></li>
  <li><a href="#inference-3" id="toc-inference-3" class="nav-link" data-scroll-target="#inference-3">Inference</a></li>
  </ul></li>
  <li><a href="#bayesian-mixed-lostistic-regression" id="toc-bayesian-mixed-lostistic-regression" class="nav-link" data-scroll-target="#bayesian-mixed-lostistic-regression">BAYESIAN Mixed Lostistic Regression</a></li>
  </ul></li>
  <li><a href="#mixed-ordinal" id="toc-mixed-ordinal" class="nav-link" data-scroll-target="#mixed-ordinal">MIXED — ORDINAL</a></li>
  <li><a href="#mixed-categorical" id="toc-mixed-categorical" class="nav-link" data-scroll-target="#mixed-categorical">MIXED — CATEGORICAL</a>
  <ul class="collapse">
  <li><a href="#mixed-multinomial-regression" id="toc-mixed-multinomial-regression" class="nav-link" data-scroll-target="#mixed-multinomial-regression">Mixed Multinomial Regression</a>
  <ul class="collapse">
  <li><a href="#fit-model-manual-individual-binomials" id="toc-fit-model-manual-individual-binomials" class="nav-link" data-scroll-target="#fit-model-manual-individual-binomials">Fit Model [MANUAL INDIVIDUAL BINOMIALS]</a></li>
  <li><a href="#fit-model-mblogit" id="toc-fit-model-mblogit" class="nav-link" data-scroll-target="#fit-model-mblogit">Fit Model [mblogit]</a></li>
  <li><a href="#inference-4" id="toc-inference-4" class="nav-link" data-scroll-target="#inference-4">Inference</a></li>
  <li><a href="#visualize-3" id="toc-visualize-3" class="nav-link" data-scroll-target="#visualize-3">Visualize</a></li>
  <li><a href="#diagnostics-4" id="toc-diagnostics-4" class="nav-link" data-scroll-target="#diagnostics-4">Diagnostics</a></li>
  <li><a href="#fit-model-brms" id="toc-fit-model-brms" class="nav-link" data-scroll-target="#fit-model-brms">Fit Model [brms]</a></li>
  <li><a href="#inference-5" id="toc-inference-5" class="nav-link" data-scroll-target="#inference-5">Inference</a></li>
  <li><a href="#visualize-4" id="toc-visualize-4" class="nav-link" data-scroll-target="#visualize-4">Visualize</a></li>
  <li><a href="#compare-1" id="toc-compare-1" class="nav-link" data-scroll-target="#compare-1">COMPARE</a></li>
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo">TODO</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#wip-unknown" id="toc-wip-unknown" class="nav-link" data-scroll-target="#wip-unknown">WIP UNKNOWN</a>
  <ul class="collapse">
  <li><a href="#cummulative-ordinal-bayesian-equal-variance" id="toc-cummulative-ordinal-bayesian-equal-variance" class="nav-link" data-scroll-target="#cummulative-ordinal-bayesian-equal-variance">Cummulative Ordinal (Bayesian) — Equal Variance</a></li>
  <li><a href="#cummulative-ordinal-bayesian-unequal-variance" id="toc-cummulative-ordinal-bayesian-unequal-variance" class="nav-link" data-scroll-target="#cummulative-ordinal-bayesian-unequal-variance">Cummulative Ordinal (Bayesian) — Unequal Variance</a></li>
  <li><a href="#adjacent-category-ordinal-bayesian" id="toc-adjacent-category-ordinal-bayesian" class="nav-link" data-scroll-target="#adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</a></li>
  </ul></li>
  <li><a href="#helpers" id="toc-helpers" class="nav-link" data-scroll-target="#helpers">HELPERS</a>
  <ul class="collapse">
  <li><a href="#odds-and-probabilities" id="toc-odds-and-probabilities" class="nav-link" data-scroll-target="#odds-and-probabilities">Odds and Probabilities</a></li>
  </ul></li>
  <li><a href="#ggdist-bayesian-posterior-vis" id="toc-ggdist-bayesian-posterior-vis" class="nav-link" data-scroll-target="#ggdist-bayesian-posterior-vis">GGDist bayesian posterior vis</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="modelling" class="quarto-section-identifier d-none d-lg-block">Modelling Reference</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">SGCX | Modelling Reference</p>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<p><strong>In this notebook we use data from study SGC3A to explore different modelling techniques and assess their suitability for the bimodal accuracy distributions in the SGC project data.</strong></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools) <span class="co">#misc helpers </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#arrange plots</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange shift function plots</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd) <span class="co">#mosaic plots</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra) <span class="co">#mosaic plots</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy) <span class="co">#the way it should be</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions) <span class="co">#expressions to add to plots</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with expressions</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects) <span class="co">#visualization log regr models</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#tables</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy models</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed and mixture models</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#misc utilities</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#viz and compare models</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic) <span class="co">#extract model equation</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr) <span class="co">#power analyses</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix) <span class="co">#helpful basic stats &amp; non parametrics</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WRS2) <span class="co">#robust and nonparametric tests </span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr) <span class="co">#confint on qq plot</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels) <span class="co">#contingency table and CHISQR</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zeroinfl / hurdle models </span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models </span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal) <span class="co">#ordinal regression</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># polyr ordinal regression</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM) <span class="co">#censored, zero infl, etc</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brant) <span class="co">#brant test for ordinal regression</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression </span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#multinomial logistic regression</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co">#one package to rule them all</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(mbp)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items_LAB.rds'</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants_LAB.rds'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_score =</span> item_test_NABS,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_condition =</span> condition,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> pretty_condition</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaled =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orth"</span>, <span class="st">"-0.5"</span><span class="ot">=</span><span class="st">"unknown"</span>,<span class="st">"0"</span><span class="ot">=</span><span class="st">"uncertain"</span>,<span class="st">"0.5"</span><span class="ot">=</span><span class="st">"lines"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"tri"</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaled =</span> <span class="fu">as.ordered</span>(scaled),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_condition =</span> condition,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> pretty_condition,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orth-like"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"unknown"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"unknown"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>),</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">as.ordered</span>(state)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 group ordered STATE variable</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 group ordered SCALED variable [matches high_interpretation]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>test-equivalents of GLM models: https://rpubs.com/palday/glm-test</li>
<li>models as test :https://lindeloev.github.io/tests-as-linear/</li>
<li>GLM REFERENCE http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#predictions-andor-confidence-or-prediction-intervals-on-predictions</li>
</ul>
<section id="independent-samples" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> INDEPENDENT SAMPLES</h1>
<section id="continuous-outcome" class="level2">
<h2 class="anchored" data-anchor-id="continuous-outcome">CONTINUOUS OUTCOME</h2>
<p><strong>Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?<br>
(# questions correct on test phase of task, [in lab] participants)</strong></p>
<p><em>(Can also be transformed to proportion or percentage).</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::SETUP DATA</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  condition min Q1 median Q3 max mean   sd  n missing
1   control   0  0      0  1   8 1.71 3.05 62       0
2   impasse   0  0      2  7   8 3.33 3.40 64       0</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | FACETED HISTOGRAM</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~item_test_NABS, </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "# Correct",</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "proportion of subjects",</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "") + theme(legend.position = "blank")</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="do">##GGPUBR | HIST+DENSITY SCORE </span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">gghistogram</span>(df, <span class="at">x =</span> <span class="st">"test_score"</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>   <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill =</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>   <span class="at">add_density =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">facet</span>(p, <span class="at">facet.by=</span><span class="fu">c</span>(<span class="st">"condition"</span>)) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, <span class="at">y =</span> <span class="st">"number of subjects"</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-IND-TESTSCORE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">##VERTICAL RAINCLOUD USING GGDISTR</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> test_score,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> condition) ) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score, <span class="at">color =</span> condition),</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.3</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>( </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">05</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">labs</span>( </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score "</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) <span class="sc">+</span> </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>), <span class="at">clip =</span> <span class="st">"off"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-IND-TESTSCORE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="independent-samples-t-test-students-t" class="level3">
<h3 class="anchored" data-anchor-id="independent-samples-t-test-students-t">Independent Samples T-Test (Student’s T)</h3>
<ul>
<li>Tests null hypothesis that true difference in population mean is == 0</li>
<li>Assumes normally distributed variables</li>
<li>Assumes equal variance of samples (homogeneity of variance)</li>
<li><strong>SGC accuracy data violate both homogeneity and normality</strong>*</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>( test_score <span class="sc">~</span> condition,<span class="at">data =</span> df,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))) <span class="co"># less, greater for one sided tests</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  test_score by condition
t = -3, df = 124, p-value = 0.006
alternative hypothesis: true difference in means between group control and group impasse is not equal to 0
95 percent confidence interval:
 -2.759 -0.478
sample estimates:
mean in group control mean in group impasse 
                 1.71                  3.33 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .effectsize_t.test(model, type = type, verbose = verbose, ...):
Unable to retrieve data from htest object. Using t_to_d() approximation.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The Two Sample t-test testing the difference of test_score by condition (mean in group control = 1.71, mean in group impasse = 3.33) suggests that the effect is negative, statistically significant, and medium (difference = -1.62, 95% CI [-2.76, -0.48], t(124) = -2.81, p = 0.006; Cohen's d = -0.50, 95% CI [-0.86, -0.15])</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#one tailed tests must be done manually by extracting results expression and adding as subtitle</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#default is two tailed test</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># results &lt;- two_sample_test( data = df, x = pretty_condition, </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                             y = item_test_NABS,</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                             alternative = "g")</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"parametric"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">alternative  =</span> <span class="st">"g"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># + labs(subtitle = results$expression[[1]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="independent-samples-t-test-welchs-t" class="level3">
<h3 class="anchored" data-anchor-id="independent-samples-t-test-welchs-t">Independent Samples T-Test (Welch’s T)</h3>
<ul>
<li>Tests null hypothesis that true difference in population mean is == 0</li>
<li>Assumes normally distributed variables</li>
<li><strong>Does not</strong> assumes equal variance of samples (homogeneity of variance)</li>
<li><strong><em>SGC accuracy data violates normality assumption</em></strong></li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>( test_score <span class="sc">~</span> condition,<span class="at">data =</span> df,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  test_score by condition
t = -3, df = 123, p-value = 0.006
alternative hypothesis: true difference in means between group control and group impasse is not equal to 0
95 percent confidence interval:
 -2.76 -0.48
sample estimates:
mean in group control mean in group impasse 
                 1.71                  3.33 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .effectsize_t.test(model, type = type, verbose = verbose, ...):
Unable to retrieve data from htest object. Using t_to_d() approximation.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The Welch Two Sample t-test testing the difference of test_score by condition (mean in group control = 1.71, mean in group impasse = 3.33) suggests that the effect is negative, statistically significant, and medium (difference = -1.62, 95% CI [-2.76, -0.48], t(123.25) = -2.81, p = 0.006; Cohen's d = -0.51, 95% CI [-0.86, -0.15])</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"parametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="yuens-t-test-trimmed-means" class="level3">
<h3 class="anchored" data-anchor-id="yuens-t-test-trimmed-means">Yuen’s T-Test (Trimmed Means)</h3>
<ul>
<li><strong>Robust alternative to</strong> to t-test is Yuen’s t-test which uses trimmed means</li>
<li>Trimmed means are not desireable for this research scenario because they trim data from the extremes, and in this study these are true, interesting values</li>
<li><a href="https://garstats.wordpress.com/2017/11/28/trimmed-means/" class="uri">https://garstats.wordpress.com/2017/11/28/trimmed-means/</a></li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(y <span class="ot">&lt;-</span> <span class="fu">yuenbt</span>( <span class="at">formula =</span> test_score <span class="sc">~</span> condition, <span class="at">data =</span> df,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">side =</span> <span class="cn">TRUE</span>, <span class="at">EQVAR =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
yuenbt(formula = test_score ~ condition, data = df, side = TRUE, 
    EQVAR = FALSE)

Test statistic: -2.99 (df = NA), p-value = 0

Trimmed mean difference:  -2.53 
95 percent confidence interval:
-4.1     -0.955 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"robust"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="wilcoxon-rank-sum-mann-whitney-test" class="level3">
<h3 class="anchored" data-anchor-id="wilcoxon-rank-sum-mann-whitney-test">Wilcoxon Rank Sum (Mann-Whitney Test)</h3>
<ul>
<li><strong>Non parametric alternative</strong> to t-test; compares median rather than mean by ranking data</li>
<li>Does not assume normality</li>
<li>Does not assume equal variance of samples (homogeneity of variance)</li>
<li><strong>Appropriate for SGC accuracy data</strong></li>
<li>https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/#two-sample-wilcoxon-test</li>
<li>https://data.library.virginia.edu/the-wilcoxon-rank-sum-test/</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df<span class="sc">$</span>test_score <span class="sc">~</span> df<span class="sc">$</span>condition,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)) <span class="co">#less, greater</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df$test_score by df$condition
W = 1438, p-value = 0.003
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Funder's (2019) recommendations.

The Wilcoxon rank sum test with continuity correction testing the difference in ranks between df$test_score and df$condition suggests that the effect is negative, statistically significant, and medium (W = 1438.00, p = 0.003; r (rank biserial) = -0.28, 95% CI [-0.45, -0.08])</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#effect size</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">wilcox_effsize</span>(test_score <span class="sc">~</span> condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.        group1  group2  effsize    n1    n2 magnitude
* &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 test_score control impasse   0.263    62    64 small    </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="floorceiling-corrections-wilcoxon-rank-sum" class="level3">
<h3 class="anchored" data-anchor-id="floorceiling-corrections-wilcoxon-rank-sum">Floor/Ceiling Corrections + Wilcoxon Rank Sum</h3>
<ul>
<li>The bimodal distribution of the subject-level score data do not meet the requirements for t-tests.</li>
<li>However, a non-parametric alternative is available (Wilcoxon rank sum test / Man-Whitney test)</li>
<li>Additional corrections are available for data with ‘floor’ and/or ‘ceiling’ effects via the ‘DACR’ package</li>
<li>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14 see also https://qmliu.shinyapps.io/DACFE/</li>
</ul>
<p>For comparison we run a standard followed by a Wilcoxon rank-sum (Mann-Whitney) test that is a nonparametric alternative for non-normally distributed data.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df<span class="sc">$</span>test_score <span class="sc">~</span> df<span class="sc">$</span>condition))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df$test_score by df$condition
W = 1438, p-value = 0.003
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>Next, we calculate the t-test and ANOVA (F-test) based on a series of corrections provided for data with floor and/or ceiling effects.</p>
<ul>
<li><a href="https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14" class="uri">https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14</a></li>
</ul>
<p>Using properties from truncated normal distributions, the authors propose an easy-to-use method for the <em>t</em>-test and ANOVA with ceiling/floor data.</p>
<p><em>The proposed method calculates the degrees of freedom based on the after-truncation sample sizes (where l = number of floor observations, and r = number of ceiling observations). The rationale was that the proposed method utilizes full information only from data points of n − r − l participants and partial information from data points of r + l participants of a group for the mean and variance estimation. Specifically, the corrected mean and variance estimates (Eqs. 14 and 15) are functions of mean and variance estimates using after-truncation data (n − r − l participants) and the standardized floor and ceiling threshold estimates. The thresholds are estimated using the ceiling and floor percentage estimates based on data points of n − r and n − l participants, respectively. This is a relatively conservative approach for calculating the degrees of freedom, which can help control the type I error rate. This feature can be beneficial, especially given the “replication crisis” in psychological and behavioral research.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED T TESTS</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DACF) <span class="co">#tests for data with floor and ceiling </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.rdocumentation.org/packages/DACF/versions/1.0.0</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare data [vector of scores for each group]</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>score_111 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test_score) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>score_121 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"impasse"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test_score) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_111) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_121) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(<span class="st">"control"</span><span class="ot">=</span>a ,<span class="st">"impasse"</span><span class="ot">=</span>b))</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        ceiling.percentage floor.percentage est.mean est.var
control              0.113            0.710    -7.70   207.4
impasse              0.172            0.422     2.39    51.8</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># perform adjusted t test</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.t.test</span>(score_111,score_121,<span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$statistic
[1] -4.94

$p.value
[1] 0.000012

$est.d
[1] -0.887

$conf.int
[1] -14.22  -5.97</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED F* </span><span class="al">TEST</span><span class="co"> ANOVA</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.f.star</span>(df,test_score<span class="sc">~</span>condition,<span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$statistic
[1] 5.85

$p.value
[1] 0.0321

$est.f.squared
[1] 0.158</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>The control condition has 11% of data at ceiling and 71% at floor, with corrected mean of -7 and variance of 207. The impasse condition has 17% at ceiling, and only 42% at floor, with with corrected mean of 2.39 and variance respectively as of 58.</em></p>
<p><em>A corrected t-test t statistic is -4.94, p = 0.05. The estimated Cohen’s d is -0.89 with a confidence interval 0f [-14.22, -5.97].</em></p>
<p><em>A correct F-test (ANOVA) has a corrected F-statstic of 5.85, p &lt; 0.05, and Fsquared effect size of 0.195</em></p>
</section>
<section id="linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression">Linear Regression</h3>
<ul>
<li>Assumes homogeneity of variance</li>
<li>Assumes normally distributed residuals</li>
<li>when default dummy coding is used;
<ul>
<li>intercept = predicted mean of first group,</li>
<li>predictor coefficient = difference to mean of second group</li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = test_score ~ condition, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
 -3.33  -1.71  -1.71   3.67   6.29 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         1.710      0.411    4.16 0.000058 ***
conditionimpasse    1.618      0.576    2.81   0.0058 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.23 on 124 degrees of freedom
Multiple R-squared:  0.0598,    Adjusted R-squared:  0.0522 
F-statistic: 7.89 on 1 and 124 DF,  p-value: 0.00579</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: test_score
           Df Sum Sq Mean Sq F value Pr(&gt;F)   
condition   1     82    82.5    7.89 0.0058 **
Residuals 124   1297    10.5                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
(Intercept)      0.897   2.52
conditionimpasse 0.478   2.76</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(lm<span class="fl">.1</span>) <span class="co">#sanity check</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict test_score with condition (formula: test_score ~ condition). The model explains a statistically significant and weak proportion of variance (R2 = 0.06, F(1, 124) = 7.89, p = 0.006, adj. R2 = 0.05). The model's intercept, corresponding to condition = control, is at 1.71 (95% CI [0.90, 2.52], t(124) = 4.16, p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically significant and positive (beta = 1.62, 95% CI [0.48, 2.76], t(124) = 2.81, p = 0.006; Std. beta = 0.49, 95% CI [0.14, 0.83])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">#setup references</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> lm<span class="fl">.1</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>call <span class="ot">&lt;-</span> m<span class="sc">$</span>call <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co"># uncertainty model visualization</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>df  <span class="sc">%&gt;%</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  modelr<span class="sc">::</span><span class="fu">data_grid</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(lm<span class="fl">.1</span>, <span class="at">newdata =</span> ., <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> condition, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>( <span class="at">scale =</span> .<span class="dv">5</span>,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">xdist =</span> <span class="fu">dist_student_t</span>(<span class="at">df =</span> <span class="fu">df.residual</span>(m), <span class="at">mu =</span> .fitted, <span class="at">sigma =</span> .se.fit),</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">stat</span>(<span class="fu">cut_cdf_qi</span>(cdf,</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">95</span>),</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())))) <span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"(LAB) Test Phase Accuracy ~ Condition"</span>,</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"model predicted mean (% correct)"</span>, <span class="at">y =</span> <span class="st">"Condition"</span>, <span class="at">fill =</span> <span class="st">"Interval"</span>,</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"lm("</span>,call[<span class="dv">2</span>],<span class="st">")"</span>)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/PLOT-MODEL-COEFSS-GGDIST-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sjPlot</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(lm<span class="fl">.1</span>,  <span class="at">type =</span> <span class="st">"eff"</span>, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.data =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p =</span> <span class="cn">TRUE</span>) </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#BS TO MANUALLY ADD REGRESSION FORMULA AS SUBTITLE </span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic)</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># library(latex2exp)</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (x &lt;- extract_eq(lm.1, use_coefs = TRUE, ital_vars=TRUE, coef_digits = 1, raw_tex = FALSE))</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># b = TeX(x)</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"># p1[["condition"]][["labels"]][["subtitle"]]= expression( paste(widehat(accuracy), " = ", 1.7, " + ", "1.6", "*", condition[impasse]) )</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/PLOT-MODEL-PRED-SJPLOT-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="censored-tobit-regression" class="level3">
<h3 class="anchored" data-anchor-id="censored-tobit-regression">Censored (Tobit) Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/tobit-models/" class="uri">https://stats.oarc.ucla.edu/r/dae/tobit-models/</a></p>
<p><strong>For censored data (i.e.&nbsp;truncated axis).</strong> The tobit model, also called a censored regression model, is designed to estimate linear relationships between variables when there is either left- or right-censoring in the dependent variable (also known as censoring from below and above, respectively). Censoring from above takes place when cases with a value at or above some threshold, all take on the value of that threshold, so that the true value might be equal to the threshold, but it might also be higher. In the case of censoring from below, values those that fall at or below some threshold are censored.</p>
<ul>
<li>censored vs truncated : There is sometimes confusion about the difference between truncated data and censored data.</li>
<li>With censored variables, all of the observations are in the dataset, but we don’t know the “true” values of some of them.</li>
<li>With truncation some of the observations are not included in the analysis because of the value of the variable.</li>
<li>When a variable is censored, regression models for truncated data provide inconsistent estimates of the parameters. See Long (1997, chapter 7) for a more detailed discussion of problems of using regression models for truncated data to analyze censored data.</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set censoring values </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>lo <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>hi <span class="ot">=</span> <span class="dv">8</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(df<span class="sc">$</span>test_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 8</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Lo and Hi should equate to upper and lower bounds of the # Qs "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lo and Hi should equate to upper and lower bounds of the # Qs "</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span> <span class="fu">vglm</span>(test_score <span class="sc">~</span> condition, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span>hi ), <span class="at">data =</span> df)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
vglm(formula = test_score ~ condition, family = tobit(Lower = lo, 
    Upper = hi), data = df)

Coefficients: 
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1      -4.185      1.483   -2.82   0.0048 ** 
(Intercept):2       2.203      0.127   17.38   &lt;2e-16 ***
conditionimpasse    5.577      1.982    2.81   0.0049 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Names of linear predictors: mu, loglink(sd)

Log-likelihood: -196 on 249 degrees of freedom

Number of Fisher scoring iterations: 11 

No Hauck-Donner effect found in any of the estimates</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m1)))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    LL    UL
(Intercept):1    -7.09 -1.28
(Intercept):2     1.95  2.45
conditionimpasse  1.69  9.46</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(test_score <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span> hi), <span class="at">data =</span> df)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(m1) <span class="sc">-</span> <span class="fu">logLik</span>(m0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0134</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P value of likelihood ratio test less than alpha = 0.05?  TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m0,m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name | Model |     AIC | AIC weights |     BIC | BIC weights |  RMSE | Sigma
----------------------------------------------------------------------------
m0   |  vglm | 404.682 |       0.035 | 410.355 |       0.131 | 7.529 | 7.560
m1   |  vglm | 398.060 |       0.965 | 406.569 |       0.869 | 7.101 | 7.144</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DIAGNOSTICS</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m1)[,<span class="dv">1</span>]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rr <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rp <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"pearson"</span>)[,<span class="dv">1</span>]</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df, {</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rr, <span class="at">main =</span> <span class="st">"Fitted vs Residuals"</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rr)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rp, <span class="at">main =</span> <span class="st">"Fitted vs Pearson Residuals"</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rp)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_score, rp, <span class="at">main =</span> <span class="st">"Actual vs Pearson Residuals"</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_score, yhat, <span class="at">main =</span> <span class="st">"Actual vs Fitted"</span>)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#VARIANCE ACCOUNTED FOR</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"VARIANCE ACCOUNTED FOR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "VARIANCE ACCOUNTED FOR"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>(r <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">cor</span>(yhat, test_score)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.245</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance accounted for</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>r<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0598</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |  RMSE | Sigma
---------------------------------
398.060 | 406.569 | 7.101 | 7.144</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#NOTE: censReg package also does Tobit regression [including mixed models]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>The coefficient labeled “(Intercept):1” is the intercept or constant for the model.</li>
<li>The coefficient labeled “(Intercept):2” is an ancillary statistic. If we exponentiate this value, we get a statistic that is analogous to the square root of the residual variance in OLS regression. logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</li>
<li>The predicted value of test_phase_score is 5.75 points <em>higher</em> for students in the impasse condition than for students in the control condition. (72% improvement in score!)</li>
</ul>
<p><strong>Using censReg package</strong> - https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censReg) <span class="co">#censored regression</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maxLik</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: miscTools</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite the 'maxLik' package as:
Henningsen, Arne and Toomet, Ott (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics 26(3), 443-458. DOI 10.1007/s00180-010-0217-1.

If you have questions, suggestions, or comments regarding the 'maxLik' package, please use a forum or 'tracker' at maxLik's R-Forge site:
https://r-forge.r-project.org/projects/maxlik/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite the 'censReg' package as:
Henningsen, Arne (2017). censReg: Censored Regression (Tobit) Models. R package version 0.5. http://CRAN.R-Project.org/package=censReg.

If you have questions, suggestions, or comments regarding the 'censReg' package, please use a forum or 'tracker' at the R-Forge site of the 'sampleSelection' project:
https://r-forge.r-project.org/projects/sampleselection/</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( test_score <span class="sc">~</span> condition, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(c1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = test_score ~ condition, left = lo, right = hi, 
    data = df)

Observations:
         Total  Left-censored     Uncensored Right-censored 
           126             71             37             18 

Coefficients:
                 Estimate Std. error t value Pr(&gt; t)    
(Intercept)       -4.1854     1.7149  -2.441 0.01466 *  
conditionimpasse   5.5775     1.9995   2.789 0.00528 ** 
logSigma           2.2033     0.1424  15.471 &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -196 on 3 Df</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(c1)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(c1)))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    LL     UL
(Intercept)      -7.55 -0.824
conditionimpasse  1.66  9.496
logSigma          1.92  2.482</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( test_score <span class="sc">~</span> <span class="dv">1</span>, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(c1) <span class="sc">-</span> <span class="fu">logLik</span>(c0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 0.0134 (df=3)</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P value of likelihood ratio test less than alpha = 0.05?  TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(c1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in get_residuals.default(model, verbose = verbose, type = "response", :
Can't extract residuals from model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Response residuals not available to calculate mean square error. (R)MSE
  is probably not reliable.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Models of class 'censReg' are not yet supported.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<ul>
<li>logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</li>
<li>output should match that of VGAM</li>
</ul>
</section>
</section>
<section id="count-outcome" class="level2">
<h2 class="anchored" data-anchor-id="count-outcome">COUNT OUTCOME</h2>
<p><strong>Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?<br>
(# questions correct on test phase of task, [in lab] participants)</strong></p>
<p>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can try considering it a type of <em>count</em>, (i.e.&nbsp;count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function). Note that the process of answering questions on a test do not seem to strictly match the assumptions of a Poisson process.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::SETUP DATA</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  condition min Q1 median Q3 max mean   sd  n missing
1   control   0  0      0  1   8 1.71 3.05 62       0
2   impasse   0  0      2  7   8 3.33 3.40 64       0</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | FACETED HISTOGRAM</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~item_test_NABS, </span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "# Correct",</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "proportion of subjects",</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "") + theme(legend.position = "blank")</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="do">##GGPUBR | HIST+DENSITY SCORE </span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">gghistogram</span>(df, <span class="at">x =</span> <span class="st">"test_score"</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>   <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill =</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>   <span class="at">add_density =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="fu">facet</span>(p, <span class="at">facet.by=</span><span class="fu">c</span>(<span class="st">"condition"</span>)) <span class="sc">+</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score"</span>,</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, <span class="at">y =</span> <span class="st">"number of subjects"</span>) <span class="sc">+</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-COUNT-TESTSCORE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">##VERTICAL RAINCLOUD USING GGDISTR</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> test_score,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> condition) ) <span class="sc">+</span> </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>, </span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span> </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score),</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score, <span class="at">color =</span> condition),</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.3</span>,</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>( </span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">05</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">labs</span>( </span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score "</span>,</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>) <span class="sc">+</span></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) <span class="sc">+</span> </span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>), <span class="at">clip =</span> <span class="st">"off"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-COUNT-TESTSCORE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="poisson-regression" class="level3">
<h3 class="anchored" data-anchor-id="poisson-regression">Poisson Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/poisson-regression/" class="uri">https://stats.oarc.ucla.edu/r/dae/poisson-regression/</a><br>
<em>General Linear model using the Poisson distribution</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>p<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(p<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 126 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> test_score </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> Generalized linear model </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Family </td>
   <td style="text-align:right;"> poisson </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Link </td>
   <td style="text-align:right;"> log </td>
  </tr>
</tbody>
</table> <table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;"> 𝛘²(1) </td>
   <td style="text-align:right;"> 33.28 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Pseudo-R² (Cragg-Uhler) </td>
   <td style="text-align:right;"> 0.23 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Pseudo-R² (McFadden) </td>
   <td style="text-align:right;"> 0.04 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> AIC </td>
   <td style="text-align:right;"> 764.95 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> BIC </td>
   <td style="text-align:right;"> 770.62 </td>
  </tr>
</tbody>
</table> <table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> z val. </th>
   <th style="text-align:right;"> p </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> 0.54 </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 5.52 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> conditionimpasse </td>
   <td style="text-align:right;"> 0.67 </td>
   <td style="text-align:right;"> 0.12 </td>
   <td style="text-align:right;"> 5.60 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: MLE</td></tr></tfoot>
</table>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(p<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: poisson, link: log

Response: test_score

Terms added sequentially (first to last)

          Df Deviance Resid. Df Resid. Dev
NULL                        125        604
condition  1     33.3       124        570</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(p<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
(Intercept)      0.340  0.721
conditionimpasse 0.436  0.902</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(p<span class="fl">.1</span>) <span class="co">#sanity check</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a poisson model (estimated using ML) to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is moderate (Nagelkerke's R2 = 0.23). The model's intercept, corresponding to condition = control, is at 0.54 (95% CI [0.34, 0.72], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically significant and positive (beta = 0.67, 95% CI [0.44, 0.90], p &lt; .001; Std. beta = 0.67, 95% CI [0.44, 0.90])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(p<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(p<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The variable condition has a coefficient of 0.67, (p &lt; 0.005). This means that for the impasse condition, the expected log count # of questions increases by 0.67. By exponentiating the estimate we see that # question correct rate for the impasse condition is 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.</em></p>
</section>
<section id="negative-binomial-regression" class="level3">
<h3 class="anchored" data-anchor-id="negative-binomial-regression">Negative Binomial Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/" class="uri">https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/</a> -<em>overdispersed count data (variance much greater than mean)</em></p>
<ul>
<li>similar to Poisson regression, but using the negative binomial distribution, which can better account for ‘overdispersed’ data where variance is much greater than the mean</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model </span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>nb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co">#check overdispersion need </span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co">#assumes conditional means are not equal to conditional variances</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="co">#conduct likelihood ration test to compare and test [need poisson]</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>m.t <span class="ot">&lt;-</span> <span class="fu">glm</span>(test_score <span class="sc">~</span> condition, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> df)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="co">#pchisq(2 * (logLik(nb.1) - logLik(m.t)), df = 1, lower.tail = FALSE)</span></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a><span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.t, nb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name |  Model | df | df_diff |   Chi2 |      p
----------------------------------------------
m.t  |    glm |  2 |         |        |       
nb.1 | negbin |  3 |       1 | 277.71 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Estimate =</span> <span class="fu">coef</span>(nb<span class="fl">.1</span>), <span class="fu">confint</span>(nb<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate parameter estimates</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Exponentiated Estimates"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Exponentiated Estimates"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate 2.5 % 97.5 %
(Intercept)          1.71  1.07   2.89
conditionimpasse     1.95  0.98   3.86</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = test_score ~ condition, data = df, init.theta = 0.2977734703, 
    link = log)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.220  -1.066  -1.066   0.447   1.067  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)         0.536      0.252    2.13    0.033 *
conditionimpasse    0.666      0.348    1.92    0.055 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(0.298) family taken to be 1)

    Null deviance: 114.32  on 125  degrees of freedom
Residual deviance: 110.70  on 124  degrees of freedom
AIC: 489.2

Number of Fisher Scoring iterations: 1

              Theta:  0.2978 
          Std. Err.:  0.0586 

 2 x log-likelihood:  -483.2380 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(nb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a negative-binomial model (estimated using ML) to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is weak (Nagelkerke's R2 = 0.05). The model's intercept, corresponding to condition = control, is at 0.54 (95% CI [0.07, 1.06], p = 0.033). Within this model:

  - The effect of condition [impasse] is statistically non-significant and positive (beta = 0.67, 95% CI [-0.02, 1.35], p = 0.055; Std. beta = 0.67, 95% CI [-0.02, 1.35])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(nb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(nb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The variable condition has a coefficient of 0.67, (p &lt; 0.005). This means that for the impasse condition, the expected log count # of questions increases by 0.67. By exponentiating the estimate we see that # question correct rate for the impasse condition is nearly 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE POISSON AND NEGATIVE BINOMIAL</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(p<span class="fl">.1</span>, nb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name |  Model |     AIC | AIC weights |     BIC | BIC weights | Nagelkerke's R2 |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------------------------------------------------
p.1  |    glm | 764.945 |     &lt; 0.001 | 770.618 |     &lt; 0.001 |           0.234 | 3.208 | 2.145 |    -3.020 |           0.069
nb.1 | negbin | 489.238 |        1.00 | 497.747 |        1.00 |           0.048 | 3.208 | 0.945 |    -2.213 |           0.074</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(p<span class="fl">.1</span>, nb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name |  Model | df | df_diff |   Chi2 |      p
----------------------------------------------
p.1  |    glm |  2 |         |        |       
nb.1 | negbin |  3 |       1 | 277.71 | &lt; .001</code></pre>
</div>
</div>
<p><em>AIC, Pseudo-R2 and a likelihood ratio test indicate that the negative binomial regression model are a better fit for the distribution of test-phase scores.</em></p>
</section>
</section>
<section id="mixture-models" class="level2">
<h2 class="anchored" data-anchor-id="mixture-models">MIXTURE MODELS</h2>
<section id="zero-inflated-poisson" class="level3">
<h3 class="anchored" data-anchor-id="zero-inflated-poisson">Zero Inflated Poisson</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/zip/" class="uri">https://stats.oarc.ucla.edu/r/dae/zip/</a><br>
<em>A Poisson count process with excess zeros</em></p>
<ul>
<li>The Zero-Inflated model allows specification of two models (a mixture) where <em>some</em> of the zeros are included in the DGP for the Poisson model, while only the ‘excess’ zeros are included in the DGP for the Binomial model [the zero-inflated part]</li>
<li>The model includes:
<ul>
<li>A logistic model to model which of the two processes the zero outcome is associated with</li>
<li>A poisson model to model the count process</li>
</ul></li>
<li>Can specify different predictors for each part of the model</li>
<li>predictors after the | are for the binomial zero-inflated part of the model, while those infront are for the poisson process</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED POISSON</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>zinfp<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(test_score <span class="sc">~</span>  condition<span class="sc">|</span> condition , <span class="at">data =</span> df)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinfp<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = test_score ~ condition | condition, data = df)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.988 -0.575 -0.575  1.090  2.117 

Count model coefficients (poisson with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7702     0.0979   18.07   &lt;2e-16 ***
conditionimpasse  -0.0231     0.1199   -0.19     0.85    

Zero-inflation model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)         0.890      0.280    3.18   0.0015 **
conditionimpasse   -1.213      0.378   -3.21   0.0013 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 7 
Log-likelihood: -213 on 4 Df</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinfp<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated poisson model to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is substantial (R2 = 0.39, adj. R2 = 0.38). The model's intercept, corresponding to condition = control, is at 1.77 (95% CI [1.58, 1.96], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically non-significant and negative (beta = -0.02, 95% CI [-0.26, 0.21], p = 0.847; Std. beta = -0.02, 95% CI [-0.26, 0.21])
  - The effect of condition [impasse] is statistically significant and negative (beta = -1.21, 95% CI [-1.95, -0.47], p = 0.001; Std. beta = -1.21, 95% CI [-1.95, -0.47])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinfp<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------
434.837 | 446.183 | 0.391 |     0.381 | 3.208 | 3.260 |    -1.694 |           0.069</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check_model(zinfp.1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>In the count model, the coefficient for the condition is not significant.</em></p>
<p><em>In the zero-inflation model, the coefficient for the condition variable is -1.23 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.23 if you are in the impasse condition</em></p>
</section>
<section id="zero-inflated-negative-binomial-regression" class="level3">
<h3 class="anchored" data-anchor-id="zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/zinb/" class="uri">https://stats.oarc.ucla.edu/r/dae/zinb/</a><br>
<em>count data that are overdispersed and have excess zeros</em></p>
<p>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the <em>excess</em> zeros can be modelled independently.</p>
<p>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different ‘process’ … (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) &lt;- this could maybe be disentangled by first question latency?</p>
<p>The model includes:</p>
<ul>
<li>A logistic model to model which of the two processes the zero outcome is associated with</li>
<li>A negative binomial model to model the count process</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#  for zeroinfl negbinomial</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>zinb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , </span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> df, <span class="at">dist =</span> <span class="st">"negbin"</span>)</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co">#before the | is the count part, after the | is the logit model</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = test_score ~ condition | condition, data = df, dist = "negbin")

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.970 -0.568 -0.568  1.070  2.091 

Count model coefficients (negbin with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7689     0.1048   16.88   &lt;2e-16 ***
conditionimpasse  -0.0232     0.1282   -0.18    0.856    
Log(theta)         3.7504     2.1488    1.75    0.081 .  

Zero-inflation model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)         0.888      0.280    3.17   0.0015 **
conditionimpasse   -1.214      0.379   -3.21   0.0013 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta = 42.54 
Number of iterations in BFGS optimization: 7 
Log-likelihood: -213 on 5 Df</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated negative-binomial model to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is substantial (R2 = 0.40, adj. R2 = 0.39). The model's intercept, corresponding to condition = control, is at 1.77 (95% CI [1.56, 1.97], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically non-significant and negative (beta = -0.02, 95% CI [-0.27, 0.23], p = 0.856; Std. beta = -0.02, 95% CI [-0.27, 0.23])
  - The effect of condition [impasse] is statistically significant and negative (beta = -1.21, 95% CI [-1.96, -0.47], p = 0.001; Std. beta = -1.21, 95% CI [-1.96, -0.47])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------
436.585 | 450.766 | 0.398 |     0.388 | 3.208 | 3.274 |    -1.740 |           0.068</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   rootogram(zinb.1)</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate parameter estimates</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Exponentiated Estimates")</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(est)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).</em></p>
<p><em>In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(zinfp<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name    |    Model |     AIC | AIC weights |     BIC | BIC weights |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
------------------------------------------------------------------------------------------------------------------------------------
zinfp.1 | zeroinfl | 434.837 |       0.705 | 446.183 |       0.908 | 0.391 |     0.381 | 3.208 | 3.260 |    -1.694 |           0.069
zinb.1  | zeroinfl | 436.585 |       0.295 | 450.766 |       0.092 | 0.398 |     0.388 | 3.208 | 3.274 |    -1.740 |           0.068</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_likelihoodratio</span>(zinfp<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name    |    Model | df | df_diff | Chi2 |     p
------------------------------------------------
zinfp.1 | zeroinfl |  4 |         |      |      
zinb.1  | zeroinfl |  5 |       1 | 0.25 | 0.615</code></pre>
</div>
</div>
<p><strong>TODO come back to this and discuss further</strong><br>
</p>
</section>
<section id="hurdle-model" class="level3">
<h3 class="anchored" data-anchor-id="hurdle-model">Hurdle Model</h3>
<ul>
<li><a href="https://data.library.virginia.edu/getting-started-with-hurdle-models/" class="uri">https://data.library.virginia.edu/getting-started-with-hurdle-models/</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values." class="uri">https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.</a></li>
</ul>
<p>class of models for count data with both overdispersion and excess zeros;<br>
different from zero-inflated models where the excess zeros are theorized to arise from two <em>different</em> processes; in the hurdle model, there is a separate model for P(x=0) and a separate model for P(x!=0)</p>
<p>The model includes:</p>
<ul>
<li><p>A binary logit model to model whether the observation takes a positive count or not. (1) Does the student get <em>any</em> questions right?</p></li>
<li><p>a truncated Poisson or Negative binomial model that only fits positive counts (2) How many questions does the student get right?</p></li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zero-inf and hurdle models </span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countreg) <span class="co">#rootogram</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'countreg':
  method                 from
  print.zeroinfl         pscl
  print.summary.zeroinfl pscl
  summary.zeroinfl       pscl
  coef.zeroinfl          pscl
  vcov.zeroinfl          pscl
  logLik.zeroinfl        pscl
  predict.zeroinfl       pscl
  residuals.zeroinfl     pscl
  fitted.zeroinfl        pscl
  terms.zeroinfl         pscl
  model.matrix.zeroinfl  pscl
  extractAIC.zeroinfl    pscl
  print.hurdle           pscl
  print.summary.hurdle   pscl
  summary.hurdle         pscl
  coef.hurdle            pscl
  vcov.hurdle            pscl
  logLik.hurdle          pscl
  predict.hurdle         pscl
  residuals.hurdle       pscl
  fitted.hurdle          pscl
  terms.hurdle           pscl
  model.matrix.hurdle    pscl
  extractAIC.hurdle      pscl</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'countreg'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    dzipois, pzipois, qzipois, rzipois</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:pscl':

    hurdle, hurdle.control, hurdletest, zeroinfl, zeroinfl.control</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    rootogram</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.1</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df,</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = zeroDist, gr = zeroGrad, par = c(start$zero, if (zero.dist
== : unknown names in control: size</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.2</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df,</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"negbin"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size

Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = test_score ~ condition | condition, data = df, 
    dist = "poisson", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.988 -0.575 -0.575  1.090  2.117 

Count model coefficients (truncated poisson with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7702     0.0979   18.07   &lt;2e-16 ***
conditionimpasse  -0.0231     0.1199   -0.19     0.85    
Zero hurdle model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)        -0.894      0.280   -3.19   0.0014 **
conditionimpasse    1.209      0.377    3.20   0.0014 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 10 
Log-likelihood: -213 on 4 Df</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = test_score ~ condition | condition, data = df, 
    dist = "negbin", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.970 -0.568 -0.568  1.070  2.091 

Count model coefficients (truncated negbin with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7689     0.1048   16.88   &lt;2e-16 ***
conditionimpasse  -0.0232     0.1282   -0.18    0.856    
Log(theta)         3.7506     2.1492    1.75    0.081 .  
Zero hurdle model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)        -0.894      0.280   -3.19   0.0014 **
conditionimpasse    1.209      0.377    3.20   0.0014 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta: count = 42.546
Number of iterations in BFGS optimization: 19 
Log-likelihood: -213 on 5 Df</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(h<span class="fl">.1</span>,h<span class="fl">.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(h<span class="fl">.1</span>, h<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name |  Model | df | df_diff | Chi2 |     p
-------------------------------------------
h.1  | hurdle |  4 |         |      |      
h.2  | hurdle |  5 |       1 | 0.25 | 0.615</code></pre>
</div>
</div>
</section>
</section>
<section id="beta-regression" class="level2">
<h2 class="anchored" data-anchor-id="beta-regression">BETA REGRESSION</h2>
<section id="beta-distribution" class="level3">
<h3 class="anchored" data-anchor-id="beta-distribution">BETA Distribution</h3>
<p>Beta regression on % correct (with standard transformation for including [0,1])</p>
<p><a href="https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression" class="uri">https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression</a></p>
<p>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</p>
<p>If a test score is conceptualized as correct (a) and b (incorrect) score = correct / (correct + incorrect) = a/ (a + b)</p>
<p>In the beta distribution, a and b are the shape parameters!</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">6</span>, <span class="at">shape2 =</span> <span class="dv">4</span>),</span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 6, shape2 = 4)"</span>),</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Beta a = 6, b = 4"</span></span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">8</span>, <span class="at">shape2 =</span> <span class="fl">0.001</span>),</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 8, shape2 = 0.001)"</span>),</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL CORRECT"</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.001</span>, <span class="at">shape2 =</span> <span class="dv">8</span>),</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 0.001, shape2 = 8)"</span>),</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL WRONG"</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">4</span>),</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 4, shape2 = 4)"</span>),</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FIGURED IT OUT HALFWAY "</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ALTERNATIVE conceptualization of a and b is as mean MU and precision PHI (same idea as variance).</p>
<p>a = mu * phi b = (1 - mu) * phi</p>
<p>MU = a / (a+b) [the score] PHI = a + b [ the total # items ]</p>
<p>The <code>extraDistr::dprop</code> function can also handle mu and phi parameters, named as mean and size</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extraDistr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'extraDistr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:miscTools':

    ddnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    rdunif</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    dfrechet, dgev, dgompertz, dgpd, dgumbel, dhuber, dkumar, dlaplace,
    dlomax, dpareto, drayleigh, dskellam, dslash, pfrechet, pgev,
    pgompertz, pgpd, pgumbel, phuber, pkumar, plaplace, plomax,
    ppareto, prayleigh, pslash, qfrechet, qgev, qgompertz, qgpd,
    qgumbel, qhuber, qkumar, qlaplace, qlomax, qpareto, qrayleigh,
    rfrechet, rgev, rgompertz, rgpd, rgumbel, rhuber, rkumar, rlaplace,
    rlomax, rpareto, rrayleigh, rskellam, rslash</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ordinal':

    dgumbel, pgumbel, qgumbel, rgumbel</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.999</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.99, size = 8)"</span>),</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL CORRECT"</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.001</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.001, size = 8)"</span>),</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL WRONG"</span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.5, size = 8)"</span>),</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FIGURED IT OUT HALFWAY "</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.001</span>, <span class="at">shape2 =</span> <span class="dv">1</span>),</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 6, shape2 = 4)"</span>),</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Note that in all cases, we have to slightly adjust the parameters because the distribution can’t handle values at 0 or 1. So we scrunch the data in just a bit.</strong></p>
</section>
<section id="beta-regression-1" class="level3">
<h3 class="anchored" data-anchor-id="beta-regression-1">BETA Regression</h3>
<p>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</p>
<p>The syntax is just like all other formula-based regression functions, but with an added bit: the first part of the equation (x ~ y) models the mean, or MU, while anything that comes after a | in the formula will explain variation in the precision, or PHI.</p>
<p>The link parameter determines the link function for the mu estimate?.</p>
<section id="setup" class="level4">
<h4 class="anchored" data-anchor-id="setup">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co">#RESCLAE VARIABLE</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="co">#beta reg can't handle 0s and 1s </span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, DV_percent_NABS)</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(sub) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>sub<span class="sc">$</span>dv_transformed <span class="ot">=</span> (sub<span class="sc">$</span>DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE VARIABLES</span></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Slightly squished data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Slightly squished data"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(sub<span class="sc">$</span>dv_transformed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>mb1 <span class="ot">&lt;-</span> <span class="fu">betareg</span>(dv_transformed <span class="sc">~</span> condition <span class="sc">|</span> condition, </span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> sub)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mb1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = dv_transformed ~ condition | condition, data = sub)

Standardized weighted residuals 2:
   Min     1Q Median     3Q    Max 
-1.239 -0.433 -0.407  0.562  1.740 

Coefficients (mean model with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -0.845      0.185   -4.56    5e-06 ***
conditionimpasse    0.515      0.248    2.08    0.038 *  

Phi coefficients (precision model with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)        -0.398      0.154   -2.58   0.0099 **
conditionimpasse    0.237      0.207    1.14   0.2534   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood:  140 on 4 Df
Pseudo R-squared: 0.085
Number of iterations: 17 (BFGS) + 1 (Fisher scoring) </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mb1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Which link function should be used for each? We now have two sets of coefficients, one set for each parameter (the mean and precision). The parameters for the mean are measured on the logit scale, just like with logistic regression previously, and we can calculate the marginal effect of having a quota by using plogis() and piecing together the coefficient and the intercept:</li>
</ul>
</section>
<section id="interpret" class="level4">
<h4 class="anchored" data-anchor-id="interpret">Interpret</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>beta_mu_intercept <span class="ot">&lt;-</span> mb1 <span class="sc">%&gt;%</span> </span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>beta_mu_condition <span class="ot">&lt;-</span> mb1 <span class="sc">%&gt;%</span> </span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- PROBABILITIES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- PROBABILITIES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"[these should math pred plots]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "[these should math pred plots]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at reference level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability at reference level"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at coefficient level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability at coefficient level"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.418</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"CHANGE in probability by coefficient"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CHANGE in probability by coefficient"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition) <span class="sc">-</span> <span class="fu">plogis</span>(beta_mu_intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.118</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mb1, <span class="at">type =</span> <span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Impasse increases the average of the distribution of accuracy by 12% percentage points, on average. This should match the value we get with fractional regression. (logistic regression with count variable instead of binomial)</p>
<ul>
<li>The intercept of MU indicates the average of the distribution of score proportion in the control condition</li>
<li>The coefficient of MU indicates the change in the average distribution of score proportion in the impasse condition</li>
</ul>
<p>The PHI parameter estimates are not measured on a logit scale. Instead, they’re log values. We can invert them by exponentiating them with exp(). - The phi intercept indicates the precision of the distribution of score proportion in the control condition - The phi coefficient indicates the change in the precision of the distribution of score proportion in the impasse condition</p>
<ul>
<li>CONDITION is a significant predictor of MEAN (location) but not PHI (precision). Put another way, the shape of both distributions is similar, but the impasse condition distribution is shift to the right (higher) than the control distribution.</li>
</ul>
</section>
<section id="compare" class="level4">
<h4 class="anchored" data-anchor-id="compare">Compare</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPARE MODELS</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(df) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> item_test_NABS<span class="sc">/</span><span class="dv">8</span>,</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_trans =</span> (accuracy <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n,</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_trans =</span> (DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( test_trans <span class="sc">~</span> pretty_condition    , <span class="at">data =</span> df)</span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm1)</span></span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION on LOGTRANSFORMED</span></span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>qlm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( <span class="fu">qlogis</span>(test_trans) <span class="sc">~</span> pretty_condition    , <span class="at">data =</span> df)</span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(qlm1)</span></span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a><span class="co"># FRACTIONAL REGRESSION</span></span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a><span class="co">#uses quasibinomial [like binomial] on proportion </span></span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a><span class="co">#instead of binomial data. coeffs on logit scale</span></span>
<span id="cb225-24"><a href="#cb225-24" aria-hidden="true" tabindex="-1"></a>flm1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( test_trans <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">quasibinomial</span>())</span>
<span id="cb225-25"><a href="#cb225-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = test_trans ~ pretty_condition, family = quasibinomial(), 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.014  -0.667  -0.667   0.949   1.733  

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               -1.289      0.274   -4.71  6.6e-06 ***
pretty_conditionimpasse    0.953      0.354    2.69   0.0082 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasibinomial family taken to be 0.788)

    Null deviance: 117.11  on 125  degrees of freedom
Residual deviance: 111.18  on 124  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BETA REGRESSION predictor phi</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>bm1 <span class="ot">&lt;-</span> <span class="fu">betareg</span>(test_trans <span class="sc">~</span> pretty_condition <span class="sc">|</span> pretty_condition, </span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> df, <span class="at">link =</span> <span class="st">"logit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in betareg.fit(X, Y, Z, weights, offset, link, link.phi, type, control):
no valid starting value for precision parameter found, using 1 instead</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = test_trans ~ pretty_condition | pretty_condition, data = df, 
    link = "logit")

Standardized weighted residuals 2:
   Min     1Q Median     3Q    Max 
-0.867 -0.397 -0.397  0.619  1.525 

Coefficients (mean model with logit link):
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -0.851      0.186   -4.58  4.7e-06 ***
pretty_conditionimpasse    0.530      0.252    2.10    0.036 *  

Phi coefficients (precision model with log link):
                        Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)              -0.4319     0.1545   -2.80   0.0052 **
pretty_conditionimpasse  -0.0629     0.2052   -0.31   0.7593   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood:  183 on 4 Df
Pseudo R-squared: 0.0608
Number of iterations: 17 (BFGS) + 2 (Fisher scoring) </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"LM"</span> <span class="ot">=</span> lm1, </span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"LM log transform"</span> <span class="ot">=</span> qlm1, </span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"GLM Quasibinomial"</span> <span class="ot">=</span> flm1, </span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"beta"</span> <span class="ot">=</span> bm1)</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(models)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> LM </th>
   <th style="text-align:center;"> LM log transform </th>
   <th style="text-align:center;"> GLM Quasibinomial </th>
   <th style="text-align:center;"> beta </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:center;"> 0.216 </td>
   <td style="text-align:center;"> −3.241 </td>
   <td style="text-align:center;"> −1.289 </td>
   <td style="text-align:center;"> −0.851 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.051) </td>
   <td style="text-align:center;"> (0.518) </td>
   <td style="text-align:center;"> (0.274) </td>
   <td style="text-align:center;"> (0.186) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> pretty_conditionimpasse </td>
   <td style="text-align:center;"> 0.201 </td>
   <td style="text-align:center;"> 2.059 </td>
   <td style="text-align:center;"> 0.953 </td>
   <td style="text-align:center;"> 0.530 </td>
  </tr>
  <tr>
   <td style="text-align:left;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.071) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.727) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.354) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.252) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Num.Obs. </td>
   <td style="text-align:center;"> 126 </td>
   <td style="text-align:center;"> 126 </td>
   <td style="text-align:center;"> 126 </td>
   <td style="text-align:center;"> 126 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> R2 </td>
   <td style="text-align:center;"> 0.060 </td>
   <td style="text-align:center;"> 0.061 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 0.061 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> R2 Adj. </td>
   <td style="text-align:center;"> 0.052 </td>
   <td style="text-align:center;"> 0.053 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> AIC </td>
   <td style="text-align:center;"> 131.3 </td>
   <td style="text-align:center;"> 715.9 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> −357.1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BIC </td>
   <td style="text-align:center;"> 139.8 </td>
   <td style="text-align:center;"> 724.4 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> −345.7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Log.Lik. </td>
   <td style="text-align:center;"> −62.653 </td>
   <td style="text-align:center;"> −354.946 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F </td>
   <td style="text-align:center;"> 7.887 </td>
   <td style="text-align:center;"> 8.022 </td>
   <td style="text-align:center;"> 7.225 </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> RMSE </td>
   <td style="text-align:center;"> 0.40 </td>
   <td style="text-align:center;"> 4.05 </td>
   <td style="text-align:center;"> 0.40 </td>
   <td style="text-align:center;"> 0.40 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GET ESTIMATES</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>model_beta <span class="ot">&lt;-</span> bm1</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>beta_mu_intercept <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>beta_mu_condition <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"pretty_conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>beta_phi_intercept <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"precision"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a>beta_phi_condition <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb232-21"><a href="#cb232-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"precision"</span>, term <span class="sc">==</span> <span class="st">"pretty_conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb232-22"><a href="#cb232-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb232-23"><a href="#cb232-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-24"><a href="#cb232-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-25"><a href="#cb232-25" aria-hidden="true" tabindex="-1"></a>mu_control <span class="ot">=</span> <span class="fu">plogis</span>(beta_mu_intercept)</span>
<span id="cb232-26"><a href="#cb232-26" aria-hidden="true" tabindex="-1"></a>phi_control <span class="ot">=</span> <span class="fu">plogis</span>(beta_phi_intercept)</span>
<span id="cb232-27"><a href="#cb232-27" aria-hidden="true" tabindex="-1"></a><span class="co">#when you don’t explicitly model the precision, the resulting coefficient in the table isn’t on the log scale—it’s a regular non-logged number, so there’s no need to exponentiate</span></span>
<span id="cb232-28"><a href="#cb232-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-29"><a href="#cb232-29" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT ESTIMATES</span></span>
<span id="cb232-30"><a href="#cb232-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-31"><a href="#cb232-31" aria-hidden="true" tabindex="-1"></a>control_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"dprop(mean = plogis("</span>, <span class="fu">round</span>(beta_mu_intercept, <span class="dv">2</span>),</span>
<span id="cb232-32"><a href="#cb232-32" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"), size = exp("</span>, <span class="fu">round</span>(beta_phi_intercept, <span class="dv">2</span>), <span class="st">"))"</span>)</span>
<span id="cb232-33"><a href="#cb232-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-34"><a href="#cb232-34" aria-hidden="true" tabindex="-1"></a>impasse_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"dprop(mean = plogis("</span>, <span class="fu">round</span>(beta_mu_intercept, <span class="dv">2</span>),</span>
<span id="cb232-35"><a href="#cb232-35" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" + "</span>, <span class="fu">round</span>(beta_mu_condition, <span class="dv">2</span>), </span>
<span id="cb232-36"><a href="#cb232-36" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"), size = exp("</span>, <span class="fu">round</span>(beta_phi_intercept, <span class="dv">2</span>),</span>
<span id="cb232-37"><a href="#cb232-37" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" + "</span>, <span class="fu">round</span>(beta_phi_condition, <span class="dv">2</span>), <span class="st">"))"</span>)</span>
<span id="cb232-38"><a href="#cb232-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-39"><a href="#cb232-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb232-40"><a href="#cb232-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dprop, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb232-41"><a href="#cb232-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fu">exp</span>(beta_phi_intercept), </span>
<span id="cb232-42"><a href="#cb232-42" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mean =</span> <span class="fu">plogis</span>(beta_mu_intercept)),</span>
<span id="cb232-43"><a href="#cb232-43" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> control_title)) <span class="sc">+</span> </span>
<span id="cb232-44"><a href="#cb232-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dprop, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb232-45"><a href="#cb232-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fu">exp</span>(beta_phi_intercept <span class="sc">+</span> beta_phi_condition), </span>
<span id="cb232-46"><a href="#cb232-46" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mean =</span> <span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition)),</span>
<span id="cb232-47"><a href="#cb232-47" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> impasse_title)) <span class="sc">+</span></span>
<span id="cb232-48"><a href="#cb232-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> df, </span>
<span id="cb232-49"><a href="#cb232-49" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> test_trans, <span class="at">fill =</span> pretty_condition), </span>
<span id="cb232-50"><a href="#cb232-50" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb232-51"><a href="#cb232-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Beta Regression Predictions"</span>) <span class="sc">+</span></span>
<span id="cb232-52"><a href="#cb232-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb232-53"><a href="#cb232-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also convert the parameter estimates back to A and B. for the impasse condition, MU = 0.397 SIZE = 0.666</p>
<p>a = mu * phi = 0.397 * 0.66 = 0.264 b = (1 - mu) * phi = (1 - 0.397) * 0.666 = 0.402</p>
<p>we should expect it to look more like … (for 50% ) a = correct = 3 b = incorrect = 10 a + b = total = 13</p>
<p>MU = a / (a+b) [the score] = 3 / 13 = 0.23 PHI = a + b [ the total # items ] = 13</p>
<p>mu = 0.277 = a / (a + b) phi = 0.395 = a + b let b = 13</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co">#RECOVER A AND B FROM MU AND PHI</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>muphi_to_shapes <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, phi) {</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  shape1 <span class="ot">&lt;-</span> mu <span class="sc">*</span> phi</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>  shape2 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> mu) <span class="sc">*</span> phi</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">shape1 =</span> shape1, <span class="at">shape2 =</span> shape2))</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>shapes_to_muphi <span class="ot">&lt;-</span> <span class="cf">function</span>(shape1, shape2) {</span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> shape1 <span class="sc">/</span> (shape1 <span class="sc">+</span> shape2)</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> shape1 <span class="sc">+</span> shape2</span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mu =</span> mu, <span class="at">phi =</span> phi))</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"model predicts control A and B "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "model predicts control A and B "</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">muphi_to_shapes</span>(mu_control, phi_control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$shape1
[1] 0.118

$shape2
[1] 0.276</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"should be something like "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "should be something like "</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapes_to_muphi</span>(<span class="dv">5</span>,<span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$mu
[1] 0.278

$phi
[1] 18</code></pre>
</div>
</div>
<p>It seems like the although the (shrinkled) beta regression model is working, it is really messing up the estimate of the PHI parameter, such that we can’t even recover the A and B. I expect whole numbers, and instead I’m geting values less than 1. I think this might be because the phi value is so low (note that phi = precision, so like inverse of variance. Lower values are more less precise (more variance)). Since I have so many values near 0 and near 1 (even though I’ve shrunk the estimates to be in the open interval (0,1) rather than [0,1], I think it causing problems with the estimation. )</p>
</section>
<section id="bayesian-version" class="level4">
<h4 class="anchored" data-anchor-id="bayesian-version">bayesian version</h4>
<p>https://www.bayesrulesbook.com/</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rcpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading 'brms' package (version 2.17.0). Useful instructions
can be found by typing help('brms'). A more detailed introduction
to the package is available through vignette('brms_overview').</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'brms'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:extraDistr':

    ddirichlet, dfrechet, pfrechet, qfrechet, rdirichlet, rfrechet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    acat, cratio, cumulative, dfrechet, dirichlet, exponential,
    frechet, geometric, lognormal, multinomial, negbinomial, pfrechet,
    qfrechet, rfrechet, s, sratio</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ordinal':

    ranef, VarCorr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    ngrps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggdist':

    dstudent_t, pstudent_t, qstudent_t, rstudent_t</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    kidney</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    ar</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>model_beta_bayes <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(test_trans <span class="sc">~</span> pretty_condition,</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> pretty_condition),</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">Beta</span>(),</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the cmdstanr backend for Stan because it's faster and more modern than</span></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the default rstan You need to install the cmdstanr package first</span></span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (https://mc-stan.org/cmdstanr/) and then run cmdstanr::install_cmdstan() to</span></span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># install cmdstan on your computer.</span></span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span></span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 finished in 0.3 seconds.
Chain 2 finished in 0.3 seconds.
Chain 3 finished in 0.3 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 0.3 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.3 seconds.
Total execution time: 0.6 seconds.</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_beta_bayes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: beta 
  Links: mu = logit; phi = log 
Formula: test_trans ~ pretty_condition 
         phi ~ pretty_condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                      -0.85      0.19    -1.22    -0.47 1.00     2740
phi_Intercept                  -0.45      0.16    -0.77    -0.16 1.00     2846
pretty_conditionimpasse         0.53      0.25     0.02     1.01 1.00     3056
phi_pretty_conditionimpasse    -0.06      0.20    -0.45     0.34 1.00     3452
                            Tail_ESS
Intercept                       2893
phi_Intercept                   2889
pretty_conditionimpasse         3205
phi_pretty_conditionimpasse     2805

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Cool! parameters are almost identical to betareg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cool! parameters are almost identical to betareg"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidybayes'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:brms':

    dstudent_t, pstudent_t, qstudent_t, rstudent_t</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:bayestestR':

    hdi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:parameters':

    parameters</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:distributional':

    parameters</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gnm':

    parameters</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggridges':

    scale_point_color_continuous, scale_point_color_discrete,
    scale_point_colour_continuous, scale_point_colour_discrete,
    scale_point_fill_continuous, scale_point_fill_discrete,
    scale_point_size_continuous</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>posterior_beta <span class="ot">&lt;-</span> model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(<span class="st">`</span><span class="at">b_.*</span><span class="st">`</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">component =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(.variable, <span class="st">"phi_"</span>), <span class="st">"Precision"</span>, <span class="st">"Mean"</span>),</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercept =</span> <span class="fu">str_detect</span>(.variable, <span class="st">"Intercept"</span>))</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(posterior_beta, <span class="fu">aes</span>(<span class="at">x =</span> .value, <span class="at">y =</span> <span class="fu">fct_rev</span>(.variable), <span class="at">fill =</span> component)) <span class="sc">+</span></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">slab_alpha =</span> intercept), </span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.95</span>), <span class="at">point_interval =</span> <span class="st">"median_hdi"</span>) <span class="sc">+</span></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">end =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_slab_alpha_discrete</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">slab_alpha =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Coefficient"</span>, <span class="at">y =</span> <span class="st">"Variable"</span>,</span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"80% and 95% credible intervals shown in black; RAW COEFF"</span>) <span class="sc">+</span></span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(component), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="do">##GET USEFUL ESTIMATES</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TRANSFORMED ESTIMATES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "TRANSFORMED ESTIMATES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(<span class="st">`</span><span class="at">b_.*</span><span class="st">`</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"b_phi"</span>), <span class="sc">~</span><span class="fu">exp</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>((<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"."</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"b_phi"</span>)), <span class="sc">~</span><span class="fu">plogis</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_variables</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_hdi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  .variable                     .value .lower .upper .width .point .interval
  &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1 b_Intercept                    0.300  0.223  0.377   0.95 median hdi      
2 b_phi_Intercept                0.643  0.451  0.843   0.95 median hdi      
3 b_phi_pretty_conditionimpasse  0.944  0.613  1.36    0.95 median hdi      
4 b_pretty_conditionimpasse      0.628  0.511  0.737   0.95 median hdi      </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now phi is a raw value indicating precision</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co"># now mu is an odds ratio for median? of the distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="bayesian-predictions" class="level4">
<h4 class="anchored" data-anchor-id="bayesian-predictions">Bayesian predictions</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plug a dataset where quota is FALSE and TRUE into the model</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>beta_bayes_pred <span class="ot">&lt;-</span> model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epred_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">pretty_condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>)))</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_bayes_pred, </span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> .epred, <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> pretty_condition)) <span class="sc">+</span></span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.95</span>), <span class="at">point_interval =</span> <span class="st">"median_hdi"</span>) <span class="sc">+</span></span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted Comprehension Task Score Percentage Correct"</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"80% and 95% credible intervals shown in black"</span>) <span class="sc">+</span></span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO POSTERIOR PREDICTIVE CHECKS </span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="co"># describe_posterior(model_beta_bayes, test = c("p_direction", "rope", "bayesfactor"))</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstanarm)</span></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pp_check(model_beta_bayes, plotfun = "boxplot", nreps = 10, notch = FALSE)</span></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="co"># pp_check(model_beta_bayes, plotfun = "stat_grouped", stat = "median", group = "pretty_condition")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="zero-inflated-beta" class="level3">
<h3 class="anchored" data-anchor-id="zero-inflated-beta">ZERO INFLATED BETA</h3>
<ol type="1">
<li>logistic regression for zero inflated <span class="math inline">\(\alpha\)</span> (logit scale)</li>
<li>beta regression for proportion <span class="math inline">\(\mu\)</span> (logit scale) and <span class="math inline">\(\phi\)</span> (log scale)</li>
</ol>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, DV_percent_NABS) <span class="sc">%&gt;%</span> </span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> pretty_condition,</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> DV_percent_NABS</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a><span class="co">#shrink accuracy just a tiny bit from 1 for testing purposes </span></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyfst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Life's short, use R.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyfst'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, cummean, nth</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    percent</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate_when</span>(accuracy <span class="sc">==</span> <span class="dv">1</span>, <span class="at">accuracy =</span> <span class="fl">0.99</span>)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERCEPT ONLY model for alpha</span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>zinb <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(accuracy <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>     zi <span class="sc">~</span> condition), <span class="co">#zero inflated is extreme? alpha</span></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_inflated_beta</span>(),</span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/zinb.rds"</span></span>
<span id="cb280-14"><a href="#cb280-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: zero_inflated_beta 
  Links: mu = logit; phi = log; zi = logit 
Formula: accuracy ~ condition 
         phi ~ condition
         zi ~ condition
   Data: df (Number of observations: 330) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                0.18      0.16    -0.14     0.51 1.00     4388
phi_Intercept            0.04      0.15    -0.26     0.32 1.00     4447
zi_Intercept             0.52      0.16     0.21     0.86 1.00     5364
conditionimpasse         0.04      0.20    -0.36     0.43 1.00     4433
phi_conditionimpasse     0.17      0.18    -0.17     0.53 1.00     4856
zi_conditionimpasse     -1.36      0.24    -1.83    -0.90 1.00     4822
                     Tail_ESS
Intercept                2768
phi_Intercept            3118
zi_Intercept             3269
conditionimpasse         3138
phi_conditionimpasse     3267
zi_conditionimpasse      2933

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Response residuals not available to calculate mean square error. (R)MSE
  is probably not reliable.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

ELPD     | ELPD_SE |   LOOIC | LOOIC_SE |    WAIC |    R2 |  RMSE | Sigma
-------------------------------------------------------------------------
-185.435 |   9.411 | 370.869 |   18.823 | 370.856 | 0.058 | 0.368 | 1.000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(zinb))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(zinb, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tidy.brmsfit(zinb, effects = "fixed"): some parameter names contain
underscores: term naming may be unreliable!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  effect component term                 estimate std.error conf.low conf.high
  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  cond      (Intercept)            0.182      0.164   -0.142     0.506
2 fixed  cond      phi_(Intercept)        0.0379     0.146   -0.256     0.317
3 fixed  zi        (Intercept)            0.524      0.165    0.208     0.858
4 fixed  cond      conditionimpasse       0.0375     0.202   -0.356     0.427
5 fixed  cond      phi_conditionimpasse   0.173      0.178   -0.169     0.528
6 fixed  zi        conditionimpasse      -1.36       0.236   -1.83     -0.899</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"INTERPRET ALPHA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "INTERPRET ALPHA"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>zi_intercept <span class="ot">&lt;-</span> <span class="fu">tidy</span>(zinb, <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"zi"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tidy.brmsfit(zinb, effects = "fixed"): some parameter names contain
underscores: term naming may be unreliable!</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit scale intercept</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>zi_intercept</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>b_zi_Intercept 
         0.524 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="do">## b_zi_Intercept </span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="do">##          0.525</span></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformed to a probability/proportion</span></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(zi_intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>b_zi_Intercept 
         0.628 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="do">## b_zi_Intercept </span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="do">##         0.628</span></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(accuracy <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> condition <span class="sc">==</span> <span class="st">"control"</span>))<span class="sc">/</span><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.661</code></pre>
</div>
</div>
<p>The value of the z_intercept should be the same as the proportion of 0s in the control condition.</p>
<p>VISUALIZE ZERO INFLATED COMPONENT ::: {.cell}</p>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>beta_zi_pred_int <span class="ot">&lt;-</span> zinb <span class="sc">%&gt;%</span> </span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_zero =</span> .prediction <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_zero, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_zero), <span class="at">binwidth =</span> <span class="fl">0.025</span>, </span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is zero?"</span>) <span class="sc">+</span></span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb300-16"><a href="#cb300-16" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb300-17"><a href="#cb300-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb300-18"><a href="#cb300-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
<p>:::</p>
</section>
<section id="zero-one-inflated-beta-regression" class="level3">
<h3 class="anchored" data-anchor-id="zero-one-inflated-beta-regression">ZERO-ONE INFLATED BETA Regression</h3>
<p>https://sometimesir.com/posts/2019-02-18-analyze-analog-scale-ratings-with-zero-one-inflated-beta-models/#zoib-regression https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</p>
<p><strong>TODO</strong> - explore priors - explore random effects - explore non-beta distribution; once the 1s and zeros are gone, do we need the beta?</p>
<p>A zero-inflated beta regression allows us to model a separate data generating process for the 0s and 1s and the rest.</p>
<p>A ZOINB is a mixture of:</p>
<ol type="1">
<li><p>A logistic regression model that predicts if an outcome is either 0 or 1 or not 0 or 1, defined by (or alternatively, a model that predicts if outcomes are extreme (0 or 1) or not (between 0 and 1); “IS EXTREME” model; defined by <span class="math inline">\(\alpha\)</span></p></li>
<li><p>A logistic regression model that predicts if any of the 0 or 1 outcomes are actually 1s, defined by (or alternatively, a model that predicts if the extreme values are 1) “WHICH EXTREME” model defined by <span class="math inline">\(\gamma\)</span></p></li>
<li><p>A beta regression model that predicts if an outcome is between 0 and 1 if it’s not zero or not one, defined by and (or alternatively, a model that predicts the non-extreme (0 or 1) values) “THE REST” model <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\phi\)</span></p></li>
</ol>
<p>Can also do mixed! (but no reason do this here, as the item level data is not beta reg )</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DATA SETUP</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sub &lt;- df_subjects %&gt;% dplyr::select(condition, DV_percent_NABS) </span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="co"># don't need to transform anymore</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> pretty_condition,</span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaled =</span> (s_SCALED <span class="sc">+</span> <span class="dv">13</span>)<span class="sc">/</span><span class="dv">26</span>,  <span class="co">#transform scaled onto 0-1 scale</span></span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> item_test_NABS<span class="sc">/</span><span class="dv">8</span></span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, scaled, accuracy)</span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERCEPT ONLY model for alpha</span></span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a>zoinb <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb301-14"><a href="#cb301-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(accuracy <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb301-15"><a href="#cb301-15" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb301-16"><a href="#cb301-16" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition, <span class="co">#is extreme? alpha</span></span>
<span id="cb301-17"><a href="#cb301-17" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition), <span class="co">#is 1? gamma</span></span>
<span id="cb301-18"><a href="#cb301-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb301-19"><a href="#cb301-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb301-20"><a href="#cb301-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb301-21"><a href="#cb301-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb301-22"><a href="#cb301-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb301-23"><a href="#cb301-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/zoinb.rds"</span></span>
<span id="cb301-24"><a href="#cb301-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb301-25"><a href="#cb301-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-26"><a href="#cb301-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-27"><a href="#cb301-27" aria-hidden="true" tabindex="-1"></a>zoinb_scaled <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb301-28"><a href="#cb301-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(scaled <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb301-29"><a href="#cb301-29" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb301-30"><a href="#cb301-30" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition, <span class="co">#is extreme? alpha</span></span>
<span id="cb301-31"><a href="#cb301-31" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition), <span class="co">#is 1? gamma</span></span>
<span id="cb301-32"><a href="#cb301-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb301-33"><a href="#cb301-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb301-34"><a href="#cb301-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb301-35"><a href="#cb301-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb301-36"><a href="#cb301-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb301-37"><a href="#cb301-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/zoinb_scaled.rds"</span></span>
<span id="cb301-38"><a href="#cb301-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zoinb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: zero_one_inflated_beta 
  Links: mu = logit; phi = log; zoi = logit; coi = logit 
Formula: accuracy ~ condition 
         phi ~ condition
         zoi ~ condition
         coi ~ condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                0.18      0.34    -0.50     0.83 1.00     4686
phi_Intercept            0.64      0.37    -0.14     1.30 1.00     5921
zoi_Intercept            1.54      0.33     0.90     2.21 1.00     6065
coi_Intercept           -1.86      0.42    -2.72    -1.10 1.00     6592
conditionimpasse         0.15      0.40    -0.61     0.94 1.00     4866
phi_conditionimpasse     0.28      0.44    -0.57     1.16 1.00     6320
zoi_conditionimpasse    -1.18      0.43    -2.02    -0.36 1.00     5970
coi_conditionimpasse     0.98      0.55    -0.10     2.06 1.00     7590
                     Tail_ESS
Intercept                3068
phi_Intercept            3140
zoi_Intercept            3053
coi_Intercept            3007
conditionimpasse         3428
phi_conditionimpasse     3219
zoi_conditionimpasse     3058
coi_conditionimpasse     2865

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(zoinb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_phi_conditionimpasse and b_phi_Intercept (r = 0.83), b_zoi_conditionimpasse and b_zoi_Intercept (r = 0.8), b_coi_conditionimpasse and b_coi_Intercept (r = 0.76). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(zoinb_scaled))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_phi_conditionimpasse and b_phi_Intercept (r = 0.81). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-44-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-44-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>More plots</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(zoinb, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tidy.brmsfit(zoinb, effects = "fixed"): some parameter names contain
underscores: term naming may be unreliable!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  effect component term                 estimate std.error conf.low conf.high
  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  cond      (Intercept)             0.184     0.337   -0.495     0.826
2 fixed  cond      phi_(Intercept)         0.636     0.366   -0.143     1.30 
3 fixed  cond      zoi_(Intercept)         1.54      0.332    0.904     2.21 
4 fixed  cond      coi_(Intercept)        -1.86      0.418   -2.72     -1.10 
5 fixed  cond      conditionimpasse        0.153     0.397   -0.609     0.940
6 fixed  cond      phi_conditionimpasse    0.281     0.441   -0.573     1.16 
7 fixed  cond      zoi_conditionimpasse   -1.18      0.425   -2.02     -0.358
8 fixed  cond      coi_conditionimpasse    0.976     0.553   -0.103     2.06 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"INTERPRET ALPHA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "INTERPRET ALPHA"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>zoi_intercept <span class="ot">&lt;-</span> <span class="fu">tidy</span>(zoinb, <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"cond"</span>, term <span class="sc">==</span> <span class="st">"zoi_(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tidy.brmsfit(zoinb, effects = "fixed"): some parameter names contain
underscores: term naming may be unreliable!</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit scale intercept</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>zoi_intercept</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>b_zoi_Intercept 
           1.54 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformed to a probability/proportion</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(zoi_intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>b_zoi_Intercept 
          0.824 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(accuracy <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">&amp;</span> condition <span class="sc">==</span> <span class="st">"control"</span>))<span class="sc">/</span><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.823</code></pre>
</div>
</div>
<p>The value of the zoi_intercept should be the same as the proportion of 0s and 1s (vs non 0s and 1s) in the control condition… and it does!</p>
<p>VISUALIZE ZERO INFLATED COMPONENT ::: {.cell}</p>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>beta_zoi_pred_int <span class="ot">&lt;-</span> zoinb <span class="sc">%&gt;%</span> </span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_extreme =</span> .prediction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">is_one =</span> .prediction <span class="sc">==</span><span class="dv">1</span>, </span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_extreme <span class="sc">&amp;</span> <span class="sc">!</span>is_one, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction),</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_one, .prediction <span class="sc">+</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zoi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_extreme), <span class="at">binwidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb323-14"><a href="#cb323-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb323-15"><a href="#cb323-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb323-16"><a href="#cb323-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is extreme?"</span>) <span class="sc">+</span></span>
<span id="cb323-17"><a href="#cb323-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb323-18"><a href="#cb323-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb323-19"><a href="#cb323-19" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb323-20"><a href="#cb323-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb323-21"><a href="#cb323-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<p>::: ::: {.cell}</p>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>beta_zoi_pred_int <span class="ot">&lt;-</span> zoinb_scaled <span class="sc">%&gt;%</span> </span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_extreme =</span> .prediction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">is_one =</span> .prediction <span class="sc">==</span><span class="dv">1</span>, </span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_extreme <span class="sc">&amp;</span> <span class="sc">!</span>is_one, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction),</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_one, .prediction <span class="sc">+</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zoi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_extreme), <span class="at">binwidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb324-15"><a href="#cb324-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb324-16"><a href="#cb324-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is extreme?"</span>) <span class="sc">+</span></span>
<span id="cb324-17"><a href="#cb324-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb324-18"><a href="#cb324-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb324-19"><a href="#cb324-19" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb324-20"><a href="#cb324-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb324-21"><a href="#cb324-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
<p>:::</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(zoinb, <span class="at">draws =</span> <span class="dv">8000</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using 10 posterior draws for ppc type 'dens_overlay' by default.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following arguments were unrecognized and ignored: draws</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="hurdle-neg-binom-bayesian" class="level3">
<h3 class="anchored" data-anchor-id="hurdle-neg-binom-bayesian">HURDLE + NEG BINOM (bayesian)</h3>
<p>Rather than transform score to a proportion correct, keep it in native count form, and model as negative binomial. hurdle model :</p>
<ol type="1">
<li>A logistic regression model that predicts if an outcome is 0 or not (this is the hurdle part)</li>
<li>A lognormal (hurdle_lognormal()), gamma (hurdle_gamma()), Poisson (hurdle_poisson()), or negative binomial (hurdle_negbinomial()) model for outcomes that are not zero</li>
</ol>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> item_test_NABS,</span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> pretty_condition</span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT</span></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>score, <span class="at">fill =</span> <span class="sc">~</span> condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>hln <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(score <span class="sc">~</span> condition,</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>     hu <span class="sc">~</span> condition),</span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">hurdle_lognormal</span>(),</span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/hln.rds"</span></span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-13"><a href="#cb329-13" aria-hidden="true" tabindex="-1"></a>hnb <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb329-14"><a href="#cb329-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(score <span class="sc">~</span> condition,</span>
<span id="cb329-15"><a href="#cb329-15" aria-hidden="true" tabindex="-1"></a>     hu <span class="sc">~</span> condition),</span>
<span id="cb329-16"><a href="#cb329-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb329-17"><a href="#cb329-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">hurdle_negbinomial</span>(),</span>
<span id="cb329-18"><a href="#cb329-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb329-19"><a href="#cb329-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb329-20"><a href="#cb329-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb329-21"><a href="#cb329-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/hnb.rds"</span></span>
<span id="cb329-22"><a href="#cb329-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb329-23"><a href="#cb329-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-24"><a href="#cb329-24" aria-hidden="true" tabindex="-1"></a>hpoi <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb329-25"><a href="#cb329-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(score <span class="sc">~</span> condition,</span>
<span id="cb329-26"><a href="#cb329-26" aria-hidden="true" tabindex="-1"></a>     hu <span class="sc">~</span> condition),</span>
<span id="cb329-27"><a href="#cb329-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb329-28"><a href="#cb329-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">hurdle_poisson</span>(),</span>
<span id="cb329-29"><a href="#cb329-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb329-30"><a href="#cb329-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb329-31"><a href="#cb329-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb329-32"><a href="#cb329-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/hpoi.rds"</span></span>
<span id="cb329-33"><a href="#cb329-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb329-34"><a href="#cb329-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-35"><a href="#cb329-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-36"><a href="#cb329-36" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: hurdle_lognormal 
  Links: mu = identity; sigma = identity; hu = logit 
Formula: score ~ condition 
         hu ~ condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept               1.56      0.17     1.23     1.90 1.00     4165     2973
hu_Intercept            0.90      0.28     0.38     1.46 1.00     3768     2802
conditionimpasse        0.02      0.21    -0.39     0.42 1.00     4336     3019
hu_conditionimpasse    -1.23      0.38    -1.99    -0.48 1.00     4061     2334

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.73      0.07     0.61     0.88 1.00     4271     2950

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hnb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: hurdle_negbinomial 
  Links: mu = log; shape = identity; hu = logit 
Formula: score ~ condition 
         hu ~ condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept               1.76      0.11     1.54     1.97 1.00     3785     2780
hu_Intercept            0.90      0.29     0.34     1.49 1.00     4271     2678
conditionimpasse       -0.02      0.14    -0.29     0.25 1.00     3901     2831
hu_conditionimpasse    -1.23      0.38    -2.00    -0.48 1.00     4206     2768

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
shape    42.90     51.27     5.69   184.18 1.00     3524     2681

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hpoi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: hurdle_poisson 
  Links: mu = log; hu = logit 
Formula: score ~ condition 
         hu ~ condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept               1.76      0.10     1.57     1.95 1.00     3312     2732
hu_Intercept            0.91      0.28     0.37     1.49 1.00     3524     2752
conditionimpasse       -0.02      0.12    -0.25     0.22 1.00     3995     3309
hu_conditionimpasse    -1.24      0.38    -2.00    -0.53 1.00     4350     3112

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(hln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(hnb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(hpoi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(hln, hnb, hpoi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Type 'pearson' is deprecated and will be removed in the future.

Warning: Type 'pearson' is deprecated and will be removed in the future.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name |   Model |     ELPD | ELPD_SE |   LOOIC | LOOIC weights | LOOIC_SE |    WAIC | WAIC weights |    R2 |  RMSE | Sigma
-------------------------------------------------------------------------------------------------------------------------
hln  | brmsfit | -231.964 |  17.047 | 463.928 |       &lt; 0.001 |   34.094 | 463.888 |      &lt; 0.001 | 0.078 | 3.224 | 0.660
hnb  | brmsfit | -218.127 |  15.993 | 436.255 |         0.256 |   31.987 | 436.257 |        0.393 | 0.061 | 3.208 | 1.000
hpoi | brmsfit | -217.708 |  16.373 | 435.416 |         0.744 |   32.746 | 435.383 |        0.607 | 0.060 | 3.208 | 1.000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(hpoi) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Poisson Hurdle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using 10 posterior draws for ppc type 'dens_overlay' by default.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(hnb) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"NegBinom Hurdle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using 10 posterior draws for ppc type 'dens_overlay' by default.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(hln) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"LogNorm Hurdle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using 10 posterior draws for ppc type 'dens_overlay' by default.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>( p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logged</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(hpoi)</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">log1p</span>(df<span class="sc">$</span>score), </span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">yrep =</span> <span class="fu">log1p</span>(pred[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])) <span class="sc">+</span> </span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Predictive Checks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>pred_gdp_hurdle <span class="ot">&lt;-</span> hpoi <span class="sc">|&gt;</span> </span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>,<span class="st">"impasse"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_zero =</span> .prediction <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_zero, .prediction <span class="sc">-</span> <span class="fl">0.1</span>, .prediction))</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_gdp_hurdle, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_zero), <span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"test phase correct"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is zero?"</span>,</span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Predicted number correct from hurdle model"</span>) <span class="sc">+</span></span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_cartesian(xlim = c(-2500, 75000)) +</span></span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_nice</span>() <span class="sc">+</span></span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This model is making predictions outside the bounds of the data (beyond 8) <strong>TODO</strong> https://jsdajournal.springeropen.com/articles/10.1186/s40488-021-00121-4 consider motivation of hurdle vs zero inflated</p>
</section>
<section id="mixed-zero-one-inflated-beta-regression" class="level3">
<h3 class="anchored" data-anchor-id="mixed-zero-one-inflated-beta-regression">MIXED ZERO-ONE-INFLATED BETA Regression</h3>
<p>Next we’ll explore doing a beta regression on a proportion transformed scaled score at the item level, as a zero one inflated mixed beta reg ::: {.cell}</p>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scaled =</span> (score_SCALED <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">condition =</span> pretty_condition) <span class="sc">%&gt;%</span> </span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(subject, scaled, condition)</span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true" tabindex="-1"></a>zoinb_scaled <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(scaled <span class="sc">~</span> condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) , <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition , <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb351-11"><a href="#cb351-11" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition , <span class="co">#is extreme? alpha</span></span>
<span id="cb351-12"><a href="#cb351-12" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition ), <span class="co">#is 1? gamma</span></span>
<span id="cb351-13"><a href="#cb351-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb351-14"><a href="#cb351-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb351-15"><a href="#cb351-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb351-16"><a href="#cb351-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb351-17"><a href="#cb351-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb351-18"><a href="#cb351-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/zoinb_scaled_2.rds"</span></span>
<span id="cb351-19"><a href="#cb351-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb351-20"><a href="#cb351-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-21"><a href="#cb351-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zoinb_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: zero_one_inflated_beta 
  Links: mu = logit; phi = log; zoi = logit; coi = logit 
Formula: scaled ~ condition + (1 | subject) 
         phi ~ condition
         zoi ~ condition
         coi ~ condition
   Data: df (Number of observations: 1638) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~subject (Number of levels: 126) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.21      0.09     0.02     0.38 1.01      686      999

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept               -0.56      0.10    -0.75    -0.37 1.00     3621
phi_Intercept            2.09      0.18     1.74     2.43 1.00     3764
zoi_Intercept            2.41      0.13     2.17     2.66 1.00     4732
coi_Intercept           -1.16      0.09    -1.33    -0.99 1.00     6594
conditionimpasse         0.25      0.12     0.02     0.47 1.00     3722
phi_conditionimpasse    -0.09      0.20    -0.49     0.30 1.00     4326
zoi_conditionimpasse    -1.20      0.15    -1.50    -0.92 1.00     5779
coi_conditionimpasse     1.46      0.12     1.23     1.69 1.00     6619
                     Tail_ESS
Intercept                2831
phi_Intercept            3016
zoi_Intercept            2525
coi_Intercept            2578
conditionimpasse         2872
phi_conditionimpasse     3305
zoi_conditionimpasse     3425
coi_conditionimpasse     2759

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
<p>:::</p>
</section>
<section id="beta-hurdle-regression-frequentist" class="level3">
<h3 class="anchored" data-anchor-id="beta-hurdle-regression-frequentist">BETA HURDLE Regression (Frequentist)</h3>
<p><a href="https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf" class="uri">https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf</a></p>
<ul>
<li>MU tells if mean is different by condition</li>
<li>SIGMA tells if variance is different by condition</li>
<li>NU coefficient tells if condition yields different probability at floor</li>
<li>TAU coefficient tells if condition yields different probability at ceiling</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BETA HURDLE REGRESSION EXAMPLE</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    sleep</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.dist</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ordinal':

    ranef, VarCorr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmList</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: parallel</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> **********   GAMLSS Version 5.4-3  ********** </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>For more on GAMLSS look at https://www.gamlss.com/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type gamlssNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:brms':

    cs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:extraDistr':

    pcat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    refit</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE SAMPLE DATA </span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> </span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">0.40</span> </span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.60</span> </span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.13</span> </span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.17</span> </span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> p0<span class="sc">-</span> p1</span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> mu <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> sigma <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> (sigma <span class="sc">^</span> <span class="dv">2</span>) </span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> mu) <span class="sc">/</span> mu</span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE DIST</span></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1839</span>) </span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, a, b) </span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a>cat <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, n, <span class="at">prob =</span> <span class="fu">c</span>(p0, p2, p1), <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb372-16"><a href="#cb372-16" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb372-17"><a href="#cb372-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-18"><a href="#cb372-18" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb372-19"><a href="#cb372-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y)</span>
<span id="cb372-20"><a href="#cb372-20" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>x<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this looks not unlike my distribution! </span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.sigma =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.nu =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.tau =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">BEINF</span>() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 7799 
GAMLSS-RS iteration 2: Global Deviance = 7778 
GAMLSS-RS iteration 3: Global Deviance = 7778 
GAMLSS-RS iteration 4: Global Deviance = 7778 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = y ~ 1, family = BEINF(), formula.sigma = ~1,  
    formula.nu = ~1, formula.tau = ~1) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.3796     0.0196   -19.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.3951     0.0162    24.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.632      0.042   -38.9   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -1.4014     0.0382   -36.7   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  5000 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  4996 
                      at cycle:  4 
 
Global Deviance:     7778 
            AIC:     7786 
            SBC:     7812 
******************************************************************</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.000571 
                       variance   =  1 
               coef. of skewness  =  0.0294 
               coef. of kurtosis  =  2.95 
Filliben correlation coefficient  =  1 
******************************************************************</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>fit_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>mu.coefficients) </span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,fit_mu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.406229902102452"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>fit_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,fit_sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.597499259410111"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>fit_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>nu.coefficients) </span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>fit_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>tau.coefficients) </span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>fit_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,fit_p0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>fit_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,fit_p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
</div>
<p><strong>BETA HURDLE INTERPRETATION</strong> - beta component<br>
- MU “location” (mean)<br>
- SIGMA “scale” (positively related to variance; variance = sigma.squared <em>mean</em> (1-mean)<br>
- Rigby, Stasinopoulos, Heller, and De Bastiani (2017) “reparameterized” the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</p>
<p><strong>ZERO-ONE HURDLE COMPONENT</strong><br>
- The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.<br>
- p0 is the probability that a case equals 0,<br>
- p1 is the probability that a case equals 1,<br>
- p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MY DATA</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> <span class="dv">0</span> <span class="co">#min possible value of scale</span></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="dv">13</span> <span class="co">#max possible value of scale</span></span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#for shuffling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:brms':

    mm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    cross</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    chisq, logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lmerTest':

    rand</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    factorize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:rstatix':

    cor_test, prop_test, t_test</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelr':

    resample</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelsummary':

    msummary</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    mplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    rescale</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:cowplot':

    theme_map</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Rescale accuracy using </span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="co"># recommended adjustment </span></span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="co">#rescaled = value-min/(max-min)</span></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> s_NABS,</span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_acc =</span> (accuracy<span class="sc">-</span>min)<span class="sc">/</span>(max<span class="sc">-</span>min), <span class="co">#as %</span></span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_acc =</span> (accuracy <span class="sc">*</span> (<span class="fu">nrow</span>(df)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fu">nrow</span>(df)<span class="sc">/</span>max, <span class="co">#transform for no 0 and 1</span></span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># perm = shuffle(condition),</span></span>
<span id="cb406-9"><a href="#cb406-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_rt =</span> item_scaffold_rt</span>
<span id="cb406-10"><a href="#cb406-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy,R_acc, T_acc, condition,scaffold_rt)</span>
<span id="cb406-11"><a href="#cb406-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-12"><a href="#cb406-12" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb406-13"><a href="#cb406-13" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of accuracy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>T_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of [rescaled] accuracy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-53-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_histogram(~R_acc, fill = ~perm, data = df) %&gt;% gf_facet_wrap(~perm) + labs(title = "Histogram of shuffled accuracy")</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SUMMARIZE SAMPLE</span></span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Grand mean"</span>, <span class="fu">mean</span>(df<span class="sc">$</span>R_acc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand mean 0.316239316239316"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> <span class="fu">favstats</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">var</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Grand stats"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand stats"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>stats </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  df$condition min     Q1 median    Q3 max  mean    sd  n missing   var
1      control   0 0.0000  0.000 0.154   1 0.210 0.370 62       0 0.137
2      impasse   0 0.0577  0.346 0.846   1 0.419 0.387 64       0 0.150</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P0"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">0</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.452</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P1"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">1</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0952</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.sigma =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.nu =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.tau =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">BEINF</span>(), <span class="at">data =</span> df )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 237 
GAMLSS-RS iteration 2: Global Deviance = 237 
GAMLSS-RS iteration 3: Global Deviance = 237 
GAMLSS-RS iteration 4: Global Deviance = 237 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 237 
GAMLSS-RS iteration 2: Global Deviance = 237 
GAMLSS-RS iteration 3: Global Deviance = 237 
GAMLSS-RS iteration 4: Global Deviance = 237 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE EMPTY MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE EMPTY MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ 1, sigma.formula = ~1, nu.formula = ~1,  
    tau.formula = ~1, family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -0.0446     0.1504    -0.3     0.77

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)    0.401      0.124    3.23   0.0016 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 0.0000492  0.1873172       0        1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.558      0.318   -4.91  2.9e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  126 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  122 
                      at cycle:  4 
 
Global Deviance:     237 
            AIC:     245 
            SBC:     256 
******************************************************************</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-53-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  -0.056 
                       variance   =  1.12 
               coef. of skewness  =  0.0143 
               coef. of kurtosis  =  2.79 
Filliben correlation coefficient  =  0.995 
******************************************************************</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>m0_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>mu.coefficients) </span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m0_mu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.488841262329077"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a>m0_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m0_sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.598940179635303"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>m0_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>nu.coefficients) </span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m0_nu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  1.00004921609826"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a>m0_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>tau.coefficients) </span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m0_tau)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.210531502115098"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a>m0_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,m0_p0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>m0_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,m0_p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL</span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition, </span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 210 
GAMLSS-RS iteration 2: Global Deviance = 209 
GAMLSS-RS iteration 3: Global Deviance = 209 
GAMLSS-RS iteration 4: Global Deviance = 209 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)        -0.238      0.305   -0.78     0.44
conditionimpasse    0.256      0.350    0.73     0.47

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)       0.39279    0.25190    1.56     0.12
conditionimpasse  0.00065    0.28961    0.00     1.00

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         1.072      0.309    3.47  0.00074 ***
conditionimpasse   -2.061      0.426   -4.84    4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.695      0.463    -1.5     0.14  
conditionimpasse   -1.457      0.661    -2.2     0.03 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  126 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  118 
                      at cycle:  4 
 
Global Deviance:     209 
            AIC:     225 
            SBC:     248 
******************************************************************</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="co">#LOOKING PREDICTOR MODEL</span></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition , </span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 210 
GAMLSS-RS iteration 2: Global Deviance = 209 
GAMLSS-RS iteration 3: Global Deviance = 209 
GAMLSS-RS iteration 4: Global Deviance = 209 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)        -0.238      0.305   -0.78     0.44
conditionimpasse    0.256      0.350    0.73     0.47

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)       0.39279    0.25190    1.56     0.12
conditionimpasse  0.00065    0.28961    0.00     1.00

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         1.072      0.309    3.47  0.00074 ***
conditionimpasse   -2.061      0.426   -4.84    4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.695      0.463    -1.5     0.14  
conditionimpasse   -1.457      0.661    -2.2     0.03 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  126 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  118 
                      at cycle:  4 
 
Global Deviance:     209 
            AIC:     225 
            SBC:     248 
******************************************************************</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION </span><span class="al">TEST</span><span class="co">]</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mperm &lt;- gamlss(R_acc ~ perm, ~ perm, ~ perm, ~ perm, </span></span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, family = BEINF())</span></span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mperm)</span></span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check with scaled outcome, no zeros ones</span></span>
<span id="cb456-7"><a href="#cb456-7" aria-hidden="true" tabindex="-1"></a><span class="co"># m3 &lt;- gamlss(T_acc ~ condition, ~ condition, ~ condition, ~ condition, </span></span>
<span id="cb456-8"><a href="#cb456-8" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, family = BEINF())</span></span>
<span id="cb456-9"><a href="#cb456-9" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m3)</span></span>
<span id="cb456-10"><a href="#cb456-10" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span></span>
<span id="cb456-11"><a href="#cb456-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-12"><a href="#cb456-12" aria-hidden="true" tabindex="-1"></a><span class="co">#investigate beta negative binomial distribution</span></span>
<span id="cb456-13"><a href="#cb456-13" aria-hidden="true" tabindex="-1"></a><span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span></span>
<span id="cb456-14"><a href="#cb456-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-15"><a href="#cb456-15" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb456-16"><a href="#cb456-16" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb456-17"><a href="#cb456-17" aria-hidden="true" tabindex="-1"></a>m1_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m1<span class="sc">$</span>mu.coefficients) </span>
<span id="cb456-18"><a href="#cb456-18" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m1_mu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.440831188224042" "MU:  0.563675250336726"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>m1_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m1_sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.598940179635303"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>m1_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>nu.coefficients) </span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m1_nu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  2.9225629022821"   "NU:  0.127317843875831"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>m1_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>tau.coefficients) </span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m1_tau)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.499239420186449" "TAU:  0.232912671590872"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)        -0.238      0.305   -0.78     0.44
conditionimpasse    0.256      0.350    0.73     0.47

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)       0.39279    0.25190    1.56     0.12
conditionimpasse  0.00065    0.28961    0.00     1.00

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         1.072      0.309    3.47  0.00074 ***
conditionimpasse   -2.061      0.426   -4.84    4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.695      0.463    -1.5     0.14  
conditionimpasse   -1.457      0.661    -2.2     0.03 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  126 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  118 
                      at cycle:  4 
 
Global Deviance:     209 
            AIC:     225 
            SBC:     248 
******************************************************************</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-53-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  -0.0404 
                       variance   =  1.16 
               coef. of skewness  =  -0.015 
               coef. of kurtosis  =  2.79 
Filliben correlation coefficient  =  0.998 
******************************************************************</code></pre>
</div>
</div>
<ul>
<li>MU tells if mean is different by condition</li>
<li>SIGMA tells if variance is different by condition</li>
<li>NU coefficient tells if condition yields different probability at floor</li>
<li>TAU coefficient tells if condition yields different probability at ceiling</li>
</ul>
</section>
</section>
<section id="binomial-outcome" class="level2">
<h2 class="anchored" data-anchor-id="binomial-outcome">BINOMIAL OUTCOME</h2>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% mutate(</span></span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = recode_factor(score_niceABS, "0" ="incorrect","1"="correct"),</span></span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   scaled = as.ordered(score_SCALED),</span></span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   q = as.factor(q),</span></span>
<span id="cb468-7"><a href="#cb468-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   high_interpretation = as.factor(high_interpretation)</span></span>
<span id="cb468-8"><a href="#cb468-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb468-9"><a href="#cb468-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-10"><a href="#cb468-10" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb468-11"><a href="#cb468-11" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb468-12"><a href="#cb468-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df) <span class="sc">%&gt;%</span></span>
<span id="cb468-13"><a href="#cb468-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb468-14"><a href="#cb468-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Question 1 Accuracy"</span>,</span>
<span id="cb468-15"><a href="#cb468-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Q1"</span>,</span>
<span id="cb468-16"><a href="#cb468-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-Q1-ACCURACY-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb469-3"><a href="#cb469-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb469-4"><a href="#cb469-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb469-5"><a href="#cb469-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb469-6"><a href="#cb469-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb469-7"><a href="#cb469-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb469-8"><a href="#cb469-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb469-9"><a href="#cb469-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb469-10"><a href="#cb469-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb469-11"><a href="#cb469-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb469-12"><a href="#cb469-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-Q1-ACCURACY-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="chi-square" class="level4">
<h4 class="anchored" data-anchor-id="chi-square">CHI SQUARE</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::CROSSTABLE</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="co"># CrossTable( x = df$condition, y = df$accuracy, </span></span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a><span class="co">#              fisher = TRUE, chisq=TRUE, expected = TRUE, sresid = TRUE)</span></span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::MOSAIC PLOT</span></span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true" tabindex="-1"></a><span class="co"># note: blue indicates cell count higher than expected, </span></span>
<span id="cb470-7"><a href="#cb470-7" aria-hidden="true" tabindex="-1"></a><span class="co"># red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb470-8"><a href="#cb470-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mosaicplot(main="Accuracy on First Question by Condition",</span></span>
<span id="cb470-9"><a href="#cb470-9" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, pretty_condition ~ accuracy, </span></span>
<span id="cb470-10"><a href="#cb470-10" aria-hidden="true" tabindex="-1"></a><span class="co">#             shade = T)</span></span>
<span id="cb470-11"><a href="#cb470-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-12"><a href="#cb470-12" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::TABLE</span></span>
<span id="cb470-13"><a href="#cb470-13" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">sjtab</span>( <span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb470-14"><a href="#cb470-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>F, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb470-15"><a href="#cb470-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="fu">c</span>(<span class="st">"auto"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
 <tbody><tr>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
 
<tr>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
 
<tr> 
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">0</td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">52</span><br><span style="color:#339999;">48</span><br><span style="color:#339933;">83.9&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">45</span><br><span style="color:#339999;">49</span><br><span style="color:#339933;">70.3&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;  "><span style="color:black;">97</span><br><span style="color:#339999;">97</span><br><span style="color:#339933;">77&nbsp;%</span></td> 
</tr>
 
<tr> 
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">1</td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">10</span><br><span style="color:#339999;">14</span><br><span style="color:#339933;">16.1&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">19</span><br><span style="color:#339999;">15</span><br><span style="color:#339933;">29.7&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;  "><span style="color:black;">29</span><br><span style="color:#339999;">29</span><br><span style="color:#339933;">23&nbsp;%</span></td> 
</tr>
 
<tr> 
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;"><span style="color:black;">62</span><br><span style="color:#339999;">62</span><br><span style="color:#339933;">100&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;"><span style="color:black;">64</span><br><span style="color:#339999;">64</span><br><span style="color:#339933;">100&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;"><span style="color:black;">126</span><br><span style="color:#339999;">126</span><br><span style="color:#339933;">100&nbsp;%</span></td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=2.547 · df=1 · φ=0.161 · p=0.111</td> 
</tr>
 
</tbody></table> <p>
 <span style="color:black;">observed values</span><br>
 <span style="color:#339999;">expected values</span><br>
 <span style="color:#339933;">% within pretty_condition</span><br>
 </p>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::BAR PLOT</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> condition,</span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20CHISQR-Q1-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::CHISQR </span><span class="al">TEST</span></span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a>(x <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">chisq.test</span>(<span class="at">x =</span> df<span class="sc">$</span>accuracy, <span class="at">y =</span> df<span class="sc">$</span>condition, <span class="at">simulate.p.value =</span> T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with simulated p-value (based on 2000
    replicates)

data:  df$accuracy and df$condition
X-squared = 3, df = NA, p-value = 0.09</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb474"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::POWER ANALYSIS</span></span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a>(po <span class="ot">&lt;-</span> <span class="fu">pwr.chisq.test</span>( <span class="at">w =</span> <span class="fl">0.1</span>, <span class="at">df=</span>(<span class="dv">2-1</span>), <span class="at">N =</span> <span class="fu">nrow</span>(df), <span class="at">sig.level =</span> <span class="fl">0.05</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Chi squared power calculation 

              w = 0.1
              N = 126
             df = 1
      sig.level = 0.05
          power = 0.202

NOTE: N is the number of observations</code></pre>
</div>
</div>
<p><strong>A Chi-Square test of independence of Q1 accuracy [correct,incorrect] by condition indicates the question accuracy is not dependent on condition. <em>However, this test may be underpowered, as with the given sample size it has only 20% power to detect a small effect (w = 0.1)</em></strong></p>
</section>
<section id="logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression">LOGISTIC REGRESSION</h3>
<ul>
<li>http://post8000.svmiller.com/lab-scripts/logistic-regression-lab.html</li>
</ul>
<p><em>Fit a logistic regression (at the subject-item level), predicting Q1 accuracy (absolute score) by condition.</em><br>
<em>note: this example uses the combined dataset rather than lab-only, as learning notes were done with the combined and I don’t want to recalcualte all the marginal probabilities by hand for learning purposes.</em></p>
<ul>
<li>Fit a logistic regression predicting accuracy (absolute score) (n = r nrow(df)) by condition. (k = 2).</li>
<li>Parameter estimate: <span class="math inline">\(\beta_{0}\)</span> = Log Odds of (correct) responses in CONTROL condition
<ul>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> = ODDS of correct response in CONTROL condition</li>
</ul></li>
<li>Parameter estimate: <span class="math inline">\(\beta_{1}\)</span> = <span class="math inline">\(\beta_{1impasse}\)</span> Log Odds (Log OR; change in odds for correct response in impasse (vs) control [log scale])
<ul>
<li><span class="math inline">\(e^{\beta_{1}}\)</span> = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</li>
</ul></li>
<li>Null hypothesis:<span class="math inline">\(\beta_{impasse} \le 0\)</span> the odds for a correct response does not change, or decreases</li>
<li>Alternative hypothesis: <span class="math inline">\(\beta_{impasse} \gt 0\)</span> the odds of a correct response increases</li>
</ul>
<section id="fit-model" class="level4">
<h4 class="anchored" data-anchor-id="fit-model">Fit Model</h4>
<p><em>First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co">#combined dataset, not lab only</span></span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS)</span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a><span class="co"># FREQUENCY TABLE</span></span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a><span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span></span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(my.table) #counts</span></span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(prop.table(my.table)) #props</span></span>
<span id="cb476-10"><a href="#cb476-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-11"><a href="#cb476-11" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb476-12"><a href="#cb476-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-13"><a href="#cb476-13" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb476-14"><a href="#cb476-14" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb476-15"><a href="#cb476-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"EMPTY MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "EMPTY MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ 1, family = "binomial", data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.723  -0.723  -0.723  -0.723   1.714  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -1.207      0.212   -5.71  1.2e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 135.95  on 125  degrees of freedom
Residual deviance: 135.95  on 125  degrees of freedom
AIC: 137.9

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.839  -0.839  -0.593  -0.593   1.910  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.649      0.345   -4.77  1.8e-06 ***
pretty_conditionimpasse    0.786      0.441    1.79    0.074 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 135.95  on 125  degrees of freedom
Residual deviance: 132.63  on 124  degrees of freedom
AIC: 136.6

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb486"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name | Model | df | df_diff | Chi2 |     p
------------------------------------------
m0   |   glm |  1 |         |      |      
m1   |   glm |  2 |       1 | 3.31 | 0.069</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0687084837283363"</code></pre>
</div>
</div>
<p><em>The Condition predictor significantly improves model fit.</em></p>
</section>
<section id="learning-notes" class="level4">
<h4 class="anchored" data-anchor-id="learning-notes">Learning Notes</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.839  -0.839  -0.593  -0.593   1.910  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.649      0.345   -4.77  1.8e-06 ***
pretty_conditionimpasse    0.786      0.441    1.79    0.074 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 135.95  on 125  degrees of freedom
Residual deviance: 132.63  on 124  degrees of freedom
AIC: 136.6

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb494"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                          2.5 % 97.5 %
(Intercept)             -2.3853  -1.02
pretty_conditionimpasse -0.0595   1.68</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb501"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(<span class="fu">confint</span>(m1)))) <span class="co">#exponentiate)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               2.5 % 97.5 %
(Intercept)             0.192 0.0921  0.362
pretty_conditionimpasse 2.196 0.9422  5.376</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- PROBABILITIES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- PROBABILITIES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"[these should math pred plots]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "[these should math pred plots]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at reference level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability at reference level"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.161</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at coefficient level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability at coefficient level"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]] <span class="sc">+</span> m1<span class="sc">$</span>coefficients[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.297</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"CHANGE in probability by coefficient"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CHANGE in probability by coefficient"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb518"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]] <span class="sc">+</span> m1<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]) <span class="sc">-</span> <span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.136</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PREDICTIONS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a>pred.control <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"control"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient)</span></span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in control,"</span>, pred.control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in control, 0.161290322580645"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a>pred.impasse <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"impasse"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient + predictor coeff)</span></span>
<span id="cb524-3"><a href="#cb524-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in impasse,"</span>, pred.impasse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in impasse, 0.296875000000275"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half</span></span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-7"><a href="#cb526-7" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb526-8"><a href="#cb526-8" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb526-9"><a href="#cb526-9" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"p value for two-tailed test, null B = 0 : "</span>,<span class="fu">round</span>(tt,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p value for two-tailed test, null B = 0 :  0.074"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a>ot <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"BUT we want a one tailed directional, null: B &lt;= 0: "</span>,<span class="fu">round</span>(ot,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BUT we want a one tailed directional, null: B &lt;= 0:  0.037"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"adjusted confint for directional hypothesis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "adjusted confint for directional hypothesis"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a>(dcint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1, <span class="at">level =</span> <span class="fl">0.90</span>)) <span class="co"># get 90% for right side))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                            5 %  95 %
(Intercept)             -2.2578 -1.11
pretty_conditionimpasse  0.0749  1.53</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb535"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-4"><a href="#cb535-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS [directional]</span></span>
<span id="cb535-5"><a href="#cb535-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-6"><a href="#cb535-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval —- LOG ODDS")</span></span>
<span id="cb535-7"><a href="#cb535-7" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb535-8"><a href="#cb535-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Coefficients —- ODDS RATIOS")</span></span>
<span id="cb535-9"><a href="#cb535-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(confint(m1)))) #exponentiated, not adjusted</span></span>
<span id="cb535-10"><a href="#cb535-10" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(dcint))) #exponentiated, adjusted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Understanding the logistic regression model</strong></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb536-4"><a href="#cb536-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb536-5"><a href="#cb536-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     
      control impasse   Sum
  0     0.839   0.703 0.770
  1     0.161   0.297 0.230
  Sum   1.000   1.000 1.000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     
      control impasse Sum
  0        52      45  97
  1        10      19  29
  Sum      62      64 126</code></pre>
</div>
</div>
<p><em>The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable</em></p>
<p><em>The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.</em></p>
<p><strong>[the empty model</strong></p>
<ul>
<li>The intercept of an empty model (glm(accuracy ~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df$accuracy ==1 ).</li>
<li>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -&gt; log(0.215 / (1-0.215)) = -1.29.</li>
<li>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</li>
<li>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</li>
</ul>
<p><strong>[a dichotomous predictor]</strong></p>
<p>natural log (odds of +) = -1.822 + 0.901(x1) ; x1 = 0 for control, 1 for impasse - b0 intercept is ODDS OF CORRECT RESPONSE IN REFERENCE (control) - b1 intercept is ODDS RATIO (difference in odds) FOR CORRECT RESPONSE IN IMPASSE</p>
<ul>
<li>INTERCEPT: log odds of (+ response) in control condition
<ul>
<li>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</li>
<li>convert to odds by exponentiating the coefficients<br>
log odds of (+) in control = exp(-1.822) = 0.162 odds</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139<br>
probability of (+) in control = ~14%</li>
</ul></li>
<li>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs.&nbsp;control
<ul>
<li>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</li>
<li>convert to odds by exponentiating log odds<br>
log odds (+) in impasse = exp(-0.921) = 0.398</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285<br>
probaility of (+) in impasse = ~ 29%</li>
</ul></li>
<li>ODDS RATIO : exponentiated B1 COEFFICIENT
<ul>
<li>B1 = (slope of logit model = difference in log odds = log odds ratio</li>
<li>B1 = 0.901 is log odds ratio of (+) in impasse vs control</li>
<li>exp(b1) = exp(0.901) = 2.46</li>
<li>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</li>
</ul></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">MARGINAL<br>
total = 330 success : 71, failure : 259<br>
p(+) = 71 / 330 = 0.215 = 22%<br>
odds(+) = 71 / 259 = 0.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">CONTROL total = 158 success = 22; failure = 136<br>
p(+) = 22/158 = 0.139 = 14%<br>
odds(+) = 22/136 = 0.162</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMPASSE total = 172 success = 49; failure = 123<br>
p(+) = 49/172 = 0.285 = 29%<br>
odds(+) = 49/123 = 0.398</td>
</tr>
</tbody>
</table>
</section>
<section id="visualize" class="level4">
<h4 class="anchored" data-anchor-id="visualize">Visualize</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb540-4"><a href="#cb540-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoefstats</span>(m1, <span class="at">output =</span> <span class="st">"plot"</span>, </span>
<span id="cb540-5"><a href="#cb540-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">+</span> </span>
<span id="cb540-6"><a href="#cb540-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Log Odds Estimate"</span>, </span>
<span id="cb540-7"><a href="#cb540-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"p is for two tailed test"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb541"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb541-5"><a href="#cb541-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb541-6"><a href="#cb541-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb541-7"><a href="#cb541-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb541-8"><a href="#cb541-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb541-9"><a href="#cb541-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb541-10"><a href="#cb541-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">type=</span><span class="st">"eff"</span>,</span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb542-5"><a href="#cb542-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb542-6"><a href="#cb542-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-59-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m1)</span></span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-4"><a href="#cb544-4" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELSUMMARY | MODEL | PROBABILITIES</span></span>
<span id="cb544-5"><a href="#cb544-5" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m1, exponentiate = TRUE)</span></span>
<span id="cb544-6"><a href="#cb544-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-7"><a href="#cb544-7" aria-hidden="true" tabindex="-1"></a><span class="co">#MARGINALEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb544-8"><a href="#cb544-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'marginaleffects'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelr':

    typical</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb547"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot adjusted predictions, conditional on the CONDITION variable using the plot_cap</span></span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true" tabindex="-1"></a><span class="co">#interactions plot_cap(mod, condition = c("length", "style"))</span></span>
<span id="cb547-3"><a href="#cb547-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cap</span>(m1, <span class="at">condition =</span> <span class="st">"pretty_condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-59-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The plot_cme function can be used to draw “Conditional Marginal Effects.” </span></span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a><span class="co">#use for ixns </span></span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_cme(m1, effect = "var1", condition = "pretty_condition")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="diagnostics">Diagnostics</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb549"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb551"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model's explanatory power is weak (Tjur's R2 = 0.03). The model's intercept, corresponding to pretty_condition = control, is at -1.65 (95% CI [-2.39, -1.02], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically non-significant and positive (beta = 0.79, 95% CI [-0.06, 1.68], p = 0.074; Std. beta = 0.79, 95% CI [-0.06, 1.68])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb554"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb556"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log | Score_spherical |   PCP
----------------------------------------------------------------------------------------------
136.632 | 142.305 |     0.026 | 0.415 | 1.034 |    0.526 |    -7.184 |           0.046 | 0.655</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb558"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL DIAGNOSTICS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb560"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb561"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ok: About 100% of the residuals are inside the error bounds.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb563"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="co"># logitgof(df$accuracy, m1$fitted.values, ord=FALSE)</span></span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hoslem.test(x = df$accuracy, y = fitted(m1), g =  2)</span></span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a><span class="co"># p should be non significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="inference" class="level4">
<h4 class="anchored" data-anchor-id="inference">Inference</h4>
<p>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the <em>impasse condition</em> increase by 146% (<span class="math inline">\(e^{beta_1}\)</span> = 2.46, 95% CI [1.42, 4.37]) over the <em>control condition</em>.</p>
<p><em>Equivalent statements:</em></p>
<ul>
<li>being in impasse condition increases log odds of correct response by 0.901 (over control)</li>
<li>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</li>
<li>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PRETTY TABLE SJPLOT</span></span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.09&nbsp;–&nbsp;0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94&nbsp;–&nbsp;5.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.074</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">126</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.026</td>
</tr>

</tbody></table>

</div>
</div>
</section>
</section>
</section>
<section id="ordinal-outcome" class="level2">
<h2 class="anchored" data-anchor-id="ordinal-outcome">ORDINAL OUTCOME</h2>
<p><strong>Does CONDITION affect the Q1 [ordered] type of response given?</strong></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb565"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb565-4"><a href="#cb565-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-5"><a href="#cb565-5" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb565-6"><a href="#cb565-6" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>scaled, df<span class="sc">$</span>condition))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth       0.3968  0.1587
  unknown    0.0000  0.0000
  uncertain  0.0000  0.1429
  lines      0.0159  0.0556
  tri        0.0794  0.1508</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb567"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>scaled, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb568"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb568-4"><a href="#cb568-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb568-5"><a href="#cb568-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> scaled)) <span class="sc">+</span></span>
<span id="cb568-6"><a href="#cb568-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb568-7"><a href="#cb568-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb568-8"><a href="#cb568-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb568-9"><a href="#cb568-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb568-10"><a href="#cb568-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb568-11"><a href="#cb568-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb568-12"><a href="#cb568-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb568-13"><a href="#cb568-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Does CONDITION affect the Q1 [ordered] state of understanding?</strong></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb569"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb569-3"><a href="#cb569-3" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb569-4"><a href="#cb569-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-5"><a href="#cb569-5" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb569-6"><a href="#cb569-6" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth-like  0.3968  0.1587
  unknown    0.0000  0.1429
  tri-like   0.0952  0.2063</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb571"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>state, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb571-3"><a href="#cb571-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb572-4"><a href="#cb572-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb572-5"><a href="#cb572-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb572-6"><a href="#cb572-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb572-7"><a href="#cb572-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb572-8"><a href="#cb572-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb572-9"><a href="#cb572-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb572-10"><a href="#cb572-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 State"</span>,</span>
<span id="cb572-11"><a href="#cb572-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb572-12"><a href="#cb572-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb572-13"><a href="#cb572-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-STATE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="ordinal-regression-cumulative-link-proportional-odds" class="level3">
<h3 class="anchored" data-anchor-id="ordinal-regression-cumulative-link-proportional-odds">ORDINAL REGRESSION — Cumulative Link; Proportional Odds</h3>
<p><em>Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.</em></p>
<ul>
<li><a href="https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/" class="uri">https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</a></li>
<li><a href="https://journals.sagepub.com/doi/full/10.1177/2515245918823199" class="uri">https://journals.sagepub.com/doi/full/10.1177/2515245918823199</a></li>
<li>todo see ordinal regression video: <a href="https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK" class="uri">https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK</a></li>
<li><a href="https://peopleanalytics-regression-book.org/ord-reg.html" class="uri">https://peopleanalytics-regression-book.org/ord-reg.html</a></li>
<li><a href="https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2" class="uri">https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2</a></li>
<li><a href="https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf" class="uri">https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf</a></li>
</ul>
<p><strong>Learning Notes</strong></p>
<ul>
<li>proportional odds regression models effectively act as a series of stratified binomial models under the assumption that the ‘slope’ of the logistic function of each stratified model is the same.</li>
<li>thus need to verify proportional odds assumption - ordinal regression requires an <strong>proportional odds assumption</strong> (the same slope holds for each equation)</li>
<li>this is required because the model simultaneously estimates k-1 equations, but each equation has the same <em>slope</em>, with different intercepts.</li>
<li>conversely, a multinomial (categorical) model will have different slopes as well as intercepts - the intercepts are always ordered in size alpha 1 &lt; alpha 2 &lt; alpha k-1…</li>
<li><strong>TODO</strong> - see difference between the three types of ordinal models (adjacent category (vs) cumulative proportions; check Agresti book</li>
</ul>
<section id="fit-model-1" class="level4">
<h4 class="anchored" data-anchor-id="fit-model-1">Fit Model</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb573"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::ORDINAL REGRESSION MODELS</span></span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true" tabindex="-1"></a><span class="co">#EMPTY MODEL</span></span>
<span id="cb573-4"><a href="#cb573-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb575"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a>om<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">clm</span>(state <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> df)</span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(om.0)</span></span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-4"><a href="#cb575-4" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICTOR MODEL</span></span>
<span id="cb575-5"><a href="#cb575-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Ordinal regression of q1 SCALED score (ordered interpretation)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordinal regression of q1 SCALED score (ordered interpretation)"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb577"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a>om <span class="ot">&lt;-</span> <span class="fu">clm</span>(state <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(om)</span></span>
<span id="cb577-3"><a href="#cb577-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-4"><a href="#cb577-4" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE EMPTY AND PREDICTOR</span></span>
<span id="cb577-5"><a href="#cb577-5" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(om<span class="fl">.0</span>, om)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name | Model | df | df_diff |  Chi2 |      p
--------------------------------------------
om.0 |   clm |  2 |         |       |       
om   |   clm |  3 |       1 | 24.58 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb579"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: EQUIVALENT APPROACH USING POLYR </span></span>
<span id="cb579-2"><a href="#cb579-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb579-3"><a href="#cb579-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL</span></span>
<span id="cb579-4"><a href="#cb579-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(state <span class="sc">~</span> condition , <span class="at">data =</span> df, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb579-5"><a href="#cb579-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m)</span></span>
<span id="cb579-6"><a href="#cb579-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb579-7"><a href="#cb579-7" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate coefficients and CIs</span></span>
<span id="cb579-8"><a href="#cb579-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (ctable &lt;- coef(summary(m)))</span></span>
<span id="cb579-9"><a href="#cb579-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (p &lt;- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2)</span></span>
<span id="cb579-10"><a href="#cb579-10" aria-hidden="true" tabindex="-1"></a><span class="co"># (ctable &lt;- cbind(ctable, "p value" = p))</span></span>
<span id="cb579-11"><a href="#cb579-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (ci &lt;- confint(m))</span></span>
<span id="cb579-12"><a href="#cb579-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- coef(m))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Likelihood ratio test suggests the predictor model is a better fit than the empty (intercept only) model.</em></p>
</section>
<section id="inference-1" class="level4">
<h4 class="anchored" data-anchor-id="inference-1">Inference</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb580"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SUMMARY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SUMMARY"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb582"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(om)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>formula: state ~ condition
data:    df

 link  threshold nobs logLik  AIC    niter max.grad cond.H 
 logit flexible  126  -109.43 224.86 6(0)  6.16e-07 2.7e+01

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
conditionimpasse     1.85       0.40    4.64  3.5e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Threshold coefficients:
                  Estimate Std. Error z value
orth-like|unknown    1.310      0.324    4.05
unknown|tri-like     2.042      0.353    5.79</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb584"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="co">#LOG ODDS</span></span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"IN LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IN LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb586"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true" tabindex="-1"></a>(ctable <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(om)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Estimate Std. Error z value Pr(&gt;|z|)
orth-like|unknown     1.31      0.324    4.05 5.16e-05
unknown|tri-like      2.04      0.353    5.79 6.95e-09
conditionimpasse      1.86      0.400    4.64 3.46e-06</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb588"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(om)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
conditionimpasse   1.1   2.67</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb590"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"IN ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IN ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb592"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ODDS RATIOS</span></span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(om))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>orth-like|unknown  unknown|tri-like  conditionimpasse 
             3.71              7.71              6.39 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb594"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(ci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
conditionimpasse  2.99   14.5</code></pre>
</div>
</div>
<p><strong>Overall, participants in the impasse condition had higher odds (6.68 X as likely) to offer <em>more correct</em> interpretations than those in the control condition (z = 4.74, p &lt; 0.001).</strong></p>
<ul>
<li>we see the estimates for the 2 intercepts, which are sometimes called cutpoints.</li>
<li>The intercepts indicate where the latent variable is cut to make the three groups that we observe in our data.</li>
<li>Note that this latent variable is continuous. In general, these are not used in the interpretation of the results.</li>
<li>The cutpoints are closely related to thresholds, which are reported by other statistical packages.</li>
<li>for k groups there will be k-1 intercepts (cutpoints)</li>
<li>confirm that the CI does not include 0 (the units are ordered logits [ordered log odds])</li>
<li>as with logistic regression we exponentiate the coefficients and confints to get odds ratio</li>
</ul>
</section>
<section id="visualize-model" class="level4">
<h4 class="anchored" data-anchor-id="visualize-model">Visualize Model</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb596"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sjPlot::tab_model(om)</span></span>
<span id="cb596-2"><a href="#cb596-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(om)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb597"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(om, <span class="at">type =</span> <span class="st">"eff"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-66-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb599"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># show.data = TRUE, jitter = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-1" class="level4">
<h4 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb600"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:: ASSESS FIT</span></span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(om)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Nagelkerke's R2 |  RMSE | Sigma
---------------------------------------------------
224.864 | 233.373 |           0.207 | 1.639 | 1.659</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb603"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #test proporitional odds assumption </span></span>
<span id="cb603-2"><a href="#cb603-2" aria-hidden="true" tabindex="-1"></a><span class="fu">brant</span>(m) <span class="co">#only works for polyr type model not clm type model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Test for        X2  df  probability 
---------------------------------------------------- 
Omnibus         22.38   1   0
conditionimpasse    22.38   1   0
---------------------------------------------------- 

H0: Parallel Regression Assumption holds</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in brant(m): 1 combinations in table(dv,ivs) do not occur. Because of
that, the test results might be invalid.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb606"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # A p-value of less than 0.05 on this test—particularly on the Omnibus plus at least one of the variables—should be interpreted as a failure of the proportional odds assumption.</span></span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-3"><a href="#cb606-3" aria-hidden="true" tabindex="-1"></a><span class="co">#test proportional odds assumption</span></span>
<span id="cb606-4"><a href="#cb606-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pomcheckr)</span>
<span id="cb606-5"><a href="#cb606-5" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/pomcheckr/pomcheckr.pdf</span></span>
<span id="cb606-6"><a href="#cb606-6" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pomcheck</span>( scaled <span class="sc">~</span> condition , <span class="at">data =</span> df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 2 × 5
# Groups:   condition [2]
  condition `scaled_&gt;=1` `scaled_&gt;=4` `scaled_&gt;=5` `scaled_&gt;=3`
  &lt;fct&gt;            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1 control            Inf       -1.43        -1.65        NA    
2 impasse            Inf       -0.379       -0.862        0.788

attr(,"class")
[1] "pomcheck" "list"    </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb608"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>The output of the graphical test for proportional odds assumption suggests that the proportional odds assumption may be unreasonable for this dataset. Also, inspecting the output table, we see the coefficients for each level of the scaled variable are quite different.</strong></p>
<p>Thus, an alternative approach may be more appropriate:</p>
<ul>
<li><p>Baseline logistic model. This model is the same as the multinomial regression model covered in the previous chapter, using the lowest ordinal value as the reference.</p></li>
<li><p>Adjacent-category logistic model. This model compares each level of the ordinal variable to the next highest level, and it is a constrained version of the baseline logistic model. The brglm2 package in R offers a function bracl() for calculating an adjacent category logistic model.</p></li>
<li><p>Continuation-ratio logistic model. This model compares each level of the ordinal variable to all lower levels. This can be modeled using binary logistic regression techniques, but new variables need to be constructed from the data set to allow this. The R package rms has a function cr.setup() which is a utility for preparing an outcome variable for a continuation ratio model.</p></li>
</ul>
<p>*Note: for multiple regression, the ordinal package offers a parameter (nominal = ~predictors) that allow you to designate some predictors as nominal rather than ordinal. But this is not appropriate for this use case._</p>
</section>
</section>
</section>
<section id="categorical-outcome" class="level2">
<h2 class="anchored" data-anchor-id="categorical-outcome">CATEGORICAL OUTCOME</h2>
<p><strong>Does CONDITION affect the Q1 [ordered] type of response given?</strong></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb610"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb610-2"><a href="#cb610-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb610-3"><a href="#cb610-3" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb610-4"><a href="#cb610-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-5"><a href="#cb610-5" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb610-6"><a href="#cb610-6" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>scaled, df<span class="sc">$</span>condition))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth       0.3968  0.1587
  unknown    0.0000  0.0000
  uncertain  0.0000  0.1429
  lines      0.0159  0.0556
  tri        0.0794  0.1508</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb612"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>scaled, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb612-3"><a href="#cb612-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb613"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb613-3"><a href="#cb613-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb613-4"><a href="#cb613-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb613-5"><a href="#cb613-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> scaled)) <span class="sc">+</span></span>
<span id="cb613-6"><a href="#cb613-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb613-7"><a href="#cb613-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb613-8"><a href="#cb613-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb613-9"><a href="#cb613-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb613-10"><a href="#cb613-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb613-11"><a href="#cb613-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb613-12"><a href="#cb613-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb613-13"><a href="#cb613-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-68-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Does CONDITION affect the Q1 [ordered] state of understanding?</strong></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb614"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb614-2"><a href="#cb614-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb614-3"><a href="#cb614-3" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb614-4"><a href="#cb614-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-5"><a href="#cb614-5" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb614-6"><a href="#cb614-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb614-7"><a href="#cb614-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb614-8"><a href="#cb614-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse   Sum
  orth-like   0.806   0.312 0.556
  unknown     0.000   0.281 0.143
  tri-like    0.194   0.406 0.302
  Sum         1.000   1.000 1.000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb616"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>state, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb616-3"><a href="#cb616-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb617"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb617-5"><a href="#cb617-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb617-6"><a href="#cb617-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb617-7"><a href="#cb617-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb617-8"><a href="#cb617-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb617-9"><a href="#cb617-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb617-10"><a href="#cb617-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 State"</span>,</span>
<span id="cb617-11"><a href="#cb617-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb617-12"><a href="#cb617-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb617-13"><a href="#cb617-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-69-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb618"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATSPLOT</span></span>
<span id="cb618-2"><a href="#cb618-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(df, state, condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-69-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="chi-square-1" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-1">CHI SQUARE</h3>
<p><strong>Does CONDITION affect the Q1 [categorical] type of response given?</strong></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb619"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>scaled, </span>
<span id="cb619-2"><a href="#cb619-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(t, correct = FALSE, ...): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  126 

 
             | df$scaled 
df$condition |      orth | uncertain |     lines |       tri | Row Total | 
-------------|-----------|-----------|-----------|-----------|-----------|
     control |        50 |         0 |         2 |        10 |        62 | 
             |    34.444 |     8.857 |     4.429 |    14.270 |           | 
             |     7.025 |     8.857 |     1.332 |     1.278 |           | 
             |     0.806 |     0.000 |     0.032 |     0.161 |     0.492 | 
             |     0.714 |     0.000 |     0.222 |     0.345 |           | 
             |     0.397 |     0.000 |     0.016 |     0.079 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|
     impasse |        20 |        18 |         7 |        19 |        64 | 
             |    35.556 |     9.143 |     4.571 |    14.730 |           | 
             |     6.806 |     8.580 |     1.290 |     1.238 |           | 
             |     0.312 |     0.281 |     0.109 |     0.297 |     0.508 | 
             |     0.286 |     1.000 |     0.778 |     0.655 |           | 
             |     0.159 |     0.143 |     0.056 |     0.151 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|
Column Total |        70 |        18 |         9 |        29 |       126 | 
             |     0.556 |     0.143 |     0.071 |     0.230 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  36.4     d.f. =  3     p =  6.15e-08 


 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Alternative hypothesis: two.sided
p =  2.88e-09 

 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb622"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb622-2"><a href="#cb622-2" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb622-3"><a href="#cb622-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Interpretation on First Question by Condition"</span>,</span>
<span id="cb622-4"><a href="#cb622-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, condition <span class="sc">~</span> scaled, </span>
<span id="cb622-5"><a href="#cb622-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb623"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::WITH STATISTICS</span></span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> condition, <span class="at">y =</span> scaled,</span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"nonparametric"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-71-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb624"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb624-2"><a href="#cb624-2" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb624-3"><a href="#cb624-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Response Type on First Question by Condition"</span>,</span>
<span id="cb624-4"><a href="#cb624-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, condition <span class="sc">~</span> scaled, </span>
<span id="cb624-5"><a href="#cb624-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20CHISQR-interpreation-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb625"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>scaled, </span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(t, correct = FALSE, ...): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  126 

 
             | df$scaled 
df$condition |      orth | uncertain |     lines |       tri | Row Total | 
-------------|-----------|-----------|-----------|-----------|-----------|
     control |        50 |         0 |         2 |        10 |        62 | 
             |    34.444 |     8.857 |     4.429 |    14.270 |           | 
             |     7.025 |     8.857 |     1.332 |     1.278 |           | 
             |     0.806 |     0.000 |     0.032 |     0.161 |     0.492 | 
             |     0.714 |     0.000 |     0.222 |     0.345 |           | 
             |     0.397 |     0.000 |     0.016 |     0.079 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|
     impasse |        20 |        18 |         7 |        19 |        64 | 
             |    35.556 |     9.143 |     4.571 |    14.730 |           | 
             |     6.806 |     8.580 |     1.290 |     1.238 |           | 
             |     0.312 |     0.281 |     0.109 |     0.297 |     0.508 | 
             |     0.286 |     1.000 |     0.778 |     0.655 |           | 
             |     0.159 |     0.143 |     0.056 |     0.151 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|
Column Total |        70 |        18 |         9 |        29 |       126 | 
             |     0.556 |     0.143 |     0.071 |     0.230 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  36.4     d.f. =  3     p =  6.15e-08 


 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Alternative hypothesis: two.sided
p =  2.88e-09 

 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb628"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb628-2"><a href="#cb628-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"scaled"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb628-3"><a href="#cb628-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb628-4"><a href="#cb628-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
 <tbody><tr>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">scaled</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
 
<tr>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
 
<tr> 
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">orth</td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">50</span><br><span style="color:#339999;">34</span><br><span style="color:#333399;">71.4&nbsp;%</span><br><span style="color:#339933;">80.6&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">20</span><br><span style="color:#339999;">36</span><br><span style="color:#333399;">28.6&nbsp;%</span><br><span style="color:#339933;">31.2&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;  "><span style="color:black;">70</span><br><span style="color:#339999;">70</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">55.6&nbsp;%</span></td> 
</tr>
 
<tr> 
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">unknown</td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">0</span><br><span style="color:#339999;">0</span><br><span style="color:#333399;">0&nbsp;%</span><br><span style="color:#339933;">0&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">0</span><br><span style="color:#339999;">0</span><br><span style="color:#333399;">0&nbsp;%</span><br><span style="color:#339933;">0&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;  "><span style="color:black;">0</span><br><span style="color:#339999;">0</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">0&nbsp;%</span></td> 
</tr>
 
<tr> 
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">uncertain</td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">0</span><br><span style="color:#339999;">9</span><br><span style="color:#333399;">0&nbsp;%</span><br><span style="color:#339933;">0&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">18</span><br><span style="color:#339999;">9</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">28.1&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;  "><span style="color:black;">18</span><br><span style="color:#339999;">18</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">14.3&nbsp;%</span></td> 
</tr>
 
<tr> 
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">lines</td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">2</span><br><span style="color:#339999;">4</span><br><span style="color:#333399;">22.2&nbsp;%</span><br><span style="color:#339933;">3.2&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">7</span><br><span style="color:#339999;">5</span><br><span style="color:#333399;">77.8&nbsp;%</span><br><span style="color:#339933;">10.9&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;  "><span style="color:black;">9</span><br><span style="color:#339999;">9</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">7.1&nbsp;%</span></td> 
</tr>
 
<tr> 
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">tri</td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">10</span><br><span style="color:#339999;">14</span><br><span style="color:#333399;">34.5&nbsp;%</span><br><span style="color:#339933;">16.1&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center; "><span style="color:black;">19</span><br><span style="color:#339999;">15</span><br><span style="color:#333399;">65.5&nbsp;%</span><br><span style="color:#339933;">29.7&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;  "><span style="color:black;">29</span><br><span style="color:#339999;">29</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">23&nbsp;%</span></td> 
</tr>
 
<tr> 
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;"><span style="color:black;">62</span><br><span style="color:#339999;">62</span><br><span style="color:#333399;">49.2&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;"><span style="color:black;">64</span><br><span style="color:#339999;">64</span><br><span style="color:#333399;">50.8&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span></td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;"><span style="color:black;">126</span><br><span style="color:#339999;">126</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span></td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=NaN · df=4 · Cramer's V=NaN · Fisher's p=0.000</td> 
</tr>
 
</tbody></table> <p>
 <span style="color:black;">observed values</span><br>
 <span style="color:#339999;">expected values</span><br>
 <span style="color:#333399;">% within scaled</span><br>
 <span style="color:#339933;">% within pretty_condition</span><br>
 </p>

</div>
</div>
<p><strong>TODO INFERENCE</strong></p>
</section>
<section id="multinomial-regression" class="level3">
<h3 class="anchored" data-anchor-id="multinomial-regression">MULTINOMIAL REGRESSION</h3>
<p>on interpreting coefficients (marginal probability) - https://data.princeton.edu/wws509/stata/mlogit</p>
<p><strong>TODO</strong> RECONCILE actual predictions with coefficients and visualization of predictions</p>
<p><em>Does condition affect the response state of Q1?</em></p>
<ul>
<li><a href="https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model" class="uri">https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model</a></li>
<li><a href="https://bookdown.org/chua/ber642_advanced_regression/multinomial-logistic-regression.html" class="uri">https://bookdown.org/chua/ber642_advanced_regression/multinomial-logistic-regression.html</a></li>
<li><a href="https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK" class="uri">https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK</a></li>
<li>Can use nnet package multinom() or mclogit package mblogit() [“baseline logit model”] or brms with family = “categorical”</li>
</ul>
<p><em>Fit a logistic regression predicting interpretation (k=#response categories) by condition. (k = 2).</em></p>
<ul>
<li><p>2 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer)</p></li>
<li><p>(from experience, seems) Each cell must have at least one observation (if one cell is blank, then it seems to be incorrectly estimated, see predicting high_interpretation vs.&nbsp;state. suggests nonsignificant OR for ‘unknown’ category, when infact that difference drives the effect</p></li>
<li><p>For <em>each</em> equation:</p>
<ul>
<li><p><span class="math inline">\(\beta_{0}\)</span> <em>= Log Odds of [this category type vs.&nbsp;reference category type) response in CONTROL condition</em></p>
<ul>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> <em>= ODDS of [this category type vs.&nbsp;reference category type] response in CONTROL condition</em></li>
</ul></li>
<li><p><span class="math inline">\(\beta_{1}\)</span> <em>=</em> <span class="math inline">\(\beta_{1impasse}\)</span> <em>Log Odds (Log OR; change in odds for [this category] type response in impasse (vs) control [log scale])</em></p></li>
<li><p><span class="math inline">\(e^{\beta_{1}}\)</span> <em>= ODDS RATIO of [this. vs reference category type] response in IMPASSE (vs) CONTROL</em></p></li>
<li><p><em>Null hypothesis:</em> <span class="math inline">\(\beta_{impasse} \le 0\)</span> <em>the odds for [this category of response vs.&nbsp;reference] does not change, or decreases</em></p></li>
<li><p><em>Alternative hypothesis:</em> <span class="math inline">\(\beta_{impasse} \gt 0\)</span> <em>the odds of [this category of response vs.&nbsp;reference] increases</em></p></li>
<li></li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb629"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES RESPONSE STATE</span></span>
<span id="cb629-2"><a href="#cb629-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-3"><a href="#cb629-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb629-4"><a href="#cb629-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb629-5"><a href="#cb629-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse   Sum
  orth-like   0.806   0.312 0.556
  unknown     0.000   0.281 0.143
  tri-like    0.194   0.406 0.302
  Sum         1.000   1.000 1.000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb631"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb631-2"><a href="#cb631-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse Sum
  orth-like      50      20  70
  unknown         0      18  18
  tri-like       12      26  38
  Sum            62      64 126</code></pre>
</div>
</div>
<section id="fit-model-2" class="level4">
<h4 class="anchored" data-anchor-id="fit-model-2">Fit Model</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb633"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb633-2"><a href="#cb633-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-3"><a href="#cb633-3" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb633-4"><a href="#cb633-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "orth-like" "unknown"   "tri-like" </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb635"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb635-2"><a href="#cb635-2" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  6 (2 variable)
initial  value 138.425148 
final  value 121.721888 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb637"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb637-2"><a href="#cb637-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb637-3"><a href="#cb637-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb637-4"><a href="#cb637-4" aria-hidden="true" tabindex="-1"></a>catm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  9 (4 variable)
initial  value 138.425148 
iter  10 value 100.042620
final  value 99.980123 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb639"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb639-1"><a href="#cb639-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm)</span></span>
<span id="cb639-2"><a href="#cb639-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb639-3"><a href="#cb639-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb639-4"><a href="#cb639-4" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |  Chi2 |      p
-------------------------------------------------
catm.0 | multinom |  2 |         |       |       
catm   | multinom |  4 |       2 | 43.48 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb641"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb641-1"><a href="#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb641-2"><a href="#cb641-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb641-3"><a href="#cb641-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bm1 &lt;- brm( state ~ pretty_condition, data = df, family = "categorical")</span></span>
<span id="cb641-4"><a href="#cb641-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(bm1)</span></span>
<span id="cb641-5"><a href="#cb641-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(bm1)</span></span>
<span id="cb641-6"><a href="#cb641-6" aria-hidden="true" tabindex="-1"></a><span class="co"># report(bm1)</span></span>
<span id="cb641-7"><a href="#cb641-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb641-8"><a href="#cb641-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-9"><a href="#cb641-9" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb641-10"><a href="#cb641-10" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb641-11"><a href="#cb641-11" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb641-12"><a href="#cb641-12" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state ~ pretty_condition , data = df)</span></span>
<span id="cb641-13"><a href="#cb641-13" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb641-14"><a href="#cb641-14" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.</em></p>
</section>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb642"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb642-2"><a href="#cb642-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL SUMMARY"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb644"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb644-1"><a href="#cb644-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(catm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = state ~ condition, data = df, model = TRUE)

Coefficients:
         (Intercept) conditionimpasse
unknown       -10.68            10.57
tri-like       -1.43             1.69

Std. Errors:
         (Intercept) conditionimpasse
unknown       29.475           29.476
tri-like       0.321            0.438

Residual Deviance: 200 
AIC: 208 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb646"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb646-1"><a href="#cb646-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb646-2"><a href="#cb646-2" aria-hidden="true" tabindex="-1"></a>(z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(catm)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(catm)<span class="sc">$</span>standard.errors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         (Intercept) conditionimpasse
unknown       -0.362            0.359
tri-like      -4.440            3.858</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb648"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb648-2"><a href="#cb648-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb648-3"><a href="#cb648-3" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb648-4"><a href="#cb648-4" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values))</span>
<span id="cb648-5"><a href="#cb648-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb648-6"><a href="#cb648-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-7"><a href="#cb648-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb650"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(catm)<span class="sc">$</span>coefficients))</span>
<span id="cb650-2"><a href="#cb650-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb650-3"><a href="#cb650-3" aria-hidden="true" tabindex="-1"></a><span class="co"># options(scipen = 3)</span></span>
<span id="cb650-4"><a href="#cb650-4" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         OR..Intercept. OR.conditionimpasse p..Intercept. p.conditionimpasse
unknown        0.000023            39095.01      7.17e-01           0.719806
tri-like       0.239973                5.42      9.01e-06           0.000114</code></pre>
</div>
</div>
<p><strong>Learning Notes</strong></p>
<ul>
<li>Model estimates encompass two equations:</li>
<li>effect of predictor on log odds of being in [unknown] instead of reference category [orth-like]</li>
<li>effect of predictor on log odds of being in [tri-like] instead of reference category [orth-like]</li>
<li>[need to to double check interpretation, but I <em>think</em> that the OR intercepts converted to probabilities equate to the marginal probability of being in each state in the [reference] control condition. which makes sense. I think]</li>
<li>IF I change reference category for condition… then the intercepts should no longer be significant. The b1 coefficients should still be significant, but with changed sign (much less likely) [Yup! this works!]</li>
</ul>
</section>
<section id="inference-2" class="level4">
<h4 class="anchored" data-anchor-id="inference-2">Inference</h4>
<ul>
<li>Being in the IMPASSE condition increases the odds of giving ‘unknown/uncertain’ response rather than an orthogonal (or satisficing) response by a factor of 50 (z = 3.59, p &lt; 0.001 ).</li>
<li>Being in the IMPASSE condition increases the odds of giving an ‘triangular or line-driven’ response rather than an orthogonal (or satisficing) response by a factor of 6 (z = 3.98, p &lt;0.001 )</li>
</ul>
</section>
<section id="visualize-1" class="level4">
<h4 class="anchored" data-anchor-id="visualize-1">Visualize</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb652"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb652-1"><a href="#cb652-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(catm, <span class="at">vline.color =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb653"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(catm, <span class="at">type =</span> <span class="st">"eff"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-76-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="diagnostics-2" class="level4">
<h4 class="anchored" data-anchor-id="diagnostics-2">Diagnostics</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb655"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb655-2"><a href="#cb655-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb655-3"><a href="#cb655-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))</span>
<span id="cb655-4"><a href="#cb655-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(catm, <span class="at">newdata =</span> test, <span class="st">"probs"</span>)</span>
<span id="cb655-5"><a href="#cb655-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Predicted Probability of Being in Each State"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Predicted Probability of Being in Each State"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb657"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb657-1"><a href="#cb657-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">cbind</span>(test, pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  condition orth-like   unknown tri-like
1   control     0.806 0.0000186    0.194
2   impasse     0.312 0.2812553    0.406</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb659"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb659-1"><a href="#cb659-1" aria-hidden="true" tabindex="-1"></a><span class="co">#performance</span></span>
<span id="cb659-2"><a href="#cb659-2" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(catm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma
-----------------------------------------------------
207.960 | 219.305 | 0.179 |     0.170 | 0.403 | 1.280</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb662"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb662-1"><a href="#cb662-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(catm, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'DescTools':
  method         from 
  reorder.factor gdata</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  McFadden   CoxSnell Nagelkerke 
     0.179      0.292      0.341 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb665"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb665-1"><a href="#cb665-1" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb665-2"><a href="#cb665-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(generalhoslem)</span></span>
<span id="cb665-3"><a href="#cb665-3" aria-hidden="true" tabindex="-1"></a><span class="co"># logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb665-4"><a href="#cb665-4" aria-hidden="true" tabindex="-1"></a><span class="co"># hoslem.test(x = df$state, y = catm$fitted.values, g =  10)</span></span>
<span id="cb665-5"><a href="#cb665-5" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb665-6"><a href="#cb665-6" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="mixed-repeated-measures" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> MIXED (Repeated Measures)</h1>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb666"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb666-1"><a href="#cb666-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb666-2"><a href="#cb666-2" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb666-3"><a href="#cb666-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-4"><a href="#cb666-4" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb666-5"><a href="#cb666-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb666-6"><a href="#cb666-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb666-7"><a href="#cb666-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb666-8"><a href="#cb666-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb666-9"><a href="#cb666-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-10"><a href="#cb666-10" aria-hidden="true" tabindex="-1"></a><span class="co">#FACETED HISTOGRAM</span></span>
<span id="cb666-11"><a href="#cb666-11" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(item_test_NABS))</span>
<span id="cb666-12"><a href="#cb666-12" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>item_test_NABS, </span>
<span id="cb666-13"><a href="#cb666-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_subjects) <span class="sc">%&gt;%</span> </span>
<span id="cb666-14"><a href="#cb666-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> pretty_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb666-15"><a href="#cb666-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb666-16"><a href="#cb666-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"# Correct"</span>,</span>
<span id="cb666-17"><a href="#cb666-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb666-18"><a href="#cb666-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Test Phase Absolute Score (# Correct)"</span>,</span>
<span id="cb666-19"><a href="#cb666-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb667"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb667-1"><a href="#cb667-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb667-2"><a href="#cb667-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb667-3"><a href="#cb667-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df) <span class="sc">%&gt;%</span></span>
<span id="cb667-4"><a href="#cb667-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb667-5"><a href="#cb667-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Correct Responses in Test Phase"</span>,</span>
<span id="cb667-6"><a href="#cb667-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Task by Condition"</span>,</span>
<span id="cb667-7"><a href="#cb667-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb668"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb668-1"><a href="#cb668-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb668-2"><a href="#cb668-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb668-3"><a href="#cb668-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb668-4"><a href="#cb668-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb668-5"><a href="#cb668-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb668-6"><a href="#cb668-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb668-7"><a href="#cb668-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb668-8"><a href="#cb668-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb668-9"><a href="#cb668-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb668-10"><a href="#cb668-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb668-11"><a href="#cb668-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb668-12"><a href="#cb668-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb668-13"><a href="#cb668-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="mixed-continuous" class="level2">
<h2 class="anchored" data-anchor-id="mixed-continuous">MIXED — CONTINUOUS</h2>
</section>
<section id="mixed-binomial" class="level2">
<h2 class="anchored" data-anchor-id="mixed-binomial">MIXED — BINOMIAL</h2>
<section id="mixed-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="mixed-logistic-regression">Mixed Logistic Regression</h4>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on test phase questions by condition; accounting for random effects of subject.</em></p>
<section id="fit-model-3" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-3">Fit Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb669"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb669-1"><a href="#cb669-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb669-2"><a href="#cb669-2" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb669-3"><a href="#cb669-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-4"><a href="#cb669-4" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb669-5"><a href="#cb669-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb669-6"><a href="#cb669-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb669-7"><a href="#cb669-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb669-8"><a href="#cb669-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb669-9"><a href="#cb669-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-10"><a href="#cb669-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb669-11"><a href="#cb669-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-12"><a href="#cb669-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM EFFECT</span></span>
<span id="cb669-13"><a href="#cb669-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-14"><a href="#cb669-14" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb669-15"><a href="#cb669-15" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df) </span>
<span id="cb669-16"><a href="#cb669-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-17"><a href="#cb669-17" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb669-18"><a href="#cb669-18" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb669-19"><a href="#cb669-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-20"><a href="#cb669-20" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT ITEM</span></span>
<span id="cb669-21"><a href="#cb669-21" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb669-22"><a href="#cb669-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-23"><a href="#cb669-23" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb669-24"><a href="#cb669-24" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with random effect is lower than glm empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC with random effect is lower than glm empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb671"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb671-1"><a href="#cb671-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name  |    Model | df | df_diff |   Chi2 |      p
-------------------------------------------------
m0    |      glm |  1 |         |        |       
mm.rS | glmerMod |  3 |       2 | 691.72 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb673"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb673-1"><a href="#cb673-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  6.23684317028986e-151"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb675"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb675-1"><a href="#cb675-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT</span></span>
<span id="cb675-2"><a href="#cb675-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-3"><a href="#cb675-3" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span></span>
<span id="cb675-4"><a href="#cb675-4" aria-hidden="true" tabindex="-1"></a>mm.CrS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), </span>
<span id="cb675-5"><a href="#cb675-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb675-6"><a href="#cb675-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-7"><a href="#cb675-7" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span></span>
<span id="cb675-8"><a href="#cb675-8" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb675-9"><a href="#cb675-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb675-10"><a href="#cb675-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-11"><a href="#cb675-11" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> fixed factor </span></span>
<span id="cb675-12"><a href="#cb675-12" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with fixed effect is lower than random intercept only model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrS)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC with fixed effect is lower than random intercept only model? FALSE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb677"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS,mm.CrS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff | Chi2 |      p
------------------------------------------------
mm.rS  | glmerMod |  3 |         |      |       
mm.CrS | glmerMod |  3 |       0 | 9.40 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb679"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS,mm.CrS))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0"</code></pre>
</div>
</div>
</section>
<section id="visualize-2" class="level5">
<h5 class="anchored" data-anchor-id="visualize-2">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb681"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: PRINT MODEL </span></span>
<span id="cb681-2"><a href="#cb681-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb683"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb683-1"><a href="#cb683-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(mm.CrS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 1008 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> accuracy </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> Mixed effects generalized linear model </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Family </td>
   <td style="text-align:right;"> binomial </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Link </td>
   <td style="text-align:right;"> logit </td>
  </tr>
</tbody>
</table> <table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;"> AIC </td>
   <td style="text-align:right;"> 582.02 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> BIC </td>
   <td style="text-align:right;"> 596.77 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Pseudo-R² (fixed effects) </td>
   <td style="text-align:right;"> 0.07 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Pseudo-R² (total) </td>
   <td style="text-align:right;"> 0.95 </td>
  </tr>
</tbody>
</table> <table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Fixed Effects</div></th></tr>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> z val. </th>
   <th style="text-align:right;"> p </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> -7.46 </td>
   <td style="text-align:right;"> 1.20 </td>
   <td style="text-align:right;"> -6.21 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> pretty_conditionimpasse </td>
   <td style="text-align:right;"> 4.03 </td>
   <td style="text-align:right;"> 1.67 </td>
   <td style="text-align:right;"> 2.42 </td>
   <td style="text-align:right;"> 0.02 </td>
  </tr>
</tbody>
</table> <table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Random Effects</div></th></tr>
  <tr>
   <th> Group </th>
   <th> Parameter </th>
   <th> Std. Dev. </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td> subject </td>
   <td> (Intercept) </td>
   <td> 7.36 </td>
  </tr>
</tbody>
</table> <table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Grouping Variables</div></th></tr>
  <tr>
   <th> Group </th>
   <th> # groups </th>
   <th> ICC </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td> subject </td>
   <td> 126 </td>
   <td> 0.94 </td>
  </tr>
</tbody>
</table>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb684"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb684-1"><a href="#cb684-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb684-2"><a href="#cb684-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb684-3"><a href="#cb684-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb686"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb686-1"><a href="#cb686-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(mm.CrS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma | Log_loss | Score_log | Score_spherical
----------------------------------------------------------------------------------------------------------------------
582.024 | 582.048 | 596.771 |      0.946 |      0.066 | 0.943 | 0.213 | 1.000 |    0.145 |      -Inf |           0.021</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb688"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb688-1"><a href="#cb688-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb690"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mm.CrS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic mixed model (estimated using ML and Nelder-Mead optimizer) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model included subject as random effect (formula: ~1 | subject). The model's total explanatory power is substantial (conditional R2 = 0.95) and the part related to the fixed effects alone (marginal R2) is of 0.07. The model's intercept, corresponding to pretty_condition = control, is at -7.46 (95% CI [-9.81, -5.11], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 4.03, 95% CI [0.76, 7.29], p = 0.016; Std. beta = 4.03, 95% CI [0.76, 7.29])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb693"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb693-1"><a href="#cb693-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m1)))</span></span>
<span id="cb693-2"><a href="#cb693-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # table of estimates with 95% CI</span></span>
<span id="cb693-3"><a href="#cb693-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m1), LL = fixef(m1) - 1.96 * se, UL = fixef(m1) + 1.96 *</span></span>
<span id="cb693-4"><a href="#cb693-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     se))</span></span>
<span id="cb693-5"><a href="#cb693-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb693-6"><a href="#cb693-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb693-7"><a href="#cb693-7" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb693-8"><a href="#cb693-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb693-9"><a href="#cb693-9" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb693-10"><a href="#cb693-10" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb693-11"><a href="#cb693-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb693-12"><a href="#cb693-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb693-13"><a href="#cb693-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb693-14"><a href="#cb693-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb693-15"><a href="#cb693-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb693-16"><a href="#cb693-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb694"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb694-2"><a href="#cb694-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"pred"</span>,</span>
<span id="cb694-3"><a href="#cb694-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb694-4"><a href="#cb694-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb694-5"><a href="#cb694-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb694-6"><a href="#cb694-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-80-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb696"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb696-1"><a href="#cb696-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb696-2"><a href="#cb696-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb696-3"><a href="#cb696-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ggeffect(model = mm.CrS) %&gt;% plot()</span></span>
<span id="cb696-4"><a href="#cb696-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb696-5"><a href="#cb696-5" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb696-6"><a href="#cb696-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb696-7"><a href="#cb696-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(mm.CrS))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-3" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-3">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb697"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb697-1"><a href="#cb697-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mm.CrS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb698"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(mm.CrS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Probably bad model fit. Only about 64% of the residuals are inside the error bounds.</code></pre>
</div>
</div>
</section>
<section id="inference-3" class="level5">
<h5 class="anchored" data-anchor-id="inference-3">Inference</h5>
<p>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(3): 4.98, p &lt; 0.05). Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 5 over the control condition <span class="math inline">\(e^{\beta_1}\)</span> = 5.11, 95% CI [1.17,22,36], p &lt; 0.05.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb700"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb700-1"><a href="#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PRETTY TABLE SJPLOT</span></span>
<span id="cb700-2"><a href="#cb700-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(mm.CrS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">56.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.14&nbsp;–&nbsp;1472.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.016</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">54.11</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.94</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">126</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1008</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.066 / 0.946</td>
</tr>

</tbody></table>

</div>
</div>
</section>
</section>
<section id="bayesian-mixed-lostistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="bayesian-mixed-lostistic-regression">BAYESIAN Mixed Lostistic Regression</h4>
<p><strong>Sanity Check</strong> Compare frequentist model with bayesian alternative</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb701"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) </span>
<span id="cb701-2"><a href="#cb701-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb701-3"><a href="#cb701-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb701-4"><a href="#cb701-4" aria-hidden="true" tabindex="-1"></a><span class="do">##:::::::: FLAT PRIORS</span></span>
<span id="cb701-5"><a href="#cb701-5" aria-hidden="true" tabindex="-1"></a><span class="co">#fit matching bayesian model [flat priors]</span></span>
<span id="cb701-6"><a href="#cb701-6" aria-hidden="true" tabindex="-1"></a>FLAT_B.mm.CrSQ <span class="ot">&lt;-</span>  <span class="fu">brm</span>(</span>
<span id="cb701-7"><a href="#cb701-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q)),</span>
<span id="cb701-8"><a href="#cb701-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_i,</span>
<span id="cb701-9"><a href="#cb701-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb701-10"><a href="#cb701-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb701-11"><a href="#cb701-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb701-12"><a href="#cb701-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb701-13"><a href="#cb701-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"analysis/utils/models/FLAT_B.mm.CrSQ.rds"</span></span>
<span id="cb701-14"><a href="#cb701-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb701-15"><a href="#cb701-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb701-16"><a href="#cb701-16" aria-hidden="true" tabindex="-1"></a><span class="co">#describe model</span></span>
<span id="cb701-17"><a href="#cb701-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FLAT_B.mm.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: accuracy ~ pretty_condition + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 4290) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~q (Number of levels: 13) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.93      0.23     0.58     1.47 1.00     1163     1843

~subject (Number of levels: 330) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     4.68      0.35     4.05     5.39 1.00      852     1424

Population-Level Effects: 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                  -4.63      0.58    -5.80    -3.52 1.01      495
pretty_conditionimpasse     3.11      0.61     1.98     4.34 1.00      331
                        Tail_ESS
Intercept                   1081
pretty_conditionimpasse      786

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb703"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb703-1"><a href="#cb703-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare to frequentist model</span></span>
<span id="cb703-2"><a href="#cb703-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"COMPARE TO FREQUENTIST"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "COMPARE TO FREQUENTIST"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb705"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb705-1"><a href="#cb705-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(mm.CrSQ, FLAT_B.mm.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                  |               mm.CrSQ |       FLAT_B.mm.CrSQ
-------------------------------------------------------------------------
(Intercept)                | -9.35 (-11.68, -7.03) | -4.62 (-5.80, -3.52)
pretty condition (impasse) |  2.18 ( -0.84,  5.19) |                     
pretty_conditionimpasse    |                       |  3.09 ( 1.98,  4.34)
-------------------------------------------------------------------------
Observations               |                  1008 |                 4290</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb707"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_Here we see that the model with default priors yields estimates comparable to the frequentist mixed model, though slightly smaller for fixed effects condition, with tighter credible intervals._</span></span>
<span id="cb707-2"><a href="#cb707-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-3"><a href="#cb707-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-4"><a href="#cb707-4" aria-hidden="true" tabindex="-1"></a><span class="do">##:::::::: INFORMATIVE PRIORS</span></span>
<span id="cb707-5"><a href="#cb707-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-6"><a href="#cb707-6" aria-hidden="true" tabindex="-1"></a><span class="co">#describe priors that were used</span></span>
<span id="cb707-7"><a href="#cb707-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"DEFAULT PRIORS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DEFAULT PRIORS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb709"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb709-1"><a href="#cb709-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(FLAT_B.mm.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class                    coef   group resp dpar nlpar
               (flat)         b                                                
               (flat)         b pretty_conditionimpasse                        
 student_t(3, 0, 2.5) Intercept                                                
 student_t(3, 0, 2.5)        sd                                                
 student_t(3, 0, 2.5)        sd                               q                
 student_t(3, 0, 2.5)        sd               Intercept       q                
 student_t(3, 0, 2.5)        sd                         subject                
 student_t(3, 0, 2.5)        sd               Intercept subject                
 lb ub       source
            default
       (vectorized)
            default
  0         default
  0    (vectorized)
  0    (vectorized)
  0    (vectorized)
  0    (vectorized)</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb711"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb711-1"><a href="#cb711-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set informative priors for fixed effects</span></span>
<span id="cb711-2"><a href="#cb711-2" aria-hidden="true" tabindex="-1"></a><span class="co">#parameters normally distributed around the mean of the expected log coefficient</span></span>
<span id="cb711-3"><a href="#cb711-3" aria-hidden="true" tabindex="-1"></a><span class="co">#we expect low probability of accuracy in control [intercept] and in impasse, but higher variance in impasse</span></span>
<span id="cb711-4"><a href="#cb711-4" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb711-5"><a href="#cb711-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>), <span class="at">class =</span> b),</span>
<span id="cb711-6"><a href="#cb711-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>)</span>
<span id="cb711-7"><a href="#cb711-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb711-8"><a href="#cb711-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-9"><a href="#cb711-9" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model with informative priors</span></span>
<span id="cb711-10"><a href="#cb711-10" aria-hidden="true" tabindex="-1"></a>B.mm.CrSQ <span class="ot">&lt;-</span>  <span class="fu">brm</span>(</span>
<span id="cb711-11"><a href="#cb711-11" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q),</span>
<span id="cb711-12"><a href="#cb711-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb711-13"><a href="#cb711-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_i,</span>
<span id="cb711-14"><a href="#cb711-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb711-15"><a href="#cb711-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb711-16"><a href="#cb711-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb711-17"><a href="#cb711-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb711-18"><a href="#cb711-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"analysis/utils/models/B.mm.CrSQ.rds"</span></span>
<span id="cb711-19"><a href="#cb711-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb711-20"><a href="#cb711-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-21"><a href="#cb711-21" aria-hidden="true" tabindex="-1"></a><span class="co">#describe model</span></span>
<span id="cb711-22"><a href="#cb711-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(B.mm.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: accuracy ~ pretty_condition + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 4290) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~q (Number of levels: 13) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.93      0.23     0.59     1.46 1.00     1270     2257

~subject (Number of levels: 330) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     4.64      0.33     4.06     5.32 1.01     1010     1894

Population-Level Effects: 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                  -4.48      0.57    -5.61    -3.38 1.01      485
pretty_conditionimpasse     2.93      0.60     1.76     4.11 1.01      379
                        Tail_ESS
Intercept                   1292
pretty_conditionimpasse      832

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb713"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb713-1"><a href="#cb713-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare to frequentist model</span></span>
<span id="cb713-2"><a href="#cb713-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"COMPARE TO UNFINFORMATIVE PRIOR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "COMPARE TO UNFINFORMATIVE PRIOR"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb715"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb715-1"><a href="#cb715-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(FLAT_B.mm.CrSQ, B.mm.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter               |       FLAT_B.mm.CrSQ |            B.mm.CrSQ
---------------------------------------------------------------------
(Intercept)             | -4.62 (-5.80, -3.52) | -4.48 (-5.61, -3.38)
pretty_conditionimpasse |  3.09 ( 1.98,  4.34) |  2.92 ( 1.76,  4.11)
---------------------------------------------------------------------
Observations            |                 4290 |                 4290</code></pre>
</div>
</div>
<p><em>Here we see tha the model with the informative prior makes predictions similar to the uninformative prior model</em>.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb717"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DIAGNOSTICS</span></span>
<span id="cb717-2"><a href="#cb717-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-3"><a href="#cb717-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set model </span></span>
<span id="cb717-4"><a href="#cb717-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> B.mm.CrSQ</span>
<span id="cb717-5"><a href="#cb717-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-6"><a href="#cb717-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: accuracy ~ pretty_condition + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 4290) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~q (Number of levels: 13) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.93      0.23     0.59     1.46 1.00     1270     2257

~subject (Number of levels: 330) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     4.64      0.33     4.06     5.32 1.01     1010     1894

Population-Level Effects: 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                  -4.48      0.57    -5.61    -3.38 1.01      485
pretty_conditionimpasse     2.93      0.60     1.76     4.11 1.01      379
                        Tail_ESS
Intercept                   1292
pretty_conditionimpasse      832

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb719"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb719-1"><a href="#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="co">#POSTERIOR CHECKS</span></span>
<span id="cb719-2"><a href="#cb719-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb719-3"><a href="#cb719-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diagnostic_posterior</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Parameter Rhat ESS   MCSE
1               b_Intercept 1.01 484 0.0257
2 b_pretty_conditionimpasse 1.01 382 0.0308</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb721"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m, <span class="at">ndraws =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb722"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb722-1"><a href="#cb722-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb723"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERPRET</span></span>
<span id="cb723-2"><a href="#cb723-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_posterior</span>(m, <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"p_direction"</span>, <span class="st">"rope"</span>, <span class="st">"bayesfactor"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling priors, please wait...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Bayes factors might not be precise.
For precise Bayes factors, sampling at least 40,000 posterior samples is recommended.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Posterior Distribution

Parameter               | Median |         95% CI |   pd |          ROPE | % in ROPE |  Rhat |    ESS |     BF
--------------------------------------------------------------------------------------------------------------
(Intercept)             |  -4.48 | [-5.61, -3.38] | 100% | [-0.18, 0.18] |        0% | 1.006 | 484.00 | &gt; 1000
pretty_conditionimpasse |   2.92 | [ 1.76,  4.11] | 100% | [-0.18, 0.18] |        0% | 1.010 | 382.00 | &gt; 1000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb727"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb727-1"><a href="#cb727-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set working model</span></span>
<span id="cb727-2"><a href="#cb727-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> B.mm.CrSQ</span>
<span id="cb727-3"><a href="#cb727-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-4"><a href="#cb727-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-5"><a href="#cb727-5" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalence test </span></span>
<span id="cb727-6"><a href="#cb727-6" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"cet"</span>)</span>
<span id="cb727-7"><a href="#cb727-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0912</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 200 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb730"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rope </span></span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb730-3"><a href="#cb730-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb731"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb731-1"><a href="#cb731-1" aria-hidden="true" tabindex="-1"></a><span class="co">#direction of effect </span></span>
<span id="cb731-2"><a href="#cb731-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m)</span>
<span id="cb731-3"><a href="#cb731-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb732"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb732-1"><a href="#cb732-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all parameters</span></span>
<span id="cb732-2"><a href="#cb732-2" aria-hidden="true" tabindex="-1"></a>m <span class="sc">%&gt;%</span> </span>
<span id="cb732-3"><a href="#cb732-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb732-4"><a href="#cb732-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(lp__, <span class="fu">contains</span>(<span class="st">"["</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb732-5"><a href="#cb732-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb732-6"><a href="#cb732-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb732-7"><a href="#cb732-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb732-8"><a href="#cb732-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb732-9"><a href="#cb732-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb732-10"><a href="#cb732-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">point_interval =</span> mode_hdi,</span>
<span id="cb732-11"><a href="#cb732-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span> </span>
<span id="cb732-12"><a href="#cb732-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,</span>
<span id="cb732-13"><a href="#cb732-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb732-14"><a href="#cb732-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb732-15"><a href="#cb732-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'posterior_samples' is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb734"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb734-1"><a href="#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot parameters</span></span>
<span id="cb734-2"><a href="#cb734-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stanplot</span>(m, </span>
<span id="cb734-3"><a href="#cb734-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"areas"</span>,</span>
<span id="cb734-4"><a href="#cb734-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob =</span> <span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'stanplot' is deprecated. Please use 'mcmc_plot' instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb736"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb736-1"><a href="#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot model</span></span>
<span id="cb736-2"><a href="#cb736-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-8.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb737"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb737-1"><a href="#cb737-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT PARAMETERS</span></span>
<span id="cb737-2"><a href="#cb737-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, </span>
<span id="cb737-3"><a href="#cb737-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb737-4"><a href="#cb737-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result) <span class="sc">+</span> </span>
<span id="cb737-5"><a href="#cb737-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb737-6"><a href="#cb737-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Accuracy ~ Condition + (1 | subject) + (1 | question)"</span>,</span>
<span id="cb737-7"><a href="#cb737-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Logistic Mixed Effects Model"</span></span>
<span id="cb737-8"><a href="#cb737-8" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-9.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb738"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb738-1"><a href="#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb738-2"><a href="#cb738-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)[[<span class="dv">1</span>]] <span class="sc">+</span> </span>
<span id="cb738-3"><a href="#cb738-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb738-4"><a href="#cb738-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb738-5"><a href="#cb738-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Impasse increases Probability of Correct Response"</span></span>
<span id="cb738-6"><a href="#cb738-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Note: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'y' is already present. Adding another scale for 'y', which will
replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/MODEL-DESC-ACC-10.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb741"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb741-1"><a href="#cb741-1" aria-hidden="true" tabindex="-1"></a><span class="co">#report(m)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="mixed-ordinal" class="level2">
<h2 class="anchored" data-anchor-id="mixed-ordinal">MIXED — ORDINAL</h2>
</section>
<section id="mixed-categorical" class="level2">
<h2 class="anchored" data-anchor-id="mixed-categorical">MIXED — CATEGORICAL</h2>
<section id="mixed-multinomial-regression" class="level3">
<h3 class="anchored" data-anchor-id="mixed-multinomial-regression">Mixed Multinomial Regression</h3>
<p><em>Does condition affect the response state of of items across the task?</em></p>
<p><em>Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).</em></p>
<ul>
<li><p>Can use mclogit mblogit() with random effect <em>or</em> bayesian brms package b/c nlme, lme4 don’t support random effects on multinomial (ie no categorical family on glmer())</p></li>
<li><p>Alternative would be to manually run [k-1] X binomial mixed models [should compare outcomes]</p></li>
<li><p>[k-1] equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) [essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing [reference category] vs [this category])</p></li>
<li><p>For <em>each</em> equation:</p>
<ul>
<li><span class="math inline">\(\beta_{0}\)</span> <em>= Log Odds of [this category type vs.&nbsp;reference category type) response in CONTROL condition</em></li>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> <em>= ODDS of [this category type vs.&nbsp;reference category type] response in CONTROL condition</em></li>
<li><span class="math inline">\(\beta_{1}\)</span> <em>=</em> <span class="math inline">\(\beta_{1impasse}\)</span> <em>Log Odds (Log OR; change in odds for [this category] type response in impasse (vs) control [log scale])</em></li>
<li><span class="math inline">\(e^{\beta_{1}}\)</span> <em>= ODDS RATIO of [this. vs reference category type] response in IMPASSE (vs) CONTROL</em></li>
<li>Two-tailed NHST <em>Null hypothesis:</em> <span class="math inline">\(\beta_{impasse} = 0\)</span> <em>the odds for [this category of response vs.&nbsp;reference] are not different for IMPASSE condition</em></li>
<li><em>Alternative hypothesis:</em> <span class="math inline">\(\beta_{impasse} \ne 0\)</span> <em>the odds of [this category of response vs.&nbsp;reference] increases or decreases for IMPASSE condition</em></li>
</ul></li>
</ul>
<section id="fit-model-manual-individual-binomials" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-manual-individual-binomials">Fit Model [MANUAL INDIVIDUAL BINOMIALS]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb742"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb742-1"><a href="#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="co">#VERIFY RESULTS BELOW VIA MULTIPLE INDIVIDUAL MODELS</span></span>
<span id="cb742-2"><a href="#cb742-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb742-3"><a href="#cb742-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ORTH vs. UNKNOWN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ORTH vs. UNKNOWN"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb744"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb744-1"><a href="#cb744-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"tri-like"</span>)) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb744-2"><a href="#cb744-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(d1<span class="sc">$</span>pretty_condition, d1<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         
          orth-like unknown
  control       562      57
  impasse       279     153</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb746"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb746-1"><a href="#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d1<span class="sc">$</span>pretty_condition, d1<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb747"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb747-1"><a href="#cb747-1" aria-hidden="true" tabindex="-1"></a>m.unknown <span class="ot">&lt;-</span> <span class="fu">glmer</span>(state <span class="sc">~</span> pretty_condition <span class="sc">+</span> ( <span class="dv">1</span> <span class="sc">|</span> subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> q), <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> d1)</span>
<span id="cb747-2"><a href="#cb747-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.unknown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: state ~ pretty_condition + (1 | subject) + (1 | q)
   Data: d1

     AIC      BIC   logLik deviance df.resid 
     801      821     -397      793     1047 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.608 -0.358 -0.193 -0.061  4.241 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 2.25     1.50    
 q       (Intercept) 1.84     1.36    
Number of obs: 1051, groups:  subject, 111; q, 13

Fixed effects:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -3.415      0.501   -6.81  9.5e-12 ***
pretty_conditionimpasse    2.785      0.414    6.73  1.7e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
prtty_cndtn -0.516</code></pre>
</div>
</div>
<p><em>Being in the IMPASSE condition increases</em> the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 19 ( logodds = 2.92, z = 6.89, p &lt; 0.001) . Participants in the impasse condition were 19x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control. (Conditional R2 = 0.67, marginal R2 = 0.21; SD(subject) = 1.55, SD(question) = 2.22)</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb749"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb749-1"><a href="#cb749-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ORTH vs. TRIANGULAR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ORTH vs. TRIANGULAR"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb751"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb751-1"><a href="#cb751-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"unknown"</span>)) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb751-2"><a href="#cb751-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(d2<span class="sc">$</span>pretty_condition, d2<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         
          orth-like tri-like
  control       562      187
  impasse       279      400</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb753"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb753-1"><a href="#cb753-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d2<span class="sc">$</span>pretty_condition, d2<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb754"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb754-1"><a href="#cb754-1" aria-hidden="true" tabindex="-1"></a>m.tri <span class="ot">&lt;-</span> <span class="fu">glmer</span>(state <span class="sc">~</span> pretty_condition <span class="sc">+</span> ( <span class="dv">1</span> <span class="sc">|</span> subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> q), <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> d2)</span>
<span id="cb754-2"><a href="#cb754-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.tri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: state ~ pretty_condition + (1 | subject) + (1 | q)
   Data: d2

     AIC      BIC   logLik deviance df.resid 
     822      843     -407      814     1424 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.877 -0.136 -0.042  0.142  5.314 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 24.675   4.967   
 q       (Intercept)  0.939   0.969   
Number of obs: 1428, groups:  subject, 126; q, 13

Fixed effects:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -4.54       1.11   -4.10 0.000041 ***
pretty_conditionimpasse     5.50       1.34    4.11 0.000039 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
prtty_cndtn -0.828</code></pre>
</div>
</div>
<p><em>Being in the IMPASSE condition increases</em> the odds of giving an triangle-like response by a factor of 305 ( logodds = 5.72, z = 4.14, p &lt; 0.001) . Participants in the impasse condition were 305 times as likely to give an triangle-like response rather than an orthogonal response compared to participants in control. (Conditional R2 = 0.91, marginal R2 = 0.21; SD(subject) = 5.05, SD(q) = 1.09)</p>
</section>
<section id="fit-model-mblogit" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-mblogit">Fit Model [mblogit]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb756"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb756-1"><a href="#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb756-2"><a href="#cb756-2" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline category logit" model matches multinom()</span></span>
<span id="cb756-3"><a href="#cb756-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb756-4"><a href="#cb756-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb756-5"><a href="#cb756-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categories (first is reference)"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb758"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb758-1"><a href="#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_i<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "orth-like" "unknown"   "tri-like" </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb760"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb760-1"><a href="#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb760-2"><a href="#cb760-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb760-3"><a href="#cb760-3" aria-hidden="true" tabindex="-1"></a>m.mbl0 <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> pretty_condition ,  <span class="co">#no random intercepts; fixed only model </span></span>
<span id="cb760-4"><a href="#cb760-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> df_i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 1 - deviance = 2979 - criterion = 0.438
Iteration 2 - deviance = 2968 - criterion = 0.00394
Iteration 3 - deviance = 2967 - criterion = 0.0000221
Iteration 4 - deviance = 2967 - criterion = 4.57e-10
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb762"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb762-1"><a href="#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(m.mbl0)</span></span>
<span id="cb762-2"><a href="#cb762-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb762-3"><a href="#cb762-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb762-4"><a href="#cb762-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb762-5"><a href="#cb762-5" aria-hidden="true" tabindex="-1"></a>m.mbl1 <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> pretty_condition , </span>
<span id="cb762-6"><a href="#cb762-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>( <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>subject, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb762-7"><a href="#cb762-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> df_i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 1 - deviance = 2132 - criterion = 0.761
Iteration 2 - deviance = 1864 - criterion = 0.0799
Iteration 3 - deviance = 1763 - criterion = 0.0252
Iteration 4 - deviance = 1727 - criterion = 0.00355
Iteration 5 - deviance = 1705 - criterion = 0.00086
Iteration 6 - deviance = 1694 - criterion = 0.000186
Iteration 7 - deviance = 1689 - criterion = 0.0000364
Iteration 8 - deviance = 1687 - criterion = 7.02e-06
Iteration 9 - deviance = 1686 - criterion = 1.39e-06
Iteration 10 - deviance = 1686 - criterion = 2.84e-07
Iteration 11 - deviance = 1686 - criterion = 6.05e-08
Iteration 12 - deviance = 1686 - criterion = 1.35e-08
Iteration 13 - deviance = 1686 - criterion = 3.12e-09
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb764"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb764-1"><a href="#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m.mbl1)</span></span>
<span id="cb764-2"><a href="#cb764-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb764-3"><a href="#cb764-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb764-4"><a href="#cb764-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, <span class="fu">AIC</span>(m.mbl0) <span class="sc">&gt;</span> <span class="fu">AIC</span>(m.mbl1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb766"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb766-1"><a href="#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.mbl0, m.mbl1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |    Chi2 |      p
---------------------------------------------------
m.mbl0 |  mblogit |  4 |         |         |       
m.mbl1 | mmblogit | 10 |       6 | 1989.27 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb768"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb768-1"><a href="#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DESCRIBE MODEL</span></span>
<span id="cb768-2"><a href="#cb768-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.mbl1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
mblogit(formula = state ~ pretty_condition, data = df_i, random = list(~1 | 
    subject, ~1 | q))

Equation for unknown vs orth-like:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -2.547      0.498   -5.12  3.1e-07 ***
pretty_conditionimpasse    2.333      0.368    6.33  2.4e-10 ***

Equation for tri-like vs orth-like:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -2.490      0.666   -3.74  0.00018 ***
pretty_conditionimpasse    3.149      0.701    4.49  7.1e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Co-)Variances:
Grouping level: subject 
           Estimate    Std.Err.   
unknown~1   2.6        0.659      
tri-like~1  4.4 12.7   2.758 7.717

Grouping level: q 
           Estimate    Std.Err. 
unknown~1  2.22        16.4     
tri-like~1 1.75 2.25   15.6 15.2

Null Deviance:     3600 
Residual Deviance: 1690 
Number of Fisher Scoring iterations:  13
Number of observations
  Groups by subject: 126
  Groups by q: 13
  Individual observations:  1638</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb770"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb770-1"><a href="#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERPRET COEFFICIENTS</span></span>
<span id="cb770-2"><a href="#cb770-2" aria-hidden="true" tabindex="-1"></a>cint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m.mbl1, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb770-3"><a href="#cb770-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ODDS RATIO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIO"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb772"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb772-1"><a href="#cb772-1" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m.mbl1)), <span class="fu">exp</span>(cint))) <span class="co">#exponentiated, adjusted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                          2.5 % 97.5 %
unknown~(Intercept)               0.0783 0.0295  0.208
tri-like~(Intercept)              0.0829 0.0225  0.306
unknown~pretty_conditionimpasse  10.3066 5.0043 21.227
tri-like~pretty_conditionimpasse 23.3153 5.8942 92.226</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb774"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb774-1"><a href="#cb774-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PERFORMANCE</span></span>
<span id="cb774-2"><a href="#cb774-2" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m.mbl1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |       BIC |  RMSE | Sigma
-------------------------------------
13718.044 | 13772.057 | 0.270 | 1.016</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb776"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb776-1"><a href="#cb776-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TABLE</span></span>
<span id="cb776-2"><a href="#cb776-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m.mbl1, <span class="at">transform =</span> <span class="st">"exp"</span>, <span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<caption style="font-weight: bold; text-align:left;">Model Predicted Odds Ratio</caption>
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">unknown~(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.03&nbsp;–&nbsp;0.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">tri-like~(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02&nbsp;–&nbsp;0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">unknown~pretty_conditionimpasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.00&nbsp;–&nbsp;21.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">tri-like~pretty_conditionimpasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">23.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.89&nbsp;–&nbsp;92.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">126</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>q</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">13</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1638</td>
</tr>

</tbody></table>

</div>
</div>
</section>
<section id="inference-4" class="level5">
<h5 class="anchored" data-anchor-id="inference-4">Inference</h5>
<ul>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 12 (z = 6.48, p &lt; 0.001) . <strong>Participants in the impasse condition were 12x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving ‘triangle-like’ response rather than an orthogonal (or satisficing) response by a factor of 29 (z = 4.63, p &lt; 0.001 ). <strong>Participants in the impasse condition were more than 29x as likely to give an a triangular response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>As with the (binary) logistic regression on accuracy ~ condition, significant model intercepts indicate that the odds of being in any particular response state (vs) orthogonal are significantly different than 1 <em>in the control condition.</em> (i.e.&nbsp;not 1:1 odds or 50% chance of being in that response state. Orthogonal is a much more probable response state in control)</p></li>
</ul>
</section>
<section id="visualize-3" class="level5">
<h5 class="anchored" data-anchor-id="visualize-3">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb777"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb777-1"><a href="#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set model </span></span>
<span id="cb777-2"><a href="#cb777-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m.mbl1</span>
<span id="cb777-3"><a href="#cb777-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb777-4"><a href="#cb777-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb777-5"><a href="#cb777-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb777-6"><a href="#cb777-6" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb777-7"><a href="#cb777-7" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb777-8"><a href="#cb777-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb777-9"><a href="#cb777-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">transform =</span> <span class="st">"exp"</span>, <span class="co">#for some reason have to manually add for mixed?</span></span>
<span id="cb777-10"><a href="#cb777-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb777-11"><a href="#cb777-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb777-12"><a href="#cb777-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.05</span>, <span class="co">#can manually adjust to account for directional test</span></span>
<span id="cb777-13"><a href="#cb777-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">+</span>  <span class="co">#can manually adjusted for directional test   </span></span>
<span id="cb777-14"><a href="#cb777-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ODDS RATIO | State ~ condition"</span>,</span>
<span id="cb777-15"><a href="#cb777-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"(p for  two-tailed test)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb778"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb778-1"><a href="#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb778-2"><a href="#cb778-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb778-3"><a href="#cb778-3" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT PARAMETER ESTIMATES</span></span>
<span id="cb778-4"><a href="#cb778-4" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">simulate_parameters</span>(m)</span>
<span id="cb778-5"><a href="#cb778-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">stack =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-89-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb779"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb779-1"><a href="#cb779-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"cet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Could not estimate a good default ROPE range. Using 'c(-0.1, 0.1)'.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb781"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb781-1"><a href="#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-89-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb782"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb782-1"><a href="#cb782-1" aria-hidden="true" tabindex="-1"></a><span class="co">#raw coefficients</span></span>
<span id="cb782-2"><a href="#cb782-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-89-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb783"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb783-1"><a href="#cb783-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT PARAMETERS</span></span>
<span id="cb783-2"><a href="#cb783-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, </span>
<span id="cb783-3"><a href="#cb783-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb783-4"><a href="#cb783-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result) <span class="sc">+</span> </span>
<span id="cb783-5"><a href="#cb783-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb783-6"><a href="#cb783-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Accuracy ~ Condition + (1 | subject) + (1 | question)"</span>,</span>
<span id="cb783-7"><a href="#cb783-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Logistic Mixed Effects Model"</span></span>
<span id="cb783-8"><a href="#cb783-8" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-89-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb784"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb784-1"><a href="#cb784-1" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>function (...) 
{
    mgcv::s(...)
}
&lt;bytecode: 0x7fbcfa8afcc8&gt;
&lt;environment: namespace:brms&gt;</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb786"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb786-1"><a href="#cb786-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO CAN'T SEEM TO COMPUTE MARGINAL EFFECTS PLOT FOR THE MIXED MODEL</span></span>
<span id="cb786-2"><a href="#cb786-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pr &lt;- ggpredict(m, "pretty_condition", type = "fixed")</span></span>
<span id="cb786-3"><a href="#cb786-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(pr)</span></span>
<span id="cb786-4"><a href="#cb786-4" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb786-5"><a href="#cb786-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")</span></span>
<span id="cb786-6"><a href="#cb786-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "eff")</span></span>
<span id="cb786-7"><a href="#cb786-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb786-8"><a href="#cb786-8" aria-hidden="true" tabindex="-1"></a><span class="co"># TERNARY PLOT</span></span>
<span id="cb786-9"><a href="#cb786-9" aria-hidden="true" tabindex="-1"></a><span class="co"># library(plot3logit)</span></span>
<span id="cb786-10"><a href="#cb786-10" aria-hidden="true" tabindex="-1"></a><span class="co"># field3logit(ggpredict(m))</span></span>
<span id="cb786-11"><a href="#cb786-11" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/plot3logit/vignettes/plot3logit-overview.html</span></span>
<span id="cb786-12"><a href="#cb786-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb786-13"><a href="#cb786-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb786-14"><a href="#cb786-14" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb786-15"><a href="#cb786-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">unknown~(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.52&nbsp;–&nbsp;-1.57</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">tri-like~(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.80&nbsp;–&nbsp;-1.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">unknown~pretty_conditionimpasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61&nbsp;–&nbsp;3.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">tri-like~pretty_conditionimpasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.77&nbsp;–&nbsp;4.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">126</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>q</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">13</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1638</td>
</tr>

</tbody></table>

</div>
</div>
</section>
<section id="diagnostics-4" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-4">Diagnostics</h5>
<p><strong>COMPARE TO MANUAL MODELS</strong> ::: {.cell}</p>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb787"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb787-1"><a href="#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(m, m.unknown, m.tri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                        |                    m |            m.unknown |                m.tri
-----------------------------------------------------------------------------------------------------
(Intercept)                      |                      | -3.41 (-4.40, -2.43) | -4.54 (-6.70, -2.37)
unknown~(Intercept)              | -2.55 (-3.52, -1.57) |                      |                     
tri-like~(Intercept)             | -2.49 (-3.80, -1.19) |                      |                     
unknown~pretty conditionimpasse  |  2.33 ( 1.61,  3.06) |                      |                     
tri-like~pretty conditionimpasse |  3.15 ( 1.77,  4.52) |                      |                     
pretty condition (impasse)       |                      |  2.78 ( 1.97,  3.60) |  5.50 ( 2.88,  8.13)
-----------------------------------------------------------------------------------------------------
Observations                     |                 1638 |                 1051 |                 1428</code></pre>
</div>
<p>:::</p>
</section>
<section id="fit-model-brms" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-brms">Fit Model [brms]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb789"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb789-1"><a href="#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb789-2"><a href="#cb789-2" aria-hidden="true" tabindex="-1"></a>mixcat<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb789-3"><a href="#cb789-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb789-4"><a href="#cb789-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb789-5"><a href="#cb789-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb789-6"><a href="#cb789-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb789-7"><a href="#cb789-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb789-8"><a href="#cb789-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/utils/models/mixcat1.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb790"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb790-1"><a href="#cb790-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mixcat<span class="fl">.1</span></span>
<span id="cb790-2"><a href="#cb790-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-3"><a href="#cb790-3" aria-hidden="true" tabindex="-1"></a><span class="co">#DESCRIBE MODEL</span></span>
<span id="cb790-4"><a href="#cb790-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: categorical 
  Links: muunknown = logit; mutrilike = logit 
Formula: state ~ pretty_condition + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 4290) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~q (Number of levels: 13) 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muunknown_Intercept)     1.54      0.35     1.01     2.36 1.00     1571
sd(mutrilike_Intercept)     1.22      0.29     0.80     1.93 1.00     1588
                        Tail_ESS
sd(muunknown_Intercept)     2624
sd(mutrilike_Intercept)     2353

~subject (Number of levels: 330) 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muunknown_Intercept)     1.20      0.10     1.02     1.40 1.00     1570
sd(mutrilike_Intercept)     4.09      0.27     3.59     4.67 1.00     1271
                        Tail_ESS
sd(muunknown_Intercept)     2708
sd(mutrilike_Intercept)     2159

Population-Level Effects: 
                                  Estimate Est.Error l-95% CI u-95% CI Rhat
muunknown_Intercept                  -2.43      0.45    -3.29    -1.52 1.00
mutrilike_Intercept                  -3.16      0.52    -4.19    -2.12 1.00
muunknown_pretty_conditionimpasse     2.04      0.19     1.67     2.41 1.00
mutrilike_pretty_conditionimpasse     3.52      0.51     2.56     4.54 1.00
                                  Bulk_ESS Tail_ESS
muunknown_Intercept                   1166     1903
mutrilike_Intercept                   1006     1533
muunknown_pretty_conditionimpasse     2775     3303
mutrilike_pretty_conditionimpasse      772     1479

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb792"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb792-1"><a href="#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="co"># report(mixcat.1)</span></span>
<span id="cb792-2"><a href="#cb792-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-3"><a href="#cb792-3" aria-hidden="true" tabindex="-1"></a><span class="co">#TABLE</span></span>
<span id="cb792-4"><a href="#cb792-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m,</span></span>
<span id="cb792-5"><a href="#cb792-5" aria-hidden="true" tabindex="-1"></a>          <span class="co"># show.r2 = FALSE) #, transform = "exp", title = "Model Predicted Odds Ratio")</span></span>
<span id="cb792-6"><a href="#cb792-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-7"><a href="#cb792-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-8"><a href="#cb792-8" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb792-9"><a href="#cb792-9" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb792-10"><a href="#cb792-10" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="inference-5" class="level5">
<h5 class="anchored" data-anchor-id="inference-5">Inference</h5>
<ul>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 43.86.</p></li>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving ‘triangle-like’ response rather than an orthogonal (or satisficing) response by a factor of 6.64.</p></li>
</ul>
</section>
<section id="visualize-4" class="level5">
<h5 class="anchored" data-anchor-id="visualize-4">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb793"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb793-1"><a href="#cb793-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-2"><a href="#cb793-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #:::::::: PLOT</span></span>
<span id="cb793-3"><a href="#cb793-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-4"><a href="#cb793-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb793-5"><a href="#cb793-5" aria-hidden="true" tabindex="-1"></a><span class="co"># #library(sjPlot)</span></span>
<span id="cb793-6"><a href="#cb793-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red", </span></span>
<span id="cb793-7"><a href="#cb793-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb793-8"><a href="#cb793-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb793-9"><a href="#cb793-9" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.05, #can manually adjust to account for directional test</span></span>
<span id="cb793-10"><a href="#cb793-10" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.95 ) +  #can manually adjusted for directional test   </span></span>
<span id="cb793-11"><a href="#cb793-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "ODDS RATIO | State ~ condition",</span></span>
<span id="cb793-12"><a href="#cb793-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "(p for one two test)")</span></span>
<span id="cb793-13"><a href="#cb793-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-14"><a href="#cb793-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-15"><a href="#cb793-15" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- estimate_density(m)</span></span>
<span id="cb793-16"><a href="#cb793-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE, priors = TRUE)</span></span>
<span id="cb793-17"><a href="#cb793-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-18"><a href="#cb793-18" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- describe_posterior(m)</span></span>
<span id="cb793-19"><a href="#cb793-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE, priors = TRUE)</span></span>
<span id="cb793-20"><a href="#cb793-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-21"><a href="#cb793-21" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- p_direction(m)</span></span>
<span id="cb793-22"><a href="#cb793-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE)</span></span>
<span id="cb793-23"><a href="#cb793-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-24"><a href="#cb793-24" aria-hidden="true" tabindex="-1"></a><span class="co"># #ROPE</span></span>
<span id="cb793-25"><a href="#cb793-25" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- rope(m, ci = 0.89)</span></span>
<span id="cb793-26"><a href="#cb793-26" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result) + theme_clean()</span></span>
<span id="cb793-27"><a href="#cb793-27" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-28"><a href="#cb793-28" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- equivalence_test(m)</span></span>
<span id="cb793-29"><a href="#cb793-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb793-30"><a href="#cb793-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-31"><a href="#cb793-31" aria-hidden="true" tabindex="-1"></a><span class="co"># #ERROR incompatible arguments to calculate multivariate normal distribution</span></span>
<span id="cb793-32"><a href="#cb793-32" aria-hidden="true" tabindex="-1"></a><span class="co"># # result &lt;- simulate_parameters(m)</span></span>
<span id="cb793-33"><a href="#cb793-33" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot(result)</span></span>
<span id="cb793-34"><a href="#cb793-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-35"><a href="#cb793-35" aria-hidden="true" tabindex="-1"></a><span class="co"># #check posterior</span></span>
<span id="cb793-36"><a href="#cb793-36" aria-hidden="true" tabindex="-1"></a><span class="co"># pp_check(m, ndraws=1000)</span></span>
<span id="cb793-37"><a href="#cb793-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-38"><a href="#cb793-38" aria-hidden="true" tabindex="-1"></a><span class="co"># #PERFORMANCE</span></span>
<span id="cb793-39"><a href="#cb793-39" aria-hidden="true" tabindex="-1"></a><span class="co"># # performance(m)</span></span>
<span id="cb793-40"><a href="#cb793-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-41"><a href="#cb793-41" aria-hidden="true" tabindex="-1"></a><span class="co"># #Plot parameters</span></span>
<span id="cb793-42"><a href="#cb793-42" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(model_parameters(m, exponentiate = TRUE))</span></span>
<span id="cb793-43"><a href="#cb793-43" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb793-44"><a href="#cb793-44" aria-hidden="true" tabindex="-1"></a><span class="co"># #plot marginal predictions of model</span></span>
<span id="cb793-45"><a href="#cb793-45" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")[[1]] + </span></span>
<span id="cb793-46"><a href="#cb793-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(</span></span>
<span id="cb793-47"><a href="#cb793-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Predicted Marginal Probabilities",</span></span>
<span id="cb793-48"><a href="#cb793-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", </span></span>
<span id="cb793-49"><a href="#cb793-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "probability of being in each state"</span></span>
<span id="cb793-50"><a href="#cb793-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compare-1" class="level5">
<h5 class="anchored" data-anchor-id="compare-1">COMPARE</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb794"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb794-1"><a href="#cb794-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare_models(m.unknown, m.tri, m.mbl1, mixcat.1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The predictions of the manual, frequentist mixed multinomial and bayesian mixed multinomial models are comparable.</p>
<p>DECISION: Report bayesian model, because for some reason the visualization of the marginal predictions is actually working?</p>
</section>
<section id="todo" class="level5">
<h5 class="anchored" data-anchor-id="todo">TODO</h5>
<ul>
<li>priors? used default flat priors… ok?</li>
<li>posterior predictive checks</li>
<li>diagnostics on random effects</li>
<li>reconcilliation of mblogit() vs brms versions of the model; seems like they should yield similar estimates</li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb795"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb795-1"><a href="#cb795-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb795-2"><a href="#cb795-2" aria-hidden="true" tabindex="-1"></a><span class="co">#df &lt;- df_items %&gt;% filter(q %nin% c(1,2,3,4,5,6,9)) %&gt;% filter(term=="spring18")</span></span>
<span id="cb795-3"><a href="#cb795-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mm1 &lt;- brm( state ~ condition + (1|subject), data = df, family = "categorical", </span></span>
<span id="cb795-4"><a href="#cb795-4" aria-hidden="true" tabindex="-1"></a><span class="co"># file = "analysis/models/sgc3a_brms_mixedcat_teststate.rds" # cache model (can be removed)))</span></span>
<span id="cb795-5"><a href="#cb795-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm1)</span></span>
<span id="cb795-6"><a href="#cb795-6" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(mm1)</span></span>
<span id="cb795-7"><a href="#cb795-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mm1)</span></span>
<span id="cb795-8"><a href="#cb795-8" aria-hidden="true" tabindex="-1"></a><span class="co"># #report(mm1)</span></span>
<span id="cb795-9"><a href="#cb795-9" aria-hidden="true" tabindex="-1"></a><span class="co"># #check_posterior_predictions(mm1, draws=100)</span></span>
<span id="cb795-10"><a href="#cb795-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(bayesplot)</span></span>
<span id="cb795-11"><a href="#cb795-11" aria-hidden="true" tabindex="-1"></a><span class="co"># library(bayestestR)</span></span>
<span id="cb795-12"><a href="#cb795-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(mm1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="wip-unknown" class="level2">
<h2 class="anchored" data-anchor-id="wip-unknown">WIP UNKNOWN</h2>
<section id="cummulative-ordinal-bayesian-equal-variance" class="level3">
<h3 class="anchored" data-anchor-id="cummulative-ordinal-bayesian-equal-variance">Cummulative Ordinal (Bayesian) — Equal Variance</h3>
<p>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb796"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb796-1"><a href="#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb796-2"><a href="#cb796-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-3"><a href="#cb796-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-4"><a href="#cb796-4" aria-hidden="true" tabindex="-1"></a><span class="co">#DEFINE DATA </span></span>
<span id="cb796-5"><a href="#cb796-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb796-6"><a href="#cb796-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb796-7"><a href="#cb796-7" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: why is this probit instead of logit?</span></span>
<span id="cb796-8"><a href="#cb796-8" aria-hidden="true" tabindex="-1"></a>cumord <span class="ot">&lt;-</span> <span class="fu">brm</span>( <span class="at">formula =</span> state <span class="sc">~</span> condition,</span>
<span id="cb796-9"><a href="#cb796-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb796-10"><a href="#cb796-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"probit"</span>),</span>
<span id="cb796-11"><a href="#cb796-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/utils/models/sgc3a_brms_cumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb796-12"><a href="#cb796-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb796-13"><a href="#cb796-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-14"><a href="#cb796-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = probit; disc = identity 
Formula: state ~ condition 
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]         0.76      0.19     0.40     1.14 1.00     2783     2309
Intercept[2]         1.22      0.20     0.84     1.62 1.00     3000     2548
conditionimpasse     1.11      0.24     0.66     1.58 1.00     2746     2646

Family Specific Parameters: 
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb798"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb798-1"><a href="#cb798-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb799"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb799-1"><a href="#cb799-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT</span></span>
<span id="cb799-2"><a href="#cb799-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-96-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb800"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb800-1"><a href="#cb800-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-96-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb801"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb801-1"><a href="#cb801-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(cumord))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.77). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-96-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb803"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb803-1"><a href="#cb803-1" aria-hidden="true" tabindex="-1"></a><span class="co">#REPORT</span></span>
<span id="cb803-2"><a href="#cb803-2" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.77). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.77). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL '3a68d5685b54180e73711b90f350310a' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 4.6e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.46 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.1086 seconds (Warm-up)
Chain 1:                0.113045 seconds (Sampling)
Chain 1:                0.221645 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL '3a68d5685b54180e73711b90f350310a' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 2.2e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.22 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.105244 seconds (Warm-up)
Chain 2:                0.104371 seconds (Sampling)
Chain 2:                0.209615 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL '3a68d5685b54180e73711b90f350310a' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 2.2e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.22 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.109792 seconds (Warm-up)
Chain 3:                0.099752 seconds (Sampling)
Chain 3:                0.209544 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL '3a68d5685b54180e73711b90f350310a' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 2.1e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.21 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.105463 seconds (Warm-up)
Chain 4:                0.114799 seconds (Sampling)
Chain 4:                0.220262 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.77). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ condition). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50) and uniform (location = , scale = ) distributions. The model's explanatory power is moderate (R2 = 0.18, 95% CI [0.07, 0.28]).  Within this model:

  - The effect of b Intercept[1] (Median = 0.75, 95% CI [0.40, 1.14]) has a 100.00% probability of being positive (&gt; 0), 99.98% of being significant (&gt; 0.05), and 99.35% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 0.999) and the indices are reliable (ESS = 2725)
  - The effect of b Intercept[2] (Median = 1.22, 95% CI [0.84, 1.62]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 2723)
  - The effect of b conditionimpasse (Median = 1.11, 95% CI [0.66, 1.58]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 99.92% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 3047)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb813"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb813-1"><a href="#cb813-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum %&gt;%</span></span>
<span id="cb813-2"><a href="#cb813-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb813-3"><a href="#cb813-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb813-4"><a href="#cb813-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb813-5"><a href="#cb813-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb813-6"><a href="#cb813-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb813-7"><a href="#cb813-7" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(cumord)</span></span>
<span id="cb813-8"><a href="#cb813-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(cumord)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cummulative-ordinal-bayesian-unequal-variance" class="level3">
<h3 class="anchored" data-anchor-id="cummulative-ordinal-bayesian-unequal-variance">Cummulative Ordinal (Bayesian) — Unequal Variance</h3>
<p>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb814"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb814-1"><a href="#cb814-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb814-2"><a href="#cb814-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-3"><a href="#cb814-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-4"><a href="#cb814-4" aria-hidden="true" tabindex="-1"></a><span class="co">#DEFINE DATA </span></span>
<span id="cb814-5"><a href="#cb814-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb814-6"><a href="#cb814-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb814-7"><a href="#cb814-7" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: why is this probit instead of logit?</span></span>
<span id="cb814-8"><a href="#cb814-8" aria-hidden="true" tabindex="-1"></a>u.cumord <span class="ot">&lt;-</span> <span class="fu">brm</span>( </span>
<span id="cb814-9"><a href="#cb814-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(state <span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb814-10"><a href="#cb814-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">lf</span>(disc <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> condition, <span class="at">cmc =</span> <span class="cn">FALSE</span>),</span>
<span id="cb814-11"><a href="#cb814-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb814-12"><a href="#cb814-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"probit"</span>),</span>
<span id="cb814-13"><a href="#cb814-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/utils/models/sgc3a_brms_ucumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb814-14"><a href="#cb814-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb814-15"><a href="#cb814-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-16"><a href="#cb814-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(u.cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 76 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = probit; disc = log 
Formula: state ~ condition 
         disc ~ 0 + condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept[1]              0.83      0.18     0.48     1.19 1.00     1294
Intercept[2]              1.00      0.19     0.66     1.38 1.01     1236
conditionimpasse          0.95      0.19     0.60     1.32 1.01     1325
disc_conditionimpasse     1.48      0.56     0.41     2.64 1.01      302
                      Tail_ESS
Intercept[1]              1484
Intercept[2]              1540
conditionimpasse          1717
disc_conditionimpasse      142

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb817"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb817-1"><a href="#cb817-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(u.cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb818"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb818-1"><a href="#cb818-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT</span></span>
<span id="cb818-2"><a href="#cb818-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(u.cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-97-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb819"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb819-1"><a href="#cb819-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(u.cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-97-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb820"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb820-1"><a href="#cb820-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(u.cumord))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-97-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb821"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb821-1"><a href="#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="co">#REPORT</span></span>
<span id="cb821-2"><a href="#cb821-2" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(u.cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL '8051b427c5dbb5a865c588f34a9e215a' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 5.4e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.54 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.411163 seconds (Warm-up)
Chain 1:                0.703376 seconds (Sampling)
Chain 1:                1.11454 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL '8051b427c5dbb5a865c588f34a9e215a' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 2.8e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.28 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.411694 seconds (Warm-up)
Chain 2:                0.347564 seconds (Sampling)
Chain 2:                0.759258 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL '8051b427c5dbb5a865c588f34a9e215a' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 2.7e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.27 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.437053 seconds (Warm-up)
Chain 3:                0.393101 seconds (Sampling)
Chain 3:                0.830154 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL '8051b427c5dbb5a865c588f34a9e215a' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 2.8e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.28 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.446784 seconds (Warm-up)
Chain 4:                0.477258 seconds (Sampling)
Chain 4:                0.924042 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ condition). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ) and uniform (location = , scale = ) distributions. The model's explanatory power is moderate (R2 = 0.17, 95% CI [0.06, 0.26]).  Within this model:

  - The effect of b Intercept[1] (Median = 0.83, 95% CI [0.48, 1.19]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 99.92% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.006) and the indices are reliable (ESS = 1320)
  - The effect of b Intercept[2] (Median = 1.00, 95% CI [0.66, 1.38]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.006) but the indices are unreliable (ESS = 312)
  - The effect of b conditionimpasse (Median = 0.94, 95% CI [0.60, 1.32]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.003) and the indices are reliable (ESS = 1284)
  - The effect of b disc conditionimpasse (Median = 1.45, 95% CI [0.41, 2.64]) has a 99.78% probability of being positive (&gt; 0), 99.72% of being significant (&gt; 0.05), and 98.45% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.006) and the indices are reliable (ESS = 1238)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb828"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb828-1"><a href="#cb828-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum %&gt;%</span></span>
<span id="cb828-2"><a href="#cb828-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb828-3"><a href="#cb828-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb828-4"><a href="#cb828-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb828-5"><a href="#cb828-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb828-6"><a href="#cb828-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb828-7"><a href="#cb828-7" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(cumord)</span></span>
<span id="cb828-8"><a href="#cb828-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(cumord)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In brms, the parameter related to latent variances is called disc (short for “discrimination”), following conventions in item response theory. Note that disc is not the variance itself, but the inverse of the standard deviation, s. That is, s = 1/disc. Further, because disc must be strictly positive, it is by default modeled on the log scale.</p>
</section>
<section id="adjacent-category-ordinal-bayesian" class="level3">
<h3 class="anchored" data-anchor-id="adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb829"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb829-1"><a href="#cb829-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb829-2"><a href="#cb829-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb829-3"><a href="#cb829-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb829-4"><a href="#cb829-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span></span>
<span id="cb829-5"><a href="#cb829-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb829-6"><a href="#cb829-6" aria-hidden="true" tabindex="-1"></a>adjcat <span class="ot">&lt;-</span> <span class="fu">brm</span>( <span class="at">formula =</span> state <span class="sc">~</span> <span class="fu">cs</span>(condition),</span>
<span id="cb829-7"><a href="#cb829-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb829-8"><a href="#cb829-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">acat</span>(<span class="st">"probit"</span>),</span>
<span id="cb829-9"><a href="#cb829-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/utils/models/sgc3a_brms_adjcat_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb829-10"><a href="#cb829-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb829-11"><a href="#cb829-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb829-12"><a href="#cb829-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adjcat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: acat 
  Links: mu = probit; disc = identity 
Formula: state ~ cs(condition) 
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]            2.01      0.38     1.36     2.88 1.00      639      551
Intercept[2]           -1.29      0.49    -2.36    -0.41 1.00      614      579
conditionimpasse[1]     1.95      0.43     1.16     2.90 1.00      674      589
conditionimpasse[2]    -1.06      0.53    -2.20    -0.11 1.00      586      604

Family Specific Parameters: 
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb831"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb831-1"><a href="#cb831-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb832"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb832-1"><a href="#cb832-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(adjcat, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-98-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb833"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb833-1"><a href="#cb833-1" aria-hidden="true" tabindex="-1"></a><span class="co">#WHICH IS BETTER? cumulative or adjacent?</span></span>
<span id="cb833-2"><a href="#cb833-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(cumord, adjcat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.

Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A `range` must be provided for data with only one unique value.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-98-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb836"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb836-1"><a href="#cb836-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(cumord, adjcat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name   |   Model |     ELPD | ELPD_SE |   LOOIC | LOOIC weights | LOOIC_SE |    WAIC | WAIC weights |    R2 | Sigma
-------------------------------------------------------------------------------------------------------------------
cumord | brmsfit | -113.736 |   7.542 | 227.471 |         0.071 |   15.085 | 227.450 |        0.002 | 0.178 | 1.000
adjcat | brmsfit | -107.521 |   7.199 | 215.042 |         0.929 |   14.397 | 214.897 |        0.998 | 0.171 | 1.000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb840"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb840-1"><a href="#cb840-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #TIDYBAYES VISUALIZATION</span></span>
<span id="cb840-2"><a href="#cb840-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidybayes)</span></span>
<span id="cb840-3"><a href="#cb840-3" aria-hidden="true" tabindex="-1"></a><span class="co"># adjcat %&gt;%</span></span>
<span id="cb840-4"><a href="#cb840-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb840-5"><a href="#cb840-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb840-6"><a href="#cb840-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb840-7"><a href="#cb840-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb840-8"><a href="#cb840-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb840-9"><a href="#cb840-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-98-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb841"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb841-1"><a href="#cb841-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(adjcat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-98-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb842"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb842-1"><a href="#cb842-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(adjcat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.83), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.86). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.83), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.86). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'ebf0c4c0e51ade2b00ca4594e215d3ad' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.00013 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.3 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1.4692 seconds (Warm-up)
Chain 1:                1.52447 seconds (Sampling)
Chain 1:                2.99367 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'ebf0c4c0e51ade2b00ca4594e215d3ad' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.0001 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 1 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 1.47894 seconds (Warm-up)
Chain 2:                1.65949 seconds (Sampling)
Chain 2:                3.13843 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'ebf0c4c0e51ade2b00ca4594e215d3ad' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.000101 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 1.01 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 1.53116 seconds (Warm-up)
Chain 3:                1.32642 seconds (Sampling)
Chain 3:                2.85758 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'ebf0c4c0e51ade2b00ca4594e215d3ad' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.000101 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 1.01 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 1.51764 seconds (Warm-up)
Chain 4:                1.46146 seconds (Sampling)
Chain 4:                2.9791 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.82), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.87). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ cs(condition)). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), NA (NA) and NA (NA) distributions. The model's explanatory power is moderate (R2 = 0.17, 95% CI [0.07, 0.27]).  Within this model:

  - The effect of b Intercept[1] (Median = 1.97, 95% CI [1.36, 2.88]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.005) but the indices are unreliable (ESS = 580)
  - The effect of b Intercept[2] (Median = -1.25, 95% CI [-2.36, -0.41]) has a 99.85% probability of being negative (&lt; 0), 99.83% of being significant (&lt; -0.05), and 98.78% of being large (&lt; -0.30). The estimation successfully converged (Rhat = 1.005) but the indices are unreliable (ESS = 577)
  - The effect of bcs conditionimpasse[1] (Median = 1.92, 95% CI [1.16, 2.90]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.004) but the indices are unreliable (ESS = 629)
  - The effect of bcs conditionimpasse[2] (Median = -1.02, 95% CI [-2.20, -0.11]) has a 98.40% probability of being negative (&lt; 0), 98.05% of being significant (&lt; -0.05), and 93.62% of being large (&lt; -0.30). The estimation successfully converged (Rhat = 1.005) but the indices are unreliable (ESS = 560)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
</div>
<p><em>Converges, but estimates are unreliable?</em></p>
</section>
</section>
<section id="helpers" class="level2">
<h2 class="anchored" data-anchor-id="helpers">HELPERS</h2>
<section id="odds-and-probabilities" class="level3">
<h3 class="anchored" data-anchor-id="odds-and-probabilities">Odds and Probabilities</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb852"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb852-1"><a href="#cb852-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t &lt;- table( df$pretty_condition, df$accuracy)</span></span>
<span id="cb852-2"><a href="#cb852-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb852-3"><a href="#cb852-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print("AS FREQUENCY")</span></span>
<span id="cb852-4"><a href="#cb852-4" aria-hidden="true" tabindex="-1"></a><span class="co"># t %&gt;% addmargins()</span></span>
<span id="cb852-5"><a href="#cb852-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb852-6"><a href="#cb852-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print("AS PROBABILITY")</span></span>
<span id="cb852-7"><a href="#cb852-7" aria-hidden="true" tabindex="-1"></a><span class="co"># prop.table(t) %&gt;% addmargins()</span></span>
<span id="cb852-8"><a href="#cb852-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb852-9"><a href="#cb852-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print("GRAND PROBABILITY")</span></span>
<span id="cb852-10"><a href="#cb852-10" aria-hidden="true" tabindex="-1"></a><span class="co"># (p_grand &lt;-  sum(t[,2]) / sum(t))</span></span>
<span id="cb852-11"><a href="#cb852-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print("GRAND ODDS")</span></span>
<span id="cb852-12"><a href="#cb852-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (odds_grand &lt;- sum(t[,2]) / sum(t[,1]))</span></span>
<span id="cb852-13"><a href="#cb852-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb852-14"><a href="#cb852-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print("P_control")</span></span>
<span id="cb852-15"><a href="#cb852-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (p_control &lt;- t[1,2]/sum(t[1,]))</span></span>
<span id="cb852-16"><a href="#cb852-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print("ODDS_control") # correct:incorrect</span></span>
<span id="cb852-17"><a href="#cb852-17" aria-hidden="true" tabindex="-1"></a><span class="co"># (odds_control &lt;- t[1,2] / t[1,1])</span></span>
<span id="cb852-18"><a href="#cb852-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb852-19"><a href="#cb852-19" aria-hidden="true" tabindex="-1"></a><span class="co"># print("P_impasse")</span></span>
<span id="cb852-20"><a href="#cb852-20" aria-hidden="true" tabindex="-1"></a><span class="co"># (p_impasse &lt;- t[2,2] / sum(t[2,]))</span></span>
<span id="cb852-21"><a href="#cb852-21" aria-hidden="true" tabindex="-1"></a><span class="co"># print("ODDS_impasse") # correct:incorrect</span></span>
<span id="cb852-22"><a href="#cb852-22" aria-hidden="true" tabindex="-1"></a><span class="co"># (odds_impasse &lt;- t[2,2] / t[2,1])</span></span>
<span id="cb852-23"><a href="#cb852-23" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb852-24"><a href="#cb852-24" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("ODDS RATIO FOR IMPASSE", odds_impasse-odds_control)</span></span>
<span id="cb852-25"><a href="#cb852-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb852-26"><a href="#cb852-26" aria-hidden="true" tabindex="-1"></a><span class="co"># to calculate odds from odds ratio ... ODDS = OR * [denominator of ratio]</span></span>
<span id="cb852-27"><a href="#cb852-27" aria-hidden="true" tabindex="-1"></a><span class="co">#eg.  ODDS [impasse] = OR[impasse] * ODDS[control] = [b_impasse] * [intercept] #for dummy coding </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="ggdist-bayesian-posterior-vis" class="level2">
<h2 class="anchored" data-anchor-id="ggdist-bayesian-posterior-vis">GGDist bayesian posterior vis</h2>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb853"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb853-1"><a href="#cb853-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_i %&gt;% filter(q %nin% c(6,9)) %&gt;% droplevels()</span></span>
<span id="cb853-2"><a href="#cb853-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-3"><a href="#cb853-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #WORKING visualize post dist of prediction</span></span>
<span id="cb853-4"><a href="#cb853-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #create df of 'draws' from the </span></span>
<span id="cb853-5"><a href="#cb853-5" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df %&gt;%</span></span>
<span id="cb853-6"><a href="#cb853-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb853-7"><a href="#cb853-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_predicted_draws(Bmm.CrSQ) </span></span>
<span id="cb853-8"><a href="#cb853-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-9"><a href="#cb853-9" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb853-10"><a href="#cb853-10" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- draws %&gt;% </span></span>
<span id="cb853-11"><a href="#cb853-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .prediction, y = pretty_condition)) +</span></span>
<span id="cb853-12"><a href="#cb853-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab() + labs(title = "Posterior Predictions??")</span></span>
<span id="cb853-13"><a href="#cb853-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb853-14"><a href="#cb853-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-15"><a href="#cb853-15" aria-hidden="true" tabindex="-1"></a><span class="co"># #WORKING visualize parameter distribution?</span></span>
<span id="cb853-16"><a href="#cb853-16" aria-hidden="true" tabindex="-1"></a><span class="co"># #create df of 'draws' from the </span></span>
<span id="cb853-17"><a href="#cb853-17" aria-hidden="true" tabindex="-1"></a><span class="co"># draws2 &lt;- df %&gt;%</span></span>
<span id="cb853-18"><a href="#cb853-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb853-19"><a href="#cb853-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_linpred_draws(Bmm.CrSQ,</span></span>
<span id="cb853-20"><a href="#cb853-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                       re_formula = NA) %&gt;%     # zero out random effects (condition on average subj avg q)) %&gt;% </span></span>
<span id="cb853-21"><a href="#cb853-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() </span></span>
<span id="cb853-22"><a href="#cb853-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(!duplicated(.)) </span></span>
<span id="cb853-23"><a href="#cb853-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   # mutate(probs = exp(.prediction)/(1+ exp(.prediction)))</span></span>
<span id="cb853-24"><a href="#cb853-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-25"><a href="#cb853-25" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb853-26"><a href="#cb853-26" aria-hidden="true" tabindex="-1"></a><span class="co"># draws2 %&gt;% </span></span>
<span id="cb853-27"><a href="#cb853-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .linpred, y = pretty_condition)) +</span></span>
<span id="cb853-28"><a href="#cb853-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab()</span></span>
<span id="cb853-29"><a href="#cb853-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-30"><a href="#cb853-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-31"><a href="#cb853-31" aria-hidden="true" tabindex="-1"></a><span class="co"># #WORKING visualize posterior distribution as probabilities?</span></span>
<span id="cb853-32"><a href="#cb853-32" aria-hidden="true" tabindex="-1"></a><span class="co"># #create df of 'draws' from the </span></span>
<span id="cb853-33"><a href="#cb853-33" aria-hidden="true" tabindex="-1"></a><span class="co"># draws2 &lt;- df %&gt;%</span></span>
<span id="cb853-34"><a href="#cb853-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb853-35"><a href="#cb853-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_epred_draws(Bmm.CrSQ,</span></span>
<span id="cb853-36"><a href="#cb853-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb853-37"><a href="#cb853-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                 </span></span>
<span id="cb853-38"><a href="#cb853-38" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb853-39"><a href="#cb853-39" aria-hidden="true" tabindex="-1"></a><span class="co"># draws2 %&gt;% </span></span>
<span id="cb853-40"><a href="#cb853-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .epred, y = pretty_condition)) +</span></span>
<span id="cb853-41"><a href="#cb853-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab()</span></span>
<span id="cb853-42"><a href="#cb853-42" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-43"><a href="#cb853-43" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-44"><a href="#cb853-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-45"><a href="#cb853-45" aria-hidden="true" tabindex="-1"></a><span class="co"># #WORKING visualize posterior distribution as probabilities?</span></span>
<span id="cb853-46"><a href="#cb853-46" aria-hidden="true" tabindex="-1"></a><span class="co"># #create df of 'draws' from the </span></span>
<span id="cb853-47"><a href="#cb853-47" aria-hidden="true" tabindex="-1"></a><span class="co"># draws3 &lt;- df %&gt;%</span></span>
<span id="cb853-48"><a href="#cb853-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb853-49"><a href="#cb853-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.CrSQ,</span></span>
<span id="cb853-50"><a href="#cb853-50" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # scale = "linear", without scale linear, .value is probability of %</span></span>
<span id="cb853-51"><a href="#cb853-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA) %&gt;% </span></span>
<span id="cb853-52"><a href="#cb853-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() </span></span>
<span id="cb853-53"><a href="#cb853-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(!duplicated(.)) </span></span>
<span id="cb853-54"><a href="#cb853-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   # mutate(probs = exp(.value)/(1+ exp(.value))) #same as scale = linear and doing the transformation manually</span></span>
<span id="cb853-55"><a href="#cb853-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-56"><a href="#cb853-56" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb853-57"><a href="#cb853-57" aria-hidden="true" tabindex="-1"></a><span class="co"># draws3 %&gt;% </span></span>
<span id="cb853-58"><a href="#cb853-58" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .value, y = pretty_condition)) +</span></span>
<span id="cb853-59"><a href="#cb853-59" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab() </span></span>
<span id="cb853-60"><a href="#cb853-60" aria-hidden="true" tabindex="-1"></a><span class="co"># #x = .value plots the distribution of the ODDS ratios?</span></span>
<span id="cb853-61"><a href="#cb853-61" aria-hidden="true" tabindex="-1"></a><span class="co"># #without the scale = linear... gives probabilities of correct response?</span></span>
<span id="cb853-62"><a href="#cb853-62" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-63"><a href="#cb853-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-64"><a href="#cb853-64" aria-hidden="true" tabindex="-1"></a><span class="co"># THE GOOD ONE</span></span>
<span id="cb853-65"><a href="#cb853-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb853-66"><a href="#cb853-66" aria-hidden="true" tabindex="-1"></a><span class="do">##WORKING</span></span>
<span id="cb853-67"><a href="#cb853-67" aria-hidden="true" tabindex="-1"></a><span class="do">## VIS probability of correct response</span></span>
<span id="cb853-68"><a href="#cb853-68" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df %&gt;%</span></span>
<span id="cb853-69"><a href="#cb853-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb853-70"><a href="#cb853-70" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_linpred_draws(Bmm.CrSQ,</span></span>
<span id="cb853-71"><a href="#cb853-71" aria-hidden="true" tabindex="-1"></a><span class="co">#                    transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb853-72"><a href="#cb853-72" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA) </span></span>
<span id="cb853-73"><a href="#cb853-73" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-74"><a href="#cb853-74" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb853-75"><a href="#cb853-75" aria-hidden="true" tabindex="-1"></a><span class="co"># #TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb853-76"><a href="#cb853-76" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;%  </span></span>
<span id="cb853-77"><a href="#cb853-77" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .linpred,  y = 0, fill = pretty_condition)) +</span></span>
<span id="cb853-78"><a href="#cb853-78" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye(width = c(.95), alpha = 0.5) + </span></span>
<span id="cb853-79"><a href="#cb853-79" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim(0,1) + labs(</span></span>
<span id="cb853-80"><a href="#cb853-80" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Predicted Probability of Correct Response",</span></span>
<span id="cb853-81"><a href="#cb853-81" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "probability of correct response",</span></span>
<span id="cb853-82"><a href="#cb853-82" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "condition"</span></span>
<span id="cb853-83"><a href="#cb853-83" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +  theme_clean() + ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb853-84"><a href="#cb853-84" aria-hidden="true" tabindex="-1"></a><span class="co"># #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb853-85"><a href="#cb853-85" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb853-86"><a href="#cb853-86" aria-hidden="true" tabindex="-1"></a><span class="co"># #equivalent to...this! </span></span>
<span id="cb853-87"><a href="#cb853-87" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot_model(Bmm.CrSQ, type  = "pred")[[1]]+ylim(0,1) + coord_flip()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../analysis/utils/scoring.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Scoring Strategy</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb854" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb854-1"><a href="#cb854-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb854-2"><a href="#cb854-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'SGCX | Modelling Reference'</span></span>
<span id="cb854-3"><a href="#cb854-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb854-4"><a href="#cb854-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-5"><a href="#cb854-5" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb854-6"><a href="#cb854-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-7"><a href="#cb854-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modelling Reference {#modelling .unnumbered}</span></span>
<span id="cb854-8"><a href="#cb854-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-9"><a href="#cb854-9" aria-hidden="true" tabindex="-1"></a>**In this notebook we use data from study SGC3A to explore different modelling techniques and assess their suitability for the bimodal accuracy distributions in the SGC project data.**</span>
<span id="cb854-10"><a href="#cb854-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-13"><a href="#cb854-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-14"><a href="#cb854-14" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb854-15"><a href="#cb854-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb854-16"><a href="#cb854-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb854-17"><a href="#cb854-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-18"><a href="#cb854-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb854-19"><a href="#cb854-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools) <span class="co">#misc helpers </span></span>
<span id="cb854-20"><a href="#cb854-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-21"><a href="#cb854-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#arrange plots</span></span>
<span id="cb854-22"><a href="#cb854-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange shift function plots</span></span>
<span id="cb854-23"><a href="#cb854-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb854-24"><a href="#cb854-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd) <span class="co">#mosaic plots</span></span>
<span id="cb854-25"><a href="#cb854-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra) <span class="co">#mosaic plots</span></span>
<span id="cb854-26"><a href="#cb854-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables </span></span>
<span id="cb854-27"><a href="#cb854-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb854-28"><a href="#cb854-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy) <span class="co">#the way it should be</span></span>
<span id="cb854-29"><a href="#cb854-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions) <span class="co">#expressions to add to plots</span></span>
<span id="cb854-30"><a href="#cb854-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with expressions</span></span>
<span id="cb854-31"><a href="#cb854-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz </span></span>
<span id="cb854-32"><a href="#cb854-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects) <span class="co">#visualization log regr models</span></span>
<span id="cb854-33"><a href="#cb854-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#tables</span></span>
<span id="cb854-34"><a href="#cb854-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy models</span></span>
<span id="cb854-35"><a href="#cb854-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed and mixture models</span></span>
<span id="cb854-36"><a href="#cb854-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-37"><a href="#cb854-37" aria-hidden="true" tabindex="-1"></a><span class="co">#misc utilities</span></span>
<span id="cb854-38"><a href="#cb854-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb854-39"><a href="#cb854-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb854-40"><a href="#cb854-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb854-41"><a href="#cb854-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb854-42"><a href="#cb854-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb854-43"><a href="#cb854-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb854-44"><a href="#cb854-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#viz and compare models</span></span>
<span id="cb854-45"><a href="#cb854-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic) <span class="co">#extract model equation</span></span>
<span id="cb854-46"><a href="#cb854-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr) <span class="co">#power analyses</span></span>
<span id="cb854-47"><a href="#cb854-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-48"><a href="#cb854-48" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling</span></span>
<span id="cb854-49"><a href="#cb854-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix) <span class="co">#helpful basic stats &amp; non parametrics</span></span>
<span id="cb854-50"><a href="#cb854-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WRS2) <span class="co">#robust and nonparametric tests </span></span>
<span id="cb854-51"><a href="#cb854-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb854-52"><a href="#cb854-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr) <span class="co">#confint on qq plot</span></span>
<span id="cb854-53"><a href="#cb854-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels) <span class="co">#contingency table and CHISQR</span></span>
<span id="cb854-54"><a href="#cb854-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zeroinfl / hurdle models </span></span>
<span id="cb854-55"><a href="#cb854-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models </span></span>
<span id="cb854-56"><a href="#cb854-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal) <span class="co">#ordinal regression</span></span>
<span id="cb854-57"><a href="#cb854-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># polyr ordinal regression</span></span>
<span id="cb854-58"><a href="#cb854-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM) <span class="co">#censored, zero infl, etc</span></span>
<span id="cb854-59"><a href="#cb854-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brant) <span class="co">#brant test for ordinal regression</span></span>
<span id="cb854-60"><a href="#cb854-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression </span></span>
<span id="cb854-61"><a href="#cb854-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#multinomial logistic regression</span></span>
<span id="cb854-62"><a href="#cb854-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb854-63"><a href="#cb854-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-64"><a href="#cb854-64" aria-hidden="true" tabindex="-1"></a><span class="co">#one package to rule them all</span></span>
<span id="cb854-65"><a href="#cb854-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb854-66"><a href="#cb854-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-67"><a href="#cb854-67" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb854-68"><a href="#cb854-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb854-69"><a href="#cb854-69" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb854-70"><a href="#cb854-70" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb854-71"><a href="#cb854-71" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb854-72"><a href="#cb854-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-73"><a href="#cb854-73" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb854-74"><a href="#cb854-74" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>()) </span>
<span id="cb854-75"><a href="#cb854-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-76"><a href="#cb854-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-77"><a href="#cb854-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-80"><a href="#cb854-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-81"><a href="#cb854-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb854-82"><a href="#cb854-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb854-83"><a href="#cb854-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb854-84"><a href="#cb854-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-85"><a href="#cb854-85" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb854-86"><a href="#cb854-86" aria-hidden="true" tabindex="-1"></a><span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb854-87"><a href="#cb854-87" aria-hidden="true" tabindex="-1"></a><span class="co">#mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb854-88"><a href="#cb854-88" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(mbp)</span></span>
<span id="cb854-89"><a href="#cb854-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-90"><a href="#cb854-90" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb854-91"><a href="#cb854-91" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items_LAB.rds'</span>)</span>
<span id="cb854-92"><a href="#cb854-92" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants_LAB.rds'</span>)</span>
<span id="cb854-93"><a href="#cb854-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-94"><a href="#cb854-94" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb854-95"><a href="#cb854-95" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb854-96"><a href="#cb854-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_score =</span> item_test_NABS,</span>
<span id="cb854-97"><a href="#cb854-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_condition =</span> condition,</span>
<span id="cb854-98"><a href="#cb854-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> pretty_condition</span>
<span id="cb854-99"><a href="#cb854-99" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-100"><a href="#cb854-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-101"><a href="#cb854-101" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb854-102"><a href="#cb854-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb854-103"><a href="#cb854-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaled =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orth"</span>, <span class="st">"-0.5"</span><span class="ot">=</span><span class="st">"unknown"</span>,<span class="st">"0"</span><span class="ot">=</span><span class="st">"uncertain"</span>,<span class="st">"0.5"</span><span class="ot">=</span><span class="st">"lines"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"tri"</span>),</span>
<span id="cb854-104"><a href="#cb854-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaled =</span> <span class="fu">as.ordered</span>(scaled),</span>
<span id="cb854-105"><a href="#cb854-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_condition =</span> condition,</span>
<span id="cb854-106"><a href="#cb854-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> pretty_condition,</span>
<span id="cb854-107"><a href="#cb854-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb854-108"><a href="#cb854-108" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orth-like"</span>,</span>
<span id="cb854-109"><a href="#cb854-109" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"unknown"</span>,</span>
<span id="cb854-110"><a href="#cb854-110" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"unknown"</span>,</span>
<span id="cb854-111"><a href="#cb854-111" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>,</span>
<span id="cb854-112"><a href="#cb854-112" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>),</span>
<span id="cb854-113"><a href="#cb854-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">as.ordered</span>(state)</span>
<span id="cb854-114"><a href="#cb854-114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-115"><a href="#cb854-115" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 group ordered STATE variable</span></span>
<span id="cb854-116"><a href="#cb854-116" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 group ordered SCALED variable [matches high_interpretation]</span></span>
<span id="cb854-117"><a href="#cb854-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-118"><a href="#cb854-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-119"><a href="#cb854-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-120"><a href="#cb854-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-121"><a href="#cb854-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-122"><a href="#cb854-122" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>test-equivalents of GLM models: https://rpubs.com/palday/glm-test</span>
<span id="cb854-123"><a href="#cb854-123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>models as test :https://lindeloev.github.io/tests-as-linear/</span>
<span id="cb854-124"><a href="#cb854-124" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>GLM REFERENCE http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#predictions-andor-confidence-or-prediction-intervals-on-predictions</span>
<span id="cb854-125"><a href="#cb854-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-126"><a href="#cb854-126" aria-hidden="true" tabindex="-1"></a><span class="fu"># INDEPENDENT SAMPLES</span></span>
<span id="cb854-127"><a href="#cb854-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-128"><a href="#cb854-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-129"><a href="#cb854-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## CONTINUOUS OUTCOME</span></span>
<span id="cb854-130"><a href="#cb854-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-131"><a href="#cb854-131" aria-hidden="true" tabindex="-1"></a>**Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?\</span>
<span id="cb854-132"><a href="#cb854-132" aria-hidden="true" tabindex="-1"></a>(# questions correct on test phase of task, <span class="sc">\[</span>in lab<span class="sc">\]</span> participants)**</span>
<span id="cb854-133"><a href="#cb854-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-134"><a href="#cb854-134" aria-hidden="true" tabindex="-1"></a>*(Can also be transformed to proportion or percentage).*</span>
<span id="cb854-135"><a href="#cb854-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-138"><a href="#cb854-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-139"><a href="#cb854-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-IND-TESTSCORE</span></span>
<span id="cb854-140"><a href="#cb854-140" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb854-141"><a href="#cb854-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb854-142"><a href="#cb854-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-143"><a href="#cb854-143" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::SETUP DATA</span></span>
<span id="cb854-144"><a href="#cb854-144" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb854-145"><a href="#cb854-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-146"><a href="#cb854-146" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb854-147"><a href="#cb854-147" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb854-148"><a href="#cb854-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-149"><a href="#cb854-149" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb854-150"><a href="#cb854-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-151"><a href="#cb854-151" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | FACETED HISTOGRAM</span></span>
<span id="cb854-152"><a href="#cb854-152" aria-hidden="true" tabindex="-1"></a><span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span></span>
<span id="cb854-153"><a href="#cb854-153" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~item_test_NABS, </span></span>
<span id="cb854-154"><a href="#cb854-154" aria-hidden="true" tabindex="-1"></a><span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span></span>
<span id="cb854-155"><a href="#cb854-155" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span></span>
<span id="cb854-156"><a href="#cb854-156" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span></span>
<span id="cb854-157"><a href="#cb854-157" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "# Correct",</span></span>
<span id="cb854-158"><a href="#cb854-158" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "proportion of subjects",</span></span>
<span id="cb854-159"><a href="#cb854-159" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span></span>
<span id="cb854-160"><a href="#cb854-160" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "") + theme(legend.position = "blank")</span></span>
<span id="cb854-161"><a href="#cb854-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-162"><a href="#cb854-162" aria-hidden="true" tabindex="-1"></a><span class="do">##GGPUBR | HIST+DENSITY SCORE </span></span>
<span id="cb854-163"><a href="#cb854-163" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">gghistogram</span>(df, <span class="at">x =</span> <span class="st">"test_score"</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb854-164"><a href="#cb854-164" aria-hidden="true" tabindex="-1"></a>   <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-165"><a href="#cb854-165" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill =</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span></span>
<span id="cb854-166"><a href="#cb854-166" aria-hidden="true" tabindex="-1"></a>   <span class="at">add_density =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-167"><a href="#cb854-167" aria-hidden="true" tabindex="-1"></a><span class="fu">facet</span>(p, <span class="at">facet.by=</span><span class="fu">c</span>(<span class="st">"condition"</span>)) <span class="sc">+</span></span>
<span id="cb854-168"><a href="#cb854-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score"</span>,</span>
<span id="cb854-169"><a href="#cb854-169" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,</span>
<span id="cb854-170"><a href="#cb854-170" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, <span class="at">y =</span> <span class="st">"number of subjects"</span>) <span class="sc">+</span></span>
<span id="cb854-171"><a href="#cb854-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb854-172"><a href="#cb854-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-173"><a href="#cb854-173" aria-hidden="true" tabindex="-1"></a><span class="do">##VERTICAL RAINCLOUD USING GGDISTR</span></span>
<span id="cb854-174"><a href="#cb854-174" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> test_score,</span>
<span id="cb854-175"><a href="#cb854-175" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> condition) ) <span class="sc">+</span> </span>
<span id="cb854-176"><a href="#cb854-176" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb854-177"><a href="#cb854-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>,</span>
<span id="cb854-178"><a href="#cb854-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb854-179"><a href="#cb854-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>, </span>
<span id="cb854-180"><a href="#cb854-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb854-181"><a href="#cb854-181" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span> </span>
<span id="cb854-182"><a href="#cb854-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb854-183"><a href="#cb854-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb854-184"><a href="#cb854-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score),</span>
<span id="cb854-185"><a href="#cb854-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb854-186"><a href="#cb854-186" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb854-187"><a href="#cb854-187" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb854-188"><a href="#cb854-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb854-189"><a href="#cb854-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb854-190"><a href="#cb854-190" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score, <span class="at">color =</span> condition),</span>
<span id="cb854-191"><a href="#cb854-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.3</span>,</span>
<span id="cb854-192"><a href="#cb854-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb854-193"><a href="#cb854-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>( </span>
<span id="cb854-194"><a href="#cb854-194" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">05</span></span>
<span id="cb854-195"><a href="#cb854-195" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">labs</span>( </span>
<span id="cb854-196"><a href="#cb854-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score "</span>,</span>
<span id="cb854-197"><a href="#cb854-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>) <span class="sc">+</span></span>
<span id="cb854-198"><a href="#cb854-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) <span class="sc">+</span> </span>
<span id="cb854-199"><a href="#cb854-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>), <span class="at">clip =</span> <span class="st">"off"</span>)</span>
<span id="cb854-200"><a href="#cb854-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-201"><a href="#cb854-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-202"><a href="#cb854-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-203"><a href="#cb854-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-204"><a href="#cb854-204" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independent Samples T-Test (Student's T)</span></span>
<span id="cb854-205"><a href="#cb854-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-206"><a href="#cb854-206" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tests null hypothesis that true difference in population mean is == 0</span>
<span id="cb854-207"><a href="#cb854-207" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed variables</span>
<span id="cb854-208"><a href="#cb854-208" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes equal variance of samples (homogeneity of variance)</span>
<span id="cb854-209"><a href="#cb854-209" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**SGC accuracy data violate both homogeneity and normality**<span class="sc">\*</span></span>
<span id="cb854-210"><a href="#cb854-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-213"><a href="#cb854-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-214"><a href="#cb854-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: STUDENTS-T</span></span>
<span id="cb854-215"><a href="#cb854-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-216"><a href="#cb854-216" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>( test_score <span class="sc">~</span> condition,<span class="at">data =</span> df,</span>
<span id="cb854-217"><a href="#cb854-217" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))) <span class="co"># less, greater for one sided tests</span></span>
<span id="cb854-218"><a href="#cb854-218" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span>
<span id="cb854-219"><a href="#cb854-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-220"><a href="#cb854-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-221"><a href="#cb854-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-224"><a href="#cb854-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-225"><a href="#cb854-225" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb854-226"><a href="#cb854-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-227"><a href="#cb854-227" aria-hidden="true" tabindex="-1"></a><span class="co">#one tailed tests must be done manually by extracting results expression and adding as subtitle</span></span>
<span id="cb854-228"><a href="#cb854-228" aria-hidden="true" tabindex="-1"></a><span class="co">#default is two tailed test</span></span>
<span id="cb854-229"><a href="#cb854-229" aria-hidden="true" tabindex="-1"></a><span class="co"># results &lt;- two_sample_test( data = df, x = pretty_condition, </span></span>
<span id="cb854-230"><a href="#cb854-230" aria-hidden="true" tabindex="-1"></a><span class="co">#                             y = item_test_NABS,</span></span>
<span id="cb854-231"><a href="#cb854-231" aria-hidden="true" tabindex="-1"></a><span class="co">#                             alternative = "g")</span></span>
<span id="cb854-232"><a href="#cb854-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-233"><a href="#cb854-233" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb854-234"><a href="#cb854-234" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"parametric"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-235"><a href="#cb854-235" aria-hidden="true" tabindex="-1"></a>               <span class="at">alternative  =</span> <span class="st">"g"</span>,</span>
<span id="cb854-236"><a href="#cb854-236" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, ) </span>
<span id="cb854-237"><a href="#cb854-237" aria-hidden="true" tabindex="-1"></a><span class="co"># + labs(subtitle = results$expression[[1]])</span></span>
<span id="cb854-238"><a href="#cb854-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-239"><a href="#cb854-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-240"><a href="#cb854-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-241"><a href="#cb854-241" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independent Samples T-Test (Welch's T)</span></span>
<span id="cb854-242"><a href="#cb854-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-243"><a href="#cb854-243" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tests null hypothesis that true difference in population mean is == 0</span>
<span id="cb854-244"><a href="#cb854-244" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed variables</span>
<span id="cb854-245"><a href="#cb854-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Does not** assumes equal variance of samples (homogeneity of variance)</span>
<span id="cb854-246"><a href="#cb854-246" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>***SGC accuracy data violates normality assumption***</span>
<span id="cb854-247"><a href="#cb854-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-250"><a href="#cb854-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-251"><a href="#cb854-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: WELCHES-T</span></span>
<span id="cb854-252"><a href="#cb854-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-253"><a href="#cb854-253" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>( test_score <span class="sc">~</span> condition,<span class="at">data =</span> df,</span>
<span id="cb854-254"><a href="#cb854-254" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>))</span>
<span id="cb854-255"><a href="#cb854-255" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span>
<span id="cb854-256"><a href="#cb854-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-257"><a href="#cb854-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-258"><a href="#cb854-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-261"><a href="#cb854-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-262"><a href="#cb854-262" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb854-263"><a href="#cb854-263" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb854-264"><a href="#cb854-264" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"parametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb854-265"><a href="#cb854-265" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb854-266"><a href="#cb854-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-267"><a href="#cb854-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-268"><a href="#cb854-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-269"><a href="#cb854-269" aria-hidden="true" tabindex="-1"></a><span class="fu">### Yuen's T-Test (Trimmed Means)</span></span>
<span id="cb854-270"><a href="#cb854-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-271"><a href="#cb854-271" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Robust alternative to** to t-test is Yuen's t-test which uses trimmed means</span>
<span id="cb854-272"><a href="#cb854-272" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Trimmed means are not desireable for this research scenario because they trim data from the extremes, and in this study these are true, interesting values</span>
<span id="cb854-273"><a href="#cb854-273" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://garstats.wordpress.com/2017/11/28/trimmed-means/&gt;</span></span>
<span id="cb854-274"><a href="#cb854-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-277"><a href="#cb854-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-278"><a href="#cb854-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: YUENS-T</span></span>
<span id="cb854-279"><a href="#cb854-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-280"><a href="#cb854-280" aria-hidden="true" tabindex="-1"></a>(y <span class="ot">&lt;-</span> <span class="fu">yuenbt</span>( <span class="at">formula =</span> test_score <span class="sc">~</span> condition, <span class="at">data =</span> df,</span>
<span id="cb854-281"><a href="#cb854-281" aria-hidden="true" tabindex="-1"></a>              <span class="at">side =</span> <span class="cn">TRUE</span>, <span class="at">EQVAR =</span> <span class="cn">FALSE</span>))</span>
<span id="cb854-282"><a href="#cb854-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-283"><a href="#cb854-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-284"><a href="#cb854-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-287"><a href="#cb854-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-288"><a href="#cb854-288" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb854-289"><a href="#cb854-289" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb854-290"><a href="#cb854-290" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"robust"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb854-291"><a href="#cb854-291" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb854-292"><a href="#cb854-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-293"><a href="#cb854-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-294"><a href="#cb854-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-295"><a href="#cb854-295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wilcoxon Rank Sum (Mann-Whitney Test)</span></span>
<span id="cb854-296"><a href="#cb854-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-297"><a href="#cb854-297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Non parametric alternative** to t-test; compares median rather than mean by ranking data</span>
<span id="cb854-298"><a href="#cb854-298" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume normality</span>
<span id="cb854-299"><a href="#cb854-299" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume equal variance of samples (homogeneity of variance)</span>
<span id="cb854-300"><a href="#cb854-300" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Appropriate for SGC accuracy data**</span>
<span id="cb854-301"><a href="#cb854-301" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/#two-sample-wilcoxon-test</span>
<span id="cb854-302"><a href="#cb854-302" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://data.library.virginia.edu/the-wilcoxon-rank-sum-test/</span>
<span id="cb854-303"><a href="#cb854-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-306"><a href="#cb854-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-307"><a href="#cb854-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: WILCOXON RANK SUM</span></span>
<span id="cb854-308"><a href="#cb854-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-309"><a href="#cb854-309" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df<span class="sc">$</span>test_score <span class="sc">~</span> df<span class="sc">$</span>condition,</span>
<span id="cb854-310"><a href="#cb854-310" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)) <span class="co">#less, greater</span></span>
<span id="cb854-311"><a href="#cb854-311" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(w)</span>
<span id="cb854-312"><a href="#cb854-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-313"><a href="#cb854-313" aria-hidden="true" tabindex="-1"></a><span class="co">#effect size</span></span>
<span id="cb854-314"><a href="#cb854-314" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">wilcox_effsize</span>(test_score <span class="sc">~</span> condition)</span>
<span id="cb854-315"><a href="#cb854-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-316"><a href="#cb854-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-317"><a href="#cb854-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-320"><a href="#cb854-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-321"><a href="#cb854-321" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb854-322"><a href="#cb854-322" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb854-323"><a href="#cb854-323" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb854-324"><a href="#cb854-324" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb854-325"><a href="#cb854-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-326"><a href="#cb854-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-327"><a href="#cb854-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-328"><a href="#cb854-328" aria-hidden="true" tabindex="-1"></a><span class="fu">### Floor/Ceiling Corrections + Wilcoxon Rank Sum</span></span>
<span id="cb854-329"><a href="#cb854-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-330"><a href="#cb854-330" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The bimodal distribution of the subject-level score data do not meet the requirements for t-tests.</span>
<span id="cb854-331"><a href="#cb854-331" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>However, a non-parametric alternative is available (Wilcoxon rank sum test / Man-Whitney test)</span>
<span id="cb854-332"><a href="#cb854-332" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Additional corrections are available for data with 'floor' and/or 'ceiling' effects via the 'DACR' package</span>
<span id="cb854-333"><a href="#cb854-333" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14 see also https://qmliu.shinyapps.io/DACFE/</span>
<span id="cb854-334"><a href="#cb854-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-335"><a href="#cb854-335" aria-hidden="true" tabindex="-1"></a>For comparison we run a standard followed by a Wilcoxon rank-sum (Mann-Whitney) test that is a nonparametric alternative for non-normally distributed data.</span>
<span id="cb854-336"><a href="#cb854-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-339"><a href="#cb854-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-340"><a href="#cb854-340" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df<span class="sc">$</span>test_score <span class="sc">~</span> df<span class="sc">$</span>condition))</span>
<span id="cb854-341"><a href="#cb854-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-342"><a href="#cb854-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-343"><a href="#cb854-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-344"><a href="#cb854-344" aria-hidden="true" tabindex="-1"></a>Next, we calculate the t-test and ANOVA (F-test) based on a series of corrections provided for data with floor and/or ceiling effects.</span>
<span id="cb854-345"><a href="#cb854-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-346"><a href="#cb854-346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14&gt;</span></span>
<span id="cb854-347"><a href="#cb854-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-348"><a href="#cb854-348" aria-hidden="true" tabindex="-1"></a>Using properties from truncated normal distributions, the authors propose an easy-to-use method for the *t*-test and ANOVA with ceiling/floor data.</span>
<span id="cb854-349"><a href="#cb854-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-350"><a href="#cb854-350" aria-hidden="true" tabindex="-1"></a>*The proposed method calculates the degrees of freedom based on the after-truncation sample sizes (where l = number of floor observations, and r = number of ceiling observations). The rationale was that the proposed method utilizes full information only from data points of n − r − l participants and partial information from data points of r + l participants of a group for the mean and variance estimation. Specifically, the corrected mean and variance estimates (Eqs. 14 and 15) are functions of mean and variance estimates using after-truncation data (n − r − l participants) and the standardized floor and ceiling threshold estimates. The thresholds are estimated using the ceiling and floor percentage estimates based on data points of n − r and n − l participants, respectively. This is a relatively conservative approach for calculating the degrees of freedom, which can help control the type I error rate. This feature can be beneficial, especially given the "replication crisis" in psychological and behavioral research.*</span>
<span id="cb854-351"><a href="#cb854-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-354"><a href="#cb854-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-355"><a href="#cb854-355" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED T TESTS</span></span>
<span id="cb854-356"><a href="#cb854-356" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DACF) <span class="co">#tests for data with floor and ceiling </span></span>
<span id="cb854-357"><a href="#cb854-357" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.rdocumentation.org/packages/DACF/versions/1.0.0</span></span>
<span id="cb854-358"><a href="#cb854-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-359"><a href="#cb854-359" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare data [vector of scores for each group]</span></span>
<span id="cb854-360"><a href="#cb854-360" aria-hidden="true" tabindex="-1"></a>score_111 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test_score) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb854-361"><a href="#cb854-361" aria-hidden="true" tabindex="-1"></a>score_121 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"impasse"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test_score) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb854-362"><a href="#cb854-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-363"><a href="#cb854-363" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb854-364"><a href="#cb854-364" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_111) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb854-365"><a href="#cb854-365" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb854-366"><a href="#cb854-366" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_121) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb854-367"><a href="#cb854-367" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(<span class="st">"control"</span><span class="ot">=</span>a ,<span class="st">"impasse"</span><span class="ot">=</span>b))</span>
<span id="cb854-368"><a href="#cb854-368" aria-hidden="true" tabindex="-1"></a>r</span>
<span id="cb854-369"><a href="#cb854-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-370"><a href="#cb854-370" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb854-371"><a href="#cb854-371" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb854-372"><a href="#cb854-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-373"><a href="#cb854-373" aria-hidden="true" tabindex="-1"></a><span class="co"># perform adjusted t test</span></span>
<span id="cb854-374"><a href="#cb854-374" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.t.test</span>(score_111,score_121,<span class="st">"b"</span>)</span>
<span id="cb854-375"><a href="#cb854-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-376"><a href="#cb854-376" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED F* </span><span class="al">TEST</span><span class="co"> ANOVA</span></span>
<span id="cb854-377"><a href="#cb854-377" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.f.star</span>(df,test_score<span class="sc">~</span>condition,<span class="st">"b"</span>)</span>
<span id="cb854-378"><a href="#cb854-378" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb854-379"><a href="#cb854-379" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb854-380"><a href="#cb854-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-381"><a href="#cb854-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-382"><a href="#cb854-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-383"><a href="#cb854-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-384"><a href="#cb854-384" aria-hidden="true" tabindex="-1"></a>*The control condition has 11% of data at ceiling and 71% at floor, with corrected mean of -7 and variance of 207. The impasse condition has 17% at ceiling, and only 42% at floor, with with corrected mean of 2.39 and variance respectively as of 58.*</span>
<span id="cb854-385"><a href="#cb854-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-386"><a href="#cb854-386" aria-hidden="true" tabindex="-1"></a>*A corrected t-test t statistic is -4.94, p = 0.05. The estimated Cohen's d is -0.89 with a confidence interval 0f \[-14.22, -5.97\].*</span>
<span id="cb854-387"><a href="#cb854-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-388"><a href="#cb854-388" aria-hidden="true" tabindex="-1"></a>*A correct F-test (ANOVA) has a corrected F-statstic of 5.85, p \&lt; 0.05, and Fsquared effect size of 0.195*</span>
<span id="cb854-389"><a href="#cb854-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-390"><a href="#cb854-390" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Regression</span></span>
<span id="cb854-391"><a href="#cb854-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-392"><a href="#cb854-392" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes homogeneity of variance</span>
<span id="cb854-393"><a href="#cb854-393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed residuals</span>
<span id="cb854-394"><a href="#cb854-394" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>when default dummy coding is used;</span>
<span id="cb854-395"><a href="#cb854-395" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>intercept = predicted mean of first group,</span>
<span id="cb854-396"><a href="#cb854-396" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>predictor coefficient = difference to mean of second group</span>
<span id="cb854-397"><a href="#cb854-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-400"><a href="#cb854-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-401"><a href="#cb854-401" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION</span></span>
<span id="cb854-402"><a href="#cb854-402" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb854-403"><a href="#cb854-403" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb854-404"><a href="#cb854-404" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm<span class="fl">.1</span>)</span>
<span id="cb854-405"><a href="#cb854-405" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb854-406"><a href="#cb854-406" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span>
<span id="cb854-407"><a href="#cb854-407" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb854-408"><a href="#cb854-408" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm<span class="fl">.1</span>)</span>
<span id="cb854-409"><a href="#cb854-409" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(lm<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb854-410"><a href="#cb854-410" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm<span class="fl">.1</span>)</span>
<span id="cb854-411"><a href="#cb854-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-412"><a href="#cb854-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-415"><a href="#cb854-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-416"><a href="#cb854-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PLOT-MODEL-COEFSS-GGDIST</span></span>
<span id="cb854-417"><a href="#cb854-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-418"><a href="#cb854-418" aria-hidden="true" tabindex="-1"></a><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span></span>
<span id="cb854-419"><a href="#cb854-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-420"><a href="#cb854-420" aria-hidden="true" tabindex="-1"></a><span class="co">#setup references</span></span>
<span id="cb854-421"><a href="#cb854-421" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> lm<span class="fl">.1</span></span>
<span id="cb854-422"><a href="#cb854-422" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df</span>
<span id="cb854-423"><a href="#cb854-423" aria-hidden="true" tabindex="-1"></a>call <span class="ot">&lt;-</span> m<span class="sc">$</span>call <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()</span>
<span id="cb854-424"><a href="#cb854-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-425"><a href="#cb854-425" aria-hidden="true" tabindex="-1"></a><span class="co"># uncertainty model visualization</span></span>
<span id="cb854-426"><a href="#cb854-426" aria-hidden="true" tabindex="-1"></a>df  <span class="sc">%&gt;%</span></span>
<span id="cb854-427"><a href="#cb854-427" aria-hidden="true" tabindex="-1"></a>  modelr<span class="sc">::</span><span class="fu">data_grid</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb854-428"><a href="#cb854-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(lm<span class="fl">.1</span>, <span class="at">newdata =</span> ., <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb854-429"><a href="#cb854-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> condition, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb854-430"><a href="#cb854-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>( <span class="at">scale =</span> .<span class="dv">5</span>,</span>
<span id="cb854-431"><a href="#cb854-431" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb854-432"><a href="#cb854-432" aria-hidden="true" tabindex="-1"></a>        <span class="at">xdist =</span> <span class="fu">dist_student_t</span>(<span class="at">df =</span> <span class="fu">df.residual</span>(m), <span class="at">mu =</span> .fitted, <span class="at">sigma =</span> .se.fit),</span>
<span id="cb854-433"><a href="#cb854-433" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">stat</span>(<span class="fu">cut_cdf_qi</span>(cdf,</span>
<span id="cb854-434"><a href="#cb854-434" aria-hidden="true" tabindex="-1"></a>                <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">95</span>),</span>
<span id="cb854-435"><a href="#cb854-435" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())))) <span class="sc">+</span></span>
<span id="cb854-436"><a href="#cb854-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-437"><a href="#cb854-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"(LAB) Test Phase Accuracy ~ Condition"</span>,</span>
<span id="cb854-438"><a href="#cb854-438" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"model predicted mean (% correct)"</span>, <span class="at">y =</span> <span class="st">"Condition"</span>, <span class="at">fill =</span> <span class="st">"Interval"</span>,</span>
<span id="cb854-439"><a href="#cb854-439" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"lm("</span>,call[<span class="dv">2</span>],<span class="st">")"</span>)</span>
<span id="cb854-440"><a href="#cb854-440" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb854-441"><a href="#cb854-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-442"><a href="#cb854-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-443"><a href="#cb854-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-446"><a href="#cb854-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-447"><a href="#cb854-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PLOT-MODEL-PRED-SJPLOT</span></span>
<span id="cb854-448"><a href="#cb854-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-449"><a href="#cb854-449" aria-hidden="true" tabindex="-1"></a><span class="co">#sjPlot</span></span>
<span id="cb854-450"><a href="#cb854-450" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(lm<span class="fl">.1</span>,  <span class="at">type =</span> <span class="st">"eff"</span>, </span>
<span id="cb854-451"><a href="#cb854-451" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.data =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-452"><a href="#cb854-452" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p =</span> <span class="cn">TRUE</span>) </span>
<span id="cb854-453"><a href="#cb854-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-454"><a href="#cb854-454" aria-hidden="true" tabindex="-1"></a><span class="co">#BS TO MANUALLY ADD REGRESSION FORMULA AS SUBTITLE </span></span>
<span id="cb854-455"><a href="#cb854-455" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic)</span></span>
<span id="cb854-456"><a href="#cb854-456" aria-hidden="true" tabindex="-1"></a><span class="co"># library(latex2exp)</span></span>
<span id="cb854-457"><a href="#cb854-457" aria-hidden="true" tabindex="-1"></a><span class="co"># (x &lt;- extract_eq(lm.1, use_coefs = TRUE, ital_vars=TRUE, coef_digits = 1, raw_tex = FALSE))</span></span>
<span id="cb854-458"><a href="#cb854-458" aria-hidden="true" tabindex="-1"></a><span class="co"># b = TeX(x)</span></span>
<span id="cb854-459"><a href="#cb854-459" aria-hidden="true" tabindex="-1"></a><span class="co"># p1[["condition"]][["labels"]][["subtitle"]]= expression( paste(widehat(accuracy), " = ", 1.7, " + ", "1.6", "*", condition[impasse]) )</span></span>
<span id="cb854-460"><a href="#cb854-460" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb854-461"><a href="#cb854-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-462"><a href="#cb854-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-463"><a href="#cb854-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-464"><a href="#cb854-464" aria-hidden="true" tabindex="-1"></a><span class="fu">### Censored (Tobit) Regression</span></span>
<span id="cb854-465"><a href="#cb854-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-466"><a href="#cb854-466" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/tobit-models/&gt;</span></span>
<span id="cb854-467"><a href="#cb854-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-468"><a href="#cb854-468" aria-hidden="true" tabindex="-1"></a>**For censored data (i.e. truncated axis).** The tobit model, also called a censored regression model, is designed to estimate linear relationships between variables when there is either left- or right-censoring in the dependent variable (also known as censoring from below and above, respectively). Censoring from above takes place when cases with a value at or above some threshold, all take on the value of that threshold, so that the true value might be equal to the threshold, but it might also be higher. In the case of censoring from below, values those that fall at or below some threshold are censored.</span>
<span id="cb854-469"><a href="#cb854-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-470"><a href="#cb854-470" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>censored vs truncated : There is sometimes confusion about the difference between truncated data and censored data.</span>
<span id="cb854-471"><a href="#cb854-471" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With censored variables, all of the observations are in the dataset, but we don't know the "true" values of some of them.</span>
<span id="cb854-472"><a href="#cb854-472" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With truncation some of the observations are not included in the analysis because of the value of the variable.</span>
<span id="cb854-473"><a href="#cb854-473" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When a variable is censored, regression models for truncated data provide inconsistent estimates of the parameters. See Long (1997, chapter 7) for a more detailed discussion of problems of using regression models for truncated data to analyze censored data.</span>
<span id="cb854-474"><a href="#cb854-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-477"><a href="#cb854-477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-478"><a href="#cb854-478" aria-hidden="true" tabindex="-1"></a><span class="co">#set censoring values </span></span>
<span id="cb854-479"><a href="#cb854-479" aria-hidden="true" tabindex="-1"></a>lo <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb854-480"><a href="#cb854-480" aria-hidden="true" tabindex="-1"></a>hi <span class="ot">=</span> <span class="dv">8</span> </span>
<span id="cb854-481"><a href="#cb854-481" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(df<span class="sc">$</span>test_score)</span>
<span id="cb854-482"><a href="#cb854-482" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Lo and Hi should equate to upper and lower bounds of the # Qs "</span>)</span>
<span id="cb854-483"><a href="#cb854-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-484"><a href="#cb854-484" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb854-485"><a href="#cb854-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-486"><a href="#cb854-486" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb854-487"><a href="#cb854-487" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span> <span class="fu">vglm</span>(test_score <span class="sc">~</span> condition, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span>hi ), <span class="at">data =</span> df)</span>
<span id="cb854-488"><a href="#cb854-488" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb854-489"><a href="#cb854-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-490"><a href="#cb854-490" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb854-491"><a href="#cb854-491" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb854-492"><a href="#cb854-492" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m1)))</span>
<span id="cb854-493"><a href="#cb854-493" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb854-494"><a href="#cb854-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-495"><a href="#cb854-495" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb854-496"><a href="#cb854-496" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb854-497"><a href="#cb854-497" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(test_score <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span> hi), <span class="at">data =</span> df)</span>
<span id="cb854-498"><a href="#cb854-498" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(m1) <span class="sc">-</span> <span class="fu">logLik</span>(m0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb854-499"><a href="#cb854-499" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb854-500"><a href="#cb854-500" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m0,m1)</span>
<span id="cb854-501"><a href="#cb854-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-502"><a href="#cb854-502" aria-hidden="true" tabindex="-1"></a><span class="co">#DIAGNOSTICS</span></span>
<span id="cb854-503"><a href="#cb854-503" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1)</span>
<span id="cb854-504"><a href="#cb854-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-505"><a href="#cb854-505" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m1)[,<span class="dv">1</span>]</span>
<span id="cb854-506"><a href="#cb854-506" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rr <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb854-507"><a href="#cb854-507" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rp <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"pearson"</span>)[,<span class="dv">1</span>]</span>
<span id="cb854-508"><a href="#cb854-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-509"><a href="#cb854-509" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb854-510"><a href="#cb854-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-511"><a href="#cb854-511" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df, {</span>
<span id="cb854-512"><a href="#cb854-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rr, <span class="at">main =</span> <span class="st">"Fitted vs Residuals"</span>)</span>
<span id="cb854-513"><a href="#cb854-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rr)</span>
<span id="cb854-514"><a href="#cb854-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rp, <span class="at">main =</span> <span class="st">"Fitted vs Pearson Residuals"</span>)</span>
<span id="cb854-515"><a href="#cb854-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rp)</span>
<span id="cb854-516"><a href="#cb854-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_score, rp, <span class="at">main =</span> <span class="st">"Actual vs Pearson Residuals"</span>)</span>
<span id="cb854-517"><a href="#cb854-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_score, yhat, <span class="at">main =</span> <span class="st">"Actual vs Fitted"</span>)</span>
<span id="cb854-518"><a href="#cb854-518" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb854-519"><a href="#cb854-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-520"><a href="#cb854-520" aria-hidden="true" tabindex="-1"></a><span class="co">#VARIANCE ACCOUNTED FOR</span></span>
<span id="cb854-521"><a href="#cb854-521" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"VARIANCE ACCOUNTED FOR"</span>)</span>
<span id="cb854-522"><a href="#cb854-522" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation</span></span>
<span id="cb854-523"><a href="#cb854-523" aria-hidden="true" tabindex="-1"></a>(r <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">cor</span>(yhat, test_score)))</span>
<span id="cb854-524"><a href="#cb854-524" aria-hidden="true" tabindex="-1"></a><span class="co"># variance accounted for</span></span>
<span id="cb854-525"><a href="#cb854-525" aria-hidden="true" tabindex="-1"></a>r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb854-526"><a href="#cb854-526" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb854-527"><a href="#cb854-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-528"><a href="#cb854-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-529"><a href="#cb854-529" aria-hidden="true" tabindex="-1"></a><span class="co">#NOTE: censReg package also does Tobit regression [including mixed models]</span></span>
<span id="cb854-530"><a href="#cb854-530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-531"><a href="#cb854-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-532"><a href="#cb854-532" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient labeled "(Intercept):1" is the intercept or constant for the model.</span>
<span id="cb854-533"><a href="#cb854-533" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient labeled "(Intercept):2" is an ancillary statistic. If we exponentiate this value, we get a statistic that is analogous to the square root of the residual variance in OLS regression. logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</span>
<span id="cb854-534"><a href="#cb854-534" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The predicted value of test_phase_score is 5.75 points *higher* for students in the impasse condition than for students in the control condition. (72% improvement in score!)</span>
<span id="cb854-535"><a href="#cb854-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-536"><a href="#cb854-536" aria-hidden="true" tabindex="-1"></a>**Using censReg package** - https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf</span>
<span id="cb854-537"><a href="#cb854-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-540"><a href="#cb854-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-541"><a href="#cb854-541" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censReg) <span class="co">#censored regression</span></span>
<span id="cb854-542"><a href="#cb854-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-543"><a href="#cb854-543" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb854-544"><a href="#cb854-544" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( test_score <span class="sc">~</span> condition, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb854-545"><a href="#cb854-545" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(c1)</span>
<span id="cb854-546"><a href="#cb854-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-547"><a href="#cb854-547" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb854-548"><a href="#cb854-548" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(c1)</span>
<span id="cb854-549"><a href="#cb854-549" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(c1)))</span>
<span id="cb854-550"><a href="#cb854-550" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb854-551"><a href="#cb854-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-552"><a href="#cb854-552" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb854-553"><a href="#cb854-553" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb854-554"><a href="#cb854-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-555"><a href="#cb854-555" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( test_score <span class="sc">~</span> <span class="dv">1</span>, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb854-556"><a href="#cb854-556" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(c1) <span class="sc">-</span> <span class="fu">logLik</span>(c0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb854-557"><a href="#cb854-557" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb854-558"><a href="#cb854-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-559"><a href="#cb854-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-560"><a href="#cb854-560" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(c1)</span>
<span id="cb854-561"><a href="#cb854-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-562"><a href="#cb854-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-563"><a href="#cb854-563" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</span>
<span id="cb854-564"><a href="#cb854-564" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>output should match that of VGAM</span>
<span id="cb854-565"><a href="#cb854-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-566"><a href="#cb854-566" aria-hidden="true" tabindex="-1"></a><span class="fu">## COUNT OUTCOME</span></span>
<span id="cb854-567"><a href="#cb854-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-568"><a href="#cb854-568" aria-hidden="true" tabindex="-1"></a>**Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?\</span>
<span id="cb854-569"><a href="#cb854-569" aria-hidden="true" tabindex="-1"></a>(# questions correct on test phase of task, <span class="sc">\[</span>in lab<span class="sc">\]</span> participants)**</span>
<span id="cb854-570"><a href="#cb854-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-571"><a href="#cb854-571" aria-hidden="true" tabindex="-1"></a>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can try considering it a type of *count*, (i.e. count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function). Note that the process of answering questions on a test do not seem to strictly match the assumptions of a Poisson process.</span>
<span id="cb854-572"><a href="#cb854-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-575"><a href="#cb854-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-576"><a href="#cb854-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-COUNT-TESTSCORE</span></span>
<span id="cb854-577"><a href="#cb854-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb854-578"><a href="#cb854-578" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb854-579"><a href="#cb854-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-580"><a href="#cb854-580" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::SETUP DATA</span></span>
<span id="cb854-581"><a href="#cb854-581" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb854-582"><a href="#cb854-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-583"><a href="#cb854-583" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb854-584"><a href="#cb854-584" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb854-585"><a href="#cb854-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-586"><a href="#cb854-586" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb854-587"><a href="#cb854-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-588"><a href="#cb854-588" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | FACETED HISTOGRAM</span></span>
<span id="cb854-589"><a href="#cb854-589" aria-hidden="true" tabindex="-1"></a><span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span></span>
<span id="cb854-590"><a href="#cb854-590" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~item_test_NABS, </span></span>
<span id="cb854-591"><a href="#cb854-591" aria-hidden="true" tabindex="-1"></a><span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span></span>
<span id="cb854-592"><a href="#cb854-592" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span></span>
<span id="cb854-593"><a href="#cb854-593" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span></span>
<span id="cb854-594"><a href="#cb854-594" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "# Correct",</span></span>
<span id="cb854-595"><a href="#cb854-595" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "proportion of subjects",</span></span>
<span id="cb854-596"><a href="#cb854-596" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span></span>
<span id="cb854-597"><a href="#cb854-597" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "") + theme(legend.position = "blank")</span></span>
<span id="cb854-598"><a href="#cb854-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-599"><a href="#cb854-599" aria-hidden="true" tabindex="-1"></a><span class="do">##GGPUBR | HIST+DENSITY SCORE </span></span>
<span id="cb854-600"><a href="#cb854-600" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">gghistogram</span>(df, <span class="at">x =</span> <span class="st">"test_score"</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb854-601"><a href="#cb854-601" aria-hidden="true" tabindex="-1"></a>   <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-602"><a href="#cb854-602" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill =</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span></span>
<span id="cb854-603"><a href="#cb854-603" aria-hidden="true" tabindex="-1"></a>   <span class="at">add_density =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-604"><a href="#cb854-604" aria-hidden="true" tabindex="-1"></a><span class="fu">facet</span>(p, <span class="at">facet.by=</span><span class="fu">c</span>(<span class="st">"condition"</span>)) <span class="sc">+</span></span>
<span id="cb854-605"><a href="#cb854-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score"</span>,</span>
<span id="cb854-606"><a href="#cb854-606" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,</span>
<span id="cb854-607"><a href="#cb854-607" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, <span class="at">y =</span> <span class="st">"number of subjects"</span>) <span class="sc">+</span></span>
<span id="cb854-608"><a href="#cb854-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb854-609"><a href="#cb854-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-610"><a href="#cb854-610" aria-hidden="true" tabindex="-1"></a><span class="do">##VERTICAL RAINCLOUD USING GGDISTR</span></span>
<span id="cb854-611"><a href="#cb854-611" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> test_score,</span>
<span id="cb854-612"><a href="#cb854-612" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> condition) ) <span class="sc">+</span> </span>
<span id="cb854-613"><a href="#cb854-613" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb854-614"><a href="#cb854-614" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>,</span>
<span id="cb854-615"><a href="#cb854-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb854-616"><a href="#cb854-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>, </span>
<span id="cb854-617"><a href="#cb854-617" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb854-618"><a href="#cb854-618" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span> </span>
<span id="cb854-619"><a href="#cb854-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb854-620"><a href="#cb854-620" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb854-621"><a href="#cb854-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score),</span>
<span id="cb854-622"><a href="#cb854-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb854-623"><a href="#cb854-623" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb854-624"><a href="#cb854-624" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb854-625"><a href="#cb854-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb854-626"><a href="#cb854-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb854-627"><a href="#cb854-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score, <span class="at">color =</span> condition),</span>
<span id="cb854-628"><a href="#cb854-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.3</span>,</span>
<span id="cb854-629"><a href="#cb854-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb854-630"><a href="#cb854-630" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>( </span>
<span id="cb854-631"><a href="#cb854-631" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">05</span></span>
<span id="cb854-632"><a href="#cb854-632" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">labs</span>( </span>
<span id="cb854-633"><a href="#cb854-633" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score "</span>,</span>
<span id="cb854-634"><a href="#cb854-634" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>) <span class="sc">+</span></span>
<span id="cb854-635"><a href="#cb854-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) <span class="sc">+</span> </span>
<span id="cb854-636"><a href="#cb854-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>), <span class="at">clip =</span> <span class="st">"off"</span>)</span>
<span id="cb854-637"><a href="#cb854-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-638"><a href="#cb854-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-639"><a href="#cb854-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-640"><a href="#cb854-640" aria-hidden="true" tabindex="-1"></a><span class="fu">### Poisson Regression</span></span>
<span id="cb854-641"><a href="#cb854-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-642"><a href="#cb854-642" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/poisson-regression/&gt;</span>\</span>
<span id="cb854-643"><a href="#cb854-643" aria-hidden="true" tabindex="-1"></a>*General Linear model using the Poisson distribution*</span>
<span id="cb854-644"><a href="#cb854-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-647"><a href="#cb854-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-648"><a href="#cb854-648" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span></span>
<span id="cb854-649"><a href="#cb854-649" aria-hidden="true" tabindex="-1"></a>p<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb854-650"><a href="#cb854-650" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb854-651"><a href="#cb854-651" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(p<span class="fl">.1</span>)</span>
<span id="cb854-652"><a href="#cb854-652" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb854-653"><a href="#cb854-653" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(p<span class="fl">.1</span>)</span>
<span id="cb854-654"><a href="#cb854-654" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb854-655"><a href="#cb854-655" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(p<span class="fl">.1</span>)</span>
<span id="cb854-656"><a href="#cb854-656" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(p<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb854-657"><a href="#cb854-657" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(p<span class="fl">.1</span>)</span>
<span id="cb854-658"><a href="#cb854-658" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(p<span class="fl">.1</span>)</span>
<span id="cb854-659"><a href="#cb854-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-660"><a href="#cb854-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-661"><a href="#cb854-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-662"><a href="#cb854-662" aria-hidden="true" tabindex="-1"></a>*The variable condition has a coefficient of 0.67, (p \&lt; 0.005). This means that for the impasse condition, the expected log count \# of questions increases by 0.67. By exponentiating the estimate we see that \# question correct rate for the impasse condition is 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.*</span>
<span id="cb854-663"><a href="#cb854-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-664"><a href="#cb854-664" aria-hidden="true" tabindex="-1"></a><span class="fu">### Negative Binomial Regression</span></span>
<span id="cb854-665"><a href="#cb854-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-666"><a href="#cb854-666" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/&gt;</span> -*overdispersed count data (variance much greater than mean)*</span>
<span id="cb854-667"><a href="#cb854-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-668"><a href="#cb854-668" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>similar to Poisson regression, but using the negative binomial distribution, which can better account for 'overdispersed' data where variance is much greater than the mean</span>
<span id="cb854-669"><a href="#cb854-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-672"><a href="#cb854-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-673"><a href="#cb854-673" aria-hidden="true" tabindex="-1"></a><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span></span>
<span id="cb854-674"><a href="#cb854-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-675"><a href="#cb854-675" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb854-676"><a href="#cb854-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-677"><a href="#cb854-677" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model </span></span>
<span id="cb854-678"><a href="#cb854-678" aria-hidden="true" tabindex="-1"></a>nb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb854-679"><a href="#cb854-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-680"><a href="#cb854-680" aria-hidden="true" tabindex="-1"></a><span class="co">#check overdispersion need </span></span>
<span id="cb854-681"><a href="#cb854-681" aria-hidden="true" tabindex="-1"></a><span class="co">#assumes conditional means are not equal to conditional variances</span></span>
<span id="cb854-682"><a href="#cb854-682" aria-hidden="true" tabindex="-1"></a><span class="co">#conduct likelihood ration test to compare and test [need poisson]</span></span>
<span id="cb854-683"><a href="#cb854-683" aria-hidden="true" tabindex="-1"></a>m.t <span class="ot">&lt;-</span> <span class="fu">glm</span>(test_score <span class="sc">~</span> condition, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> df)</span>
<span id="cb854-684"><a href="#cb854-684" aria-hidden="true" tabindex="-1"></a><span class="co">#pchisq(2 * (logLik(nb.1) - logLik(m.t)), df = 1, lower.tail = FALSE)</span></span>
<span id="cb854-685"><a href="#cb854-685" aria-hidden="true" tabindex="-1"></a><span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span></span>
<span id="cb854-686"><a href="#cb854-686" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.t, nb<span class="fl">.1</span>)</span>
<span id="cb854-687"><a href="#cb854-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-688"><a href="#cb854-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-689"><a href="#cb854-689" aria-hidden="true" tabindex="-1"></a><span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb854-690"><a href="#cb854-690" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Estimate =</span> <span class="fu">coef</span>(nb<span class="fl">.1</span>), <span class="fu">confint</span>(nb<span class="fl">.1</span>))</span>
<span id="cb854-691"><a href="#cb854-691" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate parameter estimates</span></span>
<span id="cb854-692"><a href="#cb854-692" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Exponentiated Estimates"</span>)</span>
<span id="cb854-693"><a href="#cb854-693" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(est)</span>
<span id="cb854-694"><a href="#cb854-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-695"><a href="#cb854-695" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb<span class="fl">.1</span>)</span>
<span id="cb854-696"><a href="#cb854-696" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(nb<span class="fl">.1</span>)</span>
<span id="cb854-697"><a href="#cb854-697" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(nb<span class="fl">.1</span>)</span>
<span id="cb854-698"><a href="#cb854-698" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(nb<span class="fl">.1</span>)</span>
<span id="cb854-699"><a href="#cb854-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-700"><a href="#cb854-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-701"><a href="#cb854-701" aria-hidden="true" tabindex="-1"></a>*The variable condition has a coefficient of 0.67, (p \&lt; 0.005). This means that for the impasse condition, the expected log count \# of questions increases by 0.67. By exponentiating the estimate we see that \# question correct rate for the impasse condition is nearly 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.*</span>
<span id="cb854-702"><a href="#cb854-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-705"><a href="#cb854-705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-706"><a href="#cb854-706" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE POISSON AND NEGATIVE BINOMIAL</span></span>
<span id="cb854-707"><a href="#cb854-707" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(p<span class="fl">.1</span>, nb<span class="fl">.1</span>)</span>
<span id="cb854-708"><a href="#cb854-708" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(p<span class="fl">.1</span>, nb<span class="fl">.1</span>)</span>
<span id="cb854-709"><a href="#cb854-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-710"><a href="#cb854-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-711"><a href="#cb854-711" aria-hidden="true" tabindex="-1"></a>*AIC, Pseudo-R2 and a likelihood ratio test indicate that the negative binomial regression model are a better fit for the distribution of test-phase scores.*</span>
<span id="cb854-712"><a href="#cb854-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-713"><a href="#cb854-713" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXTURE MODELS</span></span>
<span id="cb854-714"><a href="#cb854-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-715"><a href="#cb854-715" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zero Inflated Poisson</span></span>
<span id="cb854-716"><a href="#cb854-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-717"><a href="#cb854-717" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/zip/&gt;</span>\</span>
<span id="cb854-718"><a href="#cb854-718" aria-hidden="true" tabindex="-1"></a>*A Poisson count process with excess zeros*</span>
<span id="cb854-719"><a href="#cb854-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-720"><a href="#cb854-720" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Zero-Inflated model allows specification of two models (a mixture) where *some* of the zeros are included in the DGP for the Poisson model, while only the 'excess' zeros are included in the DGP for the Binomial model <span class="sc">\[</span>the zero-inflated part<span class="sc">\]</span></span>
<span id="cb854-721"><a href="#cb854-721" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The model includes:</span>
<span id="cb854-722"><a href="#cb854-722" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A logistic model to model which of the two processes the zero outcome is associated with</span>
<span id="cb854-723"><a href="#cb854-723" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A poisson model to model the count process</span>
<span id="cb854-724"><a href="#cb854-724" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can specify different predictors for each part of the model</span>
<span id="cb854-725"><a href="#cb854-725" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>predictors after the \| are for the binomial zero-inflated part of the model, while those infront are for the poisson process</span>
<span id="cb854-726"><a href="#cb854-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-729"><a href="#cb854-729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-730"><a href="#cb854-730" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED POISSON</span></span>
<span id="cb854-731"><a href="#cb854-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-732"><a href="#cb854-732" aria-hidden="true" tabindex="-1"></a>zinfp<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(test_score <span class="sc">~</span>  condition<span class="sc">|</span> condition , <span class="at">data =</span> df)</span>
<span id="cb854-733"><a href="#cb854-733" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb854-734"><a href="#cb854-734" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb854-735"><a href="#cb854-735" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb854-736"><a href="#cb854-736" aria-hidden="true" tabindex="-1"></a><span class="co">#check_model(zinfp.1)</span></span>
<span id="cb854-737"><a href="#cb854-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-738"><a href="#cb854-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-739"><a href="#cb854-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-740"><a href="#cb854-740" aria-hidden="true" tabindex="-1"></a>*In the count model, the coefficient for the condition is not significant.*</span>
<span id="cb854-741"><a href="#cb854-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-742"><a href="#cb854-742" aria-hidden="true" tabindex="-1"></a>*In the zero-inflation model, the coefficient for the condition variable is -1.23 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.23 if you are in the impasse condition*</span>
<span id="cb854-743"><a href="#cb854-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-744"><a href="#cb854-744" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zero Inflated Negative Binomial Regression</span></span>
<span id="cb854-745"><a href="#cb854-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-746"><a href="#cb854-746" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/zinb/&gt;</span>\</span>
<span id="cb854-747"><a href="#cb854-747" aria-hidden="true" tabindex="-1"></a>*count data that are overdispersed and have excess zeros*</span>
<span id="cb854-748"><a href="#cb854-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-749"><a href="#cb854-749" aria-hidden="true" tabindex="-1"></a>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the *excess* zeros can be modelled independently.</span>
<span id="cb854-750"><a href="#cb854-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-751"><a href="#cb854-751" aria-hidden="true" tabindex="-1"></a>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different 'process' ... (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) <span class="sc">\&lt;</span>- this could maybe be disentangled by first question latency?</span>
<span id="cb854-752"><a href="#cb854-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-753"><a href="#cb854-753" aria-hidden="true" tabindex="-1"></a>The model includes:</span>
<span id="cb854-754"><a href="#cb854-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-755"><a href="#cb854-755" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A logistic model to model which of the two processes the zero outcome is associated with</span>
<span id="cb854-756"><a href="#cb854-756" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A negative binomial model to model the count process</span>
<span id="cb854-757"><a href="#cb854-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-760"><a href="#cb854-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-761"><a href="#cb854-761" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TESTABS-ZINFNEGBINOM</span></span>
<span id="cb854-762"><a href="#cb854-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-763"><a href="#cb854-763" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#  for zeroinfl negbinomial</span></span>
<span id="cb854-764"><a href="#cb854-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-765"><a href="#cb854-765" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span></span>
<span id="cb854-766"><a href="#cb854-766" aria-hidden="true" tabindex="-1"></a>zinb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , </span>
<span id="cb854-767"><a href="#cb854-767" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> df, <span class="at">dist =</span> <span class="st">"negbin"</span>)</span>
<span id="cb854-768"><a href="#cb854-768" aria-hidden="true" tabindex="-1"></a><span class="co">#before the | is the count part, after the | is the logit model</span></span>
<span id="cb854-769"><a href="#cb854-769" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb854-770"><a href="#cb854-770" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb854-771"><a href="#cb854-771" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb854-772"><a href="#cb854-772" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb854-773"><a href="#cb854-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-774"><a href="#cb854-774" aria-hidden="true" tabindex="-1"></a><span class="co">#   rootogram(zinb.1)</span></span>
<span id="cb854-775"><a href="#cb854-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-776"><a href="#cb854-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-777"><a href="#cb854-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-778"><a href="#cb854-778" aria-hidden="true" tabindex="-1"></a><span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb854-779"><a href="#cb854-779" aria-hidden="true" tabindex="-1"></a><span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span></span>
<span id="cb854-780"><a href="#cb854-780" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate parameter estimates</span></span>
<span id="cb854-781"><a href="#cb854-781" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Exponentiated Estimates")</span></span>
<span id="cb854-782"><a href="#cb854-782" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(est)</span></span>
<span id="cb854-783"><a href="#cb854-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-784"><a href="#cb854-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-785"><a href="#cb854-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-786"><a href="#cb854-786" aria-hidden="true" tabindex="-1"></a>*In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).*</span>
<span id="cb854-787"><a href="#cb854-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-788"><a href="#cb854-788" aria-hidden="true" tabindex="-1"></a>*In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition*</span>
<span id="cb854-789"><a href="#cb854-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-792"><a href="#cb854-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-793"><a href="#cb854-793" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(zinfp<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span>
<span id="cb854-794"><a href="#cb854-794" aria-hidden="true" tabindex="-1"></a><span class="fu">test_likelihoodratio</span>(zinfp<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span>
<span id="cb854-795"><a href="#cb854-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-796"><a href="#cb854-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-797"><a href="#cb854-797" aria-hidden="true" tabindex="-1"></a>**TODO come back to this and discuss further**\</span>
<span id="cb854-798"><a href="#cb854-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-799"><a href="#cb854-799" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hurdle Model</span></span>
<span id="cb854-800"><a href="#cb854-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-801"><a href="#cb854-801" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://data.library.virginia.edu/getting-started-with-hurdle-models/&gt;</span></span>
<span id="cb854-802"><a href="#cb854-802" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.&gt;</span></span>
<span id="cb854-803"><a href="#cb854-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-804"><a href="#cb854-804" aria-hidden="true" tabindex="-1"></a>class of models for count data with both overdispersion and excess zeros;\</span>
<span id="cb854-805"><a href="#cb854-805" aria-hidden="true" tabindex="-1"></a>different from zero-inflated models where the excess zeros are theorized to arise from two *different* processes; in the hurdle model, there is a separate model for P(x=0) and a separate model for P(x!=0)</span>
<span id="cb854-806"><a href="#cb854-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-807"><a href="#cb854-807" aria-hidden="true" tabindex="-1"></a>The model includes:</span>
<span id="cb854-808"><a href="#cb854-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-809"><a href="#cb854-809" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A binary logit model to model whether the observation takes a positive count or not. (1) Does the student get *any* questions right?</span>
<span id="cb854-810"><a href="#cb854-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-811"><a href="#cb854-811" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>a truncated Poisson or Negative binomial model that only fits positive counts (2) How many questions does the student get right?</span>
<span id="cb854-812"><a href="#cb854-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-815"><a href="#cb854-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-816"><a href="#cb854-816" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zero-inf and hurdle models </span></span>
<span id="cb854-817"><a href="#cb854-817" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countreg) <span class="co">#rootogram</span></span>
<span id="cb854-818"><a href="#cb854-818" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span></span>
<span id="cb854-819"><a href="#cb854-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-820"><a href="#cb854-820" aria-hidden="true" tabindex="-1"></a><span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span></span>
<span id="cb854-821"><a href="#cb854-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-822"><a href="#cb854-822" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.1</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df,</span>
<span id="cb854-823"><a href="#cb854-823" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb854-824"><a href="#cb854-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-825"><a href="#cb854-825" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.2</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df,</span>
<span id="cb854-826"><a href="#cb854-826" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"negbin"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb854-827"><a href="#cb854-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-828"><a href="#cb854-828" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.1</span>)</span>
<span id="cb854-829"><a href="#cb854-829" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.2</span>)</span>
<span id="cb854-830"><a href="#cb854-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-831"><a href="#cb854-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-832"><a href="#cb854-832" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.1</span>)</span>
<span id="cb854-833"><a href="#cb854-833" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.2</span>)</span>
<span id="cb854-834"><a href="#cb854-834" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(h<span class="fl">.1</span>,h<span class="fl">.2</span>))</span>
<span id="cb854-835"><a href="#cb854-835" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(h<span class="fl">.1</span>, h<span class="fl">.2</span>)</span>
<span id="cb854-836"><a href="#cb854-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-837"><a href="#cb854-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-838"><a href="#cb854-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-839"><a href="#cb854-839" aria-hidden="true" tabindex="-1"></a><span class="fu">## BETA REGRESSION</span></span>
<span id="cb854-840"><a href="#cb854-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-841"><a href="#cb854-841" aria-hidden="true" tabindex="-1"></a><span class="fu">### BETA Distribution</span></span>
<span id="cb854-842"><a href="#cb854-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-843"><a href="#cb854-843" aria-hidden="true" tabindex="-1"></a>Beta regression on % correct (with standard transformation for including <span class="sc">\[</span>0,1<span class="sc">\]</span>)</span>
<span id="cb854-844"><a href="#cb854-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-845"><a href="#cb854-845" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression&gt;</span></span>
<span id="cb854-846"><a href="#cb854-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-847"><a href="#cb854-847" aria-hidden="true" tabindex="-1"></a>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</span>
<span id="cb854-848"><a href="#cb854-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-849"><a href="#cb854-849" aria-hidden="true" tabindex="-1"></a>If a test score is conceptualized as correct (a) and b (incorrect) score = correct / (correct + incorrect) = a/ (a + b)</span>
<span id="cb854-850"><a href="#cb854-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-851"><a href="#cb854-851" aria-hidden="true" tabindex="-1"></a>In the beta distribution, a and b are the shape parameters!</span>
<span id="cb854-852"><a href="#cb854-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-855"><a href="#cb854-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-856"><a href="#cb854-856" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb854-857"><a href="#cb854-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb854-858"><a href="#cb854-858" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb854-859"><a href="#cb854-859" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb854-860"><a href="#cb854-860" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb854-861"><a href="#cb854-861" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb854-862"><a href="#cb854-862" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb854-863"><a href="#cb854-863" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb854-864"><a href="#cb854-864" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb854-865"><a href="#cb854-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-866"><a href="#cb854-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-867"><a href="#cb854-867" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb854-868"><a href="#cb854-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">6</span>, <span class="at">shape2 =</span> <span class="dv">4</span>),</span>
<span id="cb854-869"><a href="#cb854-869" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 6, shape2 = 4)"</span>),</span>
<span id="cb854-870"><a href="#cb854-870" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-871"><a href="#cb854-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb854-872"><a href="#cb854-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-873"><a href="#cb854-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb854-874"><a href="#cb854-874" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Beta a = 6, b = 4"</span></span>
<span id="cb854-875"><a href="#cb854-875" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-876"><a href="#cb854-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-877"><a href="#cb854-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-878"><a href="#cb854-878" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb854-879"><a href="#cb854-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">8</span>, <span class="at">shape2 =</span> <span class="fl">0.001</span>),</span>
<span id="cb854-880"><a href="#cb854-880" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 8, shape2 = 0.001)"</span>),</span>
<span id="cb854-881"><a href="#cb854-881" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-882"><a href="#cb854-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb854-883"><a href="#cb854-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-884"><a href="#cb854-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb854-885"><a href="#cb854-885" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL CORRECT"</span></span>
<span id="cb854-886"><a href="#cb854-886" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-887"><a href="#cb854-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-888"><a href="#cb854-888" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb854-889"><a href="#cb854-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.001</span>, <span class="at">shape2 =</span> <span class="dv">8</span>),</span>
<span id="cb854-890"><a href="#cb854-890" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 0.001, shape2 = 8)"</span>),</span>
<span id="cb854-891"><a href="#cb854-891" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-892"><a href="#cb854-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb854-893"><a href="#cb854-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-894"><a href="#cb854-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb854-895"><a href="#cb854-895" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL WRONG"</span></span>
<span id="cb854-896"><a href="#cb854-896" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-897"><a href="#cb854-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-898"><a href="#cb854-898" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb854-899"><a href="#cb854-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">4</span>),</span>
<span id="cb854-900"><a href="#cb854-900" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 4, shape2 = 4)"</span>),</span>
<span id="cb854-901"><a href="#cb854-901" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-902"><a href="#cb854-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb854-903"><a href="#cb854-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-904"><a href="#cb854-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb854-905"><a href="#cb854-905" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FIGURED IT OUT HALFWAY "</span></span>
<span id="cb854-906"><a href="#cb854-906" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-907"><a href="#cb854-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-908"><a href="#cb854-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-909"><a href="#cb854-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-910"><a href="#cb854-910" aria-hidden="true" tabindex="-1"></a>ALTERNATIVE conceptualization of a and b is as mean MU and precision PHI (same idea as variance).</span>
<span id="cb854-911"><a href="#cb854-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-912"><a href="#cb854-912" aria-hidden="true" tabindex="-1"></a>a = mu <span class="sc">\*</span> phi b = (1 - mu) <span class="sc">\*</span> phi</span>
<span id="cb854-913"><a href="#cb854-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-914"><a href="#cb854-914" aria-hidden="true" tabindex="-1"></a>MU = a / (a+b) <span class="sc">\[</span>the score<span class="sc">\]</span> PHI = a + b <span class="sc">\[</span> the total <span class="sc">\#</span> items <span class="sc">\]</span></span>
<span id="cb854-915"><a href="#cb854-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-916"><a href="#cb854-916" aria-hidden="true" tabindex="-1"></a>The <span class="in">`extraDistr::dprop`</span> function can also handle mu and phi parameters, named as mean and size</span>
<span id="cb854-917"><a href="#cb854-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-920"><a href="#cb854-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-921"><a href="#cb854-921" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extraDistr)</span>
<span id="cb854-922"><a href="#cb854-922" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb854-923"><a href="#cb854-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.999</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb854-924"><a href="#cb854-924" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.99, size = 8)"</span>),</span>
<span id="cb854-925"><a href="#cb854-925" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-926"><a href="#cb854-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb854-927"><a href="#cb854-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-928"><a href="#cb854-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb854-929"><a href="#cb854-929" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL CORRECT"</span></span>
<span id="cb854-930"><a href="#cb854-930" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-931"><a href="#cb854-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-932"><a href="#cb854-932" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb854-933"><a href="#cb854-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.001</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb854-934"><a href="#cb854-934" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.001, size = 8)"</span>),</span>
<span id="cb854-935"><a href="#cb854-935" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-936"><a href="#cb854-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb854-937"><a href="#cb854-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-938"><a href="#cb854-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb854-939"><a href="#cb854-939" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL WRONG"</span></span>
<span id="cb854-940"><a href="#cb854-940" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-941"><a href="#cb854-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-942"><a href="#cb854-942" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb854-943"><a href="#cb854-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb854-944"><a href="#cb854-944" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.5, size = 8)"</span>),</span>
<span id="cb854-945"><a href="#cb854-945" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-946"><a href="#cb854-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb854-947"><a href="#cb854-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-948"><a href="#cb854-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb854-949"><a href="#cb854-949" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FIGURED IT OUT HALFWAY "</span></span>
<span id="cb854-950"><a href="#cb854-950" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-951"><a href="#cb854-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-952"><a href="#cb854-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-953"><a href="#cb854-953" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb854-954"><a href="#cb854-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.001</span>, <span class="at">shape2 =</span> <span class="dv">1</span>),</span>
<span id="cb854-955"><a href="#cb854-955" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 6, shape2 = 4)"</span>),</span>
<span id="cb854-956"><a href="#cb854-956" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-957"><a href="#cb854-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb854-958"><a href="#cb854-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-959"><a href="#cb854-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb854-960"><a href="#cb854-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-961"><a href="#cb854-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-962"><a href="#cb854-962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-963"><a href="#cb854-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-964"><a href="#cb854-964" aria-hidden="true" tabindex="-1"></a>**Note that in all cases, we have to slightly adjust the parameters because the distribution can't handle values at 0 or 1. So we scrunch the data in just a bit.**</span>
<span id="cb854-965"><a href="#cb854-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-966"><a href="#cb854-966" aria-hidden="true" tabindex="-1"></a><span class="fu">### BETA Regression</span></span>
<span id="cb854-967"><a href="#cb854-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-968"><a href="#cb854-968" aria-hidden="true" tabindex="-1"></a>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</span>
<span id="cb854-969"><a href="#cb854-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-970"><a href="#cb854-970" aria-hidden="true" tabindex="-1"></a>The syntax is just like all other formula-based regression functions, but with an added bit: the first part of the equation (x \~ y) models the mean, or MU, while anything that comes after a \| in the formula will explain variation in the precision, or PHI.</span>
<span id="cb854-971"><a href="#cb854-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-972"><a href="#cb854-972" aria-hidden="true" tabindex="-1"></a>The link parameter determines the link function for the mu estimate?.</span>
<span id="cb854-973"><a href="#cb854-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-974"><a href="#cb854-974" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb854-975"><a href="#cb854-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-978"><a href="#cb854-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-979"><a href="#cb854-979" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-980"><a href="#cb854-980" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg)</span>
<span id="cb854-981"><a href="#cb854-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-982"><a href="#cb854-982" aria-hidden="true" tabindex="-1"></a><span class="co">#RESCLAE VARIABLE</span></span>
<span id="cb854-983"><a href="#cb854-983" aria-hidden="true" tabindex="-1"></a><span class="co">#beta reg can't handle 0s and 1s </span></span>
<span id="cb854-984"><a href="#cb854-984" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, DV_percent_NABS)</span>
<span id="cb854-985"><a href="#cb854-985" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(sub) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb854-986"><a href="#cb854-986" aria-hidden="true" tabindex="-1"></a>sub<span class="sc">$</span>dv_transformed <span class="ot">=</span> (sub<span class="sc">$</span>DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb854-987"><a href="#cb854-987" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb854-988"><a href="#cb854-988" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE VARIABLES</span></span>
<span id="cb854-989"><a href="#cb854-989" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Slightly squished data"</span>)</span>
<span id="cb854-990"><a href="#cb854-990" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(sub<span class="sc">$</span>dv_transformed)</span>
<span id="cb854-991"><a href="#cb854-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-992"><a href="#cb854-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-993"><a href="#cb854-993" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb854-994"><a href="#cb854-994" aria-hidden="true" tabindex="-1"></a>mb1 <span class="ot">&lt;-</span> <span class="fu">betareg</span>(dv_transformed <span class="sc">~</span> condition <span class="sc">|</span> condition, </span>
<span id="cb854-995"><a href="#cb854-995" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> sub)</span>
<span id="cb854-996"><a href="#cb854-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-997"><a href="#cb854-997" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mb1)</span>
<span id="cb854-998"><a href="#cb854-998" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mb1)</span>
<span id="cb854-999"><a href="#cb854-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1000"><a href="#cb854-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1001"><a href="#cb854-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1002"><a href="#cb854-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1003"><a href="#cb854-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Which link function should be used for each? We now have two sets of coefficients, one set for each parameter (the mean and precision). The parameters for the mean are measured on the logit scale, just like with logistic regression previously, and we can calculate the marginal effect of having a quota by using plogis() and piecing together the coefficient and the intercept:</span>
<span id="cb854-1004"><a href="#cb854-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1005"><a href="#cb854-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interpret</span></span>
<span id="cb854-1006"><a href="#cb854-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1009"><a href="#cb854-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1010"><a href="#cb854-1010" aria-hidden="true" tabindex="-1"></a>beta_mu_intercept <span class="ot">&lt;-</span> mb1 <span class="sc">%&gt;%</span> </span>
<span id="cb854-1011"><a href="#cb854-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb854-1012"><a href="#cb854-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1013"><a href="#cb854-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb854-1014"><a href="#cb854-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1015"><a href="#cb854-1015" aria-hidden="true" tabindex="-1"></a>beta_mu_condition <span class="ot">&lt;-</span> mb1 <span class="sc">%&gt;%</span> </span>
<span id="cb854-1016"><a href="#cb854-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb854-1017"><a href="#cb854-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1018"><a href="#cb854-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb854-1019"><a href="#cb854-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1020"><a href="#cb854-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1021"><a href="#cb854-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- PROBABILITIES"</span>)</span>
<span id="cb854-1022"><a href="#cb854-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"[these should math pred plots]"</span>)</span>
<span id="cb854-1023"><a href="#cb854-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at reference level"</span>)</span>
<span id="cb854-1024"><a href="#cb854-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept)</span>
<span id="cb854-1025"><a href="#cb854-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at coefficient level"</span>)</span>
<span id="cb854-1026"><a href="#cb854-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition)</span>
<span id="cb854-1027"><a href="#cb854-1027" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"CHANGE in probability by coefficient"</span>)</span>
<span id="cb854-1028"><a href="#cb854-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition) <span class="sc">-</span> <span class="fu">plogis</span>(beta_mu_intercept)</span>
<span id="cb854-1029"><a href="#cb854-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1030"><a href="#cb854-1030" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mb1, <span class="at">type =</span> <span class="st">"pred"</span>)</span>
<span id="cb854-1031"><a href="#cb854-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1032"><a href="#cb854-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1033"><a href="#cb854-1033" aria-hidden="true" tabindex="-1"></a>Impasse increases the average of the distribution of accuracy by 12% percentage points, on average. This should match the value we get with fractional regression. (logistic regression with count variable instead of binomial)</span>
<span id="cb854-1034"><a href="#cb854-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1035"><a href="#cb854-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercept of MU indicates the average of the distribution of score proportion in the control condition</span>
<span id="cb854-1036"><a href="#cb854-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient of MU indicates the change in the average distribution of score proportion in the impasse condition</span>
<span id="cb854-1037"><a href="#cb854-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1038"><a href="#cb854-1038" aria-hidden="true" tabindex="-1"></a>The PHI parameter estimates are not measured on a logit scale. Instead, they're log values. We can invert them by exponentiating them with exp(). - The phi intercept indicates the precision of the distribution of score proportion in the control condition - The phi coefficient indicates the change in the precision of the distribution of score proportion in the impasse condition</span>
<span id="cb854-1039"><a href="#cb854-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1040"><a href="#cb854-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>CONDITION is a significant predictor of MEAN (location) but not PHI (precision). Put another way, the shape of both distributions is similar, but the impasse condition distribution is shift to the right (higher) than the control distribution.</span>
<span id="cb854-1041"><a href="#cb854-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1042"><a href="#cb854-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1043"><a href="#cb854-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1044"><a href="#cb854-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Compare</span></span>
<span id="cb854-1045"><a href="#cb854-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1048"><a href="#cb854-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1049"><a href="#cb854-1049" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPARE MODELS</span></span>
<span id="cb854-1050"><a href="#cb854-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1051"><a href="#cb854-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1052"><a href="#cb854-1052" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb854-1053"><a href="#cb854-1053" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb854-1054"><a href="#cb854-1054" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(df) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb854-1055"><a href="#cb854-1055" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(</span>
<span id="cb854-1056"><a href="#cb854-1056" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> item_test_NABS<span class="sc">/</span><span class="dv">8</span>,</span>
<span id="cb854-1057"><a href="#cb854-1057" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_trans =</span> (accuracy <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n,</span>
<span id="cb854-1058"><a href="#cb854-1058" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_trans =</span> (DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb854-1059"><a href="#cb854-1059" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-1060"><a href="#cb854-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1061"><a href="#cb854-1061" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION</span></span>
<span id="cb854-1062"><a href="#cb854-1062" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( test_trans <span class="sc">~</span> pretty_condition    , <span class="at">data =</span> df)</span>
<span id="cb854-1063"><a href="#cb854-1063" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm1)</span></span>
<span id="cb854-1064"><a href="#cb854-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1065"><a href="#cb854-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION on LOGTRANSFORMED</span></span>
<span id="cb854-1066"><a href="#cb854-1066" aria-hidden="true" tabindex="-1"></a>qlm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( <span class="fu">qlogis</span>(test_trans) <span class="sc">~</span> pretty_condition    , <span class="at">data =</span> df)</span>
<span id="cb854-1067"><a href="#cb854-1067" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(qlm1)</span></span>
<span id="cb854-1068"><a href="#cb854-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1069"><a href="#cb854-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># FRACTIONAL REGRESSION</span></span>
<span id="cb854-1070"><a href="#cb854-1070" aria-hidden="true" tabindex="-1"></a><span class="co">#uses quasibinomial [like binomial] on proportion </span></span>
<span id="cb854-1071"><a href="#cb854-1071" aria-hidden="true" tabindex="-1"></a><span class="co">#instead of binomial data. coeffs on logit scale</span></span>
<span id="cb854-1072"><a href="#cb854-1072" aria-hidden="true" tabindex="-1"></a>flm1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( test_trans <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">quasibinomial</span>())</span>
<span id="cb854-1073"><a href="#cb854-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flm1)</span>
<span id="cb854-1074"><a href="#cb854-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1075"><a href="#cb854-1075" aria-hidden="true" tabindex="-1"></a><span class="co"># BETA REGRESSION predictor phi</span></span>
<span id="cb854-1076"><a href="#cb854-1076" aria-hidden="true" tabindex="-1"></a>bm1 <span class="ot">&lt;-</span> <span class="fu">betareg</span>(test_trans <span class="sc">~</span> pretty_condition <span class="sc">|</span> pretty_condition, </span>
<span id="cb854-1077"><a href="#cb854-1077" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> df, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb854-1078"><a href="#cb854-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bm1)</span>
<span id="cb854-1079"><a href="#cb854-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1080"><a href="#cb854-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1081"><a href="#cb854-1081" aria-hidden="true" tabindex="-1"></a>models <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"LM"</span> <span class="ot">=</span> lm1, </span>
<span id="cb854-1082"><a href="#cb854-1082" aria-hidden="true" tabindex="-1"></a>              <span class="st">"LM log transform"</span> <span class="ot">=</span> qlm1, </span>
<span id="cb854-1083"><a href="#cb854-1083" aria-hidden="true" tabindex="-1"></a>              <span class="st">"GLM Quasibinomial"</span> <span class="ot">=</span> flm1, </span>
<span id="cb854-1084"><a href="#cb854-1084" aria-hidden="true" tabindex="-1"></a>              <span class="st">"beta"</span> <span class="ot">=</span> bm1)</span>
<span id="cb854-1085"><a href="#cb854-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(models)</span>
<span id="cb854-1086"><a href="#cb854-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1087"><a href="#cb854-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1088"><a href="#cb854-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1089"><a href="#cb854-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1092"><a href="#cb854-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1093"><a href="#cb854-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#GET ESTIMATES</span></span>
<span id="cb854-1094"><a href="#cb854-1094" aria-hidden="true" tabindex="-1"></a>model_beta <span class="ot">&lt;-</span> bm1</span>
<span id="cb854-1095"><a href="#cb854-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1096"><a href="#cb854-1096" aria-hidden="true" tabindex="-1"></a>beta_mu_intercept <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb854-1097"><a href="#cb854-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb854-1098"><a href="#cb854-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1099"><a href="#cb854-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb854-1100"><a href="#cb854-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1101"><a href="#cb854-1101" aria-hidden="true" tabindex="-1"></a>beta_mu_condition <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb854-1102"><a href="#cb854-1102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb854-1103"><a href="#cb854-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"pretty_conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1104"><a href="#cb854-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb854-1105"><a href="#cb854-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1106"><a href="#cb854-1106" aria-hidden="true" tabindex="-1"></a>beta_phi_intercept <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb854-1107"><a href="#cb854-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb854-1108"><a href="#cb854-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"precision"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1109"><a href="#cb854-1109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb854-1110"><a href="#cb854-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1111"><a href="#cb854-1111" aria-hidden="true" tabindex="-1"></a>beta_phi_condition <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb854-1112"><a href="#cb854-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb854-1113"><a href="#cb854-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"precision"</span>, term <span class="sc">==</span> <span class="st">"pretty_conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1114"><a href="#cb854-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb854-1115"><a href="#cb854-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1116"><a href="#cb854-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1117"><a href="#cb854-1117" aria-hidden="true" tabindex="-1"></a>mu_control <span class="ot">=</span> <span class="fu">plogis</span>(beta_mu_intercept)</span>
<span id="cb854-1118"><a href="#cb854-1118" aria-hidden="true" tabindex="-1"></a>phi_control <span class="ot">=</span> <span class="fu">plogis</span>(beta_phi_intercept)</span>
<span id="cb854-1119"><a href="#cb854-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#when you don’t explicitly model the precision, the resulting coefficient in the table isn’t on the log scale—it’s a regular non-logged number, so there’s no need to exponentiate</span></span>
<span id="cb854-1120"><a href="#cb854-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1121"><a href="#cb854-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT ESTIMATES</span></span>
<span id="cb854-1122"><a href="#cb854-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1123"><a href="#cb854-1123" aria-hidden="true" tabindex="-1"></a>control_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"dprop(mean = plogis("</span>, <span class="fu">round</span>(beta_mu_intercept, <span class="dv">2</span>),</span>
<span id="cb854-1124"><a href="#cb854-1124" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"), size = exp("</span>, <span class="fu">round</span>(beta_phi_intercept, <span class="dv">2</span>), <span class="st">"))"</span>)</span>
<span id="cb854-1125"><a href="#cb854-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1126"><a href="#cb854-1126" aria-hidden="true" tabindex="-1"></a>impasse_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"dprop(mean = plogis("</span>, <span class="fu">round</span>(beta_mu_intercept, <span class="dv">2</span>),</span>
<span id="cb854-1127"><a href="#cb854-1127" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" + "</span>, <span class="fu">round</span>(beta_mu_condition, <span class="dv">2</span>), </span>
<span id="cb854-1128"><a href="#cb854-1128" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"), size = exp("</span>, <span class="fu">round</span>(beta_phi_intercept, <span class="dv">2</span>),</span>
<span id="cb854-1129"><a href="#cb854-1129" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" + "</span>, <span class="fu">round</span>(beta_phi_condition, <span class="dv">2</span>), <span class="st">"))"</span>)</span>
<span id="cb854-1130"><a href="#cb854-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1131"><a href="#cb854-1131" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb854-1132"><a href="#cb854-1132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dprop, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb854-1133"><a href="#cb854-1133" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fu">exp</span>(beta_phi_intercept), </span>
<span id="cb854-1134"><a href="#cb854-1134" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mean =</span> <span class="fu">plogis</span>(beta_mu_intercept)),</span>
<span id="cb854-1135"><a href="#cb854-1135" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> control_title)) <span class="sc">+</span> </span>
<span id="cb854-1136"><a href="#cb854-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dprop, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb854-1137"><a href="#cb854-1137" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fu">exp</span>(beta_phi_intercept <span class="sc">+</span> beta_phi_condition), </span>
<span id="cb854-1138"><a href="#cb854-1138" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mean =</span> <span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition)),</span>
<span id="cb854-1139"><a href="#cb854-1139" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> impasse_title)) <span class="sc">+</span></span>
<span id="cb854-1140"><a href="#cb854-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> df, </span>
<span id="cb854-1141"><a href="#cb854-1141" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> test_trans, <span class="at">fill =</span> pretty_condition), </span>
<span id="cb854-1142"><a href="#cb854-1142" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb854-1143"><a href="#cb854-1143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Beta Regression Predictions"</span>) <span class="sc">+</span></span>
<span id="cb854-1144"><a href="#cb854-1144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-1145"><a href="#cb854-1145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb854-1146"><a href="#cb854-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1147"><a href="#cb854-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1148"><a href="#cb854-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1149"><a href="#cb854-1149" aria-hidden="true" tabindex="-1"></a>We can also convert the parameter estimates back to A and B. for the impasse condition, MU = 0.397 SIZE = 0.666</span>
<span id="cb854-1150"><a href="#cb854-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1151"><a href="#cb854-1151" aria-hidden="true" tabindex="-1"></a>a = mu <span class="sc">\*</span> phi = 0.397 <span class="sc">\*</span> 0.66 = 0.264 b = (1 - mu) <span class="sc">\*</span> phi = (1 - 0.397) <span class="sc">\*</span> 0.666 = 0.402</span>
<span id="cb854-1152"><a href="#cb854-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1153"><a href="#cb854-1153" aria-hidden="true" tabindex="-1"></a>we should expect it to look more like ... (for 50% ) a = correct = 3 b = incorrect = 10 a + b = total = 13</span>
<span id="cb854-1154"><a href="#cb854-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1155"><a href="#cb854-1155" aria-hidden="true" tabindex="-1"></a>MU = a / (a+b) <span class="sc">\[</span>the score<span class="sc">\]</span> = 3 / 13 = 0.23 PHI = a + b <span class="sc">\[</span> the total <span class="sc">\#</span> items <span class="sc">\]</span> = 13</span>
<span id="cb854-1156"><a href="#cb854-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1157"><a href="#cb854-1157" aria-hidden="true" tabindex="-1"></a>mu = 0.277 = a / (a + b) phi = 0.395 = a + b let b = 13</span>
<span id="cb854-1158"><a href="#cb854-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1161"><a href="#cb854-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1162"><a href="#cb854-1162" aria-hidden="true" tabindex="-1"></a><span class="co">#RECOVER A AND B FROM MU AND PHI</span></span>
<span id="cb854-1163"><a href="#cb854-1163" aria-hidden="true" tabindex="-1"></a>muphi_to_shapes <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, phi) {</span>
<span id="cb854-1164"><a href="#cb854-1164" aria-hidden="true" tabindex="-1"></a>  shape1 <span class="ot">&lt;-</span> mu <span class="sc">*</span> phi</span>
<span id="cb854-1165"><a href="#cb854-1165" aria-hidden="true" tabindex="-1"></a>  shape2 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> mu) <span class="sc">*</span> phi</span>
<span id="cb854-1166"><a href="#cb854-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">shape1 =</span> shape1, <span class="at">shape2 =</span> shape2))</span>
<span id="cb854-1167"><a href="#cb854-1167" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb854-1168"><a href="#cb854-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1169"><a href="#cb854-1169" aria-hidden="true" tabindex="-1"></a>shapes_to_muphi <span class="ot">&lt;-</span> <span class="cf">function</span>(shape1, shape2) {</span>
<span id="cb854-1170"><a href="#cb854-1170" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> shape1 <span class="sc">/</span> (shape1 <span class="sc">+</span> shape2)</span>
<span id="cb854-1171"><a href="#cb854-1171" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> shape1 <span class="sc">+</span> shape2</span>
<span id="cb854-1172"><a href="#cb854-1172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mu =</span> mu, <span class="at">phi =</span> phi))</span>
<span id="cb854-1173"><a href="#cb854-1173" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb854-1174"><a href="#cb854-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1175"><a href="#cb854-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"model predicts control A and B "</span>)</span>
<span id="cb854-1176"><a href="#cb854-1176" aria-hidden="true" tabindex="-1"></a><span class="fu">muphi_to_shapes</span>(mu_control, phi_control)</span>
<span id="cb854-1177"><a href="#cb854-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"should be something like "</span>)</span>
<span id="cb854-1178"><a href="#cb854-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">shapes_to_muphi</span>(<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb854-1179"><a href="#cb854-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1180"><a href="#cb854-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1181"><a href="#cb854-1181" aria-hidden="true" tabindex="-1"></a>It seems like the although the (shrinkled) beta regression model is working, it is really messing up the estimate of the PHI parameter, such that we can't even recover the A and B. I expect whole numbers, and instead I'm geting values less than 1. I think this might be because the phi value is so low (note that phi = precision, so like inverse of variance. Lower values are more less precise (more variance)). Since I have so many values near 0 and near 1 (even though I've shrunk the estimates to be in the open interval (0,1) rather than <span class="sc">\[</span>0,1<span class="sc">\]</span>, I think it causing problems with the estimation. )</span>
<span id="cb854-1182"><a href="#cb854-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1183"><a href="#cb854-1183" aria-hidden="true" tabindex="-1"></a><span class="fu">#### bayesian version</span></span>
<span id="cb854-1184"><a href="#cb854-1184" aria-hidden="true" tabindex="-1"></a>https://www.bayesrulesbook.com/</span>
<span id="cb854-1185"><a href="#cb854-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1188"><a href="#cb854-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1189"><a href="#cb854-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb854-1190"><a href="#cb854-1190" aria-hidden="true" tabindex="-1"></a>model_beta_bayes <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb854-1191"><a href="#cb854-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(test_trans <span class="sc">~</span> pretty_condition,</span>
<span id="cb854-1192"><a href="#cb854-1192" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> pretty_condition),</span>
<span id="cb854-1193"><a href="#cb854-1193" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb854-1194"><a href="#cb854-1194" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">Beta</span>(),</span>
<span id="cb854-1195"><a href="#cb854-1195" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb854-1196"><a href="#cb854-1196" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-1197"><a href="#cb854-1197" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the cmdstanr backend for Stan because it's faster and more modern than</span></span>
<span id="cb854-1198"><a href="#cb854-1198" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the default rstan You need to install the cmdstanr package first</span></span>
<span id="cb854-1199"><a href="#cb854-1199" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (https://mc-stan.org/cmdstanr/) and then run cmdstanr::install_cmdstan() to</span></span>
<span id="cb854-1200"><a href="#cb854-1200" aria-hidden="true" tabindex="-1"></a>  <span class="co"># install cmdstan on your computer.</span></span>
<span id="cb854-1201"><a href="#cb854-1201" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span></span>
<span id="cb854-1202"><a href="#cb854-1202" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1203"><a href="#cb854-1203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1204"><a href="#cb854-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1207"><a href="#cb854-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1208"><a href="#cb854-1208" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_beta_bayes)</span>
<span id="cb854-1209"><a href="#cb854-1209" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Cool! parameters are almost identical to betareg"</span>)</span>
<span id="cb854-1210"><a href="#cb854-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1211"><a href="#cb854-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1214"><a href="#cb854-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1215"><a href="#cb854-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb854-1216"><a href="#cb854-1216" aria-hidden="true" tabindex="-1"></a>posterior_beta <span class="ot">&lt;-</span> model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb854-1217"><a href="#cb854-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(<span class="st">`</span><span class="at">b_.*</span><span class="st">`</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1218"><a href="#cb854-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">component =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(.variable, <span class="st">"phi_"</span>), <span class="st">"Precision"</span>, <span class="st">"Mean"</span>),</span>
<span id="cb854-1219"><a href="#cb854-1219" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercept =</span> <span class="fu">str_detect</span>(.variable, <span class="st">"Intercept"</span>))</span>
<span id="cb854-1220"><a href="#cb854-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1221"><a href="#cb854-1221" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(posterior_beta, <span class="fu">aes</span>(<span class="at">x =</span> .value, <span class="at">y =</span> <span class="fu">fct_rev</span>(.variable), <span class="at">fill =</span> component)) <span class="sc">+</span></span>
<span id="cb854-1222"><a href="#cb854-1222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb854-1223"><a href="#cb854-1223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">slab_alpha =</span> intercept), </span>
<span id="cb854-1224"><a href="#cb854-1224" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.95</span>), <span class="at">point_interval =</span> <span class="st">"median_hdi"</span>) <span class="sc">+</span></span>
<span id="cb854-1225"><a href="#cb854-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">end =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb854-1226"><a href="#cb854-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_slab_alpha_discrete</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb854-1227"><a href="#cb854-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">slab_alpha =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb854-1228"><a href="#cb854-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Coefficient"</span>, <span class="at">y =</span> <span class="st">"Variable"</span>,</span>
<span id="cb854-1229"><a href="#cb854-1229" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"80% and 95% credible intervals shown in black; RAW COEFF"</span>) <span class="sc">+</span></span>
<span id="cb854-1230"><a href="#cb854-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(component), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb854-1231"><a href="#cb854-1231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>()</span>
<span id="cb854-1232"><a href="#cb854-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1233"><a href="#cb854-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1234"><a href="#cb854-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1235"><a href="#cb854-1235" aria-hidden="true" tabindex="-1"></a><span class="do">##GET USEFUL ESTIMATES</span></span>
<span id="cb854-1236"><a href="#cb854-1236" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TRANSFORMED ESTIMATES"</span>)</span>
<span id="cb854-1237"><a href="#cb854-1237" aria-hidden="true" tabindex="-1"></a>model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb854-1238"><a href="#cb854-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(<span class="st">`</span><span class="at">b_.*</span><span class="st">`</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1239"><a href="#cb854-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"b_phi"</span>), <span class="sc">~</span><span class="fu">exp</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb854-1240"><a href="#cb854-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>((<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"."</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"b_phi"</span>)), <span class="sc">~</span><span class="fu">plogis</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb854-1241"><a href="#cb854-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_variables</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb854-1242"><a href="#cb854-1242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_hdi</span>()</span>
<span id="cb854-1243"><a href="#cb854-1243" aria-hidden="true" tabindex="-1"></a><span class="co"># now phi is a raw value indicating precision</span></span>
<span id="cb854-1244"><a href="#cb854-1244" aria-hidden="true" tabindex="-1"></a><span class="co"># now mu is an odds ratio for median? of the distribution</span></span>
<span id="cb854-1245"><a href="#cb854-1245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1246"><a href="#cb854-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1247"><a href="#cb854-1247" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bayesian predictions</span></span>
<span id="cb854-1248"><a href="#cb854-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1251"><a href="#cb854-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1252"><a href="#cb854-1252" aria-hidden="true" tabindex="-1"></a><span class="co"># Plug a dataset where quota is FALSE and TRUE into the model</span></span>
<span id="cb854-1253"><a href="#cb854-1253" aria-hidden="true" tabindex="-1"></a>beta_bayes_pred <span class="ot">&lt;-</span> model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb854-1254"><a href="#cb854-1254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epred_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">pretty_condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>)))</span>
<span id="cb854-1255"><a href="#cb854-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1256"><a href="#cb854-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_bayes_pred, </span>
<span id="cb854-1257"><a href="#cb854-1257" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> .epred, <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> pretty_condition)) <span class="sc">+</span></span>
<span id="cb854-1258"><a href="#cb854-1258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.95</span>), <span class="at">point_interval =</span> <span class="st">"median_hdi"</span>) <span class="sc">+</span></span>
<span id="cb854-1259"><a href="#cb854-1259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb854-1260"><a href="#cb854-1260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb854-1261"><a href="#cb854-1261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted Comprehension Task Score Percentage Correct"</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb854-1262"><a href="#cb854-1262" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"80% and 95% credible intervals shown in black"</span>) <span class="sc">+</span></span>
<span id="cb854-1263"><a href="#cb854-1263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>()</span>
<span id="cb854-1264"><a href="#cb854-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1265"><a href="#cb854-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1268"><a href="#cb854-1268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1269"><a href="#cb854-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO POSTERIOR PREDICTIVE CHECKS </span></span>
<span id="cb854-1270"><a href="#cb854-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1271"><a href="#cb854-1271" aria-hidden="true" tabindex="-1"></a><span class="co"># describe_posterior(model_beta_bayes, test = c("p_direction", "rope", "bayesfactor"))</span></span>
<span id="cb854-1272"><a href="#cb854-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1273"><a href="#cb854-1273" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstanarm)</span></span>
<span id="cb854-1274"><a href="#cb854-1274" aria-hidden="true" tabindex="-1"></a><span class="co"># pp_check(model_beta_bayes, plotfun = "boxplot", nreps = 10, notch = FALSE)</span></span>
<span id="cb854-1275"><a href="#cb854-1275" aria-hidden="true" tabindex="-1"></a><span class="co"># pp_check(model_beta_bayes, plotfun = "stat_grouped", stat = "median", group = "pretty_condition")</span></span>
<span id="cb854-1276"><a href="#cb854-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1277"><a href="#cb854-1277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1278"><a href="#cb854-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">### ZERO INFLATED BETA </span></span>
<span id="cb854-1279"><a href="#cb854-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1280"><a href="#cb854-1280" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>logistic regression for zero inflated $\alpha$ (logit scale)</span>
<span id="cb854-1281"><a href="#cb854-1281" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>beta regression for proportion $\mu$ (logit scale) and $\phi$ (log scale)</span>
<span id="cb854-1282"><a href="#cb854-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1285"><a href="#cb854-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1286"><a href="#cb854-1286" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, DV_percent_NABS) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1287"><a href="#cb854-1287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb854-1288"><a href="#cb854-1288" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> pretty_condition,</span>
<span id="cb854-1289"><a href="#cb854-1289" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> DV_percent_NABS</span>
<span id="cb854-1290"><a href="#cb854-1290" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-1291"><a href="#cb854-1291" aria-hidden="true" tabindex="-1"></a><span class="co">#shrink accuracy just a tiny bit from 1 for testing purposes </span></span>
<span id="cb854-1292"><a href="#cb854-1292" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyfst)</span>
<span id="cb854-1293"><a href="#cb854-1293" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate_when</span>(accuracy <span class="sc">==</span> <span class="dv">1</span>, <span class="at">accuracy =</span> <span class="fl">0.99</span>)</span>
<span id="cb854-1294"><a href="#cb854-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1295"><a href="#cb854-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERCEPT ONLY model for alpha</span></span>
<span id="cb854-1296"><a href="#cb854-1296" aria-hidden="true" tabindex="-1"></a>zinb <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb854-1297"><a href="#cb854-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(accuracy <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb854-1298"><a href="#cb854-1298" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb854-1299"><a href="#cb854-1299" aria-hidden="true" tabindex="-1"></a>     zi <span class="sc">~</span> condition), <span class="co">#zero inflated is extreme? alpha</span></span>
<span id="cb854-1300"><a href="#cb854-1300" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb854-1301"><a href="#cb854-1301" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_inflated_beta</span>(),</span>
<span id="cb854-1302"><a href="#cb854-1302" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb854-1303"><a href="#cb854-1303" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-1304"><a href="#cb854-1304" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-1305"><a href="#cb854-1305" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/zinb.rds"</span></span>
<span id="cb854-1306"><a href="#cb854-1306" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1307"><a href="#cb854-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1310"><a href="#cb854-1310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1311"><a href="#cb854-1311" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb)</span>
<span id="cb854-1312"><a href="#cb854-1312" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb)</span>
<span id="cb854-1313"><a href="#cb854-1313" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(zinb))</span></span>
<span id="cb854-1314"><a href="#cb854-1314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1315"><a href="#cb854-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1316"><a href="#cb854-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1319"><a href="#cb854-1319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1320"><a href="#cb854-1320" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(zinb, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb854-1321"><a href="#cb854-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1322"><a href="#cb854-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1323"><a href="#cb854-1323" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"INTERPRET ALPHA"</span>)</span>
<span id="cb854-1324"><a href="#cb854-1324" aria-hidden="true" tabindex="-1"></a>zi_intercept <span class="ot">&lt;-</span> <span class="fu">tidy</span>(zinb, <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1325"><a href="#cb854-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"zi"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1326"><a href="#cb854-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb854-1327"><a href="#cb854-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1328"><a href="#cb854-1328" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit scale intercept</span></span>
<span id="cb854-1329"><a href="#cb854-1329" aria-hidden="true" tabindex="-1"></a>zi_intercept</span>
<span id="cb854-1330"><a href="#cb854-1330" aria-hidden="true" tabindex="-1"></a><span class="do">## b_zi_Intercept </span></span>
<span id="cb854-1331"><a href="#cb854-1331" aria-hidden="true" tabindex="-1"></a><span class="do">##          0.525</span></span>
<span id="cb854-1332"><a href="#cb854-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1333"><a href="#cb854-1333" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformed to a probability/proportion</span></span>
<span id="cb854-1334"><a href="#cb854-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(zi_intercept)</span>
<span id="cb854-1335"><a href="#cb854-1335" aria-hidden="true" tabindex="-1"></a><span class="do">## b_zi_Intercept </span></span>
<span id="cb854-1336"><a href="#cb854-1336" aria-hidden="true" tabindex="-1"></a><span class="do">##         0.628</span></span>
<span id="cb854-1337"><a href="#cb854-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1338"><a href="#cb854-1338" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(accuracy <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> condition <span class="sc">==</span> <span class="st">"control"</span>))<span class="sc">/</span><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>))</span>
<span id="cb854-1339"><a href="#cb854-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1340"><a href="#cb854-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1341"><a href="#cb854-1341" aria-hidden="true" tabindex="-1"></a>The value of the z_intercept should be the same as the proportion of 0s in the control condition. </span>
<span id="cb854-1342"><a href="#cb854-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1343"><a href="#cb854-1343" aria-hidden="true" tabindex="-1"></a>VISUALIZE ZERO INFLATED COMPONENT</span>
<span id="cb854-1346"><a href="#cb854-1346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1347"><a href="#cb854-1347" aria-hidden="true" tabindex="-1"></a>beta_zi_pred_int <span class="ot">&lt;-</span> zinb <span class="sc">%&gt;%</span> </span>
<span id="cb854-1348"><a href="#cb854-1348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1349"><a href="#cb854-1349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_zero =</span> .prediction <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb854-1350"><a href="#cb854-1350" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_zero, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb854-1351"><a href="#cb854-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1352"><a href="#cb854-1352" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb854-1353"><a href="#cb854-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_zero), <span class="at">binwidth =</span> <span class="fl">0.025</span>, </span>
<span id="cb854-1354"><a href="#cb854-1354" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb854-1355"><a href="#cb854-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb854-1356"><a href="#cb854-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb854-1357"><a href="#cb854-1357" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb854-1358"><a href="#cb854-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb854-1359"><a href="#cb854-1359" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is zero?"</span>) <span class="sc">+</span></span>
<span id="cb854-1360"><a href="#cb854-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb854-1361"><a href="#cb854-1361" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb854-1362"><a href="#cb854-1362" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb854-1363"><a href="#cb854-1363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-1364"><a href="#cb854-1364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb854-1365"><a href="#cb854-1365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1366"><a href="#cb854-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1367"><a href="#cb854-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1368"><a href="#cb854-1368" aria-hidden="true" tabindex="-1"></a><span class="fu">### ZERO-ONE INFLATED BETA Regression</span></span>
<span id="cb854-1369"><a href="#cb854-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1370"><a href="#cb854-1370" aria-hidden="true" tabindex="-1"></a>https://sometimesir.com/posts/2019-02-18-analyze-analog-scale-ratings-with-zero-one-inflated-beta-models/#zoib-regression</span>
<span id="cb854-1371"><a href="#cb854-1371" aria-hidden="true" tabindex="-1"></a>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</span>
<span id="cb854-1372"><a href="#cb854-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1373"><a href="#cb854-1373" aria-hidden="true" tabindex="-1"></a>**TODO** </span>
<span id="cb854-1374"><a href="#cb854-1374" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>explore priors</span>
<span id="cb854-1375"><a href="#cb854-1375" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>explore random effects</span>
<span id="cb854-1376"><a href="#cb854-1376" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>explore non-beta distribution; once the 1s and zeros are gone, do we need the beta? </span>
<span id="cb854-1377"><a href="#cb854-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1378"><a href="#cb854-1378" aria-hidden="true" tabindex="-1"></a>A zero-inflated beta regression allows us to model a separate data generating process for the 0s and 1s and the rest.</span>
<span id="cb854-1379"><a href="#cb854-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1380"><a href="#cb854-1380" aria-hidden="true" tabindex="-1"></a>A ZOINB is a mixture of:</span>
<span id="cb854-1381"><a href="#cb854-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1382"><a href="#cb854-1382" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>A logistic regression model that predicts if an outcome is either 0 or 1 or not 0 or 1, defined by (or alternatively, a model that predicts if outcomes are extreme (0 or 1) or not (between 0 and 1); "IS EXTREME" model; defined by $\alpha$</span>
<span id="cb854-1383"><a href="#cb854-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1384"><a href="#cb854-1384" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>A logistic regression model that predicts if any of the 0 or 1 outcomes are actually 1s, defined by (or alternatively, a model that predicts if the extreme values are 1) "WHICH EXTREME" model defined by $\gamma$</span>
<span id="cb854-1385"><a href="#cb854-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1386"><a href="#cb854-1386" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>A beta regression model that predicts if an outcome is between 0 and 1 if it's not zero or not one, defined by and (or alternatively, a model that predicts the non-extreme (0 or 1) values) "THE REST" model $\mu$ and $\phi$</span>
<span id="cb854-1387"><a href="#cb854-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1388"><a href="#cb854-1388" aria-hidden="true" tabindex="-1"></a>Can also do mixed! (but no reason do this here, as the item level data is not beta reg )</span>
<span id="cb854-1389"><a href="#cb854-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1392"><a href="#cb854-1392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1393"><a href="#cb854-1393" aria-hidden="true" tabindex="-1"></a><span class="co">#DATA SETUP</span></span>
<span id="cb854-1394"><a href="#cb854-1394" aria-hidden="true" tabindex="-1"></a><span class="co"># sub &lt;- df_subjects %&gt;% dplyr::select(condition, DV_percent_NABS) </span></span>
<span id="cb854-1395"><a href="#cb854-1395" aria-hidden="true" tabindex="-1"></a><span class="co"># don't need to transform anymore</span></span>
<span id="cb854-1396"><a href="#cb854-1396" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1397"><a href="#cb854-1397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb854-1398"><a href="#cb854-1398" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> pretty_condition,</span>
<span id="cb854-1399"><a href="#cb854-1399" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaled =</span> (s_SCALED <span class="sc">+</span> <span class="dv">13</span>)<span class="sc">/</span><span class="dv">26</span>,  <span class="co">#transform scaled onto 0-1 scale</span></span>
<span id="cb854-1400"><a href="#cb854-1400" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> item_test_NABS<span class="sc">/</span><span class="dv">8</span></span>
<span id="cb854-1401"><a href="#cb854-1401" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, scaled, accuracy)</span>
<span id="cb854-1402"><a href="#cb854-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1403"><a href="#cb854-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1404"><a href="#cb854-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERCEPT ONLY model for alpha</span></span>
<span id="cb854-1405"><a href="#cb854-1405" aria-hidden="true" tabindex="-1"></a>zoinb <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb854-1406"><a href="#cb854-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(accuracy <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb854-1407"><a href="#cb854-1407" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb854-1408"><a href="#cb854-1408" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition, <span class="co">#is extreme? alpha</span></span>
<span id="cb854-1409"><a href="#cb854-1409" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition), <span class="co">#is 1? gamma</span></span>
<span id="cb854-1410"><a href="#cb854-1410" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb854-1411"><a href="#cb854-1411" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb854-1412"><a href="#cb854-1412" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb854-1413"><a href="#cb854-1413" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-1414"><a href="#cb854-1414" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-1415"><a href="#cb854-1415" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/zoinb.rds"</span></span>
<span id="cb854-1416"><a href="#cb854-1416" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1417"><a href="#cb854-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1418"><a href="#cb854-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1419"><a href="#cb854-1419" aria-hidden="true" tabindex="-1"></a>zoinb_scaled <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb854-1420"><a href="#cb854-1420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(scaled <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb854-1421"><a href="#cb854-1421" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb854-1422"><a href="#cb854-1422" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition, <span class="co">#is extreme? alpha</span></span>
<span id="cb854-1423"><a href="#cb854-1423" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition), <span class="co">#is 1? gamma</span></span>
<span id="cb854-1424"><a href="#cb854-1424" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb854-1425"><a href="#cb854-1425" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb854-1426"><a href="#cb854-1426" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb854-1427"><a href="#cb854-1427" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-1428"><a href="#cb854-1428" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-1429"><a href="#cb854-1429" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/zoinb_scaled.rds"</span></span>
<span id="cb854-1430"><a href="#cb854-1430" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1431"><a href="#cb854-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1432"><a href="#cb854-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1435"><a href="#cb854-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1436"><a href="#cb854-1436" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zoinb)</span>
<span id="cb854-1437"><a href="#cb854-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1438"><a href="#cb854-1438" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(zoinb))</span>
<span id="cb854-1439"><a href="#cb854-1439" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb)</span>
<span id="cb854-1440"><a href="#cb854-1440" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(zoinb_scaled))</span>
<span id="cb854-1441"><a href="#cb854-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb_scaled)</span>
<span id="cb854-1442"><a href="#cb854-1442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1443"><a href="#cb854-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1444"><a href="#cb854-1444" aria-hidden="true" tabindex="-1"></a>More plots </span>
<span id="cb854-1445"><a href="#cb854-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1448"><a href="#cb854-1448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1449"><a href="#cb854-1449" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(zoinb, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb854-1450"><a href="#cb854-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1451"><a href="#cb854-1451" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"INTERPRET ALPHA"</span>)</span>
<span id="cb854-1452"><a href="#cb854-1452" aria-hidden="true" tabindex="-1"></a>zoi_intercept <span class="ot">&lt;-</span> <span class="fu">tidy</span>(zoinb, <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1453"><a href="#cb854-1453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"cond"</span>, term <span class="sc">==</span> <span class="st">"zoi_(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1454"><a href="#cb854-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb854-1455"><a href="#cb854-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1456"><a href="#cb854-1456" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit scale intercept</span></span>
<span id="cb854-1457"><a href="#cb854-1457" aria-hidden="true" tabindex="-1"></a>zoi_intercept</span>
<span id="cb854-1458"><a href="#cb854-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1459"><a href="#cb854-1459" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformed to a probability/proportion</span></span>
<span id="cb854-1460"><a href="#cb854-1460" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(zoi_intercept)</span>
<span id="cb854-1461"><a href="#cb854-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1462"><a href="#cb854-1462" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(accuracy <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">&amp;</span> condition <span class="sc">==</span> <span class="st">"control"</span>))<span class="sc">/</span><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>))</span>
<span id="cb854-1463"><a href="#cb854-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1464"><a href="#cb854-1464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1465"><a href="#cb854-1465" aria-hidden="true" tabindex="-1"></a>The value of the zoi_intercept should be the same as the proportion of 0s and 1s (vs non 0s and 1s) in the control condition... and it does!</span>
<span id="cb854-1466"><a href="#cb854-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1467"><a href="#cb854-1467" aria-hidden="true" tabindex="-1"></a>VISUALIZE ZERO INFLATED COMPONENT</span>
<span id="cb854-1470"><a href="#cb854-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1471"><a href="#cb854-1471" aria-hidden="true" tabindex="-1"></a>beta_zoi_pred_int <span class="ot">&lt;-</span> zoinb <span class="sc">%&gt;%</span> </span>
<span id="cb854-1472"><a href="#cb854-1472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1473"><a href="#cb854-1473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_extreme =</span> .prediction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb854-1474"><a href="#cb854-1474" aria-hidden="true" tabindex="-1"></a>         <span class="at">is_one =</span> .prediction <span class="sc">==</span><span class="dv">1</span>, </span>
<span id="cb854-1475"><a href="#cb854-1475" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_extreme <span class="sc">&amp;</span> <span class="sc">!</span>is_one, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction),</span>
<span id="cb854-1476"><a href="#cb854-1476" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_one, .prediction <span class="sc">+</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb854-1477"><a href="#cb854-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1478"><a href="#cb854-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zoi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb854-1479"><a href="#cb854-1479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_extreme), <span class="at">binwidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb854-1480"><a href="#cb854-1480" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb854-1481"><a href="#cb854-1481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb854-1482"><a href="#cb854-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-1483"><a href="#cb854-1483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb854-1484"><a href="#cb854-1484" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb854-1485"><a href="#cb854-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb854-1486"><a href="#cb854-1486" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is extreme?"</span>) <span class="sc">+</span></span>
<span id="cb854-1487"><a href="#cb854-1487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb854-1488"><a href="#cb854-1488" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb854-1489"><a href="#cb854-1489" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb854-1490"><a href="#cb854-1490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-1491"><a href="#cb854-1491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb854-1492"><a href="#cb854-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1495"><a href="#cb854-1495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1496"><a href="#cb854-1496" aria-hidden="true" tabindex="-1"></a>beta_zoi_pred_int <span class="ot">&lt;-</span> zoinb_scaled <span class="sc">%&gt;%</span> </span>
<span id="cb854-1497"><a href="#cb854-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1498"><a href="#cb854-1498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_extreme =</span> .prediction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb854-1499"><a href="#cb854-1499" aria-hidden="true" tabindex="-1"></a>         <span class="at">is_one =</span> .prediction <span class="sc">==</span><span class="dv">1</span>, </span>
<span id="cb854-1500"><a href="#cb854-1500" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_extreme <span class="sc">&amp;</span> <span class="sc">!</span>is_one, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction),</span>
<span id="cb854-1501"><a href="#cb854-1501" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_one, .prediction <span class="sc">+</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb854-1502"><a href="#cb854-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1503"><a href="#cb854-1503" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zoi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb854-1504"><a href="#cb854-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_extreme), <span class="at">binwidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb854-1505"><a href="#cb854-1505" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb854-1506"><a href="#cb854-1506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb854-1507"><a href="#cb854-1507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb854-1508"><a href="#cb854-1508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb854-1509"><a href="#cb854-1509" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb854-1510"><a href="#cb854-1510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb854-1511"><a href="#cb854-1511" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is extreme?"</span>) <span class="sc">+</span></span>
<span id="cb854-1512"><a href="#cb854-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb854-1513"><a href="#cb854-1513" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb854-1514"><a href="#cb854-1514" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb854-1515"><a href="#cb854-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb854-1516"><a href="#cb854-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb854-1517"><a href="#cb854-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1518"><a href="#cb854-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1519"><a href="#cb854-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1520"><a href="#cb854-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1523"><a href="#cb854-1523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1524"><a href="#cb854-1524" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(zoinb, <span class="at">draws =</span> <span class="dv">8000</span> )</span>
<span id="cb854-1525"><a href="#cb854-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1526"><a href="#cb854-1526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1527"><a href="#cb854-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1528"><a href="#cb854-1528" aria-hidden="true" tabindex="-1"></a><span class="fu">### HURDLE + NEG BINOM (bayesian)</span></span>
<span id="cb854-1529"><a href="#cb854-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1530"><a href="#cb854-1530" aria-hidden="true" tabindex="-1"></a>Rather than transform score to a proportion correct, keep it in native count form, and model as negative binomial. </span>
<span id="cb854-1531"><a href="#cb854-1531" aria-hidden="true" tabindex="-1"></a>hurdle model : </span>
<span id="cb854-1532"><a href="#cb854-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1533"><a href="#cb854-1533" aria-hidden="true" tabindex="-1"></a>(1) A logistic regression model that predicts if an outcome is 0 or not (this is the hurdle part)</span>
<span id="cb854-1534"><a href="#cb854-1534" aria-hidden="true" tabindex="-1"></a>(2) A lognormal (hurdle_lognormal()), gamma (hurdle_gamma()), Poisson (hurdle_poisson()), or negative binomial (hurdle_negbinomial()) model for outcomes that are not zero</span>
<span id="cb854-1535"><a href="#cb854-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1536"><a href="#cb854-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1539"><a href="#cb854-1539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1540"><a href="#cb854-1540" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb854-1541"><a href="#cb854-1541" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1542"><a href="#cb854-1542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb854-1543"><a href="#cb854-1543" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> item_test_NABS,</span>
<span id="cb854-1544"><a href="#cb854-1544" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> pretty_condition</span>
<span id="cb854-1545"><a href="#cb854-1545" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-1546"><a href="#cb854-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1547"><a href="#cb854-1547" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT</span></span>
<span id="cb854-1548"><a href="#cb854-1548" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>score, <span class="at">fill =</span> <span class="sc">~</span> condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition)</span>
<span id="cb854-1549"><a href="#cb854-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1550"><a href="#cb854-1550" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb854-1551"><a href="#cb854-1551" aria-hidden="true" tabindex="-1"></a>hln <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb854-1552"><a href="#cb854-1552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(score <span class="sc">~</span> condition,</span>
<span id="cb854-1553"><a href="#cb854-1553" aria-hidden="true" tabindex="-1"></a>     hu <span class="sc">~</span> condition),</span>
<span id="cb854-1554"><a href="#cb854-1554" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb854-1555"><a href="#cb854-1555" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">hurdle_lognormal</span>(),</span>
<span id="cb854-1556"><a href="#cb854-1556" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-1557"><a href="#cb854-1557" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb854-1558"><a href="#cb854-1558" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-1559"><a href="#cb854-1559" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/hln.rds"</span></span>
<span id="cb854-1560"><a href="#cb854-1560" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1561"><a href="#cb854-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1562"><a href="#cb854-1562" aria-hidden="true" tabindex="-1"></a>hnb <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb854-1563"><a href="#cb854-1563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(score <span class="sc">~</span> condition,</span>
<span id="cb854-1564"><a href="#cb854-1564" aria-hidden="true" tabindex="-1"></a>     hu <span class="sc">~</span> condition),</span>
<span id="cb854-1565"><a href="#cb854-1565" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb854-1566"><a href="#cb854-1566" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">hurdle_negbinomial</span>(),</span>
<span id="cb854-1567"><a href="#cb854-1567" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-1568"><a href="#cb854-1568" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb854-1569"><a href="#cb854-1569" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-1570"><a href="#cb854-1570" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/hnb.rds"</span></span>
<span id="cb854-1571"><a href="#cb854-1571" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1572"><a href="#cb854-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1573"><a href="#cb854-1573" aria-hidden="true" tabindex="-1"></a>hpoi <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb854-1574"><a href="#cb854-1574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(score <span class="sc">~</span> condition,</span>
<span id="cb854-1575"><a href="#cb854-1575" aria-hidden="true" tabindex="-1"></a>     hu <span class="sc">~</span> condition),</span>
<span id="cb854-1576"><a href="#cb854-1576" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb854-1577"><a href="#cb854-1577" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">hurdle_poisson</span>(),</span>
<span id="cb854-1578"><a href="#cb854-1578" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-1579"><a href="#cb854-1579" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb854-1580"><a href="#cb854-1580" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-1581"><a href="#cb854-1581" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/hpoi.rds"</span></span>
<span id="cb854-1582"><a href="#cb854-1582" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1583"><a href="#cb854-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1584"><a href="#cb854-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1585"><a href="#cb854-1585" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hln)</span>
<span id="cb854-1586"><a href="#cb854-1586" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hnb)</span>
<span id="cb854-1587"><a href="#cb854-1587" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hpoi)</span>
<span id="cb854-1588"><a href="#cb854-1588" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(hln)</span>
<span id="cb854-1589"><a href="#cb854-1589" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(hnb)</span>
<span id="cb854-1590"><a href="#cb854-1590" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(hpoi)</span>
<span id="cb854-1591"><a href="#cb854-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1592"><a href="#cb854-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1593"><a href="#cb854-1593" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(hln, hnb, hpoi)</span>
<span id="cb854-1594"><a href="#cb854-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1595"><a href="#cb854-1595" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential</span></span>
<span id="cb854-1596"><a href="#cb854-1596" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(hpoi) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Poisson Hurdle"</span>)</span>
<span id="cb854-1597"><a href="#cb854-1597" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(hnb) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"NegBinom Hurdle"</span>)</span>
<span id="cb854-1598"><a href="#cb854-1598" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(hln) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"LogNorm Hurdle"</span>)</span>
<span id="cb854-1599"><a href="#cb854-1599" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>( p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3)</span>
<span id="cb854-1600"><a href="#cb854-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1601"><a href="#cb854-1601" aria-hidden="true" tabindex="-1"></a><span class="co"># Logged</span></span>
<span id="cb854-1602"><a href="#cb854-1602" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(hpoi)</span>
<span id="cb854-1603"><a href="#cb854-1603" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">log1p</span>(df<span class="sc">$</span>score), </span>
<span id="cb854-1604"><a href="#cb854-1604" aria-hidden="true" tabindex="-1"></a>                            <span class="at">yrep =</span> <span class="fu">log1p</span>(pred[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])) <span class="sc">+</span> </span>
<span id="cb854-1605"><a href="#cb854-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Predictive Checks"</span>)</span>
<span id="cb854-1606"><a href="#cb854-1606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1609"><a href="#cb854-1609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1610"><a href="#cb854-1610" aria-hidden="true" tabindex="-1"></a>pred_gdp_hurdle <span class="ot">&lt;-</span> hpoi <span class="sc">|&gt;</span> </span>
<span id="cb854-1611"><a href="#cb854-1611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>,<span class="st">"impasse"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb854-1612"><a href="#cb854-1612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_zero =</span> .prediction <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb854-1613"><a href="#cb854-1613" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_zero, .prediction <span class="sc">-</span> <span class="fl">0.1</span>, .prediction))</span>
<span id="cb854-1614"><a href="#cb854-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1615"><a href="#cb854-1615" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_gdp_hurdle, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb854-1616"><a href="#cb854-1616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_zero), <span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb854-1617"><a href="#cb854-1617" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb854-1618"><a href="#cb854-1618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb854-1619"><a href="#cb854-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"test phase correct"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is zero?"</span>,</span>
<span id="cb854-1620"><a href="#cb854-1620" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Predicted number correct from hurdle model"</span>) <span class="sc">+</span></span>
<span id="cb854-1621"><a href="#cb854-1621" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_cartesian(xlim = c(-2500, 75000)) +</span></span>
<span id="cb854-1622"><a href="#cb854-1622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_nice</span>() <span class="sc">+</span></span>
<span id="cb854-1623"><a href="#cb854-1623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb854-1624"><a href="#cb854-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1625"><a href="#cb854-1625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1626"><a href="#cb854-1626" aria-hidden="true" tabindex="-1"></a>This model is making predictions outside the bounds of the data (beyond 8)</span>
<span id="cb854-1627"><a href="#cb854-1627" aria-hidden="true" tabindex="-1"></a>**TODO**</span>
<span id="cb854-1628"><a href="#cb854-1628" aria-hidden="true" tabindex="-1"></a>https://jsdajournal.springeropen.com/articles/10.1186/s40488-021-00121-4</span>
<span id="cb854-1629"><a href="#cb854-1629" aria-hidden="true" tabindex="-1"></a>consider motivation of hurdle vs zero inflated </span>
<span id="cb854-1630"><a href="#cb854-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1631"><a href="#cb854-1631" aria-hidden="true" tabindex="-1"></a><span class="fu">### MIXED ZERO-ONE-INFLATED BETA Regression</span></span>
<span id="cb854-1632"><a href="#cb854-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1633"><a href="#cb854-1633" aria-hidden="true" tabindex="-1"></a>Next we'll explore doing a beta regression on a proportion transformed scaled score at the item level, as a zero one inflated mixed beta reg </span>
<span id="cb854-1636"><a href="#cb854-1636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1637"><a href="#cb854-1637" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1638"><a href="#cb854-1638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1639"><a href="#cb854-1639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scaled =</span> (score_SCALED <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb854-1640"><a href="#cb854-1640" aria-hidden="true" tabindex="-1"></a>         <span class="at">condition =</span> pretty_condition) <span class="sc">%&gt;%</span> </span>
<span id="cb854-1641"><a href="#cb854-1641" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(subject, scaled, condition)</span>
<span id="cb854-1642"><a href="#cb854-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1643"><a href="#cb854-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1644"><a href="#cb854-1644" aria-hidden="true" tabindex="-1"></a>zoinb_scaled <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb854-1645"><a href="#cb854-1645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(scaled <span class="sc">~</span> condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) , <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb854-1646"><a href="#cb854-1646" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition , <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb854-1647"><a href="#cb854-1647" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition , <span class="co">#is extreme? alpha</span></span>
<span id="cb854-1648"><a href="#cb854-1648" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition ), <span class="co">#is 1? gamma</span></span>
<span id="cb854-1649"><a href="#cb854-1649" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb854-1650"><a href="#cb854-1650" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb854-1651"><a href="#cb854-1651" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb854-1652"><a href="#cb854-1652" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-1653"><a href="#cb854-1653" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-1654"><a href="#cb854-1654" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span><span class="st">"analysis/utils/models/zoinb_scaled_2.rds"</span></span>
<span id="cb854-1655"><a href="#cb854-1655" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1656"><a href="#cb854-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1657"><a href="#cb854-1657" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zoinb_scaled)</span>
<span id="cb854-1658"><a href="#cb854-1658" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb_scaled)</span>
<span id="cb854-1659"><a href="#cb854-1659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1660"><a href="#cb854-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1661"><a href="#cb854-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1662"><a href="#cb854-1662" aria-hidden="true" tabindex="-1"></a><span class="fu">### BETA HURDLE Regression (Frequentist)</span></span>
<span id="cb854-1663"><a href="#cb854-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1664"><a href="#cb854-1664" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf&gt;</span></span>
<span id="cb854-1665"><a href="#cb854-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1666"><a href="#cb854-1666" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MU tells if mean is different by condition</span>
<span id="cb854-1667"><a href="#cb854-1667" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SIGMA tells if variance is different by condition</span>
<span id="cb854-1668"><a href="#cb854-1668" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NU coefficient tells if condition yields different probability at floor</span>
<span id="cb854-1669"><a href="#cb854-1669" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAU coefficient tells if condition yields different probability at ceiling</span>
<span id="cb854-1670"><a href="#cb854-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1673"><a href="#cb854-1673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1674"><a href="#cb854-1674" aria-hidden="true" tabindex="-1"></a><span class="co">#BETA HURDLE REGRESSION EXAMPLE</span></span>
<span id="cb854-1675"><a href="#cb854-1675" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span>
<span id="cb854-1676"><a href="#cb854-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1677"><a href="#cb854-1677" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE SAMPLE DATA </span></span>
<span id="cb854-1678"><a href="#cb854-1678" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> </span>
<span id="cb854-1679"><a href="#cb854-1679" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">0.40</span> </span>
<span id="cb854-1680"><a href="#cb854-1680" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.60</span> </span>
<span id="cb854-1681"><a href="#cb854-1681" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.13</span> </span>
<span id="cb854-1682"><a href="#cb854-1682" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.17</span> </span>
<span id="cb854-1683"><a href="#cb854-1683" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> p0<span class="sc">-</span> p1</span>
<span id="cb854-1684"><a href="#cb854-1684" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> mu <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> sigma <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> (sigma <span class="sc">^</span> <span class="dv">2</span>) </span>
<span id="cb854-1685"><a href="#cb854-1685" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> mu) <span class="sc">/</span> mu</span>
<span id="cb854-1686"><a href="#cb854-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1687"><a href="#cb854-1687" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE DIST</span></span>
<span id="cb854-1688"><a href="#cb854-1688" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1839</span>) </span>
<span id="cb854-1689"><a href="#cb854-1689" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, a, b) </span>
<span id="cb854-1690"><a href="#cb854-1690" aria-hidden="true" tabindex="-1"></a>cat <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, n, <span class="at">prob =</span> <span class="fu">c</span>(p0, p2, p1), <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb854-1691"><a href="#cb854-1691" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb854-1692"><a href="#cb854-1692" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb854-1693"><a href="#cb854-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1694"><a href="#cb854-1694" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb854-1695"><a href="#cb854-1695" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y)</span>
<span id="cb854-1696"><a href="#cb854-1696" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>x<span class="sc">$</span>y)</span>
<span id="cb854-1697"><a href="#cb854-1697" aria-hidden="true" tabindex="-1"></a><span class="co">#this looks not unlike my distribution! </span></span>
<span id="cb854-1698"><a href="#cb854-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1699"><a href="#cb854-1699" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb854-1700"><a href="#cb854-1700" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb854-1701"><a href="#cb854-1701" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.sigma =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb854-1702"><a href="#cb854-1702" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.nu =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb854-1703"><a href="#cb854-1703" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.tau =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb854-1704"><a href="#cb854-1704" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">BEINF</span>() )</span>
<span id="cb854-1705"><a href="#cb854-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1706"><a href="#cb854-1706" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb854-1707"><a href="#cb854-1707" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span>
<span id="cb854-1708"><a href="#cb854-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1709"><a href="#cb854-1709" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb854-1710"><a href="#cb854-1710" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb854-1711"><a href="#cb854-1711" aria-hidden="true" tabindex="-1"></a>fit_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>mu.coefficients) </span>
<span id="cb854-1712"><a href="#cb854-1712" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,fit_mu)</span>
<span id="cb854-1713"><a href="#cb854-1713" aria-hidden="true" tabindex="-1"></a>fit_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb854-1714"><a href="#cb854-1714" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,fit_sigma)</span>
<span id="cb854-1715"><a href="#cb854-1715" aria-hidden="true" tabindex="-1"></a>fit_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>nu.coefficients) </span>
<span id="cb854-1716"><a href="#cb854-1716" aria-hidden="true" tabindex="-1"></a>fit_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>tau.coefficients) </span>
<span id="cb854-1717"><a href="#cb854-1717" aria-hidden="true" tabindex="-1"></a>fit_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb854-1718"><a href="#cb854-1718" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,fit_p0)</span>
<span id="cb854-1719"><a href="#cb854-1719" aria-hidden="true" tabindex="-1"></a>fit_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb854-1720"><a href="#cb854-1720" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,fit_p1)</span>
<span id="cb854-1721"><a href="#cb854-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1722"><a href="#cb854-1722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1723"><a href="#cb854-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1724"><a href="#cb854-1724" aria-hidden="true" tabindex="-1"></a>**BETA HURDLE INTERPRETATION** - beta component\</span>
<span id="cb854-1725"><a href="#cb854-1725" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MU "location" (mean)\</span>
<span id="cb854-1726"><a href="#cb854-1726" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SIGMA "scale" (positively related to variance; variance = sigma.squared *mean* (1-mean)\</span>
<span id="cb854-1727"><a href="#cb854-1727" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rigby, Stasinopoulos, Heller, and De Bastiani (2017) "reparameterized" the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</span>
<span id="cb854-1728"><a href="#cb854-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1729"><a href="#cb854-1729" aria-hidden="true" tabindex="-1"></a>**ZERO-ONE HURDLE COMPONENT**\</span>
<span id="cb854-1730"><a href="#cb854-1730" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.\</span>
<span id="cb854-1731"><a href="#cb854-1731" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p0 is the probability that a case equals 0,\</span>
<span id="cb854-1732"><a href="#cb854-1732" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p1 is the probability that a case equals 1,\</span>
<span id="cb854-1733"><a href="#cb854-1733" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</span>
<span id="cb854-1734"><a href="#cb854-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1737"><a href="#cb854-1737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1738"><a href="#cb854-1738" aria-hidden="true" tabindex="-1"></a><span class="co">#MY DATA</span></span>
<span id="cb854-1739"><a href="#cb854-1739" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb854-1740"><a href="#cb854-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1741"><a href="#cb854-1741" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> <span class="dv">0</span> <span class="co">#min possible value of scale</span></span>
<span id="cb854-1742"><a href="#cb854-1742" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="dv">13</span> <span class="co">#max possible value of scale</span></span>
<span id="cb854-1743"><a href="#cb854-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1744"><a href="#cb854-1744" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#for shuffling</span></span>
<span id="cb854-1745"><a href="#cb854-1745" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Rescale accuracy using </span></span>
<span id="cb854-1746"><a href="#cb854-1746" aria-hidden="true" tabindex="-1"></a><span class="co"># recommended adjustment </span></span>
<span id="cb854-1747"><a href="#cb854-1747" aria-hidden="true" tabindex="-1"></a><span class="co">#rescaled = value-min/(max-min)</span></span>
<span id="cb854-1748"><a href="#cb854-1748" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb854-1749"><a href="#cb854-1749" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> s_NABS,</span>
<span id="cb854-1750"><a href="#cb854-1750" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_acc =</span> (accuracy<span class="sc">-</span>min)<span class="sc">/</span>(max<span class="sc">-</span>min), <span class="co">#as %</span></span>
<span id="cb854-1751"><a href="#cb854-1751" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_acc =</span> (accuracy <span class="sc">*</span> (<span class="fu">nrow</span>(df)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fu">nrow</span>(df)<span class="sc">/</span>max, <span class="co">#transform for no 0 and 1</span></span>
<span id="cb854-1752"><a href="#cb854-1752" aria-hidden="true" tabindex="-1"></a>  <span class="co"># perm = shuffle(condition),</span></span>
<span id="cb854-1753"><a href="#cb854-1753" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_rt =</span> item_scaffold_rt</span>
<span id="cb854-1754"><a href="#cb854-1754" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy,R_acc, T_acc, condition,scaffold_rt)</span>
<span id="cb854-1755"><a href="#cb854-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1756"><a href="#cb854-1756" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb854-1757"><a href="#cb854-1757" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of accuracy"</span>)</span>
<span id="cb854-1758"><a href="#cb854-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1759"><a href="#cb854-1759" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb854-1760"><a href="#cb854-1760" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>T_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of [rescaled] accuracy"</span>)</span>
<span id="cb854-1761"><a href="#cb854-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1762"><a href="#cb854-1762" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_histogram(~R_acc, fill = ~perm, data = df) %&gt;% gf_facet_wrap(~perm) + labs(title = "Histogram of shuffled accuracy")</span></span>
<span id="cb854-1763"><a href="#cb854-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1764"><a href="#cb854-1764" aria-hidden="true" tabindex="-1"></a><span class="co">#SUMMARIZE SAMPLE</span></span>
<span id="cb854-1765"><a href="#cb854-1765" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Grand mean"</span>, <span class="fu">mean</span>(df<span class="sc">$</span>R_acc))</span>
<span id="cb854-1766"><a href="#cb854-1766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1767"><a href="#cb854-1767" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb854-1768"><a href="#cb854-1768" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> <span class="fu">favstats</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb854-1769"><a href="#cb854-1769" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb854-1770"><a href="#cb854-1770" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">var</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb854-1771"><a href="#cb854-1771" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Grand stats"</span>)</span>
<span id="cb854-1772"><a href="#cb854-1772" aria-hidden="true" tabindex="-1"></a>stats </span>
<span id="cb854-1773"><a href="#cb854-1773" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P0"</span>)</span>
<span id="cb854-1774"><a href="#cb854-1774" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">0</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb854-1775"><a href="#cb854-1775" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P1"</span>)</span>
<span id="cb854-1776"><a href="#cb854-1776" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">1</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb854-1777"><a href="#cb854-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1778"><a href="#cb854-1778" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb854-1779"><a href="#cb854-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1780"><a href="#cb854-1780" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb854-1781"><a href="#cb854-1781" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb854-1782"><a href="#cb854-1782" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.sigma =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb854-1783"><a href="#cb854-1783" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.nu =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb854-1784"><a href="#cb854-1784" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.tau =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb854-1785"><a href="#cb854-1785" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">BEINF</span>(), <span class="at">data =</span> df )</span>
<span id="cb854-1786"><a href="#cb854-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1787"><a href="#cb854-1787" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb854-1788"><a href="#cb854-1788" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb854-1789"><a href="#cb854-1789" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE EMPTY MODEL"</span>)</span>
<span id="cb854-1790"><a href="#cb854-1790" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb854-1791"><a href="#cb854-1791" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m0)</span>
<span id="cb854-1792"><a href="#cb854-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1793"><a href="#cb854-1793" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb854-1794"><a href="#cb854-1794" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb854-1795"><a href="#cb854-1795" aria-hidden="true" tabindex="-1"></a>m0_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>mu.coefficients) </span>
<span id="cb854-1796"><a href="#cb854-1796" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m0_mu)</span>
<span id="cb854-1797"><a href="#cb854-1797" aria-hidden="true" tabindex="-1"></a>m0_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb854-1798"><a href="#cb854-1798" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m0_sigma)</span>
<span id="cb854-1799"><a href="#cb854-1799" aria-hidden="true" tabindex="-1"></a>m0_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>nu.coefficients) </span>
<span id="cb854-1800"><a href="#cb854-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m0_nu)</span>
<span id="cb854-1801"><a href="#cb854-1801" aria-hidden="true" tabindex="-1"></a>m0_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>tau.coefficients) </span>
<span id="cb854-1802"><a href="#cb854-1802" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m0_tau)</span>
<span id="cb854-1803"><a href="#cb854-1803" aria-hidden="true" tabindex="-1"></a>m0_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb854-1804"><a href="#cb854-1804" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,m0_p0)</span>
<span id="cb854-1805"><a href="#cb854-1805" aria-hidden="true" tabindex="-1"></a>m0_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb854-1806"><a href="#cb854-1806" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,m0_p1)</span>
<span id="cb854-1807"><a href="#cb854-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1808"><a href="#cb854-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1809"><a href="#cb854-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1810"><a href="#cb854-1810" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL</span></span>
<span id="cb854-1811"><a href="#cb854-1811" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition, </span>
<span id="cb854-1812"><a href="#cb854-1812" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb854-1813"><a href="#cb854-1813" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb854-1814"><a href="#cb854-1814" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb854-1815"><a href="#cb854-1815" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb854-1816"><a href="#cb854-1816" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE PREDICTOR MODEL"</span>)</span>
<span id="cb854-1817"><a href="#cb854-1817" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb854-1818"><a href="#cb854-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1819"><a href="#cb854-1819" aria-hidden="true" tabindex="-1"></a><span class="co">#LOOKING PREDICTOR MODEL</span></span>
<span id="cb854-1820"><a href="#cb854-1820" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition , </span>
<span id="cb854-1821"><a href="#cb854-1821" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb854-1822"><a href="#cb854-1822" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb854-1823"><a href="#cb854-1823" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb854-1824"><a href="#cb854-1824" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb854-1825"><a href="#cb854-1825" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE PREDICTOR MODEL"</span>)</span>
<span id="cb854-1826"><a href="#cb854-1826" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb854-1827"><a href="#cb854-1827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1828"><a href="#cb854-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1829"><a href="#cb854-1829" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION </span><span class="al">TEST</span><span class="co">]</span></span>
<span id="cb854-1830"><a href="#cb854-1830" aria-hidden="true" tabindex="-1"></a><span class="co"># mperm &lt;- gamlss(R_acc ~ perm, ~ perm, ~ perm, ~ perm, </span></span>
<span id="cb854-1831"><a href="#cb854-1831" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, family = BEINF())</span></span>
<span id="cb854-1832"><a href="#cb854-1832" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mperm)</span></span>
<span id="cb854-1833"><a href="#cb854-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1834"><a href="#cb854-1834" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check with scaled outcome, no zeros ones</span></span>
<span id="cb854-1835"><a href="#cb854-1835" aria-hidden="true" tabindex="-1"></a><span class="co"># m3 &lt;- gamlss(T_acc ~ condition, ~ condition, ~ condition, ~ condition, </span></span>
<span id="cb854-1836"><a href="#cb854-1836" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, family = BEINF())</span></span>
<span id="cb854-1837"><a href="#cb854-1837" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m3)</span></span>
<span id="cb854-1838"><a href="#cb854-1838" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span></span>
<span id="cb854-1839"><a href="#cb854-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1840"><a href="#cb854-1840" aria-hidden="true" tabindex="-1"></a><span class="co">#investigate beta negative binomial distribution</span></span>
<span id="cb854-1841"><a href="#cb854-1841" aria-hidden="true" tabindex="-1"></a><span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span></span>
<span id="cb854-1842"><a href="#cb854-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1843"><a href="#cb854-1843" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb854-1844"><a href="#cb854-1844" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb854-1845"><a href="#cb854-1845" aria-hidden="true" tabindex="-1"></a>m1_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m1<span class="sc">$</span>mu.coefficients) </span>
<span id="cb854-1846"><a href="#cb854-1846" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m1_mu)</span>
<span id="cb854-1847"><a href="#cb854-1847" aria-hidden="true" tabindex="-1"></a>m1_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb854-1848"><a href="#cb854-1848" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m1_sigma)</span>
<span id="cb854-1849"><a href="#cb854-1849" aria-hidden="true" tabindex="-1"></a>m1_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>nu.coefficients) </span>
<span id="cb854-1850"><a href="#cb854-1850" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m1_nu)</span>
<span id="cb854-1851"><a href="#cb854-1851" aria-hidden="true" tabindex="-1"></a>m1_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>tau.coefficients) </span>
<span id="cb854-1852"><a href="#cb854-1852" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m1_tau)</span>
<span id="cb854-1853"><a href="#cb854-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1854"><a href="#cb854-1854" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb854-1855"><a href="#cb854-1855" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span>
<span id="cb854-1856"><a href="#cb854-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1857"><a href="#cb854-1857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1858"><a href="#cb854-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1859"><a href="#cb854-1859" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MU tells if mean is different by condition</span>
<span id="cb854-1860"><a href="#cb854-1860" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SIGMA tells if variance is different by condition</span>
<span id="cb854-1861"><a href="#cb854-1861" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NU coefficient tells if condition yields different probability at floor</span>
<span id="cb854-1862"><a href="#cb854-1862" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAU coefficient tells if condition yields different probability at ceiling</span>
<span id="cb854-1863"><a href="#cb854-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1864"><a href="#cb854-1864" aria-hidden="true" tabindex="-1"></a><span class="fu">## BINOMIAL OUTCOME</span></span>
<span id="cb854-1865"><a href="#cb854-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1868"><a href="#cb854-1868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1869"><a href="#cb854-1869" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1-ACCURACY</span></span>
<span id="cb854-1870"><a href="#cb854-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1871"><a href="#cb854-1871" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb854-1872"><a href="#cb854-1872" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb854-1873"><a href="#cb854-1873" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% mutate(</span></span>
<span id="cb854-1874"><a href="#cb854-1874" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = recode_factor(score_niceABS, "0" ="incorrect","1"="correct"),</span></span>
<span id="cb854-1875"><a href="#cb854-1875" aria-hidden="true" tabindex="-1"></a><span class="co">#   scaled = as.ordered(score_SCALED),</span></span>
<span id="cb854-1876"><a href="#cb854-1876" aria-hidden="true" tabindex="-1"></a><span class="co">#   q = as.factor(q),</span></span>
<span id="cb854-1877"><a href="#cb854-1877" aria-hidden="true" tabindex="-1"></a><span class="co">#   high_interpretation = as.factor(high_interpretation)</span></span>
<span id="cb854-1878"><a href="#cb854-1878" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb854-1879"><a href="#cb854-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1880"><a href="#cb854-1880" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb854-1881"><a href="#cb854-1881" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb854-1882"><a href="#cb854-1882" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df) <span class="sc">%&gt;%</span></span>
<span id="cb854-1883"><a href="#cb854-1883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb854-1884"><a href="#cb854-1884" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Question 1 Accuracy"</span>,</span>
<span id="cb854-1885"><a href="#cb854-1885" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Q1"</span>,</span>
<span id="cb854-1886"><a href="#cb854-1886" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb854-1887"><a href="#cb854-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1888"><a href="#cb854-1888" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb854-1889"><a href="#cb854-1889" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb854-1890"><a href="#cb854-1890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb854-1891"><a href="#cb854-1891" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb854-1892"><a href="#cb854-1892" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb854-1893"><a href="#cb854-1893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb854-1894"><a href="#cb854-1894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb854-1895"><a href="#cb854-1895" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb854-1896"><a href="#cb854-1896" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb854-1897"><a href="#cb854-1897" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb854-1898"><a href="#cb854-1898" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb854-1899"><a href="#cb854-1899" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb854-1900"><a href="#cb854-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1901"><a href="#cb854-1901" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1902"><a href="#cb854-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1903"><a href="#cb854-1903" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CHI SQUARE</span></span>
<span id="cb854-1904"><a href="#cb854-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1907"><a href="#cb854-1907" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1908"><a href="#cb854-1908" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-Q1</span></span>
<span id="cb854-1909"><a href="#cb854-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1910"><a href="#cb854-1910" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::CROSSTABLE</span></span>
<span id="cb854-1911"><a href="#cb854-1911" aria-hidden="true" tabindex="-1"></a><span class="co"># CrossTable( x = df$condition, y = df$accuracy, </span></span>
<span id="cb854-1912"><a href="#cb854-1912" aria-hidden="true" tabindex="-1"></a><span class="co">#              fisher = TRUE, chisq=TRUE, expected = TRUE, sresid = TRUE)</span></span>
<span id="cb854-1913"><a href="#cb854-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1914"><a href="#cb854-1914" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::MOSAIC PLOT</span></span>
<span id="cb854-1915"><a href="#cb854-1915" aria-hidden="true" tabindex="-1"></a><span class="co"># note: blue indicates cell count higher than expected, </span></span>
<span id="cb854-1916"><a href="#cb854-1916" aria-hidden="true" tabindex="-1"></a><span class="co"># red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb854-1917"><a href="#cb854-1917" aria-hidden="true" tabindex="-1"></a><span class="co"># mosaicplot(main="Accuracy on First Question by Condition",</span></span>
<span id="cb854-1918"><a href="#cb854-1918" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, pretty_condition ~ accuracy, </span></span>
<span id="cb854-1919"><a href="#cb854-1919" aria-hidden="true" tabindex="-1"></a><span class="co">#             shade = T)</span></span>
<span id="cb854-1920"><a href="#cb854-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1921"><a href="#cb854-1921" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::TABLE</span></span>
<span id="cb854-1922"><a href="#cb854-1922" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">sjtab</span>( <span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb854-1923"><a href="#cb854-1923" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>F, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb854-1924"><a href="#cb854-1924" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="fu">c</span>(<span class="st">"auto"</span>))</span>
<span id="cb854-1925"><a href="#cb854-1925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1926"><a href="#cb854-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1927"><a href="#cb854-1927" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::BAR PLOT</span></span>
<span id="cb854-1928"><a href="#cb854-1928" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> condition,</span>
<span id="cb854-1929"><a href="#cb854-1929" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span>
<span id="cb854-1930"><a href="#cb854-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1931"><a href="#cb854-1931" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::CHISQR </span><span class="al">TEST</span></span>
<span id="cb854-1932"><a href="#cb854-1932" aria-hidden="true" tabindex="-1"></a>(x <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">chisq.test</span>(<span class="at">x =</span> df<span class="sc">$</span>accuracy, <span class="at">y =</span> df<span class="sc">$</span>condition, <span class="at">simulate.p.value =</span> T))</span>
<span id="cb854-1933"><a href="#cb854-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1934"><a href="#cb854-1934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1935"><a href="#cb854-1935" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::POWER ANALYSIS</span></span>
<span id="cb854-1936"><a href="#cb854-1936" aria-hidden="true" tabindex="-1"></a>(po <span class="ot">&lt;-</span> <span class="fu">pwr.chisq.test</span>( <span class="at">w =</span> <span class="fl">0.1</span>, <span class="at">df=</span>(<span class="dv">2-1</span>), <span class="at">N =</span> <span class="fu">nrow</span>(df), <span class="at">sig.level =</span> <span class="fl">0.05</span>))</span>
<span id="cb854-1937"><a href="#cb854-1937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1938"><a href="#cb854-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1939"><a href="#cb854-1939" aria-hidden="true" tabindex="-1"></a>**A Chi-Square test of independence of Q1 accuracy \[correct,incorrect\] by condition indicates the question accuracy is not dependent on condition. *However, this test may be underpowered, as with the given sample size it has only 20% power to detect a small effect (w = 0.1)***</span>
<span id="cb854-1940"><a href="#cb854-1940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1941"><a href="#cb854-1941" aria-hidden="true" tabindex="-1"></a><span class="fu">### LOGISTIC REGRESSION</span></span>
<span id="cb854-1942"><a href="#cb854-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1943"><a href="#cb854-1943" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>http://post8000.svmiller.com/lab-scripts/logistic-regression-lab.html</span>
<span id="cb854-1944"><a href="#cb854-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1945"><a href="#cb854-1945" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression (at the subject-item level), predicting Q1 accuracy (absolute score) by condition.*\</span>
<span id="cb854-1946"><a href="#cb854-1946" aria-hidden="true" tabindex="-1"></a>*note: this example uses the combined dataset rather than lab-only, as learning notes were done with the combined and I don't want to recalcualte all the marginal probabilities by hand for learning purposes.*</span>
<span id="cb854-1947"><a href="#cb854-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1948"><a href="#cb854-1948" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fit a logistic regression predicting accuracy (absolute score) (n = r nrow(df)) by condition. (k = 2).</span>
<span id="cb854-1949"><a href="#cb854-1949" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{0}$ = Log Odds of (correct) responses in CONTROL condition</span>
<span id="cb854-1950"><a href="#cb854-1950" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{0}}$ = ODDS of correct response in CONTROL condition</span>
<span id="cb854-1951"><a href="#cb854-1951" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{1}$ = $\beta_{1impasse}$ Log Odds (Log OR; change in odds for correct response in impasse (vs) control <span class="sc">\[</span>log scale<span class="sc">\]</span>)</span>
<span id="cb854-1952"><a href="#cb854-1952" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{1}}$ = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</span>
<span id="cb854-1953"><a href="#cb854-1953" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis:$\beta_{impasse} \le 0$ the odds for a correct response does not change, or decreases</span>
<span id="cb854-1954"><a href="#cb854-1954" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative hypothesis: $\beta_{impasse} \gt 0$ the odds of a correct response increases</span>
<span id="cb854-1955"><a href="#cb854-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1956"><a href="#cb854-1956" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb854-1957"><a href="#cb854-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1958"><a href="#cb854-1958" aria-hidden="true" tabindex="-1"></a>*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*</span>
<span id="cb854-1959"><a href="#cb854-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1962"><a href="#cb854-1962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-1963"><a href="#cb854-1963" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-Q1ACC-LOG-combined</span></span>
<span id="cb854-1964"><a href="#cb854-1964" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb854-1965"><a href="#cb854-1965" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb854-1966"><a href="#cb854-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1967"><a href="#cb854-1967" aria-hidden="true" tabindex="-1"></a><span class="co">#combined dataset, not lab only</span></span>
<span id="cb854-1968"><a href="#cb854-1968" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb854-1969"><a href="#cb854-1969" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS)</span>
<span id="cb854-1970"><a href="#cb854-1970" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-1971"><a href="#cb854-1971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1972"><a href="#cb854-1972" aria-hidden="true" tabindex="-1"></a><span class="co"># FREQUENCY TABLE</span></span>
<span id="cb854-1973"><a href="#cb854-1973" aria-hidden="true" tabindex="-1"></a><span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span></span>
<span id="cb854-1974"><a href="#cb854-1974" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(my.table) #counts</span></span>
<span id="cb854-1975"><a href="#cb854-1975" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(prop.table(my.table)) #props</span></span>
<span id="cb854-1976"><a href="#cb854-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1977"><a href="#cb854-1977" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb854-1978"><a href="#cb854-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1979"><a href="#cb854-1979" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb854-1980"><a href="#cb854-1980" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb854-1981"><a href="#cb854-1981" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"EMPTY MODEL"</span>)</span>
<span id="cb854-1982"><a href="#cb854-1982" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb854-1983"><a href="#cb854-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1984"><a href="#cb854-1984" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb854-1985"><a href="#cb854-1985" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb854-1986"><a href="#cb854-1986" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb854-1987"><a href="#cb854-1987" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb854-1988"><a href="#cb854-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1989"><a href="#cb854-1989" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb854-1990"><a href="#cb854-1990" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span>
<span id="cb854-1991"><a href="#cb854-1991" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb854-1992"><a href="#cb854-1992" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb854-1993"><a href="#cb854-1993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-1994"><a href="#cb854-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1995"><a href="#cb854-1995" aria-hidden="true" tabindex="-1"></a>*The Condition predictor significantly improves model fit.*</span>
<span id="cb854-1996"><a href="#cb854-1996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-1997"><a href="#cb854-1997" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Learning Notes</span></span>
<span id="cb854-1998"><a href="#cb854-1998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2001"><a href="#cb854-2001" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2002"><a href="#cb854-2002" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-Q1ACC-LOG-combined</span></span>
<span id="cb854-2003"><a href="#cb854-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2004"><a href="#cb854-2004" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb854-2005"><a href="#cb854-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2006"><a href="#cb854-2006" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb854-2007"><a href="#cb854-2007" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb854-2008"><a href="#cb854-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2009"><a href="#cb854-2009" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb854-2010"><a href="#cb854-2010" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- LOG ODDS"</span>)</span>
<span id="cb854-2011"><a href="#cb854-2011" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span>
<span id="cb854-2012"><a href="#cb854-2012" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span>
<span id="cb854-2013"><a href="#cb854-2013" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(<span class="fu">confint</span>(m1)))) <span class="co">#exponentiate)</span></span>
<span id="cb854-2014"><a href="#cb854-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2015"><a href="#cb854-2015" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- PROBABILITIES"</span>)</span>
<span id="cb854-2016"><a href="#cb854-2016" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"[these should math pred plots]"</span>)</span>
<span id="cb854-2017"><a href="#cb854-2017" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at reference level"</span>)</span>
<span id="cb854-2018"><a href="#cb854-2018" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])</span>
<span id="cb854-2019"><a href="#cb854-2019" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at coefficient level"</span>)</span>
<span id="cb854-2020"><a href="#cb854-2020" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]] <span class="sc">+</span> m1<span class="sc">$</span>coefficients[[<span class="dv">2</span>]])</span>
<span id="cb854-2021"><a href="#cb854-2021" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"CHANGE in probability by coefficient"</span>)</span>
<span id="cb854-2022"><a href="#cb854-2022" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]] <span class="sc">+</span> m1<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]) <span class="sc">-</span> <span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])</span>
<span id="cb854-2023"><a href="#cb854-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2024"><a href="#cb854-2024" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span>
<span id="cb854-2025"><a href="#cb854-2025" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb854-2026"><a href="#cb854-2026" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb854-2027"><a href="#cb854-2027" aria-hidden="true" tabindex="-1"></a>pred.control <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"control"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb854-2028"><a href="#cb854-2028" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient)</span></span>
<span id="cb854-2029"><a href="#cb854-2029" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in control,"</span>, pred.control)</span>
<span id="cb854-2030"><a href="#cb854-2030" aria-hidden="true" tabindex="-1"></a>pred.impasse <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"impasse"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb854-2031"><a href="#cb854-2031" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient + predictor coeff)</span></span>
<span id="cb854-2032"><a href="#cb854-2032" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in impasse,"</span>, pred.impasse)</span>
<span id="cb854-2033"><a href="#cb854-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2034"><a href="#cb854-2034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2035"><a href="#cb854-2035" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb854-2036"><a href="#cb854-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2037"><a href="#cb854-2037" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb854-2038"><a href="#cb854-2038" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb854-2039"><a href="#cb854-2039" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half</span></span>
<span id="cb854-2040"><a href="#cb854-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2041"><a href="#cb854-2041" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb854-2042"><a href="#cb854-2042" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb854-2043"><a href="#cb854-2043" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"p value for two-tailed test, null B = 0 : "</span>,<span class="fu">round</span>(tt,<span class="dv">3</span>))</span>
<span id="cb854-2044"><a href="#cb854-2044" aria-hidden="true" tabindex="-1"></a>ot <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb854-2045"><a href="#cb854-2045" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"BUT we want a one tailed directional, null: B &lt;= 0: "</span>,<span class="fu">round</span>(ot,<span class="dv">3</span>))</span>
<span id="cb854-2046"><a href="#cb854-2046" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"adjusted confint for directional hypothesis"</span>)</span>
<span id="cb854-2047"><a href="#cb854-2047" aria-hidden="true" tabindex="-1"></a>(dcint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1, <span class="at">level =</span> <span class="fl">0.90</span>)) <span class="co"># get 90% for right side))</span></span>
<span id="cb854-2048"><a href="#cb854-2048" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb854-2049"><a href="#cb854-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2050"><a href="#cb854-2050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2051"><a href="#cb854-2051" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS [directional]</span></span>
<span id="cb854-2052"><a href="#cb854-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2053"><a href="#cb854-2053" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval —- LOG ODDS")</span></span>
<span id="cb854-2054"><a href="#cb854-2054" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb854-2055"><a href="#cb854-2055" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Coefficients —- ODDS RATIOS")</span></span>
<span id="cb854-2056"><a href="#cb854-2056" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(confint(m1)))) #exponentiated, not adjusted</span></span>
<span id="cb854-2057"><a href="#cb854-2057" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(dcint))) #exponentiated, adjusted</span></span>
<span id="cb854-2058"><a href="#cb854-2058" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2059"><a href="#cb854-2059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2060"><a href="#cb854-2060" aria-hidden="true" tabindex="-1"></a>**Understanding the logistic regression model**</span>
<span id="cb854-2061"><a href="#cb854-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2064"><a href="#cb854-2064" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2065"><a href="#cb854-2065" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb854-2066"><a href="#cb854-2066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2067"><a href="#cb854-2067" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb854-2068"><a href="#cb854-2068" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb854-2069"><a href="#cb854-2069" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb854-2070"><a href="#cb854-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2071"><a href="#cb854-2071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2072"><a href="#cb854-2072" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb854-2073"><a href="#cb854-2073" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb854-2074"><a href="#cb854-2074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2075"><a href="#cb854-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2076"><a href="#cb854-2076" aria-hidden="true" tabindex="-1"></a>*The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable*</span>
<span id="cb854-2077"><a href="#cb854-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2078"><a href="#cb854-2078" aria-hidden="true" tabindex="-1"></a>*The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.*</span>
<span id="cb854-2079"><a href="#cb854-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2080"><a href="#cb854-2080" aria-hidden="true" tabindex="-1"></a>**\[the empty model**</span>
<span id="cb854-2081"><a href="#cb854-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2082"><a href="#cb854-2082" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercept of an empty model (glm(accuracy \~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df\$accuracy ==1 ).</span>
<span id="cb854-2083"><a href="#cb854-2083" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -<span class="sc">\&gt;</span> log(0.215 / (1-0.215)) = -1.29.</span>
<span id="cb854-2084"><a href="#cb854-2084" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</span>
<span id="cb854-2085"><a href="#cb854-2085" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</span>
<span id="cb854-2086"><a href="#cb854-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2087"><a href="#cb854-2087" aria-hidden="true" tabindex="-1"></a>**\[a dichotomous predictor\]**</span>
<span id="cb854-2088"><a href="#cb854-2088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2089"><a href="#cb854-2089" aria-hidden="true" tabindex="-1"></a>natural log (odds of +) = -1.822 + 0.901(x1) ; x1 = 0 for control, 1 for impasse - b0 intercept is ODDS OF CORRECT RESPONSE IN REFERENCE (control) - b1 intercept is ODDS RATIO (difference in odds) FOR CORRECT RESPONSE IN IMPASSE</span>
<span id="cb854-2090"><a href="#cb854-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2091"><a href="#cb854-2091" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>INTERCEPT: log odds of (+ response) in control condition</span>
<span id="cb854-2092"><a href="#cb854-2092" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</span>
<span id="cb854-2093"><a href="#cb854-2093" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating the coefficients\</span>
<span id="cb854-2094"><a href="#cb854-2094" aria-hidden="true" tabindex="-1"></a>        log odds of (+) in control = exp(-1.822) = 0.162 odds</span>
<span id="cb854-2095"><a href="#cb854-2095" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb854-2096"><a href="#cb854-2096" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139\</span>
<span id="cb854-2097"><a href="#cb854-2097" aria-hidden="true" tabindex="-1"></a>        probability of (+) in control = \~14%</span>
<span id="cb854-2098"><a href="#cb854-2098" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs. control</span>
<span id="cb854-2099"><a href="#cb854-2099" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</span>
<span id="cb854-2100"><a href="#cb854-2100" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating log odds\</span>
<span id="cb854-2101"><a href="#cb854-2101" aria-hidden="true" tabindex="-1"></a>        log odds (+) in impasse = exp(-0.921) = 0.398</span>
<span id="cb854-2102"><a href="#cb854-2102" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb854-2103"><a href="#cb854-2103" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285\</span>
<span id="cb854-2104"><a href="#cb854-2104" aria-hidden="true" tabindex="-1"></a>        probaility of (+) in impasse = \~ 29%</span>
<span id="cb854-2105"><a href="#cb854-2105" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ODDS RATIO : exponentiated B1 COEFFICIENT</span>
<span id="cb854-2106"><a href="#cb854-2106" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = (slope of logit model = difference in log odds = log odds ratio</span>
<span id="cb854-2107"><a href="#cb854-2107" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = 0.901 is log odds ratio of (+) in impasse vs control</span>
<span id="cb854-2108"><a href="#cb854-2108" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>exp(b1) = exp(0.901) = 2.46</span>
<span id="cb854-2109"><a href="#cb854-2109" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</span>
<span id="cb854-2110"><a href="#cb854-2110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2111"><a href="#cb854-2111" aria-hidden="true" tabindex="-1"></a>+:----------------------------------------------------------------------+</span>
<span id="cb854-2112"><a href="#cb854-2112" aria-hidden="true" tabindex="-1"></a>| MARGINAL\                                                             |</span>
<span id="cb854-2113"><a href="#cb854-2113" aria-hidden="true" tabindex="-1"></a>| total = 330 success : 71, failure : 259\                              |</span>
<span id="cb854-2114"><a href="#cb854-2114" aria-hidden="true" tabindex="-1"></a>| p(+) = 71 / 330 = 0.215 = 22%\                                        |</span>
<span id="cb854-2115"><a href="#cb854-2115" aria-hidden="true" tabindex="-1"></a>| odds(+) = 71 / 259 = 0.274                                            |</span>
<span id="cb854-2116"><a href="#cb854-2116" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb854-2117"><a href="#cb854-2117" aria-hidden="true" tabindex="-1"></a>| CONTROL total = 158 success = 22; failure = 136\                      |</span>
<span id="cb854-2118"><a href="#cb854-2118" aria-hidden="true" tabindex="-1"></a>| p(+) = 22/158 = 0.139 = 14%\                                          |</span>
<span id="cb854-2119"><a href="#cb854-2119" aria-hidden="true" tabindex="-1"></a>| odds(+) = 22/136 = 0.162                                              |</span>
<span id="cb854-2120"><a href="#cb854-2120" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb854-2121"><a href="#cb854-2121" aria-hidden="true" tabindex="-1"></a>| IMPASSE total = 172 success = 49; failure = 123\                      |</span>
<span id="cb854-2122"><a href="#cb854-2122" aria-hidden="true" tabindex="-1"></a>| p(+) = 49/172 = 0.285 = 29%\                                          |</span>
<span id="cb854-2123"><a href="#cb854-2123" aria-hidden="true" tabindex="-1"></a>| odds(+) = 49/123 = 0.398                                              |</span>
<span id="cb854-2124"><a href="#cb854-2124" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb854-2125"><a href="#cb854-2125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2126"><a href="#cb854-2126" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb854-2127"><a href="#cb854-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2130"><a href="#cb854-2130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2131"><a href="#cb854-2131" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb854-2132"><a href="#cb854-2132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2133"><a href="#cb854-2133" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb854-2134"><a href="#cb854-2134" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoefstats</span>(m1, <span class="at">output =</span> <span class="st">"plot"</span>, </span>
<span id="cb854-2135"><a href="#cb854-2135" aria-hidden="true" tabindex="-1"></a>              <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">+</span> </span>
<span id="cb854-2136"><a href="#cb854-2136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Log Odds Estimate"</span>, </span>
<span id="cb854-2137"><a href="#cb854-2137" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"p is for two tailed test"</span>)</span>
<span id="cb854-2138"><a href="#cb854-2138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2139"><a href="#cb854-2139" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb854-2140"><a href="#cb854-2140" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb854-2141"><a href="#cb854-2141" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb854-2142"><a href="#cb854-2142" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb854-2143"><a href="#cb854-2143" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-2144"><a href="#cb854-2144" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb854-2145"><a href="#cb854-2145" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb854-2146"><a href="#cb854-2146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb854-2147"><a href="#cb854-2147" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb854-2148"><a href="#cb854-2148" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb854-2149"><a href="#cb854-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2150"><a href="#cb854-2150" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb854-2151"><a href="#cb854-2151" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">type=</span><span class="st">"eff"</span>,</span>
<span id="cb854-2152"><a href="#cb854-2152" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-2153"><a href="#cb854-2153" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-2154"><a href="#cb854-2154" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb854-2155"><a href="#cb854-2155" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb854-2156"><a href="#cb854-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2157"><a href="#cb854-2157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2158"><a href="#cb854-2158" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb854-2159"><a href="#cb854-2159" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m1)</span></span>
<span id="cb854-2160"><a href="#cb854-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2161"><a href="#cb854-2161" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELSUMMARY | MODEL | PROBABILITIES</span></span>
<span id="cb854-2162"><a href="#cb854-2162" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m1, exponentiate = TRUE)</span></span>
<span id="cb854-2163"><a href="#cb854-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2164"><a href="#cb854-2164" aria-hidden="true" tabindex="-1"></a><span class="co">#MARGINALEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb854-2165"><a href="#cb854-2165" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb854-2166"><a href="#cb854-2166" aria-hidden="true" tabindex="-1"></a><span class="co">#plot adjusted predictions, conditional on the CONDITION variable using the plot_cap</span></span>
<span id="cb854-2167"><a href="#cb854-2167" aria-hidden="true" tabindex="-1"></a><span class="co">#interactions plot_cap(mod, condition = c("length", "style"))</span></span>
<span id="cb854-2168"><a href="#cb854-2168" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cap</span>(m1, <span class="at">condition =</span> <span class="st">"pretty_condition"</span>)</span>
<span id="cb854-2169"><a href="#cb854-2169" aria-hidden="true" tabindex="-1"></a><span class="co"># The plot_cme function can be used to draw “Conditional Marginal Effects.” </span></span>
<span id="cb854-2170"><a href="#cb854-2170" aria-hidden="true" tabindex="-1"></a><span class="co">#use for ixns </span></span>
<span id="cb854-2171"><a href="#cb854-2171" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_cme(m1, effect = "var1", condition = "pretty_condition")</span></span>
<span id="cb854-2172"><a href="#cb854-2172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2173"><a href="#cb854-2173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2174"><a href="#cb854-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2175"><a href="#cb854-2175" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb854-2176"><a href="#cb854-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2179"><a href="#cb854-2179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2180"><a href="#cb854-2180" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb854-2181"><a href="#cb854-2181" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m1)</span>
<span id="cb854-2182"><a href="#cb854-2182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2183"><a href="#cb854-2183" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb854-2184"><a href="#cb854-2184" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb854-2185"><a href="#cb854-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2186"><a href="#cb854-2186" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span>
<span id="cb854-2187"><a href="#cb854-2187" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span>
<span id="cb854-2188"><a href="#cb854-2188" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(m1)</span>
<span id="cb854-2189"><a href="#cb854-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2190"><a href="#cb854-2190" aria-hidden="true" tabindex="-1"></a><span class="co"># logitgof(df$accuracy, m1$fitted.values, ord=FALSE)</span></span>
<span id="cb854-2191"><a href="#cb854-2191" aria-hidden="true" tabindex="-1"></a><span class="co"># hoslem.test(x = df$accuracy, y = fitted(m1), g =  2)</span></span>
<span id="cb854-2192"><a href="#cb854-2192" aria-hidden="true" tabindex="-1"></a><span class="co"># p should be non significant</span></span>
<span id="cb854-2193"><a href="#cb854-2193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2194"><a href="#cb854-2194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2195"><a href="#cb854-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2196"><a href="#cb854-2196" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb854-2197"><a href="#cb854-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2198"><a href="#cb854-2198" aria-hidden="true" tabindex="-1"></a>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the *impasse condition* increase by 146% ($e^{beta_1}$ = 2.46, 95% CI \[1.42, 4.37\]) over the *control condition*.</span>
<span id="cb854-2199"><a href="#cb854-2199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2200"><a href="#cb854-2200" aria-hidden="true" tabindex="-1"></a>*Equivalent statements:*</span>
<span id="cb854-2201"><a href="#cb854-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2202"><a href="#cb854-2202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse condition increases log odds of correct response by 0.901 (over control)</span>
<span id="cb854-2203"><a href="#cb854-2203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</span>
<span id="cb854-2204"><a href="#cb854-2204" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</span>
<span id="cb854-2205"><a href="#cb854-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2208"><a href="#cb854-2208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2209"><a href="#cb854-2209" aria-hidden="true" tabindex="-1"></a><span class="co">#PRETTY TABLE SJPLOT</span></span>
<span id="cb854-2210"><a href="#cb854-2210" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1)</span>
<span id="cb854-2211"><a href="#cb854-2211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2212"><a href="#cb854-2212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2213"><a href="#cb854-2213" aria-hidden="true" tabindex="-1"></a><span class="fu">## ORDINAL OUTCOME</span></span>
<span id="cb854-2214"><a href="#cb854-2214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2215"><a href="#cb854-2215" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] type of response given?**</span>
<span id="cb854-2216"><a href="#cb854-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2219"><a href="#cb854-2219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2220"><a href="#cb854-2220" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : SETUP-INDEPENDENT-ORDINAL</span></span>
<span id="cb854-2221"><a href="#cb854-2221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2222"><a href="#cb854-2222" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb854-2223"><a href="#cb854-2223" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb854-2224"><a href="#cb854-2224" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb854-2225"><a href="#cb854-2225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2226"><a href="#cb854-2226" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb854-2227"><a href="#cb854-2227" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>scaled, df<span class="sc">$</span>condition))</span>
<span id="cb854-2228"><a href="#cb854-2228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2229"><a href="#cb854-2229" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb854-2230"><a href="#cb854-2230" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>scaled, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb854-2231"><a href="#cb854-2231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb854-2232"><a href="#cb854-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2233"><a href="#cb854-2233" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb854-2234"><a href="#cb854-2234" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb854-2235"><a href="#cb854-2235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb854-2236"><a href="#cb854-2236" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb854-2237"><a href="#cb854-2237" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> scaled)) <span class="sc">+</span></span>
<span id="cb854-2238"><a href="#cb854-2238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb854-2239"><a href="#cb854-2239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb854-2240"><a href="#cb854-2240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb854-2241"><a href="#cb854-2241" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb854-2242"><a href="#cb854-2242" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb854-2243"><a href="#cb854-2243" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb854-2244"><a href="#cb854-2244" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb854-2245"><a href="#cb854-2245" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb854-2246"><a href="#cb854-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2247"><a href="#cb854-2247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2248"><a href="#cb854-2248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2249"><a href="#cb854-2249" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] state of understanding?**</span>
<span id="cb854-2250"><a href="#cb854-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2253"><a href="#cb854-2253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2254"><a href="#cb854-2254" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : SETUP-INDEPENDENT-ORDINAL-STATE</span></span>
<span id="cb854-2255"><a href="#cb854-2255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2256"><a href="#cb854-2256" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb854-2257"><a href="#cb854-2257" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb854-2258"><a href="#cb854-2258" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb854-2259"><a href="#cb854-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2260"><a href="#cb854-2260" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb854-2261"><a href="#cb854-2261" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition))</span>
<span id="cb854-2262"><a href="#cb854-2262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2263"><a href="#cb854-2263" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb854-2264"><a href="#cb854-2264" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>state, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb854-2265"><a href="#cb854-2265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb854-2266"><a href="#cb854-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2267"><a href="#cb854-2267" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb854-2268"><a href="#cb854-2268" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb854-2269"><a href="#cb854-2269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb854-2270"><a href="#cb854-2270" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb854-2271"><a href="#cb854-2271" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb854-2272"><a href="#cb854-2272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb854-2273"><a href="#cb854-2273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb854-2274"><a href="#cb854-2274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb854-2275"><a href="#cb854-2275" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb854-2276"><a href="#cb854-2276" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 State"</span>,</span>
<span id="cb854-2277"><a href="#cb854-2277" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb854-2278"><a href="#cb854-2278" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb854-2279"><a href="#cb854-2279" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb854-2280"><a href="#cb854-2280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2281"><a href="#cb854-2281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2282"><a href="#cb854-2282" aria-hidden="true" tabindex="-1"></a><span class="fu">### ORDINAL REGRESSION --- Cumulative Link; Proportional Odds</span></span>
<span id="cb854-2283"><a href="#cb854-2283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2284"><a href="#cb854-2284" aria-hidden="true" tabindex="-1"></a>*Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.*</span>
<span id="cb854-2285"><a href="#cb854-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2286"><a href="#cb854-2286" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/&gt;</span></span>
<span id="cb854-2287"><a href="#cb854-2287" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://journals.sagepub.com/doi/full/10.1177/2515245918823199&gt;</span></span>
<span id="cb854-2288"><a href="#cb854-2288" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>todo see ordinal regression video: <span class="ot">&lt;https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK&gt;</span></span>
<span id="cb854-2289"><a href="#cb854-2289" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://peopleanalytics-regression-book.org/ord-reg.html&gt;</span></span>
<span id="cb854-2290"><a href="#cb854-2290" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2&gt;</span></span>
<span id="cb854-2291"><a href="#cb854-2291" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf&gt;</span></span>
<span id="cb854-2292"><a href="#cb854-2292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2293"><a href="#cb854-2293" aria-hidden="true" tabindex="-1"></a>**Learning Notes**</span>
<span id="cb854-2294"><a href="#cb854-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2295"><a href="#cb854-2295" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>proportional odds regression models effectively act as a series of stratified binomial models under the assumption that the 'slope' of the logistic function of each stratified model is the same.</span>
<span id="cb854-2296"><a href="#cb854-2296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>thus need to verify proportional odds assumption - ordinal regression requires an **proportional odds assumption** (the same slope holds for each equation)</span>
<span id="cb854-2297"><a href="#cb854-2297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>this is required because the model simultaneously estimates k-1 equations, but each equation has the same *slope*, with different intercepts.</span>
<span id="cb854-2298"><a href="#cb854-2298" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>conversely, a multinomial (categorical) model will have different slopes as well as intercepts - the intercepts are always ordered in size alpha 1 <span class="sc">\&lt;</span> alpha 2 <span class="sc">\&lt;</span> alpha k-1...</span>
<span id="cb854-2299"><a href="#cb854-2299" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TODO** - see difference between the three types of ordinal models (adjacent category (vs) cumulative proportions; check Agresti book</span>
<span id="cb854-2300"><a href="#cb854-2300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2301"><a href="#cb854-2301" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb854-2302"><a href="#cb854-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2305"><a href="#cb854-2305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2306"><a href="#cb854-2306" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::ORDINAL REGRESSION MODELS</span></span>
<span id="cb854-2307"><a href="#cb854-2307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2308"><a href="#cb854-2308" aria-hidden="true" tabindex="-1"></a><span class="co">#EMPTY MODEL</span></span>
<span id="cb854-2309"><a href="#cb854-2309" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</span>)</span>
<span id="cb854-2310"><a href="#cb854-2310" aria-hidden="true" tabindex="-1"></a>om<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">clm</span>(state <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> df)</span>
<span id="cb854-2311"><a href="#cb854-2311" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(om.0)</span></span>
<span id="cb854-2312"><a href="#cb854-2312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2313"><a href="#cb854-2313" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICTOR MODEL</span></span>
<span id="cb854-2314"><a href="#cb854-2314" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Ordinal regression of q1 SCALED score (ordered interpretation)"</span>)</span>
<span id="cb854-2315"><a href="#cb854-2315" aria-hidden="true" tabindex="-1"></a>om <span class="ot">&lt;-</span> <span class="fu">clm</span>(state <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb854-2316"><a href="#cb854-2316" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(om)</span></span>
<span id="cb854-2317"><a href="#cb854-2317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2318"><a href="#cb854-2318" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE EMPTY AND PREDICTOR</span></span>
<span id="cb854-2319"><a href="#cb854-2319" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(om<span class="fl">.0</span>, om)</span>
<span id="cb854-2320"><a href="#cb854-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2321"><a href="#cb854-2321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2322"><a href="#cb854-2322" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: EQUIVALENT APPROACH USING POLYR </span></span>
<span id="cb854-2323"><a href="#cb854-2323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2324"><a href="#cb854-2324" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL</span></span>
<span id="cb854-2325"><a href="#cb854-2325" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(state <span class="sc">~</span> condition , <span class="at">data =</span> df, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb854-2326"><a href="#cb854-2326" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m)</span></span>
<span id="cb854-2327"><a href="#cb854-2327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2328"><a href="#cb854-2328" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate coefficients and CIs</span></span>
<span id="cb854-2329"><a href="#cb854-2329" aria-hidden="true" tabindex="-1"></a><span class="co"># (ctable &lt;- coef(summary(m)))</span></span>
<span id="cb854-2330"><a href="#cb854-2330" aria-hidden="true" tabindex="-1"></a><span class="co"># (p &lt;- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2)</span></span>
<span id="cb854-2331"><a href="#cb854-2331" aria-hidden="true" tabindex="-1"></a><span class="co"># (ctable &lt;- cbind(ctable, "p value" = p))</span></span>
<span id="cb854-2332"><a href="#cb854-2332" aria-hidden="true" tabindex="-1"></a><span class="co"># (ci &lt;- confint(m))</span></span>
<span id="cb854-2333"><a href="#cb854-2333" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- coef(m))</span></span>
<span id="cb854-2334"><a href="#cb854-2334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2335"><a href="#cb854-2335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2336"><a href="#cb854-2336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2337"><a href="#cb854-2337" aria-hidden="true" tabindex="-1"></a>*Likelihood ratio test suggests the predictor model is a better fit than the empty (intercept only) model.*</span>
<span id="cb854-2338"><a href="#cb854-2338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2339"><a href="#cb854-2339" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb854-2340"><a href="#cb854-2340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2343"><a href="#cb854-2343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2344"><a href="#cb854-2344" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SUMMARY"</span>)</span>
<span id="cb854-2345"><a href="#cb854-2345" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(om)</span>
<span id="cb854-2346"><a href="#cb854-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2347"><a href="#cb854-2347" aria-hidden="true" tabindex="-1"></a><span class="co">#LOG ODDS</span></span>
<span id="cb854-2348"><a href="#cb854-2348" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"IN LOG ODDS"</span>)</span>
<span id="cb854-2349"><a href="#cb854-2349" aria-hidden="true" tabindex="-1"></a>(ctable <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(om)))</span>
<span id="cb854-2350"><a href="#cb854-2350" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(om)) </span>
<span id="cb854-2351"><a href="#cb854-2351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2352"><a href="#cb854-2352" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"IN ODDS RATIOS"</span>)</span>
<span id="cb854-2353"><a href="#cb854-2353" aria-hidden="true" tabindex="-1"></a><span class="co">#ODDS RATIOS</span></span>
<span id="cb854-2354"><a href="#cb854-2354" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(om))</span>
<span id="cb854-2355"><a href="#cb854-2355" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(ci)</span>
<span id="cb854-2356"><a href="#cb854-2356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2357"><a href="#cb854-2357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2358"><a href="#cb854-2358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2359"><a href="#cb854-2359" aria-hidden="true" tabindex="-1"></a>**Overall, participants in the impasse condition had higher odds (6.68 X as likely) to offer *more correct* interpretations than those in the control condition (z = 4.74, p \&lt; 0.001).**</span>
<span id="cb854-2360"><a href="#cb854-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2361"><a href="#cb854-2361" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>we see the estimates for the 2 intercepts, which are sometimes called cutpoints.</span>
<span id="cb854-2362"><a href="#cb854-2362" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercepts indicate where the latent variable is cut to make the three groups that we observe in our data.</span>
<span id="cb854-2363"><a href="#cb854-2363" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that this latent variable is continuous. In general, these are not used in the interpretation of the results.</span>
<span id="cb854-2364"><a href="#cb854-2364" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The cutpoints are closely related to thresholds, which are reported by other statistical packages.</span>
<span id="cb854-2365"><a href="#cb854-2365" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>for k groups there will be k-1 intercepts (cutpoints)</span>
<span id="cb854-2366"><a href="#cb854-2366" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>confirm that the CI does not include 0 (the units are ordered logits <span class="sc">\[</span>ordered log odds<span class="sc">\]</span>)</span>
<span id="cb854-2367"><a href="#cb854-2367" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>as with logistic regression we exponentiate the coefficients and confints to get odds ratio</span>
<span id="cb854-2368"><a href="#cb854-2368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2369"><a href="#cb854-2369" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize Model</span></span>
<span id="cb854-2370"><a href="#cb854-2370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2373"><a href="#cb854-2373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2374"><a href="#cb854-2374" aria-hidden="true" tabindex="-1"></a><span class="co"># sjPlot::tab_model(om)</span></span>
<span id="cb854-2375"><a href="#cb854-2375" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(om)</span>
<span id="cb854-2376"><a href="#cb854-2376" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(om, <span class="at">type =</span> <span class="st">"eff"</span>)</span>
<span id="cb854-2377"><a href="#cb854-2377" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># show.data = TRUE, jitter = TRUE)</span></span>
<span id="cb854-2378"><a href="#cb854-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2379"><a href="#cb854-2379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2380"><a href="#cb854-2380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2381"><a href="#cb854-2381" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb854-2382"><a href="#cb854-2382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2385"><a href="#cb854-2385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2386"><a href="#cb854-2386" aria-hidden="true" tabindex="-1"></a><span class="co">#:: ASSESS FIT</span></span>
<span id="cb854-2387"><a href="#cb854-2387" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(om)</span>
<span id="cb854-2388"><a href="#cb854-2388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2389"><a href="#cb854-2389" aria-hidden="true" tabindex="-1"></a><span class="co"># #test proporitional odds assumption </span></span>
<span id="cb854-2390"><a href="#cb854-2390" aria-hidden="true" tabindex="-1"></a><span class="fu">brant</span>(m) <span class="co">#only works for polyr type model not clm type model</span></span>
<span id="cb854-2391"><a href="#cb854-2391" aria-hidden="true" tabindex="-1"></a><span class="co"># # A p-value of less than 0.05 on this test—particularly on the Omnibus plus at least one of the variables—should be interpreted as a failure of the proportional odds assumption.</span></span>
<span id="cb854-2392"><a href="#cb854-2392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2393"><a href="#cb854-2393" aria-hidden="true" tabindex="-1"></a><span class="co">#test proportional odds assumption</span></span>
<span id="cb854-2394"><a href="#cb854-2394" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pomcheckr)</span>
<span id="cb854-2395"><a href="#cb854-2395" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/pomcheckr/pomcheckr.pdf</span></span>
<span id="cb854-2396"><a href="#cb854-2396" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pomcheck</span>( scaled <span class="sc">~</span> condition , <span class="at">data =</span> df))</span>
<span id="cb854-2397"><a href="#cb854-2397" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span>
<span id="cb854-2398"><a href="#cb854-2398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2399"><a href="#cb854-2399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2400"><a href="#cb854-2400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2401"><a href="#cb854-2401" aria-hidden="true" tabindex="-1"></a>**The output of the graphical test for proportional odds assumption suggests that the proportional odds assumption may be unreasonable for this dataset. Also, inspecting the output table, we see the coefficients for each level of the scaled variable are quite different.**</span>
<span id="cb854-2402"><a href="#cb854-2402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2403"><a href="#cb854-2403" aria-hidden="true" tabindex="-1"></a>Thus, an alternative approach may be more appropriate:</span>
<span id="cb854-2404"><a href="#cb854-2404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2405"><a href="#cb854-2405" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Baseline logistic model. This model is the same as the multinomial regression model covered in the previous chapter, using the lowest ordinal value as the reference.</span>
<span id="cb854-2406"><a href="#cb854-2406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2407"><a href="#cb854-2407" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjacent-category logistic model. This model compares each level of the ordinal variable to the next highest level, and it is a constrained version of the baseline logistic model. The brglm2 package in R offers a function bracl() for calculating an adjacent category logistic model.</span>
<span id="cb854-2408"><a href="#cb854-2408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2409"><a href="#cb854-2409" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Continuation-ratio logistic model. This model compares each level of the ordinal variable to all lower levels. This can be modeled using binary logistic regression techniques, but new variables need to be constructed from the data set to allow this. The R package rms has a function cr.setup() which is a utility for preparing an outcome variable for a continuation ratio model.</span>
<span id="cb854-2410"><a href="#cb854-2410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2411"><a href="#cb854-2411" aria-hidden="true" tabindex="-1"></a><span class="sc">\*</span>Note: for multiple regression, the ordinal package offers a parameter (nominal = \~predictors) that allow you to designate some predictors as nominal rather than ordinal. But this is not appropriate for this use case.<span class="sc">\_</span></span>
<span id="cb854-2412"><a href="#cb854-2412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2413"><a href="#cb854-2413" aria-hidden="true" tabindex="-1"></a><span class="fu">## CATEGORICAL OUTCOME</span></span>
<span id="cb854-2414"><a href="#cb854-2414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2415"><a href="#cb854-2415" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] type of response given?**</span>
<span id="cb854-2416"><a href="#cb854-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2419"><a href="#cb854-2419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2420"><a href="#cb854-2420" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb854-2421"><a href="#cb854-2421" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb854-2422"><a href="#cb854-2422" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb854-2423"><a href="#cb854-2423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2424"><a href="#cb854-2424" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb854-2425"><a href="#cb854-2425" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>scaled, df<span class="sc">$</span>condition))</span>
<span id="cb854-2426"><a href="#cb854-2426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2427"><a href="#cb854-2427" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb854-2428"><a href="#cb854-2428" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>scaled, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb854-2429"><a href="#cb854-2429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb854-2430"><a href="#cb854-2430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2431"><a href="#cb854-2431" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb854-2432"><a href="#cb854-2432" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb854-2433"><a href="#cb854-2433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb854-2434"><a href="#cb854-2434" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb854-2435"><a href="#cb854-2435" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> scaled)) <span class="sc">+</span></span>
<span id="cb854-2436"><a href="#cb854-2436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb854-2437"><a href="#cb854-2437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb854-2438"><a href="#cb854-2438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb854-2439"><a href="#cb854-2439" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb854-2440"><a href="#cb854-2440" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb854-2441"><a href="#cb854-2441" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb854-2442"><a href="#cb854-2442" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb854-2443"><a href="#cb854-2443" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb854-2444"><a href="#cb854-2444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2445"><a href="#cb854-2445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2446"><a href="#cb854-2446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2447"><a href="#cb854-2447" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] state of understanding?**</span>
<span id="cb854-2448"><a href="#cb854-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2451"><a href="#cb854-2451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2452"><a href="#cb854-2452" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb854-2453"><a href="#cb854-2453" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb854-2454"><a href="#cb854-2454" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb854-2455"><a href="#cb854-2455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2456"><a href="#cb854-2456" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb854-2457"><a href="#cb854-2457" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb854-2458"><a href="#cb854-2458" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb854-2459"><a href="#cb854-2459" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb854-2460"><a href="#cb854-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2461"><a href="#cb854-2461" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb854-2462"><a href="#cb854-2462" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>state, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb854-2463"><a href="#cb854-2463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb854-2464"><a href="#cb854-2464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2465"><a href="#cb854-2465" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb854-2466"><a href="#cb854-2466" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb854-2467"><a href="#cb854-2467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb854-2468"><a href="#cb854-2468" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb854-2469"><a href="#cb854-2469" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb854-2470"><a href="#cb854-2470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb854-2471"><a href="#cb854-2471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb854-2472"><a href="#cb854-2472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb854-2473"><a href="#cb854-2473" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb854-2474"><a href="#cb854-2474" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 State"</span>,</span>
<span id="cb854-2475"><a href="#cb854-2475" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb854-2476"><a href="#cb854-2476" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb854-2477"><a href="#cb854-2477" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb854-2478"><a href="#cb854-2478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2479"><a href="#cb854-2479" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATSPLOT</span></span>
<span id="cb854-2480"><a href="#cb854-2480" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(df, state, condition)</span>
<span id="cb854-2481"><a href="#cb854-2481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2482"><a href="#cb854-2482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2483"><a href="#cb854-2483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2484"><a href="#cb854-2484" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHI SQUARE</span></span>
<span id="cb854-2485"><a href="#cb854-2485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2486"><a href="#cb854-2486" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[categorical\] type of response given?**</span>
<span id="cb854-2487"><a href="#cb854-2487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2490"><a href="#cb854-2490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2491"><a href="#cb854-2491" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>scaled, </span>
<span id="cb854-2492"><a href="#cb854-2492" aria-hidden="true" tabindex="-1"></a>             <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-2493"><a href="#cb854-2493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2494"><a href="#cb854-2494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2497"><a href="#cb854-2497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2498"><a href="#cb854-2498" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb854-2499"><a href="#cb854-2499" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb854-2500"><a href="#cb854-2500" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Interpretation on First Question by Condition"</span>,</span>
<span id="cb854-2501"><a href="#cb854-2501" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, condition <span class="sc">~</span> scaled, </span>
<span id="cb854-2502"><a href="#cb854-2502" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb854-2503"><a href="#cb854-2503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2504"><a href="#cb854-2504" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::WITH STATISTICS</span></span>
<span id="cb854-2505"><a href="#cb854-2505" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> condition, <span class="at">y =</span> scaled,</span>
<span id="cb854-2506"><a href="#cb854-2506" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"nonparametric"</span>) </span>
<span id="cb854-2507"><a href="#cb854-2507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2508"><a href="#cb854-2508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2511"><a href="#cb854-2511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2512"><a href="#cb854-2512" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-interpreation</span></span>
<span id="cb854-2513"><a href="#cb854-2513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2514"><a href="#cb854-2514" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb854-2515"><a href="#cb854-2515" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb854-2516"><a href="#cb854-2516" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Response Type on First Question by Condition"</span>,</span>
<span id="cb854-2517"><a href="#cb854-2517" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, condition <span class="sc">~</span> scaled, </span>
<span id="cb854-2518"><a href="#cb854-2518" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb854-2519"><a href="#cb854-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2520"><a href="#cb854-2520" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>scaled, </span>
<span id="cb854-2521"><a href="#cb854-2521" aria-hidden="true" tabindex="-1"></a>            <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-2522"><a href="#cb854-2522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2523"><a href="#cb854-2523" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb854-2524"><a href="#cb854-2524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"scaled"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb854-2525"><a href="#cb854-2525" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb854-2526"><a href="#cb854-2526" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb854-2527"><a href="#cb854-2527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2528"><a href="#cb854-2528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2529"><a href="#cb854-2529" aria-hidden="true" tabindex="-1"></a>**TODO INFERENCE**</span>
<span id="cb854-2530"><a href="#cb854-2530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2531"><a href="#cb854-2531" aria-hidden="true" tabindex="-1"></a><span class="fu">### MULTINOMIAL REGRESSION</span></span>
<span id="cb854-2532"><a href="#cb854-2532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2533"><a href="#cb854-2533" aria-hidden="true" tabindex="-1"></a>on interpreting coefficients (marginal probability)</span>
<span id="cb854-2534"><a href="#cb854-2534" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>https://data.princeton.edu/wws509/stata/mlogit</span>
<span id="cb854-2535"><a href="#cb854-2535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2536"><a href="#cb854-2536" aria-hidden="true" tabindex="-1"></a>**TODO** RECONCILE actual predictions with coefficients and visualization of predictions</span>
<span id="cb854-2537"><a href="#cb854-2537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2538"><a href="#cb854-2538" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of Q1?*</span>
<span id="cb854-2539"><a href="#cb854-2539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2540"><a href="#cb854-2540" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model&gt;</span></span>
<span id="cb854-2541"><a href="#cb854-2541" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://bookdown.org/chua/ber642_advanced_regression/multinomial-logistic-regression.html&gt;</span></span>
<span id="cb854-2542"><a href="#cb854-2542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK&gt;</span></span>
<span id="cb854-2543"><a href="#cb854-2543" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can use nnet package multinom() or mclogit package mblogit() <span class="sc">\[</span>"baseline logit model"<span class="sc">\]</span> or brms with family = "categorical"</span>
<span id="cb854-2544"><a href="#cb854-2544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2545"><a href="#cb854-2545" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression predicting interpretation (k=#response categories) by condition. (k = 2).*</span>
<span id="cb854-2546"><a href="#cb854-2546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2547"><a href="#cb854-2547" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>2 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer)</span>
<span id="cb854-2548"><a href="#cb854-2548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2549"><a href="#cb854-2549" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>(from experience, seems) Each cell must have at least one observation (if one cell is blank, then it seems to be incorrectly estimated, see predicting high_interpretation vs. state. suggests nonsignificant OR for 'unknown' category, when infact that difference drives the effect</span>
<span id="cb854-2550"><a href="#cb854-2550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2551"><a href="#cb854-2551" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For *each* equation:</span>
<span id="cb854-2552"><a href="#cb854-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2553"><a href="#cb854-2553" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{0}$ *= Log Odds of \[this category type vs. reference category type) response in CONTROL condition*</span>
<span id="cb854-2554"><a href="#cb854-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2555"><a href="#cb854-2555" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$e^{\beta_{0}}$ *= ODDS of \[this category type vs. reference category type\] response in CONTROL condition*</span>
<span id="cb854-2556"><a href="#cb854-2556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2557"><a href="#cb854-2557" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{1}$ *=* $\beta_{1impasse}$ *Log Odds (Log OR; change in odds for \[this category\] type response in impasse (vs) control \[log scale\])*</span>
<span id="cb854-2558"><a href="#cb854-2558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2559"><a href="#cb854-2559" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{1}}$ *= ODDS RATIO of \[this. vs reference category type\] response in IMPASSE (vs) CONTROL*</span>
<span id="cb854-2560"><a href="#cb854-2560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2561"><a href="#cb854-2561" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*Null hypothesis:* $\beta_{impasse} \le 0$ *the odds for \[this category of response vs. reference\] does not change, or decreases*</span>
<span id="cb854-2562"><a href="#cb854-2562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2563"><a href="#cb854-2563" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*Alternative hypothesis:* $\beta_{impasse} \gt 0$ *the odds of \[this category of response vs. reference\] increases*</span>
<span id="cb854-2564"><a href="#cb854-2564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2565"><a href="#cb854-2565" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span></span>
<span id="cb854-2566"><a href="#cb854-2566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2569"><a href="#cb854-2569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2570"><a href="#cb854-2570" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES RESPONSE STATE</span></span>
<span id="cb854-2571"><a href="#cb854-2571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2572"><a href="#cb854-2572" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb854-2573"><a href="#cb854-2573" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb854-2574"><a href="#cb854-2574" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb854-2575"><a href="#cb854-2575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2576"><a href="#cb854-2576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2577"><a href="#cb854-2577" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb854-2578"><a href="#cb854-2578" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb854-2579"><a href="#cb854-2579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2580"><a href="#cb854-2580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2581"><a href="#cb854-2581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2582"><a href="#cb854-2582" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb854-2583"><a href="#cb854-2583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2586"><a href="#cb854-2586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2587"><a href="#cb854-2587" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb854-2588"><a href="#cb854-2588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2589"><a href="#cb854-2589" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb854-2590"><a href="#cb854-2590" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span>
<span id="cb854-2591"><a href="#cb854-2591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2592"><a href="#cb854-2592" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb854-2593"><a href="#cb854-2593" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb854-2594"><a href="#cb854-2594" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb854-2595"><a href="#cb854-2595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2596"><a href="#cb854-2596" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb854-2597"><a href="#cb854-2597" aria-hidden="true" tabindex="-1"></a>catm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-2598"><a href="#cb854-2598" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm)</span></span>
<span id="cb854-2599"><a href="#cb854-2599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2600"><a href="#cb854-2600" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb854-2601"><a href="#cb854-2601" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm)</span>
<span id="cb854-2602"><a href="#cb854-2602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2603"><a href="#cb854-2603" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb854-2604"><a href="#cb854-2604" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb854-2605"><a href="#cb854-2605" aria-hidden="true" tabindex="-1"></a><span class="co"># bm1 &lt;- brm( state ~ pretty_condition, data = df, family = "categorical")</span></span>
<span id="cb854-2606"><a href="#cb854-2606" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(bm1)</span></span>
<span id="cb854-2607"><a href="#cb854-2607" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(bm1)</span></span>
<span id="cb854-2608"><a href="#cb854-2608" aria-hidden="true" tabindex="-1"></a><span class="co"># report(bm1)</span></span>
<span id="cb854-2609"><a href="#cb854-2609" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb854-2610"><a href="#cb854-2610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2611"><a href="#cb854-2611" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb854-2612"><a href="#cb854-2612" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb854-2613"><a href="#cb854-2613" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb854-2614"><a href="#cb854-2614" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state ~ pretty_condition , data = df)</span></span>
<span id="cb854-2615"><a href="#cb854-2615" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb854-2616"><a href="#cb854-2616" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span>
<span id="cb854-2617"><a href="#cb854-2617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2618"><a href="#cb854-2618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2619"><a href="#cb854-2619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2620"><a href="#cb854-2620" aria-hidden="true" tabindex="-1"></a>*Likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*</span>
<span id="cb854-2621"><a href="#cb854-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2622"><a href="#cb854-2622" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interpretation</span></span>
<span id="cb854-2623"><a href="#cb854-2623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2626"><a href="#cb854-2626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2627"><a href="#cb854-2627" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb854-2628"><a href="#cb854-2628" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span>
<span id="cb854-2629"><a href="#cb854-2629" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(catm)</span>
<span id="cb854-2630"><a href="#cb854-2630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2631"><a href="#cb854-2631" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb854-2632"><a href="#cb854-2632" aria-hidden="true" tabindex="-1"></a>(z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(catm)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(catm)<span class="sc">$</span>standard.errors)</span>
<span id="cb854-2633"><a href="#cb854-2633" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb854-2634"><a href="#cb854-2634" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb854-2635"><a href="#cb854-2635" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb854-2636"><a href="#cb854-2636" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values))</span>
<span id="cb854-2637"><a href="#cb854-2637" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb854-2638"><a href="#cb854-2638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2639"><a href="#cb854-2639" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb854-2640"><a href="#cb854-2640" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(catm)<span class="sc">$</span>coefficients))</span>
<span id="cb854-2641"><a href="#cb854-2641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2642"><a href="#cb854-2642" aria-hidden="true" tabindex="-1"></a><span class="co"># options(scipen = 3)</span></span>
<span id="cb854-2643"><a href="#cb854-2643" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span>
<span id="cb854-2644"><a href="#cb854-2644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2645"><a href="#cb854-2645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2646"><a href="#cb854-2646" aria-hidden="true" tabindex="-1"></a>**Learning Notes**</span>
<span id="cb854-2647"><a href="#cb854-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2648"><a href="#cb854-2648" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model estimates encompass two equations:</span>
<span id="cb854-2649"><a href="#cb854-2649" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>effect of predictor on log odds of being in <span class="sc">\[</span>unknown<span class="sc">\]</span> instead of reference category <span class="sc">\[</span>orth-like<span class="sc">\]</span></span>
<span id="cb854-2650"><a href="#cb854-2650" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>effect of predictor on log odds of being in <span class="sc">\[</span>tri-like<span class="sc">\]</span> instead of reference category <span class="sc">\[</span>orth-like<span class="sc">\]</span></span>
<span id="cb854-2651"><a href="#cb854-2651" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="sc">\[</span>need to to double check interpretation, but I *think* that the OR intercepts converted to probabilities equate to the marginal probability of being in each state in the <span class="sc">\[</span>reference<span class="sc">\]</span> control condition. which makes sense. I think<span class="sc">\]</span></span>
<span id="cb854-2652"><a href="#cb854-2652" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>IF I change reference category for condition... then the intercepts should no longer be significant. The b1 coefficients should still be significant, but with changed sign (much less likely) <span class="sc">\[</span>Yup! this works!<span class="sc">\]</span></span>
<span id="cb854-2653"><a href="#cb854-2653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2654"><a href="#cb854-2654" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb854-2655"><a href="#cb854-2655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2656"><a href="#cb854-2656" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition increases the odds of giving 'unknown/uncertain' response rather than an orthogonal (or satisficing) response by a factor of 50 (z = 3.59, p <span class="sc">\&lt;</span> 0.001 ).</span>
<span id="cb854-2657"><a href="#cb854-2657" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition increases the odds of giving an 'triangular or line-driven' response rather than an orthogonal (or satisficing) response by a factor of 6 (z = 3.98, p <span class="sc">\&lt;</span>0.001 )</span>
<span id="cb854-2658"><a href="#cb854-2658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2659"><a href="#cb854-2659" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb854-2660"><a href="#cb854-2660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2663"><a href="#cb854-2663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2664"><a href="#cb854-2664" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(catm, <span class="at">vline.color =</span> <span class="st">'red'</span>)</span>
<span id="cb854-2665"><a href="#cb854-2665" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(catm, <span class="at">type =</span> <span class="st">"eff"</span>)</span>
<span id="cb854-2666"><a href="#cb854-2666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2667"><a href="#cb854-2667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2668"><a href="#cb854-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2669"><a href="#cb854-2669" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb854-2670"><a href="#cb854-2670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2673"><a href="#cb854-2673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2674"><a href="#cb854-2674" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb854-2675"><a href="#cb854-2675" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb854-2676"><a href="#cb854-2676" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))</span>
<span id="cb854-2677"><a href="#cb854-2677" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(catm, <span class="at">newdata =</span> test, <span class="st">"probs"</span>)</span>
<span id="cb854-2678"><a href="#cb854-2678" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Predicted Probability of Being in Each State"</span>)</span>
<span id="cb854-2679"><a href="#cb854-2679" aria-hidden="true" tabindex="-1"></a>(<span class="fu">cbind</span>(test, pred))</span>
<span id="cb854-2680"><a href="#cb854-2680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2681"><a href="#cb854-2681" aria-hidden="true" tabindex="-1"></a><span class="co">#performance</span></span>
<span id="cb854-2682"><a href="#cb854-2682" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(catm)</span>
<span id="cb854-2683"><a href="#cb854-2683" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(catm, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span>
<span id="cb854-2684"><a href="#cb854-2684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2685"><a href="#cb854-2685" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb854-2686"><a href="#cb854-2686" aria-hidden="true" tabindex="-1"></a><span class="co"># library(generalhoslem)</span></span>
<span id="cb854-2687"><a href="#cb854-2687" aria-hidden="true" tabindex="-1"></a><span class="co"># logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb854-2688"><a href="#cb854-2688" aria-hidden="true" tabindex="-1"></a><span class="co"># hoslem.test(x = df$state, y = catm$fitted.values, g =  10)</span></span>
<span id="cb854-2689"><a href="#cb854-2689" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb854-2690"><a href="#cb854-2690" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb854-2691"><a href="#cb854-2691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2692"><a href="#cb854-2692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2693"><a href="#cb854-2693" aria-hidden="true" tabindex="-1"></a><span class="fu"># MIXED (Repeated Measures)</span></span>
<span id="cb854-2694"><a href="#cb854-2694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2697"><a href="#cb854-2697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2698"><a href="#cb854-2698" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-</span><span class="al">TEST</span><span class="co">-ACC-ITEM</span></span>
<span id="cb854-2699"><a href="#cb854-2699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2700"><a href="#cb854-2700" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb854-2701"><a href="#cb854-2701" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb854-2702"><a href="#cb854-2702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2703"><a href="#cb854-2703" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb854-2704"><a href="#cb854-2704" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb854-2705"><a href="#cb854-2705" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb854-2706"><a href="#cb854-2706" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb854-2707"><a href="#cb854-2707" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-2708"><a href="#cb854-2708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2709"><a href="#cb854-2709" aria-hidden="true" tabindex="-1"></a><span class="co">#FACETED HISTOGRAM</span></span>
<span id="cb854-2710"><a href="#cb854-2710" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(item_test_NABS))</span>
<span id="cb854-2711"><a href="#cb854-2711" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>item_test_NABS, </span>
<span id="cb854-2712"><a href="#cb854-2712" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_subjects) <span class="sc">%&gt;%</span> </span>
<span id="cb854-2713"><a href="#cb854-2713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> pretty_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb854-2714"><a href="#cb854-2714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb854-2715"><a href="#cb854-2715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"# Correct"</span>,</span>
<span id="cb854-2716"><a href="#cb854-2716" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb854-2717"><a href="#cb854-2717" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Test Phase Absolute Score (# Correct)"</span>,</span>
<span id="cb854-2718"><a href="#cb854-2718" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb854-2719"><a href="#cb854-2719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2720"><a href="#cb854-2720" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb854-2721"><a href="#cb854-2721" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb854-2722"><a href="#cb854-2722" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df) <span class="sc">%&gt;%</span></span>
<span id="cb854-2723"><a href="#cb854-2723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb854-2724"><a href="#cb854-2724" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Correct Responses in Test Phase"</span>,</span>
<span id="cb854-2725"><a href="#cb854-2725" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Task by Condition"</span>,</span>
<span id="cb854-2726"><a href="#cb854-2726" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb854-2727"><a href="#cb854-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2728"><a href="#cb854-2728" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb854-2729"><a href="#cb854-2729" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb854-2730"><a href="#cb854-2730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb854-2731"><a href="#cb854-2731" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb854-2732"><a href="#cb854-2732" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb854-2733"><a href="#cb854-2733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb854-2734"><a href="#cb854-2734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb854-2735"><a href="#cb854-2735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb854-2736"><a href="#cb854-2736" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb854-2737"><a href="#cb854-2737" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb854-2738"><a href="#cb854-2738" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb854-2739"><a href="#cb854-2739" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb854-2740"><a href="#cb854-2740" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb854-2741"><a href="#cb854-2741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2742"><a href="#cb854-2742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2743"><a href="#cb854-2743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2744"><a href="#cb854-2744" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- CONTINUOUS</span></span>
<span id="cb854-2745"><a href="#cb854-2745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2746"><a href="#cb854-2746" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- BINOMIAL</span></span>
<span id="cb854-2747"><a href="#cb854-2747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2748"><a href="#cb854-2748" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mixed Logistic Regression</span></span>
<span id="cb854-2749"><a href="#cb854-2749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2750"><a href="#cb854-2750" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on test phase questions by condition; accounting for random effects of subject.*</span>
<span id="cb854-2751"><a href="#cb854-2751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2752"><a href="#cb854-2752" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb854-2753"><a href="#cb854-2753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2756"><a href="#cb854-2756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2757"><a href="#cb854-2757" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb854-2758"><a href="#cb854-2758" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb854-2759"><a href="#cb854-2759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2760"><a href="#cb854-2760" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb854-2761"><a href="#cb854-2761" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb854-2762"><a href="#cb854-2762" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb854-2763"><a href="#cb854-2763" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb854-2764"><a href="#cb854-2764" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb854-2765"><a href="#cb854-2765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2766"><a href="#cb854-2766" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb854-2767"><a href="#cb854-2767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2768"><a href="#cb854-2768" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM EFFECT</span></span>
<span id="cb854-2769"><a href="#cb854-2769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2770"><a href="#cb854-2770" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb854-2771"><a href="#cb854-2771" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df) </span>
<span id="cb854-2772"><a href="#cb854-2772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2773"><a href="#cb854-2773" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb854-2774"><a href="#cb854-2774" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb854-2775"><a href="#cb854-2775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2776"><a href="#cb854-2776" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT ITEM</span></span>
<span id="cb854-2777"><a href="#cb854-2777" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb854-2778"><a href="#cb854-2778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2779"><a href="#cb854-2779" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb854-2780"><a href="#cb854-2780" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with random effect is lower than glm empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span>
<span id="cb854-2781"><a href="#cb854-2781" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb854-2782"><a href="#cb854-2782" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb854-2783"><a href="#cb854-2783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2784"><a href="#cb854-2784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2785"><a href="#cb854-2785" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT</span></span>
<span id="cb854-2786"><a href="#cb854-2786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2787"><a href="#cb854-2787" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span></span>
<span id="cb854-2788"><a href="#cb854-2788" aria-hidden="true" tabindex="-1"></a>mm.CrS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), </span>
<span id="cb854-2789"><a href="#cb854-2789" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb854-2790"><a href="#cb854-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2791"><a href="#cb854-2791" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span></span>
<span id="cb854-2792"><a href="#cb854-2792" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb854-2793"><a href="#cb854-2793" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb854-2794"><a href="#cb854-2794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2795"><a href="#cb854-2795" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> fixed factor </span></span>
<span id="cb854-2796"><a href="#cb854-2796" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with fixed effect is lower than random intercept only model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrS)) )</span>
<span id="cb854-2797"><a href="#cb854-2797" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS,mm.CrS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb854-2798"><a href="#cb854-2798" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS,mm.CrS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb854-2799"><a href="#cb854-2799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2800"><a href="#cb854-2800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2801"><a href="#cb854-2801" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb854-2802"><a href="#cb854-2802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2805"><a href="#cb854-2805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2806"><a href="#cb854-2806" aria-hidden="true" tabindex="-1"></a><span class="co">#: PRINT MODEL </span></span>
<span id="cb854-2807"><a href="#cb854-2807" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb854-2808"><a href="#cb854-2808" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(mm.CrS)</span>
<span id="cb854-2809"><a href="#cb854-2809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2810"><a href="#cb854-2810" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb854-2811"><a href="#cb854-2811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2812"><a href="#cb854-2812" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb854-2813"><a href="#cb854-2813" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(mm.CrS)</span>
<span id="cb854-2814"><a href="#cb854-2814" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb854-2815"><a href="#cb854-2815" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mm.CrS)</span>
<span id="cb854-2816"><a href="#cb854-2816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2817"><a href="#cb854-2817" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m1)))</span></span>
<span id="cb854-2818"><a href="#cb854-2818" aria-hidden="true" tabindex="-1"></a><span class="co"># # table of estimates with 95% CI</span></span>
<span id="cb854-2819"><a href="#cb854-2819" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m1), LL = fixef(m1) - 1.96 * se, UL = fixef(m1) + 1.96 *</span></span>
<span id="cb854-2820"><a href="#cb854-2820" aria-hidden="true" tabindex="-1"></a><span class="co">#     se))</span></span>
<span id="cb854-2821"><a href="#cb854-2821" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb854-2822"><a href="#cb854-2822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2823"><a href="#cb854-2823" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb854-2824"><a href="#cb854-2824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2825"><a href="#cb854-2825" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb854-2826"><a href="#cb854-2826" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb854-2827"><a href="#cb854-2827" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb854-2828"><a href="#cb854-2828" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb854-2829"><a href="#cb854-2829" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb854-2830"><a href="#cb854-2830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb854-2831"><a href="#cb854-2831" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb854-2832"><a href="#cb854-2832" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb854-2833"><a href="#cb854-2833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2834"><a href="#cb854-2834" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb854-2835"><a href="#cb854-2835" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"pred"</span>,</span>
<span id="cb854-2836"><a href="#cb854-2836" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-2837"><a href="#cb854-2837" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-2838"><a href="#cb854-2838" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb854-2839"><a href="#cb854-2839" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb854-2840"><a href="#cb854-2840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2841"><a href="#cb854-2841" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb854-2842"><a href="#cb854-2842" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb854-2843"><a href="#cb854-2843" aria-hidden="true" tabindex="-1"></a><span class="co"># ggeffect(model = mm.CrS) %&gt;% plot()</span></span>
<span id="cb854-2844"><a href="#cb854-2844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2845"><a href="#cb854-2845" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb854-2846"><a href="#cb854-2846" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb854-2847"><a href="#cb854-2847" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(mm.CrS))</span></span>
<span id="cb854-2848"><a href="#cb854-2848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2849"><a href="#cb854-2849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2850"><a href="#cb854-2850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2851"><a href="#cb854-2851" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb854-2852"><a href="#cb854-2852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2855"><a href="#cb854-2855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2856"><a href="#cb854-2856" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mm.CrS)</span>
<span id="cb854-2857"><a href="#cb854-2857" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(mm.CrS)</span>
<span id="cb854-2858"><a href="#cb854-2858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2859"><a href="#cb854-2859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2860"><a href="#cb854-2860" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb854-2861"><a href="#cb854-2861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2862"><a href="#cb854-2862" aria-hidden="true" tabindex="-1"></a>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(3): 4.98, p <span class="sc">\&lt;</span> 0.05). Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 5 over the control condition $e^{\beta_1}$ = 5.11, 95% CI <span class="sc">\[</span>1.17,22,36<span class="sc">\]</span>, p <span class="sc">\&lt;</span> 0.05.</span>
<span id="cb854-2863"><a href="#cb854-2863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2866"><a href="#cb854-2866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2867"><a href="#cb854-2867" aria-hidden="true" tabindex="-1"></a><span class="co"># PRETTY TABLE SJPLOT</span></span>
<span id="cb854-2868"><a href="#cb854-2868" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(mm.CrS)</span>
<span id="cb854-2869"><a href="#cb854-2869" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2870"><a href="#cb854-2870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2871"><a href="#cb854-2871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2872"><a href="#cb854-2872" aria-hidden="true" tabindex="-1"></a><span class="fu">#### BAYESIAN Mixed Lostistic Regression</span></span>
<span id="cb854-2873"><a href="#cb854-2873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2874"><a href="#cb854-2874" aria-hidden="true" tabindex="-1"></a>**Sanity Check** Compare frequentist model with bayesian alternative</span>
<span id="cb854-2875"><a href="#cb854-2875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2878"><a href="#cb854-2878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2879"><a href="#cb854-2879" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-BAYES-ACC</span></span>
<span id="cb854-2880"><a href="#cb854-2880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2881"><a href="#cb854-2881" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) </span>
<span id="cb854-2882"><a href="#cb854-2882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2883"><a href="#cb854-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2884"><a href="#cb854-2884" aria-hidden="true" tabindex="-1"></a><span class="do">##:::::::: FLAT PRIORS</span></span>
<span id="cb854-2885"><a href="#cb854-2885" aria-hidden="true" tabindex="-1"></a><span class="co">#fit matching bayesian model [flat priors]</span></span>
<span id="cb854-2886"><a href="#cb854-2886" aria-hidden="true" tabindex="-1"></a>FLAT_B.mm.CrSQ <span class="ot">&lt;-</span>  <span class="fu">brm</span>(</span>
<span id="cb854-2887"><a href="#cb854-2887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q)),</span>
<span id="cb854-2888"><a href="#cb854-2888" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_i,</span>
<span id="cb854-2889"><a href="#cb854-2889" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb854-2890"><a href="#cb854-2890" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb854-2891"><a href="#cb854-2891" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-2892"><a href="#cb854-2892" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-2893"><a href="#cb854-2893" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"analysis/utils/models/FLAT_B.mm.CrSQ.rds"</span></span>
<span id="cb854-2894"><a href="#cb854-2894" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-2895"><a href="#cb854-2895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2896"><a href="#cb854-2896" aria-hidden="true" tabindex="-1"></a><span class="co">#describe model</span></span>
<span id="cb854-2897"><a href="#cb854-2897" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FLAT_B.mm.CrSQ)</span>
<span id="cb854-2898"><a href="#cb854-2898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2899"><a href="#cb854-2899" aria-hidden="true" tabindex="-1"></a><span class="co">#compare to frequentist model</span></span>
<span id="cb854-2900"><a href="#cb854-2900" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"COMPARE TO FREQUENTIST"</span>)</span>
<span id="cb854-2901"><a href="#cb854-2901" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(mm.CrSQ, FLAT_B.mm.CrSQ)</span>
<span id="cb854-2902"><a href="#cb854-2902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2903"><a href="#cb854-2903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2904"><a href="#cb854-2904" aria-hidden="true" tabindex="-1"></a><span class="co">#_Here we see that the model with default priors yields estimates comparable to the frequentist mixed model, though slightly smaller for fixed effects condition, with tighter credible intervals._</span></span>
<span id="cb854-2905"><a href="#cb854-2905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2906"><a href="#cb854-2906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2907"><a href="#cb854-2907" aria-hidden="true" tabindex="-1"></a><span class="do">##:::::::: INFORMATIVE PRIORS</span></span>
<span id="cb854-2908"><a href="#cb854-2908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2909"><a href="#cb854-2909" aria-hidden="true" tabindex="-1"></a><span class="co">#describe priors that were used</span></span>
<span id="cb854-2910"><a href="#cb854-2910" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"DEFAULT PRIORS"</span>)</span>
<span id="cb854-2911"><a href="#cb854-2911" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(FLAT_B.mm.CrSQ)</span>
<span id="cb854-2912"><a href="#cb854-2912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2913"><a href="#cb854-2913" aria-hidden="true" tabindex="-1"></a><span class="co">#set informative priors for fixed effects</span></span>
<span id="cb854-2914"><a href="#cb854-2914" aria-hidden="true" tabindex="-1"></a><span class="co">#parameters normally distributed around the mean of the expected log coefficient</span></span>
<span id="cb854-2915"><a href="#cb854-2915" aria-hidden="true" tabindex="-1"></a><span class="co">#we expect low probability of accuracy in control [intercept] and in impasse, but higher variance in impasse</span></span>
<span id="cb854-2916"><a href="#cb854-2916" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb854-2917"><a href="#cb854-2917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>), <span class="at">class =</span> b),</span>
<span id="cb854-2918"><a href="#cb854-2918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>)</span>
<span id="cb854-2919"><a href="#cb854-2919" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-2920"><a href="#cb854-2920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2921"><a href="#cb854-2921" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model with informative priors</span></span>
<span id="cb854-2922"><a href="#cb854-2922" aria-hidden="true" tabindex="-1"></a>B.mm.CrSQ <span class="ot">&lt;-</span>  <span class="fu">brm</span>(</span>
<span id="cb854-2923"><a href="#cb854-2923" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q),</span>
<span id="cb854-2924"><a href="#cb854-2924" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb854-2925"><a href="#cb854-2925" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_i,</span>
<span id="cb854-2926"><a href="#cb854-2926" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb854-2927"><a href="#cb854-2927" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb854-2928"><a href="#cb854-2928" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-2929"><a href="#cb854-2929" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-2930"><a href="#cb854-2930" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"analysis/utils/models/B.mm.CrSQ.rds"</span></span>
<span id="cb854-2931"><a href="#cb854-2931" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-2932"><a href="#cb854-2932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2933"><a href="#cb854-2933" aria-hidden="true" tabindex="-1"></a><span class="co">#describe model</span></span>
<span id="cb854-2934"><a href="#cb854-2934" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(B.mm.CrSQ)</span>
<span id="cb854-2935"><a href="#cb854-2935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2936"><a href="#cb854-2936" aria-hidden="true" tabindex="-1"></a><span class="co">#compare to frequentist model</span></span>
<span id="cb854-2937"><a href="#cb854-2937" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"COMPARE TO UNFINFORMATIVE PRIOR"</span>)</span>
<span id="cb854-2938"><a href="#cb854-2938" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(FLAT_B.mm.CrSQ, B.mm.CrSQ)</span>
<span id="cb854-2939"><a href="#cb854-2939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2940"><a href="#cb854-2940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-2941"><a href="#cb854-2941" aria-hidden="true" tabindex="-1"></a>_Here we see tha the model with the informative prior makes predictions similar to the uninformative prior model_. </span>
<span id="cb854-2942"><a href="#cb854-2942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2945"><a href="#cb854-2945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-2946"><a href="#cb854-2946" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-ACC</span></span>
<span id="cb854-2947"><a href="#cb854-2947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2948"><a href="#cb854-2948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2949"><a href="#cb854-2949" aria-hidden="true" tabindex="-1"></a><span class="co">#DIAGNOSTICS</span></span>
<span id="cb854-2950"><a href="#cb854-2950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2951"><a href="#cb854-2951" aria-hidden="true" tabindex="-1"></a><span class="co">#set model </span></span>
<span id="cb854-2952"><a href="#cb854-2952" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> B.mm.CrSQ</span>
<span id="cb854-2953"><a href="#cb854-2953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2954"><a href="#cb854-2954" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb854-2955"><a href="#cb854-2955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2956"><a href="#cb854-2956" aria-hidden="true" tabindex="-1"></a><span class="co">#POSTERIOR CHECKS</span></span>
<span id="cb854-2957"><a href="#cb854-2957" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb854-2958"><a href="#cb854-2958" aria-hidden="true" tabindex="-1"></a><span class="fu">diagnostic_posterior</span>(m)</span>
<span id="cb854-2959"><a href="#cb854-2959" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m, <span class="at">ndraws =</span> <span class="dv">500</span>)</span>
<span id="cb854-2960"><a href="#cb854-2960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2961"><a href="#cb854-2961" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span>
<span id="cb854-2962"><a href="#cb854-2962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2963"><a href="#cb854-2963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2964"><a href="#cb854-2964" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERPRET</span></span>
<span id="cb854-2965"><a href="#cb854-2965" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_posterior</span>(m, <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"p_direction"</span>, <span class="st">"rope"</span>, <span class="st">"bayesfactor"</span>))</span>
<span id="cb854-2966"><a href="#cb854-2966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2967"><a href="#cb854-2967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2968"><a href="#cb854-2968" aria-hidden="true" tabindex="-1"></a><span class="co">#set working model</span></span>
<span id="cb854-2969"><a href="#cb854-2969" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> B.mm.CrSQ</span>
<span id="cb854-2970"><a href="#cb854-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2971"><a href="#cb854-2971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2972"><a href="#cb854-2972" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalence test </span></span>
<span id="cb854-2973"><a href="#cb854-2973" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"cet"</span>)</span>
<span id="cb854-2974"><a href="#cb854-2974" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb854-2975"><a href="#cb854-2975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2976"><a href="#cb854-2976" aria-hidden="true" tabindex="-1"></a><span class="co">#rope </span></span>
<span id="cb854-2977"><a href="#cb854-2977" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb854-2978"><a href="#cb854-2978" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb854-2979"><a href="#cb854-2979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2980"><a href="#cb854-2980" aria-hidden="true" tabindex="-1"></a><span class="co">#direction of effect </span></span>
<span id="cb854-2981"><a href="#cb854-2981" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m)</span>
<span id="cb854-2982"><a href="#cb854-2982" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb854-2983"><a href="#cb854-2983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2984"><a href="#cb854-2984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-2985"><a href="#cb854-2985" aria-hidden="true" tabindex="-1"></a><span class="co"># all parameters</span></span>
<span id="cb854-2986"><a href="#cb854-2986" aria-hidden="true" tabindex="-1"></a>m <span class="sc">%&gt;%</span> </span>
<span id="cb854-2987"><a href="#cb854-2987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb854-2988"><a href="#cb854-2988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(lp__, <span class="fu">contains</span>(<span class="st">"["</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb854-2989"><a href="#cb854-2989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb854-2990"><a href="#cb854-2990" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb854-2991"><a href="#cb854-2991" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb854-2992"><a href="#cb854-2992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb854-2993"><a href="#cb854-2993" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb854-2994"><a href="#cb854-2994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">point_interval =</span> mode_hdi,</span>
<span id="cb854-2995"><a href="#cb854-2995" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span> </span>
<span id="cb854-2996"><a href="#cb854-2996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,</span>
<span id="cb854-2997"><a href="#cb854-2997" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb854-2998"><a href="#cb854-2998" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb854-2999"><a href="#cb854-2999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb854-3000"><a href="#cb854-3000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3001"><a href="#cb854-3001" aria-hidden="true" tabindex="-1"></a><span class="co">#plot parameters</span></span>
<span id="cb854-3002"><a href="#cb854-3002" aria-hidden="true" tabindex="-1"></a><span class="fu">stanplot</span>(m, </span>
<span id="cb854-3003"><a href="#cb854-3003" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"areas"</span>,</span>
<span id="cb854-3004"><a href="#cb854-3004" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob =</span> <span class="fl">0.95</span>) </span>
<span id="cb854-3005"><a href="#cb854-3005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3006"><a href="#cb854-3006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3007"><a href="#cb854-3007" aria-hidden="true" tabindex="-1"></a><span class="co">#plot model</span></span>
<span id="cb854-3008"><a href="#cb854-3008" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m)</span>
<span id="cb854-3009"><a href="#cb854-3009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3010"><a href="#cb854-3010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3011"><a href="#cb854-3011" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT PARAMETERS</span></span>
<span id="cb854-3012"><a href="#cb854-3012" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, </span>
<span id="cb854-3013"><a href="#cb854-3013" aria-hidden="true" tabindex="-1"></a>                           <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb854-3014"><a href="#cb854-3014" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result) <span class="sc">+</span> </span>
<span id="cb854-3015"><a href="#cb854-3015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb854-3016"><a href="#cb854-3016" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Accuracy ~ Condition + (1 | subject) + (1 | question)"</span>,</span>
<span id="cb854-3017"><a href="#cb854-3017" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Logistic Mixed Effects Model"</span></span>
<span id="cb854-3018"><a href="#cb854-3018" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) </span>
<span id="cb854-3019"><a href="#cb854-3019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3020"><a href="#cb854-3020" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb854-3021"><a href="#cb854-3021" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)[[<span class="dv">1</span>]] <span class="sc">+</span> </span>
<span id="cb854-3022"><a href="#cb854-3022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb854-3023"><a href="#cb854-3023" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb854-3024"><a href="#cb854-3024" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Impasse increases Probability of Correct Response"</span></span>
<span id="cb854-3025"><a href="#cb854-3025" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb854-3026"><a href="#cb854-3026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3029"><a href="#cb854-3029" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3030"><a href="#cb854-3030" aria-hidden="true" tabindex="-1"></a><span class="co">#report(m)</span></span>
<span id="cb854-3031"><a href="#cb854-3031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3032"><a href="#cb854-3032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3033"><a href="#cb854-3033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3034"><a href="#cb854-3034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3035"><a href="#cb854-3035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3036"><a href="#cb854-3036" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- ORDINAL</span></span>
<span id="cb854-3037"><a href="#cb854-3037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3038"><a href="#cb854-3038" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- CATEGORICAL </span></span>
<span id="cb854-3039"><a href="#cb854-3039" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mixed Multinomial Regression</span></span>
<span id="cb854-3040"><a href="#cb854-3040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3041"><a href="#cb854-3041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3042"><a href="#cb854-3042" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of of items across the task?*</span>
<span id="cb854-3043"><a href="#cb854-3043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3044"><a href="#cb854-3044" aria-hidden="true" tabindex="-1"></a>*Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).*</span>
<span id="cb854-3045"><a href="#cb854-3045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3046"><a href="#cb854-3046" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can use mclogit mblogit() with random effect *or* bayesian brms package b/c nlme, lme4 don't support random effects on multinomial (ie no categorical family on glmer())</span>
<span id="cb854-3047"><a href="#cb854-3047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3048"><a href="#cb854-3048" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative would be to manually run <span class="co">[</span><span class="ot">k-1</span><span class="co">]</span> X binomial mixed models <span class="sc">\[</span>should compare outcomes<span class="sc">\]</span></span>
<span id="cb854-3049"><a href="#cb854-3049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3050"><a href="#cb854-3050" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">k-1</span><span class="co">]</span> equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) <span class="sc">\[</span>essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing <span class="sc">\[</span>reference category<span class="sc">\]</span> vs <span class="sc">\[</span>this category<span class="sc">\]</span>)</span>
<span id="cb854-3051"><a href="#cb854-3051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3052"><a href="#cb854-3052" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For *each* equation:</span>
<span id="cb854-3053"><a href="#cb854-3053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3054"><a href="#cb854-3054" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{0}$ *= Log Odds of \[this category type vs. reference category type) response in CONTROL condition*</span>
<span id="cb854-3055"><a href="#cb854-3055" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{0}}$ *= ODDS of \[this category type vs. reference category type\] response in CONTROL condition*</span>
<span id="cb854-3056"><a href="#cb854-3056" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{1}$ *=* $\beta_{1impasse}$ *Log Odds (Log OR; change in odds for \[this category\] type response in impasse (vs) control \[log scale\])*</span>
<span id="cb854-3057"><a href="#cb854-3057" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{1}}$ *= ODDS RATIO of \[this. vs reference category type\] response in IMPASSE (vs) CONTROL*</span>
<span id="cb854-3058"><a href="#cb854-3058" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Two-tailed NHST *Null hypothesis:* $\beta_{impasse} = 0$ *the odds for \[this category of response vs. reference\] are not different for IMPASSE condition*</span>
<span id="cb854-3059"><a href="#cb854-3059" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*Alternative hypothesis:* $\beta_{impasse} \ne 0$ *the odds of \[this category of response vs. reference\] increases or decreases for IMPASSE condition*</span>
<span id="cb854-3060"><a href="#cb854-3060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3061"><a href="#cb854-3061" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model \[MANUAL INDIVIDUAL BINOMIALS\]</span></span>
<span id="cb854-3062"><a href="#cb854-3062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3065"><a href="#cb854-3065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3066"><a href="#cb854-3066" aria-hidden="true" tabindex="-1"></a><span class="co">#VERIFY RESULTS BELOW VIA MULTIPLE INDIVIDUAL MODELS</span></span>
<span id="cb854-3067"><a href="#cb854-3067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3068"><a href="#cb854-3068" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ORTH vs. UNKNOWN"</span>)</span>
<span id="cb854-3069"><a href="#cb854-3069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3070"><a href="#cb854-3070" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"tri-like"</span>)) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb854-3071"><a href="#cb854-3071" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(d1<span class="sc">$</span>pretty_condition, d1<span class="sc">$</span>state)</span>
<span id="cb854-3072"><a href="#cb854-3072" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d1<span class="sc">$</span>pretty_condition, d1<span class="sc">$</span>state)</span>
<span id="cb854-3073"><a href="#cb854-3073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3074"><a href="#cb854-3074" aria-hidden="true" tabindex="-1"></a>m.unknown <span class="ot">&lt;-</span> <span class="fu">glmer</span>(state <span class="sc">~</span> pretty_condition <span class="sc">+</span> ( <span class="dv">1</span> <span class="sc">|</span> subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> q), <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> d1)</span>
<span id="cb854-3075"><a href="#cb854-3075" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.unknown)</span>
<span id="cb854-3076"><a href="#cb854-3076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3077"><a href="#cb854-3077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3078"><a href="#cb854-3078" aria-hidden="true" tabindex="-1"></a>*Being in the IMPASSE condition increases* the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 19 ( logodds = 2.92, z = 6.89, p <span class="sc">\&lt;</span> 0.001) . Participants in the impasse condition were 19x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control. (Conditional R2 = 0.67, marginal R2 = 0.21; SD(subject) = 1.55, SD(question) = 2.22)</span>
<span id="cb854-3079"><a href="#cb854-3079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3082"><a href="#cb854-3082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3083"><a href="#cb854-3083" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ORTH vs. TRIANGULAR"</span>)</span>
<span id="cb854-3084"><a href="#cb854-3084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3085"><a href="#cb854-3085" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"unknown"</span>)) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb854-3086"><a href="#cb854-3086" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(d2<span class="sc">$</span>pretty_condition, d2<span class="sc">$</span>state)</span>
<span id="cb854-3087"><a href="#cb854-3087" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d2<span class="sc">$</span>pretty_condition, d2<span class="sc">$</span>state)</span>
<span id="cb854-3088"><a href="#cb854-3088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3089"><a href="#cb854-3089" aria-hidden="true" tabindex="-1"></a>m.tri <span class="ot">&lt;-</span> <span class="fu">glmer</span>(state <span class="sc">~</span> pretty_condition <span class="sc">+</span> ( <span class="dv">1</span> <span class="sc">|</span> subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> q), <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> d2)</span>
<span id="cb854-3090"><a href="#cb854-3090" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.tri)</span>
<span id="cb854-3091"><a href="#cb854-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3092"><a href="#cb854-3092" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3093"><a href="#cb854-3093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3094"><a href="#cb854-3094" aria-hidden="true" tabindex="-1"></a>*Being in the IMPASSE condition increases* the odds of giving an triangle-like response by a factor of 305 ( logodds = 5.72, z = 4.14, p <span class="sc">\&lt;</span> 0.001) . Participants in the impasse condition were 305 times as likely to give an triangle-like response rather than an orthogonal response compared to participants in control. (Conditional R2 = 0.91, marginal R2 = 0.21; SD(subject) = 5.05, SD(q) = 1.09)</span>
<span id="cb854-3095"><a href="#cb854-3095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3096"><a href="#cb854-3096" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model \[mblogit\]</span></span>
<span id="cb854-3097"><a href="#cb854-3097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3100"><a href="#cb854-3100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3101"><a href="#cb854-3101" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb854-3102"><a href="#cb854-3102" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline category logit" model matches multinom()</span></span>
<span id="cb854-3103"><a href="#cb854-3103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3104"><a href="#cb854-3104" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb854-3105"><a href="#cb854-3105" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span>
<span id="cb854-3106"><a href="#cb854-3106" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_i<span class="sc">$</span>state)</span>
<span id="cb854-3107"><a href="#cb854-3107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3108"><a href="#cb854-3108" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb854-3109"><a href="#cb854-3109" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb854-3110"><a href="#cb854-3110" aria-hidden="true" tabindex="-1"></a>m.mbl0 <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> pretty_condition ,  <span class="co">#no random intercepts; fixed only model </span></span>
<span id="cb854-3111"><a href="#cb854-3111" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> df_i)</span>
<span id="cb854-3112"><a href="#cb854-3112" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(m.mbl0)</span></span>
<span id="cb854-3113"><a href="#cb854-3113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3114"><a href="#cb854-3114" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb854-3115"><a href="#cb854-3115" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb854-3116"><a href="#cb854-3116" aria-hidden="true" tabindex="-1"></a>m.mbl1 <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> pretty_condition , </span>
<span id="cb854-3117"><a href="#cb854-3117" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>( <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>subject, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb854-3118"><a href="#cb854-3118" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> df_i)</span>
<span id="cb854-3119"><a href="#cb854-3119" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m.mbl1)</span></span>
<span id="cb854-3120"><a href="#cb854-3120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3121"><a href="#cb854-3121" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb854-3122"><a href="#cb854-3122" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, <span class="fu">AIC</span>(m.mbl0) <span class="sc">&gt;</span> <span class="fu">AIC</span>(m.mbl1))</span>
<span id="cb854-3123"><a href="#cb854-3123" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.mbl0, m.mbl1)</span>
<span id="cb854-3124"><a href="#cb854-3124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3125"><a href="#cb854-3125" aria-hidden="true" tabindex="-1"></a><span class="co">#DESCRIBE MODEL</span></span>
<span id="cb854-3126"><a href="#cb854-3126" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.mbl1)</span>
<span id="cb854-3127"><a href="#cb854-3127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3128"><a href="#cb854-3128" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERPRET COEFFICIENTS</span></span>
<span id="cb854-3129"><a href="#cb854-3129" aria-hidden="true" tabindex="-1"></a>cint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m.mbl1, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb854-3130"><a href="#cb854-3130" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ODDS RATIO"</span>)</span>
<span id="cb854-3131"><a href="#cb854-3131" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m.mbl1)), <span class="fu">exp</span>(cint))) <span class="co">#exponentiated, adjusted</span></span>
<span id="cb854-3132"><a href="#cb854-3132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3133"><a href="#cb854-3133" aria-hidden="true" tabindex="-1"></a><span class="co">#PERFORMANCE</span></span>
<span id="cb854-3134"><a href="#cb854-3134" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m.mbl1)</span>
<span id="cb854-3135"><a href="#cb854-3135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3136"><a href="#cb854-3136" aria-hidden="true" tabindex="-1"></a><span class="co">#TABLE</span></span>
<span id="cb854-3137"><a href="#cb854-3137" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m.mbl1, <span class="at">transform =</span> <span class="st">"exp"</span>, <span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>)</span>
<span id="cb854-3138"><a href="#cb854-3138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3139"><a href="#cb854-3139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3140"><a href="#cb854-3140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3141"><a href="#cb854-3141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3142"><a href="#cb854-3142" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb854-3143"><a href="#cb854-3143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3144"><a href="#cb854-3144" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 12 (z = 6.48, p \&lt; 0.001) . **Participants in the impasse condition were 12x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb854-3145"><a href="#cb854-3145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3146"><a href="#cb854-3146" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving 'triangle-like' response rather than an orthogonal (or satisficing) response by a factor of 29 (z = 4.63, p \&lt; 0.001 ). **Participants in the impasse condition were more than 29x as likely to give an a triangular response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb854-3147"><a href="#cb854-3147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3148"><a href="#cb854-3148" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As with the (binary) logistic regression on accuracy \~ condition, significant model intercepts indicate that the odds of being in any particular response state (vs) orthogonal are significantly different than 1 *in the control condition.* (i.e. not 1:1 odds or 50% chance of being in that response state. Orthogonal is a much more probable response state in control)</span>
<span id="cb854-3149"><a href="#cb854-3149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3150"><a href="#cb854-3150" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb854-3151"><a href="#cb854-3151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3154"><a href="#cb854-3154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3155"><a href="#cb854-3155" aria-hidden="true" tabindex="-1"></a><span class="co">#set model </span></span>
<span id="cb854-3156"><a href="#cb854-3156" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m.mbl1</span>
<span id="cb854-3157"><a href="#cb854-3157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3158"><a href="#cb854-3158" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb854-3159"><a href="#cb854-3159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3160"><a href="#cb854-3160" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb854-3161"><a href="#cb854-3161" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb854-3162"><a href="#cb854-3162" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb854-3163"><a href="#cb854-3163" aria-hidden="true" tabindex="-1"></a>           <span class="at">transform =</span> <span class="st">"exp"</span>, <span class="co">#for some reason have to manually add for mixed?</span></span>
<span id="cb854-3164"><a href="#cb854-3164" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb854-3165"><a href="#cb854-3165" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb854-3166"><a href="#cb854-3166" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.05</span>, <span class="co">#can manually adjust to account for directional test</span></span>
<span id="cb854-3167"><a href="#cb854-3167" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">+</span>  <span class="co">#can manually adjusted for directional test   </span></span>
<span id="cb854-3168"><a href="#cb854-3168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ODDS RATIO | State ~ condition"</span>,</span>
<span id="cb854-3169"><a href="#cb854-3169" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"(p for  two-tailed test)"</span>)</span>
<span id="cb854-3170"><a href="#cb854-3170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3171"><a href="#cb854-3171" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb854-3172"><a href="#cb854-3172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3173"><a href="#cb854-3173" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT PARAMETER ESTIMATES</span></span>
<span id="cb854-3174"><a href="#cb854-3174" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">simulate_parameters</span>(m)</span>
<span id="cb854-3175"><a href="#cb854-3175" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">stack =</span> <span class="cn">FALSE</span>)</span>
<span id="cb854-3176"><a href="#cb854-3176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3177"><a href="#cb854-3177" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"cet"</span>)</span>
<span id="cb854-3178"><a href="#cb854-3178" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb854-3179"><a href="#cb854-3179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3180"><a href="#cb854-3180" aria-hidden="true" tabindex="-1"></a><span class="co">#raw coefficients</span></span>
<span id="cb854-3181"><a href="#cb854-3181" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m)</span>
<span id="cb854-3182"><a href="#cb854-3182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3183"><a href="#cb854-3183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3184"><a href="#cb854-3184" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT PARAMETERS</span></span>
<span id="cb854-3185"><a href="#cb854-3185" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, </span>
<span id="cb854-3186"><a href="#cb854-3186" aria-hidden="true" tabindex="-1"></a>                           <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb854-3187"><a href="#cb854-3187" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result) <span class="sc">+</span> </span>
<span id="cb854-3188"><a href="#cb854-3188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb854-3189"><a href="#cb854-3189" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Accuracy ~ Condition + (1 | subject) + (1 | question)"</span>,</span>
<span id="cb854-3190"><a href="#cb854-3190" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Logistic Mixed Effects Model"</span></span>
<span id="cb854-3191"><a href="#cb854-3191" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) </span>
<span id="cb854-3192"><a href="#cb854-3192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3193"><a href="#cb854-3193" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb854-3194"><a href="#cb854-3194" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO CAN'T SEEM TO COMPUTE MARGINAL EFFECTS PLOT FOR THE MIXED MODEL</span></span>
<span id="cb854-3195"><a href="#cb854-3195" aria-hidden="true" tabindex="-1"></a><span class="co"># pr &lt;- ggpredict(m, "pretty_condition", type = "fixed")</span></span>
<span id="cb854-3196"><a href="#cb854-3196" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(pr)</span></span>
<span id="cb854-3197"><a href="#cb854-3197" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb854-3198"><a href="#cb854-3198" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")</span></span>
<span id="cb854-3199"><a href="#cb854-3199" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "eff")</span></span>
<span id="cb854-3200"><a href="#cb854-3200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3201"><a href="#cb854-3201" aria-hidden="true" tabindex="-1"></a><span class="co"># TERNARY PLOT</span></span>
<span id="cb854-3202"><a href="#cb854-3202" aria-hidden="true" tabindex="-1"></a><span class="co"># library(plot3logit)</span></span>
<span id="cb854-3203"><a href="#cb854-3203" aria-hidden="true" tabindex="-1"></a><span class="co"># field3logit(ggpredict(m))</span></span>
<span id="cb854-3204"><a href="#cb854-3204" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/plot3logit/vignettes/plot3logit-overview.html</span></span>
<span id="cb854-3205"><a href="#cb854-3205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3206"><a href="#cb854-3206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3207"><a href="#cb854-3207" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb854-3208"><a href="#cb854-3208" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb854-3209"><a href="#cb854-3209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3210"><a href="#cb854-3210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3211"><a href="#cb854-3211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3212"><a href="#cb854-3212" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb854-3213"><a href="#cb854-3213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3214"><a href="#cb854-3214" aria-hidden="true" tabindex="-1"></a>**COMPARE TO MANUAL MODELS**</span>
<span id="cb854-3217"><a href="#cb854-3217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3218"><a href="#cb854-3218" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(m, m.unknown, m.tri)</span>
<span id="cb854-3219"><a href="#cb854-3219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3220"><a href="#cb854-3220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3221"><a href="#cb854-3221" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model \[brms\]</span></span>
<span id="cb854-3222"><a href="#cb854-3222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3225"><a href="#cb854-3225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3226"><a href="#cb854-3226" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb854-3227"><a href="#cb854-3227" aria-hidden="true" tabindex="-1"></a>mixcat<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb854-3228"><a href="#cb854-3228" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb854-3229"><a href="#cb854-3229" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb854-3230"><a href="#cb854-3230" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb854-3231"><a href="#cb854-3231" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb854-3232"><a href="#cb854-3232" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb854-3233"><a href="#cb854-3233" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/utils/models/mixcat1.rds"</span>)</span>
<span id="cb854-3234"><a href="#cb854-3234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3235"><a href="#cb854-3235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3236"><a href="#cb854-3236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3239"><a href="#cb854-3239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3240"><a href="#cb854-3240" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mixcat<span class="fl">.1</span></span>
<span id="cb854-3241"><a href="#cb854-3241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3242"><a href="#cb854-3242" aria-hidden="true" tabindex="-1"></a><span class="co">#DESCRIBE MODEL</span></span>
<span id="cb854-3243"><a href="#cb854-3243" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb854-3244"><a href="#cb854-3244" aria-hidden="true" tabindex="-1"></a><span class="co"># report(mixcat.1)</span></span>
<span id="cb854-3245"><a href="#cb854-3245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3246"><a href="#cb854-3246" aria-hidden="true" tabindex="-1"></a><span class="co">#TABLE</span></span>
<span id="cb854-3247"><a href="#cb854-3247" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m,</span></span>
<span id="cb854-3248"><a href="#cb854-3248" aria-hidden="true" tabindex="-1"></a>          <span class="co"># show.r2 = FALSE) #, transform = "exp", title = "Model Predicted Odds Ratio")</span></span>
<span id="cb854-3249"><a href="#cb854-3249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3250"><a href="#cb854-3250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3251"><a href="#cb854-3251" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb854-3252"><a href="#cb854-3252" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb854-3253"><a href="#cb854-3253" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m)</span></span>
<span id="cb854-3254"><a href="#cb854-3254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3255"><a href="#cb854-3255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3256"><a href="#cb854-3256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3257"><a href="#cb854-3257" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb854-3258"><a href="#cb854-3258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3259"><a href="#cb854-3259" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 43.86.</span>
<span id="cb854-3260"><a href="#cb854-3260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3261"><a href="#cb854-3261" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving 'triangle-like' response rather than an orthogonal (or satisficing) response by a factor of 6.64.</span>
<span id="cb854-3262"><a href="#cb854-3262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3263"><a href="#cb854-3263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3264"><a href="#cb854-3264" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb854-3265"><a href="#cb854-3265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3268"><a href="#cb854-3268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3269"><a href="#cb854-3269" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3270"><a href="#cb854-3270" aria-hidden="true" tabindex="-1"></a><span class="co"># #:::::::: PLOT</span></span>
<span id="cb854-3271"><a href="#cb854-3271" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3272"><a href="#cb854-3272" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb854-3273"><a href="#cb854-3273" aria-hidden="true" tabindex="-1"></a><span class="co"># #library(sjPlot)</span></span>
<span id="cb854-3274"><a href="#cb854-3274" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red", </span></span>
<span id="cb854-3275"><a href="#cb854-3275" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb854-3276"><a href="#cb854-3276" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb854-3277"><a href="#cb854-3277" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.05, #can manually adjust to account for directional test</span></span>
<span id="cb854-3278"><a href="#cb854-3278" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.95 ) +  #can manually adjusted for directional test   </span></span>
<span id="cb854-3279"><a href="#cb854-3279" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "ODDS RATIO | State ~ condition",</span></span>
<span id="cb854-3280"><a href="#cb854-3280" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "(p for one two test)")</span></span>
<span id="cb854-3281"><a href="#cb854-3281" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3282"><a href="#cb854-3282" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3283"><a href="#cb854-3283" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- estimate_density(m)</span></span>
<span id="cb854-3284"><a href="#cb854-3284" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE, priors = TRUE)</span></span>
<span id="cb854-3285"><a href="#cb854-3285" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3286"><a href="#cb854-3286" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- describe_posterior(m)</span></span>
<span id="cb854-3287"><a href="#cb854-3287" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE, priors = TRUE)</span></span>
<span id="cb854-3288"><a href="#cb854-3288" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3289"><a href="#cb854-3289" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- p_direction(m)</span></span>
<span id="cb854-3290"><a href="#cb854-3290" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE)</span></span>
<span id="cb854-3291"><a href="#cb854-3291" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3292"><a href="#cb854-3292" aria-hidden="true" tabindex="-1"></a><span class="co"># #ROPE</span></span>
<span id="cb854-3293"><a href="#cb854-3293" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- rope(m, ci = 0.89)</span></span>
<span id="cb854-3294"><a href="#cb854-3294" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result) + theme_clean()</span></span>
<span id="cb854-3295"><a href="#cb854-3295" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3296"><a href="#cb854-3296" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- equivalence_test(m)</span></span>
<span id="cb854-3297"><a href="#cb854-3297" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb854-3298"><a href="#cb854-3298" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3299"><a href="#cb854-3299" aria-hidden="true" tabindex="-1"></a><span class="co"># #ERROR incompatible arguments to calculate multivariate normal distribution</span></span>
<span id="cb854-3300"><a href="#cb854-3300" aria-hidden="true" tabindex="-1"></a><span class="co"># # result &lt;- simulate_parameters(m)</span></span>
<span id="cb854-3301"><a href="#cb854-3301" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot(result)</span></span>
<span id="cb854-3302"><a href="#cb854-3302" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3303"><a href="#cb854-3303" aria-hidden="true" tabindex="-1"></a><span class="co"># #check posterior</span></span>
<span id="cb854-3304"><a href="#cb854-3304" aria-hidden="true" tabindex="-1"></a><span class="co"># pp_check(m, ndraws=1000)</span></span>
<span id="cb854-3305"><a href="#cb854-3305" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3306"><a href="#cb854-3306" aria-hidden="true" tabindex="-1"></a><span class="co"># #PERFORMANCE</span></span>
<span id="cb854-3307"><a href="#cb854-3307" aria-hidden="true" tabindex="-1"></a><span class="co"># # performance(m)</span></span>
<span id="cb854-3308"><a href="#cb854-3308" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3309"><a href="#cb854-3309" aria-hidden="true" tabindex="-1"></a><span class="co"># #Plot parameters</span></span>
<span id="cb854-3310"><a href="#cb854-3310" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(model_parameters(m, exponentiate = TRUE))</span></span>
<span id="cb854-3311"><a href="#cb854-3311" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3312"><a href="#cb854-3312" aria-hidden="true" tabindex="-1"></a><span class="co"># #plot marginal predictions of model</span></span>
<span id="cb854-3313"><a href="#cb854-3313" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")[[1]] + </span></span>
<span id="cb854-3314"><a href="#cb854-3314" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(</span></span>
<span id="cb854-3315"><a href="#cb854-3315" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Predicted Marginal Probabilities",</span></span>
<span id="cb854-3316"><a href="#cb854-3316" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", </span></span>
<span id="cb854-3317"><a href="#cb854-3317" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "probability of being in each state"</span></span>
<span id="cb854-3318"><a href="#cb854-3318" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() </span></span>
<span id="cb854-3319"><a href="#cb854-3319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3320"><a href="#cb854-3320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3321"><a href="#cb854-3321" aria-hidden="true" tabindex="-1"></a><span class="fu">##### COMPARE</span></span>
<span id="cb854-3322"><a href="#cb854-3322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3325"><a href="#cb854-3325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3326"><a href="#cb854-3326" aria-hidden="true" tabindex="-1"></a><span class="co"># compare_models(m.unknown, m.tri, m.mbl1, mixcat.1)</span></span>
<span id="cb854-3327"><a href="#cb854-3327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3328"><a href="#cb854-3328" aria-hidden="true" tabindex="-1"></a>The predictions of the manual, frequentist mixed multinomial and bayesian mixed multinomial models are comparable. </span>
<span id="cb854-3329"><a href="#cb854-3329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3330"><a href="#cb854-3330" aria-hidden="true" tabindex="-1"></a>DECISION: Report bayesian model, because for some reason the visualization of the marginal predictions is actually working?</span>
<span id="cb854-3331"><a href="#cb854-3331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3332"><a href="#cb854-3332" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO</span></span>
<span id="cb854-3333"><a href="#cb854-3333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3334"><a href="#cb854-3334" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>priors? used default flat priors... ok?</span>
<span id="cb854-3335"><a href="#cb854-3335" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>posterior predictive checks</span>
<span id="cb854-3336"><a href="#cb854-3336" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>diagnostics on random effects</span>
<span id="cb854-3337"><a href="#cb854-3337" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>reconcilliation of mblogit() vs brms versions of the model; seems like they should yield similar estimates</span>
<span id="cb854-3338"><a href="#cb854-3338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3339"><a href="#cb854-3339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3340"><a href="#cb854-3340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3341"><a href="#cb854-3341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3344"><a href="#cb854-3344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3345"><a href="#cb854-3345" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb854-3346"><a href="#cb854-3346" aria-hidden="true" tabindex="-1"></a><span class="co">#df &lt;- df_items %&gt;% filter(q %nin% c(1,2,3,4,5,6,9)) %&gt;% filter(term=="spring18")</span></span>
<span id="cb854-3347"><a href="#cb854-3347" aria-hidden="true" tabindex="-1"></a><span class="co"># mm1 &lt;- brm( state ~ condition + (1|subject), data = df, family = "categorical", </span></span>
<span id="cb854-3348"><a href="#cb854-3348" aria-hidden="true" tabindex="-1"></a><span class="co"># file = "analysis/models/sgc3a_brms_mixedcat_teststate.rds" # cache model (can be removed)))</span></span>
<span id="cb854-3349"><a href="#cb854-3349" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm1)</span></span>
<span id="cb854-3350"><a href="#cb854-3350" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(mm1)</span></span>
<span id="cb854-3351"><a href="#cb854-3351" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mm1)</span></span>
<span id="cb854-3352"><a href="#cb854-3352" aria-hidden="true" tabindex="-1"></a><span class="co"># #report(mm1)</span></span>
<span id="cb854-3353"><a href="#cb854-3353" aria-hidden="true" tabindex="-1"></a><span class="co"># #check_posterior_predictions(mm1, draws=100)</span></span>
<span id="cb854-3354"><a href="#cb854-3354" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(bayesplot)</span></span>
<span id="cb854-3355"><a href="#cb854-3355" aria-hidden="true" tabindex="-1"></a><span class="co"># library(bayestestR)</span></span>
<span id="cb854-3356"><a href="#cb854-3356" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(mm1))</span></span>
<span id="cb854-3357"><a href="#cb854-3357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3358"><a href="#cb854-3358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3359"><a href="#cb854-3359" aria-hidden="true" tabindex="-1"></a><span class="fu">## WIP UNKNOWN</span></span>
<span id="cb854-3360"><a href="#cb854-3360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3361"><a href="#cb854-3361" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cummulative Ordinal (Bayesian) --- Equal Variance</span></span>
<span id="cb854-3362"><a href="#cb854-3362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3363"><a href="#cb854-3363" aria-hidden="true" tabindex="-1"></a>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb854-3364"><a href="#cb854-3364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3367"><a href="#cb854-3367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3368"><a href="#cb854-3368" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb854-3369"><a href="#cb854-3369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3370"><a href="#cb854-3370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3371"><a href="#cb854-3371" aria-hidden="true" tabindex="-1"></a><span class="co">#DEFINE DATA </span></span>
<span id="cb854-3372"><a href="#cb854-3372" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb854-3373"><a href="#cb854-3373" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb854-3374"><a href="#cb854-3374" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: why is this probit instead of logit?</span></span>
<span id="cb854-3375"><a href="#cb854-3375" aria-hidden="true" tabindex="-1"></a>cumord <span class="ot">&lt;-</span> <span class="fu">brm</span>( <span class="at">formula =</span> state <span class="sc">~</span> condition,</span>
<span id="cb854-3376"><a href="#cb854-3376" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb854-3377"><a href="#cb854-3377" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"probit"</span>),</span>
<span id="cb854-3378"><a href="#cb854-3378" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/utils/models/sgc3a_brms_cumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb854-3379"><a href="#cb854-3379" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-3380"><a href="#cb854-3380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3381"><a href="#cb854-3381" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cumord)</span>
<span id="cb854-3382"><a href="#cb854-3382" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-3383"><a href="#cb854-3383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3384"><a href="#cb854-3384" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT</span></span>
<span id="cb854-3385"><a href="#cb854-3385" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(cumord)</span>
<span id="cb854-3386"><a href="#cb854-3386" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cumord)</span>
<span id="cb854-3387"><a href="#cb854-3387" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(cumord))</span>
<span id="cb854-3388"><a href="#cb854-3388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3389"><a href="#cb854-3389" aria-hidden="true" tabindex="-1"></a><span class="co">#REPORT</span></span>
<span id="cb854-3390"><a href="#cb854-3390" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(cumord)</span>
<span id="cb854-3391"><a href="#cb854-3391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3392"><a href="#cb854-3392" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum %&gt;%</span></span>
<span id="cb854-3393"><a href="#cb854-3393" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb854-3394"><a href="#cb854-3394" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb854-3395"><a href="#cb854-3395" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb854-3396"><a href="#cb854-3396" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb854-3397"><a href="#cb854-3397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3398"><a href="#cb854-3398" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(cumord)</span></span>
<span id="cb854-3399"><a href="#cb854-3399" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(cumord)</span></span>
<span id="cb854-3400"><a href="#cb854-3400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3401"><a href="#cb854-3401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3402"><a href="#cb854-3402" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cummulative Ordinal (Bayesian) --- Unequal Variance</span></span>
<span id="cb854-3403"><a href="#cb854-3403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3404"><a href="#cb854-3404" aria-hidden="true" tabindex="-1"></a>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb854-3405"><a href="#cb854-3405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3408"><a href="#cb854-3408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3409"><a href="#cb854-3409" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb854-3410"><a href="#cb854-3410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3411"><a href="#cb854-3411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3412"><a href="#cb854-3412" aria-hidden="true" tabindex="-1"></a><span class="co">#DEFINE DATA </span></span>
<span id="cb854-3413"><a href="#cb854-3413" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb854-3414"><a href="#cb854-3414" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb854-3415"><a href="#cb854-3415" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: why is this probit instead of logit?</span></span>
<span id="cb854-3416"><a href="#cb854-3416" aria-hidden="true" tabindex="-1"></a>u.cumord <span class="ot">&lt;-</span> <span class="fu">brm</span>( </span>
<span id="cb854-3417"><a href="#cb854-3417" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(state <span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb854-3418"><a href="#cb854-3418" aria-hidden="true" tabindex="-1"></a>               <span class="fu">lf</span>(disc <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> condition, <span class="at">cmc =</span> <span class="cn">FALSE</span>),</span>
<span id="cb854-3419"><a href="#cb854-3419" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb854-3420"><a href="#cb854-3420" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"probit"</span>),</span>
<span id="cb854-3421"><a href="#cb854-3421" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/utils/models/sgc3a_brms_ucumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb854-3422"><a href="#cb854-3422" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-3423"><a href="#cb854-3423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3424"><a href="#cb854-3424" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(u.cumord)</span>
<span id="cb854-3425"><a href="#cb854-3425" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(u.cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-3426"><a href="#cb854-3426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3427"><a href="#cb854-3427" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT</span></span>
<span id="cb854-3428"><a href="#cb854-3428" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(u.cumord)</span>
<span id="cb854-3429"><a href="#cb854-3429" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(u.cumord)</span>
<span id="cb854-3430"><a href="#cb854-3430" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(u.cumord))</span>
<span id="cb854-3431"><a href="#cb854-3431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3432"><a href="#cb854-3432" aria-hidden="true" tabindex="-1"></a><span class="co">#REPORT</span></span>
<span id="cb854-3433"><a href="#cb854-3433" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(u.cumord)</span>
<span id="cb854-3434"><a href="#cb854-3434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3435"><a href="#cb854-3435" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum %&gt;%</span></span>
<span id="cb854-3436"><a href="#cb854-3436" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb854-3437"><a href="#cb854-3437" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb854-3438"><a href="#cb854-3438" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb854-3439"><a href="#cb854-3439" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb854-3440"><a href="#cb854-3440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3441"><a href="#cb854-3441" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(cumord)</span></span>
<span id="cb854-3442"><a href="#cb854-3442" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(cumord)</span></span>
<span id="cb854-3443"><a href="#cb854-3443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3444"><a href="#cb854-3444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3445"><a href="#cb854-3445" aria-hidden="true" tabindex="-1"></a>In brms, the parameter related to latent variances is called disc (short for "discrimination"), following conventions in item response theory. Note that disc is not the variance itself, but the inverse of the standard deviation, s. That is, s = 1/disc. Further, because disc must be strictly positive, it is by default modeled on the log scale.</span>
<span id="cb854-3446"><a href="#cb854-3446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3447"><a href="#cb854-3447" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjacent-Category Ordinal (Bayesian)</span></span>
<span id="cb854-3448"><a href="#cb854-3448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3451"><a href="#cb854-3451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3452"><a href="#cb854-3452" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb854-3453"><a href="#cb854-3453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3454"><a href="#cb854-3454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3455"><a href="#cb854-3455" aria-hidden="true" tabindex="-1"></a><span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span></span>
<span id="cb854-3456"><a href="#cb854-3456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3457"><a href="#cb854-3457" aria-hidden="true" tabindex="-1"></a>adjcat <span class="ot">&lt;-</span> <span class="fu">brm</span>( <span class="at">formula =</span> state <span class="sc">~</span> <span class="fu">cs</span>(condition),</span>
<span id="cb854-3458"><a href="#cb854-3458" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb854-3459"><a href="#cb854-3459" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">acat</span>(<span class="st">"probit"</span>),</span>
<span id="cb854-3460"><a href="#cb854-3460" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/utils/models/sgc3a_brms_adjcat_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb854-3461"><a href="#cb854-3461" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb854-3462"><a href="#cb854-3462" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb854-3463"><a href="#cb854-3463" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adjcat)</span>
<span id="cb854-3464"><a href="#cb854-3464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3465"><a href="#cb854-3465" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-3466"><a href="#cb854-3466" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(adjcat, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb854-3467"><a href="#cb854-3467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3468"><a href="#cb854-3468" aria-hidden="true" tabindex="-1"></a><span class="co">#WHICH IS BETTER? cumulative or adjacent?</span></span>
<span id="cb854-3469"><a href="#cb854-3469" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(cumord, adjcat))</span>
<span id="cb854-3470"><a href="#cb854-3470" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(cumord, adjcat)</span>
<span id="cb854-3471"><a href="#cb854-3471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3472"><a href="#cb854-3472" aria-hidden="true" tabindex="-1"></a><span class="co"># #TIDYBAYES VISUALIZATION</span></span>
<span id="cb854-3473"><a href="#cb854-3473" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidybayes)</span></span>
<span id="cb854-3474"><a href="#cb854-3474" aria-hidden="true" tabindex="-1"></a><span class="co"># adjcat %&gt;%</span></span>
<span id="cb854-3475"><a href="#cb854-3475" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb854-3476"><a href="#cb854-3476" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb854-3477"><a href="#cb854-3477" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb854-3478"><a href="#cb854-3478" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb854-3479"><a href="#cb854-3479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3480"><a href="#cb854-3480" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cumord)</span>
<span id="cb854-3481"><a href="#cb854-3481" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(adjcat)</span>
<span id="cb854-3482"><a href="#cb854-3482" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(adjcat)</span>
<span id="cb854-3483"><a href="#cb854-3483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3484"><a href="#cb854-3484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3485"><a href="#cb854-3485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3486"><a href="#cb854-3486" aria-hidden="true" tabindex="-1"></a>*Converges, but estimates are unreliable?*</span>
<span id="cb854-3487"><a href="#cb854-3487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3488"><a href="#cb854-3488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3489"><a href="#cb854-3489" aria-hidden="true" tabindex="-1"></a><span class="fu">## HELPERS</span></span>
<span id="cb854-3490"><a href="#cb854-3490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3491"><a href="#cb854-3491" aria-hidden="true" tabindex="-1"></a><span class="fu">### Odds and Probabilities </span></span>
<span id="cb854-3494"><a href="#cb854-3494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3495"><a href="#cb854-3495" aria-hidden="true" tabindex="-1"></a><span class="co"># t &lt;- table( df$pretty_condition, df$accuracy)</span></span>
<span id="cb854-3496"><a href="#cb854-3496" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3497"><a href="#cb854-3497" aria-hidden="true" tabindex="-1"></a><span class="co"># print("AS FREQUENCY")</span></span>
<span id="cb854-3498"><a href="#cb854-3498" aria-hidden="true" tabindex="-1"></a><span class="co"># t %&gt;% addmargins()</span></span>
<span id="cb854-3499"><a href="#cb854-3499" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3500"><a href="#cb854-3500" aria-hidden="true" tabindex="-1"></a><span class="co"># print("AS PROBABILITY")</span></span>
<span id="cb854-3501"><a href="#cb854-3501" aria-hidden="true" tabindex="-1"></a><span class="co"># prop.table(t) %&gt;% addmargins()</span></span>
<span id="cb854-3502"><a href="#cb854-3502" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3503"><a href="#cb854-3503" aria-hidden="true" tabindex="-1"></a><span class="co"># print("GRAND PROBABILITY")</span></span>
<span id="cb854-3504"><a href="#cb854-3504" aria-hidden="true" tabindex="-1"></a><span class="co"># (p_grand &lt;-  sum(t[,2]) / sum(t))</span></span>
<span id="cb854-3505"><a href="#cb854-3505" aria-hidden="true" tabindex="-1"></a><span class="co"># print("GRAND ODDS")</span></span>
<span id="cb854-3506"><a href="#cb854-3506" aria-hidden="true" tabindex="-1"></a><span class="co"># (odds_grand &lt;- sum(t[,2]) / sum(t[,1]))</span></span>
<span id="cb854-3507"><a href="#cb854-3507" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3508"><a href="#cb854-3508" aria-hidden="true" tabindex="-1"></a><span class="co"># print("P_control")</span></span>
<span id="cb854-3509"><a href="#cb854-3509" aria-hidden="true" tabindex="-1"></a><span class="co"># (p_control &lt;- t[1,2]/sum(t[1,]))</span></span>
<span id="cb854-3510"><a href="#cb854-3510" aria-hidden="true" tabindex="-1"></a><span class="co"># print("ODDS_control") # correct:incorrect</span></span>
<span id="cb854-3511"><a href="#cb854-3511" aria-hidden="true" tabindex="-1"></a><span class="co"># (odds_control &lt;- t[1,2] / t[1,1])</span></span>
<span id="cb854-3512"><a href="#cb854-3512" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3513"><a href="#cb854-3513" aria-hidden="true" tabindex="-1"></a><span class="co"># print("P_impasse")</span></span>
<span id="cb854-3514"><a href="#cb854-3514" aria-hidden="true" tabindex="-1"></a><span class="co"># (p_impasse &lt;- t[2,2] / sum(t[2,]))</span></span>
<span id="cb854-3515"><a href="#cb854-3515" aria-hidden="true" tabindex="-1"></a><span class="co"># print("ODDS_impasse") # correct:incorrect</span></span>
<span id="cb854-3516"><a href="#cb854-3516" aria-hidden="true" tabindex="-1"></a><span class="co"># (odds_impasse &lt;- t[2,2] / t[2,1])</span></span>
<span id="cb854-3517"><a href="#cb854-3517" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb854-3518"><a href="#cb854-3518" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("ODDS RATIO FOR IMPASSE", odds_impasse-odds_control)</span></span>
<span id="cb854-3519"><a href="#cb854-3519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3520"><a href="#cb854-3520" aria-hidden="true" tabindex="-1"></a><span class="co"># to calculate odds from odds ratio ... ODDS = OR * [denominator of ratio]</span></span>
<span id="cb854-3521"><a href="#cb854-3521" aria-hidden="true" tabindex="-1"></a><span class="co">#eg.  ODDS [impasse] = OR[impasse] * ODDS[control] = [b_impasse] * [intercept] #for dummy coding </span></span>
<span id="cb854-3522"><a href="#cb854-3522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3523"><a href="#cb854-3523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb854-3524"><a href="#cb854-3524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3525"><a href="#cb854-3525" aria-hidden="true" tabindex="-1"></a><span class="fu">## GGDist bayesian posterior vis</span></span>
<span id="cb854-3526"><a href="#cb854-3526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3529"><a href="#cb854-3529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb854-3530"><a href="#cb854-3530" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_i %&gt;% filter(q %nin% c(6,9)) %&gt;% droplevels()</span></span>
<span id="cb854-3531"><a href="#cb854-3531" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3532"><a href="#cb854-3532" aria-hidden="true" tabindex="-1"></a><span class="co"># #WORKING visualize post dist of prediction</span></span>
<span id="cb854-3533"><a href="#cb854-3533" aria-hidden="true" tabindex="-1"></a><span class="co"># #create df of 'draws' from the </span></span>
<span id="cb854-3534"><a href="#cb854-3534" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df %&gt;%</span></span>
<span id="cb854-3535"><a href="#cb854-3535" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb854-3536"><a href="#cb854-3536" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_predicted_draws(Bmm.CrSQ) </span></span>
<span id="cb854-3537"><a href="#cb854-3537" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3538"><a href="#cb854-3538" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb854-3539"><a href="#cb854-3539" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- draws %&gt;% </span></span>
<span id="cb854-3540"><a href="#cb854-3540" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .prediction, y = pretty_condition)) +</span></span>
<span id="cb854-3541"><a href="#cb854-3541" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab() + labs(title = "Posterior Predictions??")</span></span>
<span id="cb854-3542"><a href="#cb854-3542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3543"><a href="#cb854-3543" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3544"><a href="#cb854-3544" aria-hidden="true" tabindex="-1"></a><span class="co"># #WORKING visualize parameter distribution?</span></span>
<span id="cb854-3545"><a href="#cb854-3545" aria-hidden="true" tabindex="-1"></a><span class="co"># #create df of 'draws' from the </span></span>
<span id="cb854-3546"><a href="#cb854-3546" aria-hidden="true" tabindex="-1"></a><span class="co"># draws2 &lt;- df %&gt;%</span></span>
<span id="cb854-3547"><a href="#cb854-3547" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb854-3548"><a href="#cb854-3548" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_linpred_draws(Bmm.CrSQ,</span></span>
<span id="cb854-3549"><a href="#cb854-3549" aria-hidden="true" tabindex="-1"></a><span class="co">#                       re_formula = NA) %&gt;%     # zero out random effects (condition on average subj avg q)) %&gt;% </span></span>
<span id="cb854-3550"><a href="#cb854-3550" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() </span></span>
<span id="cb854-3551"><a href="#cb854-3551" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(!duplicated(.)) </span></span>
<span id="cb854-3552"><a href="#cb854-3552" aria-hidden="true" tabindex="-1"></a><span class="co">#   # mutate(probs = exp(.prediction)/(1+ exp(.prediction)))</span></span>
<span id="cb854-3553"><a href="#cb854-3553" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3554"><a href="#cb854-3554" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb854-3555"><a href="#cb854-3555" aria-hidden="true" tabindex="-1"></a><span class="co"># draws2 %&gt;% </span></span>
<span id="cb854-3556"><a href="#cb854-3556" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .linpred, y = pretty_condition)) +</span></span>
<span id="cb854-3557"><a href="#cb854-3557" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab()</span></span>
<span id="cb854-3558"><a href="#cb854-3558" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3559"><a href="#cb854-3559" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3560"><a href="#cb854-3560" aria-hidden="true" tabindex="-1"></a><span class="co"># #WORKING visualize posterior distribution as probabilities?</span></span>
<span id="cb854-3561"><a href="#cb854-3561" aria-hidden="true" tabindex="-1"></a><span class="co"># #create df of 'draws' from the </span></span>
<span id="cb854-3562"><a href="#cb854-3562" aria-hidden="true" tabindex="-1"></a><span class="co"># draws2 &lt;- df %&gt;%</span></span>
<span id="cb854-3563"><a href="#cb854-3563" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb854-3564"><a href="#cb854-3564" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_epred_draws(Bmm.CrSQ,</span></span>
<span id="cb854-3565"><a href="#cb854-3565" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb854-3566"><a href="#cb854-3566" aria-hidden="true" tabindex="-1"></a><span class="co">#                 </span></span>
<span id="cb854-3567"><a href="#cb854-3567" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb854-3568"><a href="#cb854-3568" aria-hidden="true" tabindex="-1"></a><span class="co"># draws2 %&gt;% </span></span>
<span id="cb854-3569"><a href="#cb854-3569" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .epred, y = pretty_condition)) +</span></span>
<span id="cb854-3570"><a href="#cb854-3570" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab()</span></span>
<span id="cb854-3571"><a href="#cb854-3571" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3572"><a href="#cb854-3572" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3573"><a href="#cb854-3573" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3574"><a href="#cb854-3574" aria-hidden="true" tabindex="-1"></a><span class="co"># #WORKING visualize posterior distribution as probabilities?</span></span>
<span id="cb854-3575"><a href="#cb854-3575" aria-hidden="true" tabindex="-1"></a><span class="co"># #create df of 'draws' from the </span></span>
<span id="cb854-3576"><a href="#cb854-3576" aria-hidden="true" tabindex="-1"></a><span class="co"># draws3 &lt;- df %&gt;%</span></span>
<span id="cb854-3577"><a href="#cb854-3577" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb854-3578"><a href="#cb854-3578" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.CrSQ,</span></span>
<span id="cb854-3579"><a href="#cb854-3579" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # scale = "linear", without scale linear, .value is probability of %</span></span>
<span id="cb854-3580"><a href="#cb854-3580" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA) %&gt;% </span></span>
<span id="cb854-3581"><a href="#cb854-3581" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() </span></span>
<span id="cb854-3582"><a href="#cb854-3582" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(!duplicated(.)) </span></span>
<span id="cb854-3583"><a href="#cb854-3583" aria-hidden="true" tabindex="-1"></a><span class="co">#   # mutate(probs = exp(.value)/(1+ exp(.value))) #same as scale = linear and doing the transformation manually</span></span>
<span id="cb854-3584"><a href="#cb854-3584" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3585"><a href="#cb854-3585" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb854-3586"><a href="#cb854-3586" aria-hidden="true" tabindex="-1"></a><span class="co"># draws3 %&gt;% </span></span>
<span id="cb854-3587"><a href="#cb854-3587" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .value, y = pretty_condition)) +</span></span>
<span id="cb854-3588"><a href="#cb854-3588" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab() </span></span>
<span id="cb854-3589"><a href="#cb854-3589" aria-hidden="true" tabindex="-1"></a><span class="co"># #x = .value plots the distribution of the ODDS ratios?</span></span>
<span id="cb854-3590"><a href="#cb854-3590" aria-hidden="true" tabindex="-1"></a><span class="co"># #without the scale = linear... gives probabilities of correct response?</span></span>
<span id="cb854-3591"><a href="#cb854-3591" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3592"><a href="#cb854-3592" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3593"><a href="#cb854-3593" aria-hidden="true" tabindex="-1"></a><span class="co"># THE GOOD ONE</span></span>
<span id="cb854-3594"><a href="#cb854-3594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb854-3595"><a href="#cb854-3595" aria-hidden="true" tabindex="-1"></a><span class="do">##WORKING</span></span>
<span id="cb854-3596"><a href="#cb854-3596" aria-hidden="true" tabindex="-1"></a><span class="do">## VIS probability of correct response</span></span>
<span id="cb854-3597"><a href="#cb854-3597" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df %&gt;%</span></span>
<span id="cb854-3598"><a href="#cb854-3598" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb854-3599"><a href="#cb854-3599" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_linpred_draws(Bmm.CrSQ,</span></span>
<span id="cb854-3600"><a href="#cb854-3600" aria-hidden="true" tabindex="-1"></a><span class="co">#                    transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb854-3601"><a href="#cb854-3601" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA) </span></span>
<span id="cb854-3602"><a href="#cb854-3602" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3603"><a href="#cb854-3603" aria-hidden="true" tabindex="-1"></a><span class="co"># #visualize the predictions</span></span>
<span id="cb854-3604"><a href="#cb854-3604" aria-hidden="true" tabindex="-1"></a><span class="co"># #TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb854-3605"><a href="#cb854-3605" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;%  </span></span>
<span id="cb854-3606"><a href="#cb854-3606" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .linpred,  y = 0, fill = pretty_condition)) +</span></span>
<span id="cb854-3607"><a href="#cb854-3607" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye(width = c(.95), alpha = 0.5) + </span></span>
<span id="cb854-3608"><a href="#cb854-3608" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim(0,1) + labs(</span></span>
<span id="cb854-3609"><a href="#cb854-3609" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Predicted Probability of Correct Response",</span></span>
<span id="cb854-3610"><a href="#cb854-3610" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "probability of correct response",</span></span>
<span id="cb854-3611"><a href="#cb854-3611" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "condition"</span></span>
<span id="cb854-3612"><a href="#cb854-3612" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +  theme_clean() + ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb854-3613"><a href="#cb854-3613" aria-hidden="true" tabindex="-1"></a><span class="co"># #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb854-3614"><a href="#cb854-3614" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb854-3615"><a href="#cb854-3615" aria-hidden="true" tabindex="-1"></a><span class="co"># #equivalent to...this! </span></span>
<span id="cb854-3616"><a href="#cb854-3616" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot_model(Bmm.CrSQ, type  = "pred")[[1]]+ylim(0,1) + coord_flip()</span></span>
<span id="cb854-3617"><a href="#cb854-3617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>