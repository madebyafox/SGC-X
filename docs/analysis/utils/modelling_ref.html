<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.640">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>SGC-X - Modelling Reference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../analysis/SGC2/1_sgc2_introduction.html" rel="next">
<link href="../../analysis/utils/scoring.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Modelling Reference</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/modelling_ref.html" class="sidebar-item-text sidebar-link active">Modelling Reference</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC2</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/3_sgc2_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/4_sgc2_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/5_sgc3A_exploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploratory Analyses</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/3_sgc4A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">SGC4C</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/1_sgc4C_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/2_sgc4C_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">SGC5A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/1_sgc5A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/2_sgc5A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">COMBINED</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/combined/combined.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Combined Study Data</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#independent-samples" id="toc-independent-samples" class="nav-link active" data-scroll-target="#independent-samples">INDEPENDENT SAMPLES</a>
  <ul class="collapse">
<li>
<a href="#continuous-outcome" id="toc-continuous-outcome" class="nav-link" data-scroll-target="#continuous-outcome">CONTINUOUS OUTCOME</a>
  <ul class="collapse">
<li><a href="#independent-samples-t-test-students-t" id="toc-independent-samples-t-test-students-t" class="nav-link" data-scroll-target="#independent-samples-t-test-students-t">Independent Samples T-Test (Student’s T)</a></li>
  <li><a href="#independent-samples-t-test-welchs-t" id="toc-independent-samples-t-test-welchs-t" class="nav-link" data-scroll-target="#independent-samples-t-test-welchs-t">Independent Samples T-Test (Welch’s T)</a></li>
  <li><a href="#yuens-t-test-trimmed-means" id="toc-yuens-t-test-trimmed-means" class="nav-link" data-scroll-target="#yuens-t-test-trimmed-means">Yuen’s T-Test (Trimmed Means)</a></li>
  <li><a href="#wilcoxon-rank-sum-mann-whitney-test" id="toc-wilcoxon-rank-sum-mann-whitney-test" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-mann-whitney-test">Wilcoxon Rank Sum (Mann-Whitney Test)</a></li>
  <li><a href="#floorceiling-corrections-wilcoxon-rank-sum" id="toc-floorceiling-corrections-wilcoxon-rank-sum" class="nav-link" data-scroll-target="#floorceiling-corrections-wilcoxon-rank-sum">Floor/Ceiling Corrections + Wilcoxon Rank Sum</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#censored-tobit-regression" id="toc-censored-tobit-regression" class="nav-link" data-scroll-target="#censored-tobit-regression">Censored (Tobit) Regression</a></li>
  </ul>
</li>
  <li>
<a href="#count-outcome" id="toc-count-outcome" class="nav-link" data-scroll-target="#count-outcome">COUNT OUTCOME</a>
  <ul class="collapse">
<li><a href="#poisson-regression" id="toc-poisson-regression" class="nav-link" data-scroll-target="#poisson-regression">Poisson Regression</a></li>
  <li><a href="#negative-binomial-regression" id="toc-negative-binomial-regression" class="nav-link" data-scroll-target="#negative-binomial-regression">Negative Binomial Regression</a></li>
  </ul>
</li>
  <li>
<a href="#mixture-models" id="toc-mixture-models" class="nav-link" data-scroll-target="#mixture-models">MIXTURE MODELS</a>
  <ul class="collapse">
<li><a href="#zero-inflated-poisson" id="toc-zero-inflated-poisson" class="nav-link" data-scroll-target="#zero-inflated-poisson">Zero Inflated Poisson</a></li>
  <li><a href="#zero-inflated-negative-binomial-regression" id="toc-zero-inflated-negative-binomial-regression" class="nav-link" data-scroll-target="#zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</a></li>
  <li><a href="#hurdle-model" id="toc-hurdle-model" class="nav-link" data-scroll-target="#hurdle-model">Hurdle Model</a></li>
  </ul>
</li>
  <li>
<a href="#beta-regression" id="toc-beta-regression" class="nav-link" data-scroll-target="#beta-regression">BETA REGRESSION</a>
  <ul class="collapse">
<li><a href="#beta-regression-1" id="toc-beta-regression-1" class="nav-link" data-scroll-target="#beta-regression-1">BETA Regression</a></li>
  <li><a href="#beta-hurdle-regression" id="toc-beta-hurdle-regression" class="nav-link" data-scroll-target="#beta-hurdle-regression">BETA HURDLE Regression</a></li>
  </ul>
</li>
  <li>
<a href="#binomial-outcome" id="toc-binomial-outcome" class="nav-link" data-scroll-target="#binomial-outcome">BINOMIAL OUTCOME</a>
  <ul class="collapse">
<li><a href="#chi-square" id="toc-chi-square" class="nav-link" data-scroll-target="#chi-square">CHI SQUARE</a></li>
  <li>
<a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">LOGISTIC REGRESSION</a>
  <ul class="collapse">
<li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#learning-notes" id="toc-learning-notes" class="nav-link" data-scroll-target="#learning-notes">Learning Notes</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#ordinal-outcome" id="toc-ordinal-outcome" class="nav-link" data-scroll-target="#ordinal-outcome">ORDINAL OUTCOME</a>
  <ul class="collapse">
<li>
<a href="#ordinal-regression-cumulative-link-proportional-odds" id="toc-ordinal-regression-cumulative-link-proportional-odds" class="nav-link" data-scroll-target="#ordinal-regression-cumulative-link-proportional-odds">ORDINAL REGRESSION — Cumulative Link; Proportional Odds</a>
  <ul class="collapse">
<li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1">Fit Model</a></li>
  <li><a href="#inference-1" id="toc-inference-1" class="nav-link" data-scroll-target="#inference-1">Inference</a></li>
  <li><a href="#visualize-model" id="toc-visualize-model" class="nav-link" data-scroll-target="#visualize-model">Visualize Model</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#categorical-outcome" id="toc-categorical-outcome" class="nav-link" data-scroll-target="#categorical-outcome">CATEGORICAL OUTCOME</a>
  <ul class="collapse">
<li><a href="#chi-square-1" id="toc-chi-square-1" class="nav-link" data-scroll-target="#chi-square-1">CHI SQUARE</a></li>
  <li>
<a href="#multinomial-regression" id="toc-multinomial-regression" class="nav-link" data-scroll-target="#multinomial-regression">MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
<li><a href="#fit-model-2" id="toc-fit-model-2" class="nav-link" data-scroll-target="#fit-model-2">Fit Model</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#inference-2" id="toc-inference-2" class="nav-link" data-scroll-target="#inference-2">Inference</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  <li><a href="#diagnostics-2" id="toc-diagnostics-2" class="nav-link" data-scroll-target="#diagnostics-2">Diagnostics</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#mixed-repeated-measures" id="toc-mixed-repeated-measures" class="nav-link" data-scroll-target="#mixed-repeated-measures">MIXED (Repeated Measures)</a>
  <ul class="collapse">
<li><a href="#mixed-continuous" id="toc-mixed-continuous" class="nav-link" data-scroll-target="#mixed-continuous">MIXED — CONTINUOUS</a></li>
  <li>
<a href="#mixed-binomial" id="toc-mixed-binomial" class="nav-link" data-scroll-target="#mixed-binomial">MIXED — BINOMIAL</a>
  <ul class="collapse">
<li>
<a href="#mixed-logistic-regression" id="toc-mixed-logistic-regression" class="nav-link" data-scroll-target="#mixed-logistic-regression">Mixed Logistic Regression</a>
  <ul class="collapse">
<li><a href="#fit-model-3" id="toc-fit-model-3" class="nav-link" data-scroll-target="#fit-model-3">Fit Model</a></li>
  <li><a href="#visualize-2" id="toc-visualize-2" class="nav-link" data-scroll-target="#visualize-2">Visualize</a></li>
  <li><a href="#diagnostics-3" id="toc-diagnostics-3" class="nav-link" data-scroll-target="#diagnostics-3">Diagnostics</a></li>
  <li><a href="#inference-3" id="toc-inference-3" class="nav-link" data-scroll-target="#inference-3">Inference</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#mixed-ordinal" id="toc-mixed-ordinal" class="nav-link" data-scroll-target="#mixed-ordinal">MIXED — ORDINAL</a></li>
  <li><a href="#mixed-categorical" id="toc-mixed-categorical" class="nav-link" data-scroll-target="#mixed-categorical">MIXED — CATEGORICAL</a></li>
  <li>
<a href="#wip-unknown" id="toc-wip-unknown" class="nav-link" data-scroll-target="#wip-unknown">WIP UNKNOWN</a>
  <ul class="collapse">
<li><a href="#cummulative-ordinal-bayesian-equal-variance" id="toc-cummulative-ordinal-bayesian-equal-variance" class="nav-link" data-scroll-target="#cummulative-ordinal-bayesian-equal-variance">Cummulative Ordinal (Bayesian) — Equal Variance</a></li>
  <li><a href="#cummulative-ordinal-bayesian-unequal-variance" id="toc-cummulative-ordinal-bayesian-unequal-variance" class="nav-link" data-scroll-target="#cummulative-ordinal-bayesian-unequal-variance">Cummulative Ordinal (Bayesian) — Unequal Variance</a></li>
  <li><a href="#adjacent-category-ordinal-bayesian" id="toc-adjacent-category-ordinal-bayesian" class="nav-link" data-scroll-target="#adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="modelling" class="quarto-section-identifier d-none d-lg-block">Modelling Reference</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">SGCX | Modelling Reference</p>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div style="page-break-after: always;"></div>
<p><strong>In this notebook we use data from study SGC3A to explore different modelling techniques and assess their suitability for the bimodal accuracy distributions in the SGC project data.</strong></p>
<div class="cell" data-hash="modelling_ref_cache/html/SETUP_e7812fd4381b3f6ce54e6d53d0da3fee">
<details><summary>CODE</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span> <span class="co"># %nin% operator</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jtools.jacob-long.com">jtools</a></span><span class="op">)</span> <span class="co">#misc helpers </span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span> <span class="co">#arrange plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span> <span class="co">#arrange shift function plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/ggformula">ggformula</a></span><span class="op">)</span> <span class="co">#easy graphs</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=vcdExtra">vcdExtra</a></span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span> <span class="co">#printing tables </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co">#visualize model coefficients</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonocarroll/ggeasy">ggeasy</a></span><span class="op">)</span> <span class="co">#the way it should be</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://indrajeetpatil.github.io/statsExpressions/">statsExpressions</a></span><span class="op">)</span> <span class="co">#expressions to add to plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a></span><span class="op">)</span> <span class="co">#plots with expressions</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/">ggdist</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span> <span class="co">#visualization log regr models</span>

<span class="co">#misc utilities</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://modelr.tidyverse.org">modelr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.mitchelloharawild.com/distributional/">distributional</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/">report</a></span><span class="op">)</span> <span class="co">#easystats reporting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/">see</a></span><span class="op">)</span> <span class="co">#easystats visualization</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span> <span class="co">#easystats model diagnostics</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datalorax/equatiomatic">equatiomatic</a></span><span class="op">)</span> <span class="co">#extract model equation</span>

<span class="co">#modelling</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/psychor/">WRS2</a></span><span class="op">)</span> <span class="co">#robust and nonparametric tests </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR">lmerTest</a></span><span class="op">)</span> <span class="co">#for CIs in glmer </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aloy/qqplotr">qqplotr</a></span><span class="op">)</span> <span class="co">#confint on qq plot</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gmodels</span><span class="op">)</span> <span class="co">#contingency table and CHISQR</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zeroinfl / hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co">#mixed effects models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/ordinal">ordinal</a></span><span class="op">)</span> <span class="co">#ordinal regression</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># polyr ordinal regression</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/">VGAM</a></span><span class="op">)</span> <span class="co">#censored, zero infl, etc</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://benjaminschlegel.ch/r/brant/">brant</a></span><span class="op">)</span> <span class="co">#brant test for ordinal regression</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span> <span class="co">#multinomial logistic regression </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/">bayestestR</a></span><span class="op">)</span>

<span class="co">#one package to rule them all</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co">#ALL THE THINGS</span>

<span class="co">#OUTPUT OPTIONS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>ggplot2.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">1</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="co">#GRAPH THEMEING</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/IMPORT-DATA_f716a9af5978c912086dfd9af5541625">
<details><summary>CODE</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># HACK WD FOR LOCAL RUNNING?</span>
<span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="co">#mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="co">#setwd(mbp)</span>

<span class="co">#IMPORT DATA </span>
<span class="va">df_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span><span class="op">)</span>
<span class="va">df_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span><span class="op">)</span>

<span class="co">#PREP DATA </span>
<span class="va">df_subjects</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  test_score <span class="op">=</span> <span class="va">item_test_NABS</span>,
  raw_condition <span class="op">=</span> <span class="va">condition</span>,
  condition <span class="op">=</span> <span class="va">pretty_condition</span>
<span class="op">)</span>

<span class="va">df_items</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>,
  scaled <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_SCALED</span>, <span class="st">"-1"</span> <span class="op">=</span> <span class="st">"orth"</span>, <span class="st">"-0.5"</span><span class="op">=</span><span class="st">"unknown"</span>,<span class="st">"0"</span><span class="op">=</span><span class="st">"uncertain"</span>,<span class="st">"0.5"</span><span class="op">=</span><span class="st">"lines"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"tri"</span><span class="op">)</span>,
  scaled <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.ordered</a></span><span class="op">(</span><span class="va">scaled</span><span class="op">)</span>,
  raw_condition <span class="op">=</span> <span class="va">condition</span>,
  condition <span class="op">=</span> <span class="va">pretty_condition</span>,
  state <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_SCALED</span>, <span class="co">#for ordinal</span>
                         <span class="st">"-1"</span> <span class="op">=</span> <span class="st">"orth-like"</span>,
                         <span class="st">"-0.5"</span> <span class="op">=</span> <span class="st">"unknown"</span>,
                         <span class="st">"0"</span> <span class="op">=</span> <span class="st">"unknown"</span>,
                         <span class="st">"0.5"</span> <span class="op">=</span> <span class="st">"tri-like"</span>,
                         <span class="st">"1"</span> <span class="op">=</span> <span class="st">"tri-like"</span><span class="op">)</span>,
  state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.ordered</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span>
<span class="op">)</span>
<span class="co"># 3 group ordered STATE variable</span>
<span class="co"># 5 group ordered SCALED variable [matches high_interpretation]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="independent-samples" class="level1"><h1>INDEPENDENT SAMPLES</h1>
<section id="continuous-outcome" class="level2"><h2 class="anchored" data-anchor-id="continuous-outcome">CONTINUOUS OUTCOME</h2>
<p><strong>Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?<br>
(# questions correct on test phase of task, [in lab] participants)</strong></p>
<p><em>(Can also be transformed to proportion or percentage).</em></p>
<div class="cell" data-hash="modelling_ref_cache/html/SETUP-IND-TESTSCORE_212e535fa26b39ad060262549bed0089">
<details><summary>CODE</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::SETUP DATA</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  condition min Q1 median Q3 max mean   sd  n missing
1   control   0  0      0  1   8 1.71 3.05 62       0
2   impasse   0  0      2  7   8 3.33 3.40 64       0</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>

<span class="co"># #GGFORMULA | FACETED HISTOGRAM</span>
<span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span>
<span class="co"># gf_props(~item_test_NABS, </span>
<span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span>
<span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span>
<span class="co">#   labs(x = "# Correct",</span>
<span class="co">#        y = "proportion of subjects",</span>
<span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span>
<span class="co">#        subtitle = "") + theme(legend.position = "blank")</span>

<span class="co">##GGPUBR | HIST+DENSITY SCORE </span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/gghistogram.html">gghistogram</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="st">"test_score"</span>, binwidth <span class="op">=</span> <span class="fl">0.5</span>,
   add <span class="op">=</span> <span class="st">"mean"</span>, rug <span class="op">=</span> <span class="cn">TRUE</span>,
   fill <span class="op">=</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span>
   add_density <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/facet.html">facet</a></span><span class="op">(</span><span class="va">p</span>, facet.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Distribution of TEST Absolute Score"</span>,
        subtitle <span class="op">=</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,
        x <span class="op">=</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, y <span class="op">=</span> <span class="st">"number of subjects"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-IND-TESTSCORE-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">##VERTICAL RAINCLOUD USING GGDISTR</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span>,
                        fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span>
    side <span class="op">=</span> <span class="st">"left"</span>,
    justification <span class="op">=</span> <span class="fl">1.1</span>,
    width <span class="op">=</span> <span class="fl">1</span>, 
    point_colour <span class="op">=</span> <span class="cn">NA</span>
   <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>
    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">.15</span>, 
    outlier.shape <span class="op">=</span> <span class="cn">NA</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">1.3</span>,
    alpha <span class="op">=</span> <span class="fl">.3</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span> 
      seed <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">.05</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> 
    title <span class="op">=</span> <span class="st">"Distribution of TEST Absolute Score "</span>,
    x <span class="op">=</span> <span class="st">"Condition"</span>, y <span class="op">=</span> <span class="st">"Total Absolute Score (Test Phase)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="cn">NA</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-IND-TESTSCORE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="independent-samples-t-test-students-t" class="level3"><h3 class="anchored" data-anchor-id="independent-samples-t-test-students-t">Independent Samples T-Test (Student’s T)</h3>
<ul>
<li>Tests null hypothesis that true difference in population mean is == 0</li>
<li>Assumes normally distributed variables</li>
<li>Assumes equal variance of samples (homogeneity of variance)</li>
<li>
<strong>SGC accuracy data violate both homogeneity and normality</strong>*</li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/STUDENTS-T_f8cf4924e46d8a981be948beead5ffeb">
<details><summary>CODE</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span> <span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>,data <span class="op">=</span> <span class="va">df</span>,
              paired <span class="op">=</span> <span class="cn">FALSE</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"two.sided"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># less, greater for one sided tests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  test_score by condition
t = -3, df = 124, p-value = 0.006
alternative hypothesis: true difference in means between group control and group impasse is not equal to 0
95 percent confidence interval:
 -2.759 -0.478
sample estimates:
mean in group control mean in group impasse 
                 1.71                  3.33 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in effectsize.htest(x, type = type, verbose = verbose, ...): Unable to
retrieve data from htest object. Using t_to_d() approximation.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

The Two Sample t-test testing the difference of test_score by condition (mean in group control = 1.71, mean in group impasse = 3.33) suggests that the effect is negative, statistically significant, and medium (difference = -1.62, 95% CI [-2.76, -0.48], t(124) = -2.81, p = 0.006; Cohen's d = -0.50, 95% CI [-0.86, -0.15])</code></pre>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-5_3dbb19111ca4af091575acd41050d8ed">
<details><summary>CODE</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STATSPLOT | VIOLIN</span>

<span class="co">#one tailed tests must be done manually by extracting results expression and adding as subtitle</span>
<span class="co">#default is two tailed test</span>
<span class="co"># results &lt;- two_sample_test( data = df, x = pretty_condition, </span>
<span class="co">#                             y = item_test_NABS,</span>
<span class="co">#                             alternative = "g")</span>

<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html">ggbetweenstats</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">test_score</span>, x <span class="op">=</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
               type <span class="op">=</span> <span class="st">"parametric"</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>,
               alternative  <span class="op">=</span> <span class="st">"g"</span>,
               pairwide.display <span class="op">=</span> <span class="st">"significant"</span>, <span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># + labs(subtitle = results$expression[[1]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="independent-samples-t-test-welchs-t" class="level3"><h3 class="anchored" data-anchor-id="independent-samples-t-test-welchs-t">Independent Samples T-Test (Welch’s T)</h3>
<ul>
<li>Tests null hypothesis that true difference in population mean is == 0</li>
<li>Assumes normally distributed variables</li>
<li>
<strong>Does not</strong> assumes equal variance of samples (homogeneity of variance)</li>
<li><strong><em>SGC accuracy data violates normality assumption</em></strong></li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/WELCHES-T_6f10fbbc0665988ef775bee24cb83bd0">
<details><summary>CODE</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span> <span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>,data <span class="op">=</span> <span class="va">df</span>,
              paired <span class="op">=</span> <span class="cn">FALSE</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  test_score by condition
t = -3, df = 123, p-value = 0.006
alternative hypothesis: true difference in means between group control and group impasse is not equal to 0
95 percent confidence interval:
 -2.76 -0.48
sample estimates:
mean in group control mean in group impasse 
                 1.71                  3.33 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in effectsize.htest(x, type = type, verbose = verbose, ...): Unable to
retrieve data from htest object. Using t_to_d() approximation.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

The Welch Two Sample t-test testing the difference of test_score by condition (mean in group control = 1.71, mean in group impasse = 3.33) suggests that the effect is negative, statistically significant, and medium (difference = -1.62, 95% CI [-2.76, -0.48], t(123.25) = -2.81, p = 0.006; Cohen's d = -0.51, 95% CI [-0.86, -0.15])</code></pre>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-7_ad53df923b04d156bfe09e9c58238dd8">
<details><summary>CODE</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STATSPLOT | VIOLIN</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html">ggbetweenstats</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">test_score</span>, x <span class="op">=</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
               type <span class="op">=</span> <span class="st">"parametric"</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span>,
               pairwide.display <span class="op">=</span> <span class="st">"significant"</span>, <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="yuens-t-test-trimmed-means" class="level3"><h3 class="anchored" data-anchor-id="yuens-t-test-trimmed-means">Yuen’s T-Test (Trimmed Means)</h3>
<ul>
<li>
<strong>Robust alternative to</strong> to t-test is Yuen’s t-test which uses trimmed means</li>
<li>Trimmed means are not desireable for this research scenario because they trim data from the extremes, and in this study these are true, interesting values</li>
<li><a href="https://garstats.wordpress.com/2017/11/28/trimmed-means/" class="uri">https://garstats.wordpress.com/2017/11/28/trimmed-means/</a></li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/YUENS-T_eabe6d5052b396b9a346c8af9cf59a1f">
<details><summary>CODE</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WRS2/man/yuen.html">yuenbt</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
              side <span class="op">=</span> <span class="cn">TRUE</span>, EQVAR <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Call:
yuenbt(formula = test_score ~ condition, data = df, side = TRUE, 
    EQVAR = FALSE)

Test statistic: -2.99 (df = NA), p-value = 0.00334

Trimmed mean difference:  -2.53 
95 percent confidence interval:
-4.15     -0.909 </code></pre>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-9_18b79d5de12f35e480648c0c33d22364">
<details><summary>CODE</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STATSPLOT | VIOLIN</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html">ggbetweenstats</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">test_score</span>, x <span class="op">=</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
               type <span class="op">=</span> <span class="st">"robust"</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span>,
               pairwide.display <span class="op">=</span> <span class="st">"significant"</span>, <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="wilcoxon-rank-sum-mann-whitney-test" class="level3"><h3 class="anchored" data-anchor-id="wilcoxon-rank-sum-mann-whitney-test">Wilcoxon Rank Sum (Mann-Whitney Test)</h3>
<ul>
<li>
<strong>Non parametric alternative</strong> to t-test; compares median rather than mean by ranking data</li>
<li>Does not assume normality</li>
<li>Does not assume equal variance of samples (homogeneity of variance)</li>
<li><strong>Appropriate for SGC accuracy data</strong></li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/WILCOXON RANK SUM_d53598cafcdd03a5db18f5853aba1b38">
<details><summary>CODE</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>,
                 pared <span class="op">=</span> <span class="cn">FALSE</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span><span class="op">)</span> <span class="co">#less, greater</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df$test_score by df$condition
W = 1438, p-value = 0.003
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>

The Wilcoxon rank sum test with continuity correction testing the difference in ranks between df$test_score and df$condition suggests that the effect is negative, statistically significant, and medium (W = 1438.00, p = 0.003; r (rank biserial) = -0.28, 95% CI [-0.45, -0.08])</code></pre>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-11_f31a3b2b7ee1629693594986fc3c8945">
<details><summary>CODE</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STATSPLOT | VIOLIN</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html">ggbetweenstats</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">test_score</span>, x <span class="op">=</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
               type <span class="op">=</span> <span class="st">"nonparametric"</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span>,
               pairwide.display <span class="op">=</span> <span class="st">"significant"</span>, <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="floorceiling-corrections-wilcoxon-rank-sum" class="level3"><h3 class="anchored" data-anchor-id="floorceiling-corrections-wilcoxon-rank-sum">Floor/Ceiling Corrections + Wilcoxon Rank Sum</h3>
<ul>
<li>The bimodal distribution of the subject-level score data do not meet the requirements for t-tests.</li>
<li>However, a non-parametric alternative is available (Wilcoxon rank sum test / Man-Whitney test)</li>
<li>Additional corrections are available for data with ‘floor’ and/or ‘ceiling’ effects via the ‘DACR’ package</li>
<li>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14 see also https://qmliu.shinyapps.io/DACFE/</li>
</ul>
<p>For comparison we run a standard followed by a Wilcoxon rank-sum (Mann-Whitney) test that is a nonparametric alternative for non-normally distributed data.</p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-12_cbe57b72aa03998b58a81527326f1bec">
<details><summary>CODE</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df$test_score by df$condition
W = 1438, p-value = 0.003
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>Next, we calculate the t-test and ANOVA (F-test) based on a series of corrections provided for data with floor and/or ceiling effects.</p>
<ul>
<li><a href="https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14" class="uri">https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14</a></li>
</ul>
<p>Using properties from truncated normal distributions, the authors propose an easy-to-use method for the <em>t</em>-test and ANOVA with ceiling/floor data.</p>
<p><em>The proposed method calculates the degrees of freedom based on the after-truncation sample sizes (where l = number of floor observations, and r = number of ceiling observations). The rationale was that the proposed method utilizes full information only from data points of n − r − l participants and partial information from data points of r + l participants of a group for the mean and variance estimation. Specifically, the corrected mean and variance estimates (Eqs. 14 and 15) are functions of mean and variance estimates using after-truncation data (n − r − l participants) and the standardized floor and ceiling threshold estimates. The thresholds are estimated using the ceiling and floor percentage estimates based on data points of n − r and n − l participants, respectively. This is a relatively conservative approach for calculating the degrees of freedom, which can help control the type I error rate. This feature can be beneficial, especially given the “replication crisis” in psychological and behavioral research.</em></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-13_043ce0b9ed69ba0b1e18e67477074b15">
<details><summary>CODE</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FLOOR-CEILING ADJUSTED T TESTS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DACF</span><span class="op">)</span> <span class="co">#tests for data with floor and ceiling </span>
<span class="co"># https://www.rdocumentation.org/packages/DACF/versions/1.0.0</span>

<span class="co">#prepare data [vector of scores for each group]</span>
<span class="va">score_111</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">test_score</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">score_121</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"impasse"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">test_score</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># recover the mean and variance for ceiling/floor data</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DACF/man/rec.mean.var.html">rec.mean.var</a></span><span class="op">(</span><span class="va">score_111</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># recover the mean and variance for ceiling/floor data</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DACF/man/rec.mean.var.html">rec.mean.var</a></span><span class="op">(</span><span class="va">score_121</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="st">"control"</span><span class="op">=</span><span class="va">a</span> ,<span class="st">"impasse"</span><span class="op">=</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>
<span class="va">r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        ceiling.percentage floor.percentage est.mean est.var
control              0.113            0.710    -7.70   207.4
impasse              0.172            0.422     2.39    51.8</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># method "a" uses original sample size</span>
<span class="co"># method "b" uses after-truncation sample size</span>

<span class="co"># perform adjusted t test</span>
<span class="fu"><a href="https://rdrr.io/pkg/DACF/man/lw.t.test.html">lw.t.test</a></span><span class="op">(</span><span class="va">score_111</span>,<span class="va">score_121</span>,<span class="st">"b"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$statistic
[1] -4.94

$p.value
[1] 0.000012

$est.d
[1] -0.887

$conf.int
[1] -14.22  -5.97</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FLOOR-CEILING ADJUSTED F* TEST ANOVA</span>
<span class="fu"><a href="https://rdrr.io/pkg/DACF/man/lw.f.star.html">lw.f.star</a></span><span class="op">(</span><span class="va">df</span>,<span class="va">test_score</span><span class="op">~</span><span class="va">condition</span>,<span class="st">"b"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$statistic
[1] 5.85

$p.value
[1] 0.0321

$est.f.squared
[1] 0.158</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># method "a" uses original sample size</span>
<span class="co"># method "b" uses after-truncation sample size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>The control condition has 11% of data at ceiling and 71% at floor, with corrected mean of -7 and variance of 207. The impasse condition has 17% at ceiling, and only 42% at floor, with with corrected mean of 2.39 and variance respectively as of 58.</em></p>
<p><em>A corrected t-test t statistic is -4.94, p = 0.05. The estimated Cohen’s d is -0.89 with a confidence interval 0f [-14.22, -5.97].</em></p>
<p><em>A correct F-test (ANOVA) has a corrected F-statstic of 5.85, p &lt; 0.05, and Fsquared effect size of 0.195</em></p>
</section><section id="linear-regression" class="level3"><h3 class="anchored" data-anchor-id="linear-regression">Linear Regression</h3>
<ul>
<li>Assumes homogeneity of variance</li>
<li>Assumes normally distributed residuals</li>
<li>when default dummy coding is used;
<ul>
<li>intercept = predicted mean of first group,</li>
<li>predictor coefficient = difference to mean of second group</li>
</ul>
</li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-14_001f56255be4a657fd23dd3011297356">
<details><summary>CODE</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SCORE predicted by CONDITION</span>
<span class="va">lm.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = test_score ~ condition, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
 -3.33  -1.71  -1.71   3.67   6.29 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         1.710      0.411    4.16 0.000058 ***
conditionimpasse    1.618      0.576    2.81   0.0058 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.23 on 124 degrees of freedom
Multiple R-squared:  0.0598,    Adjusted R-squared:  0.0522 
F-statistic: 7.89 on 1 and 124 DF,  p-value: 0.00579</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Partition Variance"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: test_score
           Df Sum Sq Mean Sq F value Pr(&gt;F)   
condition   1     82    82.5    7.89 0.0058 **
Residuals 124   1297    10.5                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Confidence Interval on Parameter Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
(Intercept)      0.897   2.52
conditionimpasse 0.478   2.76</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span> <span class="co">#sanity check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict test_score with condition (formula: test_score ~ condition). The model explains a statistically significant and weak proportion of variance (R2 = 0.06, F(1, 124) = 7.89, p = 0.006, adj. R2 = 0.05). The model's intercept, corresponding to condition = control, is at 1.71 (95% CI [0.90, 2.52], t(124) = 4.16, p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically significant and positive (beta = 1.62, 95% CI [0.48, 2.76], t(124) = 2.81, p = 0.006; Std. beta = 0.49, 95% CI [0.14, 0.83])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/PLOT-MODEL-COEFSS-GGDIST_b51595fb6a552e802da625b5fddb62fb">
<details><summary>CODE</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span>

<span class="co">#setup references</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="va">lm.1</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span>
<span class="va">call</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">$</span><span class="va">call</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># uncertainty model visualization</span>
<span class="va">df</span>  <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">modelr</span><span class="fu">::</span><span class="fu"><a href="https://modelr.tidyverse.org/reference/data_grid.html">data_grid</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">lm.1</span>, newdata <span class="op">=</span> <span class="va">.</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">condition</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span> scale <span class="op">=</span> <span class="fl">.5</span>,
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
        xdist <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_student_t.html">dist_student_t</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">.fitted</span>, sigma <span class="op">=</span> <span class="va">.se.fit</span><span class="op">)</span>,
        fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/cut_cdf_qi.html">cut_cdf_qi</a></span><span class="op">(</span><span class="va">cdf</span>,
                .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.90</span>, <span class="fl">.95</span><span class="op">)</span>,
                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span> <span class="op">(</span>title <span class="op">=</span> <span class="st">"(LAB) Test Phase Accuracy ~ Condition"</span>,
        x <span class="op">=</span> <span class="st">"model predicted mean (% correct)"</span>, y <span class="op">=</span> <span class="st">"Condition"</span>, fill <span class="op">=</span> <span class="st">"Interval"</span>,
        subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"lm("</span>,<span class="va">call</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">")"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/PLOT-MODEL-COEFSS-GGDIST-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/PLOT-MODEL-PRED-SJPLOT_2a948a6523666b0f0737f005508f8f16">
<details><summary>CODE</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#sjPlot</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">lm.1</span>,  type <span class="op">=</span> <span class="st">"eff"</span>, 
           show.data <span class="op">=</span> <span class="cn">TRUE</span>, jitter <span class="op">=</span> <span class="cn">TRUE</span>,
           show.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 

<span class="co">#BS TO MANUALLY ADD REGRESSION FORMULA AS SUBTITLE </span>
<span class="co"># library(equatiomatic)</span>
<span class="co"># library(latex2exp)</span>
<span class="co"># (x &lt;- extract_eq(lm.1, use_coefs = TRUE, ital_vars=TRUE, coef_digits = 1, raw_tex = FALSE))</span>
<span class="co"># b = TeX(x)</span>
<span class="co"># p1[["condition"]][["labels"]][["subtitle"]]= expression( paste(widehat(accuracy), " = ", 1.7, " + ", "1.6", "*", condition[impasse]) )</span>
<span class="va">p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/PLOT-MODEL-PRED-SJPLOT-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="censored-tobit-regression" class="level3"><h3 class="anchored" data-anchor-id="censored-tobit-regression">Censored (Tobit) Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/tobit-models/" class="uri">https://stats.oarc.ucla.edu/r/dae/tobit-models/</a></p>
<p><strong>For censored data (i.e.&nbsp;truncated axis).</strong> The tobit model, also called a censored regression model, is designed to estimate linear relationships between variables when there is either left- or right-censoring in the dependent variable (also known as censoring from below and above, respectively). Censoring from above takes place when cases with a value at or above some threshold, all take on the value of that threshold, so that the true value might be equal to the threshold, but it might also be higher. In the case of censoring from below, values those that fall at or below some threshold are censored.</p>
<ul>
<li>censored vs truncated : There is sometimes confusion about the difference between truncated data and censored data.</li>
<li>With censored variables, all of the observations are in the dataset, but we don’t know the “true” values of some of them.</li>
<li>With truncation some of the observations are not included in the analysis because of the value of the variable.</li>
<li>When a variable is censored, regression models for truncated data provide inconsistent estimates of the parameters. See Long (1997, chapter 7) for a more detailed discussion of problems of using regression models for truncated data to analyze censored data.</li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-17_4e983efa4ddf0cca119ca8f6fa7c3d26">
<details><summary>CODE</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#set censoring values </span>
<span class="va">lo</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">hi</span> <span class="op">=</span> <span class="fl">8</span> 
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">test_score</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0 8</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Lo and Hi should equate to upper and lower bounds of the # Qs "</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Lo and Hi should equate to upper and lower bounds of the # Qs "</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/">VGAM</a></span><span class="op">)</span>

<span class="co">#FIT MODEL</span>
<span class="va">m1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html">vglm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html">tobit</a></span><span class="op">(</span>Lower <span class="op">=</span> <span class="va">lo</span>, Upper <span class="op">=</span><span class="va">hi</span> <span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
vglm(formula = test_score ~ condition, family = tobit(Lower = lo, 
    Upper = hi), data = df)

Coefficients: 
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1      -4.185      1.483   -2.82   0.0048 ** 
(Intercept):2       2.203      0.127   17.38   &lt;2e-16 ***
conditionimpasse    5.577      1.982    2.81   0.0049 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Names of linear predictors: mu, loglink(sd)

Log-likelihood: -196 on 249 degrees of freedom

Number of Fisher scoring iterations: 11 

No Hauck-Donner effect found in any of the estimates</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CONFIDENCE INTERVALS</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vcovvlm.html">vcov</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>LL <span class="op">=</span> <span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span>, UL <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                    LL    UL
(Intercept):1    -7.09 -1.28
(Intercept):2     1.95  2.45
conditionimpasse  1.69  9.46</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TEST FIT</span>
<span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html">vglm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html">tobit</a></span><span class="op">(</span>Lower <span class="op">=</span> <span class="va">lo</span>, Upper <span class="op">=</span> <span class="va">hi</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0134</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, <span class="va">p</span> <span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P value of likelihood ratio test less than alpha = 0.05?  TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name | Model |     AIC | AIC weights |     BIC | BIC weights |  RMSE | Sigma
----------------------------------------------------------------------------
m0   |  vglm | 404.682 |       0.035 | 410.355 |       0.131 | 7.529 | 7.560
m1   |  vglm | 398.060 |       0.965 | 406.569 |       0.869 | 7.101 | 7.144</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#DIAGNOSTICS</span>
<span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">yhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="op">{</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">rr</span>, main <span class="op">=</span> <span class="st">"Fitted vs Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">rr</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">rp</span>, main <span class="op">=</span> <span class="st">"Fitted vs Pearson Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">rp</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">test_score</span>, <span class="va">rp</span>, main <span class="op">=</span> <span class="st">"Actual vs Pearson Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">test_score</span>, <span class="va">yhat</span>, main <span class="op">=</span> <span class="st">"Actual vs Fitted"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-5.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#VARIANCE ACCOUNTED FOR</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"VARIANCE ACCOUNTED FOR"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "VARIANCE ACCOUNTED FOR"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># correlation</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">test_score</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.245</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># variance accounted for</span>
<span class="va">r</span><span class="op">^</span><span class="fl">2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0598</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |  RMSE | Sigma
---------------------------------
398.060 | 406.569 | 7.101 | 7.144</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#NOTE: censReg package also does Tobit regression [including mixed models]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>The coefficient labeled “(Intercept):1” is the intercept or constant for the model.</li>
<li>The coefficient labeled “(Intercept):2” is an ancillary statistic. If we exponentiate this value, we get a statistic that is analogous to the square root of the residual variance in OLS regression. logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</li>
<li>The predicted value of test_phase_score is 5.75 points <em>higher</em> for students in the impasse condition than for students in the control condition. (72% improvement in score!)</li>
</ul>
<p><strong>Using censReg package</strong> - https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf</p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-18_88c243a8b5cee19c5958b05739b0873e">
<details><summary>CODE</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sampleSelection.org">censReg</a></span><span class="op">)</span> <span class="co">#censored regression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'censReg' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maxLik</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: miscTools</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite the 'maxLik' package as:
Henningsen, Arne and Toomet, Ott (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics 26(3), 443-458. DOI 10.1007/s00180-010-0217-1.

If you have questions, suggestions, or comments regarding the 'maxLik' package, please use a forum or 'tracker' at maxLik's R-Forge site:
https://r-forge.r-project.org/projects/maxlik/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite the 'censReg' package as:
Henningsen, Arne (2017). censReg: Censored Regression (Tobit) Models. R package version 0.5. http://CRAN.R-Project.org/package=censReg.

If you have questions, suggestions, or comments regarding the 'censReg' package, please use a forum or 'tracker' at the R-Forge site of the 'sampleSelection' project:
https://r-forge.r-project.org/projects/sampleselection/</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT MODEL</span>
<span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/censReg/man/censReg.html">censReg</a></span><span class="op">(</span> <span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, left<span class="op">=</span><span class="va">lo</span>, right<span class="op">=</span><span class="va">hi</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = test_score ~ condition, left = lo, right = hi, 
    data = df)

Observations:
         Total  Left-censored     Uncensored Right-censored 
           126             71             37             18 

Coefficients:
                 Estimate Std. error t value Pr(&gt; t)    
(Intercept)       -4.1854     1.7149  -2.441 0.01466 *  
conditionimpasse   5.5775     1.9995   2.789 0.00528 ** 
logSigma           2.2033     0.1424  15.471 &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -196 on 3 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CONFIDENCE INTERVALS</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vcovvlm.html">vcov</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>LL <span class="op">=</span> <span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span>, UL <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                    LL     UL
(Intercept)      -7.55 -0.824
conditionimpasse  1.66  9.496
logSigma          1.92  2.482</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TEST FIT</span>
<span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span>

<span class="va">c0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/censReg/man/censReg.html">censReg</a></span><span class="op">(</span> <span class="va">test_score</span> <span class="op">~</span> <span class="fl">1</span>, left<span class="op">=</span><span class="va">lo</span>, right<span class="op">=</span><span class="va">hi</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">c0</span><span class="op">)</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 0.0134 (df=3)</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, <span class="va">p</span> <span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P value of likelihood ratio test less than alpha = 0.05?  TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in get_residuals.default(model, verbose = verbose, type = "response", :
Can't extract residuals from model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Response residuals not available to calculate mean square error. (R)MSE
  is probably not reliable.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC
-----------------
398.060 | 406.569</code></pre>
</div>
</div>
<ul>
<li>logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</li>
<li>output should match that of VGAM</li>
</ul></section></section><section id="count-outcome" class="level2"><h2 class="anchored" data-anchor-id="count-outcome">COUNT OUTCOME</h2>
<p><strong>Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?<br>
(# questions correct on test phase of task, [in lab] participants)</strong></p>
<p>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can try considering it a type of <em>count</em>, (i.e.&nbsp;count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function). Note that the process of answering questions on a test do not seem to strictly match the assumptions of a Poisson process.</p>
<div class="cell" data-hash="modelling_ref_cache/html/SETUP-COUNT-TESTSCORE_650bb4a4fb090a9fd8d4374b6dafc081">
<details><summary>CODE</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::SETUP DATA</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  condition min Q1 median Q3 max mean   sd  n missing
1   control   0  0      0  1   8 1.71 3.05 62       0
2   impasse   0  0      2  7   8 3.33 3.40 64       0</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>

<span class="co"># #GGFORMULA | FACETED HISTOGRAM</span>
<span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span>
<span class="co"># gf_props(~item_test_NABS, </span>
<span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span>
<span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span>
<span class="co">#   labs(x = "# Correct",</span>
<span class="co">#        y = "proportion of subjects",</span>
<span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span>
<span class="co">#        subtitle = "") + theme(legend.position = "blank")</span>

<span class="co">##GGPUBR | HIST+DENSITY SCORE </span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/gghistogram.html">gghistogram</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="st">"test_score"</span>, binwidth <span class="op">=</span> <span class="fl">0.5</span>,
   add <span class="op">=</span> <span class="st">"mean"</span>, rug <span class="op">=</span> <span class="cn">TRUE</span>,
   fill <span class="op">=</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span>
   add_density <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/facet.html">facet</a></span><span class="op">(</span><span class="va">p</span>, facet.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Distribution of TEST Absolute Score"</span>,
        subtitle <span class="op">=</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,
        x <span class="op">=</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, y <span class="op">=</span> <span class="st">"number of subjects"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-COUNT-TESTSCORE-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">##VERTICAL RAINCLOUD USING GGDISTR</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span>,
                        fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span>
    side <span class="op">=</span> <span class="st">"left"</span>,
    justification <span class="op">=</span> <span class="fl">1.1</span>,
    width <span class="op">=</span> <span class="fl">1</span>, 
    point_colour <span class="op">=</span> <span class="cn">NA</span>
   <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>
    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">.15</span>, 
    outlier.shape <span class="op">=</span> <span class="cn">NA</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">1.3</span>,
    alpha <span class="op">=</span> <span class="fl">.3</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span> 
      seed <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">.05</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> 
    title <span class="op">=</span> <span class="st">"Distribution of TEST Absolute Score "</span>,
    x <span class="op">=</span> <span class="st">"Condition"</span>, y <span class="op">=</span> <span class="st">"Total Absolute Score (Test Phase)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="cn">NA</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-COUNT-TESTSCORE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="poisson-regression" class="level3"><h3 class="anchored" data-anchor-id="poisson-regression">Poisson Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/poisson-regression/" class="uri">https://stats.oarc.ucla.edu/r/dae/poisson-regression/</a><br><em>General Linear model using the Poisson distribution</em></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-20_9e59e58f468628d11dcddc6631b6aca0">
<details><summary>CODE</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span>
<span class="va">p.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://jtools.jacob-long.com/reference/summ.html">summ</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 126 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> test_score </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> Generalized linear model </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Family </td>
   <td style="text-align:right;"> poisson </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Link </td>
   <td style="text-align:right;"> log </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> 𝛘²(1) </td>
   <td style="text-align:right;"> 33.28 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (Cragg-Uhler) </td>
   <td style="text-align:right;"> 0.23 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (McFadden) </td>
   <td style="text-align:right;"> 0.04 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> AIC </td>
   <td style="text-align:right;"> 764.95 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> BIC </td>
   <td style="text-align:right;"> 770.62 </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> z val. </th>
   <th style="text-align:right;"> p </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> 0.54 </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 5.52 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> conditionimpasse </td>
   <td style="text-align:right;"> 0.67 </td>
   <td style="text-align:right;"> 0.12 </td>
   <td style="text-align:right;"> 5.60 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: MLE</td></tr></tfoot>
</table>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Partition Variance"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: poisson, link: log

Response: test_score

Terms added sequentially (first to last)

          Df Deviance Resid. Df Resid. Dev
NULL                        125        604
condition  1     33.3       124        570</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Confidence Interval on Parameter Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/maxLik/man/confint.maxLik.html">confint</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
(Intercept)      0.340  0.721
conditionimpasse 0.436  0.902</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span> <span class="co">#sanity check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a poisson model (estimated using ML) to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is moderate (Nagelkerke's R2 = 0.23). The model's intercept, corresponding to condition = control, is at 0.54 (95% CI [0.34, 0.72], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically significant and positive (beta = 0.67, 95% CI [0.44, 0.90], p &lt; .001; Std. beta = 0.67, 95% CI [0.44, 0.90])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The variable condition has a coefficient of 0.67, (p &lt; 0.005). This means that for the impasse condition, the expected log count # of questions increases by 0.67. By exponentiating the estimate we see that # question correct rate for the impasse condition is 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.</em></p>
</section><section id="negative-binomial-regression" class="level3"><h3 class="anchored" data-anchor-id="negative-binomial-regression">Negative Binomial Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/" class="uri">https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/</a> -<em>overdispersed count data (variance much greater than mean)</em></p>
<ul>
<li>similar to Poisson regression, but using the negative binomial distribution, which can better account for ‘overdispersed’ data where variance is much greater than the mean</li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-21_748f4608a311dec6bdd27396a0f1b05e">
<details><summary>CODE</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>

<span class="co">#fit model </span>
<span class="va">nb.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>

<span class="co">#check overdispersion need </span>
<span class="co">#assumes conditional means are not equal to conditional variances</span>
<span class="co">#conduct likelihood ration test to compare and test [need poisson]</span>
<span class="va">m.t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co">#pchisq(2 * (logLik(nb.1) - logLik(m.t)), df = 1, lower.tail = FALSE)</span>
<span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m.t</span>, <span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name |  Model | df | df_diff |   Chi2 |      p
----------------------------------------------
m.t  |    glm |  2 |         |        |       
nb.1 | negbin |  3 |       1 | 277.71 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span>
<span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#exponentiate parameter estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Exponentiated Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Exponentiated Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 Estimate 2.5 % 97.5 %
(Intercept)          1.71  1.07   2.89
conditionimpasse     1.95  0.98   3.86</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = test_score ~ condition, data = df, init.theta = 0.2977734703, 
    link = log)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.220  -1.066  -1.066   0.447   1.067  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)         0.536      0.252    2.13    0.033 *
conditionimpasse    0.666      0.348    1.92    0.055 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(0.298) family taken to be 1)

    Null deviance: 114.32  on 125  degrees of freedom
Residual deviance: 110.70  on 124  degrees of freedom
AIC: 489.2

Number of Fisher Scoring iterations: 1

              Theta:  0.2978 
          Std. Err.:  0.0586 

 2 x log-likelihood:  -483.2380 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a negative-binomial model (estimated using ML) to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is weak (Nagelkerke's R2 = 0.05). The model's intercept, corresponding to condition = control, is at 0.54 (95% CI [0.07, 1.06], p = 0.033). Within this model:

  - The effect of condition [impasse] is statistically non-significant and positive (beta = 0.67, 95% CI [-0.02, 1.35], p = 0.055; Std. beta = 0.67, 95% CI [-0.02, 1.35])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The variable condition has a coefficient of 0.67, (p &lt; 0.005). This means that for the impasse condition, the expected log count # of questions increases by 0.67. By exponentiating the estimate we see that # question correct rate for the impasse condition is nearly 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.</em></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-22_b7f56246ee34cd8e6c2378e756cc0df2">
<details><summary>CODE</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#COMPARE POISSON AND NEGATIVE BINOMIAL</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">p.1</span>, <span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name |  Model |     AIC | AIC weights |     BIC | BIC weights | Nagelkerke's R2 |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------------------------------------------------
p.1  |    glm | 764.945 |     &lt; 0.001 | 770.618 |     &lt; 0.001 |           0.234 | 3.208 | 2.145 |    -3.020 |           0.069
nb.1 | negbin | 489.238 |        1.00 | 497.747 |        1.00 |           0.048 | 3.208 | 0.945 |    -2.213 |           0.074</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">p.1</span>, <span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name |  Model | df | df_diff |   Chi2 |      p
----------------------------------------------
p.1  |    glm |  2 |         |        |       
nb.1 | negbin |  3 |       1 | 277.71 | &lt; .001</code></pre>
</div>
</div>
<p><em>AIC, Pseudo-R2 and a likelihood ratio test indicate that the negative binomial regression model are a better fit for the distribution of test-phase scores.</em></p>
</section></section><section id="mixture-models" class="level2"><h2 class="anchored" data-anchor-id="mixture-models">MIXTURE MODELS</h2>
<section id="zero-inflated-poisson" class="level3"><h3 class="anchored" data-anchor-id="zero-inflated-poisson">Zero Inflated Poisson</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/zip/" class="uri">https://stats.oarc.ucla.edu/r/dae/zip/</a><br><em>A Poisson count process with excess zeros</em></p>
<ul>
<li>The Zero-Inflated model allows specification of two models (a mixture) where <em>some</em> of the zeros are included in the DGP for the Poisson model, while only the ‘excess’ zeros are included in the DGP for the Binomial model [the zero-inflated part]</li>
<li>The model includes:
<ul>
<li>A logistic model to model which of the two processes the zero outcome is associated with</li>
<li>A poisson model to model the count process</li>
</ul>
</li>
<li>Can specify different predictors for each part of the model</li>
<li>predictors after the | are for the binomial zero-inflated part of the model, while those infront are for the poisson process</li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-23_e6d43d2e5fef6d216a86d3338fa7a898">
<details><summary>CODE</summary><div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#ZERO INFLATED POISSON</span>

<span class="va">zinfp.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span>  <span class="va">condition</span><span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = test_score ~ condition | condition, data = df)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.988 -0.575 -0.575  1.090  2.117 

Count model coefficients (poisson with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7702     0.0979   18.07   &lt;2e-16 ***
conditionimpasse  -0.0231     0.1199   -0.19     0.85    

Zero-inflation model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)         0.890      0.280    3.18   0.0015 **
conditionimpasse   -1.213      0.378   -3.21   0.0013 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 7 
Log-likelihood: -213 on 4 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated poisson model to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is substantial (R2 = 0.39, adj. R2 = 0.38). The model's intercept, corresponding to condition = control, is at 1.77 (95% CI [1.58, 1.96], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically non-significant and negative (beta = -0.02, 95% CI [-0.26, 0.21], p = 0.847; Std. beta = -0.02, 95% CI [-0.26, 0.21])
  - The effect of condition [impasse] is statistically significant and negative (beta = -1.21, 95% CI [-1.95, -0.47], p = 0.001; Std. beta = -1.21, 95% CI [-1.95, -0.47])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------
434.837 | 446.183 | 0.391 |     0.381 | 3.208 | 3.260 |    -1.694 |           0.069</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#check_model(zinfp.1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>In the count model, the coefficient for the condition is not significant.</em></p>
<p><em>In the zero-inflation model, the coefficient for the condition variable is -1.23 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.23 if you are in the impasse condition</em></p>
</section><section id="zero-inflated-negative-binomial-regression" class="level3"><h3 class="anchored" data-anchor-id="zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/zinb/" class="uri">https://stats.oarc.ucla.edu/r/dae/zinb/</a><br><em>count data that are overdispersed and have excess zeros</em></p>
<p>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the <em>excess</em> zeros can be modelled independently.</p>
<p>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different ‘process’ … (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) &lt;- this could maybe be disentangled by first question latency?</p>
<p>The model includes:</p>
<ul>
<li>A logistic model to model which of the two processes the zero outcome is associated with</li>
<li>A negative binomial model to model the count process</li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/MODEL-TESTABS-ZINFNEGBINOM_5cad3d934be3d8fa20c6a9c1857f0904">
<details><summary>CODE</summary><div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#  for zeroinfl negbinomial</span>

<span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span>
<span class="va">zinb.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , 
                   data <span class="op">=</span> <span class="va">df</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span>
<span class="co">#before the | is the count part, after the | is the logit model</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = test_score ~ condition | condition, data = df, dist = "negbin")

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.970 -0.568 -0.568  1.070  2.091 

Count model coefficients (negbin with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7689     0.1048   16.88   &lt;2e-16 ***
conditionimpasse  -0.0232     0.1282   -0.18    0.856    
Log(theta)         3.7504     2.1488    1.75    0.081 .  

Zero-inflation model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)         0.888      0.280    3.17   0.0015 **
conditionimpasse   -1.214      0.379   -3.21   0.0013 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta = 42.54 
Number of iterations in BFGS optimization: 7 
Log-likelihood: -213 on 5 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated negative-binomial model to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is substantial (R2 = 0.40, adj. R2 = 0.39). The model's intercept, corresponding to condition = control, is at 1.77 (95% CI [1.56, 1.97], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically non-significant and negative (beta = -0.02, 95% CI [-0.27, 0.23], p = 0.856; Std. beta = -0.02, 95% CI [-0.27, 0.23])
  - The effect of condition [impasse] is statistically significant and negative (beta = -1.21, 95% CI [-1.96, -0.47], p = 0.001; Std. beta = -1.21, 95% CI [-1.96, -0.47])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------
436.585 | 450.766 | 0.398 |     0.388 | 3.208 | 3.274 |    -1.740 |           0.068</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#   rootogram(zinb.1)</span>



<span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span>
<span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span>
<span class="co"># #exponentiate parameter estimates</span>
<span class="co"># print("Exponentiated Estimates")</span>
<span class="co"># exp(est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).</em></p>
<p><em>In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition</em></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-25_b402605c1d0cf0ff793b99b77806d459">
<details><summary>CODE</summary><div class="sourceCode" id="cb157"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">zinfp.1</span>, <span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name    |    Model |     AIC | AIC weights |     BIC | BIC weights |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
------------------------------------------------------------------------------------------------------------------------------------
zinfp.1 | zeroinfl | 434.837 |       0.705 | 446.183 |       0.908 | 0.391 |     0.381 | 3.208 | 3.260 |    -1.694 |           0.069
zinb.1  | zeroinfl | 436.585 |       0.295 | 450.766 |       0.092 | 0.398 |     0.388 | 3.208 | 3.274 |    -1.740 |           0.068</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_likelihoodratio</a></span><span class="op">(</span><span class="va">zinfp.1</span>, <span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name    |    Model | df | df_diff | Chi2 |     p
------------------------------------------------
zinfp.1 | zeroinfl |  4 |         |      |      
zinb.1  | zeroinfl |  5 |       1 | 0.25 | 0.615</code></pre>
</div>
</div>
<p><strong>TODO come back to this and discuss further</strong><br></p>
</section><section id="hurdle-model" class="level3"><h3 class="anchored" data-anchor-id="hurdle-model">Hurdle Model</h3>
<ul>
<li><a href="https://data.library.virginia.edu/getting-started-with-hurdle-models/" class="uri">https://data.library.virginia.edu/getting-started-with-hurdle-models/</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values." class="uri">https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.</a></li>
</ul>
<p>class of models for count data with both overdispersion and excess zeros;<br>
different from zero-inflated models where the excess zeros are theorized to arise from two <em>different</em> processes; in the hurdle model, there is a separate model for P(x=0) and a separate model for P(x!=0)</p>
<p>The model includes:</p>
<ul>
<li><p>A binary logit model to model whether the observation takes a positive count or not. (1) Does the student get <em>any</em> questions right?</p></li>
<li><p>a truncated Poisson or Negative binomial model that only fits positive counts (2) How many questions does the student get right?</p></li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-26_50f1028b1c966b071bce5f125a4cf752">
<details><summary>CODE</summary><div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zero-inf and hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">countreg</span><span class="op">)</span> <span class="co">#rootogram</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'countreg':
  method                 from
  print.zeroinfl         pscl
  print.summary.zeroinfl pscl
  summary.zeroinfl       pscl
  coef.zeroinfl          pscl
  vcov.zeroinfl          pscl
  logLik.zeroinfl        pscl
  predict.zeroinfl       pscl
  residuals.zeroinfl     pscl
  fitted.zeroinfl        pscl
  terms.zeroinfl         pscl
  model.matrix.zeroinfl  pscl
  extractAIC.zeroinfl    pscl
  print.hurdle           pscl
  print.summary.hurdle   pscl
  summary.hurdle         pscl
  coef.hurdle            pscl
  vcov.hurdle            pscl
  logLik.hurdle          pscl
  predict.hurdle         pscl
  residuals.hurdle       pscl
  fitted.hurdle          pscl
  terms.hurdle           pscl
  model.matrix.hurdle    pscl
  extractAIC.hurdle      pscl</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'countreg'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    dzipois, pzipois, qzipois, rzipois</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:pscl':

    hurdle, hurdle.control, hurdletest, zeroinfl, zeroinfl.control</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    rootogram</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span>

<span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span>

<span class="va">h.1</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span>,
              zero.dist <span class="op">=</span> <span class="st">"binomial"</span>, dist <span class="op">=</span> <span class="st">"poisson"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = zeroDist, gr = zeroGrad, par = c(start$zero, if (zero.dist
== : unknown names in control: size</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">h.2</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span>,
              zero.dist <span class="op">=</span> <span class="st">"binomial"</span>, dist <span class="op">=</span> <span class="st">"negbin"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size

Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">h.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = test_score ~ condition | condition, data = df, 
    dist = "poisson", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.988 -0.575 -0.575  1.090  2.117 

Count model coefficients (truncated poisson with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7702     0.0979   18.07   &lt;2e-16 ***
conditionimpasse  -0.0231     0.1199   -0.19     0.85    
Zero hurdle model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)        -0.894      0.280   -3.19   0.0014 **
conditionimpasse    1.209      0.377    3.20   0.0014 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 10 
Log-likelihood: -213 on 4 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = test_score ~ condition | condition, data = df, 
    dist = "negbin", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.970 -0.568 -0.568  1.070  2.091 

Count model coefficients (truncated negbin with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7689     0.1048   16.88   &lt;2e-16 ***
conditionimpasse  -0.0232     0.1282   -0.18    0.856    
Log(theta)         3.7506     2.1492    1.75    0.081 .  
Zero hurdle model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)        -0.894      0.280   -3.19   0.0014 **
conditionimpasse    1.209      0.377    3.20   0.0014 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta: count = 42.546
Number of iterations in BFGS optimization: 19 
Log-likelihood: -213 on 5 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/countreg/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">h.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb178"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/countreg/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">h.1</span>,<span class="va">h.2</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">h.1</span>, <span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name |  Model | df | df_diff | Chi2 |     p
-------------------------------------------
h.1  | hurdle |  4 |         |      |      
h.2  | hurdle |  5 |       1 | 0.25 | 0.615</code></pre>
</div>
</div>
</section></section><section id="beta-regression" class="level2"><h2 class="anchored" data-anchor-id="beta-regression">BETA REGRESSION</h2>
<section id="beta-regression-1" class="level3"><h3 class="anchored" data-anchor-id="beta-regression-1">BETA Regression</h3>
<p>Beta regression on % correct (with standard transformation for including [0,1])</p>
<p><a href="https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression" class="uri">https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression</a></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-27_4251ec67095a8eb5b2d3e99fc60eba68">
<details><summary>CODE</summary><div class="sourceCode" id="cb183"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betareg</span><span class="op">)</span>

<span class="co">#RESCLAE VARIABLE</span>
<span class="co">#beta reg can't handle 0s and 1s </span>
<span class="va">sub</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">DV_percent_NABS</span><span class="op">)</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">sub</span><span class="op">$</span><span class="va">dv_transformed</span> <span class="op">=</span> <span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">DV_percent_NABS</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>
 
<span class="co">#VISUALIZE VARIABLES</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html">histogram</a></span><span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">dv_transformed</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">dv_transformed</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">sub</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT MODEL</span>
<span class="va">mb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">dv_transformed</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = dv_transformed ~ condition, data = sub)

Standardized weighted residuals 2:
   Min     1Q Median     3Q    Max 
-1.057 -0.453 -0.216  0.541  1.690 

Coefficients (mean model with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -0.969      0.108   -8.97   &lt;2e-16 ***
conditionimpasse    0.556      0.143    3.89   0.0001 ***

Phi coefficients (precision model with identity link):
      Estimate Std. Error z value Pr(&gt;|z|)    
(phi)   0.6604     0.0425    15.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood:  506 on 3 Df
Pseudo R-squared: 0.0725
Number of iterations: 12 (BFGS) + 1 (Fisher scoring) </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb187"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="beta-hurdle-regression" class="level3"><h3 class="anchored" data-anchor-id="beta-hurdle-regression">BETA HURDLE Regression</h3>
<p><a href="https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf" class="uri">https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf</a></p>
<ul>
<li>MU tells if mean is different by condition</li>
<li>SIGMA tells if variance is different by condition</li>
<li>NU coefficient tells if condition yields different probability at floor</li>
<li>TAU coefficient tells if condition yields different probability at ceiling</li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-28_454f1997230c6709c9547ba786bbe440">
<details><summary>CODE</summary><div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#BETA HURDLE REGRESSION EXAMPLE</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.gamlss.com/">gamlss</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gamlss' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    sleep</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.dist</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gamlss.dist' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'nlme' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ordinal':

    ranef, VarCorr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmList</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: parallel</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> **********   GAMLSS Version 5.4-3  ********** </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>For more on GAMLSS look at https://www.gamlss.com/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type gamlssNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    refit</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb207"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE SAMPLE DATA </span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span> 
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.40</span> 
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.60</span> 
<span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">0.13</span> 
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fl">0.17</span> 
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span> <span class="va">p0</span><span class="op">-</span> <span class="va">p1</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">sigma</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> 
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">/</span> <span class="va">mu</span>

<span class="co">#CREATE DIST</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1839</span><span class="op">)</span> 
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> 
<span class="va">cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">p0</span>, <span class="va">p2</span>, <span class="va">p1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="va">y</span><span class="op">[</span><span class="va">cat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> 
<span class="va">y</span><span class="op">[</span><span class="va">cat</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">x</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#this looks not unlike my distribution! </span>

<span class="co">#CREATE AN EMPTY MODEL</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for mu </span>
               formula.sigma <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for sigma </span>
               formula.nu <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for nu </span>
               formula.tau <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for tau </span>
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 7799 
GAMLSS-RS iteration 2: Global Deviance = 7778 
GAMLSS-RS iteration 3: Global Deviance = 7778 
GAMLSS-RS iteration 4: Global Deviance = 7778 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = y ~ 1, family = BEINF(), formula.sigma = ~1,  
    formula.nu = ~1, formula.tau = ~1) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.3796     0.0196   -19.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.3951     0.0162    24.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.632      0.042   -38.9   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -1.4014     0.0382   -36.7   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  5000 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  4996 
                      at cycle:  4 
 
Global Deviance:     7778 
            AIC:     7786 
            SBC:     7812 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.000571 
                       variance   =  1 
               coef. of skewness  =  0.0294 
               coef. of kurtosis  =  2.95 
Filliben correlation coefficient  =  1 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">fit_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">fit_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.406229902102452"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">fit_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.597499259410111"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb218"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="va">fit_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="va">fit_p0</span> <span class="op">&lt;-</span> <span class="va">fit_nu</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P0: "</span>,<span class="va">fit_p0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb220"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_p1</span> <span class="op">&lt;-</span> <span class="va">fit_tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P1: "</span>,<span class="va">fit_p1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
</div>
<p><strong>BETA HURDLE INTERPRETATION</strong> - beta component<br>
- MU “location” (mean)<br>
- SIGMA “scale” (positively related to variance; variance = sigma.squared <em>mean</em> (1-mean)<br>
- Rigby, Stasinopoulos, Heller, and De Bastiani (2017) “reparameterized” the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</p>
<p><strong>ZERO-ONE HURDLE COMPONENT</strong><br>
- The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.<br>
- p0 is the probability that a case equals 0,<br>
- p1 is the probability that a case equals 1,<br>
- p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-29_5edd4b013814c6db46e73a2455933114">
<details><summary>CODE</summary><div class="sourceCode" id="cb222"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MY DATA</span>
<span class="co">#SETUP DATA </span>

<span class="va">min</span> <span class="op">=</span> <span class="fl">0</span> <span class="co">#min possible value of scale</span>
<span class="va">max</span> <span class="op">=</span> <span class="fl">13</span> <span class="co">#max possible value of scale</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span> <span class="co">#for shuffling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    cross</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    chisq, logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lmerTest':

    rand</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    factorize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelr':

    resample</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    mplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    rescale</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:cowplot':

    theme_map</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb238"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#1. Rescale accuracy using </span>
<span class="co"># recommended adjustment </span>
<span class="co">#rescaled = value-min/(max-min)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="va">s_NABS</span>,
  R_acc <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span><span class="op">-</span><span class="va">min</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">max</span><span class="op">-</span><span class="va">min</span><span class="op">)</span>, <span class="co">#as %</span>
  T_acc <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="va">max</span>, <span class="co">#transform for no 0 and 1</span>
  perm <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/resample.html">shuffle</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>,
  scaffold_rt <span class="op">=</span> <span class="va">item_scaffold_rt</span>
<span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accuracy</span>,<span class="va">R_acc</span>, <span class="va">T_acc</span>, <span class="va">condition</span>, <span class="va">perm</span>,<span class="va">scaffold_rt</span><span class="op">)</span>

<span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">R_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb239"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">T_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of [rescaled] accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb240"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">R_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">perm</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">perm</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of shuffled accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb241"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SUMMARIZE SAMPLE</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Grand mean"</span>, <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand mean 0.288344988344988"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb243"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span>
<span class="va">stats</span> <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">var</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Grand stats"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand stats"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb245"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">stats</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  df$condition min Q1 median    Q3 max  mean    sd   n missing   var
1      control   0  0  0.000 0.154   1 0.190 0.343 158       0 0.118
2      impasse   0  0  0.154 0.788   1 0.379 0.395 172       0 0.156</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb247"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"P0"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb249"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.458</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb251"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"P1"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb253"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0939</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb255"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE MODEL</span>

<span class="co">#CREATE AN EMPTY MODEL</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">R_acc</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for mu </span>
              formula.sigma <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for sigma </span>
              formula.nu <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for nu </span>
              formula.tau <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for tau </span>
              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 611 
GAMLSS-RS iteration 2: Global Deviance = 610 
GAMLSS-RS iteration 3: Global Deviance = 610 
GAMLSS-RS iteration 4: Global Deviance = 610 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb257"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 611 
GAMLSS-RS iteration 2: Global Deviance = 610 
GAMLSS-RS iteration 3: Global Deviance = 610 
GAMLSS-RS iteration 4: Global Deviance = 610 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb259"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"THE EMPTY MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "THE EMPTY MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb261"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ 1, sigma.formula = ~1, nu.formula = ~1,  
    tau.formula = ~1, family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  -0.2304     0.0947   -2.43    0.015 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.4262     0.0775     5.5  7.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.0201     0.1157    0.17     0.86

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.563      0.198   -7.91  3.9e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  326 
                      at cycle:  4 
 
Global Deviance:     610 
            AIC:     618 
            SBC:     634 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb263"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.0111 
                       variance   =  0.973 
               coef. of skewness  =  0.0732 
               coef. of kurtosis  =  2.69 
Filliben correlation coefficient  =  0.996 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb265"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">m0_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">m0_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.442655135079248"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb267"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">m0_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.604970105601303"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb269"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"NU: "</span>,<span class="va">m0_nu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  1.02032203257766"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb271"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU: "</span>,<span class="va">m0_tau</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.209464832192797"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb273"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_p0</span> <span class="op">&lt;-</span> <span class="va">fit_nu</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P0: "</span>,<span class="va">m0_p0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb275"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_p1</span> <span class="op">&lt;-</span> <span class="va">fit_tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P1: "</span>,<span class="va">m0_p1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb277"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE PREDICTOR MODEL</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 573 
GAMLSS-RS iteration 2: Global Deviance = 572 
GAMLSS-RS iteration 3: Global Deviance = 572 
GAMLSS-RS iteration 4: Global Deviance = 572 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb279"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"THE PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "THE PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb281"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.421      0.171   -2.46    0.014 *
conditionimpasse    0.274      0.205    1.33    0.183  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)        0.3949     0.1407    2.81   0.0053 **
conditionimpasse   0.0309     0.1687    0.18   0.8549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         0.767      0.178    4.30  2.3e-05 ***
conditionimpasse   -1.440      0.247   -5.84  1.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -1.264      0.314   -4.02 0.000072 ***
conditionimpasse   -0.471      0.405   -1.16     0.25    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  4 
 
Global Deviance:     572 
            AIC:     588 
            SBC:     618 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb283"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#LOOKING PREDICTOR MODEL</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 573 
GAMLSS-RS iteration 2: Global Deviance = 572 
GAMLSS-RS iteration 3: Global Deviance = 572 
GAMLSS-RS iteration 4: Global Deviance = 572 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb285"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"THE PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "THE PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb287"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.421      0.171   -2.46    0.014 *
conditionimpasse    0.274      0.205    1.33    0.183  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)        0.3949     0.1407    2.81   0.0053 **
conditionimpasse   0.0309     0.1687    0.18   0.8549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         0.767      0.178    4.30  2.3e-05 ***
conditionimpasse   -1.440      0.247   -5.84  1.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -1.264      0.314   -4.02 0.000072 ***
conditionimpasse   -0.471      0.405   -1.16     0.25    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  4 
 
Global Deviance:     572 
            AIC:     588 
            SBC:     618 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb289"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION TEST]</span>
<span class="va">mperm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 611 
GAMLSS-RS iteration 2: Global Deviance = 610 
GAMLSS-RS iteration 3: Global Deviance = 610 
GAMLSS-RS iteration 4: Global Deviance = 610 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb291"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mperm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ perm, sigma.formula = ~perm,  
    nu.formula = ~perm, tau.formula = ~perm, family = BEINF(),      data = df) 


Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -0.2029     0.1397   -1.45     0.15
permimpasse  -0.0524     0.1899   -0.28     0.78

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.4570     0.1134    4.03    7e-05 ***
permimpasse  -0.0594     0.1553   -0.38      0.7    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.0564     0.1679    0.34     0.74
permimpasse  -0.0691     0.2317   -0.30     0.77

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.461      0.277   -5.27  2.5e-07 ***
permimpasse   -0.200      0.395   -0.51     0.61    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  4 
 
Global Deviance:     610 
            AIC:     626 
            SBC:     656 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb293"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#sanity check with scaled outcome, no zeros ones</span>
<span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">T_acc</span> <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = -1207 
GAMLSS-RS iteration 2: Global Deviance = -1335 
GAMLSS-RS iteration 3: Global Deviance = -1345 
GAMLSS-RS iteration 4: Global Deviance = -1346 
GAMLSS-RS iteration 5: Global Deviance = -1346 
GAMLSS-RS iteration 6: Global Deviance = -1346 
GAMLSS-RS iteration 7: Global Deviance = -1346 
GAMLSS-RS iteration 8: Global Deviance = -1346 
GAMLSS-RS iteration 9: Global Deviance = -1346 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb295"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.gamlss(m3): summary: vcov has failed, option qr is used instead</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = T_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition, family = BEINF(),  
    data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       -1.1773     0.0971  -12.13  &lt; 2e-16 ***
conditionimpasse   0.5857     0.1387    4.22 0.000031 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        1.2553     0.0740   16.97   &lt;2e-16 ***
conditionimpasse  -0.0122     0.1030   -0.12     0.91    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)      -2.25e+01   3.78e+03   -0.01        1
conditionimpasse -6.72e-15   5.24e+03    0.00        1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)      -2.26e+01   3.96e+03   -0.01        1
conditionimpasse  9.20e-15   5.48e+03    0.00        1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  9 
 
Global Deviance:     -1346 
            AIC:     -1330 
            SBC:     -1300 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb298"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span>

<span class="co">#investigate beta negative binomial distribution</span>
<span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span>

<span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">m1_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">m1_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.396369901111619" "MU:  0.568036956954873"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb300"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">m1_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.604970105601303"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb302"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"NU: "</span>,<span class="va">m1_nu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  2.15227350452983"  "NU:  0.236870904856183"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb304"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU: "</span>,<span class="va">m1_tau</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.282617628302748" "TAU:  0.624417570712948"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb306"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.421      0.171   -2.46    0.014 *
conditionimpasse    0.274      0.205    1.33    0.183  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)        0.3949     0.1407    2.81   0.0053 **
conditionimpasse   0.0309     0.1687    0.18   0.8549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         0.767      0.178    4.30  2.3e-05 ***
conditionimpasse   -1.440      0.247   -5.84  1.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -1.264      0.314   -4.02 0.000072 ***
conditionimpasse   -0.471      0.405   -1.16     0.25    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  4 
 
Global Deviance:     572 
            AIC:     588 
            SBC:     618 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb308"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  -0.0141 
                       variance   =  1.03 
               coef. of skewness  =  0.0142 
               coef. of kurtosis  =  3.05 
Filliben correlation coefficient  =  0.998 
******************************************************************</code></pre>
</div>
</div>
<ul>
<li>MU tells if mean is different by condition</li>
<li>SIGMA tells if variance is different by condition</li>
<li>NU coefficient tells if condition yields different probability at floor</li>
<li>TAU coefficient tells if condition yields different probability at ceiling</li>
</ul></section></section><section id="binomial-outcome" class="level2"><h2 class="anchored" data-anchor-id="binomial-outcome">BINOMIAL OUTCOME</h2>
<div class="cell" data-hash="modelling_ref_cache/html/SETUP-Q1-ACCURACY_45ac9847251a41c4162e85d17c56cb36">
<details><summary>CODE</summary><div class="sourceCode" id="cb310"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PREPARE DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span>
<span class="co"># %&gt;% mutate(</span>
<span class="co">#   accuracy = recode_factor(score_niceABS, "0" ="incorrect","1"="correct"),</span>
<span class="co">#   scaled = as.ordered(score_SCALED),</span>
<span class="co">#   q = as.factor(q),</span>
<span class="co">#   high_interpretation = as.factor(high_interpretation)</span>
<span class="co"># )</span>

<span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">accuracy</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, x <span class="op">=</span><span class="op">~</span><span class="va">pretty_condition</span>,
       position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Question 1 Accuracy"</span>,
       title <span class="op">=</span> <span class="st">"Accuracy on Q1"</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-Q1-ACCURACY-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb311"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on Test Phase"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-Q1-ACCURACY-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="chi-square" class="level3"><h3 class="anchored" data-anchor-id="chi-square">CHI SQUARE</h3>
<p><strong>Does CONDITION affect Q1 ACCURACY?</strong></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-31_a34850f5aff4ef03d9dcf7db07ae9584">
<details><summary>CODE</summary><div class="sourceCode" id="cb312"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">accuracy</span>, 
             fisher <span class="op">=</span> <span class="cn">TRUE</span>, chisq<span class="op">=</span><span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span>, sresid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  126 

 
             | df$accuracy 
df$condition |         0 |         1 | Row Total | 
-------------|-----------|-----------|-----------|
     control |        52 |        10 |        62 | 
             |    47.730 |    14.270 |           | 
             |     0.382 |     1.278 |           | 
             |     0.839 |     0.161 |     0.492 | 
             |     0.536 |     0.345 |           | 
             |     0.413 |     0.079 |           | 
-------------|-----------|-----------|-----------|
     impasse |        45 |        19 |        64 | 
             |    49.270 |    14.730 |           | 
             |     0.370 |     1.238 |           | 
             |     0.703 |     0.297 |     0.508 | 
             |     0.464 |     0.655 |           | 
             |     0.357 |     0.151 |           | 
-------------|-----------|-----------|-----------|
Column Total |        97 |        29 |       126 | 
             |     0.770 |     0.230 |           | 
-------------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  3.27     d.f. =  1     p =  0.0707 

Pearson's Chi-squared test with Yates' continuity correction 
------------------------------------------------------------
Chi^2 =  2.55     d.f. =  1     p =  0.111 

 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Sample estimate odds ratio:  2.18 

Alternative hypothesis: true odds ratio is not equal to 1
p =  0.0909 
95% confidence interval:  0.86 5.84 

Alternative hypothesis: true odds ratio is less than 1
p =  0.979 
95% confidence interval:  0 5.03 

Alternative hypothesis: true odds ratio is greater than 1
p =  0.0547 
95% confidence interval:  0.982 Inf 


 </code></pre>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/label - VIS-CHISQR-Q1_f4259dafe1788a022c118fae153c580f">
<details><summary>CODE</summary><div class="sourceCode" id="cb314"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Accuracy on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">accuracy</span>, 
            shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20VIS-CHISQR-Q1-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb315"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJTABLE</span>
<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">0</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">52</span><br><span style="color:#339999;">48</span><br><span style="color:#333399;">53.6&nbsp;%</span><br><span style="color:#339933;">83.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">45</span><br><span style="color:#339999;">49</span><br><span style="color:#333399;">46.4&nbsp;%</span><br><span style="color:#339933;">70.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">97</span><br><span style="color:#339999;">97</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">77&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">1</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">10</span><br><span style="color:#339999;">14</span><br><span style="color:#333399;">34.5&nbsp;%</span><br><span style="color:#339933;">16.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">19</span><br><span style="color:#339999;">15</span><br><span style="color:#333399;">65.5&nbsp;%</span><br><span style="color:#339933;">29.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">29</span><br><span style="color:#339999;">29</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">23&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">62</span><br><span style="color:#339999;">62</span><br><span style="color:#333399;">49.2&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">64</span><br><span style="color:#339999;">64</span><br><span style="color:#333399;">50.8&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">126</span><br><span style="color:#339999;">126</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=2.547 · df=1 · Cramer's V=0.161 · Fisher's p=0.091</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within accuracy</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb316"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::WITH STATISTICS</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbarstats.html">ggbarstats</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">accuracy</span>,
           type <span class="op">=</span> <span class="st">"nonparametric"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20VIS-CHISQR-Q1-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>For (In Person) data collection</strong> (n=126) the Pearson’s Chi-squared test (of independence) indicates a relationship between response accuracy on the first question and experimental condition that is not significant at the alpha level 0.05, <span class="math inline">\(\chi^2\)</span> (1) = 10.3, p = 0.07. Thus we have insufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. In this particular data sample, the odds ratio (Odds Ratio = 2.18, p = 0.055, 95% CI [0.982, +Inf]) indicates that the odds of producing a correct response on the first question were 2.18 times greater if a subject was in the impasse condition, than in the control condition .</p>
</section><section id="logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="logistic-regression">LOGISTIC REGRESSION</h3>
<p><em>Fit a logistic regression (at the subject-item level), predicting Q1 accuracy (absolute score) by condition.</em><br><em>note: this example uses the combined dataset rather than lab-only, as learning notes were done with the combined and I don’t want to recalcualte all the marginal probabilities by hand for learning purposes.</em></p>
<section id="fit-model" class="level4"><h4 class="anchored" data-anchor-id="fit-model">Fit Model</h4>
<p><em>First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.</em></p>
<div class="cell" data-hash="modelling_ref_cache/html/FIT-Q1ACC-LOG-combined_5939f3bb23ae53ba23996f29f5f2d4e0">
<details><summary>CODE</summary><div class="sourceCode" id="cb317"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#combined dataset, not lab only</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># FREQUENCY TABLE</span>
<span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span>
<span class="co"># addmargins(my.table) #counts</span>
<span class="co"># addmargins(prop.table(my.table)) #props</span>

<span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span>

<span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span>
<span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"EMPTY MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "EMPTY MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb319"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ 1, family = "binomial", data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.696  -0.696  -0.696  -0.696   1.753  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -1.294      0.134   -9.66   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 343.66  on 329  degrees of freedom
AIC: 345.7

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb321"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: 2 CONDITION model</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb323"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.819  -0.819  -0.548  -0.548   1.986  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.822      0.230   -7.93  2.2e-15 ***
pretty_conditionimpasse    0.901      0.285    3.16   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 333.07  on 328  degrees of freedom
AIC: 337.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb325"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: 3 TEST SUPERIOR FIT</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC wth predictor is lower than empty model?"</span>, <span class="va">m0</span><span class="op">$</span><span class="va">aic</span> <span class="op">&gt;</span> <span class="va">m1</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb327"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name | Model | df | df_diff |  Chi2 |     p
-------------------------------------------
m0   |   glm |  1 |         |       |      
m1   |   glm |  2 |       1 | 10.59 | 0.001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb329"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.00113745235691825"</code></pre>
</div>
</div>
<p><em>The Condition predictor significantly improves model fit.</em></p>
</section><section id="learning-notes" class="level4"><h4 class="anchored" data-anchor-id="learning-notes">Learning Notes</h4>
<div class="cell" data-hash="modelling_ref_cache/html/MODEL-Q1ACC-LOG-combined_597f8d6d5f485df3d129e2a4a5444a6c">
<details><summary>CODE</summary><div class="sourceCode" id="cb331"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb333"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.819  -0.819  -0.548  -0.548   1.986  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.822      0.230   -7.93  2.2e-15 ***
pretty_conditionimpasse    0.901      0.285    3.16   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 333.07  on 328  degrees of freedom
AIC: 337.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb335"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: INTERPRET COEFFICIENTS</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- LOG ODDS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- LOG ODDS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb337"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                         2.5 % 97.5 %
(Intercept)             -2.299  -1.39
pretty_conditionimpasse  0.353   1.48</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb340"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb342"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#exponentiate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb344"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                              2.5 % 97.5 %
(Intercept)             0.162  0.10  0.248
pretty_conditionimpasse 2.463  1.42  4.374</code></pre>
</div>
</div>
<p><strong>Understanding the logistic regression model</strong></p>
<p><em>The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable</em></p>
<p><em>The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.</em></p>
<p><strong>[the empty model</strong></p>
<ul>
<li>The intercept of an empty model (glm(accuracy ~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df$accuracy ==1 ).</li>
<li>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -&gt; log(0.215 / (1-0.215)) = -1.29.</li>
<li>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</li>
<li>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</li>
</ul>
<p><strong>[a dichotomous predictor]</strong></p>
<p>natural log (odds of +) = -1.822 + 0.901(x1) ; x1 = 0 for control, 1 for impasse</p>
<ul>
<li>INTERCEPT: log odds of (+ response) in control condition
<ul>
<li>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</li>
<li>convert to odds by exponentiating the coefficients<br>
log odds of (+) in control = exp(-1.822) = 0.162 odds</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139<br>
probability of (+) in control = ~14%</li>
</ul>
</li>
<li>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs.&nbsp;control
<ul>
<li>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</li>
<li>convert to odds by exponentiating log odds<br>
log odds (+) in impasse = exp(-0.921) = 0.398</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285<br>
probaility of (+) in impasse = ~ 29%</li>
</ul>
</li>
<li>ODDS RATIO : exponentiated B1 COEFFICIENT
<ul>
<li><p>B1 = (slope of logit model = difference in log odds = log odds ratio</p></li>
<li><p>B1 = 0.901 is log odds ratio of (+) in impasse vs control</p></li>
<li><p>exp(b1) = exp(0.901) = 2.46</p></li>
<li><p>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</p></li>
</ul>
</li>
</ul>
<table class="table">
<colgroup><col style="width: 100%"></colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">MARGINAL<br>
total = 330 success : 71, failure : 259<br>
p(+) = 71 / 330 = 0.215 = 22%<br>
odds(+) = 71 / 259 = 0.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">CONTROL total = 158 success = 22; failure = 136<br>
p(+) = 22/158 = 0.139 = 14%<br>
odds(+) = 22/136 = 0.162</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMPASSE total = 172 success = 49; failure = 123<br>
p(+) = 49/172 = 0.285 = 29%<br>
odds(+) = 49/123 = 0.398</td>
</tr>
</tbody>
</table></section><section id="visualize" class="level4"><h4 class="anchored" data-anchor-id="visualize">Visualize</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-35_c838cb275e8c754268e7998f4724bf76">
<details><summary>CODE</summary><div class="sourceCode" id="cb346"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb348"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log | Score_spherical |   PCP
----------------------------------------------------------------------------------------------
337.074 | 344.673 |     0.031 | 0.404 | 1.008 |    0.505 |   -16.847 |           0.021 | 0.673</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb350"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb352"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model's explanatory power is weak (Tjur's R2 = 0.03). The model's intercept, corresponding to pretty_condition = control, is at -1.82 (95% CI [-2.30, -1.39], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.90, 95% CI [0.35, 1.48], p = 0.002; Std. beta = 0.90, 95% CI [0.35, 1.48])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb355"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PREDICTIONS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PREDICTIONS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb357"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Retrieve predictions as probabilities </span>
<span class="co"># (for each level of the predictor)</span>
<span class="va">p.control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m1</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pretty_condition<span class="op">=</span><span class="st">"control"</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Probability of success in control,"</span>, <span class="va">p.control</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in control, 0.139240506329147"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb359"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p.impasse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m1</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pretty_condition<span class="op">=</span><span class="st">"impasse"</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Probability of success in impasse,"</span>, <span class="va">p.impasse</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in impasse, 0.284883720930631"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb361"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PLOT</span>

<span class="co">#GGSTATS | MODEL | LOG ODDS </span>
<span class="co"># library(ggstatsplot)</span>
<span class="co"># ggcoefstats(m1, output = "plot") + labs(x = "Log Odds Estimate")</span>

<span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m1</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb362"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="co"># plot_model(m1, type="pred",</span>
<span class="co">#            show.intercept = TRUE, </span>
<span class="co">#            show.values = TRUE,</span>
<span class="co">#            title = "Model Predicted Probability of Accuracy",</span>
<span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span>

<span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span>
<span class="co"># library(ggeffects)</span>
<span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggeffect</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">m1</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb364"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SANITY CHECK SJPLOT</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics" class="level4"><h4 class="anchored" data-anchor-id="diagnostics">Diagnostics</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-36_e717beb22247129de7c036dac4de16b2">
<details><summary>CODE</summary><div class="sourceCode" id="cb365"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb366"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Ok: About 100% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb368"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># logitgof(df$accuracy, m1$fitted.values, ord=FALSE)</span>
<span class="co"># hoslem.test(x = df$accuracy, y = fitted(m1), g =  2)</span>
<span class="co"># p should be non significant</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="inference" class="level4"><h4 class="anchored" data-anchor-id="inference">Inference</h4>
<p>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the <em>impasse condition</em> increase by 146% (<span class="math inline">\(e^{beta_1}\)</span> = 2.46, 95% CI [1.42, 4.37]) over the <em>control condition</em>.</p>
<p><em>Equivalent statements:</em></p>
<ul>
<li>being in impasse condition increases log odds of correct response by 0.901 (over control)</li>
<li>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</li>
<li>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</li>
</ul>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-37_aa4a015199fe571bdde28afd7251d77d">
<details><summary>CODE</summary><div class="sourceCode" id="cb369"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PRETTY TABLE SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.10&nbsp;–&nbsp;0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.42&nbsp;–&nbsp;4.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.002</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">330</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.031</td>
</tr>
</tbody></table>
</div>
</div>
</section></section></section><section id="ordinal-outcome" class="level2"><h2 class="anchored" data-anchor-id="ordinal-outcome">ORDINAL OUTCOME</h2>
<p><strong>Does CONDITION affect the Q1 [ordered] type of response given?</strong></p>
<div class="cell" data-hash="modelling_ref_cache/html/label - SETUP-INDEPENDENT-ORDINAL_bcd852336a04d35413d89fa16bd154db">
<details><summary>CODE</summary><div class="sourceCode" id="cb370"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> 
<span class="co">#scaled has already been set as an ordered factor of score_SCALED</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">scaled</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth      0.39683 0.15873
  unknown   0.00794 0.00000
  uncertain 0.00000 0.14286
  lines     0.00794 0.05556
  tri       0.07937 0.15079</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb372"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">scaled</span>, fill<span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb373"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,
                       fill <span class="op">=</span> <span class="va">scaled</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Q1 Interpretation"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Does CONDITION affect the Q1 [ordered] state of understanding?</strong></p>
<div class="cell" data-hash="modelling_ref_cache/html/label - SETUP-INDEPENDENT-ORDINAL-STATE_c2e696091b93525a51a82206162efbe9">
<details><summary>CODE</summary><div class="sourceCode" id="cb374"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> 
<span class="co">#scaled has already been set as an ordered factor of score_SCALED</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth-like 0.39683 0.15873
  unknown   0.00794 0.14286
  tri-like  0.08730 0.20635</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb376"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">state</span>, fill<span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb377"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,
                       fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Q1 State"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-STATE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="ordinal-regression-cumulative-link-proportional-odds" class="level3"><h3 class="anchored" data-anchor-id="ordinal-regression-cumulative-link-proportional-odds">ORDINAL REGRESSION — Cumulative Link; Proportional Odds</h3>
<p><em>Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.</em></p>
<ul>
<li><a href="https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/" class="uri">https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</a></li>
<li><a href="https://journals.sagepub.com/doi/full/10.1177/2515245918823199" class="uri">https://journals.sagepub.com/doi/full/10.1177/2515245918823199</a></li>
<li>todo see ordinal regression video: <a href="https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK" class="uri">https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK</a>
</li>
<li><a href="https://peopleanalytics-regression-book.org/ord-reg.html" class="uri">https://peopleanalytics-regression-book.org/ord-reg.html</a></li>
<li><a href="https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2" class="uri">https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2</a></li>
<li><a href="https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf" class="uri">https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf</a></li>
</ul>
<p><strong>Learning Notes</strong></p>
<ul>
<li>proportional odds regression models effectively act as a series of stratified binomial models under the assumption that the ‘slope’ of the logistic function of each stratified model is the same.</li>
<li>thus need to verify proportional odds assumption - ordinal regression requires an <strong>proportional odds assumption</strong> (the same slope holds for each equation)</li>
<li>this is required because the model simultaneously estimates k-1 equations, but each equation has the same <em>slope</em>, with different intercepts.</li>
<li>conversely, a multinomial (categorical) model will have different slopes as well as intercepts - the intercepts are always ordered in size alpha 1 &lt; alpha 2 &lt; alpha k-1…</li>
<li>
<strong>TODO</strong> - see difference between the three types of ordinal models (adjacent category (vs) cumulative proportions; check Agresti book</li>
</ul>
<section id="fit-model-1" class="level4"><h4 class="anchored" data-anchor-id="fit-model-1">Fit Model</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-40_e313bea26551ad31adf0874cecae86ff">
<details><summary>CODE</summary><div class="sourceCode" id="cb378"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::ORDINAL REGRESSION MODELS</span>

<span class="co">#EMPTY MODEL</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb380"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">om.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ordinal/man/clm.html">clm</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="fl">1</span> , data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co"># summary(om.0)</span>

<span class="co">#PREDICTOR MODEL</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Ordinal regression of q1 SCALED score (ordered interpretation)"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordinal regression of q1 SCALED score (ordered interpretation)"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb382"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">om</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ordinal/man/clm.html">clm</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co"># summary(om)</span>

<span class="co">#COMPARE EMPTY AND PREDICTOR</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">om.0</span>, <span class="va">om</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name | Model | df | df_diff |  Chi2 |      p
--------------------------------------------
om.0 |   clm |  2 |         |       |       
om   |   clm |  3 |       1 | 25.77 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb384"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::: EQUIVALENT APPROACH USING POLYR </span>

<span class="co"># #MODEL</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/polr.html">polr</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span>, Hess<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># summary(m)</span>

<span class="co">#exponentiate coefficients and CIs</span>
<span class="co"># (ctable &lt;- coef(summary(m)))</span>
<span class="co"># (p &lt;- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2)</span>
<span class="co"># (ctable &lt;- cbind(ctable, "p value" = p))</span>
<span class="co"># (ci &lt;- confint(m))</span>
<span class="co"># (e &lt;- coef(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Likelihood ratio test suggests the predictor model is a better fit than the empty (intercept only) model.</em></p>
</section><section id="inference-1" class="level4"><h4 class="anchored" data-anchor-id="inference-1">Inference</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-41_7acd4b47b3a988f353e19d71c63b440a">
<details><summary>CODE</summary><div class="sourceCode" id="cb385"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SUMMARY"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SUMMARY"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb387"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>formula: state ~ condition
data:    df

 link  threshold nobs logLik  AIC    niter max.grad cond.H 
 logit flexible  126  -109.55 225.09 6(0)  2.18e-10 2.5e+01

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
conditionimpasse      1.9        0.4    4.74  2.1e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Threshold coefficients:
                  Estimate Std. Error z value
orth-like|unknown    1.326      0.323    4.10
unknown|tri-like     2.109      0.355    5.94</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb389"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#LOG ODDS</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"IN LOG ODDS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "IN LOG ODDS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb391"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">ctable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                  Estimate Std. Error z value Pr(&gt;|z|)
orth-like|unknown     1.33      0.323    4.10 4.07e-05
unknown|tri-like      2.11      0.355    5.94 2.80e-09
conditionimpasse      1.90      0.400    4.74 2.10e-06</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb393"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/confint.html">confint</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
conditionimpasse  1.14   2.72</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb395"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"IN ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "IN ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb397"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#ODDS RATIOS</span>
<span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>orth-like|unknown  unknown|tri-like  conditionimpasse 
             3.77              8.24              6.68 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb399"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">ci</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
conditionimpasse  3.12   15.1</code></pre>
</div>
</div>
<p><strong>Overall, participants in the impasse condition had higher odds (6.68 X as likely) to offer <em>more correct</em> interpretations than those in the control condition (z = 4.74, p &lt; 0.001).</strong></p>
<ul>
<li>we see the estimates for the 2 intercepts, which are sometimes called cutpoints.</li>
<li>The intercepts indicate where the latent variable is cut to make the three groups that we observe in our data.</li>
<li>Note that this latent variable is continuous. In general, these are not used in the interpretation of the results.</li>
<li>The cutpoints are closely related to thresholds, which are reported by other statistical packages.</li>
<li>for k groups there will be k-1 intercepts (cutpoints)</li>
<li>confirm that the CI does not include 0 (the units are ordered logits [ordered log odds])</li>
<li>as with logistic regression we exponentiate the coefficients and confints to get odds ratio</li>
</ul></section><section id="visualize-model" class="level4"><h4 class="anchored" data-anchor-id="visualize-model">Visualize Model</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-42_c4b07734972e163dcdf6e0ec7bd0806c">
<details><summary>CODE</summary><div class="sourceCode" id="cb401"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># sjPlot::tab_model(om)</span>
<span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb402"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">om</span>, type <span class="op">=</span> <span class="st">"eff"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb404"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R">                   <span class="co"># show.data = TRUE, jitter = TRUE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics-1" class="level4"><h4 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-43_32dda8b05afaf474d34e98954dac5972">
<details><summary>CODE</summary><div class="sourceCode" id="cb405"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#:: ASSESS FIT</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Nagelkerke's R2 |  RMSE | Sigma
---------------------------------------------------
225.090 | 233.599 |           0.216 | 1.629 | 1.648</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb408"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># #test proporitional odds assumption </span>
<span class="fu"><a href="https://rdrr.io/pkg/brant/man/brant.html">brant</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="co">#only works for polyr type model not clm type model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Test for        X2  df  probability 
---------------------------------------------------- 
Omnibus         15.6    1   0
conditionimpasse    15.6    1   0
---------------------------------------------------- 

H0: Parallel Regression Assumption holds</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb410"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># # A p-value of less than 0.05 on this test—particularly on the Omnibus plus at least one of the variables—should be interpreted as a failure of the proportional odds assumption.</span>

<span class="co">#test proportional odds assumption</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pomcheckr</span><span class="op">)</span>
<span class="co"># https://cran.r-project.org/web/packages/pomcheckr/pomcheckr.pdf</span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pomcheckr/man/pomcheck.html">pomcheck</a></span><span class="op">(</span> <span class="va">scaled</span> <span class="op">~</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 2 × 6
# Groups:   condition [2]
  condition `scaled_&gt;=1` `scaled_&gt;=2` `scaled_&gt;=4` `scaled_&gt;=5` `scaled_&gt;=3`
  &lt;fct&gt;            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1 control            Inf        -1.43       -1.53        -1.65        NA    
2 impasse            Inf        NA          -0.379       -0.862        0.788

attr(,"class")
[1] "pomcheck" "list"    </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb412"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>The output of the graphical test for proportional odds assumption suggests that the proportional odds assumption may be unreasonable for this dataset. Also, inspecting the output table, we see the coefficients for each level of the scaled variable are quite different.</strong></p>
<p>Thus, an alternative approach may be more appropriate:</p>
<ul>
<li><p>Baseline logistic model. This model is the same as the multinomial regression model covered in the previous chapter, using the lowest ordinal value as the reference.</p></li>
<li><p>Adjacent-category logistic model. This model compares each level of the ordinal variable to the next highest level, and it is a constrained version of the baseline logistic model. The brglm2 package in R offers a function bracl() for calculating an adjacent category logistic model.</p></li>
<li><p>Continuation-ratio logistic model. This model compares each level of the ordinal variable to all lower levels. This can be modeled using binary logistic regression techniques, but new variables need to be constructed from the data set to allow this. The R package rms has a function cr.setup() which is a utility for preparing an outcome variable for a continuation ratio model.</p></li>
</ul>
<p>*Note: for multiple regression, the ordinal package offers a parameter (nominal = ~predictors) that allow you to designate some predictors as nominal rather than ordinal. But this is not appropriate for this use case._</p>
</section></section></section><section id="categorical-outcome" class="level2"><h2 class="anchored" data-anchor-id="categorical-outcome">CATEGORICAL OUTCOME</h2>
<p><strong>Does CONDITION affect the Q1 [ordered] type of response given?</strong></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-44_2e58c925f0b33aaedef09abdcee73059">
<details><summary>CODE</summary><div class="sourceCode" id="cb414"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> 
<span class="co">#scaled has already been set as an ordered factor of score_SCALED</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">scaled</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth      0.39683 0.15873
  unknown   0.00794 0.00000
  uncertain 0.00000 0.14286
  lines     0.00794 0.05556
  tri       0.07937 0.15079</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb416"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">scaled</span>, fill<span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb417"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,
                       fill <span class="op">=</span> <span class="va">scaled</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Q1 Interpretation"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Does CONDITION affect the Q1 [ordered] state of understanding?</strong></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-45_cd810725fe2a63ec4a7a39622540f68b">
<details><summary>CODE</summary><div class="sourceCode" id="cb418"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> 
<span class="co">#scaled has already been set as an ordered factor of score_SCALED</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth-like 0.39683 0.15873
  unknown   0.00794 0.14286
  tri-like  0.08730 0.20635</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb420"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">state</span>, fill<span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb421"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,
                       fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Q1 State"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="chi-square-1" class="level3"><h3 class="anchored" data-anchor-id="chi-square-1">CHI SQUARE</h3>
<p><strong>Does CONDITION affect the Q1 [categorical] type of response given?</strong></p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-46_83565a7cf2565b26a1a3ddc7b99d40c3">
<details><summary>CODE</summary><div class="sourceCode" id="cb422"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">scaled</span>, 
             fisher <span class="op">=</span> <span class="cn">TRUE</span>, chisq<span class="op">=</span><span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span>, sresid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(t, correct = FALSE, ...): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  126 

 
             | df$scaled 
df$condition |      orth |   unknown | uncertain |     lines |       tri | Row Total | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
     control |        50 |         1 |         0 |         1 |        10 |        62 | 
             |    34.444 |     0.492 |     8.857 |     3.937 |    14.270 |           | 
             |     7.025 |     0.524 |     8.857 |     2.191 |     1.278 |           | 
             |     0.806 |     0.016 |     0.000 |     0.016 |     0.161 |     0.492 | 
             |     0.714 |     1.000 |     0.000 |     0.125 |     0.345 |           | 
             |     0.397 |     0.008 |     0.000 |     0.008 |     0.079 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
     impasse |        20 |         0 |        18 |         7 |        19 |        64 | 
             |    35.556 |     0.508 |     9.143 |     4.063 |    14.730 |           | 
             |     6.806 |     0.508 |     8.580 |     2.122 |     1.238 |           | 
             |     0.312 |     0.000 |     0.281 |     0.109 |     0.297 |     0.508 | 
             |     0.286 |     0.000 |     1.000 |     0.875 |     0.655 |           | 
             |     0.159 |     0.000 |     0.143 |     0.056 |     0.151 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
Column Total |        70 |         1 |        18 |         8 |        29 |       126 | 
             |     0.556 |     0.008 |     0.143 |     0.063 |     0.230 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  39.1     d.f. =  4     p =  6.55e-08 


 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Alternative hypothesis: two.sided
p =  1.01e-09 

 </code></pre>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-47_b2b518a620580218d719029bf0a96cb2">
<details><summary>CODE</summary><div class="sourceCode" id="cb425"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Interpretation on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">condition</span> <span class="op">~</span> <span class="va">scaled</span>, 
            shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb426"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::WITH STATISTICS</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbarstats.html">ggbarstats</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">scaled</span>,
           type <span class="op">=</span> <span class="st">"nonparametric"</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="modelling_ref_cache/html/label - CHISQR-interpreation_0d919eb86a008e462e69f6924d7755a7">
<details><summary>CODE</summary><div class="sourceCode" id="cb427"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Response Type on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">condition</span> <span class="op">~</span> <span class="va">scaled</span>, 
            shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20CHISQR-interpreation-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb428"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">scaled</span>, 
            fisher <span class="op">=</span> <span class="cn">TRUE</span>, chisq<span class="op">=</span><span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span>, sresid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(t, correct = FALSE, ...): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  126 

 
             | df$scaled 
df$condition |      orth |   unknown | uncertain |     lines |       tri | Row Total | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
     control |        50 |         1 |         0 |         1 |        10 |        62 | 
             |    34.444 |     0.492 |     8.857 |     3.937 |    14.270 |           | 
             |     7.025 |     0.524 |     8.857 |     2.191 |     1.278 |           | 
             |     0.806 |     0.016 |     0.000 |     0.016 |     0.161 |     0.492 | 
             |     0.714 |     1.000 |     0.000 |     0.125 |     0.345 |           | 
             |     0.397 |     0.008 |     0.000 |     0.008 |     0.079 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
     impasse |        20 |         0 |        18 |         7 |        19 |        64 | 
             |    35.556 |     0.508 |     9.143 |     4.063 |    14.730 |           | 
             |     6.806 |     0.508 |     8.580 |     2.122 |     1.238 |           | 
             |     0.312 |     0.000 |     0.281 |     0.109 |     0.297 |     0.508 | 
             |     0.286 |     0.000 |     1.000 |     0.875 |     0.655 |           | 
             |     0.159 |     0.000 |     0.143 |     0.056 |     0.151 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
Column Total |        70 |         1 |        18 |         8 |        29 |       126 | 
             |     0.556 |     0.008 |     0.143 |     0.063 |     0.230 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  39.1     d.f. =  4     p =  6.55e-08 


 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Alternative hypothesis: two.sided
p =  1.01e-09 

 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb431"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scaled"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">scaled</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">orth</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">50</span><br><span style="color:#339999;">34</span><br><span style="color:#333399;">71.4&nbsp;%</span><br><span style="color:#339933;">80.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">20</span><br><span style="color:#339999;">36</span><br><span style="color:#333399;">28.6&nbsp;%</span><br><span style="color:#339933;">31.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">70</span><br><span style="color:#339999;">70</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">55.6&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">unknown</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">1</span><br><span style="color:#339999;">0</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">1.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">0</span><br><span style="color:#339999;">1</span><br><span style="color:#333399;">0&nbsp;%</span><br><span style="color:#339933;">0&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">1</span><br><span style="color:#339999;">1</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">0.8&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">uncertain</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">0</span><br><span style="color:#339999;">9</span><br><span style="color:#333399;">0&nbsp;%</span><br><span style="color:#339933;">0&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">18</span><br><span style="color:#339999;">9</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">28.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">18</span><br><span style="color:#339999;">18</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">14.3&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">lines</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">1</span><br><span style="color:#339999;">4</span><br><span style="color:#333399;">12.5&nbsp;%</span><br><span style="color:#339933;">1.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">7</span><br><span style="color:#339999;">4</span><br><span style="color:#333399;">87.5&nbsp;%</span><br><span style="color:#339933;">10.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">8</span><br><span style="color:#339999;">8</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">6.3&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">tri</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">10</span><br><span style="color:#339999;">14</span><br><span style="color:#333399;">34.5&nbsp;%</span><br><span style="color:#339933;">16.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">19</span><br><span style="color:#339999;">15</span><br><span style="color:#333399;">65.5&nbsp;%</span><br><span style="color:#339933;">29.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">29</span><br><span style="color:#339999;">29</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">23&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">62</span><br><span style="color:#339999;">62</span><br><span style="color:#333399;">49.2&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">64</span><br><span style="color:#339999;">64</span><br><span style="color:#333399;">50.8&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">126</span><br><span style="color:#339999;">126</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=39.128 · df=4 · Cramer's V=0.557 · Fisher's p=0.000</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within scaled</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
</div>
<p><strong>TODO INFERENCE</strong></p>
</section><section id="multinomial-regression" class="level3"><h3 class="anchored" data-anchor-id="multinomial-regression">MULTINOMIAL REGRESSION</h3>
<p><em>Does condition affect the response state of Q1?</em></p>
<ul>
<li><a href="https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model" class="uri">https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model</a></li>
<li><a href="https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK" class="uri">https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK</a></li>
</ul>
<section id="fit-model-2" class="level4"><h4 class="anchored" data-anchor-id="fit-model-2">Fit Model</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-49_819484559562eed7d6b0d17cd246fa06">
<details><summary>CODE</summary><div class="sourceCode" id="cb432"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span>

<span class="co">#check reference level </span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "orth-like" "unknown"   "tri-like" </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb434"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT EMPTY MODEL</span>
<span class="va">catm.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># weights:  6 (2 variable)
initial  value 138.425148 
final  value 122.428550 
converged</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb436"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># summary(catm.0)</span>

<span class="co">#FIT PREDICTOR MODEL</span>
<span class="va">catm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">state</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># weights:  9 (4 variable)
initial  value 138.425148 
iter  10 value 103.421004
iter  10 value 103.421004
final  value 103.421004 
converged</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb438"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># summary(catm)</span>

<span class="co">#COMPARE MODEL FIT</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">catm.0</span>, <span class="va">catm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name   |    Model | df | df_diff |  Chi2 |      p
-------------------------------------------------
catm.0 | multinom |  2 |         |       |       
catm   | multinom |  4 |       2 | 38.02 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb440"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">##compare bayesian version</span>
<span class="co">#library(brms)</span>
<span class="co"># m1 &lt;- brm( state ~ condition, data = df, family = "categorical")</span>
<span class="co"># summary(m1)</span>
<span class="co"># plot_model(m1)</span>
<span class="co"># report(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.</em></p>
</section><section id="interpretation" class="level4"><h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-50_b363aa45fcecb2b7e89b1fc48687eeb9">
<details><summary>CODE</summary><div class="sourceCode" id="cb441"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::INTERPRETATION</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MODEL SUMMARY"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL SUMMARY"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb443"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = state ~ condition, data = df, model = TRUE)

Coefficients:
         (Intercept) conditionimpasse
unknown        -3.91             3.81
tri-like       -1.51             1.78

Std. Errors:
         (Intercept) conditionimpasse
unknown        1.010            1.061
tri-like       0.333            0.447

Residual Deviance: 207 
AIC: 215 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb445"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># calculate z-statistics of coefficients</span>
<span class="op">(</span><span class="va">z_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span><span class="op">$</span><span class="va">standard.errors</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         (Intercept) conditionimpasse
unknown        -3.87             3.59
tri-like       -4.55             3.98</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb447"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># convert to p-values</span>
<span class="va">p_values</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z_stats</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span>
<span class="co"># display p-values in transposed data frame</span>
<span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>p <span class="op">=</span> <span class="op">(</span><span class="va">p_values</span><span class="op">)</span><span class="op">)</span>
<span class="co"># display odds ratios in transposed data frame</span>

<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb449"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">odds_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">)</span>

<span class="co"># options(scipen = 3)</span>
<span class="op">(</span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">odds_ratios</span>, <span class="va">p_values</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         OR..Intercept. OR.conditionimpasse p..Intercept. p.conditionimpasse
unknown            0.02               44.99      1.07e-04          0.0003330
tri-like           0.22                5.91      5.45e-06          0.0000692</code></pre>
</div>
</div>
<p><strong>Learning Notes</strong></p>
<ul>
<li>Model estimates encompass two equations:</li>
<li>effect of predictor on log odds of being in [unknown] instead of reference category [orth-like]</li>
<li>effect of predictor on log odds of being in [tri-like] instead of reference category [orth-like]</li>
</ul></section><section id="inference-2" class="level4"><h4 class="anchored" data-anchor-id="inference-2">Inference</h4>
<ul>
<li>Being in the IMPASSE condition increases the odds of giving ‘unknown/uncertain’ response rather than an orthogonal (or satisficing) response by a factor of 50 (z = 3.59, p &lt; 0.001 ).</li>
<li>Being in the IMPASSE condition increases the odds of giving an ‘triangular or line-driven’ response rather than an orthogonal (or satisficing) response by a factor of 6 (z = 3.98, p &lt;0.001 )</li>
</ul></section><section id="visualize-1" class="level4"><h4 class="anchored" data-anchor-id="visualize-1">Visualize</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-51_887398fbeff3fe7fe68c8aaa2e1c0b04">
<details><summary>CODE</summary><div class="sourceCode" id="cb451"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">catm</span>, vline.color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb452"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">catm</span>, type <span class="op">=</span> <span class="st">"eff"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-51-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="diagnostics-2" class="level4"><h4 class="anchored" data-anchor-id="diagnostics-2">Diagnostics</h4>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-52_d993b5ae185c046d096854360612f041">
<details><summary>CODE</summary><div class="sourceCode" id="cb454"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#EXAMINE PREDICTIONS</span>
<span class="co">#create sample data frame</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"impasse"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">catm</span>, newdata <span class="op">=</span> <span class="va">test</span>, <span class="st">"probs"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Predicted Probability of Being in Each State"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Predicted Probability of Being in Each State"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb456"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">test</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  condition orth-like unknown tri-like
1   control     0.806  0.0161    0.177
2   impasse     0.312  0.2812    0.406</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb458"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#performance</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Nagelkerke's R2 |  RMSE | Sigma
---------------------------------------------------
214.842 | 226.187 |           0.304 | 0.404 | 1.302</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb461"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/PseudoR2.html">PseudoR2</a></span><span class="op">(</span><span class="va">catm</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'DescTools':
  method         from 
  reorder.factor gdata</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  McFadden   CoxSnell Nagelkerke 
     0.155      0.260      0.304 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb464"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#General Goodness of Fit</span>
<span class="co"># library(generalhoslem)</span>
<span class="co"># logitgof(df$state, catm$fitted.values, g = 3)</span>
<span class="co"># hoslem.test(x = df$state, y = catm$fitted.values, g =  10)</span>
<span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span>
<span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section></section><section id="mixed-repeated-measures" class="level1"><h1>MIXED (Repeated Measures)</h1>
<div class="cell" data-hash="modelling_ref_cache/html/SETUP-TEST-ACC-ITEM_864ca78c0852a829a70704d7124dabbe">
<details><summary>CODE</summary><div class="sourceCode" id="cb465"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PREPARE DATA </span>
<span class="va">n_items</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#number of items in test</span>

<span class="co">#item level</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_niceABS</span>, <span class="st">"0"</span> <span class="op">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"correct"</span><span class="op">)</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">#FACETED HISTOGRAM</span>
<span class="va">stats</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">pretty_condition</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">item_test_NABS</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">item_test_NABS</span>, 
         fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">pretty_mode</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_lines.html">gf_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stats</span>, xintercept <span class="op">=</span> <span class="op">~</span><span class="va">mean</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"# Correct"</span>,
       y <span class="op">=</span> <span class="st">"proportion of subjects"</span>,
       title <span class="op">=</span> <span class="st">"Test Phase Absolute Score (# Correct)"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb466"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">accuracy</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, x <span class="op">=</span><span class="op">~</span><span class="va">pretty_condition</span>,
       position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Correct Responses in Test Phase"</span>,
       title <span class="op">=</span> <span class="st">"Accuracy on Task by Condition"</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb467"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on Test Phase"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="mixed-continuous" class="level2"><h2 class="anchored" data-anchor-id="mixed-continuous">MIXED — CONTINUOUS</h2>
</section><section id="mixed-binomial" class="level2"><h2 class="anchored" data-anchor-id="mixed-binomial">MIXED — BINOMIAL</h2>
<section id="mixed-logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="mixed-logistic-regression">Mixed Logistic Regression</h4>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on test phase questions by condition; accounting for random effects of subject.</em></p>
<section id="fit-model-3" class="level5"><h5 class="anchored" data-anchor-id="fit-model-3">Fit Model</h5>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-54_19f2d0f311b449f6838a6788ba1bd54f">
<details><summary>CODE</summary><div class="sourceCode" id="cb468"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA </span>
<span class="va">n_items</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#number of items in test</span>

<span class="co">#item level</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>
<span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span><span class="st">"lab-synch"</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR">lmerTest</a></span><span class="op">)</span> <span class="co">#for CIs in glmer </span>

<span class="co">## 1 | SETUP RANDOM EFFECT</span>

<span class="co">#:: EMPTY MODEL (baseline, no random effect)</span>
<span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> 

<span class="co">#:: RANDOM INTERCEPT SUBJECT</span>
<span class="va">mm.rS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>

<span class="co"># :: TEST random effect</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC with random effect is lower than glm empty model?"</span>, <span class="va">m0</span><span class="op">$</span><span class="va">aic</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC with random effect is lower than glm empty model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb470"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">mm.rS</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name  |    Model | df | df_diff |   Chi2 |      p
-------------------------------------------------
m0    |      glm |  1 |         |        |       
mm.rS | glmerMod |  2 |       1 | 678.41 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb472"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  1.48371797931313e-149"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb474"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## 2 | ADD FIXED EFFECT</span>

<span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span>
<span class="va">mm.CrS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, 
                data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>

<span class="co"># :: TEST fixed factor </span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC with fixed effect is lower than random intercept only model?"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC with fixed effect is lower than random intercept only model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb476"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rS</span>,<span class="va">mm.CrS</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name   |    Model | df | df_diff | Chi2 |     p
-----------------------------------------------
mm.rS  | glmerMod |  2 |         |      |      
mm.CrS | glmerMod |  3 |       1 | 3.91 | 0.048</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb478"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rS</span>,<span class="va">mm.CrS</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.047907883063779"</code></pre>
</div>
</div>
</section><section id="visualize-2" class="level5"><h5 class="anchored" data-anchor-id="visualize-2">Visualize</h5>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-55_6296d6184785416ac0a11f989efcb79a">
<details><summary>CODE</summary><div class="sourceCode" id="cb480"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PRINT MODEL </span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb482"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://jtools.jacob-long.com/reference/summ.html">summ</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 1008 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> accuracy </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> Mixed effects generalized linear model </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Family </td>
   <td style="text-align:right;"> binomial </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Link </td>
   <td style="text-align:right;"> logit </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> AIC </td>
   <td style="text-align:right;"> 582.02 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> BIC </td>
   <td style="text-align:right;"> 596.77 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (fixed effects) </td>
   <td style="text-align:right;"> 0.07 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (total) </td>
   <td style="text-align:right;"> 0.95 </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Fixed Effects</div></th></tr>
<tr>
<th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> z val. </th>
   <th style="text-align:right;"> p </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> -7.46 </td>
   <td style="text-align:right;"> 1.20 </td>
   <td style="text-align:right;"> -6.21 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> pretty_conditionimpasse </td>
   <td style="text-align:right;"> 4.03 </td>
   <td style="text-align:right;"> 1.67 </td>
   <td style="text-align:right;"> 2.42 </td>
   <td style="text-align:right;"> 0.02 </td>
  </tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Random Effects</div></th></tr>
<tr>
<th> Group </th>
   <th> Parameter </th>
   <th> Std. Dev. </th>
  </tr>
</thead>
<tbody><tr>
<td> subject </td>
   <td> (Intercept) </td>
   <td> 7.36 </td>
  </tr></tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Grouping Variables</div></th></tr>
<tr>
<th> Group </th>
   <th> # groups </th>
   <th> ICC </th>
  </tr>
</thead>
<tbody><tr>
<td> subject </td>
   <td> 126 </td>
   <td> 0.94 </td>
  </tr></tbody>
</table>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb483"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: INTERPRET COEFFICIENTS</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb485"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma | Log_loss | Score_log | Score_spherical
------------------------------------------------------------------------------------------------------------
582.024 | 596.771 |      0.946 |      0.066 | 0.943 | 0.213 | 1.000 |    0.145 |      -Inf |           0.021</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb487"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb489"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic mixed model (estimated using ML and Nelder-Mead optimizer) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model included subject as random effect (formula: ~1 | subject). The model's total explanatory power is substantial (conditional R2 = 0.95) and the part related to the fixed effects alone (marginal R2) is of 0.07. The model's intercept, corresponding to pretty_condition = control, is at -7.46 (95% CI [-9.81, -5.11], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 4.03, 95% CI [0.76, 7.29], p = 0.016; Std. beta = 4.03, 95% CI [0.76, 7.29])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb492"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PLOT</span>

<span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mm.CrS</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb493"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mm.CrS</span>, type<span class="op">=</span><span class="st">"pred"</span>,
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,
           show.values <span class="op">=</span> <span class="cn">TRUE</span>,
           title <span class="op">=</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,
           axis.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-55-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb495"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span>
<span class="co"># library(ggeffects)</span>
<span class="co"># ggeffect(model = mm.CrS) %&gt;% plot()</span>

<span class="co">#SANITY CHECK SJPLOT</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(mm.CrS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics-3" class="level5"><h5 class="anchored" data-anchor-id="diagnostics-3">Diagnostics</h5>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-56_1b7b3a3099d08b1107e99d65cd942f6a">
<details><summary>CODE</summary><div class="sourceCode" id="cb496"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb497"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Warning: Probably bad model fit. Only about 64% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-56-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="inference-3" class="level5"><h5 class="anchored" data-anchor-id="inference-3">Inference</h5>
<p>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(3): 4.98, p &lt; 0.05). Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 5 over the control condition <span class="math inline">\(e^{\beta_1}\)</span> = 5.11, 95% CI [1.17,22,36], p &lt; 0.05.</p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-57_8a596c060628b3798a62a4c177a9af9e">
<details><summary>CODE</summary><div class="sourceCode" id="cb499"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># PRETTY TABLE SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">56.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.14&nbsp;–&nbsp;1472.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.016</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">54.11</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.94</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">126</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1008</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.066 / 0.946</td>
</tr>
</tbody></table>
</div>
</div>
</section></section></section><section id="mixed-ordinal" class="level2"><h2 class="anchored" data-anchor-id="mixed-ordinal">MIXED — ORDINAL</h2>
</section><section id="mixed-categorical" class="level2"><h2 class="anchored" data-anchor-id="mixed-categorical">MIXED — CATEGORICAL</h2>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-58_83c4083ce75eaa2dcb2f9d71392003ea">
<details><summary>CODE</summary><div class="sourceCode" id="cb500"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#BAYESIAN MIXED VERSION</span>
<span class="co">#df &lt;- df_items %&gt;% filter(q %nin% c(1,2,3,4,5,6,9)) %&gt;% filter(term=="spring18")</span>
<span class="co"># mm1 &lt;- brm( state ~ condition + (1|subject), data = df, family = "categorical", </span>
<span class="co"># file = "analysis/models/sgc3a_brms_mixedcat_teststate.rds" # cache model (can be removed)))</span>
<span class="co"># summary(mm1)</span>
<span class="co"># performance(mm1)</span>
<span class="co"># plot(mm1)</span>
<span class="co"># #report(mm1)</span>
<span class="co"># #check_posterior_predictions(mm1, draws=100)</span>
<span class="co"># # library(bayesplot)</span>
<span class="co"># library(bayestestR)</span>
<span class="co"># plot(rope(mm1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="wip-unknown" class="level2"><h2 class="anchored" data-anchor-id="wip-unknown">WIP UNKNOWN</h2>
<section id="cummulative-ordinal-bayesian-equal-variance" class="level3"><h3 class="anchored" data-anchor-id="cummulative-ordinal-bayesian-equal-variance">Cummulative Ordinal (Bayesian) — Equal Variance</h3>
<p>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-59_99af1c389a1e0e1f79d55dcc023297c3">
<details><summary>CODE</summary><div class="sourceCode" id="cb501"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rcpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Rcpp' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading 'brms' package (version 2.16.3). Useful instructions
can be found by typing help('brms'). A more detailed introduction
to the package is available through vignette('brms_overview').</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'brms'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    mm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gamlss':

    cs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    acat, cratio, cumulative, dfrechet, dirichlet, exponential,
    frechet, geometric, lognormal, multinomial, negbinomial, pfrechet,
    qfrechet, rfrechet, s, sratio</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ordinal':

    ranef, VarCorr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    ngrps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggdist':

    dstudent_t, pstudent_t, qstudent_t, rstudent_t</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    kidney</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    ar</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb514"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#DEFINE DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span><span class="st">"lab-synch"</span><span class="op">)</span>
  
<span class="co">#TODO: why is this probit instead of logit?</span>
<span class="va">cumord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">state</span> <span class="op">~</span> <span class="va">condition</span>,
               data <span class="op">=</span> <span class="va">df</span>,
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">cumulative</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span>,
               file <span class="op">=</span> <span class="st">"analysis/models/sgc3a_brms_cumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = probit; disc = identity 
Formula: state ~ condition 
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]         0.75      0.18     0.41     1.11 1.00     3054     2790
Intercept[2]         1.22      0.19     0.85     1.60 1.00     3305     2732
conditionimpasse     1.11      0.23     0.66     1.55 1.00     3192     2953

Family Specific Parameters: 
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb516"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">cumord</span>, <span class="st">"condition"</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb517"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb518"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-59-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb519"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/rope.html">rope</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.76). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-59-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb521"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#REPORT</span>
<span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.76). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.76). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'cf2f01a4fe37a84227ece42ac0100f30' NOW (CHAIN 1).
Chain 1: Rejecting initial value:
Chain 1:   Log probability evaluates to log(0), i.e. negative infinity.
Chain 1:   Stan can't start sampling from this initial value.
Chain 1: 
Chain 1: Gradient evaluation took 0.000153 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.53 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.138664 seconds (Warm-up)
Chain 1:                0.135617 seconds (Sampling)
Chain 1:                0.274281 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'cf2f01a4fe37a84227ece42ac0100f30' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 2.9e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.29 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.141138 seconds (Warm-up)
Chain 2:                0.132802 seconds (Sampling)
Chain 2:                0.27394 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'cf2f01a4fe37a84227ece42ac0100f30' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 2.9e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.29 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.141417 seconds (Warm-up)
Chain 3:                0.133805 seconds (Sampling)
Chain 3:                0.275222 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'cf2f01a4fe37a84227ece42ac0100f30' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.3 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.139052 seconds (Warm-up)
Chain 4:                0.138151 seconds (Sampling)
Chain 4:                0.277203 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.74). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ condition). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50) and uniform (location = , scale = ) distributions. The model's explanatory power is moderate (R2 = 0.18, 95% CI [0.08, 0.28]).  Within this model:

  - The effect of b Intercept[1] (Median = 0.74, 95% CI [0.41, 1.11]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 99.58% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.001) and the indices are reliable (ESS = 3139)
  - The effect of b Intercept[2] (Median = 1.22, 95% CI [0.85, 1.60]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.001) and the indices are reliable (ESS = 3040)
  - The effect of b conditionimpasse (Median = 1.11, 95% CI [0.66, 1.55]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 99.98% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.002) and the indices are reliable (ESS = 3314)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb531"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># ord_cum %&gt;%</span>
<span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co">#   stat_halfeye()</span>

<span class="co"># performance(cumord)</span>
<span class="co"># plot(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="cummulative-ordinal-bayesian-unequal-variance" class="level3"><h3 class="anchored" data-anchor-id="cummulative-ordinal-bayesian-unequal-variance">Cummulative Ordinal (Bayesian) — Unequal Variance</h3>
<p>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</p>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-60_e313db5af10d579fd479e712a645d6fb">
<details><summary>CODE</summary><div class="sourceCode" id="cb532"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span>


<span class="co">#DEFINE DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span><span class="st">"lab-synch"</span><span class="op">)</span>
  
<span class="co">#TODO: why is this probit instead of logit?</span>
<span class="va">u.cumord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span> 
  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html">bf</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="va">condition</span><span class="op">)</span> <span class="op">+</span>
               <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula-helpers.html">lf</a></span><span class="op">(</span><span class="va">disc</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">condition</span>, cmc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
               data <span class="op">=</span> <span class="va">df</span>,
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">cumulative</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span>,
               file <span class="op">=</span> <span class="st">"analysis/models/sgc3a_brms_ucumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 97 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = probit; disc = log 
Formula: state ~ condition 
         disc ~ 0 + condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept[1]              0.84      0.18     0.48     1.19 1.00      960
Intercept[2]              1.01      0.19     0.64     1.39 1.01      908
conditionimpasse          0.96      0.19     0.60     1.32 1.01      954
disc_conditionimpasse     1.52      0.61     0.43     2.68 1.02      313
                      Tail_ESS
Intercept[1]              1061
Intercept[2]               764
conditionimpasse           848
disc_conditionimpasse      227

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb535"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">u.cumord</span>, <span class="st">"condition"</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb536"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-60-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb537"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-60-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb538"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/rope.html">rope</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-60-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb539"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#REPORT</span>
<span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL '6d2eabb1cdbde54c793de3661fa8db1b' NOW (CHAIN 1).
Chain 1: Rejecting initial value:
Chain 1:   Log probability evaluates to log(0), i.e. negative infinity.
Chain 1:   Stan can't start sampling from this initial value.
Chain 1: 
Chain 1: Gradient evaluation took 7e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.7 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.526857 seconds (Warm-up)
Chain 1:                0.339216 seconds (Sampling)
Chain 1:                0.866073 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL '6d2eabb1cdbde54c793de3661fa8db1b' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 3.8e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.38 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.544406 seconds (Warm-up)
Chain 2:                0.488075 seconds (Sampling)
Chain 2:                1.03248 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL '6d2eabb1cdbde54c793de3661fa8db1b' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 7.2e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.72 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.554185 seconds (Warm-up)
Chain 3:                0.474468 seconds (Sampling)
Chain 3:                1.02865 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL '6d2eabb1cdbde54c793de3661fa8db1b' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3.5e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.35 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.553802 seconds (Warm-up)
Chain 4:                0.48838 seconds (Sampling)
Chain 4:                1.04218 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ condition). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ) and uniform (location = , scale = ) distributions. The model's explanatory power is moderate (R2 = 0.17, 95% CI [0.07, 0.26]).  Within this model:

  - The effect of b Intercept[1] (Median = 0.84, 95% CI [0.48, 1.19]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 99.98% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.000) but the indices are unreliable (ESS = 953)
  - The effect of b Intercept[2] (Median = 1.01, 95% CI [0.64, 1.39]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.008) but the indices are unreliable (ESS = 298)
  - The effect of b conditionimpasse (Median = 0.95, 95% CI [0.60, 1.32]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.000) but the indices are unreliable (ESS = 952)
  - The effect of b disc conditionimpasse (Median = 1.48, 95% CI [0.43, 2.68]) has a 99.80% probability of being positive (&gt; 0), 99.72% of being significant (&gt; 0.05), and 98.67% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.000) but the indices are unreliable (ESS = 905)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb546"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># ord_cum %&gt;%</span>
<span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co">#   stat_halfeye()</span>

<span class="co"># performance(cumord)</span>
<span class="co"># plot(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In brms, the parameter related to latent variances is called disc (short for “discrimination”), following conventions in item response theory. Note that disc is not the variance itself, but the inverse of the standard deviation, s. That is, s = 1/disc. Further, because disc must be strictly positive, it is by default modeled on the log scale.</p>
</section><section id="adjacent-category-ordinal-bayesian" class="level3"><h3 class="anchored" data-anchor-id="adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</h3>
<div class="cell" data-hash="modelling_ref_cache/html/unnamed-chunk-61_213219dc63ec6cf373bc2953c8a3eac4">
<details><summary>CODE</summary><div class="sourceCode" id="cb547"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span><span class="st">"lab-synch"</span><span class="op">)</span>


<span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span>

<span class="va">adjcat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">state</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/cs.html">cs</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>,
               data <span class="op">=</span> <span class="va">df</span>,
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">acat</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span>,
               file <span class="op">=</span> <span class="st">"analysis/models/sgc3a_brms_adjcat_q1state.rds"</span> <span class="co"># cache model (can be removed)</span>
<span class="op">)</span>
 
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">adjcat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: acat 
  Links: mu = probit; disc = identity 
Formula: state ~ cs(condition) 
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]            1.99      0.37     1.38     2.80 1.00      637      822
Intercept[2]           -1.26      0.47    -2.29    -0.41 1.00      644      812
conditionimpasse[1]     1.92      0.42     1.18     2.79 1.00      656      827
conditionimpasse[2]    -1.02      0.50    -2.08    -0.14 1.00      652      732

Family Specific Parameters: 
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb549"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">cumord</span>, <span class="st">"condition"</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb550"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">adjcat</span>, <span class="st">"condition"</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-61-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb551"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#WHICH IS BETTER? cumulative or adjacent?</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">cumord</span>, <span class="va">adjcat</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.

Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-61-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb553"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">cumord</span>, <span class="va">adjcat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.

Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name   |   Model |     ELPD | ELPD_SE |   LOOIC | LOOIC weights | LOOIC_SE |    WAIC | WAIC weights |    R2
-----------------------------------------------------------------------------------------------------------
cumord | brmsfit | -113.628 |   7.485 | 227.256 |         0.062 |   14.970 | 227.249 |        0.002 | 0.179
adjcat | brmsfit | -107.434 |   7.111 | 214.868 |         0.938 |   14.223 | 214.718 |        0.998 | 0.169</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb556"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># #TIDYBAYES VISUALIZATION</span>
<span class="co"># library(tidybayes)</span>
<span class="co"># adjcat %&gt;%</span>
<span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co">#   stat_halfeye()</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-61-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb557"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">adjcat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-61-5.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb558"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">adjcat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.81), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.86). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.81), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.86). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'cb54d61933639a344521da987151fc46' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.000217 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.17 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1.76106 seconds (Warm-up)
Chain 1:                1.83352 seconds (Sampling)
Chain 1:                3.59457 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'cb54d61933639a344521da987151fc46' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.000119 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.19 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 1.77346 seconds (Warm-up)
Chain 2:                1.59958 seconds (Sampling)
Chain 2:                3.37304 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'cb54d61933639a344521da987151fc46' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.000119 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 1.19 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 1.76223 seconds (Warm-up)
Chain 3:                2.35291 seconds (Sampling)
Chain 3:                4.11514 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'cb54d61933639a344521da987151fc46' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.000123 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 1.23 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 2.13537 seconds (Warm-up)
Chain 4:                1.68762 seconds (Sampling)
Chain 4:                3.82298 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.83), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.86). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ cs(condition)). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), NA (NA) and NA (NA) distributions. The model's explanatory power is moderate (R2 = 0.17, 95% CI [0.07, 0.27]).  Within this model:

  - The effect of b Intercept[1] (Median = 1.94, 95% CI [1.38, 2.80]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.004) but the indices are unreliable (ESS = 598)
  - The effect of b Intercept[2] (Median = -1.22, 95% CI [-2.29, -0.41]) has a 99.85% probability of being negative (&lt; 0), 99.85% of being significant (&lt; -0.05), and 98.90% of being large (&lt; -0.30). The estimation successfully converged (Rhat = 1.002) but the indices are unreliable (ESS = 612)
  - The effect of bcs conditionimpasse[1] (Median = 1.88, 95% CI [1.18, 2.79]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.004) but the indices are unreliable (ESS = 617)
  - The effect of bcs conditionimpasse[2] (Median = -0.99, 95% CI [-2.08, -0.14]) has a 99.12% probability of being negative (&lt; 0), 98.70% of being significant (&lt; -0.05), and 93.70% of being large (&lt; -0.30). The estimation successfully converged (Rhat = 1.003) but the indices are unreliable (ESS = 620)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
</div>
<p><em>Converges, but estimates are unreliable?</em></p>


<!-- -->

</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../analysis/utils/scoring.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Scoring Strategy</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb568" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'SGCX | Modelling Reference'</span></span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb568-4"><a href="#cb568-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-5"><a href="#cb568-5" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb568-6"><a href="#cb568-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-7"><a href="#cb568-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modelling Reference {#modelling .unnumbered}</span></span>
<span id="cb568-8"><a href="#cb568-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-9"><a href="#cb568-9" aria-hidden="true" tabindex="-1"></a>**In this notebook we use data from study SGC3A to explore different modelling techniques and assess their suitability for the bimodal accuracy distributions in the SGC project data.**</span>
<span id="cb568-10"><a href="#cb568-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-13"><a href="#cb568-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-14"><a href="#cb568-14" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb568-15"><a href="#cb568-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb568-16"><a href="#cb568-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb568-17"><a href="#cb568-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-18"><a href="#cb568-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb568-19"><a href="#cb568-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools) <span class="co">#misc helpers </span></span>
<span id="cb568-20"><a href="#cb568-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-21"><a href="#cb568-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#arrange plots</span></span>
<span id="cb568-22"><a href="#cb568-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange shift function plots</span></span>
<span id="cb568-23"><a href="#cb568-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb568-24"><a href="#cb568-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd) <span class="co">#mosaic plots</span></span>
<span id="cb568-25"><a href="#cb568-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra) <span class="co">#mosaic plots</span></span>
<span id="cb568-26"><a href="#cb568-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables </span></span>
<span id="cb568-27"><a href="#cb568-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb568-28"><a href="#cb568-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy) <span class="co">#the way it should be</span></span>
<span id="cb568-29"><a href="#cb568-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions) <span class="co">#expressions to add to plots</span></span>
<span id="cb568-30"><a href="#cb568-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with expressions</span></span>
<span id="cb568-31"><a href="#cb568-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb568-32"><a href="#cb568-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects) <span class="co">#visualization log regr models</span></span>
<span id="cb568-33"><a href="#cb568-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-34"><a href="#cb568-34" aria-hidden="true" tabindex="-1"></a><span class="co">#misc utilities</span></span>
<span id="cb568-35"><a href="#cb568-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb568-36"><a href="#cb568-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb568-37"><a href="#cb568-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb568-38"><a href="#cb568-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb568-39"><a href="#cb568-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb568-40"><a href="#cb568-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb568-41"><a href="#cb568-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic) <span class="co">#extract model equation</span></span>
<span id="cb568-42"><a href="#cb568-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-43"><a href="#cb568-43" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling</span></span>
<span id="cb568-44"><a href="#cb568-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WRS2) <span class="co">#robust and nonparametric tests </span></span>
<span id="cb568-45"><a href="#cb568-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb568-46"><a href="#cb568-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr) <span class="co">#confint on qq plot</span></span>
<span id="cb568-47"><a href="#cb568-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels) <span class="co">#contingency table and CHISQR</span></span>
<span id="cb568-48"><a href="#cb568-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zeroinfl / hurdle models </span></span>
<span id="cb568-49"><a href="#cb568-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models </span></span>
<span id="cb568-50"><a href="#cb568-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal) <span class="co">#ordinal regression</span></span>
<span id="cb568-51"><a href="#cb568-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># polyr ordinal regression</span></span>
<span id="cb568-52"><a href="#cb568-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM) <span class="co">#censored, zero infl, etc</span></span>
<span id="cb568-53"><a href="#cb568-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brant) <span class="co">#brant test for ordinal regression</span></span>
<span id="cb568-54"><a href="#cb568-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression </span></span>
<span id="cb568-55"><a href="#cb568-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb568-56"><a href="#cb568-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-57"><a href="#cb568-57" aria-hidden="true" tabindex="-1"></a><span class="co">#one package to rule them all</span></span>
<span id="cb568-58"><a href="#cb568-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb568-59"><a href="#cb568-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-60"><a href="#cb568-60" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb568-61"><a href="#cb568-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb568-62"><a href="#cb568-62" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb568-63"><a href="#cb568-63" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb568-64"><a href="#cb568-64" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb568-65"><a href="#cb568-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-66"><a href="#cb568-66" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb568-67"><a href="#cb568-67" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>()) </span>
<span id="cb568-68"><a href="#cb568-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-69"><a href="#cb568-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-70"><a href="#cb568-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-73"><a href="#cb568-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-74"><a href="#cb568-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb568-75"><a href="#cb568-75" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb568-76"><a href="#cb568-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb568-77"><a href="#cb568-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-78"><a href="#cb568-78" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb568-79"><a href="#cb568-79" aria-hidden="true" tabindex="-1"></a><span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb568-80"><a href="#cb568-80" aria-hidden="true" tabindex="-1"></a><span class="co">#mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb568-81"><a href="#cb568-81" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(mbp)</span></span>
<span id="cb568-82"><a href="#cb568-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-83"><a href="#cb568-83" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb568-84"><a href="#cb568-84" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span>)</span>
<span id="cb568-85"><a href="#cb568-85" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span>)</span>
<span id="cb568-86"><a href="#cb568-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-87"><a href="#cb568-87" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb568-88"><a href="#cb568-88" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb568-89"><a href="#cb568-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_score =</span> item_test_NABS,</span>
<span id="cb568-90"><a href="#cb568-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_condition =</span> condition,</span>
<span id="cb568-91"><a href="#cb568-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> pretty_condition</span>
<span id="cb568-92"><a href="#cb568-92" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb568-93"><a href="#cb568-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-94"><a href="#cb568-94" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb568-95"><a href="#cb568-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb568-96"><a href="#cb568-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaled =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orth"</span>, <span class="st">"-0.5"</span><span class="ot">=</span><span class="st">"unknown"</span>,<span class="st">"0"</span><span class="ot">=</span><span class="st">"uncertain"</span>,<span class="st">"0.5"</span><span class="ot">=</span><span class="st">"lines"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"tri"</span>),</span>
<span id="cb568-97"><a href="#cb568-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaled =</span> <span class="fu">as.ordered</span>(scaled),</span>
<span id="cb568-98"><a href="#cb568-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_condition =</span> condition,</span>
<span id="cb568-99"><a href="#cb568-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> pretty_condition,</span>
<span id="cb568-100"><a href="#cb568-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb568-101"><a href="#cb568-101" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orth-like"</span>,</span>
<span id="cb568-102"><a href="#cb568-102" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"unknown"</span>,</span>
<span id="cb568-103"><a href="#cb568-103" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"unknown"</span>,</span>
<span id="cb568-104"><a href="#cb568-104" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>,</span>
<span id="cb568-105"><a href="#cb568-105" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>),</span>
<span id="cb568-106"><a href="#cb568-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">as.ordered</span>(state)</span>
<span id="cb568-107"><a href="#cb568-107" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb568-108"><a href="#cb568-108" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 group ordered STATE variable</span></span>
<span id="cb568-109"><a href="#cb568-109" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 group ordered SCALED variable [matches high_interpretation]</span></span>
<span id="cb568-110"><a href="#cb568-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-111"><a href="#cb568-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-112"><a href="#cb568-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-113"><a href="#cb568-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-114"><a href="#cb568-114" aria-hidden="true" tabindex="-1"></a><span class="fu"># INDEPENDENT SAMPLES</span></span>
<span id="cb568-115"><a href="#cb568-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-116"><a href="#cb568-116" aria-hidden="true" tabindex="-1"></a><span class="fu">## CONTINUOUS OUTCOME</span></span>
<span id="cb568-117"><a href="#cb568-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-118"><a href="#cb568-118" aria-hidden="true" tabindex="-1"></a>**Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?\</span>
<span id="cb568-119"><a href="#cb568-119" aria-hidden="true" tabindex="-1"></a>(# questions correct on test phase of task, <span class="sc">\[</span>in lab<span class="sc">\]</span> participants)**</span>
<span id="cb568-120"><a href="#cb568-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-121"><a href="#cb568-121" aria-hidden="true" tabindex="-1"></a>*(Can also be transformed to proportion or percentage).*</span>
<span id="cb568-122"><a href="#cb568-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-125"><a href="#cb568-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-126"><a href="#cb568-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-IND-TESTSCORE</span></span>
<span id="cb568-127"><a href="#cb568-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb568-128"><a href="#cb568-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb568-129"><a href="#cb568-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-130"><a href="#cb568-130" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::SETUP DATA</span></span>
<span id="cb568-131"><a href="#cb568-131" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb568-132"><a href="#cb568-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-133"><a href="#cb568-133" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb568-134"><a href="#cb568-134" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb568-135"><a href="#cb568-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-136"><a href="#cb568-136" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb568-137"><a href="#cb568-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-138"><a href="#cb568-138" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | FACETED HISTOGRAM</span></span>
<span id="cb568-139"><a href="#cb568-139" aria-hidden="true" tabindex="-1"></a><span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span></span>
<span id="cb568-140"><a href="#cb568-140" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~item_test_NABS, </span></span>
<span id="cb568-141"><a href="#cb568-141" aria-hidden="true" tabindex="-1"></a><span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span></span>
<span id="cb568-142"><a href="#cb568-142" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span></span>
<span id="cb568-143"><a href="#cb568-143" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span></span>
<span id="cb568-144"><a href="#cb568-144" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "# Correct",</span></span>
<span id="cb568-145"><a href="#cb568-145" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "proportion of subjects",</span></span>
<span id="cb568-146"><a href="#cb568-146" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span></span>
<span id="cb568-147"><a href="#cb568-147" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "") + theme(legend.position = "blank")</span></span>
<span id="cb568-148"><a href="#cb568-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-149"><a href="#cb568-149" aria-hidden="true" tabindex="-1"></a><span class="do">##GGPUBR | HIST+DENSITY SCORE </span></span>
<span id="cb568-150"><a href="#cb568-150" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">gghistogram</span>(df, <span class="at">x =</span> <span class="st">"test_score"</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb568-151"><a href="#cb568-151" aria-hidden="true" tabindex="-1"></a>   <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb568-152"><a href="#cb568-152" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill =</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span></span>
<span id="cb568-153"><a href="#cb568-153" aria-hidden="true" tabindex="-1"></a>   <span class="at">add_density =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-154"><a href="#cb568-154" aria-hidden="true" tabindex="-1"></a><span class="fu">facet</span>(p, <span class="at">facet.by=</span><span class="fu">c</span>(<span class="st">"condition"</span>)) <span class="sc">+</span></span>
<span id="cb568-155"><a href="#cb568-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score"</span>,</span>
<span id="cb568-156"><a href="#cb568-156" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,</span>
<span id="cb568-157"><a href="#cb568-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, <span class="at">y =</span> <span class="st">"number of subjects"</span>) <span class="sc">+</span></span>
<span id="cb568-158"><a href="#cb568-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb568-159"><a href="#cb568-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-160"><a href="#cb568-160" aria-hidden="true" tabindex="-1"></a><span class="do">##VERTICAL RAINCLOUD USING GGDISTR</span></span>
<span id="cb568-161"><a href="#cb568-161" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> test_score,</span>
<span id="cb568-162"><a href="#cb568-162" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> condition) ) <span class="sc">+</span> </span>
<span id="cb568-163"><a href="#cb568-163" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb568-164"><a href="#cb568-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>,</span>
<span id="cb568-165"><a href="#cb568-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb568-166"><a href="#cb568-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>, </span>
<span id="cb568-167"><a href="#cb568-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb568-168"><a href="#cb568-168" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span> </span>
<span id="cb568-169"><a href="#cb568-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb568-170"><a href="#cb568-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb568-171"><a href="#cb568-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score),</span>
<span id="cb568-172"><a href="#cb568-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb568-173"><a href="#cb568-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb568-174"><a href="#cb568-174" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb568-175"><a href="#cb568-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb568-176"><a href="#cb568-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb568-177"><a href="#cb568-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score, <span class="at">color =</span> condition),</span>
<span id="cb568-178"><a href="#cb568-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.3</span>,</span>
<span id="cb568-179"><a href="#cb568-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb568-180"><a href="#cb568-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>( </span>
<span id="cb568-181"><a href="#cb568-181" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">05</span></span>
<span id="cb568-182"><a href="#cb568-182" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">labs</span>( </span>
<span id="cb568-183"><a href="#cb568-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score "</span>,</span>
<span id="cb568-184"><a href="#cb568-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>) <span class="sc">+</span></span>
<span id="cb568-185"><a href="#cb568-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) <span class="sc">+</span> </span>
<span id="cb568-186"><a href="#cb568-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>), <span class="at">clip =</span> <span class="st">"off"</span>)</span>
<span id="cb568-187"><a href="#cb568-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-188"><a href="#cb568-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-189"><a href="#cb568-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-190"><a href="#cb568-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-191"><a href="#cb568-191" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independent Samples T-Test (Student's T)</span></span>
<span id="cb568-192"><a href="#cb568-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-193"><a href="#cb568-193" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tests null hypothesis that true difference in population mean is == 0</span>
<span id="cb568-194"><a href="#cb568-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed variables</span>
<span id="cb568-195"><a href="#cb568-195" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes equal variance of samples (homogeneity of variance)</span>
<span id="cb568-196"><a href="#cb568-196" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**SGC accuracy data violate both homogeneity and normality**<span class="sc">\*</span></span>
<span id="cb568-197"><a href="#cb568-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-200"><a href="#cb568-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-201"><a href="#cb568-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: STUDENTS-T</span></span>
<span id="cb568-202"><a href="#cb568-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-203"><a href="#cb568-203" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>( test_score <span class="sc">~</span> condition,<span class="at">data =</span> df,</span>
<span id="cb568-204"><a href="#cb568-204" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))) <span class="co"># less, greater for one sided tests</span></span>
<span id="cb568-205"><a href="#cb568-205" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span>
<span id="cb568-206"><a href="#cb568-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-207"><a href="#cb568-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-208"><a href="#cb568-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-211"><a href="#cb568-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-212"><a href="#cb568-212" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb568-213"><a href="#cb568-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-214"><a href="#cb568-214" aria-hidden="true" tabindex="-1"></a><span class="co">#one tailed tests must be done manually by extracting results expression and adding as subtitle</span></span>
<span id="cb568-215"><a href="#cb568-215" aria-hidden="true" tabindex="-1"></a><span class="co">#default is two tailed test</span></span>
<span id="cb568-216"><a href="#cb568-216" aria-hidden="true" tabindex="-1"></a><span class="co"># results &lt;- two_sample_test( data = df, x = pretty_condition, </span></span>
<span id="cb568-217"><a href="#cb568-217" aria-hidden="true" tabindex="-1"></a><span class="co">#                             y = item_test_NABS,</span></span>
<span id="cb568-218"><a href="#cb568-218" aria-hidden="true" tabindex="-1"></a><span class="co">#                             alternative = "g")</span></span>
<span id="cb568-219"><a href="#cb568-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-220"><a href="#cb568-220" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb568-221"><a href="#cb568-221" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"parametric"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb568-222"><a href="#cb568-222" aria-hidden="true" tabindex="-1"></a>               <span class="at">alternative  =</span> <span class="st">"g"</span>,</span>
<span id="cb568-223"><a href="#cb568-223" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, ) </span>
<span id="cb568-224"><a href="#cb568-224" aria-hidden="true" tabindex="-1"></a><span class="co"># + labs(subtitle = results$expression[[1]])</span></span>
<span id="cb568-225"><a href="#cb568-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-226"><a href="#cb568-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-227"><a href="#cb568-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-228"><a href="#cb568-228" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independent Samples T-Test (Welch's T)</span></span>
<span id="cb568-229"><a href="#cb568-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-230"><a href="#cb568-230" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tests null hypothesis that true difference in population mean is == 0</span>
<span id="cb568-231"><a href="#cb568-231" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed variables</span>
<span id="cb568-232"><a href="#cb568-232" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Does not** assumes equal variance of samples (homogeneity of variance)</span>
<span id="cb568-233"><a href="#cb568-233" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>***SGC accuracy data violates normality assumption***</span>
<span id="cb568-234"><a href="#cb568-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-237"><a href="#cb568-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-238"><a href="#cb568-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: WELCHES-T</span></span>
<span id="cb568-239"><a href="#cb568-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-240"><a href="#cb568-240" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>( test_score <span class="sc">~</span> condition,<span class="at">data =</span> df,</span>
<span id="cb568-241"><a href="#cb568-241" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>))</span>
<span id="cb568-242"><a href="#cb568-242" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span>
<span id="cb568-243"><a href="#cb568-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-244"><a href="#cb568-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-245"><a href="#cb568-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-248"><a href="#cb568-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-249"><a href="#cb568-249" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb568-250"><a href="#cb568-250" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb568-251"><a href="#cb568-251" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"parametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb568-252"><a href="#cb568-252" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb568-253"><a href="#cb568-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-254"><a href="#cb568-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-255"><a href="#cb568-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-256"><a href="#cb568-256" aria-hidden="true" tabindex="-1"></a><span class="fu">### Yuen's T-Test (Trimmed Means)</span></span>
<span id="cb568-257"><a href="#cb568-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-258"><a href="#cb568-258" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Robust alternative to** to t-test is Yuen's t-test which uses trimmed means</span>
<span id="cb568-259"><a href="#cb568-259" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Trimmed means are not desireable for this research scenario because they trim data from the extremes, and in this study these are true, interesting values</span>
<span id="cb568-260"><a href="#cb568-260" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://garstats.wordpress.com/2017/11/28/trimmed-means/&gt;</span></span>
<span id="cb568-261"><a href="#cb568-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-264"><a href="#cb568-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-265"><a href="#cb568-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: YUENS-T</span></span>
<span id="cb568-266"><a href="#cb568-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-267"><a href="#cb568-267" aria-hidden="true" tabindex="-1"></a>(y <span class="ot">&lt;-</span> <span class="fu">yuenbt</span>( <span class="at">formula =</span> test_score <span class="sc">~</span> condition, <span class="at">data =</span> df,</span>
<span id="cb568-268"><a href="#cb568-268" aria-hidden="true" tabindex="-1"></a>              <span class="at">side =</span> <span class="cn">TRUE</span>, <span class="at">EQVAR =</span> <span class="cn">FALSE</span>))</span>
<span id="cb568-269"><a href="#cb568-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-270"><a href="#cb568-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-271"><a href="#cb568-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-274"><a href="#cb568-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-275"><a href="#cb568-275" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb568-276"><a href="#cb568-276" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb568-277"><a href="#cb568-277" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"robust"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb568-278"><a href="#cb568-278" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb568-279"><a href="#cb568-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-280"><a href="#cb568-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-281"><a href="#cb568-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-282"><a href="#cb568-282" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wilcoxon Rank Sum (Mann-Whitney Test)</span></span>
<span id="cb568-283"><a href="#cb568-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-284"><a href="#cb568-284" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Non parametric alternative** to t-test; compares median rather than mean by ranking data</span>
<span id="cb568-285"><a href="#cb568-285" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume normality</span>
<span id="cb568-286"><a href="#cb568-286" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume equal variance of samples (homogeneity of variance)</span>
<span id="cb568-287"><a href="#cb568-287" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Appropriate for SGC accuracy data**</span>
<span id="cb568-288"><a href="#cb568-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-291"><a href="#cb568-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-292"><a href="#cb568-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: WILCOXON RANK SUM</span></span>
<span id="cb568-293"><a href="#cb568-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-294"><a href="#cb568-294" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df<span class="sc">$</span>test_score <span class="sc">~</span> df<span class="sc">$</span>condition,</span>
<span id="cb568-295"><a href="#cb568-295" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pared =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)) <span class="co">#less, greater</span></span>
<span id="cb568-296"><a href="#cb568-296" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(w)</span>
<span id="cb568-297"><a href="#cb568-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-298"><a href="#cb568-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-299"><a href="#cb568-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-302"><a href="#cb568-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-303"><a href="#cb568-303" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb568-304"><a href="#cb568-304" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb568-305"><a href="#cb568-305" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb568-306"><a href="#cb568-306" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb568-307"><a href="#cb568-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-308"><a href="#cb568-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-309"><a href="#cb568-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-310"><a href="#cb568-310" aria-hidden="true" tabindex="-1"></a><span class="fu">### Floor/Ceiling Corrections + Wilcoxon Rank Sum</span></span>
<span id="cb568-311"><a href="#cb568-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-312"><a href="#cb568-312" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The bimodal distribution of the subject-level score data do not meet the requirements for t-tests.</span>
<span id="cb568-313"><a href="#cb568-313" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>However, a non-parametric alternative is available (Wilcoxon rank sum test / Man-Whitney test)</span>
<span id="cb568-314"><a href="#cb568-314" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Additional corrections are available for data with 'floor' and/or 'ceiling' effects via the 'DACR' package</span>
<span id="cb568-315"><a href="#cb568-315" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14 see also https://qmliu.shinyapps.io/DACFE/</span>
<span id="cb568-316"><a href="#cb568-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-317"><a href="#cb568-317" aria-hidden="true" tabindex="-1"></a>For comparison we run a standard followed by a Wilcoxon rank-sum (Mann-Whitney) test that is a nonparametric alternative for non-normally distributed data.</span>
<span id="cb568-318"><a href="#cb568-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-321"><a href="#cb568-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-322"><a href="#cb568-322" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df<span class="sc">$</span>test_score <span class="sc">~</span> df<span class="sc">$</span>condition))</span>
<span id="cb568-323"><a href="#cb568-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-324"><a href="#cb568-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-325"><a href="#cb568-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-326"><a href="#cb568-326" aria-hidden="true" tabindex="-1"></a>Next, we calculate the t-test and ANOVA (F-test) based on a series of corrections provided for data with floor and/or ceiling effects.</span>
<span id="cb568-327"><a href="#cb568-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-328"><a href="#cb568-328" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14&gt;</span></span>
<span id="cb568-329"><a href="#cb568-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-330"><a href="#cb568-330" aria-hidden="true" tabindex="-1"></a>Using properties from truncated normal distributions, the authors propose an easy-to-use method for the *t*-test and ANOVA with ceiling/floor data.</span>
<span id="cb568-331"><a href="#cb568-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-332"><a href="#cb568-332" aria-hidden="true" tabindex="-1"></a>*The proposed method calculates the degrees of freedom based on the after-truncation sample sizes (where l = number of floor observations, and r = number of ceiling observations). The rationale was that the proposed method utilizes full information only from data points of n − r − l participants and partial information from data points of r + l participants of a group for the mean and variance estimation. Specifically, the corrected mean and variance estimates (Eqs. 14 and 15) are functions of mean and variance estimates using after-truncation data (n − r − l participants) and the standardized floor and ceiling threshold estimates. The thresholds are estimated using the ceiling and floor percentage estimates based on data points of n − r and n − l participants, respectively. This is a relatively conservative approach for calculating the degrees of freedom, which can help control the type I error rate. This feature can be beneficial, especially given the "replication crisis" in psychological and behavioral research.*</span>
<span id="cb568-333"><a href="#cb568-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-336"><a href="#cb568-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-337"><a href="#cb568-337" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED T TESTS</span></span>
<span id="cb568-338"><a href="#cb568-338" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DACF) <span class="co">#tests for data with floor and ceiling </span></span>
<span id="cb568-339"><a href="#cb568-339" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.rdocumentation.org/packages/DACF/versions/1.0.0</span></span>
<span id="cb568-340"><a href="#cb568-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-341"><a href="#cb568-341" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare data [vector of scores for each group]</span></span>
<span id="cb568-342"><a href="#cb568-342" aria-hidden="true" tabindex="-1"></a>score_111 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test_score) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb568-343"><a href="#cb568-343" aria-hidden="true" tabindex="-1"></a>score_121 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"impasse"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test_score) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb568-344"><a href="#cb568-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-345"><a href="#cb568-345" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb568-346"><a href="#cb568-346" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_111) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb568-347"><a href="#cb568-347" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb568-348"><a href="#cb568-348" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_121) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb568-349"><a href="#cb568-349" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(<span class="st">"control"</span><span class="ot">=</span>a ,<span class="st">"impasse"</span><span class="ot">=</span>b))</span>
<span id="cb568-350"><a href="#cb568-350" aria-hidden="true" tabindex="-1"></a>r</span>
<span id="cb568-351"><a href="#cb568-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-352"><a href="#cb568-352" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb568-353"><a href="#cb568-353" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb568-354"><a href="#cb568-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-355"><a href="#cb568-355" aria-hidden="true" tabindex="-1"></a><span class="co"># perform adjusted t test</span></span>
<span id="cb568-356"><a href="#cb568-356" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.t.test</span>(score_111,score_121,<span class="st">"b"</span>)</span>
<span id="cb568-357"><a href="#cb568-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-358"><a href="#cb568-358" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED F* </span><span class="al">TEST</span><span class="co"> ANOVA</span></span>
<span id="cb568-359"><a href="#cb568-359" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.f.star</span>(df,test_score<span class="sc">~</span>condition,<span class="st">"b"</span>)</span>
<span id="cb568-360"><a href="#cb568-360" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb568-361"><a href="#cb568-361" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb568-362"><a href="#cb568-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-363"><a href="#cb568-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-364"><a href="#cb568-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-365"><a href="#cb568-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-366"><a href="#cb568-366" aria-hidden="true" tabindex="-1"></a>*The control condition has 11% of data at ceiling and 71% at floor, with corrected mean of -7 and variance of 207. The impasse condition has 17% at ceiling, and only 42% at floor, with with corrected mean of 2.39 and variance respectively as of 58.*</span>
<span id="cb568-367"><a href="#cb568-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-368"><a href="#cb568-368" aria-hidden="true" tabindex="-1"></a>*A corrected t-test t statistic is -4.94, p = 0.05. The estimated Cohen's d is -0.89 with a confidence interval 0f \[-14.22, -5.97\].*</span>
<span id="cb568-369"><a href="#cb568-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-370"><a href="#cb568-370" aria-hidden="true" tabindex="-1"></a>*A correct F-test (ANOVA) has a corrected F-statstic of 5.85, p \&lt; 0.05, and Fsquared effect size of 0.195*</span>
<span id="cb568-371"><a href="#cb568-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-372"><a href="#cb568-372" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Regression</span></span>
<span id="cb568-373"><a href="#cb568-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-374"><a href="#cb568-374" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes homogeneity of variance</span>
<span id="cb568-375"><a href="#cb568-375" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed residuals</span>
<span id="cb568-376"><a href="#cb568-376" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>when default dummy coding is used;</span>
<span id="cb568-377"><a href="#cb568-377" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>intercept = predicted mean of first group,</span>
<span id="cb568-378"><a href="#cb568-378" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>predictor coefficient = difference to mean of second group</span>
<span id="cb568-379"><a href="#cb568-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-382"><a href="#cb568-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-383"><a href="#cb568-383" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION</span></span>
<span id="cb568-384"><a href="#cb568-384" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb568-385"><a href="#cb568-385" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb568-386"><a href="#cb568-386" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm<span class="fl">.1</span>)</span>
<span id="cb568-387"><a href="#cb568-387" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb568-388"><a href="#cb568-388" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span>
<span id="cb568-389"><a href="#cb568-389" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb568-390"><a href="#cb568-390" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm<span class="fl">.1</span>)</span>
<span id="cb568-391"><a href="#cb568-391" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(lm<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb568-392"><a href="#cb568-392" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm<span class="fl">.1</span>)</span>
<span id="cb568-393"><a href="#cb568-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-394"><a href="#cb568-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-397"><a href="#cb568-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-398"><a href="#cb568-398" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PLOT-MODEL-COEFSS-GGDIST</span></span>
<span id="cb568-399"><a href="#cb568-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-400"><a href="#cb568-400" aria-hidden="true" tabindex="-1"></a><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span></span>
<span id="cb568-401"><a href="#cb568-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-402"><a href="#cb568-402" aria-hidden="true" tabindex="-1"></a><span class="co">#setup references</span></span>
<span id="cb568-403"><a href="#cb568-403" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> lm<span class="fl">.1</span></span>
<span id="cb568-404"><a href="#cb568-404" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df</span>
<span id="cb568-405"><a href="#cb568-405" aria-hidden="true" tabindex="-1"></a>call <span class="ot">&lt;-</span> m<span class="sc">$</span>call <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()</span>
<span id="cb568-406"><a href="#cb568-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-407"><a href="#cb568-407" aria-hidden="true" tabindex="-1"></a><span class="co"># uncertainty model visualization</span></span>
<span id="cb568-408"><a href="#cb568-408" aria-hidden="true" tabindex="-1"></a>df  <span class="sc">%&gt;%</span></span>
<span id="cb568-409"><a href="#cb568-409" aria-hidden="true" tabindex="-1"></a>  modelr<span class="sc">::</span><span class="fu">data_grid</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb568-410"><a href="#cb568-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(lm<span class="fl">.1</span>, <span class="at">newdata =</span> ., <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb568-411"><a href="#cb568-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> condition, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb568-412"><a href="#cb568-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>( <span class="at">scale =</span> .<span class="dv">5</span>,</span>
<span id="cb568-413"><a href="#cb568-413" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb568-414"><a href="#cb568-414" aria-hidden="true" tabindex="-1"></a>        <span class="at">xdist =</span> <span class="fu">dist_student_t</span>(<span class="at">df =</span> <span class="fu">df.residual</span>(m), <span class="at">mu =</span> .fitted, <span class="at">sigma =</span> .se.fit),</span>
<span id="cb568-415"><a href="#cb568-415" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">stat</span>(<span class="fu">cut_cdf_qi</span>(cdf,</span>
<span id="cb568-416"><a href="#cb568-416" aria-hidden="true" tabindex="-1"></a>                <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">95</span>),</span>
<span id="cb568-417"><a href="#cb568-417" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())))) <span class="sc">+</span></span>
<span id="cb568-418"><a href="#cb568-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb568-419"><a href="#cb568-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"(LAB) Test Phase Accuracy ~ Condition"</span>,</span>
<span id="cb568-420"><a href="#cb568-420" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"model predicted mean (% correct)"</span>, <span class="at">y =</span> <span class="st">"Condition"</span>, <span class="at">fill =</span> <span class="st">"Interval"</span>,</span>
<span id="cb568-421"><a href="#cb568-421" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"lm("</span>,call[<span class="dv">2</span>],<span class="st">")"</span>)</span>
<span id="cb568-422"><a href="#cb568-422" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb568-423"><a href="#cb568-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-424"><a href="#cb568-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-425"><a href="#cb568-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-428"><a href="#cb568-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-429"><a href="#cb568-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PLOT-MODEL-PRED-SJPLOT</span></span>
<span id="cb568-430"><a href="#cb568-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-431"><a href="#cb568-431" aria-hidden="true" tabindex="-1"></a><span class="co">#sjPlot</span></span>
<span id="cb568-432"><a href="#cb568-432" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(lm<span class="fl">.1</span>,  <span class="at">type =</span> <span class="st">"eff"</span>, </span>
<span id="cb568-433"><a href="#cb568-433" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.data =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="cn">TRUE</span>,</span>
<span id="cb568-434"><a href="#cb568-434" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p =</span> <span class="cn">TRUE</span>) </span>
<span id="cb568-435"><a href="#cb568-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-436"><a href="#cb568-436" aria-hidden="true" tabindex="-1"></a><span class="co">#BS TO MANUALLY ADD REGRESSION FORMULA AS SUBTITLE </span></span>
<span id="cb568-437"><a href="#cb568-437" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic)</span></span>
<span id="cb568-438"><a href="#cb568-438" aria-hidden="true" tabindex="-1"></a><span class="co"># library(latex2exp)</span></span>
<span id="cb568-439"><a href="#cb568-439" aria-hidden="true" tabindex="-1"></a><span class="co"># (x &lt;- extract_eq(lm.1, use_coefs = TRUE, ital_vars=TRUE, coef_digits = 1, raw_tex = FALSE))</span></span>
<span id="cb568-440"><a href="#cb568-440" aria-hidden="true" tabindex="-1"></a><span class="co"># b = TeX(x)</span></span>
<span id="cb568-441"><a href="#cb568-441" aria-hidden="true" tabindex="-1"></a><span class="co"># p1[["condition"]][["labels"]][["subtitle"]]= expression( paste(widehat(accuracy), " = ", 1.7, " + ", "1.6", "*", condition[impasse]) )</span></span>
<span id="cb568-442"><a href="#cb568-442" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb568-443"><a href="#cb568-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-444"><a href="#cb568-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-445"><a href="#cb568-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-446"><a href="#cb568-446" aria-hidden="true" tabindex="-1"></a><span class="fu">### Censored (Tobit) Regression</span></span>
<span id="cb568-447"><a href="#cb568-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-448"><a href="#cb568-448" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/tobit-models/&gt;</span></span>
<span id="cb568-449"><a href="#cb568-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-450"><a href="#cb568-450" aria-hidden="true" tabindex="-1"></a>**For censored data (i.e. truncated axis).** The tobit model, also called a censored regression model, is designed to estimate linear relationships between variables when there is either left- or right-censoring in the dependent variable (also known as censoring from below and above, respectively). Censoring from above takes place when cases with a value at or above some threshold, all take on the value of that threshold, so that the true value might be equal to the threshold, but it might also be higher. In the case of censoring from below, values those that fall at or below some threshold are censored.</span>
<span id="cb568-451"><a href="#cb568-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-452"><a href="#cb568-452" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>censored vs truncated : There is sometimes confusion about the difference between truncated data and censored data.</span>
<span id="cb568-453"><a href="#cb568-453" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With censored variables, all of the observations are in the dataset, but we don't know the "true" values of some of them.</span>
<span id="cb568-454"><a href="#cb568-454" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With truncation some of the observations are not included in the analysis because of the value of the variable.</span>
<span id="cb568-455"><a href="#cb568-455" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When a variable is censored, regression models for truncated data provide inconsistent estimates of the parameters. See Long (1997, chapter 7) for a more detailed discussion of problems of using regression models for truncated data to analyze censored data.</span>
<span id="cb568-456"><a href="#cb568-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-459"><a href="#cb568-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-460"><a href="#cb568-460" aria-hidden="true" tabindex="-1"></a><span class="co">#set censoring values </span></span>
<span id="cb568-461"><a href="#cb568-461" aria-hidden="true" tabindex="-1"></a>lo <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb568-462"><a href="#cb568-462" aria-hidden="true" tabindex="-1"></a>hi <span class="ot">=</span> <span class="dv">8</span> </span>
<span id="cb568-463"><a href="#cb568-463" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(df<span class="sc">$</span>test_score)</span>
<span id="cb568-464"><a href="#cb568-464" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Lo and Hi should equate to upper and lower bounds of the # Qs "</span>)</span>
<span id="cb568-465"><a href="#cb568-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-466"><a href="#cb568-466" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb568-467"><a href="#cb568-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-468"><a href="#cb568-468" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb568-469"><a href="#cb568-469" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span> <span class="fu">vglm</span>(test_score <span class="sc">~</span> condition, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span>hi ), <span class="at">data =</span> df)</span>
<span id="cb568-470"><a href="#cb568-470" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb568-471"><a href="#cb568-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-472"><a href="#cb568-472" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb568-473"><a href="#cb568-473" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb568-474"><a href="#cb568-474" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m1)))</span>
<span id="cb568-475"><a href="#cb568-475" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb568-476"><a href="#cb568-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-477"><a href="#cb568-477" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb568-478"><a href="#cb568-478" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb568-479"><a href="#cb568-479" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(test_score <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span> hi), <span class="at">data =</span> df)</span>
<span id="cb568-480"><a href="#cb568-480" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(m1) <span class="sc">-</span> <span class="fu">logLik</span>(m0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb568-481"><a href="#cb568-481" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb568-482"><a href="#cb568-482" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m0,m1)</span>
<span id="cb568-483"><a href="#cb568-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-484"><a href="#cb568-484" aria-hidden="true" tabindex="-1"></a><span class="co">#DIAGNOSTICS</span></span>
<span id="cb568-485"><a href="#cb568-485" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1)</span>
<span id="cb568-486"><a href="#cb568-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-487"><a href="#cb568-487" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m1)[,<span class="dv">1</span>]</span>
<span id="cb568-488"><a href="#cb568-488" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rr <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb568-489"><a href="#cb568-489" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rp <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"pearson"</span>)[,<span class="dv">1</span>]</span>
<span id="cb568-490"><a href="#cb568-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-491"><a href="#cb568-491" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb568-492"><a href="#cb568-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-493"><a href="#cb568-493" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df, {</span>
<span id="cb568-494"><a href="#cb568-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rr, <span class="at">main =</span> <span class="st">"Fitted vs Residuals"</span>)</span>
<span id="cb568-495"><a href="#cb568-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rr)</span>
<span id="cb568-496"><a href="#cb568-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rp, <span class="at">main =</span> <span class="st">"Fitted vs Pearson Residuals"</span>)</span>
<span id="cb568-497"><a href="#cb568-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rp)</span>
<span id="cb568-498"><a href="#cb568-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_score, rp, <span class="at">main =</span> <span class="st">"Actual vs Pearson Residuals"</span>)</span>
<span id="cb568-499"><a href="#cb568-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_score, yhat, <span class="at">main =</span> <span class="st">"Actual vs Fitted"</span>)</span>
<span id="cb568-500"><a href="#cb568-500" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb568-501"><a href="#cb568-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-502"><a href="#cb568-502" aria-hidden="true" tabindex="-1"></a><span class="co">#VARIANCE ACCOUNTED FOR</span></span>
<span id="cb568-503"><a href="#cb568-503" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"VARIANCE ACCOUNTED FOR"</span>)</span>
<span id="cb568-504"><a href="#cb568-504" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation</span></span>
<span id="cb568-505"><a href="#cb568-505" aria-hidden="true" tabindex="-1"></a>(r <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">cor</span>(yhat, test_score)))</span>
<span id="cb568-506"><a href="#cb568-506" aria-hidden="true" tabindex="-1"></a><span class="co"># variance accounted for</span></span>
<span id="cb568-507"><a href="#cb568-507" aria-hidden="true" tabindex="-1"></a>r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb568-508"><a href="#cb568-508" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb568-509"><a href="#cb568-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-510"><a href="#cb568-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-511"><a href="#cb568-511" aria-hidden="true" tabindex="-1"></a><span class="co">#NOTE: censReg package also does Tobit regression [including mixed models]</span></span>
<span id="cb568-512"><a href="#cb568-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-513"><a href="#cb568-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-514"><a href="#cb568-514" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient labeled "(Intercept):1" is the intercept or constant for the model.</span>
<span id="cb568-515"><a href="#cb568-515" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient labeled "(Intercept):2" is an ancillary statistic. If we exponentiate this value, we get a statistic that is analogous to the square root of the residual variance in OLS regression. logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</span>
<span id="cb568-516"><a href="#cb568-516" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The predicted value of test_phase_score is 5.75 points *higher* for students in the impasse condition than for students in the control condition. (72% improvement in score!)</span>
<span id="cb568-517"><a href="#cb568-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-518"><a href="#cb568-518" aria-hidden="true" tabindex="-1"></a>**Using censReg package** - https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf</span>
<span id="cb568-519"><a href="#cb568-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-522"><a href="#cb568-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-523"><a href="#cb568-523" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censReg) <span class="co">#censored regression</span></span>
<span id="cb568-524"><a href="#cb568-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-525"><a href="#cb568-525" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb568-526"><a href="#cb568-526" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( test_score <span class="sc">~</span> condition, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb568-527"><a href="#cb568-527" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(c1)</span>
<span id="cb568-528"><a href="#cb568-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-529"><a href="#cb568-529" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb568-530"><a href="#cb568-530" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(c1)</span>
<span id="cb568-531"><a href="#cb568-531" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(c1)))</span>
<span id="cb568-532"><a href="#cb568-532" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb568-533"><a href="#cb568-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-534"><a href="#cb568-534" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb568-535"><a href="#cb568-535" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb568-536"><a href="#cb568-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-537"><a href="#cb568-537" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( test_score <span class="sc">~</span> <span class="dv">1</span>, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb568-538"><a href="#cb568-538" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(c1) <span class="sc">-</span> <span class="fu">logLik</span>(c0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb568-539"><a href="#cb568-539" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb568-540"><a href="#cb568-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-541"><a href="#cb568-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-542"><a href="#cb568-542" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(c1)</span>
<span id="cb568-543"><a href="#cb568-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-544"><a href="#cb568-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-545"><a href="#cb568-545" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</span>
<span id="cb568-546"><a href="#cb568-546" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>output should match that of VGAM</span>
<span id="cb568-547"><a href="#cb568-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-548"><a href="#cb568-548" aria-hidden="true" tabindex="-1"></a><span class="fu">## COUNT OUTCOME</span></span>
<span id="cb568-549"><a href="#cb568-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-550"><a href="#cb568-550" aria-hidden="true" tabindex="-1"></a>**Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?\</span>
<span id="cb568-551"><a href="#cb568-551" aria-hidden="true" tabindex="-1"></a>(# questions correct on test phase of task, <span class="sc">\[</span>in lab<span class="sc">\]</span> participants)**</span>
<span id="cb568-552"><a href="#cb568-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-553"><a href="#cb568-553" aria-hidden="true" tabindex="-1"></a>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can try considering it a type of *count*, (i.e. count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function). Note that the process of answering questions on a test do not seem to strictly match the assumptions of a Poisson process.</span>
<span id="cb568-554"><a href="#cb568-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-557"><a href="#cb568-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-558"><a href="#cb568-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-COUNT-TESTSCORE</span></span>
<span id="cb568-559"><a href="#cb568-559" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb568-560"><a href="#cb568-560" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb568-561"><a href="#cb568-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-562"><a href="#cb568-562" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::SETUP DATA</span></span>
<span id="cb568-563"><a href="#cb568-563" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb568-564"><a href="#cb568-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-565"><a href="#cb568-565" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb568-566"><a href="#cb568-566" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb568-567"><a href="#cb568-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-568"><a href="#cb568-568" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb568-569"><a href="#cb568-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-570"><a href="#cb568-570" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | FACETED HISTOGRAM</span></span>
<span id="cb568-571"><a href="#cb568-571" aria-hidden="true" tabindex="-1"></a><span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span></span>
<span id="cb568-572"><a href="#cb568-572" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~item_test_NABS, </span></span>
<span id="cb568-573"><a href="#cb568-573" aria-hidden="true" tabindex="-1"></a><span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span></span>
<span id="cb568-574"><a href="#cb568-574" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span></span>
<span id="cb568-575"><a href="#cb568-575" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span></span>
<span id="cb568-576"><a href="#cb568-576" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "# Correct",</span></span>
<span id="cb568-577"><a href="#cb568-577" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "proportion of subjects",</span></span>
<span id="cb568-578"><a href="#cb568-578" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span></span>
<span id="cb568-579"><a href="#cb568-579" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "") + theme(legend.position = "blank")</span></span>
<span id="cb568-580"><a href="#cb568-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-581"><a href="#cb568-581" aria-hidden="true" tabindex="-1"></a><span class="do">##GGPUBR | HIST+DENSITY SCORE </span></span>
<span id="cb568-582"><a href="#cb568-582" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">gghistogram</span>(df, <span class="at">x =</span> <span class="st">"test_score"</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb568-583"><a href="#cb568-583" aria-hidden="true" tabindex="-1"></a>   <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb568-584"><a href="#cb568-584" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill =</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span></span>
<span id="cb568-585"><a href="#cb568-585" aria-hidden="true" tabindex="-1"></a>   <span class="at">add_density =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-586"><a href="#cb568-586" aria-hidden="true" tabindex="-1"></a><span class="fu">facet</span>(p, <span class="at">facet.by=</span><span class="fu">c</span>(<span class="st">"condition"</span>)) <span class="sc">+</span></span>
<span id="cb568-587"><a href="#cb568-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score"</span>,</span>
<span id="cb568-588"><a href="#cb568-588" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,</span>
<span id="cb568-589"><a href="#cb568-589" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, <span class="at">y =</span> <span class="st">"number of subjects"</span>) <span class="sc">+</span></span>
<span id="cb568-590"><a href="#cb568-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb568-591"><a href="#cb568-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-592"><a href="#cb568-592" aria-hidden="true" tabindex="-1"></a><span class="do">##VERTICAL RAINCLOUD USING GGDISTR</span></span>
<span id="cb568-593"><a href="#cb568-593" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> test_score,</span>
<span id="cb568-594"><a href="#cb568-594" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> condition) ) <span class="sc">+</span> </span>
<span id="cb568-595"><a href="#cb568-595" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb568-596"><a href="#cb568-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>,</span>
<span id="cb568-597"><a href="#cb568-597" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb568-598"><a href="#cb568-598" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>, </span>
<span id="cb568-599"><a href="#cb568-599" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb568-600"><a href="#cb568-600" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span> </span>
<span id="cb568-601"><a href="#cb568-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb568-602"><a href="#cb568-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb568-603"><a href="#cb568-603" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score),</span>
<span id="cb568-604"><a href="#cb568-604" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb568-605"><a href="#cb568-605" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb568-606"><a href="#cb568-606" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb568-607"><a href="#cb568-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb568-608"><a href="#cb568-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb568-609"><a href="#cb568-609" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score, <span class="at">color =</span> condition),</span>
<span id="cb568-610"><a href="#cb568-610" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.3</span>,</span>
<span id="cb568-611"><a href="#cb568-611" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb568-612"><a href="#cb568-612" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>( </span>
<span id="cb568-613"><a href="#cb568-613" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">05</span></span>
<span id="cb568-614"><a href="#cb568-614" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">labs</span>( </span>
<span id="cb568-615"><a href="#cb568-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score "</span>,</span>
<span id="cb568-616"><a href="#cb568-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>) <span class="sc">+</span></span>
<span id="cb568-617"><a href="#cb568-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) <span class="sc">+</span> </span>
<span id="cb568-618"><a href="#cb568-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>), <span class="at">clip =</span> <span class="st">"off"</span>)</span>
<span id="cb568-619"><a href="#cb568-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-620"><a href="#cb568-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-621"><a href="#cb568-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-622"><a href="#cb568-622" aria-hidden="true" tabindex="-1"></a><span class="fu">### Poisson Regression</span></span>
<span id="cb568-623"><a href="#cb568-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-624"><a href="#cb568-624" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/poisson-regression/&gt;</span>\</span>
<span id="cb568-625"><a href="#cb568-625" aria-hidden="true" tabindex="-1"></a>*General Linear model using the Poisson distribution*</span>
<span id="cb568-626"><a href="#cb568-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-629"><a href="#cb568-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-630"><a href="#cb568-630" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span></span>
<span id="cb568-631"><a href="#cb568-631" aria-hidden="true" tabindex="-1"></a>p<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb568-632"><a href="#cb568-632" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb568-633"><a href="#cb568-633" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(p<span class="fl">.1</span>)</span>
<span id="cb568-634"><a href="#cb568-634" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb568-635"><a href="#cb568-635" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(p<span class="fl">.1</span>)</span>
<span id="cb568-636"><a href="#cb568-636" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb568-637"><a href="#cb568-637" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(p<span class="fl">.1</span>)</span>
<span id="cb568-638"><a href="#cb568-638" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(p<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb568-639"><a href="#cb568-639" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(p<span class="fl">.1</span>)</span>
<span id="cb568-640"><a href="#cb568-640" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(p<span class="fl">.1</span>)</span>
<span id="cb568-641"><a href="#cb568-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-642"><a href="#cb568-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-643"><a href="#cb568-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-644"><a href="#cb568-644" aria-hidden="true" tabindex="-1"></a>*The variable condition has a coefficient of 0.67, (p \&lt; 0.005). This means that for the impasse condition, the expected log count \# of questions increases by 0.67. By exponentiating the estimate we see that \# question correct rate for the impasse condition is 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.*</span>
<span id="cb568-645"><a href="#cb568-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-646"><a href="#cb568-646" aria-hidden="true" tabindex="-1"></a><span class="fu">### Negative Binomial Regression</span></span>
<span id="cb568-647"><a href="#cb568-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-648"><a href="#cb568-648" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/&gt;</span> -*overdispersed count data (variance much greater than mean)*</span>
<span id="cb568-649"><a href="#cb568-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-650"><a href="#cb568-650" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>similar to Poisson regression, but using the negative binomial distribution, which can better account for 'overdispersed' data where variance is much greater than the mean</span>
<span id="cb568-651"><a href="#cb568-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-654"><a href="#cb568-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-655"><a href="#cb568-655" aria-hidden="true" tabindex="-1"></a><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span></span>
<span id="cb568-656"><a href="#cb568-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-657"><a href="#cb568-657" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb568-658"><a href="#cb568-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-659"><a href="#cb568-659" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model </span></span>
<span id="cb568-660"><a href="#cb568-660" aria-hidden="true" tabindex="-1"></a>nb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb568-661"><a href="#cb568-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-662"><a href="#cb568-662" aria-hidden="true" tabindex="-1"></a><span class="co">#check overdispersion need </span></span>
<span id="cb568-663"><a href="#cb568-663" aria-hidden="true" tabindex="-1"></a><span class="co">#assumes conditional means are not equal to conditional variances</span></span>
<span id="cb568-664"><a href="#cb568-664" aria-hidden="true" tabindex="-1"></a><span class="co">#conduct likelihood ration test to compare and test [need poisson]</span></span>
<span id="cb568-665"><a href="#cb568-665" aria-hidden="true" tabindex="-1"></a>m.t <span class="ot">&lt;-</span> <span class="fu">glm</span>(test_score <span class="sc">~</span> condition, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> df)</span>
<span id="cb568-666"><a href="#cb568-666" aria-hidden="true" tabindex="-1"></a><span class="co">#pchisq(2 * (logLik(nb.1) - logLik(m.t)), df = 1, lower.tail = FALSE)</span></span>
<span id="cb568-667"><a href="#cb568-667" aria-hidden="true" tabindex="-1"></a><span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span></span>
<span id="cb568-668"><a href="#cb568-668" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.t, nb<span class="fl">.1</span>)</span>
<span id="cb568-669"><a href="#cb568-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-670"><a href="#cb568-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-671"><a href="#cb568-671" aria-hidden="true" tabindex="-1"></a><span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb568-672"><a href="#cb568-672" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Estimate =</span> <span class="fu">coef</span>(nb<span class="fl">.1</span>), <span class="fu">confint</span>(nb<span class="fl">.1</span>))</span>
<span id="cb568-673"><a href="#cb568-673" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate parameter estimates</span></span>
<span id="cb568-674"><a href="#cb568-674" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Exponentiated Estimates"</span>)</span>
<span id="cb568-675"><a href="#cb568-675" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(est)</span>
<span id="cb568-676"><a href="#cb568-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-677"><a href="#cb568-677" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb<span class="fl">.1</span>)</span>
<span id="cb568-678"><a href="#cb568-678" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(nb<span class="fl">.1</span>)</span>
<span id="cb568-679"><a href="#cb568-679" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(nb<span class="fl">.1</span>)</span>
<span id="cb568-680"><a href="#cb568-680" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(nb<span class="fl">.1</span>)</span>
<span id="cb568-681"><a href="#cb568-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-682"><a href="#cb568-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-683"><a href="#cb568-683" aria-hidden="true" tabindex="-1"></a>*The variable condition has a coefficient of 0.67, (p \&lt; 0.005). This means that for the impasse condition, the expected log count \# of questions increases by 0.67. By exponentiating the estimate we see that \# question correct rate for the impasse condition is nearly 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.*</span>
<span id="cb568-684"><a href="#cb568-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-687"><a href="#cb568-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-688"><a href="#cb568-688" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE POISSON AND NEGATIVE BINOMIAL</span></span>
<span id="cb568-689"><a href="#cb568-689" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(p<span class="fl">.1</span>, nb<span class="fl">.1</span>)</span>
<span id="cb568-690"><a href="#cb568-690" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(p<span class="fl">.1</span>, nb<span class="fl">.1</span>)</span>
<span id="cb568-691"><a href="#cb568-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-692"><a href="#cb568-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-693"><a href="#cb568-693" aria-hidden="true" tabindex="-1"></a>*AIC, Pseudo-R2 and a likelihood ratio test indicate that the negative binomial regression model are a better fit for the distribution of test-phase scores.*</span>
<span id="cb568-694"><a href="#cb568-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-695"><a href="#cb568-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXTURE MODELS</span></span>
<span id="cb568-696"><a href="#cb568-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-697"><a href="#cb568-697" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zero Inflated Poisson</span></span>
<span id="cb568-698"><a href="#cb568-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-699"><a href="#cb568-699" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/zip/&gt;</span>\</span>
<span id="cb568-700"><a href="#cb568-700" aria-hidden="true" tabindex="-1"></a>*A Poisson count process with excess zeros*</span>
<span id="cb568-701"><a href="#cb568-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-702"><a href="#cb568-702" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Zero-Inflated model allows specification of two models (a mixture) where *some* of the zeros are included in the DGP for the Poisson model, while only the 'excess' zeros are included in the DGP for the Binomial model <span class="sc">\[</span>the zero-inflated part<span class="sc">\]</span></span>
<span id="cb568-703"><a href="#cb568-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The model includes:</span>
<span id="cb568-704"><a href="#cb568-704" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A logistic model to model which of the two processes the zero outcome is associated with</span>
<span id="cb568-705"><a href="#cb568-705" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A poisson model to model the count process</span>
<span id="cb568-706"><a href="#cb568-706" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can specify different predictors for each part of the model</span>
<span id="cb568-707"><a href="#cb568-707" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>predictors after the \| are for the binomial zero-inflated part of the model, while those infront are for the poisson process</span>
<span id="cb568-708"><a href="#cb568-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-711"><a href="#cb568-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-712"><a href="#cb568-712" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED POISSON</span></span>
<span id="cb568-713"><a href="#cb568-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-714"><a href="#cb568-714" aria-hidden="true" tabindex="-1"></a>zinfp<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(test_score <span class="sc">~</span>  condition<span class="sc">|</span> condition , <span class="at">data =</span> df)</span>
<span id="cb568-715"><a href="#cb568-715" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb568-716"><a href="#cb568-716" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb568-717"><a href="#cb568-717" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb568-718"><a href="#cb568-718" aria-hidden="true" tabindex="-1"></a><span class="co">#check_model(zinfp.1)</span></span>
<span id="cb568-719"><a href="#cb568-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-720"><a href="#cb568-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-721"><a href="#cb568-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-722"><a href="#cb568-722" aria-hidden="true" tabindex="-1"></a>*In the count model, the coefficient for the condition is not significant.*</span>
<span id="cb568-723"><a href="#cb568-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-724"><a href="#cb568-724" aria-hidden="true" tabindex="-1"></a>*In the zero-inflation model, the coefficient for the condition variable is -1.23 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.23 if you are in the impasse condition*</span>
<span id="cb568-725"><a href="#cb568-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-726"><a href="#cb568-726" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zero Inflated Negative Binomial Regression</span></span>
<span id="cb568-727"><a href="#cb568-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-728"><a href="#cb568-728" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/zinb/&gt;</span>\</span>
<span id="cb568-729"><a href="#cb568-729" aria-hidden="true" tabindex="-1"></a>*count data that are overdispersed and have excess zeros*</span>
<span id="cb568-730"><a href="#cb568-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-731"><a href="#cb568-731" aria-hidden="true" tabindex="-1"></a>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the *excess* zeros can be modelled independently.</span>
<span id="cb568-732"><a href="#cb568-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-733"><a href="#cb568-733" aria-hidden="true" tabindex="-1"></a>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different 'process' ... (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) <span class="sc">\&lt;</span>- this could maybe be disentangled by first question latency?</span>
<span id="cb568-734"><a href="#cb568-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-735"><a href="#cb568-735" aria-hidden="true" tabindex="-1"></a>The model includes:</span>
<span id="cb568-736"><a href="#cb568-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-737"><a href="#cb568-737" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A logistic model to model which of the two processes the zero outcome is associated with</span>
<span id="cb568-738"><a href="#cb568-738" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A negative binomial model to model the count process</span>
<span id="cb568-739"><a href="#cb568-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-742"><a href="#cb568-742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-743"><a href="#cb568-743" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TESTABS-ZINFNEGBINOM</span></span>
<span id="cb568-744"><a href="#cb568-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-745"><a href="#cb568-745" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#  for zeroinfl negbinomial</span></span>
<span id="cb568-746"><a href="#cb568-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-747"><a href="#cb568-747" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span></span>
<span id="cb568-748"><a href="#cb568-748" aria-hidden="true" tabindex="-1"></a>zinb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , </span>
<span id="cb568-749"><a href="#cb568-749" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> df, <span class="at">dist =</span> <span class="st">"negbin"</span>)</span>
<span id="cb568-750"><a href="#cb568-750" aria-hidden="true" tabindex="-1"></a><span class="co">#before the | is the count part, after the | is the logit model</span></span>
<span id="cb568-751"><a href="#cb568-751" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb568-752"><a href="#cb568-752" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb568-753"><a href="#cb568-753" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb568-754"><a href="#cb568-754" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb568-755"><a href="#cb568-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-756"><a href="#cb568-756" aria-hidden="true" tabindex="-1"></a><span class="co">#   rootogram(zinb.1)</span></span>
<span id="cb568-757"><a href="#cb568-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-758"><a href="#cb568-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-759"><a href="#cb568-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-760"><a href="#cb568-760" aria-hidden="true" tabindex="-1"></a><span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb568-761"><a href="#cb568-761" aria-hidden="true" tabindex="-1"></a><span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span></span>
<span id="cb568-762"><a href="#cb568-762" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate parameter estimates</span></span>
<span id="cb568-763"><a href="#cb568-763" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Exponentiated Estimates")</span></span>
<span id="cb568-764"><a href="#cb568-764" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(est)</span></span>
<span id="cb568-765"><a href="#cb568-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-766"><a href="#cb568-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-767"><a href="#cb568-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-768"><a href="#cb568-768" aria-hidden="true" tabindex="-1"></a>*In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).*</span>
<span id="cb568-769"><a href="#cb568-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-770"><a href="#cb568-770" aria-hidden="true" tabindex="-1"></a>*In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition*</span>
<span id="cb568-771"><a href="#cb568-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-774"><a href="#cb568-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-775"><a href="#cb568-775" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(zinfp<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span>
<span id="cb568-776"><a href="#cb568-776" aria-hidden="true" tabindex="-1"></a><span class="fu">test_likelihoodratio</span>(zinfp<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span>
<span id="cb568-777"><a href="#cb568-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-778"><a href="#cb568-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-779"><a href="#cb568-779" aria-hidden="true" tabindex="-1"></a>**TODO come back to this and discuss further**\</span>
<span id="cb568-780"><a href="#cb568-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-781"><a href="#cb568-781" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hurdle Model </span></span>
<span id="cb568-782"><a href="#cb568-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-783"><a href="#cb568-783" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://data.library.virginia.edu/getting-started-with-hurdle-models/&gt;</span></span>
<span id="cb568-784"><a href="#cb568-784" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.&gt;</span></span>
<span id="cb568-785"><a href="#cb568-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-786"><a href="#cb568-786" aria-hidden="true" tabindex="-1"></a>class of models for count data with both overdispersion and excess zeros;\</span>
<span id="cb568-787"><a href="#cb568-787" aria-hidden="true" tabindex="-1"></a>different from zero-inflated models where the excess zeros are theorized to arise from two *different* processes; in the hurdle model, there is a separate model for P(x=0) and a separate model for P(x!=0)</span>
<span id="cb568-788"><a href="#cb568-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-789"><a href="#cb568-789" aria-hidden="true" tabindex="-1"></a>The model includes:</span>
<span id="cb568-790"><a href="#cb568-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-791"><a href="#cb568-791" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A binary logit model to model whether the observation takes a positive count or not. (1) Does the student get *any* questions right?</span>
<span id="cb568-792"><a href="#cb568-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-793"><a href="#cb568-793" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>a truncated Poisson or Negative binomial model that only fits positive counts (2) How many questions does the student get right?</span>
<span id="cb568-794"><a href="#cb568-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-797"><a href="#cb568-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-798"><a href="#cb568-798" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zero-inf and hurdle models </span></span>
<span id="cb568-799"><a href="#cb568-799" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countreg) <span class="co">#rootogram</span></span>
<span id="cb568-800"><a href="#cb568-800" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span></span>
<span id="cb568-801"><a href="#cb568-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-802"><a href="#cb568-802" aria-hidden="true" tabindex="-1"></a><span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span></span>
<span id="cb568-803"><a href="#cb568-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-804"><a href="#cb568-804" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.1</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df,</span>
<span id="cb568-805"><a href="#cb568-805" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb568-806"><a href="#cb568-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-807"><a href="#cb568-807" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.2</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df,</span>
<span id="cb568-808"><a href="#cb568-808" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"negbin"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb568-809"><a href="#cb568-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-810"><a href="#cb568-810" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.1</span>)</span>
<span id="cb568-811"><a href="#cb568-811" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.2</span>)</span>
<span id="cb568-812"><a href="#cb568-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-813"><a href="#cb568-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-814"><a href="#cb568-814" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.1</span>)</span>
<span id="cb568-815"><a href="#cb568-815" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.2</span>)</span>
<span id="cb568-816"><a href="#cb568-816" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(h<span class="fl">.1</span>,h<span class="fl">.2</span>))</span>
<span id="cb568-817"><a href="#cb568-817" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(h<span class="fl">.1</span>, h<span class="fl">.2</span>)</span>
<span id="cb568-818"><a href="#cb568-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-819"><a href="#cb568-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-820"><a href="#cb568-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-821"><a href="#cb568-821" aria-hidden="true" tabindex="-1"></a><span class="fu">## BETA REGRESSION</span></span>
<span id="cb568-822"><a href="#cb568-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-823"><a href="#cb568-823" aria-hidden="true" tabindex="-1"></a><span class="fu">### BETA Regression </span></span>
<span id="cb568-824"><a href="#cb568-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-825"><a href="#cb568-825" aria-hidden="true" tabindex="-1"></a>Beta regression on % correct (with standard transformation for including <span class="sc">\[</span>0,1<span class="sc">\]</span>)</span>
<span id="cb568-826"><a href="#cb568-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-827"><a href="#cb568-827" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression&gt;</span></span>
<span id="cb568-828"><a href="#cb568-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-831"><a href="#cb568-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-832"><a href="#cb568-832" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb568-833"><a href="#cb568-833" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg)</span>
<span id="cb568-834"><a href="#cb568-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-835"><a href="#cb568-835" aria-hidden="true" tabindex="-1"></a><span class="co">#RESCLAE VARIABLE</span></span>
<span id="cb568-836"><a href="#cb568-836" aria-hidden="true" tabindex="-1"></a><span class="co">#beta reg can't handle 0s and 1s </span></span>
<span id="cb568-837"><a href="#cb568-837" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, DV_percent_NABS)</span>
<span id="cb568-838"><a href="#cb568-838" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(sub) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb568-839"><a href="#cb568-839" aria-hidden="true" tabindex="-1"></a>sub<span class="sc">$</span>dv_transformed <span class="ot">=</span> (sub<span class="sc">$</span>DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb568-840"><a href="#cb568-840" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb568-841"><a href="#cb568-841" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE VARIABLES</span></span>
<span id="cb568-842"><a href="#cb568-842" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(sub<span class="sc">$</span>dv_transformed)</span>
<span id="cb568-843"><a href="#cb568-843" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>dv_transformed, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> sub) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition)</span>
<span id="cb568-844"><a href="#cb568-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-845"><a href="#cb568-845" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb568-846"><a href="#cb568-846" aria-hidden="true" tabindex="-1"></a>mb <span class="ot">&lt;-</span> <span class="fu">betareg</span>(dv_transformed <span class="sc">~</span> condition, <span class="at">data =</span> sub)</span>
<span id="cb568-847"><a href="#cb568-847" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mb)</span>
<span id="cb568-848"><a href="#cb568-848" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mb)</span>
<span id="cb568-849"><a href="#cb568-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-850"><a href="#cb568-850" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-851"><a href="#cb568-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-852"><a href="#cb568-852" aria-hidden="true" tabindex="-1"></a><span class="fu">### BETA HURDLE Regression</span></span>
<span id="cb568-853"><a href="#cb568-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-854"><a href="#cb568-854" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf&gt;</span></span>
<span id="cb568-855"><a href="#cb568-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-856"><a href="#cb568-856" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MU tells if mean is different by condition</span>
<span id="cb568-857"><a href="#cb568-857" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SIGMA tells if variance is different by condition</span>
<span id="cb568-858"><a href="#cb568-858" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NU coefficient tells if condition yields different probability at floor</span>
<span id="cb568-859"><a href="#cb568-859" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAU coefficient tells if condition yields different probability at ceiling</span>
<span id="cb568-860"><a href="#cb568-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-863"><a href="#cb568-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-864"><a href="#cb568-864" aria-hidden="true" tabindex="-1"></a><span class="co">#BETA HURDLE REGRESSION EXAMPLE</span></span>
<span id="cb568-865"><a href="#cb568-865" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span>
<span id="cb568-866"><a href="#cb568-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-867"><a href="#cb568-867" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE SAMPLE DATA </span></span>
<span id="cb568-868"><a href="#cb568-868" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> </span>
<span id="cb568-869"><a href="#cb568-869" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">0.40</span> </span>
<span id="cb568-870"><a href="#cb568-870" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.60</span> </span>
<span id="cb568-871"><a href="#cb568-871" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.13</span> </span>
<span id="cb568-872"><a href="#cb568-872" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.17</span> </span>
<span id="cb568-873"><a href="#cb568-873" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> p0<span class="sc">-</span> p1</span>
<span id="cb568-874"><a href="#cb568-874" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> mu <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> sigma <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> (sigma <span class="sc">^</span> <span class="dv">2</span>) </span>
<span id="cb568-875"><a href="#cb568-875" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> mu) <span class="sc">/</span> mu</span>
<span id="cb568-876"><a href="#cb568-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-877"><a href="#cb568-877" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE DIST</span></span>
<span id="cb568-878"><a href="#cb568-878" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1839</span>) </span>
<span id="cb568-879"><a href="#cb568-879" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, a, b) </span>
<span id="cb568-880"><a href="#cb568-880" aria-hidden="true" tabindex="-1"></a>cat <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, n, <span class="at">prob =</span> <span class="fu">c</span>(p0, p2, p1), <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb568-881"><a href="#cb568-881" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb568-882"><a href="#cb568-882" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb568-883"><a href="#cb568-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-884"><a href="#cb568-884" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb568-885"><a href="#cb568-885" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y)</span>
<span id="cb568-886"><a href="#cb568-886" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>x<span class="sc">$</span>y)</span>
<span id="cb568-887"><a href="#cb568-887" aria-hidden="true" tabindex="-1"></a><span class="co">#this looks not unlike my distribution! </span></span>
<span id="cb568-888"><a href="#cb568-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-889"><a href="#cb568-889" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb568-890"><a href="#cb568-890" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb568-891"><a href="#cb568-891" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.sigma =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb568-892"><a href="#cb568-892" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.nu =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb568-893"><a href="#cb568-893" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.tau =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb568-894"><a href="#cb568-894" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">BEINF</span>() )</span>
<span id="cb568-895"><a href="#cb568-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-896"><a href="#cb568-896" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb568-897"><a href="#cb568-897" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span>
<span id="cb568-898"><a href="#cb568-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-899"><a href="#cb568-899" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb568-900"><a href="#cb568-900" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb568-901"><a href="#cb568-901" aria-hidden="true" tabindex="-1"></a>fit_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>mu.coefficients) </span>
<span id="cb568-902"><a href="#cb568-902" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,fit_mu)</span>
<span id="cb568-903"><a href="#cb568-903" aria-hidden="true" tabindex="-1"></a>fit_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb568-904"><a href="#cb568-904" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,fit_sigma)</span>
<span id="cb568-905"><a href="#cb568-905" aria-hidden="true" tabindex="-1"></a>fit_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>nu.coefficients) </span>
<span id="cb568-906"><a href="#cb568-906" aria-hidden="true" tabindex="-1"></a>fit_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>tau.coefficients) </span>
<span id="cb568-907"><a href="#cb568-907" aria-hidden="true" tabindex="-1"></a>fit_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb568-908"><a href="#cb568-908" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,fit_p0)</span>
<span id="cb568-909"><a href="#cb568-909" aria-hidden="true" tabindex="-1"></a>fit_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb568-910"><a href="#cb568-910" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,fit_p1)</span>
<span id="cb568-911"><a href="#cb568-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-912"><a href="#cb568-912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-913"><a href="#cb568-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-914"><a href="#cb568-914" aria-hidden="true" tabindex="-1"></a>**BETA HURDLE INTERPRETATION** - beta component\</span>
<span id="cb568-915"><a href="#cb568-915" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MU "location" (mean)\</span>
<span id="cb568-916"><a href="#cb568-916" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SIGMA "scale" (positively related to variance; variance = sigma.squared *mean* (1-mean)\</span>
<span id="cb568-917"><a href="#cb568-917" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rigby, Stasinopoulos, Heller, and De Bastiani (2017) "reparameterized" the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</span>
<span id="cb568-918"><a href="#cb568-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-919"><a href="#cb568-919" aria-hidden="true" tabindex="-1"></a>**ZERO-ONE HURDLE COMPONENT**\</span>
<span id="cb568-920"><a href="#cb568-920" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.\</span>
<span id="cb568-921"><a href="#cb568-921" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p0 is the probability that a case equals 0,\</span>
<span id="cb568-922"><a href="#cb568-922" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p1 is the probability that a case equals 1,\</span>
<span id="cb568-923"><a href="#cb568-923" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</span>
<span id="cb568-924"><a href="#cb568-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-927"><a href="#cb568-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-928"><a href="#cb568-928" aria-hidden="true" tabindex="-1"></a><span class="co">#MY DATA</span></span>
<span id="cb568-929"><a href="#cb568-929" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb568-930"><a href="#cb568-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-931"><a href="#cb568-931" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> <span class="dv">0</span> <span class="co">#min possible value of scale</span></span>
<span id="cb568-932"><a href="#cb568-932" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="dv">13</span> <span class="co">#max possible value of scale</span></span>
<span id="cb568-933"><a href="#cb568-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-934"><a href="#cb568-934" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#for shuffling</span></span>
<span id="cb568-935"><a href="#cb568-935" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Rescale accuracy using </span></span>
<span id="cb568-936"><a href="#cb568-936" aria-hidden="true" tabindex="-1"></a><span class="co"># recommended adjustment </span></span>
<span id="cb568-937"><a href="#cb568-937" aria-hidden="true" tabindex="-1"></a><span class="co">#rescaled = value-min/(max-min)</span></span>
<span id="cb568-938"><a href="#cb568-938" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb568-939"><a href="#cb568-939" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> s_NABS,</span>
<span id="cb568-940"><a href="#cb568-940" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_acc =</span> (accuracy<span class="sc">-</span>min)<span class="sc">/</span>(max<span class="sc">-</span>min), <span class="co">#as %</span></span>
<span id="cb568-941"><a href="#cb568-941" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_acc =</span> (accuracy <span class="sc">*</span> (<span class="fu">nrow</span>(df)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fu">nrow</span>(df)<span class="sc">/</span>max, <span class="co">#transform for no 0 and 1</span></span>
<span id="cb568-942"><a href="#cb568-942" aria-hidden="true" tabindex="-1"></a>  <span class="at">perm =</span> <span class="fu">shuffle</span>(condition),</span>
<span id="cb568-943"><a href="#cb568-943" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_rt =</span> item_scaffold_rt</span>
<span id="cb568-944"><a href="#cb568-944" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy,R_acc, T_acc, condition, perm,scaffold_rt)</span>
<span id="cb568-945"><a href="#cb568-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-946"><a href="#cb568-946" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb568-947"><a href="#cb568-947" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of accuracy"</span>)</span>
<span id="cb568-948"><a href="#cb568-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-949"><a href="#cb568-949" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb568-950"><a href="#cb568-950" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>T_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of [rescaled] accuracy"</span>)</span>
<span id="cb568-951"><a href="#cb568-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-952"><a href="#cb568-952" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>perm, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>perm) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of shuffled accuracy"</span>)</span>
<span id="cb568-953"><a href="#cb568-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-954"><a href="#cb568-954" aria-hidden="true" tabindex="-1"></a><span class="co">#SUMMARIZE SAMPLE</span></span>
<span id="cb568-955"><a href="#cb568-955" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Grand mean"</span>, <span class="fu">mean</span>(df<span class="sc">$</span>R_acc))</span>
<span id="cb568-956"><a href="#cb568-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-957"><a href="#cb568-957" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb568-958"><a href="#cb568-958" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> <span class="fu">favstats</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb568-959"><a href="#cb568-959" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb568-960"><a href="#cb568-960" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">var</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb568-961"><a href="#cb568-961" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Grand stats"</span>)</span>
<span id="cb568-962"><a href="#cb568-962" aria-hidden="true" tabindex="-1"></a>stats </span>
<span id="cb568-963"><a href="#cb568-963" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P0"</span>)</span>
<span id="cb568-964"><a href="#cb568-964" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">0</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb568-965"><a href="#cb568-965" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P1"</span>)</span>
<span id="cb568-966"><a href="#cb568-966" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">1</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb568-967"><a href="#cb568-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-968"><a href="#cb568-968" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb568-969"><a href="#cb568-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-970"><a href="#cb568-970" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb568-971"><a href="#cb568-971" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb568-972"><a href="#cb568-972" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.sigma =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb568-973"><a href="#cb568-973" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.nu =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb568-974"><a href="#cb568-974" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.tau =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb568-975"><a href="#cb568-975" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">BEINF</span>(), <span class="at">data =</span> df )</span>
<span id="cb568-976"><a href="#cb568-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-977"><a href="#cb568-977" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb568-978"><a href="#cb568-978" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb568-979"><a href="#cb568-979" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE EMPTY MODEL"</span>)</span>
<span id="cb568-980"><a href="#cb568-980" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb568-981"><a href="#cb568-981" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m0)</span>
<span id="cb568-982"><a href="#cb568-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-983"><a href="#cb568-983" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb568-984"><a href="#cb568-984" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb568-985"><a href="#cb568-985" aria-hidden="true" tabindex="-1"></a>m0_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>mu.coefficients) </span>
<span id="cb568-986"><a href="#cb568-986" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m0_mu)</span>
<span id="cb568-987"><a href="#cb568-987" aria-hidden="true" tabindex="-1"></a>m0_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb568-988"><a href="#cb568-988" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m0_sigma)</span>
<span id="cb568-989"><a href="#cb568-989" aria-hidden="true" tabindex="-1"></a>m0_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>nu.coefficients) </span>
<span id="cb568-990"><a href="#cb568-990" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m0_nu)</span>
<span id="cb568-991"><a href="#cb568-991" aria-hidden="true" tabindex="-1"></a>m0_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>tau.coefficients) </span>
<span id="cb568-992"><a href="#cb568-992" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m0_tau)</span>
<span id="cb568-993"><a href="#cb568-993" aria-hidden="true" tabindex="-1"></a>m0_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb568-994"><a href="#cb568-994" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,m0_p0)</span>
<span id="cb568-995"><a href="#cb568-995" aria-hidden="true" tabindex="-1"></a>m0_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb568-996"><a href="#cb568-996" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,m0_p1)</span>
<span id="cb568-997"><a href="#cb568-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-998"><a href="#cb568-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-999"><a href="#cb568-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1000"><a href="#cb568-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL</span></span>
<span id="cb568-1001"><a href="#cb568-1001" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, </span>
<span id="cb568-1002"><a href="#cb568-1002" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb568-1003"><a href="#cb568-1003" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE PREDICTOR MODEL"</span>)</span>
<span id="cb568-1004"><a href="#cb568-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb568-1005"><a href="#cb568-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1006"><a href="#cb568-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#LOOKING PREDICTOR MODEL</span></span>
<span id="cb568-1007"><a href="#cb568-1007" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition , </span>
<span id="cb568-1008"><a href="#cb568-1008" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb568-1009"><a href="#cb568-1009" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb568-1010"><a href="#cb568-1010" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb568-1011"><a href="#cb568-1011" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb568-1012"><a href="#cb568-1012" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE PREDICTOR MODEL"</span>)</span>
<span id="cb568-1013"><a href="#cb568-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1014"><a href="#cb568-1014" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb568-1015"><a href="#cb568-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1016"><a href="#cb568-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1017"><a href="#cb568-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION </span><span class="al">TEST</span><span class="co">]</span></span>
<span id="cb568-1018"><a href="#cb568-1018" aria-hidden="true" tabindex="-1"></a>mperm <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> perm, <span class="sc">~</span> perm, <span class="sc">~</span> perm, <span class="sc">~</span> perm, </span>
<span id="cb568-1019"><a href="#cb568-1019" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb568-1020"><a href="#cb568-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mperm)</span>
<span id="cb568-1021"><a href="#cb568-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1022"><a href="#cb568-1022" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check with scaled outcome, no zeros ones</span></span>
<span id="cb568-1023"><a href="#cb568-1023" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(T_acc <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, </span>
<span id="cb568-1024"><a href="#cb568-1024" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb568-1025"><a href="#cb568-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span>
<span id="cb568-1026"><a href="#cb568-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span></span>
<span id="cb568-1027"><a href="#cb568-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1028"><a href="#cb568-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#investigate beta negative binomial distribution</span></span>
<span id="cb568-1029"><a href="#cb568-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span></span>
<span id="cb568-1030"><a href="#cb568-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1031"><a href="#cb568-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb568-1032"><a href="#cb568-1032" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb568-1033"><a href="#cb568-1033" aria-hidden="true" tabindex="-1"></a>m1_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m1<span class="sc">$</span>mu.coefficients) </span>
<span id="cb568-1034"><a href="#cb568-1034" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m1_mu)</span>
<span id="cb568-1035"><a href="#cb568-1035" aria-hidden="true" tabindex="-1"></a>m1_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb568-1036"><a href="#cb568-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m1_sigma)</span>
<span id="cb568-1037"><a href="#cb568-1037" aria-hidden="true" tabindex="-1"></a>m1_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>nu.coefficients) </span>
<span id="cb568-1038"><a href="#cb568-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m1_nu)</span>
<span id="cb568-1039"><a href="#cb568-1039" aria-hidden="true" tabindex="-1"></a>m1_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>tau.coefficients) </span>
<span id="cb568-1040"><a href="#cb568-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m1_tau)</span>
<span id="cb568-1041"><a href="#cb568-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1042"><a href="#cb568-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb568-1043"><a href="#cb568-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span>
<span id="cb568-1044"><a href="#cb568-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1045"><a href="#cb568-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1046"><a href="#cb568-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1047"><a href="#cb568-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MU tells if mean is different by condition</span>
<span id="cb568-1048"><a href="#cb568-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SIGMA tells if variance is different by condition</span>
<span id="cb568-1049"><a href="#cb568-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NU coefficient tells if condition yields different probability at floor</span>
<span id="cb568-1050"><a href="#cb568-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAU coefficient tells if condition yields different probability at ceiling</span>
<span id="cb568-1051"><a href="#cb568-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1052"><a href="#cb568-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">## BINOMIAL OUTCOME</span></span>
<span id="cb568-1053"><a href="#cb568-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1056"><a href="#cb568-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1057"><a href="#cb568-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1-ACCURACY</span></span>
<span id="cb568-1058"><a href="#cb568-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1059"><a href="#cb568-1059" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb568-1060"><a href="#cb568-1060" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb568-1061"><a href="#cb568-1061" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% mutate(</span></span>
<span id="cb568-1062"><a href="#cb568-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = recode_factor(score_niceABS, "0" ="incorrect","1"="correct"),</span></span>
<span id="cb568-1063"><a href="#cb568-1063" aria-hidden="true" tabindex="-1"></a><span class="co">#   scaled = as.ordered(score_SCALED),</span></span>
<span id="cb568-1064"><a href="#cb568-1064" aria-hidden="true" tabindex="-1"></a><span class="co">#   q = as.factor(q),</span></span>
<span id="cb568-1065"><a href="#cb568-1065" aria-hidden="true" tabindex="-1"></a><span class="co">#   high_interpretation = as.factor(high_interpretation)</span></span>
<span id="cb568-1066"><a href="#cb568-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb568-1067"><a href="#cb568-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1068"><a href="#cb568-1068" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-1069"><a href="#cb568-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb568-1070"><a href="#cb568-1070" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df) <span class="sc">%&gt;%</span></span>
<span id="cb568-1071"><a href="#cb568-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb568-1072"><a href="#cb568-1072" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Question 1 Accuracy"</span>,</span>
<span id="cb568-1073"><a href="#cb568-1073" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Q1"</span>,</span>
<span id="cb568-1074"><a href="#cb568-1074" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb568-1075"><a href="#cb568-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1076"><a href="#cb568-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-1077"><a href="#cb568-1077" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb568-1078"><a href="#cb568-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb568-1079"><a href="#cb568-1079" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb568-1080"><a href="#cb568-1080" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb568-1081"><a href="#cb568-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb568-1082"><a href="#cb568-1082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb568-1083"><a href="#cb568-1083" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb568-1084"><a href="#cb568-1084" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb568-1085"><a href="#cb568-1085" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb568-1086"><a href="#cb568-1086" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb568-1087"><a href="#cb568-1087" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb568-1088"><a href="#cb568-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1089"><a href="#cb568-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1090"><a href="#cb568-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1091"><a href="#cb568-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHI SQUARE</span></span>
<span id="cb568-1092"><a href="#cb568-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1093"><a href="#cb568-1093" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect Q1 ACCURACY?**</span>
<span id="cb568-1094"><a href="#cb568-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1097"><a href="#cb568-1097" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1098"><a href="#cb568-1098" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>accuracy, </span>
<span id="cb568-1099"><a href="#cb568-1099" aria-hidden="true" tabindex="-1"></a>             <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-1100"><a href="#cb568-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1101"><a href="#cb568-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1104"><a href="#cb568-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1105"><a href="#cb568-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : VIS-CHISQR-Q1</span></span>
<span id="cb568-1106"><a href="#cb568-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1107"><a href="#cb568-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb568-1108"><a href="#cb568-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb568-1109"><a href="#cb568-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb568-1110"><a href="#cb568-1110" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, pretty_condition <span class="sc">~</span> accuracy, </span>
<span id="cb568-1111"><a href="#cb568-1111" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb568-1112"><a href="#cb568-1112" aria-hidden="true" tabindex="-1"></a><span class="co">#SJTABLE</span></span>
<span id="cb568-1113"><a href="#cb568-1113" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb568-1114"><a href="#cb568-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb568-1115"><a href="#cb568-1115" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb568-1116"><a href="#cb568-1116" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb568-1117"><a href="#cb568-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1118"><a href="#cb568-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::WITH STATISTICS</span></span>
<span id="cb568-1119"><a href="#cb568-1119" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> condition, <span class="at">y =</span> accuracy,</span>
<span id="cb568-1120"><a href="#cb568-1120" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span>
<span id="cb568-1121"><a href="#cb568-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1122"><a href="#cb568-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1123"><a href="#cb568-1123" aria-hidden="true" tabindex="-1"></a>**For (In Person) data collection** (n=126) the Pearson's Chi-squared test (of independence) indicates a relationship between response accuracy on the first question and experimental condition that is not significant at the alpha level 0.05, $\chi^2$ (1) = 10.3, p = 0.07. Thus we have insufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. In this particular data sample, the odds ratio (Odds Ratio = 2.18, p = 0.055, 95% CI <span class="sc">\[</span>0.982, +Inf<span class="sc">\]</span>) indicates that the odds of producing a correct response on the first question were 2.18 times greater if a subject was in the impasse condition, than in the control condition .</span>
<span id="cb568-1124"><a href="#cb568-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1125"><a href="#cb568-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">### LOGISTIC REGRESSION</span></span>
<span id="cb568-1126"><a href="#cb568-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1127"><a href="#cb568-1127" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression (at the subject-item level), predicting Q1 accuracy (absolute score) by condition.*\</span>
<span id="cb568-1128"><a href="#cb568-1128" aria-hidden="true" tabindex="-1"></a>*note: this example uses the combined dataset rather than lab-only, as learning notes were done with the combined and I don't want to recalcualte all the marginal probabilities by hand for learning purposes.*</span>
<span id="cb568-1129"><a href="#cb568-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1130"><a href="#cb568-1130" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb568-1131"><a href="#cb568-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1132"><a href="#cb568-1132" aria-hidden="true" tabindex="-1"></a>*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*</span>
<span id="cb568-1133"><a href="#cb568-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1136"><a href="#cb568-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1137"><a href="#cb568-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-Q1ACC-LOG-combined</span></span>
<span id="cb568-1138"><a href="#cb568-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb568-1139"><a href="#cb568-1139" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb568-1140"><a href="#cb568-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1141"><a href="#cb568-1141" aria-hidden="true" tabindex="-1"></a><span class="co">#combined dataset, not lab only</span></span>
<span id="cb568-1142"><a href="#cb568-1142" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb568-1143"><a href="#cb568-1143" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS)</span>
<span id="cb568-1144"><a href="#cb568-1144" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb568-1145"><a href="#cb568-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1146"><a href="#cb568-1146" aria-hidden="true" tabindex="-1"></a><span class="co"># FREQUENCY TABLE</span></span>
<span id="cb568-1147"><a href="#cb568-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span></span>
<span id="cb568-1148"><a href="#cb568-1148" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(my.table) #counts</span></span>
<span id="cb568-1149"><a href="#cb568-1149" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(prop.table(my.table)) #props</span></span>
<span id="cb568-1150"><a href="#cb568-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1151"><a href="#cb568-1151" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb568-1152"><a href="#cb568-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1153"><a href="#cb568-1153" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb568-1154"><a href="#cb568-1154" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb568-1155"><a href="#cb568-1155" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"EMPTY MODEL"</span>)</span>
<span id="cb568-1156"><a href="#cb568-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb568-1157"><a href="#cb568-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1158"><a href="#cb568-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb568-1159"><a href="#cb568-1159" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb568-1160"><a href="#cb568-1160" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb568-1161"><a href="#cb568-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb568-1162"><a href="#cb568-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1163"><a href="#cb568-1163" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb568-1164"><a href="#cb568-1164" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span>
<span id="cb568-1165"><a href="#cb568-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb568-1166"><a href="#cb568-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb568-1167"><a href="#cb568-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1168"><a href="#cb568-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1169"><a href="#cb568-1169" aria-hidden="true" tabindex="-1"></a>*The Condition predictor significantly improves model fit.*</span>
<span id="cb568-1170"><a href="#cb568-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1171"><a href="#cb568-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Learning Notes</span></span>
<span id="cb568-1172"><a href="#cb568-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1175"><a href="#cb568-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1176"><a href="#cb568-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-Q1ACC-LOG-combined</span></span>
<span id="cb568-1177"><a href="#cb568-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1178"><a href="#cb568-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb568-1179"><a href="#cb568-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1180"><a href="#cb568-1180" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb568-1181"><a href="#cb568-1181" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb568-1182"><a href="#cb568-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1183"><a href="#cb568-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb568-1184"><a href="#cb568-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1185"><a href="#cb568-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- LOG ODDS"</span>)</span>
<span id="cb568-1186"><a href="#cb568-1186" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span>
<span id="cb568-1187"><a href="#cb568-1187" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span>
<span id="cb568-1188"><a href="#cb568-1188" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(<span class="fu">confint</span>(m1))) <span class="co">#exponentiate</span></span>
<span id="cb568-1189"><a href="#cb568-1189" aria-hidden="true" tabindex="-1"></a>e</span>
<span id="cb568-1190"><a href="#cb568-1190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1191"><a href="#cb568-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1192"><a href="#cb568-1192" aria-hidden="true" tabindex="-1"></a>**Understanding the logistic regression model**</span>
<span id="cb568-1193"><a href="#cb568-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1194"><a href="#cb568-1194" aria-hidden="true" tabindex="-1"></a>*The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable*</span>
<span id="cb568-1195"><a href="#cb568-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1196"><a href="#cb568-1196" aria-hidden="true" tabindex="-1"></a>*The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.*</span>
<span id="cb568-1197"><a href="#cb568-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1198"><a href="#cb568-1198" aria-hidden="true" tabindex="-1"></a>**\[the empty model**</span>
<span id="cb568-1199"><a href="#cb568-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1200"><a href="#cb568-1200" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercept of an empty model (glm(accuracy \~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df\$accuracy ==1 ).</span>
<span id="cb568-1201"><a href="#cb568-1201" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -<span class="sc">\&gt;</span> log(0.215 / (1-0.215)) = -1.29.</span>
<span id="cb568-1202"><a href="#cb568-1202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</span>
<span id="cb568-1203"><a href="#cb568-1203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</span>
<span id="cb568-1204"><a href="#cb568-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1205"><a href="#cb568-1205" aria-hidden="true" tabindex="-1"></a>**\[a dichotomous predictor\]**</span>
<span id="cb568-1206"><a href="#cb568-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1207"><a href="#cb568-1207" aria-hidden="true" tabindex="-1"></a>natural log (odds of +) = -1.822 + 0.901(x1) ; x1 = 0 for control, 1 for impasse</span>
<span id="cb568-1208"><a href="#cb568-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1209"><a href="#cb568-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>INTERCEPT: log odds of (+ response) in control condition</span>
<span id="cb568-1210"><a href="#cb568-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</span>
<span id="cb568-1211"><a href="#cb568-1211" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating the coefficients\</span>
<span id="cb568-1212"><a href="#cb568-1212" aria-hidden="true" tabindex="-1"></a>        log odds of (+) in control = exp(-1.822) = 0.162 odds</span>
<span id="cb568-1213"><a href="#cb568-1213" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb568-1214"><a href="#cb568-1214" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139\</span>
<span id="cb568-1215"><a href="#cb568-1215" aria-hidden="true" tabindex="-1"></a>        probability of (+) in control = \~14%</span>
<span id="cb568-1216"><a href="#cb568-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs. control</span>
<span id="cb568-1217"><a href="#cb568-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</span>
<span id="cb568-1218"><a href="#cb568-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating log odds\</span>
<span id="cb568-1219"><a href="#cb568-1219" aria-hidden="true" tabindex="-1"></a>        log odds (+) in impasse = exp(-0.921) = 0.398</span>
<span id="cb568-1220"><a href="#cb568-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb568-1221"><a href="#cb568-1221" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285\</span>
<span id="cb568-1222"><a href="#cb568-1222" aria-hidden="true" tabindex="-1"></a>        probaility of (+) in impasse = \~ 29%</span>
<span id="cb568-1223"><a href="#cb568-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ODDS RATIO : exponentiated B1 COEFFICIENT</span>
<span id="cb568-1224"><a href="#cb568-1224" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = (slope of logit model = difference in log odds = log odds ratio</span>
<span id="cb568-1225"><a href="#cb568-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1226"><a href="#cb568-1226" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = 0.901 is log odds ratio of (+) in impasse vs control</span>
<span id="cb568-1227"><a href="#cb568-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1228"><a href="#cb568-1228" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>exp(b1) = exp(0.901) = 2.46</span>
<span id="cb568-1229"><a href="#cb568-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1230"><a href="#cb568-1230" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</span>
<span id="cb568-1231"><a href="#cb568-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1232"><a href="#cb568-1232" aria-hidden="true" tabindex="-1"></a>+:----------------------------------------------------------------------+</span>
<span id="cb568-1233"><a href="#cb568-1233" aria-hidden="true" tabindex="-1"></a>| MARGINAL\                                                             |</span>
<span id="cb568-1234"><a href="#cb568-1234" aria-hidden="true" tabindex="-1"></a>| total = 330 success : 71, failure : 259\                              |</span>
<span id="cb568-1235"><a href="#cb568-1235" aria-hidden="true" tabindex="-1"></a>| p(+) = 71 / 330 = 0.215 = 22%\                                        |</span>
<span id="cb568-1236"><a href="#cb568-1236" aria-hidden="true" tabindex="-1"></a>| odds(+) = 71 / 259 = 0.274                                            |</span>
<span id="cb568-1237"><a href="#cb568-1237" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb568-1238"><a href="#cb568-1238" aria-hidden="true" tabindex="-1"></a>| CONTROL total = 158 success = 22; failure = 136\                      |</span>
<span id="cb568-1239"><a href="#cb568-1239" aria-hidden="true" tabindex="-1"></a>| p(+) = 22/158 = 0.139 = 14%\                                          |</span>
<span id="cb568-1240"><a href="#cb568-1240" aria-hidden="true" tabindex="-1"></a>| odds(+) = 22/136 = 0.162                                              |</span>
<span id="cb568-1241"><a href="#cb568-1241" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb568-1242"><a href="#cb568-1242" aria-hidden="true" tabindex="-1"></a>| IMPASSE total = 172 success = 49; failure = 123\                      |</span>
<span id="cb568-1243"><a href="#cb568-1243" aria-hidden="true" tabindex="-1"></a>| p(+) = 49/172 = 0.285 = 29%\                                          |</span>
<span id="cb568-1244"><a href="#cb568-1244" aria-hidden="true" tabindex="-1"></a>| odds(+) = 49/123 = 0.398                                              |</span>
<span id="cb568-1245"><a href="#cb568-1245" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb568-1246"><a href="#cb568-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1247"><a href="#cb568-1247" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb568-1248"><a href="#cb568-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1251"><a href="#cb568-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1252"><a href="#cb568-1252" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb568-1253"><a href="#cb568-1253" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb568-1254"><a href="#cb568-1254" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb568-1255"><a href="#cb568-1255" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m1)</span>
<span id="cb568-1256"><a href="#cb568-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1257"><a href="#cb568-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span>
<span id="cb568-1258"><a href="#cb568-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb568-1259"><a href="#cb568-1259" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb568-1260"><a href="#cb568-1260" aria-hidden="true" tabindex="-1"></a>p.control <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"control"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb568-1261"><a href="#cb568-1261" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in control,"</span>, p.control)</span>
<span id="cb568-1262"><a href="#cb568-1262" aria-hidden="true" tabindex="-1"></a>p.impasse <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"impasse"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb568-1263"><a href="#cb568-1263" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in impasse,"</span>, p.impasse)</span>
<span id="cb568-1264"><a href="#cb568-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1265"><a href="#cb568-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb568-1266"><a href="#cb568-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1267"><a href="#cb568-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb568-1268"><a href="#cb568-1268" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggstatsplot)</span></span>
<span id="cb568-1269"><a href="#cb568-1269" aria-hidden="true" tabindex="-1"></a><span class="co"># ggcoefstats(m1, output = "plot") + labs(x = "Log Odds Estimate")</span></span>
<span id="cb568-1270"><a href="#cb568-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1271"><a href="#cb568-1271" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb568-1272"><a href="#cb568-1272" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb568-1273"><a href="#cb568-1273" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb568-1274"><a href="#cb568-1274" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb568-1275"><a href="#cb568-1275" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb568-1276"><a href="#cb568-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb568-1277"><a href="#cb568-1277" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb568-1278"><a href="#cb568-1278" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb568-1279"><a href="#cb568-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1280"><a href="#cb568-1280" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb568-1281"><a href="#cb568-1281" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m1, type="pred",</span></span>
<span id="cb568-1282"><a href="#cb568-1282" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb568-1283"><a href="#cb568-1283" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb568-1284"><a href="#cb568-1284" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Predicted Probability of Accuracy",</span></span>
<span id="cb568-1285"><a href="#cb568-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb568-1286"><a href="#cb568-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1287"><a href="#cb568-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb568-1288"><a href="#cb568-1288" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb568-1289"><a href="#cb568-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">ggeffect</span>(<span class="at">model =</span> m1) <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span>
<span id="cb568-1290"><a href="#cb568-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1291"><a href="#cb568-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1292"><a href="#cb568-1292" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb568-1293"><a href="#cb568-1293" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb568-1294"><a href="#cb568-1294" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(m))</span></span>
<span id="cb568-1295"><a href="#cb568-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1296"><a href="#cb568-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1297"><a href="#cb568-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1298"><a href="#cb568-1298" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb568-1299"><a href="#cb568-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1302"><a href="#cb568-1302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1303"><a href="#cb568-1303" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span>
<span id="cb568-1304"><a href="#cb568-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(m1)</span>
<span id="cb568-1305"><a href="#cb568-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1306"><a href="#cb568-1306" aria-hidden="true" tabindex="-1"></a><span class="co"># logitgof(df$accuracy, m1$fitted.values, ord=FALSE)</span></span>
<span id="cb568-1307"><a href="#cb568-1307" aria-hidden="true" tabindex="-1"></a><span class="co"># hoslem.test(x = df$accuracy, y = fitted(m1), g =  2)</span></span>
<span id="cb568-1308"><a href="#cb568-1308" aria-hidden="true" tabindex="-1"></a><span class="co"># p should be non significant</span></span>
<span id="cb568-1309"><a href="#cb568-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1310"><a href="#cb568-1310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1311"><a href="#cb568-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1312"><a href="#cb568-1312" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb568-1313"><a href="#cb568-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1314"><a href="#cb568-1314" aria-hidden="true" tabindex="-1"></a>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the *impasse condition* increase by 146% ($e^{beta_1}$ = 2.46, 95% CI \[1.42, 4.37\]) over the *control condition*.</span>
<span id="cb568-1315"><a href="#cb568-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1316"><a href="#cb568-1316" aria-hidden="true" tabindex="-1"></a>*Equivalent statements:*</span>
<span id="cb568-1317"><a href="#cb568-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1318"><a href="#cb568-1318" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse condition increases log odds of correct response by 0.901 (over control)</span>
<span id="cb568-1319"><a href="#cb568-1319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</span>
<span id="cb568-1320"><a href="#cb568-1320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</span>
<span id="cb568-1321"><a href="#cb568-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1324"><a href="#cb568-1324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1325"><a href="#cb568-1325" aria-hidden="true" tabindex="-1"></a><span class="co">#PRETTY TABLE SJPLOT</span></span>
<span id="cb568-1326"><a href="#cb568-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1)</span>
<span id="cb568-1327"><a href="#cb568-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1328"><a href="#cb568-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1329"><a href="#cb568-1329" aria-hidden="true" tabindex="-1"></a><span class="fu">## ORDINAL OUTCOME</span></span>
<span id="cb568-1330"><a href="#cb568-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1331"><a href="#cb568-1331" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] type of response given?**</span>
<span id="cb568-1332"><a href="#cb568-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1335"><a href="#cb568-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1336"><a href="#cb568-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : SETUP-INDEPENDENT-ORDINAL</span></span>
<span id="cb568-1337"><a href="#cb568-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1338"><a href="#cb568-1338" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb568-1339"><a href="#cb568-1339" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb568-1340"><a href="#cb568-1340" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb568-1341"><a href="#cb568-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1342"><a href="#cb568-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb568-1343"><a href="#cb568-1343" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>scaled, df<span class="sc">$</span>condition))</span>
<span id="cb568-1344"><a href="#cb568-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1345"><a href="#cb568-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb568-1346"><a href="#cb568-1346" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>scaled, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb568-1347"><a href="#cb568-1347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb568-1348"><a href="#cb568-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1349"><a href="#cb568-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-1350"><a href="#cb568-1350" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb568-1351"><a href="#cb568-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb568-1352"><a href="#cb568-1352" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb568-1353"><a href="#cb568-1353" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> scaled)) <span class="sc">+</span></span>
<span id="cb568-1354"><a href="#cb568-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb568-1355"><a href="#cb568-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb568-1356"><a href="#cb568-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb568-1357"><a href="#cb568-1357" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb568-1358"><a href="#cb568-1358" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb568-1359"><a href="#cb568-1359" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb568-1360"><a href="#cb568-1360" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb568-1361"><a href="#cb568-1361" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb568-1362"><a href="#cb568-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1363"><a href="#cb568-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1364"><a href="#cb568-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1365"><a href="#cb568-1365" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] state of understanding?**</span>
<span id="cb568-1366"><a href="#cb568-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1369"><a href="#cb568-1369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1370"><a href="#cb568-1370" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : SETUP-INDEPENDENT-ORDINAL-STATE</span></span>
<span id="cb568-1371"><a href="#cb568-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1372"><a href="#cb568-1372" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb568-1373"><a href="#cb568-1373" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb568-1374"><a href="#cb568-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb568-1375"><a href="#cb568-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1376"><a href="#cb568-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb568-1377"><a href="#cb568-1377" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition))</span>
<span id="cb568-1378"><a href="#cb568-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1379"><a href="#cb568-1379" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb568-1380"><a href="#cb568-1380" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>state, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb568-1381"><a href="#cb568-1381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb568-1382"><a href="#cb568-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1383"><a href="#cb568-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-1384"><a href="#cb568-1384" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb568-1385"><a href="#cb568-1385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb568-1386"><a href="#cb568-1386" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb568-1387"><a href="#cb568-1387" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb568-1388"><a href="#cb568-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb568-1389"><a href="#cb568-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb568-1390"><a href="#cb568-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb568-1391"><a href="#cb568-1391" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb568-1392"><a href="#cb568-1392" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 State"</span>,</span>
<span id="cb568-1393"><a href="#cb568-1393" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb568-1394"><a href="#cb568-1394" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb568-1395"><a href="#cb568-1395" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb568-1396"><a href="#cb568-1396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1397"><a href="#cb568-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1398"><a href="#cb568-1398" aria-hidden="true" tabindex="-1"></a><span class="fu">### ORDINAL REGRESSION --- Cumulative Link; Proportional Odds</span></span>
<span id="cb568-1399"><a href="#cb568-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1400"><a href="#cb568-1400" aria-hidden="true" tabindex="-1"></a>*Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.*</span>
<span id="cb568-1401"><a href="#cb568-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1402"><a href="#cb568-1402" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/&gt;</span></span>
<span id="cb568-1403"><a href="#cb568-1403" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://journals.sagepub.com/doi/full/10.1177/2515245918823199&gt;</span></span>
<span id="cb568-1404"><a href="#cb568-1404" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>todo see ordinal regression video: <span class="ot">&lt;https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK&gt;</span></span>
<span id="cb568-1405"><a href="#cb568-1405" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://peopleanalytics-regression-book.org/ord-reg.html&gt;</span></span>
<span id="cb568-1406"><a href="#cb568-1406" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2&gt;</span></span>
<span id="cb568-1407"><a href="#cb568-1407" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf&gt;</span></span>
<span id="cb568-1408"><a href="#cb568-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1409"><a href="#cb568-1409" aria-hidden="true" tabindex="-1"></a>**Learning Notes**</span>
<span id="cb568-1410"><a href="#cb568-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1411"><a href="#cb568-1411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>proportional odds regression models effectively act as a series of stratified binomial models under the assumption that the 'slope' of the logistic function of each stratified model is the same.</span>
<span id="cb568-1412"><a href="#cb568-1412" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>thus need to verify proportional odds assumption - ordinal regression requires an **proportional odds assumption** (the same slope holds for each equation)</span>
<span id="cb568-1413"><a href="#cb568-1413" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>this is required because the model simultaneously estimates k-1 equations, but each equation has the same *slope*, with different intercepts.</span>
<span id="cb568-1414"><a href="#cb568-1414" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>conversely, a multinomial (categorical) model will have different slopes as well as intercepts - the intercepts are always ordered in size alpha 1 <span class="sc">\&lt;</span> alpha 2 <span class="sc">\&lt;</span> alpha k-1...</span>
<span id="cb568-1415"><a href="#cb568-1415" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TODO** - see difference between the three types of ordinal models (adjacent category (vs) cumulative proportions; check Agresti book</span>
<span id="cb568-1416"><a href="#cb568-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1417"><a href="#cb568-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb568-1418"><a href="#cb568-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1421"><a href="#cb568-1421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1422"><a href="#cb568-1422" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::ORDINAL REGRESSION MODELS</span></span>
<span id="cb568-1423"><a href="#cb568-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1424"><a href="#cb568-1424" aria-hidden="true" tabindex="-1"></a><span class="co">#EMPTY MODEL</span></span>
<span id="cb568-1425"><a href="#cb568-1425" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</span>)</span>
<span id="cb568-1426"><a href="#cb568-1426" aria-hidden="true" tabindex="-1"></a>om<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">clm</span>(state <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> df)</span>
<span id="cb568-1427"><a href="#cb568-1427" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(om.0)</span></span>
<span id="cb568-1428"><a href="#cb568-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1429"><a href="#cb568-1429" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICTOR MODEL</span></span>
<span id="cb568-1430"><a href="#cb568-1430" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Ordinal regression of q1 SCALED score (ordered interpretation)"</span>)</span>
<span id="cb568-1431"><a href="#cb568-1431" aria-hidden="true" tabindex="-1"></a>om <span class="ot">&lt;-</span> <span class="fu">clm</span>(state <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb568-1432"><a href="#cb568-1432" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(om)</span></span>
<span id="cb568-1433"><a href="#cb568-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1434"><a href="#cb568-1434" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE EMPTY AND PREDICTOR</span></span>
<span id="cb568-1435"><a href="#cb568-1435" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(om<span class="fl">.0</span>, om)</span>
<span id="cb568-1436"><a href="#cb568-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1437"><a href="#cb568-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1438"><a href="#cb568-1438" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: EQUIVALENT APPROACH USING POLYR </span></span>
<span id="cb568-1439"><a href="#cb568-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1440"><a href="#cb568-1440" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL</span></span>
<span id="cb568-1441"><a href="#cb568-1441" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(state <span class="sc">~</span> condition , <span class="at">data =</span> df, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb568-1442"><a href="#cb568-1442" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m)</span></span>
<span id="cb568-1443"><a href="#cb568-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1444"><a href="#cb568-1444" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate coefficients and CIs</span></span>
<span id="cb568-1445"><a href="#cb568-1445" aria-hidden="true" tabindex="-1"></a><span class="co"># (ctable &lt;- coef(summary(m)))</span></span>
<span id="cb568-1446"><a href="#cb568-1446" aria-hidden="true" tabindex="-1"></a><span class="co"># (p &lt;- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2)</span></span>
<span id="cb568-1447"><a href="#cb568-1447" aria-hidden="true" tabindex="-1"></a><span class="co"># (ctable &lt;- cbind(ctable, "p value" = p))</span></span>
<span id="cb568-1448"><a href="#cb568-1448" aria-hidden="true" tabindex="-1"></a><span class="co"># (ci &lt;- confint(m))</span></span>
<span id="cb568-1449"><a href="#cb568-1449" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- coef(m))</span></span>
<span id="cb568-1450"><a href="#cb568-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1451"><a href="#cb568-1451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1452"><a href="#cb568-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1453"><a href="#cb568-1453" aria-hidden="true" tabindex="-1"></a>*Likelihood ratio test suggests the predictor model is a better fit than the empty (intercept only) model.*</span>
<span id="cb568-1454"><a href="#cb568-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1455"><a href="#cb568-1455" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb568-1456"><a href="#cb568-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1459"><a href="#cb568-1459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1460"><a href="#cb568-1460" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SUMMARY"</span>)</span>
<span id="cb568-1461"><a href="#cb568-1461" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(om)</span>
<span id="cb568-1462"><a href="#cb568-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1463"><a href="#cb568-1463" aria-hidden="true" tabindex="-1"></a><span class="co">#LOG ODDS</span></span>
<span id="cb568-1464"><a href="#cb568-1464" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"IN LOG ODDS"</span>)</span>
<span id="cb568-1465"><a href="#cb568-1465" aria-hidden="true" tabindex="-1"></a>(ctable <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(om)))</span>
<span id="cb568-1466"><a href="#cb568-1466" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(om)) </span>
<span id="cb568-1467"><a href="#cb568-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1468"><a href="#cb568-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"IN ODDS RATIOS"</span>)</span>
<span id="cb568-1469"><a href="#cb568-1469" aria-hidden="true" tabindex="-1"></a><span class="co">#ODDS RATIOS</span></span>
<span id="cb568-1470"><a href="#cb568-1470" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(om))</span>
<span id="cb568-1471"><a href="#cb568-1471" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(ci)</span>
<span id="cb568-1472"><a href="#cb568-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1473"><a href="#cb568-1473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1474"><a href="#cb568-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1475"><a href="#cb568-1475" aria-hidden="true" tabindex="-1"></a>**Overall, participants in the impasse condition had higher odds (6.68 X as likely) to offer *more correct* interpretations than those in the control condition (z = 4.74, p \&lt; 0.001).**</span>
<span id="cb568-1476"><a href="#cb568-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1477"><a href="#cb568-1477" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>we see the estimates for the 2 intercepts, which are sometimes called cutpoints.</span>
<span id="cb568-1478"><a href="#cb568-1478" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercepts indicate where the latent variable is cut to make the three groups that we observe in our data.</span>
<span id="cb568-1479"><a href="#cb568-1479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that this latent variable is continuous. In general, these are not used in the interpretation of the results.</span>
<span id="cb568-1480"><a href="#cb568-1480" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The cutpoints are closely related to thresholds, which are reported by other statistical packages.</span>
<span id="cb568-1481"><a href="#cb568-1481" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>for k groups there will be k-1 intercepts (cutpoints)</span>
<span id="cb568-1482"><a href="#cb568-1482" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>confirm that the CI does not include 0 (the units are ordered logits <span class="sc">\[</span>ordered log odds<span class="sc">\]</span>)</span>
<span id="cb568-1483"><a href="#cb568-1483" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>as with logistic regression we exponentiate the coefficients and confints to get odds ratio</span>
<span id="cb568-1484"><a href="#cb568-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1485"><a href="#cb568-1485" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize Model</span></span>
<span id="cb568-1486"><a href="#cb568-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1489"><a href="#cb568-1489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1490"><a href="#cb568-1490" aria-hidden="true" tabindex="-1"></a><span class="co"># sjPlot::tab_model(om)</span></span>
<span id="cb568-1491"><a href="#cb568-1491" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(om)</span>
<span id="cb568-1492"><a href="#cb568-1492" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(om, <span class="at">type =</span> <span class="st">"eff"</span>)</span>
<span id="cb568-1493"><a href="#cb568-1493" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># show.data = TRUE, jitter = TRUE)</span></span>
<span id="cb568-1494"><a href="#cb568-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1495"><a href="#cb568-1495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1496"><a href="#cb568-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1497"><a href="#cb568-1497" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb568-1498"><a href="#cb568-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1501"><a href="#cb568-1501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1502"><a href="#cb568-1502" aria-hidden="true" tabindex="-1"></a><span class="co">#:: ASSESS FIT</span></span>
<span id="cb568-1503"><a href="#cb568-1503" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(om)</span>
<span id="cb568-1504"><a href="#cb568-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1505"><a href="#cb568-1505" aria-hidden="true" tabindex="-1"></a><span class="co"># #test proporitional odds assumption </span></span>
<span id="cb568-1506"><a href="#cb568-1506" aria-hidden="true" tabindex="-1"></a><span class="fu">brant</span>(m) <span class="co">#only works for polyr type model not clm type model</span></span>
<span id="cb568-1507"><a href="#cb568-1507" aria-hidden="true" tabindex="-1"></a><span class="co"># # A p-value of less than 0.05 on this test—particularly on the Omnibus plus at least one of the variables—should be interpreted as a failure of the proportional odds assumption.</span></span>
<span id="cb568-1508"><a href="#cb568-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1509"><a href="#cb568-1509" aria-hidden="true" tabindex="-1"></a><span class="co">#test proportional odds assumption</span></span>
<span id="cb568-1510"><a href="#cb568-1510" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pomcheckr)</span>
<span id="cb568-1511"><a href="#cb568-1511" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/pomcheckr/pomcheckr.pdf</span></span>
<span id="cb568-1512"><a href="#cb568-1512" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pomcheck</span>( scaled <span class="sc">~</span> condition , <span class="at">data =</span> df))</span>
<span id="cb568-1513"><a href="#cb568-1513" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span>
<span id="cb568-1514"><a href="#cb568-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1515"><a href="#cb568-1515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1516"><a href="#cb568-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1517"><a href="#cb568-1517" aria-hidden="true" tabindex="-1"></a>**The output of the graphical test for proportional odds assumption suggests that the proportional odds assumption may be unreasonable for this dataset. Also, inspecting the output table, we see the coefficients for each level of the scaled variable are quite different.**</span>
<span id="cb568-1518"><a href="#cb568-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1519"><a href="#cb568-1519" aria-hidden="true" tabindex="-1"></a>Thus, an alternative approach may be more appropriate:</span>
<span id="cb568-1520"><a href="#cb568-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1521"><a href="#cb568-1521" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Baseline logistic model. This model is the same as the multinomial regression model covered in the previous chapter, using the lowest ordinal value as the reference.</span>
<span id="cb568-1522"><a href="#cb568-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1523"><a href="#cb568-1523" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjacent-category logistic model. This model compares each level of the ordinal variable to the next highest level, and it is a constrained version of the baseline logistic model. The brglm2 package in R offers a function bracl() for calculating an adjacent category logistic model.</span>
<span id="cb568-1524"><a href="#cb568-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1525"><a href="#cb568-1525" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Continuation-ratio logistic model. This model compares each level of the ordinal variable to all lower levels. This can be modeled using binary logistic regression techniques, but new variables need to be constructed from the data set to allow this. The R package rms has a function cr.setup() which is a utility for preparing an outcome variable for a continuation ratio model.</span>
<span id="cb568-1526"><a href="#cb568-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1527"><a href="#cb568-1527" aria-hidden="true" tabindex="-1"></a><span class="sc">\*</span>Note: for multiple regression, the ordinal package offers a parameter (nominal = \~predictors) that allow you to designate some predictors as nominal rather than ordinal. But this is not appropriate for this use case.<span class="sc">\_</span></span>
<span id="cb568-1528"><a href="#cb568-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1529"><a href="#cb568-1529" aria-hidden="true" tabindex="-1"></a><span class="fu">## CATEGORICAL OUTCOME </span></span>
<span id="cb568-1530"><a href="#cb568-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1531"><a href="#cb568-1531" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] type of response given?**</span>
<span id="cb568-1532"><a href="#cb568-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1535"><a href="#cb568-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1536"><a href="#cb568-1536" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb568-1537"><a href="#cb568-1537" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb568-1538"><a href="#cb568-1538" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb568-1539"><a href="#cb568-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1540"><a href="#cb568-1540" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb568-1541"><a href="#cb568-1541" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>scaled, df<span class="sc">$</span>condition))</span>
<span id="cb568-1542"><a href="#cb568-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1543"><a href="#cb568-1543" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb568-1544"><a href="#cb568-1544" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>scaled, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb568-1545"><a href="#cb568-1545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb568-1546"><a href="#cb568-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1547"><a href="#cb568-1547" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-1548"><a href="#cb568-1548" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb568-1549"><a href="#cb568-1549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb568-1550"><a href="#cb568-1550" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb568-1551"><a href="#cb568-1551" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> scaled)) <span class="sc">+</span></span>
<span id="cb568-1552"><a href="#cb568-1552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb568-1553"><a href="#cb568-1553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb568-1554"><a href="#cb568-1554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb568-1555"><a href="#cb568-1555" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb568-1556"><a href="#cb568-1556" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb568-1557"><a href="#cb568-1557" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb568-1558"><a href="#cb568-1558" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb568-1559"><a href="#cb568-1559" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb568-1560"><a href="#cb568-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1561"><a href="#cb568-1561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1562"><a href="#cb568-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1563"><a href="#cb568-1563" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] state of understanding?**</span>
<span id="cb568-1564"><a href="#cb568-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1567"><a href="#cb568-1567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1568"><a href="#cb568-1568" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb568-1569"><a href="#cb568-1569" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb568-1570"><a href="#cb568-1570" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb568-1571"><a href="#cb568-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1572"><a href="#cb568-1572" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb568-1573"><a href="#cb568-1573" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition))</span>
<span id="cb568-1574"><a href="#cb568-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1575"><a href="#cb568-1575" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb568-1576"><a href="#cb568-1576" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>state, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb568-1577"><a href="#cb568-1577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb568-1578"><a href="#cb568-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1579"><a href="#cb568-1579" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-1580"><a href="#cb568-1580" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb568-1581"><a href="#cb568-1581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb568-1582"><a href="#cb568-1582" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb568-1583"><a href="#cb568-1583" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb568-1584"><a href="#cb568-1584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb568-1585"><a href="#cb568-1585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb568-1586"><a href="#cb568-1586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb568-1587"><a href="#cb568-1587" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb568-1588"><a href="#cb568-1588" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 State"</span>,</span>
<span id="cb568-1589"><a href="#cb568-1589" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb568-1590"><a href="#cb568-1590" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb568-1591"><a href="#cb568-1591" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb568-1592"><a href="#cb568-1592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1593"><a href="#cb568-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1594"><a href="#cb568-1594" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHI SQUARE</span></span>
<span id="cb568-1595"><a href="#cb568-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1596"><a href="#cb568-1596" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[categorical\] type of response given?**</span>
<span id="cb568-1597"><a href="#cb568-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1600"><a href="#cb568-1600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1601"><a href="#cb568-1601" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>scaled, </span>
<span id="cb568-1602"><a href="#cb568-1602" aria-hidden="true" tabindex="-1"></a>             <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-1603"><a href="#cb568-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1604"><a href="#cb568-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1607"><a href="#cb568-1607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1608"><a href="#cb568-1608" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb568-1609"><a href="#cb568-1609" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb568-1610"><a href="#cb568-1610" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Interpretation on First Question by Condition"</span>,</span>
<span id="cb568-1611"><a href="#cb568-1611" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, condition <span class="sc">~</span> scaled, </span>
<span id="cb568-1612"><a href="#cb568-1612" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb568-1613"><a href="#cb568-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1614"><a href="#cb568-1614" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::WITH STATISTICS</span></span>
<span id="cb568-1615"><a href="#cb568-1615" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> condition, <span class="at">y =</span> scaled,</span>
<span id="cb568-1616"><a href="#cb568-1616" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"nonparametric"</span>) </span>
<span id="cb568-1617"><a href="#cb568-1617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1618"><a href="#cb568-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1621"><a href="#cb568-1621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1622"><a href="#cb568-1622" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-interpreation</span></span>
<span id="cb568-1623"><a href="#cb568-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1624"><a href="#cb568-1624" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb568-1625"><a href="#cb568-1625" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb568-1626"><a href="#cb568-1626" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Response Type on First Question by Condition"</span>,</span>
<span id="cb568-1627"><a href="#cb568-1627" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, condition <span class="sc">~</span> scaled, </span>
<span id="cb568-1628"><a href="#cb568-1628" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb568-1629"><a href="#cb568-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1630"><a href="#cb568-1630" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>scaled, </span>
<span id="cb568-1631"><a href="#cb568-1631" aria-hidden="true" tabindex="-1"></a>            <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-1632"><a href="#cb568-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1633"><a href="#cb568-1633" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb568-1634"><a href="#cb568-1634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"scaled"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb568-1635"><a href="#cb568-1635" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb568-1636"><a href="#cb568-1636" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb568-1637"><a href="#cb568-1637" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1638"><a href="#cb568-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1639"><a href="#cb568-1639" aria-hidden="true" tabindex="-1"></a>**TODO INFERENCE**</span>
<span id="cb568-1640"><a href="#cb568-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1641"><a href="#cb568-1641" aria-hidden="true" tabindex="-1"></a><span class="fu">### MULTINOMIAL REGRESSION </span></span>
<span id="cb568-1642"><a href="#cb568-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1643"><a href="#cb568-1643" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of Q1?*</span>
<span id="cb568-1644"><a href="#cb568-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1645"><a href="#cb568-1645" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model&gt;</span></span>
<span id="cb568-1646"><a href="#cb568-1646" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK&gt;</span></span>
<span id="cb568-1647"><a href="#cb568-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1648"><a href="#cb568-1648" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb568-1649"><a href="#cb568-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1652"><a href="#cb568-1652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1653"><a href="#cb568-1653" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb568-1654"><a href="#cb568-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1655"><a href="#cb568-1655" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb568-1656"><a href="#cb568-1656" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span>
<span id="cb568-1657"><a href="#cb568-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1658"><a href="#cb568-1658" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb568-1659"><a href="#cb568-1659" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb568-1660"><a href="#cb568-1660" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb568-1661"><a href="#cb568-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1662"><a href="#cb568-1662" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb568-1663"><a href="#cb568-1663" aria-hidden="true" tabindex="-1"></a>catm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-1664"><a href="#cb568-1664" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm)</span></span>
<span id="cb568-1665"><a href="#cb568-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1666"><a href="#cb568-1666" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb568-1667"><a href="#cb568-1667" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm)</span>
<span id="cb568-1668"><a href="#cb568-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1669"><a href="#cb568-1669" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb568-1670"><a href="#cb568-1670" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb568-1671"><a href="#cb568-1671" aria-hidden="true" tabindex="-1"></a><span class="co"># m1 &lt;- brm( state ~ condition, data = df, family = "categorical")</span></span>
<span id="cb568-1672"><a href="#cb568-1672" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m1)</span></span>
<span id="cb568-1673"><a href="#cb568-1673" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m1)</span></span>
<span id="cb568-1674"><a href="#cb568-1674" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m1)</span></span>
<span id="cb568-1675"><a href="#cb568-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1676"><a href="#cb568-1676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1677"><a href="#cb568-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1678"><a href="#cb568-1678" aria-hidden="true" tabindex="-1"></a>*Likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*</span>
<span id="cb568-1679"><a href="#cb568-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1680"><a href="#cb568-1680" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interpretation</span></span>
<span id="cb568-1681"><a href="#cb568-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1684"><a href="#cb568-1684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1685"><a href="#cb568-1685" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb568-1686"><a href="#cb568-1686" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span>
<span id="cb568-1687"><a href="#cb568-1687" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(catm)</span>
<span id="cb568-1688"><a href="#cb568-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1689"><a href="#cb568-1689" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb568-1690"><a href="#cb568-1690" aria-hidden="true" tabindex="-1"></a>(z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(catm)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(catm)<span class="sc">$</span>standard.errors)</span>
<span id="cb568-1691"><a href="#cb568-1691" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb568-1692"><a href="#cb568-1692" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb568-1693"><a href="#cb568-1693" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb568-1694"><a href="#cb568-1694" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values))</span>
<span id="cb568-1695"><a href="#cb568-1695" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb568-1696"><a href="#cb568-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1697"><a href="#cb568-1697" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb568-1698"><a href="#cb568-1698" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(catm)<span class="sc">$</span>coefficients))</span>
<span id="cb568-1699"><a href="#cb568-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1700"><a href="#cb568-1700" aria-hidden="true" tabindex="-1"></a><span class="co"># options(scipen = 3)</span></span>
<span id="cb568-1701"><a href="#cb568-1701" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span>
<span id="cb568-1702"><a href="#cb568-1702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1703"><a href="#cb568-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1704"><a href="#cb568-1704" aria-hidden="true" tabindex="-1"></a>**Learning Notes**</span>
<span id="cb568-1705"><a href="#cb568-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1706"><a href="#cb568-1706" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model estimates encompass two equations:</span>
<span id="cb568-1707"><a href="#cb568-1707" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>effect of predictor on log odds of being in <span class="sc">\[</span>unknown<span class="sc">\]</span> instead of reference category <span class="sc">\[</span>orth-like<span class="sc">\]</span></span>
<span id="cb568-1708"><a href="#cb568-1708" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>effect of predictor on log odds of being in <span class="sc">\[</span>tri-like<span class="sc">\]</span> instead of reference category <span class="sc">\[</span>orth-like<span class="sc">\]</span></span>
<span id="cb568-1709"><a href="#cb568-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1710"><a href="#cb568-1710" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb568-1711"><a href="#cb568-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1712"><a href="#cb568-1712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition increases the odds of giving 'unknown/uncertain' response rather than an orthogonal (or satisficing) response by a factor of 50 (z = 3.59, p <span class="sc">\&lt;</span> 0.001 ).</span>
<span id="cb568-1713"><a href="#cb568-1713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition increases the odds of giving an 'triangular or line-driven' response rather than an orthogonal (or satisficing) response by a factor of 6 (z = 3.98, p <span class="sc">\&lt;</span>0.001 )</span>
<span id="cb568-1714"><a href="#cb568-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1715"><a href="#cb568-1715" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb568-1716"><a href="#cb568-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1719"><a href="#cb568-1719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1720"><a href="#cb568-1720" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(catm, <span class="at">vline.color =</span> <span class="st">'red'</span>)</span>
<span id="cb568-1721"><a href="#cb568-1721" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(catm, <span class="at">type =</span> <span class="st">"eff"</span>)</span>
<span id="cb568-1722"><a href="#cb568-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1723"><a href="#cb568-1723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1724"><a href="#cb568-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1725"><a href="#cb568-1725" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb568-1726"><a href="#cb568-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1729"><a href="#cb568-1729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1730"><a href="#cb568-1730" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb568-1731"><a href="#cb568-1731" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb568-1732"><a href="#cb568-1732" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))</span>
<span id="cb568-1733"><a href="#cb568-1733" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(catm, <span class="at">newdata =</span> test, <span class="st">"probs"</span>)</span>
<span id="cb568-1734"><a href="#cb568-1734" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Predicted Probability of Being in Each State"</span>)</span>
<span id="cb568-1735"><a href="#cb568-1735" aria-hidden="true" tabindex="-1"></a>(<span class="fu">cbind</span>(test, pred))</span>
<span id="cb568-1736"><a href="#cb568-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1737"><a href="#cb568-1737" aria-hidden="true" tabindex="-1"></a><span class="co">#performance</span></span>
<span id="cb568-1738"><a href="#cb568-1738" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(catm)</span>
<span id="cb568-1739"><a href="#cb568-1739" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(catm, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span>
<span id="cb568-1740"><a href="#cb568-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1741"><a href="#cb568-1741" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb568-1742"><a href="#cb568-1742" aria-hidden="true" tabindex="-1"></a><span class="co"># library(generalhoslem)</span></span>
<span id="cb568-1743"><a href="#cb568-1743" aria-hidden="true" tabindex="-1"></a><span class="co"># logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb568-1744"><a href="#cb568-1744" aria-hidden="true" tabindex="-1"></a><span class="co"># hoslem.test(x = df$state, y = catm$fitted.values, g =  10)</span></span>
<span id="cb568-1745"><a href="#cb568-1745" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb568-1746"><a href="#cb568-1746" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb568-1747"><a href="#cb568-1747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1748"><a href="#cb568-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1749"><a href="#cb568-1749" aria-hidden="true" tabindex="-1"></a><span class="fu"># MIXED (Repeated Measures)</span></span>
<span id="cb568-1750"><a href="#cb568-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1753"><a href="#cb568-1753" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1754"><a href="#cb568-1754" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-</span><span class="al">TEST</span><span class="co">-ACC-ITEM</span></span>
<span id="cb568-1755"><a href="#cb568-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1756"><a href="#cb568-1756" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb568-1757"><a href="#cb568-1757" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb568-1758"><a href="#cb568-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1759"><a href="#cb568-1759" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb568-1760"><a href="#cb568-1760" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb568-1761"><a href="#cb568-1761" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb568-1762"><a href="#cb568-1762" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb568-1763"><a href="#cb568-1763" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb568-1764"><a href="#cb568-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1765"><a href="#cb568-1765" aria-hidden="true" tabindex="-1"></a><span class="co">#FACETED HISTOGRAM</span></span>
<span id="cb568-1766"><a href="#cb568-1766" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(item_test_NABS))</span>
<span id="cb568-1767"><a href="#cb568-1767" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>item_test_NABS, </span>
<span id="cb568-1768"><a href="#cb568-1768" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_subjects) <span class="sc">%&gt;%</span> </span>
<span id="cb568-1769"><a href="#cb568-1769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> pretty_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb568-1770"><a href="#cb568-1770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb568-1771"><a href="#cb568-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"# Correct"</span>,</span>
<span id="cb568-1772"><a href="#cb568-1772" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb568-1773"><a href="#cb568-1773" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Test Phase Absolute Score (# Correct)"</span>,</span>
<span id="cb568-1774"><a href="#cb568-1774" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb568-1775"><a href="#cb568-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1776"><a href="#cb568-1776" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-1777"><a href="#cb568-1777" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb568-1778"><a href="#cb568-1778" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df) <span class="sc">%&gt;%</span></span>
<span id="cb568-1779"><a href="#cb568-1779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb568-1780"><a href="#cb568-1780" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Correct Responses in Test Phase"</span>,</span>
<span id="cb568-1781"><a href="#cb568-1781" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Task by Condition"</span>,</span>
<span id="cb568-1782"><a href="#cb568-1782" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb568-1783"><a href="#cb568-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1784"><a href="#cb568-1784" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb568-1785"><a href="#cb568-1785" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb568-1786"><a href="#cb568-1786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb568-1787"><a href="#cb568-1787" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb568-1788"><a href="#cb568-1788" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb568-1789"><a href="#cb568-1789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb568-1790"><a href="#cb568-1790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb568-1791"><a href="#cb568-1791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb568-1792"><a href="#cb568-1792" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb568-1793"><a href="#cb568-1793" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb568-1794"><a href="#cb568-1794" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb568-1795"><a href="#cb568-1795" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb568-1796"><a href="#cb568-1796" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb568-1797"><a href="#cb568-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1798"><a href="#cb568-1798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1799"><a href="#cb568-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1800"><a href="#cb568-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- CONTINUOUS</span></span>
<span id="cb568-1801"><a href="#cb568-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1802"><a href="#cb568-1802" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- BINOMIAL</span></span>
<span id="cb568-1803"><a href="#cb568-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1804"><a href="#cb568-1804" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mixed Logistic Regression</span></span>
<span id="cb568-1805"><a href="#cb568-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1806"><a href="#cb568-1806" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on test phase questions by condition; accounting for random effects of subject.*</span>
<span id="cb568-1807"><a href="#cb568-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1808"><a href="#cb568-1808" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb568-1809"><a href="#cb568-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1812"><a href="#cb568-1812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1813"><a href="#cb568-1813" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb568-1814"><a href="#cb568-1814" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb568-1815"><a href="#cb568-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1816"><a href="#cb568-1816" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb568-1817"><a href="#cb568-1817" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb568-1818"><a href="#cb568-1818" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb568-1819"><a href="#cb568-1819" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb568-1820"><a href="#cb568-1820" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb568-1821"><a href="#cb568-1821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1822"><a href="#cb568-1822" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb568-1823"><a href="#cb568-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1824"><a href="#cb568-1824" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM EFFECT</span></span>
<span id="cb568-1825"><a href="#cb568-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1826"><a href="#cb568-1826" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb568-1827"><a href="#cb568-1827" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df) </span>
<span id="cb568-1828"><a href="#cb568-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1829"><a href="#cb568-1829" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb568-1830"><a href="#cb568-1830" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb568-1831"><a href="#cb568-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1832"><a href="#cb568-1832" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb568-1833"><a href="#cb568-1833" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with random effect is lower than glm empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span>
<span id="cb568-1834"><a href="#cb568-1834" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb568-1835"><a href="#cb568-1835" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb568-1836"><a href="#cb568-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1837"><a href="#cb568-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1838"><a href="#cb568-1838" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT</span></span>
<span id="cb568-1839"><a href="#cb568-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1840"><a href="#cb568-1840" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span></span>
<span id="cb568-1841"><a href="#cb568-1841" aria-hidden="true" tabindex="-1"></a>mm.CrS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), </span>
<span id="cb568-1842"><a href="#cb568-1842" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb568-1843"><a href="#cb568-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1844"><a href="#cb568-1844" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> fixed factor </span></span>
<span id="cb568-1845"><a href="#cb568-1845" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with fixed effect is lower than random intercept only model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrS)) )</span>
<span id="cb568-1846"><a href="#cb568-1846" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS,mm.CrS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb568-1847"><a href="#cb568-1847" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS,mm.CrS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb568-1848"><a href="#cb568-1848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1849"><a href="#cb568-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1850"><a href="#cb568-1850" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb568-1851"><a href="#cb568-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1854"><a href="#cb568-1854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1855"><a href="#cb568-1855" aria-hidden="true" tabindex="-1"></a><span class="co">#: PRINT MODEL </span></span>
<span id="cb568-1856"><a href="#cb568-1856" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb568-1857"><a href="#cb568-1857" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(mm.CrS)</span>
<span id="cb568-1858"><a href="#cb568-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1859"><a href="#cb568-1859" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb568-1860"><a href="#cb568-1860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1861"><a href="#cb568-1861" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb568-1862"><a href="#cb568-1862" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(mm.CrS)</span>
<span id="cb568-1863"><a href="#cb568-1863" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb568-1864"><a href="#cb568-1864" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mm.CrS)</span>
<span id="cb568-1865"><a href="#cb568-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1866"><a href="#cb568-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1867"><a href="#cb568-1867" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb568-1868"><a href="#cb568-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1869"><a href="#cb568-1869" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb568-1870"><a href="#cb568-1870" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb568-1871"><a href="#cb568-1871" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb568-1872"><a href="#cb568-1872" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb568-1873"><a href="#cb568-1873" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb568-1874"><a href="#cb568-1874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb568-1875"><a href="#cb568-1875" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb568-1876"><a href="#cb568-1876" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb568-1877"><a href="#cb568-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1878"><a href="#cb568-1878" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb568-1879"><a href="#cb568-1879" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"pred"</span>,</span>
<span id="cb568-1880"><a href="#cb568-1880" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb568-1881"><a href="#cb568-1881" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb568-1882"><a href="#cb568-1882" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb568-1883"><a href="#cb568-1883" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb568-1884"><a href="#cb568-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1885"><a href="#cb568-1885" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb568-1886"><a href="#cb568-1886" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb568-1887"><a href="#cb568-1887" aria-hidden="true" tabindex="-1"></a><span class="co"># ggeffect(model = mm.CrS) %&gt;% plot()</span></span>
<span id="cb568-1888"><a href="#cb568-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1889"><a href="#cb568-1889" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb568-1890"><a href="#cb568-1890" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb568-1891"><a href="#cb568-1891" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(mm.CrS))</span></span>
<span id="cb568-1892"><a href="#cb568-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1893"><a href="#cb568-1893" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1894"><a href="#cb568-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1895"><a href="#cb568-1895" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb568-1896"><a href="#cb568-1896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1899"><a href="#cb568-1899" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1900"><a href="#cb568-1900" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mm.CrS)</span>
<span id="cb568-1901"><a href="#cb568-1901" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(mm.CrS)</span>
<span id="cb568-1902"><a href="#cb568-1902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1903"><a href="#cb568-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1904"><a href="#cb568-1904" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb568-1905"><a href="#cb568-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1906"><a href="#cb568-1906" aria-hidden="true" tabindex="-1"></a>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(3): 4.98, p <span class="sc">\&lt;</span> 0.05). Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 5 over the control condition $e^{\beta_1}$ = 5.11, 95% CI <span class="sc">\[</span>1.17,22,36<span class="sc">\]</span>, p <span class="sc">\&lt;</span> 0.05.</span>
<span id="cb568-1907"><a href="#cb568-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1910"><a href="#cb568-1910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1911"><a href="#cb568-1911" aria-hidden="true" tabindex="-1"></a><span class="co"># PRETTY TABLE SJPLOT</span></span>
<span id="cb568-1912"><a href="#cb568-1912" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(mm.CrS)</span>
<span id="cb568-1913"><a href="#cb568-1913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1914"><a href="#cb568-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1915"><a href="#cb568-1915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1916"><a href="#cb568-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1917"><a href="#cb568-1917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1918"><a href="#cb568-1918" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- ORDINAL</span></span>
<span id="cb568-1919"><a href="#cb568-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1920"><a href="#cb568-1920" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- CATEGORICAL</span></span>
<span id="cb568-1921"><a href="#cb568-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1924"><a href="#cb568-1924" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1925"><a href="#cb568-1925" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb568-1926"><a href="#cb568-1926" aria-hidden="true" tabindex="-1"></a><span class="co">#df &lt;- df_items %&gt;% filter(q %nin% c(1,2,3,4,5,6,9)) %&gt;% filter(term=="spring18")</span></span>
<span id="cb568-1927"><a href="#cb568-1927" aria-hidden="true" tabindex="-1"></a><span class="co"># mm1 &lt;- brm( state ~ condition + (1|subject), data = df, family = "categorical", </span></span>
<span id="cb568-1928"><a href="#cb568-1928" aria-hidden="true" tabindex="-1"></a><span class="co"># file = "analysis/models/sgc3a_brms_mixedcat_teststate.rds" # cache model (can be removed)))</span></span>
<span id="cb568-1929"><a href="#cb568-1929" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm1)</span></span>
<span id="cb568-1930"><a href="#cb568-1930" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(mm1)</span></span>
<span id="cb568-1931"><a href="#cb568-1931" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mm1)</span></span>
<span id="cb568-1932"><a href="#cb568-1932" aria-hidden="true" tabindex="-1"></a><span class="co"># #report(mm1)</span></span>
<span id="cb568-1933"><a href="#cb568-1933" aria-hidden="true" tabindex="-1"></a><span class="co"># #check_posterior_predictions(mm1, draws=100)</span></span>
<span id="cb568-1934"><a href="#cb568-1934" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(bayesplot)</span></span>
<span id="cb568-1935"><a href="#cb568-1935" aria-hidden="true" tabindex="-1"></a><span class="co"># library(bayestestR)</span></span>
<span id="cb568-1936"><a href="#cb568-1936" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(mm1))</span></span>
<span id="cb568-1937"><a href="#cb568-1937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1938"><a href="#cb568-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1939"><a href="#cb568-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1940"><a href="#cb568-1940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1941"><a href="#cb568-1941" aria-hidden="true" tabindex="-1"></a><span class="fu">## WIP UNKNOWN</span></span>
<span id="cb568-1942"><a href="#cb568-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1943"><a href="#cb568-1943" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cummulative Ordinal (Bayesian) — Equal Variance</span></span>
<span id="cb568-1944"><a href="#cb568-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1945"><a href="#cb568-1945" aria-hidden="true" tabindex="-1"></a>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb568-1946"><a href="#cb568-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1949"><a href="#cb568-1949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1950"><a href="#cb568-1950" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb568-1951"><a href="#cb568-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1952"><a href="#cb568-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1953"><a href="#cb568-1953" aria-hidden="true" tabindex="-1"></a><span class="co">#DEFINE DATA </span></span>
<span id="cb568-1954"><a href="#cb568-1954" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb568-1955"><a href="#cb568-1955" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb568-1956"><a href="#cb568-1956" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: why is this probit instead of logit?</span></span>
<span id="cb568-1957"><a href="#cb568-1957" aria-hidden="true" tabindex="-1"></a>cumord <span class="ot">&lt;-</span> <span class="fu">brm</span>( <span class="at">formula =</span> state <span class="sc">~</span> condition,</span>
<span id="cb568-1958"><a href="#cb568-1958" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb568-1959"><a href="#cb568-1959" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"probit"</span>),</span>
<span id="cb568-1960"><a href="#cb568-1960" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/models/sgc3a_brms_cumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb568-1961"><a href="#cb568-1961" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb568-1962"><a href="#cb568-1962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1963"><a href="#cb568-1963" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cumord)</span>
<span id="cb568-1964"><a href="#cb568-1964" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-1965"><a href="#cb568-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1966"><a href="#cb568-1966" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT</span></span>
<span id="cb568-1967"><a href="#cb568-1967" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(cumord)</span>
<span id="cb568-1968"><a href="#cb568-1968" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cumord)</span>
<span id="cb568-1969"><a href="#cb568-1969" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(cumord))</span>
<span id="cb568-1970"><a href="#cb568-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1971"><a href="#cb568-1971" aria-hidden="true" tabindex="-1"></a><span class="co">#REPORT</span></span>
<span id="cb568-1972"><a href="#cb568-1972" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(cumord)</span>
<span id="cb568-1973"><a href="#cb568-1973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1974"><a href="#cb568-1974" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum %&gt;%</span></span>
<span id="cb568-1975"><a href="#cb568-1975" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb568-1976"><a href="#cb568-1976" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb568-1977"><a href="#cb568-1977" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb568-1978"><a href="#cb568-1978" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb568-1979"><a href="#cb568-1979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1980"><a href="#cb568-1980" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(cumord)</span></span>
<span id="cb568-1981"><a href="#cb568-1981" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(cumord)</span></span>
<span id="cb568-1982"><a href="#cb568-1982" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-1983"><a href="#cb568-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1984"><a href="#cb568-1984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1985"><a href="#cb568-1985" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cummulative Ordinal (Bayesian) — Unequal Variance</span></span>
<span id="cb568-1986"><a href="#cb568-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1987"><a href="#cb568-1987" aria-hidden="true" tabindex="-1"></a>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb568-1988"><a href="#cb568-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1991"><a href="#cb568-1991" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-1992"><a href="#cb568-1992" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb568-1993"><a href="#cb568-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1994"><a href="#cb568-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-1995"><a href="#cb568-1995" aria-hidden="true" tabindex="-1"></a><span class="co">#DEFINE DATA </span></span>
<span id="cb568-1996"><a href="#cb568-1996" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb568-1997"><a href="#cb568-1997" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb568-1998"><a href="#cb568-1998" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: why is this probit instead of logit?</span></span>
<span id="cb568-1999"><a href="#cb568-1999" aria-hidden="true" tabindex="-1"></a>u.cumord <span class="ot">&lt;-</span> <span class="fu">brm</span>( </span>
<span id="cb568-2000"><a href="#cb568-2000" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(state <span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb568-2001"><a href="#cb568-2001" aria-hidden="true" tabindex="-1"></a>               <span class="fu">lf</span>(disc <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> condition, <span class="at">cmc =</span> <span class="cn">FALSE</span>),</span>
<span id="cb568-2002"><a href="#cb568-2002" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb568-2003"><a href="#cb568-2003" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"probit"</span>),</span>
<span id="cb568-2004"><a href="#cb568-2004" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/models/sgc3a_brms_ucumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb568-2005"><a href="#cb568-2005" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb568-2006"><a href="#cb568-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2007"><a href="#cb568-2007" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(u.cumord)</span>
<span id="cb568-2008"><a href="#cb568-2008" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(u.cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-2009"><a href="#cb568-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2010"><a href="#cb568-2010" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT</span></span>
<span id="cb568-2011"><a href="#cb568-2011" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(u.cumord)</span>
<span id="cb568-2012"><a href="#cb568-2012" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(u.cumord)</span>
<span id="cb568-2013"><a href="#cb568-2013" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(u.cumord))</span>
<span id="cb568-2014"><a href="#cb568-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2015"><a href="#cb568-2015" aria-hidden="true" tabindex="-1"></a><span class="co">#REPORT</span></span>
<span id="cb568-2016"><a href="#cb568-2016" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(u.cumord)</span>
<span id="cb568-2017"><a href="#cb568-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2018"><a href="#cb568-2018" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum %&gt;%</span></span>
<span id="cb568-2019"><a href="#cb568-2019" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb568-2020"><a href="#cb568-2020" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb568-2021"><a href="#cb568-2021" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb568-2022"><a href="#cb568-2022" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb568-2023"><a href="#cb568-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2024"><a href="#cb568-2024" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(cumord)</span></span>
<span id="cb568-2025"><a href="#cb568-2025" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(cumord)</span></span>
<span id="cb568-2026"><a href="#cb568-2026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-2027"><a href="#cb568-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2028"><a href="#cb568-2028" aria-hidden="true" tabindex="-1"></a>In brms, the parameter related to latent variances is called disc (short for “discrimination”), following conventions in item response theory. Note that disc is not the variance itself, but the inverse of the standard deviation, s. That is, s = 1/disc. Further, because disc must be strictly positive, it is by default modeled on the log scale.</span>
<span id="cb568-2029"><a href="#cb568-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2030"><a href="#cb568-2030" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjacent-Category Ordinal (Bayesian)</span></span>
<span id="cb568-2031"><a href="#cb568-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2034"><a href="#cb568-2034" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb568-2035"><a href="#cb568-2035" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb568-2036"><a href="#cb568-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2037"><a href="#cb568-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2038"><a href="#cb568-2038" aria-hidden="true" tabindex="-1"></a><span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span></span>
<span id="cb568-2039"><a href="#cb568-2039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2040"><a href="#cb568-2040" aria-hidden="true" tabindex="-1"></a>adjcat <span class="ot">&lt;-</span> <span class="fu">brm</span>( <span class="at">formula =</span> state <span class="sc">~</span> <span class="fu">cs</span>(condition),</span>
<span id="cb568-2041"><a href="#cb568-2041" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb568-2042"><a href="#cb568-2042" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">acat</span>(<span class="st">"probit"</span>),</span>
<span id="cb568-2043"><a href="#cb568-2043" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/models/sgc3a_brms_adjcat_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb568-2044"><a href="#cb568-2044" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb568-2045"><a href="#cb568-2045" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb568-2046"><a href="#cb568-2046" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adjcat)</span>
<span id="cb568-2047"><a href="#cb568-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2048"><a href="#cb568-2048" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-2049"><a href="#cb568-2049" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(adjcat, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb568-2050"><a href="#cb568-2050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2051"><a href="#cb568-2051" aria-hidden="true" tabindex="-1"></a><span class="co">#WHICH IS BETTER? cumulative or adjacent?</span></span>
<span id="cb568-2052"><a href="#cb568-2052" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(cumord, adjcat))</span>
<span id="cb568-2053"><a href="#cb568-2053" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(cumord, adjcat)</span>
<span id="cb568-2054"><a href="#cb568-2054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2055"><a href="#cb568-2055" aria-hidden="true" tabindex="-1"></a><span class="co"># #TIDYBAYES VISUALIZATION</span></span>
<span id="cb568-2056"><a href="#cb568-2056" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidybayes)</span></span>
<span id="cb568-2057"><a href="#cb568-2057" aria-hidden="true" tabindex="-1"></a><span class="co"># adjcat %&gt;%</span></span>
<span id="cb568-2058"><a href="#cb568-2058" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb568-2059"><a href="#cb568-2059" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb568-2060"><a href="#cb568-2060" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb568-2061"><a href="#cb568-2061" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb568-2062"><a href="#cb568-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2063"><a href="#cb568-2063" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cumord)</span>
<span id="cb568-2064"><a href="#cb568-2064" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(adjcat)</span>
<span id="cb568-2065"><a href="#cb568-2065" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(adjcat)</span>
<span id="cb568-2066"><a href="#cb568-2066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-2067"><a href="#cb568-2067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb568-2068"><a href="#cb568-2068" aria-hidden="true" tabindex="-1"></a>_Converges, but estimates are unreliable?_</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>