<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.640">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>SGC-X - Modelling Reference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../analysis/SGC2/1_sgc2_introduction.html" rel="next">
<link href="../../analysis/utils/scoring.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Modelling Reference</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/modelling_ref.html" class="sidebar-item-text sidebar-link active">Modelling Reference</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC2</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/3_sgc2_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/5_sgc3A_exploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploratory Analyses</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/3_sgc4A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">SGC4C</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/1_sgc4C_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/2_sgc4C_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">SGC5A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/1_sgc5A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/2_sgc5A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#independent-samples" id="toc-independent-samples" class="nav-link active" data-scroll-target="#independent-samples">INDEPENDENT SAMPLES</a>
  <ul class="collapse">
<li>
<a href="#continuous-outcome" id="toc-continuous-outcome" class="nav-link" data-scroll-target="#continuous-outcome">CONTINUOUS OUTCOME</a>
  <ul class="collapse">
<li><a href="#independent-samples-t-test-students-t" id="toc-independent-samples-t-test-students-t" class="nav-link" data-scroll-target="#independent-samples-t-test-students-t">Independent Samples T-Test (Student’s T)</a></li>
  <li><a href="#independent-samples-t-test-welchs-t" id="toc-independent-samples-t-test-welchs-t" class="nav-link" data-scroll-target="#independent-samples-t-test-welchs-t">Independent Samples T-Test (Welch’s T)</a></li>
  <li><a href="#yuens-t-test-trimmed-means" id="toc-yuens-t-test-trimmed-means" class="nav-link" data-scroll-target="#yuens-t-test-trimmed-means">Yuen’s T-Test (Trimmed Means)</a></li>
  <li><a href="#wilcoxon-rank-sum-mann-whitney-test" id="toc-wilcoxon-rank-sum-mann-whitney-test" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-mann-whitney-test">Wilcoxon Rank Sum (Mann-Whitney Test)</a></li>
  <li><a href="#floorceiling-corrections-wilcoxon-rank-sum" id="toc-floorceiling-corrections-wilcoxon-rank-sum" class="nav-link" data-scroll-target="#floorceiling-corrections-wilcoxon-rank-sum">Floor/Ceiling Corrections + Wilcoxon Rank Sum</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#censored-tobit-regression" id="toc-censored-tobit-regression" class="nav-link" data-scroll-target="#censored-tobit-regression">Censored (Tobit) Regression</a></li>
  </ul>
</li>
  <li>
<a href="#count-outcome" id="toc-count-outcome" class="nav-link" data-scroll-target="#count-outcome">COUNT OUTCOME</a>
  <ul class="collapse">
<li><a href="#poisson-regression" id="toc-poisson-regression" class="nav-link" data-scroll-target="#poisson-regression">Poisson Regression</a></li>
  <li><a href="#negative-binomial-regression" id="toc-negative-binomial-regression" class="nav-link" data-scroll-target="#negative-binomial-regression">Negative Binomial Regression</a></li>
  </ul>
</li>
  <li>
<a href="#mixture-models" id="toc-mixture-models" class="nav-link" data-scroll-target="#mixture-models">MIXTURE MODELS</a>
  <ul class="collapse">
<li><a href="#zero-inflated-poisson" id="toc-zero-inflated-poisson" class="nav-link" data-scroll-target="#zero-inflated-poisson">Zero Inflated Poisson</a></li>
  <li><a href="#zero-inflated-negative-binomial-regression" id="toc-zero-inflated-negative-binomial-regression" class="nav-link" data-scroll-target="#zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</a></li>
  <li><a href="#hurdle-model" id="toc-hurdle-model" class="nav-link" data-scroll-target="#hurdle-model">Hurdle Model</a></li>
  </ul>
</li>
  <li>
<a href="#beta-regression" id="toc-beta-regression" class="nav-link" data-scroll-target="#beta-regression">BETA REGRESSION</a>
  <ul class="collapse">
<li><a href="#beta-distribution" id="toc-beta-distribution" class="nav-link" data-scroll-target="#beta-distribution">BETA Distribution</a></li>
  <li>
<a href="#beta-regression-1" id="toc-beta-regression-1" class="nav-link" data-scroll-target="#beta-regression-1">BETA Regression</a>
  <ul class="collapse">
<li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#interpret" id="toc-interpret" class="nav-link" data-scroll-target="#interpret">Interpret</a></li>
  <li><a href="#compare" id="toc-compare" class="nav-link" data-scroll-target="#compare">Compare</a></li>
  <li><a href="#bayesian-version" id="toc-bayesian-version" class="nav-link" data-scroll-target="#bayesian-version">bayesian version</a></li>
  <li><a href="#bayesian-predictions" id="toc-bayesian-predictions" class="nav-link" data-scroll-target="#bayesian-predictions">Bayesian predictions</a></li>
  </ul>
</li>
  <li><a href="#zero-inflated-beta" id="toc-zero-inflated-beta" class="nav-link" data-scroll-target="#zero-inflated-beta">ZERO INFLATED BETA</a></li>
  <li><a href="#zero-one-inflated-beta-regression" id="toc-zero-one-inflated-beta-regression" class="nav-link" data-scroll-target="#zero-one-inflated-beta-regression">ZERO-ONE INFLATED BETA Regression</a></li>
  <li><a href="#zoinf-neg-binom" id="toc-zoinf-neg-binom" class="nav-link" data-scroll-target="#zoinf-neg-binom">ZOINF NEG BINOM?</a></li>
  <li><a href="#mixed-zero-one-inflated-beta-regression" id="toc-mixed-zero-one-inflated-beta-regression" class="nav-link" data-scroll-target="#mixed-zero-one-inflated-beta-regression">MIXED ZERO-ONE-INFLATED BETA Regression</a></li>
  <li><a href="#beta-hurdle-regression-frequentist" id="toc-beta-hurdle-regression-frequentist" class="nav-link" data-scroll-target="#beta-hurdle-regression-frequentist">BETA HURDLE Regression (Frequentist)</a></li>
  </ul>
</li>
  <li>
<a href="#binomial-outcome" id="toc-binomial-outcome" class="nav-link" data-scroll-target="#binomial-outcome">BINOMIAL OUTCOME</a>
  <ul class="collapse">
<li><a href="#chi-square" id="toc-chi-square" class="nav-link" data-scroll-target="#chi-square">CHI SQUARE</a></li>
  <li>
<a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">LOGISTIC REGRESSION</a>
  <ul class="collapse">
<li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#learning-notes" id="toc-learning-notes" class="nav-link" data-scroll-target="#learning-notes">Learning Notes</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#ordinal-outcome" id="toc-ordinal-outcome" class="nav-link" data-scroll-target="#ordinal-outcome">ORDINAL OUTCOME</a>
  <ul class="collapse">
<li>
<a href="#ordinal-regression-cumulative-link-proportional-odds" id="toc-ordinal-regression-cumulative-link-proportional-odds" class="nav-link" data-scroll-target="#ordinal-regression-cumulative-link-proportional-odds">ORDINAL REGRESSION — Cumulative Link; Proportional Odds</a>
  <ul class="collapse">
<li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1">Fit Model</a></li>
  <li><a href="#inference-1" id="toc-inference-1" class="nav-link" data-scroll-target="#inference-1">Inference</a></li>
  <li><a href="#visualize-model" id="toc-visualize-model" class="nav-link" data-scroll-target="#visualize-model">Visualize Model</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#categorical-outcome" id="toc-categorical-outcome" class="nav-link" data-scroll-target="#categorical-outcome">CATEGORICAL OUTCOME</a>
  <ul class="collapse">
<li><a href="#chi-square-1" id="toc-chi-square-1" class="nav-link" data-scroll-target="#chi-square-1">CHI SQUARE</a></li>
  <li>
<a href="#multinomial-regression" id="toc-multinomial-regression" class="nav-link" data-scroll-target="#multinomial-regression">MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
<li><a href="#fit-model-2" id="toc-fit-model-2" class="nav-link" data-scroll-target="#fit-model-2">Fit Model</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#inference-2" id="toc-inference-2" class="nav-link" data-scroll-target="#inference-2">Inference</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  <li><a href="#diagnostics-2" id="toc-diagnostics-2" class="nav-link" data-scroll-target="#diagnostics-2">Diagnostics</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#mixed-repeated-measures" id="toc-mixed-repeated-measures" class="nav-link" data-scroll-target="#mixed-repeated-measures">MIXED (Repeated Measures)</a>
  <ul class="collapse">
<li><a href="#mixed-continuous" id="toc-mixed-continuous" class="nav-link" data-scroll-target="#mixed-continuous">MIXED — CONTINUOUS</a></li>
  <li>
<a href="#mixed-binomial" id="toc-mixed-binomial" class="nav-link" data-scroll-target="#mixed-binomial">MIXED — BINOMIAL</a>
  <ul class="collapse">
<li>
<a href="#mixed-logistic-regression" id="toc-mixed-logistic-regression" class="nav-link" data-scroll-target="#mixed-logistic-regression">Mixed Logistic Regression</a>
  <ul class="collapse">
<li><a href="#fit-model-3" id="toc-fit-model-3" class="nav-link" data-scroll-target="#fit-model-3">Fit Model</a></li>
  <li><a href="#visualize-2" id="toc-visualize-2" class="nav-link" data-scroll-target="#visualize-2">Visualize</a></li>
  <li><a href="#diagnostics-3" id="toc-diagnostics-3" class="nav-link" data-scroll-target="#diagnostics-3">Diagnostics</a></li>
  <li><a href="#inference-3" id="toc-inference-3" class="nav-link" data-scroll-target="#inference-3">Inference</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#mixed-ordinal" id="toc-mixed-ordinal" class="nav-link" data-scroll-target="#mixed-ordinal">MIXED — ORDINAL</a></li>
  <li><a href="#mixed-categorical" id="toc-mixed-categorical" class="nav-link" data-scroll-target="#mixed-categorical">MIXED — CATEGORICAL</a></li>
  <li>
<a href="#wip-unknown" id="toc-wip-unknown" class="nav-link" data-scroll-target="#wip-unknown">WIP UNKNOWN</a>
  <ul class="collapse">
<li><a href="#cummulative-ordinal-bayesian-equal-variance" id="toc-cummulative-ordinal-bayesian-equal-variance" class="nav-link" data-scroll-target="#cummulative-ordinal-bayesian-equal-variance">Cummulative Ordinal (Bayesian) — Equal Variance</a></li>
  <li><a href="#cummulative-ordinal-bayesian-unequal-variance" id="toc-cummulative-ordinal-bayesian-unequal-variance" class="nav-link" data-scroll-target="#cummulative-ordinal-bayesian-unequal-variance">Cummulative Ordinal (Bayesian) — Unequal Variance</a></li>
  <li><a href="#adjacent-category-ordinal-bayesian" id="toc-adjacent-category-ordinal-bayesian" class="nav-link" data-scroll-target="#adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="modelling" class="quarto-section-identifier d-none d-lg-block">Modelling Reference</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">SGCX | Modelling Reference</p>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div style="page-break-after: always;"></div>
<p><strong>In this notebook we use data from study SGC3A to explore different modelling techniques and assess their suitability for the bimodal accuracy distributions in the SGC project data.</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span> <span class="co"># %nin% operator</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jtools.jacob-long.com">jtools</a></span><span class="op">)</span> <span class="co">#misc helpers </span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span> <span class="co">#arrange plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span> <span class="co">#arrange shift function plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/ggformula">ggformula</a></span><span class="op">)</span> <span class="co">#easy graphs</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=vcdExtra">vcdExtra</a></span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span> <span class="co">#printing tables </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co">#visualize model coefficients</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonocarroll/ggeasy">ggeasy</a></span><span class="op">)</span> <span class="co">#the way it should be</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://indrajeetpatil.github.io/statsExpressions/">statsExpressions</a></span><span class="op">)</span> <span class="co">#expressions to add to plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a></span><span class="op">)</span> <span class="co">#plots with expressions</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/">ggdist</a></span><span class="op">)</span> <span class="co">#uncertainty viz </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span> <span class="co">#visualization log regr models</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/modelsummary/">modelsummary</a></span><span class="op">)</span> <span class="co">#tables</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span> <span class="co">#tidy models</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/broom.mixed">broom.mixed</a></span><span class="op">)</span> <span class="co">#tidy mixed and mixture models</span>

<span class="co">#misc utilities</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://modelr.tidyverse.org">modelr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.mitchelloharawild.com/distributional/">distributional</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/">report</a></span><span class="op">)</span> <span class="co">#easystats reporting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/">see</a></span><span class="op">)</span> <span class="co">#easystats visualization</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span> <span class="co">#easystats model diagnostics</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datalorax/equatiomatic">equatiomatic</a></span><span class="op">)</span> <span class="co">#extract model equation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr">pwr</a></span><span class="op">)</span> <span class="co">#power analyses</span>

<span class="co">#modelling</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/">rstatix</a></span><span class="op">)</span> <span class="co">#helpful basic stats &amp; non parametrics</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/psychor/">WRS2</a></span><span class="op">)</span> <span class="co">#robust and nonparametric tests </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR">lmerTest</a></span><span class="op">)</span> <span class="co">#for CIs in glmer </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aloy/qqplotr">qqplotr</a></span><span class="op">)</span> <span class="co">#confint on qq plot</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gmodels</span><span class="op">)</span> <span class="co">#contingency table and CHISQR</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zeroinfl / hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co">#mixed effects models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/ordinal">ordinal</a></span><span class="op">)</span> <span class="co">#ordinal regression</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># polyr ordinal regression</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/">VGAM</a></span><span class="op">)</span> <span class="co">#censored, zero infl, etc</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://benjaminschlegel.ch/r/brant/">brant</a></span><span class="op">)</span> <span class="co">#brant test for ordinal regression</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span> <span class="co">#multinomial logistic regression </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/">bayestestR</a></span><span class="op">)</span>

<span class="co">#one package to rule them all</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co">#ALL THE THINGS</span>

<span class="co">#OUTPUT OPTIONS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>ggplot2.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">1</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="co">#GRAPH THEMEING</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># HACK WD FOR LOCAL RUNNING?</span>
<span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="co">#mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="co">#setwd(mbp)</span>

<span class="co">#IMPORT DATA </span>
<span class="va">df_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span><span class="op">)</span>
<span class="va">df_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span><span class="op">)</span>

<span class="co">#PREP DATA </span>
<span class="va">df_subjects</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  test_score <span class="op">=</span> <span class="va">item_test_NABS</span>,
  raw_condition <span class="op">=</span> <span class="va">condition</span>,
  condition <span class="op">=</span> <span class="va">pretty_condition</span>
<span class="op">)</span>

<span class="va">df_items</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>,
  scaled <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_SCALED</span>, <span class="st">"-1"</span> <span class="op">=</span> <span class="st">"orth"</span>, <span class="st">"-0.5"</span><span class="op">=</span><span class="st">"unknown"</span>,<span class="st">"0"</span><span class="op">=</span><span class="st">"uncertain"</span>,<span class="st">"0.5"</span><span class="op">=</span><span class="st">"lines"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"tri"</span><span class="op">)</span>,
  scaled <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.ordered</a></span><span class="op">(</span><span class="va">scaled</span><span class="op">)</span>,
  raw_condition <span class="op">=</span> <span class="va">condition</span>,
  condition <span class="op">=</span> <span class="va">pretty_condition</span>,
  state <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_SCALED</span>, <span class="co">#for ordinal</span>
                         <span class="st">"-1"</span> <span class="op">=</span> <span class="st">"orth-like"</span>,
                         <span class="st">"-0.5"</span> <span class="op">=</span> <span class="st">"unknown"</span>,
                         <span class="st">"0"</span> <span class="op">=</span> <span class="st">"unknown"</span>,
                         <span class="st">"0.5"</span> <span class="op">=</span> <span class="st">"tri-like"</span>,
                         <span class="st">"1"</span> <span class="op">=</span> <span class="st">"tri-like"</span><span class="op">)</span>,
  state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.ordered</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span>
<span class="op">)</span>
<span class="co"># 3 group ordered STATE variable</span>
<span class="co"># 5 group ordered SCALED variable [matches high_interpretation]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="independent-samples" class="level1"><h1>INDEPENDENT SAMPLES</h1>
<ul>
<li>test-equivalents of GLM models: https://rpubs.com/palday/glm-test</li>
<li>models as test :https://lindeloev.github.io/tests-as-linear/</li>
</ul>
<section id="continuous-outcome" class="level2"><h2 class="anchored" data-anchor-id="continuous-outcome">CONTINUOUS OUTCOME</h2>
<p><strong>Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?<br>
(# questions correct on test phase of task, [in lab] participants)</strong></p>
<p><em>(Can also be transformed to proportion or percentage).</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::SETUP DATA</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  condition min Q1 median Q3 max mean   sd  n missing
1   control   0  0      0  1   8 1.71 3.05 62       0
2   impasse   0  0      2  7   8 3.33 3.40 64       0</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>

<span class="co"># #GGFORMULA | FACETED HISTOGRAM</span>
<span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span>
<span class="co"># gf_props(~item_test_NABS, </span>
<span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span>
<span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span>
<span class="co">#   labs(x = "# Correct",</span>
<span class="co">#        y = "proportion of subjects",</span>
<span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span>
<span class="co">#        subtitle = "") + theme(legend.position = "blank")</span>

<span class="co">##GGPUBR | HIST+DENSITY SCORE </span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/gghistogram.html">gghistogram</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="st">"test_score"</span>, binwidth <span class="op">=</span> <span class="fl">0.5</span>,
   add <span class="op">=</span> <span class="st">"mean"</span>, rug <span class="op">=</span> <span class="cn">TRUE</span>,
   fill <span class="op">=</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span>
   add_density <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/facet.html">facet</a></span><span class="op">(</span><span class="va">p</span>, facet.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Distribution of TEST Absolute Score"</span>,
        subtitle <span class="op">=</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,
        x <span class="op">=</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, y <span class="op">=</span> <span class="st">"number of subjects"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-IND-TESTSCORE-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">##VERTICAL RAINCLOUD USING GGDISTR</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span>,
                        fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span>
    side <span class="op">=</span> <span class="st">"left"</span>,
    justification <span class="op">=</span> <span class="fl">1.1</span>,
    width <span class="op">=</span> <span class="fl">1</span>, 
    point_colour <span class="op">=</span> <span class="cn">NA</span>
   <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>
    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">.15</span>, 
    outlier.shape <span class="op">=</span> <span class="cn">NA</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">1.3</span>,
    alpha <span class="op">=</span> <span class="fl">.3</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span> 
      seed <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">.05</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> 
    title <span class="op">=</span> <span class="st">"Distribution of TEST Absolute Score "</span>,
    x <span class="op">=</span> <span class="st">"Condition"</span>, y <span class="op">=</span> <span class="st">"Total Absolute Score (Test Phase)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="cn">NA</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-IND-TESTSCORE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="independent-samples-t-test-students-t" class="level3"><h3 class="anchored" data-anchor-id="independent-samples-t-test-students-t">Independent Samples T-Test (Student’s T)</h3>
<ul>
<li>Tests null hypothesis that true difference in population mean is == 0</li>
<li>Assumes normally distributed variables</li>
<li>Assumes equal variance of samples (homogeneity of variance)</li>
<li>
<strong>SGC accuracy data violate both homogeneity and normality</strong>*</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span> <span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>,data <span class="op">=</span> <span class="va">df</span>,
              paired <span class="op">=</span> <span class="cn">FALSE</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"two.sided"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># less, greater for one sided tests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  test_score by condition
t = -3, df = 124, p-value = 0.006
alternative hypothesis: true difference in means between group control and group impasse is not equal to 0
95 percent confidence interval:
 -2.759 -0.478
sample estimates:
mean in group control mean in group impasse 
                 1.71                  3.33 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in effectsize.htest(x, type = type, verbose = verbose, ...): Unable to
retrieve data from htest object. Using t_to_d() approximation.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

The Two Sample t-test testing the difference of test_score by condition (mean in group control = 1.71, mean in group impasse = 3.33) suggests that the effect is negative, statistically significant, and medium (difference = -1.62, 95% CI [-2.76, -0.48], t(124) = -2.81, p = 0.006; Cohen's d = -0.50, 95% CI [-0.86, -0.15])</code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STATSPLOT | VIOLIN</span>

<span class="co">#one tailed tests must be done manually by extracting results expression and adding as subtitle</span>
<span class="co">#default is two tailed test</span>
<span class="co"># results &lt;- two_sample_test( data = df, x = pretty_condition, </span>
<span class="co">#                             y = item_test_NABS,</span>
<span class="co">#                             alternative = "g")</span>

<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html">ggbetweenstats</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">test_score</span>, x <span class="op">=</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
               type <span class="op">=</span> <span class="st">"parametric"</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>,
               alternative  <span class="op">=</span> <span class="st">"g"</span>,
               pairwide.display <span class="op">=</span> <span class="st">"significant"</span>, <span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># + labs(subtitle = results$expression[[1]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="independent-samples-t-test-welchs-t" class="level3"><h3 class="anchored" data-anchor-id="independent-samples-t-test-welchs-t">Independent Samples T-Test (Welch’s T)</h3>
<ul>
<li>Tests null hypothesis that true difference in population mean is == 0</li>
<li>Assumes normally distributed variables</li>
<li>
<strong>Does not</strong> assumes equal variance of samples (homogeneity of variance)</li>
<li><strong><em>SGC accuracy data violates normality assumption</em></strong></li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span> <span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>,data <span class="op">=</span> <span class="va">df</span>,
              paired <span class="op">=</span> <span class="cn">FALSE</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  test_score by condition
t = -3, df = 123, p-value = 0.006
alternative hypothesis: true difference in means between group control and group impasse is not equal to 0
95 percent confidence interval:
 -2.76 -0.48
sample estimates:
mean in group control mean in group impasse 
                 1.71                  3.33 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in effectsize.htest(x, type = type, verbose = verbose, ...): Unable to
retrieve data from htest object. Using t_to_d() approximation.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

The Welch Two Sample t-test testing the difference of test_score by condition (mean in group control = 1.71, mean in group impasse = 3.33) suggests that the effect is negative, statistically significant, and medium (difference = -1.62, 95% CI [-2.76, -0.48], t(123.25) = -2.81, p = 0.006; Cohen's d = -0.51, 95% CI [-0.86, -0.15])</code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STATSPLOT | VIOLIN</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html">ggbetweenstats</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">test_score</span>, x <span class="op">=</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
               type <span class="op">=</span> <span class="st">"parametric"</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span>,
               pairwide.display <span class="op">=</span> <span class="st">"significant"</span>, <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="yuens-t-test-trimmed-means" class="level3"><h3 class="anchored" data-anchor-id="yuens-t-test-trimmed-means">Yuen’s T-Test (Trimmed Means)</h3>
<ul>
<li>
<strong>Robust alternative to</strong> to t-test is Yuen’s t-test which uses trimmed means</li>
<li>Trimmed means are not desireable for this research scenario because they trim data from the extremes, and in this study these are true, interesting values</li>
<li><a href="https://garstats.wordpress.com/2017/11/28/trimmed-means/" class="uri">https://garstats.wordpress.com/2017/11/28/trimmed-means/</a></li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WRS2/man/yuen.html">yuenbt</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
              side <span class="op">=</span> <span class="cn">TRUE</span>, EQVAR <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Call:
yuenbt(formula = test_score ~ condition, data = df, side = TRUE, 
    EQVAR = FALSE)

Test statistic: -2.99 (df = NA), p-value = 0

Trimmed mean difference:  -2.53 
95 percent confidence interval:
-4.03     -1.03 </code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STATSPLOT | VIOLIN</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html">ggbetweenstats</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">test_score</span>, x <span class="op">=</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
               type <span class="op">=</span> <span class="st">"robust"</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span>,
               pairwide.display <span class="op">=</span> <span class="st">"significant"</span>, <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="wilcoxon-rank-sum-mann-whitney-test" class="level3"><h3 class="anchored" data-anchor-id="wilcoxon-rank-sum-mann-whitney-test">Wilcoxon Rank Sum (Mann-Whitney Test)</h3>
<ul>
<li>
<strong>Non parametric alternative</strong> to t-test; compares median rather than mean by ranking data</li>
<li>Does not assume normality</li>
<li>Does not assume equal variance of samples (homogeneity of variance)</li>
<li><strong>Appropriate for SGC accuracy data</strong></li>
<li>https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/#two-sample-wilcoxon-test</li>
<li>https://data.library.virginia.edu/the-wilcoxon-rank-sum-test/</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>,
                 paired <span class="op">=</span> <span class="cn">FALSE</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span><span class="op">)</span> <span class="co">#less, greater</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df$test_score by df$condition
W = 1438, p-value = 0.003
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>

The Wilcoxon rank sum test with continuity correction testing the difference in ranks between df$test_score and df$condition suggests that the effect is negative, statistically significant, and medium (W = 1438.00, p = 0.003; r (rank biserial) = -0.28, 95% CI [-0.45, -0.08])</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#effect size</span>
<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/wilcox_effsize.html">wilcox_effsize</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.        group1  group2  effsize    n1    n2 magnitude
* &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 test_score control impasse   0.263    62    64 small    </code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STATSPLOT | VIOLIN</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html">ggbetweenstats</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">test_score</span>, x <span class="op">=</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>,
               type <span class="op">=</span> <span class="st">"nonparametric"</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span>,
               pairwide.display <span class="op">=</span> <span class="st">"significant"</span>, <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="floorceiling-corrections-wilcoxon-rank-sum" class="level3"><h3 class="anchored" data-anchor-id="floorceiling-corrections-wilcoxon-rank-sum">Floor/Ceiling Corrections + Wilcoxon Rank Sum</h3>
<ul>
<li>The bimodal distribution of the subject-level score data do not meet the requirements for t-tests.</li>
<li>However, a non-parametric alternative is available (Wilcoxon rank sum test / Man-Whitney test)</li>
<li>Additional corrections are available for data with ‘floor’ and/or ‘ceiling’ effects via the ‘DACR’ package</li>
<li>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14 see also https://qmliu.shinyapps.io/DACFE/</li>
</ul>
<p>For comparison we run a standard followed by a Wilcoxon rank-sum (Mann-Whitney) test that is a nonparametric alternative for non-normally distributed data.</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df$test_score by df$condition
W = 1438, p-value = 0.003
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>Next, we calculate the t-test and ANOVA (F-test) based on a series of corrections provided for data with floor and/or ceiling effects.</p>
<ul>
<li><a href="https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14" class="uri">https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14</a></li>
</ul>
<p>Using properties from truncated normal distributions, the authors propose an easy-to-use method for the <em>t</em>-test and ANOVA with ceiling/floor data.</p>
<p><em>The proposed method calculates the degrees of freedom based on the after-truncation sample sizes (where l = number of floor observations, and r = number of ceiling observations). The rationale was that the proposed method utilizes full information only from data points of n − r − l participants and partial information from data points of r + l participants of a group for the mean and variance estimation. Specifically, the corrected mean and variance estimates (Eqs. 14 and 15) are functions of mean and variance estimates using after-truncation data (n − r − l participants) and the standardized floor and ceiling threshold estimates. The thresholds are estimated using the ceiling and floor percentage estimates based on data points of n − r and n − l participants, respectively. This is a relatively conservative approach for calculating the degrees of freedom, which can help control the type I error rate. This feature can be beneficial, especially given the “replication crisis” in psychological and behavioral research.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FLOOR-CEILING ADJUSTED T TESTS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DACF</span><span class="op">)</span> <span class="co">#tests for data with floor and ceiling </span>
<span class="co"># https://www.rdocumentation.org/packages/DACF/versions/1.0.0</span>

<span class="co">#prepare data [vector of scores for each group]</span>
<span class="va">score_111</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">test_score</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">score_121</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"impasse"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">test_score</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># recover the mean and variance for ceiling/floor data</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DACF/man/rec.mean.var.html">rec.mean.var</a></span><span class="op">(</span><span class="va">score_111</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># recover the mean and variance for ceiling/floor data</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DACF/man/rec.mean.var.html">rec.mean.var</a></span><span class="op">(</span><span class="va">score_121</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="st">"control"</span><span class="op">=</span><span class="va">a</span> ,<span class="st">"impasse"</span><span class="op">=</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>
<span class="va">r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        ceiling.percentage floor.percentage est.mean est.var
control              0.113            0.710    -7.70   207.4
impasse              0.172            0.422     2.39    51.8</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># method "a" uses original sample size</span>
<span class="co"># method "b" uses after-truncation sample size</span>

<span class="co"># perform adjusted t test</span>
<span class="fu"><a href="https://rdrr.io/pkg/DACF/man/lw.t.test.html">lw.t.test</a></span><span class="op">(</span><span class="va">score_111</span>,<span class="va">score_121</span>,<span class="st">"b"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$statistic
[1] -4.94

$p.value
[1] 0.000012

$est.d
[1] -0.887

$conf.int
[1] -14.22  -5.97</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FLOOR-CEILING ADJUSTED F* TEST ANOVA</span>
<span class="fu"><a href="https://rdrr.io/pkg/DACF/man/lw.f.star.html">lw.f.star</a></span><span class="op">(</span><span class="va">df</span>,<span class="va">test_score</span><span class="op">~</span><span class="va">condition</span>,<span class="st">"b"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$statistic
[1] 5.85

$p.value
[1] 0.0321

$est.f.squared
[1] 0.158</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># method "a" uses original sample size</span>
<span class="co"># method "b" uses after-truncation sample size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>The control condition has 11% of data at ceiling and 71% at floor, with corrected mean of -7 and variance of 207. The impasse condition has 17% at ceiling, and only 42% at floor, with with corrected mean of 2.39 and variance respectively as of 58.</em></p>
<p><em>A corrected t-test t statistic is -4.94, p = 0.05. The estimated Cohen’s d is -0.89 with a confidence interval 0f [-14.22, -5.97].</em></p>
<p><em>A correct F-test (ANOVA) has a corrected F-statstic of 5.85, p &lt; 0.05, and Fsquared effect size of 0.195</em></p>
</section><section id="linear-regression" class="level3"><h3 class="anchored" data-anchor-id="linear-regression">Linear Regression</h3>
<ul>
<li>Assumes homogeneity of variance</li>
<li>Assumes normally distributed residuals</li>
<li>when default dummy coding is used;
<ul>
<li>intercept = predicted mean of first group,</li>
<li>predictor coefficient = difference to mean of second group</li>
</ul>
</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SCORE predicted by CONDITION</span>
<span class="va">lm.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = test_score ~ condition, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
 -3.33  -1.71  -1.71   3.67   6.29 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         1.710      0.411    4.16 0.000058 ***
conditionimpasse    1.618      0.576    2.81   0.0058 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.23 on 124 degrees of freedom
Multiple R-squared:  0.0598,    Adjusted R-squared:  0.0522 
F-statistic: 7.89 on 1 and 124 DF,  p-value: 0.00579</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Partition Variance"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: test_score
           Df Sum Sq Mean Sq F value Pr(&gt;F)   
condition   1     82    82.5    7.89 0.0058 **
Residuals 124   1297    10.5                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Confidence Interval on Parameter Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
(Intercept)      0.897   2.52
conditionimpasse 0.478   2.76</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span> <span class="co">#sanity check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict test_score with condition (formula: test_score ~ condition). The model explains a statistically significant and weak proportion of variance (R2 = 0.06, F(1, 124) = 7.89, p = 0.006, adj. R2 = 0.05). The model's intercept, corresponding to condition = control, is at 1.71 (95% CI [0.90, 2.52], t(124) = 4.16, p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically significant and positive (beta = 1.62, 95% CI [0.48, 2.76], t(124) = 2.81, p = 0.006; Std. beta = 0.49, 95% CI [0.14, 0.83])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span>

<span class="co">#setup references</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="va">lm.1</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span>
<span class="va">call</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">$</span><span class="va">call</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># uncertainty model visualization</span>
<span class="va">df</span>  <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">modelr</span><span class="fu">::</span><span class="fu"><a href="https://modelr.tidyverse.org/reference/data_grid.html">data_grid</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">lm.1</span>, newdata <span class="op">=</span> <span class="va">.</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">condition</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span> scale <span class="op">=</span> <span class="fl">.5</span>,
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
        xdist <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_student_t.html">dist_student_t</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">.fitted</span>, sigma <span class="op">=</span> <span class="va">.se.fit</span><span class="op">)</span>,
        fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/cut_cdf_qi.html">cut_cdf_qi</a></span><span class="op">(</span><span class="va">cdf</span>,
                .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.90</span>, <span class="fl">.95</span><span class="op">)</span>,
                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span> <span class="op">(</span>title <span class="op">=</span> <span class="st">"(LAB) Test Phase Accuracy ~ Condition"</span>,
        x <span class="op">=</span> <span class="st">"model predicted mean (% correct)"</span>, y <span class="op">=</span> <span class="st">"Condition"</span>, fill <span class="op">=</span> <span class="st">"Interval"</span>,
        subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"lm("</span>,<span class="va">call</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">")"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/PLOT-MODEL-COEFSS-GGDIST-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#sjPlot</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">lm.1</span>,  type <span class="op">=</span> <span class="st">"eff"</span>, 
           show.data <span class="op">=</span> <span class="cn">TRUE</span>, jitter <span class="op">=</span> <span class="cn">TRUE</span>,
           show.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 

<span class="co">#BS TO MANUALLY ADD REGRESSION FORMULA AS SUBTITLE </span>
<span class="co"># library(equatiomatic)</span>
<span class="co"># library(latex2exp)</span>
<span class="co"># (x &lt;- extract_eq(lm.1, use_coefs = TRUE, ital_vars=TRUE, coef_digits = 1, raw_tex = FALSE))</span>
<span class="co"># b = TeX(x)</span>
<span class="co"># p1[["condition"]][["labels"]][["subtitle"]]= expression( paste(widehat(accuracy), " = ", 1.7, " + ", "1.6", "*", condition[impasse]) )</span>
<span class="va">p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/PLOT-MODEL-PRED-SJPLOT-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="censored-tobit-regression" class="level3"><h3 class="anchored" data-anchor-id="censored-tobit-regression">Censored (Tobit) Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/tobit-models/" class="uri">https://stats.oarc.ucla.edu/r/dae/tobit-models/</a></p>
<p><strong>For censored data (i.e.&nbsp;truncated axis).</strong> The tobit model, also called a censored regression model, is designed to estimate linear relationships between variables when there is either left- or right-censoring in the dependent variable (also known as censoring from below and above, respectively). Censoring from above takes place when cases with a value at or above some threshold, all take on the value of that threshold, so that the true value might be equal to the threshold, but it might also be higher. In the case of censoring from below, values those that fall at or below some threshold are censored.</p>
<ul>
<li>censored vs truncated : There is sometimes confusion about the difference between truncated data and censored data.</li>
<li>With censored variables, all of the observations are in the dataset, but we don’t know the “true” values of some of them.</li>
<li>With truncation some of the observations are not included in the analysis because of the value of the variable.</li>
<li>When a variable is censored, regression models for truncated data provide inconsistent estimates of the parameters. See Long (1997, chapter 7) for a more detailed discussion of problems of using regression models for truncated data to analyze censored data.</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#set censoring values </span>
<span class="va">lo</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">hi</span> <span class="op">=</span> <span class="fl">8</span> 
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">test_score</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0 8</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Lo and Hi should equate to upper and lower bounds of the # Qs "</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Lo and Hi should equate to upper and lower bounds of the # Qs "</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/">VGAM</a></span><span class="op">)</span>

<span class="co">#FIT MODEL</span>
<span class="va">m1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html">vglm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html">tobit</a></span><span class="op">(</span>Lower <span class="op">=</span> <span class="va">lo</span>, Upper <span class="op">=</span><span class="va">hi</span> <span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
vglm(formula = test_score ~ condition, family = tobit(Lower = lo, 
    Upper = hi), data = df)

Coefficients: 
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1      -4.185      1.483   -2.82   0.0048 ** 
(Intercept):2       2.203      0.127   17.38   &lt;2e-16 ***
conditionimpasse    5.577      1.982    2.81   0.0049 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Names of linear predictors: mu, loglink(sd)

Log-likelihood: -196 on 249 degrees of freedom

Number of Fisher scoring iterations: 11 

No Hauck-Donner effect found in any of the estimates</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CONFIDENCE INTERVALS</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vcovvlm.html">vcov</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>LL <span class="op">=</span> <span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span>, UL <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                    LL    UL
(Intercept):1    -7.09 -1.28
(Intercept):2     1.95  2.45
conditionimpasse  1.69  9.46</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TEST FIT</span>
<span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html">vglm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html">tobit</a></span><span class="op">(</span>Lower <span class="op">=</span> <span class="va">lo</span>, Upper <span class="op">=</span> <span class="va">hi</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0134</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, <span class="va">p</span> <span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P value of likelihood ratio test less than alpha = 0.05?  TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name | Model |     AIC | AIC weights |     BIC | BIC weights |  RMSE | Sigma
----------------------------------------------------------------------------
m0   |  vglm | 404.682 |       0.035 | 410.355 |       0.131 | 7.529 | 7.560
m1   |  vglm | 398.060 |       0.965 | 406.569 |       0.869 | 7.101 | 7.144</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#DIAGNOSTICS</span>
<span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">yhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="op">{</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">rr</span>, main <span class="op">=</span> <span class="st">"Fitted vs Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">rr</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">rp</span>, main <span class="op">=</span> <span class="st">"Fitted vs Pearson Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">rp</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">test_score</span>, <span class="va">rp</span>, main <span class="op">=</span> <span class="st">"Actual vs Pearson Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">test_score</span>, <span class="va">yhat</span>, main <span class="op">=</span> <span class="st">"Actual vs Fitted"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-17-5.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#VARIANCE ACCOUNTED FOR</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"VARIANCE ACCOUNTED FOR"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "VARIANCE ACCOUNTED FOR"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># correlation</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">test_score</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.245</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># variance accounted for</span>
<span class="va">r</span><span class="op">^</span><span class="fl">2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0598</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |  RMSE | Sigma
---------------------------------
398.060 | 406.569 | 7.101 | 7.144</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#NOTE: censReg package also does Tobit regression [including mixed models]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>The coefficient labeled “(Intercept):1” is the intercept or constant for the model.</li>
<li>The coefficient labeled “(Intercept):2” is an ancillary statistic. If we exponentiate this value, we get a statistic that is analogous to the square root of the residual variance in OLS regression. logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</li>
<li>The predicted value of test_phase_score is 5.75 points <em>higher</em> for students in the impasse condition than for students in the control condition. (72% improvement in score!)</li>
</ul>
<p><strong>Using censReg package</strong> - https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sampleSelection.org">censReg</a></span><span class="op">)</span> <span class="co">#censored regression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'censReg' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maxLik</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: miscTools</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite the 'maxLik' package as:
Henningsen, Arne and Toomet, Ott (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics 26(3), 443-458. DOI 10.1007/s00180-010-0217-1.

If you have questions, suggestions, or comments regarding the 'maxLik' package, please use a forum or 'tracker' at maxLik's R-Forge site:
https://r-forge.r-project.org/projects/maxlik/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite the 'censReg' package as:
Henningsen, Arne (2017). censReg: Censored Regression (Tobit) Models. R package version 0.5. http://CRAN.R-Project.org/package=censReg.

If you have questions, suggestions, or comments regarding the 'censReg' package, please use a forum or 'tracker' at the R-Forge site of the 'sampleSelection' project:
https://r-forge.r-project.org/projects/sampleselection/</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT MODEL</span>
<span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/censReg/man/censReg.html">censReg</a></span><span class="op">(</span> <span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, left<span class="op">=</span><span class="va">lo</span>, right<span class="op">=</span><span class="va">hi</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = test_score ~ condition, left = lo, right = hi, 
    data = df)

Observations:
         Total  Left-censored     Uncensored Right-censored 
           126             71             37             18 

Coefficients:
                 Estimate Std. error t value Pr(&gt; t)    
(Intercept)       -4.1854     1.7149  -2.441 0.01466 *  
conditionimpasse   5.5775     1.9995   2.789 0.00528 ** 
logSigma           2.2033     0.1424  15.471 &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -196 on 3 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CONFIDENCE INTERVALS</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vcovvlm.html">vcov</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>LL <span class="op">=</span> <span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span>, UL <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                    LL     UL
(Intercept)      -7.55 -0.824
conditionimpasse  1.66  9.496
logSigma          1.92  2.482</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TEST FIT</span>
<span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span>

<span class="va">c0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/censReg/man/censReg.html">censReg</a></span><span class="op">(</span> <span class="va">test_score</span> <span class="op">~</span> <span class="fl">1</span>, left<span class="op">=</span><span class="va">lo</span>, right<span class="op">=</span><span class="va">hi</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">c0</span><span class="op">)</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 0.0134 (df=3)</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, <span class="va">p</span> <span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P value of likelihood ratio test less than alpha = 0.05?  TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in get_residuals.default(model, verbose = verbose, type = "response", :
Can't extract residuals from model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Response residuals not available to calculate mean square error. (R)MSE
  is probably not reliable.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC
-----------------
398.060 | 406.569</code></pre>
</div>
</div>
<ul>
<li>logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</li>
<li>output should match that of VGAM</li>
</ul></section></section><section id="count-outcome" class="level2"><h2 class="anchored" data-anchor-id="count-outcome">COUNT OUTCOME</h2>
<p><strong>Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?<br>
(# questions correct on test phase of task, [in lab] participants)</strong></p>
<p>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can try considering it a type of <em>count</em>, (i.e.&nbsp;count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function). Note that the process of answering questions on a test do not seem to strictly match the assumptions of a Poisson process.</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::SETUP DATA</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  condition min Q1 median Q3 max mean   sd  n missing
1   control   0  0      0  1   8 1.71 3.05 62       0
2   impasse   0  0      2  7   8 3.33 3.40 64       0</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>

<span class="co"># #GGFORMULA | FACETED HISTOGRAM</span>
<span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span>
<span class="co"># gf_props(~item_test_NABS, </span>
<span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span>
<span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span>
<span class="co">#   labs(x = "# Correct",</span>
<span class="co">#        y = "proportion of subjects",</span>
<span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span>
<span class="co">#        subtitle = "") + theme(legend.position = "blank")</span>

<span class="co">##GGPUBR | HIST+DENSITY SCORE </span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/gghistogram.html">gghistogram</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="st">"test_score"</span>, binwidth <span class="op">=</span> <span class="fl">0.5</span>,
   add <span class="op">=</span> <span class="st">"mean"</span>, rug <span class="op">=</span> <span class="cn">TRUE</span>,
   fill <span class="op">=</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span>
   add_density <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/facet.html">facet</a></span><span class="op">(</span><span class="va">p</span>, facet.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Distribution of TEST Absolute Score"</span>,
        subtitle <span class="op">=</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,
        x <span class="op">=</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, y <span class="op">=</span> <span class="st">"number of subjects"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-COUNT-TESTSCORE-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">##VERTICAL RAINCLOUD USING GGDISTR</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span>,
                        fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span>
    side <span class="op">=</span> <span class="st">"left"</span>,
    justification <span class="op">=</span> <span class="fl">1.1</span>,
    width <span class="op">=</span> <span class="fl">1</span>, 
    point_colour <span class="op">=</span> <span class="cn">NA</span>
   <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>
    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">.15</span>, 
    outlier.shape <span class="op">=</span> <span class="cn">NA</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">test_score</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">1.3</span>,
    alpha <span class="op">=</span> <span class="fl">.3</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span> 
      seed <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">.05</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> 
    title <span class="op">=</span> <span class="st">"Distribution of TEST Absolute Score "</span>,
    x <span class="op">=</span> <span class="st">"Condition"</span>, y <span class="op">=</span> <span class="st">"Total Absolute Score (Test Phase)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="cn">NA</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-COUNT-TESTSCORE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="poisson-regression" class="level3"><h3 class="anchored" data-anchor-id="poisson-regression">Poisson Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/poisson-regression/" class="uri">https://stats.oarc.ucla.edu/r/dae/poisson-regression/</a><br><em>General Linear model using the Poisson distribution</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span>
<span class="va">p.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://jtools.jacob-long.com/reference/summ.html">summ</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 126 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> test_score </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> Generalized linear model </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Family </td>
   <td style="text-align:right;"> poisson </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Link </td>
   <td style="text-align:right;"> log </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> 𝛘²(1) </td>
   <td style="text-align:right;"> 33.28 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (Cragg-Uhler) </td>
   <td style="text-align:right;"> 0.23 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (McFadden) </td>
   <td style="text-align:right;"> 0.04 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> AIC </td>
   <td style="text-align:right;"> 764.95 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> BIC </td>
   <td style="text-align:right;"> 770.62 </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> z val. </th>
   <th style="text-align:right;"> p </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> 0.54 </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 5.52 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> conditionimpasse </td>
   <td style="text-align:right;"> 0.67 </td>
   <td style="text-align:right;"> 0.12 </td>
   <td style="text-align:right;"> 5.60 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: MLE</td></tr></tfoot>
</table>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Partition Variance"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: poisson, link: log

Response: test_score

Terms added sequentially (first to last)

          Df Deviance Resid. Df Resid. Dev
NULL                        125        604
condition  1     33.3       124        570</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Confidence Interval on Parameter Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/maxLik/man/confint.maxLik.html">confint</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
(Intercept)      0.340  0.721
conditionimpasse 0.436  0.902</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span> <span class="co">#sanity check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a poisson model (estimated using ML) to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is moderate (Nagelkerke's R2 = 0.23). The model's intercept, corresponding to condition = control, is at 0.54 (95% CI [0.34, 0.72], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically significant and positive (beta = 0.67, 95% CI [0.44, 0.90], p &lt; .001; Std. beta = 0.67, 95% CI [0.44, 0.90])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The variable condition has a coefficient of 0.67, (p &lt; 0.005). This means that for the impasse condition, the expected log count # of questions increases by 0.67. By exponentiating the estimate we see that # question correct rate for the impasse condition is 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.</em></p>
</section><section id="negative-binomial-regression" class="level3"><h3 class="anchored" data-anchor-id="negative-binomial-regression">Negative Binomial Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/" class="uri">https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/</a> -<em>overdispersed count data (variance much greater than mean)</em></p>
<ul>
<li>similar to Poisson regression, but using the negative binomial distribution, which can better account for ‘overdispersed’ data where variance is much greater than the mean</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>

<span class="co">#fit model </span>
<span class="va">nb.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>

<span class="co">#check overdispersion need </span>
<span class="co">#assumes conditional means are not equal to conditional variances</span>
<span class="co">#conduct likelihood ration test to compare and test [need poisson]</span>
<span class="va">m.t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co">#pchisq(2 * (logLik(nb.1) - logLik(m.t)), df = 1, lower.tail = FALSE)</span>
<span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m.t</span>, <span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name |  Model | df | df_diff |   Chi2 |      p
----------------------------------------------
m.t  |    glm |  2 |         |        |       
nb.1 | negbin |  3 |       1 | 277.71 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span>
<span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#exponentiate parameter estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Exponentiated Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Exponentiated Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 Estimate 2.5 % 97.5 %
(Intercept)          1.71  1.07   2.89
conditionimpasse     1.95  0.98   3.86</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = test_score ~ condition, data = df, init.theta = 0.2977734703, 
    link = log)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.220  -1.066  -1.066   0.447   1.067  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)         0.536      0.252    2.13    0.033 *
conditionimpasse    0.666      0.348    1.92    0.055 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(0.298) family taken to be 1)

    Null deviance: 114.32  on 125  degrees of freedom
Residual deviance: 110.70  on 124  degrees of freedom
AIC: 489.2

Number of Fisher Scoring iterations: 1

              Theta:  0.2978 
          Std. Err.:  0.0586 

 2 x log-likelihood:  -483.2380 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a negative-binomial model (estimated using ML) to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is weak (Nagelkerke's R2 = 0.05). The model's intercept, corresponding to condition = control, is at 0.54 (95% CI [0.07, 1.06], p = 0.033). Within this model:

  - The effect of condition [impasse] is statistically non-significant and positive (beta = 0.67, 95% CI [-0.02, 1.35], p = 0.055; Std. beta = 0.67, 95% CI [-0.02, 1.35])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The variable condition has a coefficient of 0.67, (p &lt; 0.005). This means that for the impasse condition, the expected log count # of questions increases by 0.67. By exponentiating the estimate we see that # question correct rate for the impasse condition is nearly 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#COMPARE POISSON AND NEGATIVE BINOMIAL</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">p.1</span>, <span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name |  Model |     AIC | AIC weights |     BIC | BIC weights | Nagelkerke's R2 |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------------------------------------------------
p.1  |    glm | 764.945 |     &lt; 0.001 | 770.618 |     &lt; 0.001 |           0.234 | 3.208 | 2.145 |    -3.020 |           0.069
nb.1 | negbin | 489.238 |        1.00 | 497.747 |        1.00 |           0.048 | 3.208 | 0.945 |    -2.213 |           0.074</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">p.1</span>, <span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name |  Model | df | df_diff |   Chi2 |      p
----------------------------------------------
p.1  |    glm |  2 |         |        |       
nb.1 | negbin |  3 |       1 | 277.71 | &lt; .001</code></pre>
</div>
</div>
<p><em>AIC, Pseudo-R2 and a likelihood ratio test indicate that the negative binomial regression model are a better fit for the distribution of test-phase scores.</em></p>
</section></section><section id="mixture-models" class="level2"><h2 class="anchored" data-anchor-id="mixture-models">MIXTURE MODELS</h2>
<section id="zero-inflated-poisson" class="level3"><h3 class="anchored" data-anchor-id="zero-inflated-poisson">Zero Inflated Poisson</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/zip/" class="uri">https://stats.oarc.ucla.edu/r/dae/zip/</a><br><em>A Poisson count process with excess zeros</em></p>
<ul>
<li>The Zero-Inflated model allows specification of two models (a mixture) where <em>some</em> of the zeros are included in the DGP for the Poisson model, while only the ‘excess’ zeros are included in the DGP for the Binomial model [the zero-inflated part]</li>
<li>The model includes:
<ul>
<li>A logistic model to model which of the two processes the zero outcome is associated with</li>
<li>A poisson model to model the count process</li>
</ul>
</li>
<li>Can specify different predictors for each part of the model</li>
<li>predictors after the | are for the binomial zero-inflated part of the model, while those infront are for the poisson process</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#ZERO INFLATED POISSON</span>

<span class="va">zinfp.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span>  <span class="va">condition</span><span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = test_score ~ condition | condition, data = df)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.988 -0.575 -0.575  1.090  2.117 

Count model coefficients (poisson with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7702     0.0979   18.07   &lt;2e-16 ***
conditionimpasse  -0.0231     0.1199   -0.19     0.85    

Zero-inflation model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)         0.890      0.280    3.18   0.0015 **
conditionimpasse   -1.213      0.378   -3.21   0.0013 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 7 
Log-likelihood: -213 on 4 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated poisson model to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is substantial (R2 = 0.39, adj. R2 = 0.38). The model's intercept, corresponding to condition = control, is at 1.77 (95% CI [1.58, 1.96], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically non-significant and negative (beta = -0.02, 95% CI [-0.26, 0.21], p = 0.847; Std. beta = -0.02, 95% CI [-0.26, 0.21])
  - The effect of condition [impasse] is statistically significant and negative (beta = -1.21, 95% CI [-1.95, -0.47], p = 0.001; Std. beta = -1.21, 95% CI [-1.95, -0.47])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------
434.837 | 446.183 | 0.391 |     0.381 | 3.208 | 3.260 |    -1.694 |           0.069</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#check_model(zinfp.1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>In the count model, the coefficient for the condition is not significant.</em></p>
<p><em>In the zero-inflation model, the coefficient for the condition variable is -1.23 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.23 if you are in the impasse condition</em></p>
</section><section id="zero-inflated-negative-binomial-regression" class="level3"><h3 class="anchored" data-anchor-id="zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</h3>
<p><a href="https://stats.oarc.ucla.edu/r/dae/zinb/" class="uri">https://stats.oarc.ucla.edu/r/dae/zinb/</a><br><em>count data that are overdispersed and have excess zeros</em></p>
<p>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the <em>excess</em> zeros can be modelled independently.</p>
<p>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different ‘process’ … (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) &lt;- this could maybe be disentangled by first question latency?</p>
<p>The model includes:</p>
<ul>
<li>A logistic model to model which of the two processes the zero outcome is associated with</li>
<li>A negative binomial model to model the count process</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#  for zeroinfl negbinomial</span>

<span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span>
<span class="va">zinb.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , 
                   data <span class="op">=</span> <span class="va">df</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span>
<span class="co">#before the | is the count part, after the | is the logit model</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = test_score ~ condition | condition, data = df, dist = "negbin")

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.970 -0.568 -0.568  1.070  2.091 

Count model coefficients (negbin with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7689     0.1048   16.88   &lt;2e-16 ***
conditionimpasse  -0.0232     0.1282   -0.18    0.856    
Log(theta)         3.7504     2.1488    1.75    0.081 .  

Zero-inflation model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)         0.888      0.280    3.17   0.0015 **
conditionimpasse   -1.214      0.379   -3.21   0.0013 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta = 42.54 
Number of iterations in BFGS optimization: 7 
Log-likelihood: -213 on 5 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated negative-binomial model to predict test_score with condition (formula: test_score ~ condition). The model's explanatory power is substantial (R2 = 0.40, adj. R2 = 0.39). The model's intercept, corresponding to condition = control, is at 1.77 (95% CI [1.56, 1.97], p &lt; .001). Within this model:

  - The effect of condition [impasse] is statistically non-significant and negative (beta = -0.02, 95% CI [-0.27, 0.23], p = 0.856; Std. beta = -0.02, 95% CI [-0.27, 0.23])
  - The effect of condition [impasse] is statistically significant and negative (beta = -1.21, 95% CI [-1.96, -0.47], p = 0.001; Std. beta = -1.21, 95% CI [-1.96, -0.47])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-----------------------------------------------------------------------------------
436.585 | 450.766 | 0.398 |     0.388 | 3.208 | 3.274 |    -1.740 |           0.068</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#   rootogram(zinb.1)</span>



<span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span>
<span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span>
<span class="co"># #exponentiate parameter estimates</span>
<span class="co"># print("Exponentiated Estimates")</span>
<span class="co"># exp(est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).</em></p>
<p><em>In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">zinfp.1</span>, <span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name    |    Model |     AIC | AIC weights |     BIC | BIC weights |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
------------------------------------------------------------------------------------------------------------------------------------
zinfp.1 | zeroinfl | 434.837 |       0.705 | 446.183 |       0.908 | 0.391 |     0.381 | 3.208 | 3.260 |    -1.694 |           0.069
zinb.1  | zeroinfl | 436.585 |       0.295 | 450.766 |       0.092 | 0.398 |     0.388 | 3.208 | 3.274 |    -1.740 |           0.068</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_likelihoodratio</a></span><span class="op">(</span><span class="va">zinfp.1</span>, <span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name    |    Model | df | df_diff | Chi2 |     p
------------------------------------------------
zinfp.1 | zeroinfl |  4 |         |      |      
zinb.1  | zeroinfl |  5 |       1 | 0.25 | 0.615</code></pre>
</div>
</div>
<p><strong>TODO come back to this and discuss further</strong><br></p>
</section><section id="hurdle-model" class="level3"><h3 class="anchored" data-anchor-id="hurdle-model">Hurdle Model</h3>
<ul>
<li><a href="https://data.library.virginia.edu/getting-started-with-hurdle-models/" class="uri">https://data.library.virginia.edu/getting-started-with-hurdle-models/</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values." class="uri">https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.</a></li>
</ul>
<p>class of models for count data with both overdispersion and excess zeros;<br>
different from zero-inflated models where the excess zeros are theorized to arise from two <em>different</em> processes; in the hurdle model, there is a separate model for P(x=0) and a separate model for P(x!=0)</p>
<p>The model includes:</p>
<ul>
<li><p>A binary logit model to model whether the observation takes a positive count or not. (1) Does the student get <em>any</em> questions right?</p></li>
<li><p>a truncated Poisson or Negative binomial model that only fits positive counts (2) How many questions does the student get right?</p></li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zero-inf and hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">countreg</span><span class="op">)</span> <span class="co">#rootogram</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'countreg':
  method                 from
  print.zeroinfl         pscl
  print.summary.zeroinfl pscl
  summary.zeroinfl       pscl
  coef.zeroinfl          pscl
  vcov.zeroinfl          pscl
  logLik.zeroinfl        pscl
  predict.zeroinfl       pscl
  residuals.zeroinfl     pscl
  fitted.zeroinfl        pscl
  terms.zeroinfl         pscl
  model.matrix.zeroinfl  pscl
  extractAIC.zeroinfl    pscl
  print.hurdle           pscl
  print.summary.hurdle   pscl
  summary.hurdle         pscl
  coef.hurdle            pscl
  vcov.hurdle            pscl
  logLik.hurdle          pscl
  predict.hurdle         pscl
  residuals.hurdle       pscl
  fitted.hurdle          pscl
  terms.hurdle           pscl
  model.matrix.hurdle    pscl
  extractAIC.hurdle      pscl</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'countreg'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    dzipois, pzipois, qzipois, rzipois</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:pscl':

    hurdle, hurdle.control, hurdletest, zeroinfl, zeroinfl.control</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    rootogram</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span>

<span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span>

<span class="va">h.1</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span>,
              zero.dist <span class="op">=</span> <span class="st">"binomial"</span>, dist <span class="op">=</span> <span class="st">"poisson"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = zeroDist, gr = zeroGrad, par = c(start$zero, if (zero.dist
== : unknown names in control: size</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">h.2</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span>,
              zero.dist <span class="op">=</span> <span class="st">"binomial"</span>, dist <span class="op">=</span> <span class="st">"negbin"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size

Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">h.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = test_score ~ condition | condition, data = df, 
    dist = "poisson", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.988 -0.575 -0.575  1.090  2.117 

Count model coefficients (truncated poisson with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7702     0.0979   18.07   &lt;2e-16 ***
conditionimpasse  -0.0231     0.1199   -0.19     0.85    
Zero hurdle model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)        -0.894      0.280   -3.19   0.0014 **
conditionimpasse    1.209      0.377    3.20   0.0014 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 10 
Log-likelihood: -213 on 4 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = test_score ~ condition | condition, data = df, 
    dist = "negbin", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.970 -0.568 -0.568  1.070  2.091 

Count model coefficients (truncated negbin with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.7689     0.1048   16.88   &lt;2e-16 ***
conditionimpasse  -0.0232     0.1282   -0.18    0.856    
Log(theta)         3.7506     2.1492    1.75    0.081 .  
Zero hurdle model coefficients (binomial with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)        -0.894      0.280   -3.19   0.0014 **
conditionimpasse    1.209      0.377    3.20   0.0014 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta: count = 42.546
Number of iterations in BFGS optimization: 19 
Log-likelihood: -213 on 5 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/countreg/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">h.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/countreg/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">h.1</span>,<span class="va">h.2</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">h.1</span>, <span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name |  Model | df | df_diff | Chi2 |     p
-------------------------------------------
h.1  | hurdle |  4 |         |      |      
h.2  | hurdle |  5 |       1 | 0.25 | 0.615</code></pre>
</div>
</div>
</section></section><section id="beta-regression" class="level2"><h2 class="anchored" data-anchor-id="beta-regression">BETA REGRESSION</h2>
<section id="beta-distribution" class="level3"><h3 class="anchored" data-anchor-id="beta-distribution">BETA Distribution</h3>
<p>Beta regression on % correct (with standard transformation for including [0,1])</p>
<p><a href="https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression" class="uri">https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression</a></p>
<p>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</p>
<p>If a test score is conceptualized as correct (a) and b (incorrect) score = correct / (correct + incorrect) = a/ (a + b)</p>
<p>In the beta distribution, a and b are the shape parameters!</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">theme_clean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Barlow Semi Condensed"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"BarlowSemiCondensed-Bold"</span><span class="op">)</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"BarlowSemiCondensed-Medium"</span><span class="op">)</span>,
          strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,
                                    size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
          strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey80"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>


<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbeta</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">6</span>, shape2 <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Beta(shape1 = 6, shape2 = 4)"</span><span class="op">)</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Beta a = 6, b = 4"</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbeta</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">8</span>, shape2 <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Beta(shape1 = 8, shape2 = 0.001)"</span><span class="op">)</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    <span class="st">"ALL CORRECT"</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb187"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbeta</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">0.001</span>, shape2 <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Beta(shape1 = 0.001, shape2 = 8)"</span><span class="op">)</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    <span class="st">"ALL WRONG"</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbeta</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">4</span>, shape2 <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Beta(shape1 = 4, shape2 = 4)"</span><span class="op">)</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    <span class="st">"FIGURED IT OUT HALFWAY "</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-27-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ALTERNATIVE conceptualization of a and b is as mean MU and precision PHI (same idea as variance).</p>
<p>a = mu * phi b = (1 - mu) * phi</p>
<p>MU = a / (a+b) [the score] PHI = a + b [ the total # items ]</p>
<p>The <code><a href="https://rdrr.io/pkg/extraDistr/man/PropBeta.html">extraDistr::dprop</a></code> function can also handle mu and phi parameters, named as mean and size</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb189"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/twolodzko/extraDistr">extraDistr</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'extraDistr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:miscTools':

    ddnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    rdunif</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    dfrechet, dgev, dgompertz, dgpd, dgumbel, dhuber, dkumar, dlaplace,
    dlomax, dpareto, drayleigh, dskellam, dslash, pfrechet, pgev,
    pgompertz, pgpd, pgumbel, phuber, pkumar, plaplace, plomax,
    ppareto, prayleigh, pslash, qfrechet, qgev, qgompertz, qgpd,
    qgumbel, qhuber, qkumar, qlaplace, qlomax, qpareto, qrayleigh,
    rfrechet, rgev, rgompertz, rgpd, rgumbel, rhuber, rkumar, rlaplace,
    rlomax, rpareto, rrayleigh, rskellam, rslash</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ordinal':

    dgumbel, pgumbel, qgumbel, rgumbel</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb195"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dprop</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.999</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Beta(mean = 0.99, size = 8)"</span><span class="op">)</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    <span class="st">"ALL CORRECT"</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dprop</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.001</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Beta(mean = 0.001, size = 8)"</span><span class="op">)</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    <span class="st">"ALL WRONG"</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb197"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dprop</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Beta(mean = 0.5, size = 8)"</span><span class="op">)</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    <span class="st">"FIGURED IT OUT HALFWAY "</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbeta</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">0.001</span>, shape2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Beta(shape1 = 6, shape2 = 4)"</span><span class="op">)</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Note that in all cases, we have to slightly adjust the parameters because the distribution can’t handle values at 0 or 1. So we scrunch the data in just a bit.</strong></p>
</section><section id="beta-regression-1" class="level3"><h3 class="anchored" data-anchor-id="beta-regression-1">BETA Regression</h3>
<p>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</p>
<p>The syntax is just like all other formula-based regression functions, but with an added bit: the first part of the equation (x ~ y) models the mean, or MU, while anything that comes after a | in the formula will explain variation in the precision, or PHI.</p>
<p>The link parameter determines the link function for the mu estimate?.</p>
<section id="setup" class="level4"><h4 class="anchored" data-anchor-id="setup">Setup</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb199"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betareg</span><span class="op">)</span>

<span class="co">#RESCLAE VARIABLE</span>
<span class="co">#beta reg can't handle 0s and 1s </span>
<span class="va">sub</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">DV_percent_NABS</span><span class="op">)</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">sub</span><span class="op">$</span><span class="va">dv_transformed</span> <span class="op">=</span> <span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">DV_percent_NABS</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>
 
<span class="co">#VISUALIZE VARIABLES</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Slightly squished data"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Slightly squished data"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb201"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html">histogram</a></span><span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">dv_transformed</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT MODEL</span>
<span class="va">mb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">dv_transformed</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span>, 
              data <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mb1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = dv_transformed ~ condition | condition, data = sub)

Standardized weighted residuals 2:
   Min     1Q Median     3Q    Max 
-1.065 -0.450 -0.217  0.537  1.678 

Coefficients (mean model with logit link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -0.961      0.119   -8.06  7.6e-16 ***
conditionimpasse    0.545      0.158    3.44  0.00057 ***

Phi coefficients (precision model with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       -0.4273     0.1001   -4.27    2e-05 ***
conditionimpasse   0.0212     0.1307    0.16     0.87    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood:  506 on 4 Df
Pseudo R-squared: 0.0725
Number of iterations: 16 (BFGS) + 2 (Fisher scoring) </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mb1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-29-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Which link function should be used for each? We now have two sets of coefficients, one set for each parameter (the mean and precision). The parameters for the mean are measured on the logit scale, just like with logistic regression previously, and we can calculate the marginal effect of having a quota by using plogis() and piecing together the coefficient and the intercept:</li>
</ul></section><section id="interpret" class="level4"><h4 class="anchored" data-anchor-id="interpret">Interpret</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb205"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">beta_mu_intercept</span> <span class="op">&lt;-</span> <span class="va">mb1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"mean"</span>, <span class="va">term</span> <span class="op">==</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>

<span class="va">beta_mu_condition</span> <span class="op">&lt;-</span> <span class="va">mb1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"mean"</span>, <span class="va">term</span> <span class="op">==</span> <span class="st">"conditionimpasse"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- PROBABILITIES"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- PROBABILITIES"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb207"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"[these should math pred plots]"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "[these should math pred plots]"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb209"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Probability at reference level"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability at reference level"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb211"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.277</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb213"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Probability at coefficient level"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability at coefficient level"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb215"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span> <span class="op">+</span> <span class="va">beta_mu_condition</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.397</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb217"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"CHANGE in probability by coefficient"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "CHANGE in probability by coefficient"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb219"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span> <span class="op">+</span> <span class="va">beta_mu_condition</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.121</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb221"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mb1</span>, type <span class="op">=</span> <span class="st">"pred"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Impasse increases the average of the distribution of accuracy by 12% percentage points, on average. This should match the value we get with fractional regression. (logistic regression with count variable instead of binomial)</p>
<ul>
<li>The intercept of MU indicates the average of the distribution of score proportion in the control condition</li>
<li>The coefficient of MU indicates the change in the average distribution of score proportion in the impasse condition</li>
</ul>
<p>The PHI parameter estimates are not measured on a logit scale. Instead, they’re log values. We can invert them by exponentiating them with exp(). - The phi intercept indicates the precision of the distribution of score proportion in the control condition - The phi coefficient indicates the change in the precision of the distribution of score proportion in the impasse condition</p>
<ul>
<li>CONDITION is a significant predictor of MEAN (location) but not PHI (precision). Put another way, the shape of both distributions is similar, but the impasse condition distribution is shift to the right (higher) than the control distribution.</li>
</ul></section><section id="compare" class="level4"><h4 class="anchored" data-anchor-id="compare">Compare</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb223"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># COMPARE MODELS</span>


<span class="co">#PREP DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    accuracy <span class="op">=</span> <span class="va">item_test_NABS</span><span class="op">/</span><span class="fl">8</span>,
    test_trans <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>,
    all_trans <span class="op">=</span> <span class="op">(</span><span class="va">DV_percent_NABS</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>
  <span class="op">)</span>

<span class="co"># LINEAR REGRESSION</span>
<span class="va">lm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span> <span class="va">test_trans</span> <span class="op">~</span> <span class="va">pretty_condition</span>    , data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co"># summary(lm1)</span>

<span class="co"># LINEAR REGRESSION on LOGTRANSFORMED</span>
<span class="va">qlm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">qlogis</a></span><span class="op">(</span><span class="va">test_trans</span><span class="op">)</span> <span class="op">~</span> <span class="va">pretty_condition</span>    , data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co"># summary(qlm1)</span>

<span class="co"># FRACTIONAL REGRESSION</span>
<span class="co">#uses quasibinomial [like binomial] on proportion </span>
<span class="co">#instead of binomial data. coeffs on logit scale</span>
<span class="va">flm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="va">test_trans</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">quasibinomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">flm1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = test_trans ~ pretty_condition, family = quasibinomial(), 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.014  -0.667  -0.667   0.949   1.733  

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               -1.289      0.274   -4.71  6.6e-06 ***
pretty_conditionimpasse    0.953      0.354    2.69   0.0082 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasibinomial family taken to be 0.788)

    Null deviance: 117.11  on 125  degrees of freedom
Residual deviance: 111.18  on 124  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb225"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># BETA REGRESSION predictor phi</span>
<span class="va">bm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">test_trans</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">|</span> <span class="va">pretty_condition</span>, 
              data <span class="op">=</span> <span class="va">df</span>, link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in betareg.fit(X, Y, Z, weights, offset, link, link.phi, type, control):
no valid starting value for precision parameter found, using 1 instead</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb227"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bm1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = test_trans ~ pretty_condition | pretty_condition, data = df, 
    link = "logit")

Standardized weighted residuals 2:
   Min     1Q Median     3Q    Max 
-0.867 -0.397 -0.397  0.619  1.525 

Coefficients (mean model with logit link):
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -0.851      0.186   -4.58  4.7e-06 ***
pretty_conditionimpasse    0.530      0.252    2.10    0.036 *  

Phi coefficients (precision model with log link):
                        Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)              -0.4319     0.1545   -2.80   0.0052 **
pretty_conditionimpasse  -0.0629     0.2052   -0.31   0.7593   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood:  183 on 4 Df
Pseudo R-squared: 0.0608
Number of iterations: 17 (BFGS) + 2 (Fisher scoring) </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb229"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">models</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"LM"</span> <span class="op">=</span> <span class="va">lm1</span>, 
              <span class="st">"LM log transform"</span> <span class="op">=</span> <span class="va">qlm1</span>, 
              <span class="st">"GLM Quasibinomial"</span> <span class="op">=</span> <span class="va">flm1</span>, 
              <span class="st">"beta"</span> <span class="op">=</span> <span class="va">bm1</span><span class="op">)</span>
<span class="fu"><a href="https://vincentarelbundock.github.io/modelsummary/reference/modelsummary.html">modelsummary</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in modelsummary(models): The table includes duplicate term names.
This can happen when `coef_map` or `coef_rename` are misused. This can also
happen when a model produces "grouped" terms, such as in multinomial logit or
gamlss models. You may want to call `get_estimates(model)` to see how estimates
are labelled internally, and use the `group` argument of the `modelsummary`
function.</code></pre>
</div>
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:center;"> LM </th>
   <th style="text-align:center;"> LM log transform </th>
   <th style="text-align:center;"> GLM Quasibinomial </th>
   <th style="text-align:center;"> beta </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:center;"> 0.216 </td>
   <td style="text-align:center;"> −3.241 </td>
   <td style="text-align:center;"> −1.289 </td>
   <td style="text-align:center;"> −0.432 </td>
  </tr>
<tr>
<td style="text-align:left;">  </td>
   <td style="text-align:center;"> 0.216 </td>
   <td style="text-align:center;"> −3.241 </td>
   <td style="text-align:center;"> −1.289 </td>
   <td style="text-align:center;"> −0.851 </td>
  </tr>
<tr>
<td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.051) </td>
   <td style="text-align:center;"> (0.518) </td>
   <td style="text-align:center;"> (0.274) </td>
   <td style="text-align:center;"> (0.154) </td>
  </tr>
<tr>
<td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.051) </td>
   <td style="text-align:center;"> (0.518) </td>
   <td style="text-align:center;"> (0.274) </td>
   <td style="text-align:center;"> (0.186) </td>
  </tr>
<tr>
<td style="text-align:left;"> pretty_conditionimpasse </td>
   <td style="text-align:center;"> 0.201 </td>
   <td style="text-align:center;"> 2.059 </td>
   <td style="text-align:center;"> 0.953 </td>
   <td style="text-align:center;"> −0.063 </td>
  </tr>
<tr>
<td style="text-align:left;">  </td>
   <td style="text-align:center;"> 0.201 </td>
   <td style="text-align:center;"> 2.059 </td>
   <td style="text-align:center;"> 0.953 </td>
   <td style="text-align:center;"> 0.530 </td>
  </tr>
<tr>
<td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.071) </td>
   <td style="text-align:center;"> (0.727) </td>
   <td style="text-align:center;"> (0.354) </td>
   <td style="text-align:center;"> (0.205) </td>
  </tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.071) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.727) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.354) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.252) </td>
  </tr>
<tr>
<td style="text-align:left;"> Num.Obs. </td>
   <td style="text-align:center;"> 126 </td>
   <td style="text-align:center;"> 126 </td>
   <td style="text-align:center;"> 126 </td>
   <td style="text-align:center;"> 126 </td>
  </tr>
<tr>
<td style="text-align:left;"> R2 </td>
   <td style="text-align:center;"> 0.060 </td>
   <td style="text-align:center;"> 0.061 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> R2 Adj. </td>
   <td style="text-align:center;"> 0.052 </td>
   <td style="text-align:center;"> 0.053 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> R2 Pseudo </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 0.061 </td>
  </tr>
<tr>
<td style="text-align:left;"> AIC </td>
   <td style="text-align:center;"> 131.3 </td>
   <td style="text-align:center;"> 715.9 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> −357.1 </td>
  </tr>
<tr>
<td style="text-align:left;"> BIC </td>
   <td style="text-align:center;"> 139.8 </td>
   <td style="text-align:center;"> 724.4 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> −345.7 </td>
  </tr>
<tr>
<td style="text-align:left;"> Log.Lik. </td>
   <td style="text-align:center;"> −62.653 </td>
   <td style="text-align:center;"> −354.946 </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 182.533 </td>
  </tr>
<tr>
<td style="text-align:left;"> F </td>
   <td style="text-align:center;"> 7.887 </td>
   <td style="text-align:center;"> 8.022 </td>
   <td style="text-align:center;"> 7.225 </td>
   <td style="text-align:center;">  </td>
  </tr>
<tr>
<td style="text-align:left;"> RMSE </td>
   <td style="text-align:center;"> 0.40 </td>
   <td style="text-align:center;"> 4.08 </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;">  </td>
  </tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb231"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GET ESTIMATES</span>
<span class="va">model_beta</span> <span class="op">&lt;-</span> <span class="va">bm1</span>

<span class="va">beta_mu_intercept</span> <span class="op">&lt;-</span> <span class="va">model_beta</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"mean"</span>, <span class="va">term</span> <span class="op">==</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>

<span class="va">beta_mu_condition</span> <span class="op">&lt;-</span> <span class="va">model_beta</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"mean"</span>, <span class="va">term</span> <span class="op">==</span> <span class="st">"pretty_conditionimpasse"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>

<span class="va">beta_phi_intercept</span> <span class="op">&lt;-</span> <span class="va">model_beta</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"precision"</span>, <span class="va">term</span> <span class="op">==</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>

<span class="va">beta_phi_condition</span> <span class="op">&lt;-</span> <span class="va">model_beta</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"precision"</span>, <span class="va">term</span> <span class="op">==</span> <span class="st">"pretty_conditionimpasse"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>


<span class="va">mu_control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span><span class="op">)</span>
<span class="va">phi_control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta_phi_intercept</span><span class="op">)</span>
<span class="co">#when you don’t explicitly model the precision, the resulting coefficient in the table isn’t on the log scale—it’s a regular non-logged number, so there’s no need to exponentiate</span>

<span class="co">#PLOT ESTIMATES</span>

<span class="va">control_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"dprop(mean = plogis("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span>, <span class="fl">2</span><span class="op">)</span>,
                         <span class="st">"), size = exp("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_phi_intercept</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"))"</span><span class="op">)</span>

<span class="va">impasse_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"dprop(mean = plogis("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span>, <span class="fl">2</span><span class="op">)</span>,
                      <span class="st">" + "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_mu_condition</span>, <span class="fl">2</span><span class="op">)</span>, 
                      <span class="st">"), size = exp("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_phi_intercept</span>, <span class="fl">2</span><span class="op">)</span>,
                      <span class="st">" + "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_phi_condition</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"))"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dprop</span>, size <span class="op">=</span> <span class="fl">1</span>,
                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">beta_phi_intercept</span><span class="op">)</span>, 
                            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span><span class="op">)</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">control_title</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dprop</span>, size <span class="op">=</span> <span class="fl">1</span>,
                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">beta_phi_intercept</span> <span class="op">+</span> <span class="va">beta_phi_condition</span><span class="op">)</span>, 
                            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta_mu_intercept</span> <span class="op">+</span> <span class="va">beta_mu_condition</span><span class="op">)</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">impasse_title</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">test_trans</span>, fill <span class="op">=</span> <span class="va">pretty_condition</span><span class="op">)</span>, 
               alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Beta Regression Predictions"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also convert the parameter estimates back to A and B. for the impasse condition, MU = 0.397 SIZE = 0.666</p>
<p>a = mu * phi = 0.397 * 0.66 = 0.264 b = (1 - mu) * phi = (1 - 0.397) * 0.666 = 0.402</p>
<p>we should expect it to look more like … (for 50% ) a = correct = 3 b = incorrect = 10 a + b = total = 13</p>
<p>MU = a / (a+b) [the score] = 3 / 13 = 0.23 PHI = a + b [ the total # items ] = 13</p>
<p>mu = 0.277 = a / (a + b) phi = 0.395 = a + b let b = 13</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb232"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#RECOVER A AND B FROM MU AND PHI</span>
<span class="va">muphi_to_shapes</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">phi</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">shape1</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">*</span> <span class="va">phi</span>
  <span class="va">shape2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">*</span> <span class="va">phi</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="va">shape1</span>, shape2 <span class="op">=</span> <span class="va">shape2</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">shapes_to_muphi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">shape1</span>, <span class="va">shape2</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">shape1</span> <span class="op">/</span> <span class="op">(</span><span class="va">shape1</span> <span class="op">+</span> <span class="va">shape2</span><span class="op">)</span>
  <span class="va">phi</span> <span class="op">&lt;-</span> <span class="va">shape1</span> <span class="op">+</span> <span class="va">shape2</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">mu</span>, phi <span class="op">=</span> <span class="va">phi</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"model predicts control A and B "</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "model predicts control A and B "</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb234"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">muphi_to_shapes</span><span class="op">(</span><span class="va">mu_control</span>, <span class="va">phi_control</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$shape1
[1] 0.118

$shape2
[1] 0.276</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb236"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"should be something like "</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "should be something like "</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb238"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">shapes_to_muphi</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">13</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$mu
[1] 0.278

$phi
[1] 18</code></pre>
</div>
</div>
<p>It seems like the although the (shrinkled) beta regression model is working, it is really messing up the estimate of the PHI parameter, such that we can’t even recover the A and B. I expect whole numbers, and instead I’m geting values less than 1. I think this might be because the phi value is so low (note that phi = precision, so like inverse of variance. Lower values are more less precise (more variance)). Since I have so many values near 0 and near 1 (even though I’ve shrunk the estimates to be in the open interval (0,1) rather than [0,1], I think it causing problems with the estimation. )</p>
</section><section id="bayesian-version" class="level4"><h4 class="anchored" data-anchor-id="bayesian-version">bayesian version</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb240"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rcpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Rcpp' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading 'brms' package (version 2.16.3). Useful instructions
can be found by typing help('brms'). A more detailed introduction
to the package is available through vignette('brms_overview').</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'brms'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:extraDistr':

    ddirichlet, dfrechet, pfrechet, qfrechet, rdirichlet, rfrechet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    acat, cratio, cumulative, dfrechet, dirichlet, exponential,
    frechet, geometric, lognormal, multinomial, negbinomial, pfrechet,
    qfrechet, rfrechet, s, sratio</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ordinal':

    ranef, VarCorr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    ngrps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggdist':

    dstudent_t, pstudent_t, qstudent_t, rstudent_t</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    kidney</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    ar</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb252"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">model_beta_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html">bf</a></span><span class="op">(</span><span class="va">test_trans</span> <span class="op">~</span> <span class="va">pretty_condition</span>,
     <span class="va">phi</span> <span class="op">~</span> <span class="va">pretty_condition</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="va">df</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">Beta</a></span><span class="op">(</span><span class="op">)</span>,
  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">2000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,
  cores <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">1234</span>,
  <span class="co"># Use the cmdstanr backend for Stan because it's faster and more modern than</span>
  <span class="co"># the default rstan You need to install the cmdstanr package first</span>
  <span class="co"># (https://mc-stan.org/cmdstanr/) and then run cmdstanr::install_cmdstan() to</span>
  <span class="co"># install cmdstan on your computer.</span>
  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 finished in 0.9 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 0.9 seconds.
Chain 3 finished in 0.8 seconds.
Chain 4 finished in 0.9 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.9 seconds.
Total execution time: 1.1 seconds.</code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb255"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_beta_bayes</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: beta 
  Links: mu = logit; phi = log 
Formula: test_trans ~ pretty_condition 
         phi ~ pretty_condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                      -0.85      0.19    -1.21    -0.48 1.00     3324
phi_Intercept                  -0.44      0.15    -0.75    -0.14 1.00     3227
pretty_conditionimpasse         0.53      0.25     0.02     1.02 1.00     3896
phi_pretty_conditionimpasse    -0.06      0.21    -0.47     0.34 1.00     3717
                            Tail_ESS
Intercept                       3024
phi_Intercept                   2973
pretty_conditionimpasse         2985
phi_pretty_conditionimpasse     3139

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb257"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Cool! parameters are almost identical to betareg"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Cool! parameters are almost identical to betareg"</code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb259"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/">tidybayes</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidybayes' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidybayes'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:brms':

    dstudent_t, pstudent_t, qstudent_t, rstudent_t</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:bayestestR':

    hdi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:distributional':

    parameters</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gnm':

    parameters</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggridges':

    scale_point_color_continuous, scale_point_color_discrete,
    scale_point_colour_continuous, scale_point_colour_discrete,
    scale_point_fill_continuous, scale_point_fill_discrete,
    scale_point_size_continuous</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb267"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">posterior_beta</span> <span class="op">&lt;-</span> <span class="va">model_beta_bayes</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/spread_draws.html">gather_draws</a></span><span class="op">(</span><span class="va">`b_.*`</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">.variable</span>, <span class="st">"phi_"</span><span class="op">)</span>, <span class="st">"Precision"</span>, <span class="st">"Mean"</span><span class="op">)</span>,
         intercept <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">.variable</span>, <span class="st">"Intercept"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">posterior_beta</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.value</span>, y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="va">.variable</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">component</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>slab_alpha <span class="op">=</span> <span class="va">intercept</span><span class="op">)</span>, 
               .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.95</span><span class="op">)</span>, point_interval <span class="op">=</span> <span class="st">"median_hdi"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"viridis"</span>, end <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/scales.html">scale_slab_alpha_discrete</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, slab_alpha <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Coefficient"</span>, y <span class="op">=</span> <span class="st">"Variable"</span>,
       caption <span class="op">=</span> <span class="st">"80% and 95% credible intervals shown in black; RAW COEFF"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">component</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb268"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">##GET USEFUL ESTIMATES</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TRANSFORMED ESTIMATES"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TRANSFORMED ESTIMATES"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb270"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">model_beta_bayes</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">`b_.*`</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"b_phi"</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"b_phi"</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/gather_variables.html">gather_variables</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/point_interval.html">median_hdi</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  .variable                     .value .lower .upper .width .point .interval
  &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1 b_Intercept                    0.299  0.229  0.381   0.95 median hdi      
2 b_phi_Intercept                0.643  0.459  0.847   0.95 median hdi      
3 b_phi_pretty_conditionimpasse  0.944  0.608  1.36    0.95 median hdi      
4 b_pretty_conditionimpasse      0.630  0.517  0.741   0.95 median hdi      </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb272"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># now phi is a raw value indicating precision</span>
<span class="co"># now mu is an odds ratio for median? of the distribution</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="bayesian-predictions" class="level4"><h4 class="anchored" data-anchor-id="bayesian-predictions">Bayesian predictions</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb273"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Plug a dataset where quota is FALSE and TRUE into the model</span>
<span class="va">beta_bayes_pred</span> <span class="op">&lt;-</span> <span class="va">model_beta_bayes</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/add_predicted_draws.html">epred_draws</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>pretty_condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"impasse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">beta_bayes_pred</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.epred</span>, y <span class="op">=</span> <span class="va">pretty_condition</span>, fill <span class="op">=</span> <span class="va">pretty_condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span>.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.95</span><span class="op">)</span>, point_interval <span class="op">=</span> <span class="st">"median_hdi"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Predicted Comprehension Task Score Percentage Correct"</span>, y <span class="op">=</span> <span class="cn">NULL</span>,
       caption <span class="op">=</span> <span class="st">"80% and 95% credible intervals shown in black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="zero-inflated-beta" class="level3"><h3 class="anchored" data-anchor-id="zero-inflated-beta">ZERO INFLATED BETA</h3>
<ol type="1">
<li>logistic regression for zero inflated <span class="math inline">\(\alpha\)</span> (logit scale)</li>
<li>beta regression for proportion <span class="math inline">\(\mu\)</span> (logit scale) and <span class="math inline">\(\phi\)</span> (log scale)</li>
</ol>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb274"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">pretty_condition</span>, <span class="va">DV_percent_NABS</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    condition <span class="op">=</span> <span class="va">pretty_condition</span>,
    accuracy <span class="op">=</span> <span class="va">DV_percent_NABS</span>
  <span class="op">)</span>
<span class="co">#shrink accuracy just a tiny bit from 1 for testing purposes </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hope-data-science/tidyfst">tidyfst</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyfst' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Life's short, use R.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyfst'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, cummean, nth</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    percent</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb280"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://hope-data-science.github.io/tidyfst/reference/mutate_vars.html">mutate_when</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">==</span> <span class="fl">1</span>, accuracy <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>

<span class="co">#INTERCEPT ONLY model for alpha</span>
<span class="va">zinb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html">bf</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co">#mean of (0,1) values, mu</span>
     <span class="va">phi</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co">#precision of (0,1) values, phi</span>
     <span class="va">zi</span> <span class="op">~</span> <span class="va">condition</span><span class="op">)</span>, <span class="co">#zero inflated is extreme? alpha</span>
  data <span class="op">=</span> <span class="va">df</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">zero_inflated_beta</a></span><span class="op">(</span><span class="op">)</span>,
  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">2000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,
  cores <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">1234</span>
  <span class="co"># backend = "cmdstanr"</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Compiling Stan program...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Trying to compile a simple C file</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
clang -mmacosx-version-min=10.13 -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG   -I"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/Rcpp/include/"  -I"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppEigen/include/"  -I"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppEigen/include/unsupported"  -I"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/BH/include" -I"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/StanHeaders/include/src/"  -I"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/StanHeaders/include/"  -I"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppParallel/include/"  -I"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/rstan/include" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include '/Library/Frameworks/R.framework/Versions/4.1/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
In file included from &lt;built-in&gt;:1:
In file included from /Library/Frameworks/R.framework/Versions/4.1/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
In file included from /Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppEigen/include/Eigen/Dense:1:
In file included from /Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppEigen/include/Eigen/Core:88:
/Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace'
namespace Eigen {
^
/Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator
namespace Eigen {
               ^
               ;
In file included from &lt;built-in&gt;:1:
In file included from /Library/Frameworks/R.framework/Versions/4.1/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
In file included from /Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppEigen/include/Eigen/Dense:1:
/Library/Frameworks/R.framework/Versions/4.1/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found
#include &lt;complex&gt;
         ^~~~~~~~~
3 errors generated.
make: *** [foo.o] Error 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb285"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: zero_inflated_beta 
  Links: mu = logit; phi = log; zi = logit 
Formula: accuracy ~ condition 
         phi ~ condition
         zi ~ condition
   Data: df (Number of observations: 330) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                0.18      0.16    -0.15     0.50 1.00     4462
phi_Intercept            0.04      0.15    -0.26     0.31 1.00     4473
zi_Intercept             0.52      0.16     0.21     0.85 1.00     4599
conditionimpasse         0.03      0.20    -0.36     0.44 1.00     4766
phi_conditionimpasse     0.17      0.18    -0.17     0.53 1.00     4612
zi_conditionimpasse     -1.36      0.23    -1.81    -0.91 1.00     4415
                     Tail_ESS
Intercept                2671
phi_Intercept            2724
zi_Intercept             2936
conditionimpasse         3012
phi_conditionimpasse     3330
zi_conditionimpasse      2708

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb287"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Response residuals not available to calculate mean square error. (R)MSE
  is probably not reliable.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

ELPD     | ELPD_SE |   LOOIC | LOOIC_SE |    WAIC |    R2 |  RMSE | Sigma
-------------------------------------------------------------------------
-185.460 |   9.386 | 370.921 |   18.772 | 370.908 | 0.058 | 0.368 | 1.000</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb290"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># plot(rope(zinb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb291"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">zinb</span>, effects <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in tidy.brmsfit(zinb, effects = "fixed"): some parameter names contain
underscores: term naming may be unreliable!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'posterior_samples' is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  effect component term                 estimate std.error conf.low conf.high
  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  cond      (Intercept)            0.183      0.165   -0.145     0.496
2 fixed  cond      phi_(Intercept)        0.0373     0.146   -0.262     0.314
3 fixed  zi        (Intercept)            0.525      0.165    0.211     0.854
4 fixed  cond      conditionimpasse       0.0331     0.203   -0.357     0.439
5 fixed  cond      phi_conditionimpasse   0.174      0.177   -0.167     0.533
6 fixed  zi        conditionimpasse      -1.36       0.232   -1.81     -0.907</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb295"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"INTERPRET ALPHA"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "INTERPRET ALPHA"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb297"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">zi_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">zinb</span>, effects <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"zi"</span>, <span class="va">term</span> <span class="op">==</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in tidy.brmsfit(zinb, effects = "fixed"): some parameter names contain
underscores: term naming may be unreliable!

Warning in tidy.brmsfit(zinb, effects = "fixed"): Method 'posterior_samples' is
deprecated. Please see ?as_draws for recommended alternatives.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb299"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Logit scale intercept</span>
<span class="va">zi_intercept</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>b_zi_Intercept 
         0.525 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb301"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## b_zi_Intercept </span>
<span class="co">##          0.525</span>

<span class="co"># Transformed to a probability/proportion</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">zi_intercept</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>b_zi_Intercept 
         0.628 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb303"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## b_zi_Intercept </span>
<span class="co">##         0.628</span>

<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">condition</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.627</code></pre>
</div>
</div>
<p>The value of the z_intercept should be the same as the proportion of 0s in the control condition.</p>
<p>VISUALIZE ZERO INFLATED COMPONENT</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb305"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">beta_zi_pred_int</span> <span class="op">&lt;-</span> <span class="va">zinb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/add_predicted_draws.html">predicted_draws</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"impasse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_zero <span class="op">=</span> <span class="va">.prediction</span> <span class="op">==</span> <span class="fl">0</span>,
         .prediction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_zero</span>, <span class="va">.prediction</span> <span class="op">-</span> <span class="fl">0.01</span>, <span class="va">.prediction</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">beta_zi_pred_int</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.prediction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">is_zero</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.025</span>, 
                 boundary <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, end <span class="op">=</span> <span class="fl">0.5</span>,
                       guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Predicted proportion of Correct Responses"</span>, 
       y <span class="op">=</span> <span class="st">"Count"</span>, fill <span class="op">=</span> <span class="st">"Is zero?"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>,
             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html">labeller</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`control` <span class="op">=</span> <span class="st">"Control"</span>, 
                                           `impasse` <span class="op">=</span> <span class="st">"Impasse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="zero-one-inflated-beta-regression" class="level3"><h3 class="anchored" data-anchor-id="zero-one-inflated-beta-regression">ZERO-ONE INFLATED BETA Regression</h3>
<p>https://sometimesir.com/posts/2019-02-18-analyze-analog-scale-ratings-with-zero-one-inflated-beta-models/#zoib-regression https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</p>
<p><strong>TODO</strong> - explore priors - explore random effects - explore non-beta distribution; once the 1s and zeros are gone, do we need the beta?</p>
<p>A zero-inflated beta regression allows us to model a separate data generating process for the 0s and 1s and the rest.</p>
<p>A ZOINB is a mixture of:</p>
<ol type="1">
<li><p>A logistic regression model that predicts if an outcome is either 0 or 1 or not 0 or 1, defined by (or alternatively, a model that predicts if outcomes are extreme (0 or 1) or not (between 0 and 1); “IS EXTREME” model; defined by <span class="math inline">\(\alpha\)</span></p></li>
<li><p>A logistic regression model that predicts if any of the 0 or 1 outcomes are actually 1s, defined by (or alternatively, a model that predicts if the extreme values are 1) “WHICH EXTREME” model defined by <span class="math inline">\(\gamma\)</span></p></li>
<li><p>A beta regression model that predicts if an outcome is between 0 and 1 if it’s not zero or not one, defined by and (or alternatively, a model that predicts the non-extreme (0 or 1) values) “THE REST” model <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\phi\)</span></p></li>
</ol>
<p>Can also do mixed! (but no reason do this here, as the item level data is not beta reg )</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb306"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#DATA SETUP</span>
<span class="co"># sub &lt;- df_subjects %&gt;% dplyr::select(condition, DV_percent_NABS) </span>
<span class="co"># don't need to transform anymore</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    condition <span class="op">=</span> <span class="va">pretty_condition</span>,
    scaled <span class="op">=</span> <span class="op">(</span><span class="va">s_SCALED</span> <span class="op">+</span> <span class="fl">13</span><span class="op">)</span><span class="op">/</span><span class="fl">26</span>,  <span class="co">#transform scaled onto 0-1 scale</span>
    accuracy <span class="op">=</span> <span class="va">item_test_NABS</span><span class="op">/</span><span class="fl">8</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">scaled</span>, <span class="va">accuracy</span><span class="op">)</span>


<span class="co">#INTERCEPT ONLY model for alpha</span>
<span class="va">zoinb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html">bf</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co">#mean of (0,1) values, mu</span>
     <span class="va">phi</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co">#precision of (0,1) values, phi</span>
     <span class="va">zoi</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co">#is extreme? alpha</span>
     <span class="va">coi</span> <span class="op">~</span> <span class="va">condition</span><span class="op">)</span>, <span class="co">#is 1? gamma</span>
  data <span class="op">=</span> <span class="va">df</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">zero_one_inflated_beta</a></span><span class="op">(</span><span class="op">)</span>,
  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">2000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,
  cores <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">1234</span>,
  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 finished in 1.4 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 1.3 seconds.
Chain 3 finished in 1.3 seconds.
Chain 4 finished in 1.3 seconds.

All 4 chains finished successfully.
Mean chain execution time: 1.3 seconds.
Total execution time: 1.5 seconds.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb309"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">zoinb_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html">bf</a></span><span class="op">(</span><span class="va">scaled</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co">#mean of (0,1) values, mu</span>
     <span class="va">phi</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co">#precision of (0,1) values, phi</span>
     <span class="va">zoi</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co">#is extreme? alpha</span>
     <span class="va">coi</span> <span class="op">~</span> <span class="va">condition</span><span class="op">)</span>, <span class="co">#is 1? gamma</span>
  data <span class="op">=</span> <span class="va">df</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">zero_one_inflated_beta</a></span><span class="op">(</span><span class="op">)</span>,
  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">2000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,
  cores <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">1234</span>,
  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 finished in 3.0 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 3.2 seconds.
Chain 4 finished in 3.1 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 3.2 seconds.

All 4 chains finished successfully.
Mean chain execution time: 3.1 seconds.
Total execution time: 3.4 seconds.</code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb312"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zoinb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: zero_one_inflated_beta 
  Links: mu = logit; phi = log; zoi = logit; coi = logit 
Formula: accuracy ~ condition 
         phi ~ condition
         zoi ~ condition
         coi ~ condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                0.19      0.35    -0.50     0.87 1.00     5675
phi_Intercept            0.63      0.37    -0.11     1.30 1.00     5271
zoi_Intercept            1.55      0.33     0.94     2.21 1.00     5972
coi_Intercept           -1.85      0.41    -2.70    -1.11 1.00     7202
conditionimpasse         0.14      0.41    -0.67     0.94 1.00     6117
phi_conditionimpasse     0.29      0.44    -0.54     1.18 1.00     5802
zoi_conditionimpasse    -1.18      0.41    -1.99    -0.40 1.00     5892
coi_conditionimpasse     0.97      0.56    -0.11     2.07 1.00     6790
                     Tail_ESS
Intercept                3115
phi_Intercept            2590
zoi_Intercept            2934
coi_Intercept            2913
conditionimpasse         3437
phi_conditionimpasse     2950
zoi_conditionimpasse     3361
coi_conditionimpasse     2918

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb314"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/rope.html">rope</a></span><span class="op">(</span><span class="va">zoinb</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_phi_conditionimpasse and b_phi_Intercept (r = 0.83), b_zoi_conditionimpasse and b_zoi_Intercept (r = 0.78), b_coi_conditionimpasse and b_coi_Intercept (r = 0.75). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb316"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">zoinb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb317"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/rope.html">rope</a></span><span class="op">(</span><span class="va">zoinb_scaled</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_phi_conditionimpasse and b_phi_Intercept (r = 0.81). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-43-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb319"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">zoinb_scaled</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-43-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>More plots</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb320"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">zoinb</span>, effects <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in tidy.brmsfit(zoinb, effects = "fixed"): some parameter names contain
underscores: term naming may be unreliable!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'posterior_samples' is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  effect component term                 estimate std.error conf.low conf.high
  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  cond      (Intercept)             0.193     0.348   -0.497     0.866
2 fixed  cond      phi_(Intercept)         0.635     0.370   -0.108     1.30 
3 fixed  cond      zoi_(Intercept)         1.55      0.328    0.942     2.21 
4 fixed  cond      coi_(Intercept)        -1.85      0.415   -2.70     -1.11 
5 fixed  cond      conditionimpasse        0.141     0.410   -0.669     0.939
6 fixed  cond      phi_conditionimpasse    0.288     0.441   -0.537     1.18 
7 fixed  cond      zoi_conditionimpasse   -1.18      0.412   -1.99     -0.402
8 fixed  cond      coi_conditionimpasse    0.966     0.560   -0.107     2.07 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb324"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"INTERPRET ALPHA"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "INTERPRET ALPHA"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb326"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">zoi_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">zoinb</span>, effects <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"cond"</span>, <span class="va">term</span> <span class="op">==</span> <span class="st">"zoi_(Intercept)"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in tidy.brmsfit(zoinb, effects = "fixed"): some parameter names contain
underscores: term naming may be unreliable!

Warning in tidy.brmsfit(zoinb, effects = "fixed"): Method 'posterior_samples' is
deprecated. Please see ?as_draws for recommended alternatives.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb328"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Logit scale intercept</span>
<span class="va">zoi_intercept</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>b_zoi_Intercept 
           1.55 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb330"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Transformed to a probability/proportion</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">zoi_intercept</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>b_zoi_Intercept 
          0.824 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb332"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">condition</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.823</code></pre>
</div>
</div>
<p>The value of the zoi_intercept should be the same as the proportion of 0s and 1s (vs non 0s and 1s) in the control condition… and it does!</p>
<p>VISUALIZE ZERO INFLATED COMPONENT</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb334"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">beta_zoi_pred_int</span> <span class="op">&lt;-</span> <span class="va">zoinb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/add_predicted_draws.html">predicted_draws</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"impasse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_extreme <span class="op">=</span> <span class="va">.prediction</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
         is_one <span class="op">=</span> <span class="va">.prediction</span> <span class="op">==</span><span class="fl">1</span>, 
         .prediction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_extreme</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">is_one</span>, <span class="va">.prediction</span> <span class="op">-</span> <span class="fl">0.01</span>, <span class="va">.prediction</span><span class="op">)</span>,
         .prediction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_one</span>, <span class="va">.prediction</span> <span class="op">+</span> <span class="fl">0.01</span>, <span class="va">.prediction</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">beta_zoi_pred_int</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.prediction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">is_extreme</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.05</span>, 
                 boundary <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, end <span class="op">=</span> <span class="fl">0.5</span>,
                       guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Predicted proportion of Correct Responses"</span>, 
       y <span class="op">=</span> <span class="st">"Count"</span>, fill <span class="op">=</span> <span class="st">"Is extreme?"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>,
             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html">labeller</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`control` <span class="op">=</span> <span class="st">"Control"</span>, 
                                           `impasse` <span class="op">=</span> <span class="st">"Impasse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb335"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">beta_zoi_pred_int</span> <span class="op">&lt;-</span> <span class="va">zoinb_scaled</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/add_predicted_draws.html">predicted_draws</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"impasse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_extreme <span class="op">=</span> <span class="va">.prediction</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
         is_one <span class="op">=</span> <span class="va">.prediction</span> <span class="op">==</span><span class="fl">1</span>, 
         .prediction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_extreme</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">is_one</span>, <span class="va">.prediction</span> <span class="op">-</span> <span class="fl">0.01</span>, <span class="va">.prediction</span><span class="op">)</span>,
         .prediction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_one</span>, <span class="va">.prediction</span> <span class="op">+</span> <span class="fl">0.01</span>, <span class="va">.prediction</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">beta_zoi_pred_int</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.prediction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">is_extreme</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.05</span>, 
                 boundary <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, end <span class="op">=</span> <span class="fl">0.5</span>,
                       guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Predicted proportion of Correct Responses"</span>, 
       y <span class="op">=</span> <span class="st">"Count"</span>, fill <span class="op">=</span> <span class="st">"Is extreme?"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>,
             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html">labeller</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`control` <span class="op">=</span> <span class="st">"Control"</span>, 
                                           `impasse` <span class="op">=</span> <span class="st">"Impasse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="zoinf-neg-binom" class="level3"><h3 class="anchored" data-anchor-id="zoinf-neg-binom">ZOINF NEG BINOM?</h3>
</section><section id="mixed-zero-one-inflated-beta-regression" class="level3"><h3 class="anchored" data-anchor-id="mixed-zero-one-inflated-beta-regression">MIXED ZERO-ONE-INFLATED BETA Regression</h3>
<p>Next we’ll explore doing a beta regression on a proportion transformed scaled score at the item level, as a zero one inflated mixed beta reg</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb336"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>scaled <span class="op">=</span> <span class="op">(</span><span class="va">score_SCALED</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>,
         condition <span class="op">=</span> <span class="va">pretty_condition</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">subject</span>, <span class="va">scaled</span>, <span class="va">condition</span><span class="op">)</span>


<span class="va">zoinb_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html">bf</a></span><span class="op">(</span><span class="va">scaled</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span> , <span class="co">#mean of (0,1) values, mu</span>
     <span class="va">phi</span> <span class="op">~</span> <span class="va">condition</span> , <span class="co">#precision of (0,1) values, phi</span>
     <span class="va">zoi</span> <span class="op">~</span> <span class="va">condition</span> , <span class="co">#is extreme? alpha</span>
     <span class="va">coi</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">)</span>, <span class="co">#is 1? gamma</span>
  data <span class="op">=</span> <span class="va">df</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">zero_one_inflated_beta</a></span><span class="op">(</span><span class="op">)</span>,
  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">2000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,
  cores <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">1234</span>,
  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in '/var/folders/52/q436r3nd6kvcz73cchs_t98r0000gn/T/RtmpR7bjpB/model-667f45df313b.stan', line 39, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in '/var/folders/52/q436r3nd6kvcz73cchs_t98r0000gn/T/RtmpR7bjpB/model-667f45df313b.stan', line 84, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 50.2 seconds.
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 53.2 seconds.
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 65.2 seconds.
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 68.7 seconds.

All 4 chains finished successfully.
Mean chain execution time: 59.3 seconds.
Total execution time: 68.7 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 of 4000 (0.0%) transitions ended with a divergence.
See https://mc-stan.org/misc/warnings for details.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb341"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zoinb_scaled</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing adapt_delta
above may help. See http://mc-stan.org/misc/warnings.html#divergent-transitions-
after-warmup</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: zero_one_inflated_beta 
  Links: mu = logit; phi = log; zoi = logit; coi = logit 
Formula: scaled ~ condition + (1 | subject) 
         phi ~ condition
         zoi ~ condition
         coi ~ condition
   Data: df (Number of observations: 1638) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~subject (Number of levels: 126) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.21      0.09     0.03     0.37 1.00      718     1164

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept               -0.56      0.10    -0.76    -0.37 1.00     3731
phi_Intercept            2.09      0.18     1.72     2.43 1.00     3595
zoi_Intercept            2.40      0.13     2.16     2.66 1.00     5146
coi_Intercept           -1.16      0.09    -1.33    -0.99 1.00     7441
conditionimpasse         0.25      0.12     0.02     0.48 1.00     4205
phi_conditionimpasse    -0.09      0.21    -0.49     0.33 1.00     4217
zoi_conditionimpasse    -1.20      0.15    -1.49    -0.91 1.00     5556
coi_conditionimpasse     1.46      0.12     1.22     1.71 1.00     8209
                     Tail_ESS
Intercept                2772
phi_Intercept            2667
zoi_Intercept            3015
coi_Intercept            2654
conditionimpasse         2479
phi_conditionimpasse     2776
zoi_conditionimpasse     3083
coi_conditionimpasse     2153

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb344"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">zoinb_scaled</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="beta-hurdle-regression-frequentist" class="level3"><h3 class="anchored" data-anchor-id="beta-hurdle-regression-frequentist">BETA HURDLE Regression (Frequentist)</h3>
<p><a href="https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf" class="uri">https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf</a></p>
<ul>
<li>MU tells if mean is different by condition</li>
<li>SIGMA tells if variance is different by condition</li>
<li>NU coefficient tells if condition yields different probability at floor</li>
<li>TAU coefficient tells if condition yields different probability at ceiling</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb345"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#BETA HURDLE REGRESSION EXAMPLE</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.gamlss.com/">gamlss</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gamlss' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    sleep</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.dist</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gamlss.dist' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'nlme' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ordinal':

    ranef, VarCorr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmList</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: parallel</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> **********   GAMLSS Version 5.4-3  ********** </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>For more on GAMLSS look at https://www.gamlss.com/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type gamlssNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:brms':

    cs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:extraDistr':

    pcat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    refit</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb366"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE SAMPLE DATA </span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span> 
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.40</span> 
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.60</span> 
<span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">0.13</span> 
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fl">0.17</span> 
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span> <span class="va">p0</span><span class="op">-</span> <span class="va">p1</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">sigma</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> 
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">/</span> <span class="va">mu</span>

<span class="co">#CREATE DIST</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1839</span><span class="op">)</span> 
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> 
<span class="va">cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">p0</span>, <span class="va">p2</span>, <span class="va">p1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="va">y</span><span class="op">[</span><span class="va">cat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> 
<span class="va">y</span><span class="op">[</span><span class="va">cat</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">x</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb367"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#this looks not unlike my distribution! </span>

<span class="co">#CREATE AN EMPTY MODEL</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for mu </span>
               formula.sigma <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for sigma </span>
               formula.nu <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for nu </span>
               formula.tau <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for tau </span>
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 7799 
GAMLSS-RS iteration 2: Global Deviance = 7778 
GAMLSS-RS iteration 3: Global Deviance = 7778 
GAMLSS-RS iteration 4: Global Deviance = 7778 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb369"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = y ~ 1, family = BEINF(), formula.sigma = ~1,  
    formula.nu = ~1, formula.tau = ~1) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.3796     0.0196   -19.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.3951     0.0162    24.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.632      0.042   -38.9   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -1.4014     0.0382   -36.7   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  5000 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  4996 
                      at cycle:  4 
 
Global Deviance:     7778 
            AIC:     7786 
            SBC:     7812 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb371"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.000571 
                       variance   =  1 
               coef. of skewness  =  0.0294 
               coef. of kurtosis  =  2.95 
Filliben correlation coefficient  =  1 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb373"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">fit_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">fit_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.406229902102452"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb375"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">fit_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.597499259410111"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb377"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="va">fit_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="va">fit_p0</span> <span class="op">&lt;-</span> <span class="va">fit_nu</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P0: "</span>,<span class="va">fit_p0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb379"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_p1</span> <span class="op">&lt;-</span> <span class="va">fit_tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P1: "</span>,<span class="va">fit_p1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
</div>
<p><strong>BETA HURDLE INTERPRETATION</strong> - beta component<br>
- MU “location” (mean)<br>
- SIGMA “scale” (positively related to variance; variance = sigma.squared <em>mean</em> (1-mean)<br>
- Rigby, Stasinopoulos, Heller, and De Bastiani (2017) “reparameterized” the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</p>
<p><strong>ZERO-ONE HURDLE COMPONENT</strong><br>
- The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.<br>
- p0 is the probability that a case equals 0,<br>
- p1 is the probability that a case equals 1,<br>
- p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb381"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MY DATA</span>
<span class="co">#SETUP DATA </span>

<span class="va">min</span> <span class="op">=</span> <span class="fl">0</span> <span class="co">#min possible value of scale</span>
<span class="va">max</span> <span class="op">=</span> <span class="fl">13</span> <span class="co">#max possible value of scale</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span> <span class="co">#for shuffling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:brms':

    mm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    cross</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    chisq, logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lmerTest':

    rand</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    factorize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:rstatix':

    cor_test, prop_test, t_test</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelr':

    resample</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelsummary':

    msummary</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    mplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    rescale</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:cowplot':

    theme_map</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb400"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#1. Rescale accuracy using </span>
<span class="co"># recommended adjustment </span>
<span class="co">#rescaled = value-min/(max-min)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="va">s_NABS</span>,
  R_acc <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span><span class="op">-</span><span class="va">min</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">max</span><span class="op">-</span><span class="va">min</span><span class="op">)</span>, <span class="co">#as %</span>
  T_acc <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="va">max</span>, <span class="co">#transform for no 0 and 1</span>
  <span class="co"># perm = shuffle(condition),</span>
  scaffold_rt <span class="op">=</span> <span class="va">item_scaffold_rt</span>
<span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accuracy</span>,<span class="va">R_acc</span>, <span class="va">T_acc</span>, <span class="va">condition</span>,<span class="va">scaffold_rt</span><span class="op">)</span>

<span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">R_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb401"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">T_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of [rescaled] accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb402"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># gf_histogram(~R_acc, fill = ~perm, data = df) %&gt;% gf_facet_wrap(~perm) + labs(title = "Histogram of shuffled accuracy")</span>

<span class="co">#SUMMARIZE SAMPLE</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Grand mean"</span>, <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand mean 0.288344988344988"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb404"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span>
<span class="va">stats</span> <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">var</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Grand stats"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand stats"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb406"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">stats</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  df$condition min Q1 median    Q3 max  mean    sd   n missing   var
1      control   0  0  0.000 0.154   1 0.190 0.343 158       0 0.118
2      impasse   0  0  0.154 0.788   1 0.379 0.395 172       0 0.156</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb408"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"P0"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb410"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.458</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb412"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"P1"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb414"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0939</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb416"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE MODEL</span>

<span class="co">#CREATE AN EMPTY MODEL</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">R_acc</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for mu </span>
              formula.sigma <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for sigma </span>
              formula.nu <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for nu </span>
              formula.tau <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for tau </span>
              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 611 
GAMLSS-RS iteration 2: Global Deviance = 610 
GAMLSS-RS iteration 3: Global Deviance = 610 
GAMLSS-RS iteration 4: Global Deviance = 610 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb418"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 611 
GAMLSS-RS iteration 2: Global Deviance = 610 
GAMLSS-RS iteration 3: Global Deviance = 610 
GAMLSS-RS iteration 4: Global Deviance = 610 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb420"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"THE EMPTY MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "THE EMPTY MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb422"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ 1, sigma.formula = ~1, nu.formula = ~1,  
    tau.formula = ~1, family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  -0.2304     0.0947   -2.43    0.015 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.4262     0.0775     5.5  7.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.0201     0.1157    0.17     0.86

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.563      0.198   -7.91  3.9e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  326 
                      at cycle:  4 
 
Global Deviance:     610 
            AIC:     618 
            SBC:     634 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb424"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  -0.00445 
                       variance   =  1.03 
               coef. of skewness  =  0.0264 
               coef. of kurtosis  =  3.03 
Filliben correlation coefficient  =  0.996 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb426"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">m0_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">m0_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.442655135079248"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb428"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">m0_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.604970105601303"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb430"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"NU: "</span>,<span class="va">m0_nu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  1.02032203257766"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb432"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU: "</span>,<span class="va">m0_tau</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.209464832192797"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb434"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_p0</span> <span class="op">&lt;-</span> <span class="va">fit_nu</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P0: "</span>,<span class="va">m0_p0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb436"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_p1</span> <span class="op">&lt;-</span> <span class="va">fit_tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P1: "</span>,<span class="va">m0_p1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb438"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE PREDICTOR MODEL</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">condition</span>, 
             <span class="op">~</span> <span class="va">condition</span>, 
             <span class="op">~</span> <span class="va">condition</span>, 
             <span class="op">~</span> <span class="va">condition</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 573 
GAMLSS-RS iteration 2: Global Deviance = 572 
GAMLSS-RS iteration 3: Global Deviance = 572 
GAMLSS-RS iteration 4: Global Deviance = 572 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb440"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"THE PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "THE PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb442"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.421      0.171   -2.46    0.014 *
conditionimpasse    0.274      0.205    1.33    0.183  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)        0.3949     0.1407    2.81   0.0053 **
conditionimpasse   0.0309     0.1687    0.18   0.8549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         0.767      0.178    4.30  2.3e-05 ***
conditionimpasse   -1.440      0.247   -5.84  1.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -1.264      0.314   -4.02 0.000072 ***
conditionimpasse   -0.471      0.405   -1.16     0.25    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  4 
 
Global Deviance:     572 
            AIC:     588 
            SBC:     618 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb444"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#LOOKING PREDICTOR MODEL</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 573 
GAMLSS-RS iteration 2: Global Deviance = 572 
GAMLSS-RS iteration 3: Global Deviance = 572 
GAMLSS-RS iteration 4: Global Deviance = 572 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb446"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"THE PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "THE PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb448"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.421      0.171   -2.46    0.014 *
conditionimpasse    0.274      0.205    1.33    0.183  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)        0.3949     0.1407    2.81   0.0053 **
conditionimpasse   0.0309     0.1687    0.18   0.8549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         0.767      0.178    4.30  2.3e-05 ***
conditionimpasse   -1.440      0.247   -5.84  1.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -1.264      0.314   -4.02 0.000072 ***
conditionimpasse   -0.471      0.405   -1.16     0.25    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  4 
 
Global Deviance:     572 
            AIC:     588 
            SBC:     618 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb450"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION TEST]</span>
<span class="co"># mperm &lt;- gamlss(R_acc ~ perm, ~ perm, ~ perm, ~ perm, </span>
<span class="co">#             data = df, family = BEINF())</span>
<span class="co"># summary(mperm)</span>

<span class="co">#sanity check with scaled outcome, no zeros ones</span>
<span class="co"># m3 &lt;- gamlss(T_acc ~ condition, ~ condition, ~ condition, ~ condition, </span>
<span class="co">#             data = df, family = BEINF())</span>
<span class="co"># summary(m3)</span>
<span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span>

<span class="co">#investigate beta negative binomial distribution</span>
<span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span>

<span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">m1_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">m1_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.396369901111619" "MU:  0.568036956954873"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb452"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">m1_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.604970105601303"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb454"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"NU: "</span>,<span class="va">m1_nu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  2.15227350452983"  "NU:  0.236870904856183"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb456"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU: "</span>,<span class="va">m1_tau</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.282617628302748" "TAU:  0.624417570712948"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb458"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)        -0.421      0.171   -2.46    0.014 *
conditionimpasse    0.274      0.205    1.33    0.183  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)        0.3949     0.1407    2.81   0.0053 **
conditionimpasse   0.0309     0.1687    0.18   0.8549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         0.767      0.178    4.30  2.3e-05 ***
conditionimpasse   -1.440      0.247   -5.84  1.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -1.264      0.314   -4.02 0.000072 ***
conditionimpasse   -0.471      0.405   -1.16     0.25    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  4 
 
Global Deviance:     572 
            AIC:     588 
            SBC:     618 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb460"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-49-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.0127 
                       variance   =  0.938 
               coef. of skewness  =  0.11 
               coef. of kurtosis  =  2.76 
Filliben correlation coefficient  =  0.997 
******************************************************************</code></pre>
</div>
</div>
<ul>
<li>MU tells if mean is different by condition</li>
<li>SIGMA tells if variance is different by condition</li>
<li>NU coefficient tells if condition yields different probability at floor</li>
<li>TAU coefficient tells if condition yields different probability at ceiling</li>
</ul></section></section><section id="binomial-outcome" class="level2"><h2 class="anchored" data-anchor-id="binomial-outcome">BINOMIAL OUTCOME</h2>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb462"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PREPARE DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span>
<span class="co"># %&gt;% mutate(</span>
<span class="co">#   accuracy = recode_factor(score_niceABS, "0" ="incorrect","1"="correct"),</span>
<span class="co">#   scaled = as.ordered(score_SCALED),</span>
<span class="co">#   q = as.factor(q),</span>
<span class="co">#   high_interpretation = as.factor(high_interpretation)</span>
<span class="co"># )</span>

<span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">accuracy</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, x <span class="op">=</span><span class="op">~</span><span class="va">pretty_condition</span>,
       position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Question 1 Accuracy"</span>,
       title <span class="op">=</span> <span class="st">"Accuracy on Q1"</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-Q1-ACCURACY-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb463"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on Test Phase"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-Q1-ACCURACY-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="chi-square" class="level4"><h4 class="anchored" data-anchor-id="chi-square">CHI SQUARE</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb464"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::CROSSTABLE</span>
<span class="co"># CrossTable( x = df$condition, y = df$accuracy, </span>
<span class="co">#              fisher = TRUE, chisq=TRUE, expected = TRUE, sresid = TRUE)</span>

<span class="co">#::::::::::::MOSAIC PLOT</span>
<span class="co"># note: blue indicates cell count higher than expected, </span>
<span class="co"># red indicates cell count less than expected; under null hypothesis</span>
<span class="co"># mosaicplot(main="Accuracy on First Question by Condition",</span>
<span class="co">#             data = df, pretty_condition ~ accuracy, </span>
<span class="co">#             shade = T)</span>

<span class="co">#::::::::::::TABLE</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span> fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">F</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"auto"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">0</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">52</span><br><span style="color:#339999;">48</span><br><span style="color:#339933;">83.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">45</span><br><span style="color:#339999;">49</span><br><span style="color:#339933;">70.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">97</span><br><span style="color:#339999;">97</span><br><span style="color:#339933;">77&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">1</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">10</span><br><span style="color:#339999;">14</span><br><span style="color:#339933;">16.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">19</span><br><span style="color:#339999;">15</span><br><span style="color:#339933;">29.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">29</span><br><span style="color:#339999;">29</span><br><span style="color:#339933;">23&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">62</span><br><span style="color:#339999;">62</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">64</span><br><span style="color:#339999;">64</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">126</span><br><span style="color:#339999;">126</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=2.547 · df=1 · φ=0.161 · p=0.111</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb465"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::BAR PLOT</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbarstats.html">ggbarstats</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, x <span class="op">=</span> <span class="va">accuracy</span>, y <span class="op">=</span> <span class="va">condition</span>,
           type <span class="op">=</span> <span class="st">"nonparametric"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20CHISQR-Q1-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb466"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::CHISQR TEST</span>
<span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">accuracy</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, simulate.p.value <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with simulated p-value (based on 2000
    replicates)

data:  df$accuracy and df$condition
X-squared = 3, df = NA, p-value = 0.09</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb468"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::POWER ANALYSIS</span>
<span class="op">(</span><span class="va">po</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.chisq.test.html">pwr.chisq.test</a></span><span class="op">(</span> w <span class="op">=</span> <span class="fl">0.1</span>, df<span class="op">=</span><span class="op">(</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
     Chi squared power calculation 

              w = 0.1
              N = 126
             df = 1
      sig.level = 0.05
          power = 0.202

NOTE: N is the number of observations</code></pre>
</div>
</div>
<p><strong>A Chi-Square test of independence of Q1 accuracy [correct,incorrect] by condition indicates the question accuracy is not dependent on condition. <em>However, this test may be underpowered, as with the given sample size it has only 20% power to detect a small effect (w = 0.1)</em></strong></p>
</section><section id="logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="logistic-regression">LOGISTIC REGRESSION</h3>
<ul>
<li>http://post8000.svmiller.com/lab-scripts/logistic-regression-lab.html</li>
</ul>
<p><em>Fit a logistic regression (at the subject-item level), predicting Q1 accuracy (absolute score) by condition.</em><br><em>note: this example uses the combined dataset rather than lab-only, as learning notes were done with the combined and I don’t want to recalcualte all the marginal probabilities by hand for learning purposes.</em></p>
<ul>
<li>Fit a logistic regression predicting accuracy (absolute score) (n = r nrow(df)) by condition. (k = 2).</li>
<li>Parameter estimate: <span class="math inline">\(\beta_{0}\)</span> = Log Odds of (correct) responses in CONTROL condition
<ul>
<li>
<span class="math inline">\(e^{\beta_{0}}\)</span> = ODDS of correct response in CONTROL condition</li>
</ul>
</li>
<li>Parameter estimate: <span class="math inline">\(\beta_{1}\)</span> = <span class="math inline">\(\beta_{1impasse}\)</span> Log Odds (Log OR; change in odds for correct response in impasse (vs) control [log scale])
<ul>
<li>
<span class="math inline">\(e^{\beta_{1}}\)</span> = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</li>
</ul>
</li>
<li>Null hypothesis:<span class="math inline">\(\beta_{impasse} \le 0\)</span> the odds for a correct response does not change, or decreases</li>
<li>Alternative hypothesis: <span class="math inline">\(\beta_{impasse} \gt 0\)</span> the odds of a correct response increases</li>
</ul>
<section id="fit-model" class="level4"><h4 class="anchored" data-anchor-id="fit-model">Fit Model</h4>
<p><em>First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb470"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#combined dataset, not lab only</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># FREQUENCY TABLE</span>
<span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span>
<span class="co"># addmargins(my.table) #counts</span>
<span class="co"># addmargins(prop.table(my.table)) #props</span>

<span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span>

<span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span>
<span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"EMPTY MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "EMPTY MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb472"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ 1, family = "binomial", data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.696  -0.696  -0.696  -0.696   1.753  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -1.294      0.134   -9.66   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 343.66  on 329  degrees of freedom
AIC: 345.7

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb474"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: 2 CONDITION model</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb476"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.819  -0.819  -0.548  -0.548   1.986  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.822      0.230   -7.93  2.2e-15 ***
pretty_conditionimpasse    0.901      0.285    3.16   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 333.07  on 328  degrees of freedom
AIC: 337.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb478"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: 3 TEST SUPERIOR FIT</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC wth predictor is lower than empty model?"</span>, <span class="va">m0</span><span class="op">$</span><span class="va">aic</span> <span class="op">&gt;</span> <span class="va">m1</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb480"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name | Model | df | df_diff |  Chi2 |     p
-------------------------------------------
m0   |   glm |  1 |         |       |      
m1   |   glm |  2 |       1 | 10.59 | 0.001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb482"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.00113745235691825"</code></pre>
</div>
</div>
<p><em>The Condition predictor significantly improves model fit.</em></p>
</section><section id="learning-notes" class="level4"><h4 class="anchored" data-anchor-id="learning-notes">Learning Notes</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb484"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb486"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.819  -0.819  -0.548  -0.548   1.986  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.822      0.230   -7.93  2.2e-15 ***
pretty_conditionimpasse    0.901      0.285    3.16   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 333.07  on 328  degrees of freedom
AIC: 337.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb488"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: INTERPRET COEFFICIENTS</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- LOG ODDS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- LOG ODDS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb490"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                         2.5 % 97.5 %
(Intercept)             -2.299  -1.39
pretty_conditionimpasse  0.353   1.48</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb493"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb495"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#exponentiate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                              2.5 % 97.5 %
(Intercept)             0.162  0.10  0.248
pretty_conditionimpasse 2.463  1.42  4.374</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb498"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- PROBABILITIES"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- PROBABILITIES"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb500"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"[these should math pred plots]"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "[these should math pred plots]"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb502"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Probability at reference level"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability at reference level"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb504"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.139</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb506"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Probability at coefficient level"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability at coefficient level"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb508"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">m1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.285</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb510"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"CHANGE in probability by coefficient"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "CHANGE in probability by coefficient"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb512"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">m1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.146</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb514"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span>

<span class="co"># one-sided (right tail) z test for B COEFFICIENT</span>
<span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span>
<span class="co">#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half</span>

<span class="co">#SANITY CHECK 2-tailed test should match the model output</span>
<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"p value for two-tailed test, null B = 0 : "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tt</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "p value for two-tailed test, null B = 0 :  0.002"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb516"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"BUT we want a one tailed directional, null: B &lt;= 0: "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ot</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "BUT we want a one tailed directional, null: B &lt;= 0:  0.001"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb518"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"adjusted confint for directional hypothesis"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "adjusted confint for directional hypothesis"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb520"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">dcint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span>, level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span><span class="op">)</span> <span class="co"># get 90% for right side))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                          5 %  95 %
(Intercept)             -2.22 -1.46
pretty_conditionimpasse  0.44  1.38</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb523"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span>


<span class="co">#:::::::: INTERPRET COEFFICIENTS [directional]</span>

<span class="co"># print("Confidence Interval —- LOG ODDS")</span>
<span class="co"># confint(m1) #not adjusted for 1-tailed</span>
<span class="co"># print("Coefficients —- ODDS RATIOS")</span>
<span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(confint(m1)))) #exponentiated, not adjusted</span>
<span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(dcint))) #exponentiated, adjusted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Understanding the logistic regression model</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb524"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::DESCRIPTIVES</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">accuracy</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co">#display sum for row</span>
      <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span>margin<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co">#return proportion (of column)</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co">#sanity check sum of columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     
      control impasse   Sum
  0     0.861   0.715 0.785
  1     0.139   0.285 0.215
  Sum   1.000   1.000 1.000</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb526"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">accuracy</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co">#display sum for row</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co">#sanity check sum of columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     
      control impasse Sum
  0       136     123 259
  1        22      49  71
  Sum     158     172 330</code></pre>
</div>
</div>
<p><em>The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable</em></p>
<p><em>The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.</em></p>
<p><strong>[the empty model</strong></p>
<ul>
<li>The intercept of an empty model (glm(accuracy ~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df$accuracy ==1 ).</li>
<li>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -&gt; log(0.215 / (1-0.215)) = -1.29.</li>
<li>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</li>
<li>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</li>
</ul>
<p><strong>[a dichotomous predictor]</strong></p>
<p>natural log (odds of +) = -1.822 + 0.901(x1) ; x1 = 0 for control, 1 for impasse - b0 intercept is ODDS OF CORRECT RESPONSE IN REFERENCE (control) - b1 intercept is ODDS RATIO (difference in odds) FOR CORRECT RESPONSE IN IMPASSE</p>
<ul>
<li>INTERCEPT: log odds of (+ response) in control condition
<ul>
<li>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</li>
<li>convert to odds by exponentiating the coefficients<br>
log odds of (+) in control = exp(-1.822) = 0.162 odds</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139<br>
probability of (+) in control = ~14%</li>
</ul>
</li>
<li>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs.&nbsp;control
<ul>
<li>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</li>
<li>convert to odds by exponentiating log odds<br>
log odds (+) in impasse = exp(-0.921) = 0.398</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285<br>
probaility of (+) in impasse = ~ 29%</li>
</ul>
</li>
<li>ODDS RATIO : exponentiated B1 COEFFICIENT
<ul>
<li>B1 = (slope of logit model = difference in log odds = log odds ratio</li>
<li>B1 = 0.901 is log odds ratio of (+) in impasse vs control</li>
<li>exp(b1) = exp(0.901) = 2.46</li>
<li>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</li>
</ul>
</li>
</ul>
<table class="table">
<colgroup><col style="width: 100%"></colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">MARGINAL<br>
total = 330 success : 71, failure : 259<br>
p(+) = 71 / 330 = 0.215 = 22%<br>
odds(+) = 71 / 259 = 0.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">CONTROL total = 158 success = 22; failure = 136<br>
p(+) = 22/158 = 0.139 = 14%<br>
odds(+) = 22/136 = 0.162</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMPASSE total = 172 success = 49; failure = 123<br>
p(+) = 49/172 = 0.285 = 29%<br>
odds(+) = 49/123 = 0.398</td>
</tr>
</tbody>
</table></section><section id="visualize" class="level4"><h4 class="anchored" data-anchor-id="visualize">Visualize</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb528"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#:::::::: PLOT</span>

<span class="co">#GGSTATS | MODEL | LOG ODDS </span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggcoefstats.html">ggcoefstats</a></span><span class="op">(</span><span class="va">m1</span>, output <span class="op">=</span> <span class="st">"plot"</span>, 
              conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Log Odds Estimate"</span>, 
       subtitle <span class="op">=</span> <span class="st">"p is for two tailed test"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb529"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m1</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span>,
           p.threshold <span class="op">=</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span>
           ci.lvl <span class="op">=</span> <span class="fl">0.90</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#manually adjusted for directional test   </span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-55-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb530"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m1</span>, type<span class="op">=</span><span class="st">"eff"</span>,
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,
           show.values <span class="op">=</span> <span class="cn">TRUE</span>,
           title <span class="op">=</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,
           axis.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-55-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb532"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | TABLE</span>
<span class="co"># tab_model(m1)</span>

<span class="co">#MODELSUMMARY | MODEL | PROBABILITIES</span>
<span class="co"># modelsummary(m1, exponentiate = TRUE)</span>

<span class="co">#MARGINALEFFECTS | MODEL | PROBABILITIES</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/marginaleffects/">marginaleffects</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'marginaleffects' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'marginaleffects'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelr':

    typical</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb536"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#plot adjusted predictions, conditional on the CONDITION variable using the plot_cap</span>
<span class="co">#interactions plot_cap(mod, condition = c("length", "style"))</span>
<span class="fu"><a href="https://vincentarelbundock.github.io/marginaleffects/reference/plot_cap.html">plot_cap</a></span><span class="op">(</span><span class="va">m1</span>, condition <span class="op">=</span> <span class="st">"pretty_condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-55-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb537"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># The plot_cme function can be used to draw “Conditional Marginal Effects.” </span>
<span class="co">#use for ixns </span>
<span class="co"># plot_cme(m1, effect = "var1", condition = "pretty_condition")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics" class="level4"><h4 class="anchored" data-anchor-id="diagnostics">Diagnostics</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb538"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb540"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model's explanatory power is weak (Tjur's R2 = 0.03). The model's intercept, corresponding to pretty_condition = control, is at -1.82 (95% CI [-2.30, -1.39], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.90, 95% CI [0.35, 1.48], p = 0.002; Std. beta = 0.90, 95% CI [0.35, 1.48])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb543"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb545"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log | Score_spherical |   PCP
----------------------------------------------------------------------------------------------
337.074 | 344.673 |     0.031 | 0.404 | 1.008 |    0.505 |   -16.847 |           0.021 | 0.673</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb547"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL DIAGNOSTICS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL DIAGNOSTICS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb549"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb550"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Ok: About 100% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-56-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb552"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># logitgof(df$accuracy, m1$fitted.values, ord=FALSE)</span>
<span class="co"># hoslem.test(x = df$accuracy, y = fitted(m1), g =  2)</span>
<span class="co"># p should be non significant</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="inference" class="level4"><h4 class="anchored" data-anchor-id="inference">Inference</h4>
<p>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the <em>impasse condition</em> increase by 146% (<span class="math inline">\(e^{beta_1}\)</span> = 2.46, 95% CI [1.42, 4.37]) over the <em>control condition</em>.</p>
<p><em>Equivalent statements:</em></p>
<ul>
<li>being in impasse condition increases log odds of correct response by 0.901 (over control)</li>
<li>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</li>
<li>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb553"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PRETTY TABLE SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.10&nbsp;–&nbsp;0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.42&nbsp;–&nbsp;4.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.002</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">330</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.031</td>
</tr>
</tbody></table>
</div>
</div>
</section></section></section><section id="ordinal-outcome" class="level2"><h2 class="anchored" data-anchor-id="ordinal-outcome">ORDINAL OUTCOME</h2>
<p><strong>Does CONDITION affect the Q1 [ordered] type of response given?</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb554"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> 
<span class="co">#scaled has already been set as an ordered factor of score_SCALED</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">scaled</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth      0.39683 0.15873
  unknown   0.00794 0.00000
  uncertain 0.00000 0.14286
  lines     0.00794 0.05556
  tri       0.07937 0.15079</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb556"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">scaled</span>, fill<span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb557"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,
                       fill <span class="op">=</span> <span class="va">scaled</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Q1 Interpretation"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Does CONDITION affect the Q1 [ordered] state of understanding?</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb558"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> 
<span class="co">#scaled has already been set as an ordered factor of score_SCALED</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth-like 0.39683 0.15873
  unknown   0.00794 0.14286
  tri-like  0.08730 0.20635</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb560"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">state</span>, fill<span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb561"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,
                       fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Q1 State"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20SETUP-INDEPENDENT-ORDINAL-STATE-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="ordinal-regression-cumulative-link-proportional-odds" class="level3"><h3 class="anchored" data-anchor-id="ordinal-regression-cumulative-link-proportional-odds">ORDINAL REGRESSION — Cumulative Link; Proportional Odds</h3>
<p><em>Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.</em></p>
<ul>
<li><a href="https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/" class="uri">https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</a></li>
<li><a href="https://journals.sagepub.com/doi/full/10.1177/2515245918823199" class="uri">https://journals.sagepub.com/doi/full/10.1177/2515245918823199</a></li>
<li>todo see ordinal regression video: <a href="https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK" class="uri">https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK</a>
</li>
<li><a href="https://peopleanalytics-regression-book.org/ord-reg.html" class="uri">https://peopleanalytics-regression-book.org/ord-reg.html</a></li>
<li><a href="https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2" class="uri">https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2</a></li>
<li><a href="https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf" class="uri">https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf</a></li>
</ul>
<p><strong>Learning Notes</strong></p>
<ul>
<li>proportional odds regression models effectively act as a series of stratified binomial models under the assumption that the ‘slope’ of the logistic function of each stratified model is the same.</li>
<li>thus need to verify proportional odds assumption - ordinal regression requires an <strong>proportional odds assumption</strong> (the same slope holds for each equation)</li>
<li>this is required because the model simultaneously estimates k-1 equations, but each equation has the same <em>slope</em>, with different intercepts.</li>
<li>conversely, a multinomial (categorical) model will have different slopes as well as intercepts - the intercepts are always ordered in size alpha 1 &lt; alpha 2 &lt; alpha k-1…</li>
<li>
<strong>TODO</strong> - see difference between the three types of ordinal models (adjacent category (vs) cumulative proportions; check Agresti book</li>
</ul>
<section id="fit-model-1" class="level4"><h4 class="anchored" data-anchor-id="fit-model-1">Fit Model</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb562"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::ORDINAL REGRESSION MODELS</span>

<span class="co">#EMPTY MODEL</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb564"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">om.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ordinal/man/clm.html">clm</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="fl">1</span> , data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co"># summary(om.0)</span>

<span class="co">#PREDICTOR MODEL</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Ordinal regression of q1 SCALED score (ordered interpretation)"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordinal regression of q1 SCALED score (ordered interpretation)"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb566"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">om</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ordinal/man/clm.html">clm</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co"># summary(om)</span>

<span class="co">#COMPARE EMPTY AND PREDICTOR</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">om.0</span>, <span class="va">om</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name | Model | df | df_diff |  Chi2 |      p
--------------------------------------------
om.0 |   clm |  2 |         |       |       
om   |   clm |  3 |       1 | 25.77 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb568"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::: EQUIVALENT APPROACH USING POLYR </span>

<span class="co"># #MODEL</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/polr.html">polr</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span>, Hess<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># summary(m)</span>

<span class="co">#exponentiate coefficients and CIs</span>
<span class="co"># (ctable &lt;- coef(summary(m)))</span>
<span class="co"># (p &lt;- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2)</span>
<span class="co"># (ctable &lt;- cbind(ctable, "p value" = p))</span>
<span class="co"># (ci &lt;- confint(m))</span>
<span class="co"># (e &lt;- coef(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Likelihood ratio test suggests the predictor model is a better fit than the empty (intercept only) model.</em></p>
</section><section id="inference-1" class="level4"><h4 class="anchored" data-anchor-id="inference-1">Inference</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb569"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SUMMARY"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SUMMARY"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb571"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>formula: state ~ condition
data:    df

 link  threshold nobs logLik  AIC    niter max.grad cond.H 
 logit flexible  126  -109.55 225.09 6(0)  2.18e-10 2.5e+01

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
conditionimpasse      1.9        0.4    4.74  2.1e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Threshold coefficients:
                  Estimate Std. Error z value
orth-like|unknown    1.326      0.323    4.10
unknown|tri-like     2.109      0.355    5.94</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb573"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#LOG ODDS</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"IN LOG ODDS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "IN LOG ODDS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb575"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">ctable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                  Estimate Std. Error z value Pr(&gt;|z|)
orth-like|unknown     1.33      0.323    4.10 4.07e-05
unknown|tri-like      2.11      0.355    5.94 2.80e-09
conditionimpasse      1.90      0.400    4.74 2.10e-06</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb577"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/confint.html">confint</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
conditionimpasse  1.14   2.72</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb579"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"IN ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "IN ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb581"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#ODDS RATIOS</span>
<span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>orth-like|unknown  unknown|tri-like  conditionimpasse 
             3.77              8.24              6.68 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb583"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">ci</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 2.5 % 97.5 %
conditionimpasse  3.12   15.1</code></pre>
</div>
</div>
<p><strong>Overall, participants in the impasse condition had higher odds (6.68 X as likely) to offer <em>more correct</em> interpretations than those in the control condition (z = 4.74, p &lt; 0.001).</strong></p>
<ul>
<li>we see the estimates for the 2 intercepts, which are sometimes called cutpoints.</li>
<li>The intercepts indicate where the latent variable is cut to make the three groups that we observe in our data.</li>
<li>Note that this latent variable is continuous. In general, these are not used in the interpretation of the results.</li>
<li>The cutpoints are closely related to thresholds, which are reported by other statistical packages.</li>
<li>for k groups there will be k-1 intercepts (cutpoints)</li>
<li>confirm that the CI does not include 0 (the units are ordered logits [ordered log odds])</li>
<li>as with logistic regression we exponentiate the coefficients and confints to get odds ratio</li>
</ul></section><section id="visualize-model" class="level4"><h4 class="anchored" data-anchor-id="visualize-model">Visualize Model</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb585"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># sjPlot::tab_model(om)</span>
<span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb586"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">om</span>, type <span class="op">=</span> <span class="st">"eff"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-62-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb588"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R">                   <span class="co"># show.data = TRUE, jitter = TRUE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics-1" class="level4"><h4 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb589"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#:: ASSESS FIT</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Nagelkerke's R2 |  RMSE | Sigma
---------------------------------------------------
225.090 | 233.599 |           0.216 | 1.629 | 1.648</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb592"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># #test proporitional odds assumption </span>
<span class="fu"><a href="https://rdrr.io/pkg/brant/man/brant.html">brant</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="co">#only works for polyr type model not clm type model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Test for        X2  df  probability 
---------------------------------------------------- 
Omnibus         15.6    1   0
conditionimpasse    15.6    1   0
---------------------------------------------------- 

H0: Parallel Regression Assumption holds</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb594"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># # A p-value of less than 0.05 on this test—particularly on the Omnibus plus at least one of the variables—should be interpreted as a failure of the proportional odds assumption.</span>

<span class="co">#test proportional odds assumption</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pomcheckr</span><span class="op">)</span>
<span class="co"># https://cran.r-project.org/web/packages/pomcheckr/pomcheckr.pdf</span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pomcheckr/man/pomcheck.html">pomcheck</a></span><span class="op">(</span> <span class="va">scaled</span> <span class="op">~</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 2 × 6
# Groups:   condition [2]
  condition `scaled_&gt;=1` `scaled_&gt;=2` `scaled_&gt;=4` `scaled_&gt;=5` `scaled_&gt;=3`
  &lt;fct&gt;            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1 control            Inf        -1.43       -1.53        -1.65        NA    
2 impasse            Inf        NA          -0.379       -0.862        0.788

attr(,"class")
[1] "pomcheck" "list"    </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb596"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>The output of the graphical test for proportional odds assumption suggests that the proportional odds assumption may be unreasonable for this dataset. Also, inspecting the output table, we see the coefficients for each level of the scaled variable are quite different.</strong></p>
<p>Thus, an alternative approach may be more appropriate:</p>
<ul>
<li><p>Baseline logistic model. This model is the same as the multinomial regression model covered in the previous chapter, using the lowest ordinal value as the reference.</p></li>
<li><p>Adjacent-category logistic model. This model compares each level of the ordinal variable to the next highest level, and it is a constrained version of the baseline logistic model. The brglm2 package in R offers a function bracl() for calculating an adjacent category logistic model.</p></li>
<li><p>Continuation-ratio logistic model. This model compares each level of the ordinal variable to all lower levels. This can be modeled using binary logistic regression techniques, but new variables need to be constructed from the data set to allow this. The R package rms has a function cr.setup() which is a utility for preparing an outcome variable for a continuation ratio model.</p></li>
</ul>
<p>*Note: for multiple regression, the ordinal package offers a parameter (nominal = ~predictors) that allow you to designate some predictors as nominal rather than ordinal. But this is not appropriate for this use case._</p>
</section></section></section><section id="categorical-outcome" class="level2"><h2 class="anchored" data-anchor-id="categorical-outcome">CATEGORICAL OUTCOME</h2>
<p><strong>Does CONDITION affect the Q1 [ordered] type of response given?</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb598"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> 
<span class="co">#scaled has already been set as an ordered factor of score_SCALED</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">scaled</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse
  orth      0.39683 0.15873
  unknown   0.00794 0.00000
  uncertain 0.00000 0.14286
  lines     0.00794 0.05556
  tri       0.07937 0.15079</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb600"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">scaled</span>, fill<span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb601"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,
                       fill <span class="op">=</span> <span class="va">scaled</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Q1 Interpretation"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-64-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Does CONDITION affect the Q1 [ordered] state of understanding?</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb602"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span> 
<span class="co">#scaled has already been set as an ordered factor of score_SCALED</span>

<span class="co">#::::::::::::DESCRIPTIVES</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="co">#display sum for row</span>
      <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span>margin<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span>  <span class="co">#return proportion (of column)</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co">#sanity check sum of columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse    Sum
  orth-like  0.8065  0.3125 0.5556
  unknown    0.0161  0.2812 0.1508
  tri-like   0.1774  0.4062 0.2937
  Sum        1.0000  1.0000 1.0000</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb604"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">state</span>, fill<span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb605"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,
                       fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Q1 State"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-65-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb606"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GGSTATSPLOT</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbarstats.html">ggbarstats</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">state</span>, <span class="va">condition</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-65-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="chi-square-1" class="level3"><h3 class="anchored" data-anchor-id="chi-square-1">CHI SQUARE</h3>
<p><strong>Does CONDITION affect the Q1 [categorical] type of response given?</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb607"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">scaled</span>, 
             fisher <span class="op">=</span> <span class="cn">TRUE</span>, chisq<span class="op">=</span><span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span>, sresid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(t, correct = FALSE, ...): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  126 

 
             | df$scaled 
df$condition |      orth |   unknown | uncertain |     lines |       tri | Row Total | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
     control |        50 |         1 |         0 |         1 |        10 |        62 | 
             |    34.444 |     0.492 |     8.857 |     3.937 |    14.270 |           | 
             |     7.025 |     0.524 |     8.857 |     2.191 |     1.278 |           | 
             |     0.806 |     0.016 |     0.000 |     0.016 |     0.161 |     0.492 | 
             |     0.714 |     1.000 |     0.000 |     0.125 |     0.345 |           | 
             |     0.397 |     0.008 |     0.000 |     0.008 |     0.079 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
     impasse |        20 |         0 |        18 |         7 |        19 |        64 | 
             |    35.556 |     0.508 |     9.143 |     4.063 |    14.730 |           | 
             |     6.806 |     0.508 |     8.580 |     2.122 |     1.238 |           | 
             |     0.312 |     0.000 |     0.281 |     0.109 |     0.297 |     0.508 | 
             |     0.286 |     0.000 |     1.000 |     0.875 |     0.655 |           | 
             |     0.159 |     0.000 |     0.143 |     0.056 |     0.151 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
Column Total |        70 |         1 |        18 |         8 |        29 |       126 | 
             |     0.556 |     0.008 |     0.143 |     0.063 |     0.230 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  39.1     d.f. =  4     p =  6.55e-08 


 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Alternative hypothesis: two.sided
p =  1.01e-09 

 </code></pre>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb610"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Interpretation on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">condition</span> <span class="op">~</span> <span class="va">scaled</span>, 
            shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb611"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::WITH STATISTICS</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggbarstats.html">ggbarstats</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">scaled</span>,
           type <span class="op">=</span> <span class="st">"nonparametric"</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-67-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb612"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Response Type on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">condition</span> <span class="op">~</span> <span class="va">scaled</span>, 
            shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/label%20-%20CHISQR-interpreation-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb613"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">scaled</span>, 
            fisher <span class="op">=</span> <span class="cn">TRUE</span>, chisq<span class="op">=</span><span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span>, sresid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(t, correct = FALSE, ...): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  126 

 
             | df$scaled 
df$condition |      orth |   unknown | uncertain |     lines |       tri | Row Total | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
     control |        50 |         1 |         0 |         1 |        10 |        62 | 
             |    34.444 |     0.492 |     8.857 |     3.937 |    14.270 |           | 
             |     7.025 |     0.524 |     8.857 |     2.191 |     1.278 |           | 
             |     0.806 |     0.016 |     0.000 |     0.016 |     0.161 |     0.492 | 
             |     0.714 |     1.000 |     0.000 |     0.125 |     0.345 |           | 
             |     0.397 |     0.008 |     0.000 |     0.008 |     0.079 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
     impasse |        20 |         0 |        18 |         7 |        19 |        64 | 
             |    35.556 |     0.508 |     9.143 |     4.063 |    14.730 |           | 
             |     6.806 |     0.508 |     8.580 |     2.122 |     1.238 |           | 
             |     0.312 |     0.000 |     0.281 |     0.109 |     0.297 |     0.508 | 
             |     0.286 |     0.000 |     1.000 |     0.875 |     0.655 |           | 
             |     0.159 |     0.000 |     0.143 |     0.056 |     0.151 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|
Column Total |        70 |         1 |        18 |         8 |        29 |       126 | 
             |     0.556 |     0.008 |     0.143 |     0.063 |     0.230 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  39.1     d.f. =  4     p =  6.55e-08 


 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Alternative hypothesis: two.sided
p =  1.01e-09 

 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb616"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scaled"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">scaled</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">orth</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">50</span><br><span style="color:#339999;">34</span><br><span style="color:#333399;">71.4&nbsp;%</span><br><span style="color:#339933;">80.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">20</span><br><span style="color:#339999;">36</span><br><span style="color:#333399;">28.6&nbsp;%</span><br><span style="color:#339933;">31.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">70</span><br><span style="color:#339999;">70</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">55.6&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">unknown</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">1</span><br><span style="color:#339999;">0</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">1.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">0</span><br><span style="color:#339999;">1</span><br><span style="color:#333399;">0&nbsp;%</span><br><span style="color:#339933;">0&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">1</span><br><span style="color:#339999;">1</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">0.8&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">uncertain</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">0</span><br><span style="color:#339999;">9</span><br><span style="color:#333399;">0&nbsp;%</span><br><span style="color:#339933;">0&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">18</span><br><span style="color:#339999;">9</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">28.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">18</span><br><span style="color:#339999;">18</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">14.3&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">lines</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">1</span><br><span style="color:#339999;">4</span><br><span style="color:#333399;">12.5&nbsp;%</span><br><span style="color:#339933;">1.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">7</span><br><span style="color:#339999;">4</span><br><span style="color:#333399;">87.5&nbsp;%</span><br><span style="color:#339933;">10.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">8</span><br><span style="color:#339999;">8</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">6.3&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">tri</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">10</span><br><span style="color:#339999;">14</span><br><span style="color:#333399;">34.5&nbsp;%</span><br><span style="color:#339933;">16.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">19</span><br><span style="color:#339999;">15</span><br><span style="color:#333399;">65.5&nbsp;%</span><br><span style="color:#339933;">29.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">29</span><br><span style="color:#339999;">29</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">23&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">62</span><br><span style="color:#339999;">62</span><br><span style="color:#333399;">49.2&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">64</span><br><span style="color:#339999;">64</span><br><span style="color:#333399;">50.8&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">126</span><br><span style="color:#339999;">126</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=39.128 · df=4 · Cramer's V=0.557 · Fisher's p=0.000</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within scaled</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
</div>
<p><strong>TODO INFERENCE</strong></p>
</section><section id="multinomial-regression" class="level3"><h3 class="anchored" data-anchor-id="multinomial-regression">MULTINOMIAL REGRESSION</h3>
<p><strong>TODO</strong> RECONCILE actual predictions with coefficients and visualization of predictions</p>
<p><em>Does condition affect the response state of Q1?</em></p>
<ul>
<li><a href="https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model" class="uri">https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model</a></li>
<li><a href="https://bookdown.org/chua/ber642_advanced_regression/multinomial-logistic-regression.html" class="uri">https://bookdown.org/chua/ber642_advanced_regression/multinomial-logistic-regression.html</a></li>
<li><a href="https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK" class="uri">https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK</a></li>
<li>Can use nnet package multinom() or mclogit package mblogit() [“baseline logit model”] or brms with family = “categorical”</li>
</ul>
<p><em>Fit a logistic regression predicting interpretation (k=#response categories) by condition. (k = 2).</em></p>
<ul>
<li><p>2 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer)</p></li>
<li><p>(from experience, seems) Each cell must have at least one observation (if one cell is blank, then it seems to be incorrectly estimated, see predicting high_interpretation vs.&nbsp;state. suggests nonsignificant OR for ‘unknown’ category, when infact that difference drives the effect</p></li>
<li>
<p>For <em>each</em> equation:</p>
<ul>
<li>
<p><span class="math inline">\(\beta_{0}\)</span> <em>= Log Odds of [this category type vs.&nbsp;reference category type) response in CONTROL condition</em></p>
<ul>
<li>
<span class="math inline">\(e^{\beta_{0}}\)</span> <em>= ODDS of [this category type vs.&nbsp;reference category type] response in CONTROL condition</em>
</li>
</ul>
</li>
<li><p><span class="math inline">\(\beta_{1}\)</span> <em>=</em> <span class="math inline">\(\beta_{1impasse}\)</span> <em>Log Odds (Log OR; change in odds for [this category] type response in impasse (vs) control [log scale])</em></p></li>
<li><p><span class="math inline">\(e^{\beta_{1}}\)</span> <em>= ODDS RATIO of [this. vs reference category type] response in IMPASSE (vs) CONTROL</em></p></li>
<li><p><em>Null hypothesis:</em> <span class="math inline">\(\beta_{impasse} \le 0\)</span> <em>the odds for [this category of response vs.&nbsp;reference] does not change, or decreases</em></p></li>
<li><p><em>Alternative hypothesis:</em> <span class="math inline">\(\beta_{impasse} \gt 0\)</span> <em>the odds of [this category of response vs.&nbsp;reference] increases</em></p></li>
<li>
</li></ul>
</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb617"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::::::DESCRIPTIVES RESPONSE STATE</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="co">#display sum for row</span>
      <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span>margin<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span>  <span class="co">#return proportion (of column)</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co">#sanity check sum of columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse    Sum
  orth-like  0.8065  0.3125 0.5556
  unknown    0.0161  0.2812 0.1508
  tri-like   0.1774  0.4062 0.2937
  Sum        1.0000  1.0000 1.0000</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb619"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span>, <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="co">#display sum for row</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#sanity check sum of columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse Sum
  orth-like      50      20  70
  unknown         1      18  19
  tri-like       11      26  37
  Sum            62      64 126</code></pre>
</div>
</div>
<section id="fit-model-2" class="level4"><h4 class="anchored" data-anchor-id="fit-model-2">Fit Model</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb621"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span>

<span class="co">#check reference level </span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "orth-like" "unknown"   "tri-like" </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb623"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT EMPTY MODEL</span>
<span class="va">catm.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># weights:  6 (2 variable)
initial  value 138.425148 
final  value 122.428550 
converged</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb625"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># summary(catm.0)</span>

<span class="co">#FIT PREDICTOR MODEL</span>
<span class="va">catm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">state</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># weights:  9 (4 variable)
initial  value 138.425148 
iter  10 value 103.421004
iter  10 value 103.421004
final  value 103.421004 
converged</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb627"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># summary(catm)</span>

<span class="co">#COMPARE MODEL FIT</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">catm.0</span>, <span class="va">catm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name   |    Model | df | df_diff |  Chi2 |      p
-------------------------------------------------
catm.0 | multinom |  2 |         |       |       
catm   | multinom |  4 |       2 | 38.02 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb629"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">##compare bayesian version</span>
<span class="co">#library(brms)</span>
<span class="co"># bm1 &lt;- brm( state ~ pretty_condition, data = df, family = "categorical")</span>
<span class="co"># summary(bm1)</span>
<span class="co"># plot_model(bm1)</span>
<span class="co"># report(bm1)</span>
<span class="co"># coefficient estimates are very simliar to catm. super cool!</span>

<span class="co">##compare mclogit version</span>
<span class="co">#"baseline-category logit model</span>
<span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span>
<span class="co"># blm1 &lt;- mblogit(state ~ pretty_condition , data = df)</span>
<span class="co"># summary(blm1)</span>
<span class="co">#identical to catm. super cool!</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.</em></p>
</section><section id="interpretation" class="level4"><h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb630"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#::::::::INTERPRETATION</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MODEL SUMMARY"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL SUMMARY"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb632"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = state ~ condition, data = df, model = TRUE)

Coefficients:
         (Intercept) conditionimpasse
unknown        -3.91             3.81
tri-like       -1.51             1.78

Std. Errors:
         (Intercept) conditionimpasse
unknown        1.010            1.061
tri-like       0.333            0.447

Residual Deviance: 207 
AIC: 215 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb634"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># calculate z-statistics of coefficients</span>
<span class="op">(</span><span class="va">z_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span><span class="op">$</span><span class="va">standard.errors</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         (Intercept) conditionimpasse
unknown        -3.87             3.59
tri-like       -4.55             3.98</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb636"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># convert to p-values</span>
<span class="va">p_values</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z_stats</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span>
<span class="co"># display p-values in transposed data frame</span>
<span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>p <span class="op">=</span> <span class="op">(</span><span class="va">p_values</span><span class="op">)</span><span class="op">)</span>
<span class="co"># display odds ratios in transposed data frame</span>

<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb638"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">odds_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">)</span>

<span class="co"># options(scipen = 3)</span>
<span class="op">(</span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">odds_ratios</span>, <span class="va">p_values</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         OR..Intercept. OR.conditionimpasse p..Intercept. p.conditionimpasse
unknown            0.02               44.99      1.07e-04          0.0003330
tri-like           0.22                5.91      5.45e-06          0.0000692</code></pre>
</div>
</div>
<p><strong>Learning Notes</strong></p>
<ul>
<li>Model estimates encompass two equations:</li>
<li>effect of predictor on log odds of being in [unknown] instead of reference category [orth-like]</li>
<li>effect of predictor on log odds of being in [tri-like] instead of reference category [orth-like]</li>
<li>[need to to double check interpretation, but I <em>think</em> that the OR intercepts converted to probabilities equate to the marginal probability of being in each state in the [reference] control condition. which makes sense. I think]</li>
<li>IF I change reference category for condition… then the intercepts should no longer be significant. The b1 coefficients should still be significant, but with changed sign (much less likely) [Yup! this works!]</li>
</ul></section><section id="inference-2" class="level4"><h4 class="anchored" data-anchor-id="inference-2">Inference</h4>
<ul>
<li>Being in the IMPASSE condition increases the odds of giving ‘unknown/uncertain’ response rather than an orthogonal (or satisficing) response by a factor of 50 (z = 3.59, p &lt; 0.001 ).</li>
<li>Being in the IMPASSE condition increases the odds of giving an ‘triangular or line-driven’ response rather than an orthogonal (or satisficing) response by a factor of 6 (z = 3.98, p &lt;0.001 )</li>
</ul></section><section id="visualize-1" class="level4"><h4 class="anchored" data-anchor-id="visualize-1">Visualize</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb640"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">catm</span>, vline.color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb641"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">catm</span>, type <span class="op">=</span> <span class="st">"eff"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-72-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="diagnostics-2" class="level4"><h4 class="anchored" data-anchor-id="diagnostics-2">Diagnostics</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb643"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#EXAMINE PREDICTIONS</span>
<span class="co">#create sample data frame</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"impasse"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">catm</span>, newdata <span class="op">=</span> <span class="va">test</span>, <span class="st">"probs"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Predicted Probability of Being in Each State"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Predicted Probability of Being in Each State"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb645"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">test</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  condition orth-like unknown tri-like
1   control     0.806  0.0161    0.177
2   impasse     0.312  0.2812    0.406</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb647"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#performance</span>
<span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">catm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Nagelkerke's R2 |  RMSE | Sigma
---------------------------------------------------
214.842 | 226.187 |           0.304 | 0.404 | 1.302</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb650"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/PseudoR2.html">PseudoR2</a></span><span class="op">(</span><span class="va">catm</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'DescTools':
  method         from 
  reorder.factor gdata</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  McFadden   CoxSnell Nagelkerke 
     0.155      0.260      0.304 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb653"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#General Goodness of Fit</span>
<span class="co"># library(generalhoslem)</span>
<span class="co"># logitgof(df$state, catm$fitted.values, g = 3)</span>
<span class="co"># hoslem.test(x = df$state, y = catm$fitted.values, g =  10)</span>
<span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span>
<span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section></section><section id="mixed-repeated-measures" class="level1"><h1>MIXED (Repeated Measures)</h1>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb654"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PREPARE DATA </span>
<span class="va">n_items</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#number of items in test</span>

<span class="co">#item level</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_niceABS</span>, <span class="st">"0"</span> <span class="op">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"correct"</span><span class="op">)</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">#FACETED HISTOGRAM</span>
<span class="va">stats</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">pretty_condition</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">item_test_NABS</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">item_test_NABS</span>, 
         fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">pretty_mode</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_lines.html">gf_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stats</span>, xintercept <span class="op">=</span> <span class="op">~</span><span class="va">mean</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"# Correct"</span>,
       y <span class="op">=</span> <span class="st">"proportion of subjects"</span>,
       title <span class="op">=</span> <span class="st">"Test Phase Absolute Score (# Correct)"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb655"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">accuracy</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, x <span class="op">=</span><span class="op">~</span><span class="va">pretty_condition</span>,
       position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Correct Responses in Test Phase"</span>,
       title <span class="op">=</span> <span class="st">"Accuracy on Task by Condition"</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb656"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on Test Phase"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/SETUP-TEST-ACC-ITEM-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="mixed-continuous" class="level2"><h2 class="anchored" data-anchor-id="mixed-continuous">MIXED — CONTINUOUS</h2>
</section><section id="mixed-binomial" class="level2"><h2 class="anchored" data-anchor-id="mixed-binomial">MIXED — BINOMIAL</h2>
<section id="mixed-logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="mixed-logistic-regression">Mixed Logistic Regression</h4>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on test phase questions by condition; accounting for random effects of subject.</em></p>
<section id="fit-model-3" class="level5"><h5 class="anchored" data-anchor-id="fit-model-3">Fit Model</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb657"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA </span>
<span class="va">n_items</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#number of items in test</span>

<span class="co">#item level</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>
<span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span><span class="st">"lab-synch"</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR">lmerTest</a></span><span class="op">)</span> <span class="co">#for CIs in glmer </span>

<span class="co">## 1 | SETUP RANDOM EFFECT</span>

<span class="co">#:: EMPTY MODEL (baseline, no random effect)</span>
<span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> 

<span class="co">#:: RANDOM INTERCEPT SUBJECT</span>
<span class="va">mm.rS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>

<span class="co"># :: TEST random effect</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC with random effect is lower than glm empty model?"</span>, <span class="va">m0</span><span class="op">$</span><span class="va">aic</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC with random effect is lower than glm empty model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb659"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">mm.rS</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name  |    Model | df | df_diff |   Chi2 |      p
-------------------------------------------------
m0    |      glm |  1 |         |        |       
mm.rS | glmerMod |  2 |       1 | 678.41 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb661"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  1.48371797931313e-149"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb663"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## 2 | ADD FIXED EFFECT</span>

<span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span>
<span class="va">mm.CrS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, 
                data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>

<span class="co"># :: TEST fixed factor </span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC with fixed effect is lower than random intercept only model?"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC with fixed effect is lower than random intercept only model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb665"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rS</span>,<span class="va">mm.CrS</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name   |    Model | df | df_diff | Chi2 |     p
-----------------------------------------------
mm.rS  | glmerMod |  2 |         |      |      
mm.CrS | glmerMod |  3 |       1 | 3.91 | 0.048</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb667"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rS</span>,<span class="va">mm.CrS</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.047907883063779"</code></pre>
</div>
</div>
</section><section id="visualize-2" class="level5"><h5 class="anchored" data-anchor-id="visualize-2">Visualize</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb669"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PRINT MODEL </span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb671"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://jtools.jacob-long.com/reference/summ.html">summ</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 1008 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> accuracy </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> Mixed effects generalized linear model </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Family </td>
   <td style="text-align:right;"> binomial </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Link </td>
   <td style="text-align:right;"> logit </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> AIC </td>
   <td style="text-align:right;"> 582.02 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> BIC </td>
   <td style="text-align:right;"> 596.77 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (fixed effects) </td>
   <td style="text-align:right;"> 0.07 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (total) </td>
   <td style="text-align:right;"> 0.95 </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Fixed Effects</div></th></tr>
<tr>
<th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> z val. </th>
   <th style="text-align:right;"> p </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> -7.46 </td>
   <td style="text-align:right;"> 1.20 </td>
   <td style="text-align:right;"> -6.21 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> pretty_conditionimpasse </td>
   <td style="text-align:right;"> 4.03 </td>
   <td style="text-align:right;"> 1.67 </td>
   <td style="text-align:right;"> 2.42 </td>
   <td style="text-align:right;"> 0.02 </td>
  </tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Random Effects</div></th></tr>
<tr>
<th> Group </th>
   <th> Parameter </th>
   <th> Std. Dev. </th>
  </tr>
</thead>
<tbody><tr>
<td> subject </td>
   <td> (Intercept) </td>
   <td> 7.36 </td>
  </tr></tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Grouping Variables</div></th></tr>
<tr>
<th> Group </th>
   <th> # groups </th>
   <th> ICC </th>
  </tr>
</thead>
<tbody><tr>
<td> subject </td>
   <td> 126 </td>
   <td> 0.94 </td>
  </tr></tbody>
</table>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb672"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: INTERPRET COEFFICIENTS</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb674"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma | Log_loss | Score_log | Score_spherical
------------------------------------------------------------------------------------------------------------
582.024 | 596.771 |      0.946 |      0.066 | 0.943 | 0.213 | 1.000 |    0.145 |      -Inf |           0.021</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb676"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb678"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic mixed model (estimated using ML and Nelder-Mead optimizer) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model included subject as random effect (formula: ~1 | subject). The model's total explanatory power is substantial (conditional R2 = 0.95) and the part related to the fixed effects alone (marginal R2) is of 0.07. The model's intercept, corresponding to pretty_condition = control, is at -7.46 (95% CI [-9.81, -5.11], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 4.03, 95% CI [0.76, 7.29], p = 0.016; Std. beta = 4.03, 95% CI [0.76, 7.29])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb681"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># se &lt;- sqrt(diag(stats::vcov(m1)))</span>
<span class="co"># # table of estimates with 95% CI</span>
<span class="co"># (tab &lt;- cbind(Est = fixef(m1), LL = fixef(m1) - 1.96 * se, UL = fixef(m1) + 1.96 *</span>
<span class="co">#     se))</span>
<span class="co"># (e &lt;- exp(tab))</span>

<span class="co">#: PLOT</span>

<span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mm.CrS</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb682"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mm.CrS</span>, type<span class="op">=</span><span class="st">"pred"</span>,
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,
           show.values <span class="op">=</span> <span class="cn">TRUE</span>,
           title <span class="op">=</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,
           axis.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-76-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb684"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span>
<span class="co"># library(ggeffects)</span>
<span class="co"># ggeffect(model = mm.CrS) %&gt;% plot()</span>

<span class="co">#SANITY CHECK SJPLOT</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(mm.CrS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics-3" class="level5"><h5 class="anchored" data-anchor-id="diagnostics-3">Diagnostics</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb685"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb686"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Warning: Probably bad model fit. Only about 64% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-77-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="inference-3" class="level5"><h5 class="anchored" data-anchor-id="inference-3">Inference</h5>
<p>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(3): 4.98, p &lt; 0.05). Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 5 over the control condition <span class="math inline">\(e^{\beta_1}\)</span> = 5.11, 95% CI [1.17,22,36], p &lt; 0.05.</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb688"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># PRETTY TABLE SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">56.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.14&nbsp;–&nbsp;1472.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.016</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">54.11</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.94</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">126</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1008</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.066 / 0.946</td>
</tr>
</tbody></table>
</div>
</div>
</section></section></section><section id="mixed-ordinal" class="level2"><h2 class="anchored" data-anchor-id="mixed-ordinal">MIXED — ORDINAL</h2>
</section><section id="mixed-categorical" class="level2"><h2 class="anchored" data-anchor-id="mixed-categorical">MIXED — CATEGORICAL</h2>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb689"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#BAYESIAN MIXED VERSION</span>
<span class="co">#df &lt;- df_items %&gt;% filter(q %nin% c(1,2,3,4,5,6,9)) %&gt;% filter(term=="spring18")</span>
<span class="co"># mm1 &lt;- brm( state ~ condition + (1|subject), data = df, family = "categorical", </span>
<span class="co"># file = "analysis/models/sgc3a_brms_mixedcat_teststate.rds" # cache model (can be removed)))</span>
<span class="co"># summary(mm1)</span>
<span class="co"># performance(mm1)</span>
<span class="co"># plot(mm1)</span>
<span class="co"># #report(mm1)</span>
<span class="co"># #check_posterior_predictions(mm1, draws=100)</span>
<span class="co"># # library(bayesplot)</span>
<span class="co"># library(bayestestR)</span>
<span class="co"># plot(rope(mm1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="wip-unknown" class="level2"><h2 class="anchored" data-anchor-id="wip-unknown">WIP UNKNOWN</h2>
<section id="cummulative-ordinal-bayesian-equal-variance" class="level3"><h3 class="anchored" data-anchor-id="cummulative-ordinal-bayesian-equal-variance">Cummulative Ordinal (Bayesian) — Equal Variance</h3>
<p>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb690"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span>


<span class="co">#DEFINE DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span><span class="st">"lab-synch"</span><span class="op">)</span>
  
<span class="co">#TODO: why is this probit instead of logit?</span>
<span class="va">cumord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">state</span> <span class="op">~</span> <span class="va">condition</span>,
               data <span class="op">=</span> <span class="va">df</span>,
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">cumulative</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span>,
               file <span class="op">=</span> <span class="st">"analysis/models/sgc3a_brms_cumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = probit; disc = identity 
Formula: state ~ condition 
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]         0.75      0.18     0.41     1.11 1.00     3054     2790
Intercept[2]         1.22      0.19     0.85     1.60 1.00     3305     2732
conditionimpasse     1.11      0.23     0.66     1.55 1.00     3192     2953

Family Specific Parameters: 
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb692"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">cumord</span>, <span class="st">"condition"</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb693"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-80-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb694"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-80-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb695"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/rope.html">rope</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.76). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-80-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb697"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#REPORT</span>
<span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.76). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.76). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'cf2f01a4fe37a84227ece42ac0100f30' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 7.7e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.77 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.145152 seconds (Warm-up)
Chain 1:                0.142215 seconds (Sampling)
Chain 1:                0.287367 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'cf2f01a4fe37a84227ece42ac0100f30' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 4e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.4 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.140972 seconds (Warm-up)
Chain 2:                0.146357 seconds (Sampling)
Chain 2:                0.287329 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'cf2f01a4fe37a84227ece42ac0100f30' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 2.8e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.28 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.142461 seconds (Warm-up)
Chain 3:                0.144181 seconds (Sampling)
Chain 3:                0.286642 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'cf2f01a4fe37a84227ece42ac0100f30' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.3 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.143564 seconds (Warm-up)
Chain 4:                0.148597 seconds (Sampling)
Chain 4:                0.292161 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between b_conditionimpasse and b_Intercept[2] (r = 0.76). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ condition). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50) and uniform (location = , scale = ) distributions. The model's explanatory power is moderate (R2 = 0.18, 95% CI [0.08, 0.28]).  Within this model:

  - The effect of b Intercept[1] (Median = 0.74, 95% CI [0.41, 1.11]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 99.58% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.001) and the indices are reliable (ESS = 3139)
  - The effect of b Intercept[2] (Median = 1.22, 95% CI [0.85, 1.60]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.001) and the indices are reliable (ESS = 3040)
  - The effect of b conditionimpasse (Median = 1.11, 95% CI [0.66, 1.55]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 99.98% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.002) and the indices are reliable (ESS = 3314)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb707"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># ord_cum %&gt;%</span>
<span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co">#   stat_halfeye()</span>

<span class="co"># performance(cumord)</span>
<span class="co"># plot(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="cummulative-ordinal-bayesian-unequal-variance" class="level3"><h3 class="anchored" data-anchor-id="cummulative-ordinal-bayesian-unequal-variance">Cummulative Ordinal (Bayesian) — Unequal Variance</h3>
<p>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb708"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span>


<span class="co">#DEFINE DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span><span class="st">"lab-synch"</span><span class="op">)</span>
  
<span class="co">#TODO: why is this probit instead of logit?</span>
<span class="va">u.cumord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span> 
  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html">bf</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="va">condition</span><span class="op">)</span> <span class="op">+</span>
               <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula-helpers.html">lf</a></span><span class="op">(</span><span class="va">disc</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">condition</span>, cmc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
               data <span class="op">=</span> <span class="va">df</span>,
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">cumulative</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span>,
               file <span class="op">=</span> <span class="st">"analysis/models/sgc3a_brms_ucumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 97 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = probit; disc = log 
Formula: state ~ condition 
         disc ~ 0 + condition
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept[1]              0.84      0.18     0.48     1.19 1.00      960
Intercept[2]              1.01      0.19     0.64     1.39 1.01      908
conditionimpasse          0.96      0.19     0.60     1.32 1.01      954
disc_conditionimpasse     1.52      0.61     0.43     2.68 1.02      313
                      Tail_ESS
Intercept[1]              1061
Intercept[2]               764
conditionimpasse           848
disc_conditionimpasse      227

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb711"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">u.cumord</span>, <span class="st">"condition"</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb712"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-81-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb713"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-81-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb714"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/rope.html">rope</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-81-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb715"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#REPORT</span>
<span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">u.cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL '6d2eabb1cdbde54c793de3661fa8db1b' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 7.2e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.72 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.578461 seconds (Warm-up)
Chain 1:                0.561512 seconds (Sampling)
Chain 1:                1.13997 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL '6d2eabb1cdbde54c793de3661fa8db1b' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 4.1e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.41 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.633652 seconds (Warm-up)
Chain 2:                0.415342 seconds (Sampling)
Chain 2:                1.04899 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL '6d2eabb1cdbde54c793de3661fa8db1b' NOW (CHAIN 3).
Chain 3: Rejecting initial value:
Chain 3:   Log probability evaluates to log(0), i.e. negative infinity.
Chain 3:   Stan can't start sampling from this initial value.
Chain 3: 
Chain 3: Gradient evaluation took 3.8e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.38 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.594079 seconds (Warm-up)
Chain 3:                0.629353 seconds (Sampling)
Chain 3:                1.22343 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL '6d2eabb1cdbde54c793de3661fa8db1b' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3.6e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.36 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.620573 seconds (Warm-up)
Chain 4:                0.440993 seconds (Sampling)
Chain 4:                1.06157 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ condition). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ) and uniform (location = , scale = ) distributions. The model's explanatory power is moderate (R2 = 0.17, 95% CI [0.07, 0.26]).  Within this model:

  - The effect of b Intercept[1] (Median = 0.84, 95% CI [0.48, 1.19]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 99.98% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.000) but the indices are unreliable (ESS = 953)
  - The effect of b Intercept[2] (Median = 1.01, 95% CI [0.64, 1.39]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.008) but the indices are unreliable (ESS = 298)
  - The effect of b conditionimpasse (Median = 0.95, 95% CI [0.60, 1.32]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.000) but the indices are unreliable (ESS = 952)
  - The effect of b disc conditionimpasse (Median = 1.48, 95% CI [0.43, 2.68]) has a 99.80% probability of being positive (&gt; 0), 99.72% of being significant (&gt; 0.05), and 98.67% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.000) but the indices are unreliable (ESS = 905)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb722"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># ord_cum %&gt;%</span>
<span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co">#   stat_halfeye()</span>

<span class="co"># performance(cumord)</span>
<span class="co"># plot(cumord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In brms, the parameter related to latent variances is called disc (short for “discrimination”), following conventions in item response theory. Note that disc is not the variance itself, but the inverse of the standard deviation, s. That is, s = 1/disc. Further, because disc must be strictly positive, it is by default modeled on the log scale.</p>
</section><section id="adjacent-category-ordinal-bayesian" class="level3"><h3 class="anchored" data-anchor-id="adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</h3>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb723"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pomcheckr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span><span class="st">"lab-synch"</span><span class="op">)</span>


<span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span>

<span class="va">adjcat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">state</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/cs.html">cs</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>,
               data <span class="op">=</span> <span class="va">df</span>,
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html">acat</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span>,
               file <span class="op">=</span> <span class="st">"analysis/models/sgc3a_brms_adjcat_q1state.rds"</span> <span class="co"># cache model (can be removed)</span>
<span class="op">)</span>
 
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">adjcat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Family: acat 
  Links: mu = probit; disc = identity 
Formula: state ~ cs(condition) 
   Data: df (Number of observations: 126) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]            1.99      0.37     1.38     2.80 1.00      637      822
Intercept[2]           -1.26      0.47    -2.29    -0.41 1.00      644      812
conditionimpasse[1]     1.92      0.42     1.18     2.79 1.00      656      827
conditionimpasse[2]    -1.02      0.50    -2.08    -0.14 1.00      652      732

Family Specific Parameters: 
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb725"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">cumord</span>, <span class="st">"condition"</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb726"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">adjcat</span>, <span class="st">"condition"</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-82-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb727"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#WHICH IS BETTER? cumulative or adjacent?</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">cumord</span>, <span class="va">adjcat</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.

Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A `range` must be provided for data with only one unique value.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-82-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb730"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">cumord</span>, <span class="va">adjcat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name   |   Model |     ELPD | ELPD_SE |   LOOIC | LOOIC weights | LOOIC_SE |    WAIC | WAIC weights |    R2 | Sigma
-------------------------------------------------------------------------------------------------------------------
cumord | brmsfit | -113.628 |   7.485 | 227.256 |         0.062 |   14.970 | 227.249 |        0.002 | 0.179 | 1.000
adjcat | brmsfit | -107.434 |   7.111 | 214.868 |         0.938 |   14.223 | 214.718 |        0.998 | 0.169 | 1.000</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb734"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># #TIDYBAYES VISUALIZATION</span>
<span class="co"># library(tidybayes)</span>
<span class="co"># adjcat %&gt;%</span>
<span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co">#   stat_halfeye()</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cumord</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-82-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb735"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">adjcat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="modelling_ref_files/figure-html/unnamed-chunk-82-5.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb736"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">adjcat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.81), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.86). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is
likely invalid for ordinal families.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.81), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.86). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'cb54d61933639a344521da987151fc46' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.000191 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.91 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1.90674 seconds (Warm-up)
Chain 1:                2.0057 seconds (Sampling)
Chain 1:                3.91244 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'cb54d61933639a344521da987151fc46' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.000121 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.21 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 1.82492 seconds (Warm-up)
Chain 2:                1.56442 seconds (Sampling)
Chain 2:                3.38934 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'cb54d61933639a344521da987151fc46' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.000124 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 1.24 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 1.80899 seconds (Warm-up)
Chain 3:                1.81941 seconds (Sampling)
Chain 3:                3.6284 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'cb54d61933639a344521da987151fc46' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.000127 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 1.27 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 1.87903 seconds (Warm-up)
Chain 4:                1.71516 seconds (Sampling)
Chain 4:                3.59419 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Possible multicollinearity between bcs_conditionimpasse[1] and b_Intercept[2] (r = 0.83), bcs_conditionimpasse[2] and bcs_conditionimpasse[1] (r = 0.87). This might lead to inappropriate results. See 'Details' in '?rope'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Predictions are treated as continuous variables in 'bayes_R2' which is likely invalid for ordinal families.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a Bayesian probit model (estimated using MCMC sampling with 4 chains of 2000 iterations and a warmup of 1000) to predict state with condition (formula: state ~ cs(condition)). Priors over parameters were set as uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), uniform (location = , scale = ), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), student_t (location = 0.00, scale = 2.50), NA (NA) and NA (NA) distributions. The model's explanatory power is moderate (R2 = 0.17, 95% CI [0.07, 0.27]).  Within this model:

  - The effect of b Intercept[1] (Median = 1.94, 95% CI [1.38, 2.80]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.004) but the indices are unreliable (ESS = 598)
  - The effect of b Intercept[2] (Median = -1.22, 95% CI [-2.29, -0.41]) has a 99.85% probability of being negative (&lt; 0), 99.85% of being significant (&lt; -0.05), and 98.90% of being large (&lt; -0.30). The estimation successfully converged (Rhat = 1.002) but the indices are unreliable (ESS = 612)
  - The effect of bcs conditionimpasse[1] (Median = 1.88, 95% CI [1.18, 2.79]) has a 100.00% probability of being positive (&gt; 0), 100.00% of being significant (&gt; 0.05), and 100.00% of being large (&gt; 0.30). The estimation successfully converged (Rhat = 1.004) but the indices are unreliable (ESS = 617)
  - The effect of bcs conditionimpasse[2] (Median = -0.99, 95% CI [-2.08, -0.14]) has a 99.12% probability of being negative (&lt; 0), 98.70% of being significant (&lt; -0.05), and 93.70% of being large (&lt; -0.30). The estimation successfully converged (Rhat = 1.003) but the indices are unreliable (ESS = 620)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.05| and |0.30|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).</code></pre>
</div>
</div>
<p><em>Converges, but estimates are unreliable?</em></p>


<!-- -->

</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../analysis/utils/scoring.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Scoring Strategy</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb746" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb746-1"><a href="#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb746-2"><a href="#cb746-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'SGCX | Modelling Reference'</span></span>
<span id="cb746-3"><a href="#cb746-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb746-4"><a href="#cb746-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-5"><a href="#cb746-5" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb746-6"><a href="#cb746-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-7"><a href="#cb746-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modelling Reference {#modelling .unnumbered}</span></span>
<span id="cb746-8"><a href="#cb746-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-9"><a href="#cb746-9" aria-hidden="true" tabindex="-1"></a>**In this notebook we use data from study SGC3A to explore different modelling techniques and assess their suitability for the bimodal accuracy distributions in the SGC project data.**</span>
<span id="cb746-10"><a href="#cb746-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-13"><a href="#cb746-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-14"><a href="#cb746-14" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb746-15"><a href="#cb746-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb746-16"><a href="#cb746-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb746-17"><a href="#cb746-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-18"><a href="#cb746-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb746-19"><a href="#cb746-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools) <span class="co">#misc helpers </span></span>
<span id="cb746-20"><a href="#cb746-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-21"><a href="#cb746-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#arrange plots</span></span>
<span id="cb746-22"><a href="#cb746-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange shift function plots</span></span>
<span id="cb746-23"><a href="#cb746-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb746-24"><a href="#cb746-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd) <span class="co">#mosaic plots</span></span>
<span id="cb746-25"><a href="#cb746-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra) <span class="co">#mosaic plots</span></span>
<span id="cb746-26"><a href="#cb746-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables </span></span>
<span id="cb746-27"><a href="#cb746-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb746-28"><a href="#cb746-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy) <span class="co">#the way it should be</span></span>
<span id="cb746-29"><a href="#cb746-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions) <span class="co">#expressions to add to plots</span></span>
<span id="cb746-30"><a href="#cb746-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with expressions</span></span>
<span id="cb746-31"><a href="#cb746-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz </span></span>
<span id="cb746-32"><a href="#cb746-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects) <span class="co">#visualization log regr models</span></span>
<span id="cb746-33"><a href="#cb746-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#tables</span></span>
<span id="cb746-34"><a href="#cb746-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy models</span></span>
<span id="cb746-35"><a href="#cb746-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed and mixture models</span></span>
<span id="cb746-36"><a href="#cb746-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-37"><a href="#cb746-37" aria-hidden="true" tabindex="-1"></a><span class="co">#misc utilities</span></span>
<span id="cb746-38"><a href="#cb746-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb746-39"><a href="#cb746-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb746-40"><a href="#cb746-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb746-41"><a href="#cb746-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb746-42"><a href="#cb746-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb746-43"><a href="#cb746-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb746-44"><a href="#cb746-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic) <span class="co">#extract model equation</span></span>
<span id="cb746-45"><a href="#cb746-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr) <span class="co">#power analyses</span></span>
<span id="cb746-46"><a href="#cb746-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-47"><a href="#cb746-47" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling</span></span>
<span id="cb746-48"><a href="#cb746-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix) <span class="co">#helpful basic stats &amp; non parametrics</span></span>
<span id="cb746-49"><a href="#cb746-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WRS2) <span class="co">#robust and nonparametric tests </span></span>
<span id="cb746-50"><a href="#cb746-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb746-51"><a href="#cb746-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr) <span class="co">#confint on qq plot</span></span>
<span id="cb746-52"><a href="#cb746-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels) <span class="co">#contingency table and CHISQR</span></span>
<span id="cb746-53"><a href="#cb746-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zeroinfl / hurdle models </span></span>
<span id="cb746-54"><a href="#cb746-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models </span></span>
<span id="cb746-55"><a href="#cb746-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal) <span class="co">#ordinal regression</span></span>
<span id="cb746-56"><a href="#cb746-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># polyr ordinal regression</span></span>
<span id="cb746-57"><a href="#cb746-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM) <span class="co">#censored, zero infl, etc</span></span>
<span id="cb746-58"><a href="#cb746-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brant) <span class="co">#brant test for ordinal regression</span></span>
<span id="cb746-59"><a href="#cb746-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression </span></span>
<span id="cb746-60"><a href="#cb746-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb746-61"><a href="#cb746-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-62"><a href="#cb746-62" aria-hidden="true" tabindex="-1"></a><span class="co">#one package to rule them all</span></span>
<span id="cb746-63"><a href="#cb746-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb746-64"><a href="#cb746-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-65"><a href="#cb746-65" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb746-66"><a href="#cb746-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb746-67"><a href="#cb746-67" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb746-68"><a href="#cb746-68" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb746-69"><a href="#cb746-69" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb746-70"><a href="#cb746-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-71"><a href="#cb746-71" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb746-72"><a href="#cb746-72" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>()) </span>
<span id="cb746-73"><a href="#cb746-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-74"><a href="#cb746-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-75"><a href="#cb746-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-78"><a href="#cb746-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-79"><a href="#cb746-79" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb746-80"><a href="#cb746-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb746-81"><a href="#cb746-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb746-82"><a href="#cb746-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-83"><a href="#cb746-83" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb746-84"><a href="#cb746-84" aria-hidden="true" tabindex="-1"></a><span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb746-85"><a href="#cb746-85" aria-hidden="true" tabindex="-1"></a><span class="co">#mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb746-86"><a href="#cb746-86" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(mbp)</span></span>
<span id="cb746-87"><a href="#cb746-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-88"><a href="#cb746-88" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb746-89"><a href="#cb746-89" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span>)</span>
<span id="cb746-90"><a href="#cb746-90" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span>)</span>
<span id="cb746-91"><a href="#cb746-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-92"><a href="#cb746-92" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb746-93"><a href="#cb746-93" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb746-94"><a href="#cb746-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_score =</span> item_test_NABS,</span>
<span id="cb746-95"><a href="#cb746-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_condition =</span> condition,</span>
<span id="cb746-96"><a href="#cb746-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> pretty_condition</span>
<span id="cb746-97"><a href="#cb746-97" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-98"><a href="#cb746-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-99"><a href="#cb746-99" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb746-100"><a href="#cb746-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb746-101"><a href="#cb746-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaled =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orth"</span>, <span class="st">"-0.5"</span><span class="ot">=</span><span class="st">"unknown"</span>,<span class="st">"0"</span><span class="ot">=</span><span class="st">"uncertain"</span>,<span class="st">"0.5"</span><span class="ot">=</span><span class="st">"lines"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"tri"</span>),</span>
<span id="cb746-102"><a href="#cb746-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaled =</span> <span class="fu">as.ordered</span>(scaled),</span>
<span id="cb746-103"><a href="#cb746-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_condition =</span> condition,</span>
<span id="cb746-104"><a href="#cb746-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> pretty_condition,</span>
<span id="cb746-105"><a href="#cb746-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb746-106"><a href="#cb746-106" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orth-like"</span>,</span>
<span id="cb746-107"><a href="#cb746-107" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"unknown"</span>,</span>
<span id="cb746-108"><a href="#cb746-108" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"unknown"</span>,</span>
<span id="cb746-109"><a href="#cb746-109" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>,</span>
<span id="cb746-110"><a href="#cb746-110" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"tri-like"</span>),</span>
<span id="cb746-111"><a href="#cb746-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">as.ordered</span>(state)</span>
<span id="cb746-112"><a href="#cb746-112" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-113"><a href="#cb746-113" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 group ordered STATE variable</span></span>
<span id="cb746-114"><a href="#cb746-114" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 group ordered SCALED variable [matches high_interpretation]</span></span>
<span id="cb746-115"><a href="#cb746-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-116"><a href="#cb746-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-117"><a href="#cb746-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-118"><a href="#cb746-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-119"><a href="#cb746-119" aria-hidden="true" tabindex="-1"></a><span class="fu"># INDEPENDENT SAMPLES</span></span>
<span id="cb746-120"><a href="#cb746-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-121"><a href="#cb746-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>test-equivalents of GLM models: https://rpubs.com/palday/glm-test</span>
<span id="cb746-122"><a href="#cb746-122" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>models as test :https://lindeloev.github.io/tests-as-linear/</span>
<span id="cb746-123"><a href="#cb746-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-124"><a href="#cb746-124" aria-hidden="true" tabindex="-1"></a><span class="fu">## CONTINUOUS OUTCOME</span></span>
<span id="cb746-125"><a href="#cb746-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-126"><a href="#cb746-126" aria-hidden="true" tabindex="-1"></a>**Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?\</span>
<span id="cb746-127"><a href="#cb746-127" aria-hidden="true" tabindex="-1"></a>(# questions correct on test phase of task, <span class="sc">\[</span>in lab<span class="sc">\]</span> participants)**</span>
<span id="cb746-128"><a href="#cb746-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-129"><a href="#cb746-129" aria-hidden="true" tabindex="-1"></a>*(Can also be transformed to proportion or percentage).*</span>
<span id="cb746-130"><a href="#cb746-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-133"><a href="#cb746-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-134"><a href="#cb746-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-IND-TESTSCORE</span></span>
<span id="cb746-135"><a href="#cb746-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb746-136"><a href="#cb746-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb746-137"><a href="#cb746-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-138"><a href="#cb746-138" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::SETUP DATA</span></span>
<span id="cb746-139"><a href="#cb746-139" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb746-140"><a href="#cb746-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-141"><a href="#cb746-141" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb746-142"><a href="#cb746-142" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb746-143"><a href="#cb746-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-144"><a href="#cb746-144" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb746-145"><a href="#cb746-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-146"><a href="#cb746-146" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | FACETED HISTOGRAM</span></span>
<span id="cb746-147"><a href="#cb746-147" aria-hidden="true" tabindex="-1"></a><span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span></span>
<span id="cb746-148"><a href="#cb746-148" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~item_test_NABS, </span></span>
<span id="cb746-149"><a href="#cb746-149" aria-hidden="true" tabindex="-1"></a><span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span></span>
<span id="cb746-150"><a href="#cb746-150" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span></span>
<span id="cb746-151"><a href="#cb746-151" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span></span>
<span id="cb746-152"><a href="#cb746-152" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "# Correct",</span></span>
<span id="cb746-153"><a href="#cb746-153" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "proportion of subjects",</span></span>
<span id="cb746-154"><a href="#cb746-154" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span></span>
<span id="cb746-155"><a href="#cb746-155" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "") + theme(legend.position = "blank")</span></span>
<span id="cb746-156"><a href="#cb746-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-157"><a href="#cb746-157" aria-hidden="true" tabindex="-1"></a><span class="do">##GGPUBR | HIST+DENSITY SCORE </span></span>
<span id="cb746-158"><a href="#cb746-158" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">gghistogram</span>(df, <span class="at">x =</span> <span class="st">"test_score"</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb746-159"><a href="#cb746-159" aria-hidden="true" tabindex="-1"></a>   <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-160"><a href="#cb746-160" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill =</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span></span>
<span id="cb746-161"><a href="#cb746-161" aria-hidden="true" tabindex="-1"></a>   <span class="at">add_density =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-162"><a href="#cb746-162" aria-hidden="true" tabindex="-1"></a><span class="fu">facet</span>(p, <span class="at">facet.by=</span><span class="fu">c</span>(<span class="st">"condition"</span>)) <span class="sc">+</span></span>
<span id="cb746-163"><a href="#cb746-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score"</span>,</span>
<span id="cb746-164"><a href="#cb746-164" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,</span>
<span id="cb746-165"><a href="#cb746-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, <span class="at">y =</span> <span class="st">"number of subjects"</span>) <span class="sc">+</span></span>
<span id="cb746-166"><a href="#cb746-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb746-167"><a href="#cb746-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-168"><a href="#cb746-168" aria-hidden="true" tabindex="-1"></a><span class="do">##VERTICAL RAINCLOUD USING GGDISTR</span></span>
<span id="cb746-169"><a href="#cb746-169" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> test_score,</span>
<span id="cb746-170"><a href="#cb746-170" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> condition) ) <span class="sc">+</span> </span>
<span id="cb746-171"><a href="#cb746-171" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb746-172"><a href="#cb746-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>,</span>
<span id="cb746-173"><a href="#cb746-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb746-174"><a href="#cb746-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>, </span>
<span id="cb746-175"><a href="#cb746-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb746-176"><a href="#cb746-176" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span> </span>
<span id="cb746-177"><a href="#cb746-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb746-178"><a href="#cb746-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb746-179"><a href="#cb746-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score),</span>
<span id="cb746-180"><a href="#cb746-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb746-181"><a href="#cb746-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb746-182"><a href="#cb746-182" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb746-183"><a href="#cb746-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb746-184"><a href="#cb746-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb746-185"><a href="#cb746-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score, <span class="at">color =</span> condition),</span>
<span id="cb746-186"><a href="#cb746-186" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.3</span>,</span>
<span id="cb746-187"><a href="#cb746-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb746-188"><a href="#cb746-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>( </span>
<span id="cb746-189"><a href="#cb746-189" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">05</span></span>
<span id="cb746-190"><a href="#cb746-190" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">labs</span>( </span>
<span id="cb746-191"><a href="#cb746-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score "</span>,</span>
<span id="cb746-192"><a href="#cb746-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>) <span class="sc">+</span></span>
<span id="cb746-193"><a href="#cb746-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) <span class="sc">+</span> </span>
<span id="cb746-194"><a href="#cb746-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>), <span class="at">clip =</span> <span class="st">"off"</span>)</span>
<span id="cb746-195"><a href="#cb746-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-196"><a href="#cb746-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-197"><a href="#cb746-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-198"><a href="#cb746-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-199"><a href="#cb746-199" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independent Samples T-Test (Student's T)</span></span>
<span id="cb746-200"><a href="#cb746-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-201"><a href="#cb746-201" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tests null hypothesis that true difference in population mean is == 0</span>
<span id="cb746-202"><a href="#cb746-202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed variables</span>
<span id="cb746-203"><a href="#cb746-203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes equal variance of samples (homogeneity of variance)</span>
<span id="cb746-204"><a href="#cb746-204" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**SGC accuracy data violate both homogeneity and normality**<span class="sc">\*</span></span>
<span id="cb746-205"><a href="#cb746-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-208"><a href="#cb746-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-209"><a href="#cb746-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: STUDENTS-T</span></span>
<span id="cb746-210"><a href="#cb746-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-211"><a href="#cb746-211" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>( test_score <span class="sc">~</span> condition,<span class="at">data =</span> df,</span>
<span id="cb746-212"><a href="#cb746-212" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))) <span class="co"># less, greater for one sided tests</span></span>
<span id="cb746-213"><a href="#cb746-213" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span>
<span id="cb746-214"><a href="#cb746-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-215"><a href="#cb746-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-216"><a href="#cb746-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-219"><a href="#cb746-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-220"><a href="#cb746-220" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb746-221"><a href="#cb746-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-222"><a href="#cb746-222" aria-hidden="true" tabindex="-1"></a><span class="co">#one tailed tests must be done manually by extracting results expression and adding as subtitle</span></span>
<span id="cb746-223"><a href="#cb746-223" aria-hidden="true" tabindex="-1"></a><span class="co">#default is two tailed test</span></span>
<span id="cb746-224"><a href="#cb746-224" aria-hidden="true" tabindex="-1"></a><span class="co"># results &lt;- two_sample_test( data = df, x = pretty_condition, </span></span>
<span id="cb746-225"><a href="#cb746-225" aria-hidden="true" tabindex="-1"></a><span class="co">#                             y = item_test_NABS,</span></span>
<span id="cb746-226"><a href="#cb746-226" aria-hidden="true" tabindex="-1"></a><span class="co">#                             alternative = "g")</span></span>
<span id="cb746-227"><a href="#cb746-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-228"><a href="#cb746-228" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb746-229"><a href="#cb746-229" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"parametric"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-230"><a href="#cb746-230" aria-hidden="true" tabindex="-1"></a>               <span class="at">alternative  =</span> <span class="st">"g"</span>,</span>
<span id="cb746-231"><a href="#cb746-231" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, ) </span>
<span id="cb746-232"><a href="#cb746-232" aria-hidden="true" tabindex="-1"></a><span class="co"># + labs(subtitle = results$expression[[1]])</span></span>
<span id="cb746-233"><a href="#cb746-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-234"><a href="#cb746-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-235"><a href="#cb746-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-236"><a href="#cb746-236" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independent Samples T-Test (Welch's T)</span></span>
<span id="cb746-237"><a href="#cb746-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-238"><a href="#cb746-238" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tests null hypothesis that true difference in population mean is == 0</span>
<span id="cb746-239"><a href="#cb746-239" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed variables</span>
<span id="cb746-240"><a href="#cb746-240" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Does not** assumes equal variance of samples (homogeneity of variance)</span>
<span id="cb746-241"><a href="#cb746-241" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>***SGC accuracy data violates normality assumption***</span>
<span id="cb746-242"><a href="#cb746-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-245"><a href="#cb746-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-246"><a href="#cb746-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: WELCHES-T</span></span>
<span id="cb746-247"><a href="#cb746-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-248"><a href="#cb746-248" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">t.test</span>( test_score <span class="sc">~</span> condition,<span class="at">data =</span> df,</span>
<span id="cb746-249"><a href="#cb746-249" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>))</span>
<span id="cb746-250"><a href="#cb746-250" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span>
<span id="cb746-251"><a href="#cb746-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-252"><a href="#cb746-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-253"><a href="#cb746-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-256"><a href="#cb746-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-257"><a href="#cb746-257" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb746-258"><a href="#cb746-258" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb746-259"><a href="#cb746-259" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"parametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb746-260"><a href="#cb746-260" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb746-261"><a href="#cb746-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-262"><a href="#cb746-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-263"><a href="#cb746-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-264"><a href="#cb746-264" aria-hidden="true" tabindex="-1"></a><span class="fu">### Yuen's T-Test (Trimmed Means)</span></span>
<span id="cb746-265"><a href="#cb746-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-266"><a href="#cb746-266" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Robust alternative to** to t-test is Yuen's t-test which uses trimmed means</span>
<span id="cb746-267"><a href="#cb746-267" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Trimmed means are not desireable for this research scenario because they trim data from the extremes, and in this study these are true, interesting values</span>
<span id="cb746-268"><a href="#cb746-268" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://garstats.wordpress.com/2017/11/28/trimmed-means/&gt;</span></span>
<span id="cb746-269"><a href="#cb746-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-272"><a href="#cb746-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-273"><a href="#cb746-273" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: YUENS-T</span></span>
<span id="cb746-274"><a href="#cb746-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-275"><a href="#cb746-275" aria-hidden="true" tabindex="-1"></a>(y <span class="ot">&lt;-</span> <span class="fu">yuenbt</span>( <span class="at">formula =</span> test_score <span class="sc">~</span> condition, <span class="at">data =</span> df,</span>
<span id="cb746-276"><a href="#cb746-276" aria-hidden="true" tabindex="-1"></a>              <span class="at">side =</span> <span class="cn">TRUE</span>, <span class="at">EQVAR =</span> <span class="cn">FALSE</span>))</span>
<span id="cb746-277"><a href="#cb746-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-278"><a href="#cb746-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-279"><a href="#cb746-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-282"><a href="#cb746-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-283"><a href="#cb746-283" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb746-284"><a href="#cb746-284" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb746-285"><a href="#cb746-285" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"robust"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb746-286"><a href="#cb746-286" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb746-287"><a href="#cb746-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-288"><a href="#cb746-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-289"><a href="#cb746-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-290"><a href="#cb746-290" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wilcoxon Rank Sum (Mann-Whitney Test)</span></span>
<span id="cb746-291"><a href="#cb746-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-292"><a href="#cb746-292" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Non parametric alternative** to t-test; compares median rather than mean by ranking data</span>
<span id="cb746-293"><a href="#cb746-293" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume normality</span>
<span id="cb746-294"><a href="#cb746-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume equal variance of samples (homogeneity of variance)</span>
<span id="cb746-295"><a href="#cb746-295" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Appropriate for SGC accuracy data**</span>
<span id="cb746-296"><a href="#cb746-296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/#two-sample-wilcoxon-test</span>
<span id="cb746-297"><a href="#cb746-297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://data.library.virginia.edu/the-wilcoxon-rank-sum-test/</span>
<span id="cb746-298"><a href="#cb746-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-301"><a href="#cb746-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-302"><a href="#cb746-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: WILCOXON RANK SUM</span></span>
<span id="cb746-303"><a href="#cb746-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-304"><a href="#cb746-304" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df<span class="sc">$</span>test_score <span class="sc">~</span> df<span class="sc">$</span>condition,</span>
<span id="cb746-305"><a href="#cb746-305" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)) <span class="co">#less, greater</span></span>
<span id="cb746-306"><a href="#cb746-306" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(w)</span>
<span id="cb746-307"><a href="#cb746-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-308"><a href="#cb746-308" aria-hidden="true" tabindex="-1"></a><span class="co">#effect size</span></span>
<span id="cb746-309"><a href="#cb746-309" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">wilcox_effsize</span>(test_score <span class="sc">~</span> condition)</span>
<span id="cb746-310"><a href="#cb746-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-311"><a href="#cb746-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-312"><a href="#cb746-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-315"><a href="#cb746-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-316"><a href="#cb746-316" aria-hidden="true" tabindex="-1"></a><span class="co">#STATSPLOT | VIOLIN</span></span>
<span id="cb746-317"><a href="#cb746-317" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">y =</span> test_score, <span class="at">x =</span> condition, <span class="at">data =</span> df,</span>
<span id="cb746-318"><a href="#cb746-318" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb746-319"><a href="#cb746-319" aria-hidden="true" tabindex="-1"></a>               <span class="at">pairwide.display =</span> <span class="st">"significant"</span>, )</span>
<span id="cb746-320"><a href="#cb746-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-321"><a href="#cb746-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-322"><a href="#cb746-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-323"><a href="#cb746-323" aria-hidden="true" tabindex="-1"></a><span class="fu">### Floor/Ceiling Corrections + Wilcoxon Rank Sum</span></span>
<span id="cb746-324"><a href="#cb746-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-325"><a href="#cb746-325" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The bimodal distribution of the subject-level score data do not meet the requirements for t-tests.</span>
<span id="cb746-326"><a href="#cb746-326" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>However, a non-parametric alternative is available (Wilcoxon rank sum test / Man-Whitney test)</span>
<span id="cb746-327"><a href="#cb746-327" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Additional corrections are available for data with 'floor' and/or 'ceiling' effects via the 'DACR' package</span>
<span id="cb746-328"><a href="#cb746-328" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14 see also https://qmliu.shinyapps.io/DACFE/</span>
<span id="cb746-329"><a href="#cb746-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-330"><a href="#cb746-330" aria-hidden="true" tabindex="-1"></a>For comparison we run a standard followed by a Wilcoxon rank-sum (Mann-Whitney) test that is a nonparametric alternative for non-normally distributed data.</span>
<span id="cb746-331"><a href="#cb746-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-334"><a href="#cb746-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-335"><a href="#cb746-335" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df<span class="sc">$</span>test_score <span class="sc">~</span> df<span class="sc">$</span>condition))</span>
<span id="cb746-336"><a href="#cb746-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-337"><a href="#cb746-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-338"><a href="#cb746-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-339"><a href="#cb746-339" aria-hidden="true" tabindex="-1"></a>Next, we calculate the t-test and ANOVA (F-test) based on a series of corrections provided for data with floor and/or ceiling effects.</span>
<span id="cb746-340"><a href="#cb746-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-341"><a href="#cb746-341" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14&gt;</span></span>
<span id="cb746-342"><a href="#cb746-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-343"><a href="#cb746-343" aria-hidden="true" tabindex="-1"></a>Using properties from truncated normal distributions, the authors propose an easy-to-use method for the *t*-test and ANOVA with ceiling/floor data.</span>
<span id="cb746-344"><a href="#cb746-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-345"><a href="#cb746-345" aria-hidden="true" tabindex="-1"></a>*The proposed method calculates the degrees of freedom based on the after-truncation sample sizes (where l = number of floor observations, and r = number of ceiling observations). The rationale was that the proposed method utilizes full information only from data points of n − r − l participants and partial information from data points of r + l participants of a group for the mean and variance estimation. Specifically, the corrected mean and variance estimates (Eqs. 14 and 15) are functions of mean and variance estimates using after-truncation data (n − r − l participants) and the standardized floor and ceiling threshold estimates. The thresholds are estimated using the ceiling and floor percentage estimates based on data points of n − r and n − l participants, respectively. This is a relatively conservative approach for calculating the degrees of freedom, which can help control the type I error rate. This feature can be beneficial, especially given the "replication crisis" in psychological and behavioral research.*</span>
<span id="cb746-346"><a href="#cb746-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-349"><a href="#cb746-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-350"><a href="#cb746-350" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED T TESTS</span></span>
<span id="cb746-351"><a href="#cb746-351" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DACF) <span class="co">#tests for data with floor and ceiling </span></span>
<span id="cb746-352"><a href="#cb746-352" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.rdocumentation.org/packages/DACF/versions/1.0.0</span></span>
<span id="cb746-353"><a href="#cb746-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-354"><a href="#cb746-354" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare data [vector of scores for each group]</span></span>
<span id="cb746-355"><a href="#cb746-355" aria-hidden="true" tabindex="-1"></a>score_111 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test_score) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb746-356"><a href="#cb746-356" aria-hidden="true" tabindex="-1"></a>score_121 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"impasse"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test_score) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb746-357"><a href="#cb746-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-358"><a href="#cb746-358" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb746-359"><a href="#cb746-359" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_111) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb746-360"><a href="#cb746-360" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb746-361"><a href="#cb746-361" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_121) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb746-362"><a href="#cb746-362" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(<span class="st">"control"</span><span class="ot">=</span>a ,<span class="st">"impasse"</span><span class="ot">=</span>b))</span>
<span id="cb746-363"><a href="#cb746-363" aria-hidden="true" tabindex="-1"></a>r</span>
<span id="cb746-364"><a href="#cb746-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-365"><a href="#cb746-365" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb746-366"><a href="#cb746-366" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb746-367"><a href="#cb746-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-368"><a href="#cb746-368" aria-hidden="true" tabindex="-1"></a><span class="co"># perform adjusted t test</span></span>
<span id="cb746-369"><a href="#cb746-369" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.t.test</span>(score_111,score_121,<span class="st">"b"</span>)</span>
<span id="cb746-370"><a href="#cb746-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-371"><a href="#cb746-371" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED F* </span><span class="al">TEST</span><span class="co"> ANOVA</span></span>
<span id="cb746-372"><a href="#cb746-372" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.f.star</span>(df,test_score<span class="sc">~</span>condition,<span class="st">"b"</span>)</span>
<span id="cb746-373"><a href="#cb746-373" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb746-374"><a href="#cb746-374" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb746-375"><a href="#cb746-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-376"><a href="#cb746-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-377"><a href="#cb746-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-378"><a href="#cb746-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-379"><a href="#cb746-379" aria-hidden="true" tabindex="-1"></a>*The control condition has 11% of data at ceiling and 71% at floor, with corrected mean of -7 and variance of 207. The impasse condition has 17% at ceiling, and only 42% at floor, with with corrected mean of 2.39 and variance respectively as of 58.*</span>
<span id="cb746-380"><a href="#cb746-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-381"><a href="#cb746-381" aria-hidden="true" tabindex="-1"></a>*A corrected t-test t statistic is -4.94, p = 0.05. The estimated Cohen's d is -0.89 with a confidence interval 0f \[-14.22, -5.97\].*</span>
<span id="cb746-382"><a href="#cb746-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-383"><a href="#cb746-383" aria-hidden="true" tabindex="-1"></a>*A correct F-test (ANOVA) has a corrected F-statstic of 5.85, p \&lt; 0.05, and Fsquared effect size of 0.195*</span>
<span id="cb746-384"><a href="#cb746-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-385"><a href="#cb746-385" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Regression</span></span>
<span id="cb746-386"><a href="#cb746-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-387"><a href="#cb746-387" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes homogeneity of variance</span>
<span id="cb746-388"><a href="#cb746-388" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumes normally distributed residuals</span>
<span id="cb746-389"><a href="#cb746-389" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>when default dummy coding is used;</span>
<span id="cb746-390"><a href="#cb746-390" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>intercept = predicted mean of first group,</span>
<span id="cb746-391"><a href="#cb746-391" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>predictor coefficient = difference to mean of second group</span>
<span id="cb746-392"><a href="#cb746-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-395"><a href="#cb746-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-396"><a href="#cb746-396" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION</span></span>
<span id="cb746-397"><a href="#cb746-397" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb746-398"><a href="#cb746-398" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb746-399"><a href="#cb746-399" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm<span class="fl">.1</span>)</span>
<span id="cb746-400"><a href="#cb746-400" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb746-401"><a href="#cb746-401" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span>
<span id="cb746-402"><a href="#cb746-402" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb746-403"><a href="#cb746-403" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm<span class="fl">.1</span>)</span>
<span id="cb746-404"><a href="#cb746-404" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(lm<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb746-405"><a href="#cb746-405" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm<span class="fl">.1</span>)</span>
<span id="cb746-406"><a href="#cb746-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-407"><a href="#cb746-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-410"><a href="#cb746-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-411"><a href="#cb746-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PLOT-MODEL-COEFSS-GGDIST</span></span>
<span id="cb746-412"><a href="#cb746-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-413"><a href="#cb746-413" aria-hidden="true" tabindex="-1"></a><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span></span>
<span id="cb746-414"><a href="#cb746-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-415"><a href="#cb746-415" aria-hidden="true" tabindex="-1"></a><span class="co">#setup references</span></span>
<span id="cb746-416"><a href="#cb746-416" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> lm<span class="fl">.1</span></span>
<span id="cb746-417"><a href="#cb746-417" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df</span>
<span id="cb746-418"><a href="#cb746-418" aria-hidden="true" tabindex="-1"></a>call <span class="ot">&lt;-</span> m<span class="sc">$</span>call <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()</span>
<span id="cb746-419"><a href="#cb746-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-420"><a href="#cb746-420" aria-hidden="true" tabindex="-1"></a><span class="co"># uncertainty model visualization</span></span>
<span id="cb746-421"><a href="#cb746-421" aria-hidden="true" tabindex="-1"></a>df  <span class="sc">%&gt;%</span></span>
<span id="cb746-422"><a href="#cb746-422" aria-hidden="true" tabindex="-1"></a>  modelr<span class="sc">::</span><span class="fu">data_grid</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb746-423"><a href="#cb746-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(lm<span class="fl">.1</span>, <span class="at">newdata =</span> ., <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb746-424"><a href="#cb746-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> condition, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb746-425"><a href="#cb746-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>( <span class="at">scale =</span> .<span class="dv">5</span>,</span>
<span id="cb746-426"><a href="#cb746-426" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb746-427"><a href="#cb746-427" aria-hidden="true" tabindex="-1"></a>        <span class="at">xdist =</span> <span class="fu">dist_student_t</span>(<span class="at">df =</span> <span class="fu">df.residual</span>(m), <span class="at">mu =</span> .fitted, <span class="at">sigma =</span> .se.fit),</span>
<span id="cb746-428"><a href="#cb746-428" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">stat</span>(<span class="fu">cut_cdf_qi</span>(cdf,</span>
<span id="cb746-429"><a href="#cb746-429" aria-hidden="true" tabindex="-1"></a>                <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">95</span>),</span>
<span id="cb746-430"><a href="#cb746-430" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())))) <span class="sc">+</span></span>
<span id="cb746-431"><a href="#cb746-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-432"><a href="#cb746-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"(LAB) Test Phase Accuracy ~ Condition"</span>,</span>
<span id="cb746-433"><a href="#cb746-433" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"model predicted mean (% correct)"</span>, <span class="at">y =</span> <span class="st">"Condition"</span>, <span class="at">fill =</span> <span class="st">"Interval"</span>,</span>
<span id="cb746-434"><a href="#cb746-434" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"lm("</span>,call[<span class="dv">2</span>],<span class="st">")"</span>)</span>
<span id="cb746-435"><a href="#cb746-435" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb746-436"><a href="#cb746-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-437"><a href="#cb746-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-438"><a href="#cb746-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-441"><a href="#cb746-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-442"><a href="#cb746-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PLOT-MODEL-PRED-SJPLOT</span></span>
<span id="cb746-443"><a href="#cb746-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-444"><a href="#cb746-444" aria-hidden="true" tabindex="-1"></a><span class="co">#sjPlot</span></span>
<span id="cb746-445"><a href="#cb746-445" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(lm<span class="fl">.1</span>,  <span class="at">type =</span> <span class="st">"eff"</span>, </span>
<span id="cb746-446"><a href="#cb746-446" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.data =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-447"><a href="#cb746-447" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p =</span> <span class="cn">TRUE</span>) </span>
<span id="cb746-448"><a href="#cb746-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-449"><a href="#cb746-449" aria-hidden="true" tabindex="-1"></a><span class="co">#BS TO MANUALLY ADD REGRESSION FORMULA AS SUBTITLE </span></span>
<span id="cb746-450"><a href="#cb746-450" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic)</span></span>
<span id="cb746-451"><a href="#cb746-451" aria-hidden="true" tabindex="-1"></a><span class="co"># library(latex2exp)</span></span>
<span id="cb746-452"><a href="#cb746-452" aria-hidden="true" tabindex="-1"></a><span class="co"># (x &lt;- extract_eq(lm.1, use_coefs = TRUE, ital_vars=TRUE, coef_digits = 1, raw_tex = FALSE))</span></span>
<span id="cb746-453"><a href="#cb746-453" aria-hidden="true" tabindex="-1"></a><span class="co"># b = TeX(x)</span></span>
<span id="cb746-454"><a href="#cb746-454" aria-hidden="true" tabindex="-1"></a><span class="co"># p1[["condition"]][["labels"]][["subtitle"]]= expression( paste(widehat(accuracy), " = ", 1.7, " + ", "1.6", "*", condition[impasse]) )</span></span>
<span id="cb746-455"><a href="#cb746-455" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb746-456"><a href="#cb746-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-457"><a href="#cb746-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-458"><a href="#cb746-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-459"><a href="#cb746-459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Censored (Tobit) Regression</span></span>
<span id="cb746-460"><a href="#cb746-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-461"><a href="#cb746-461" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/tobit-models/&gt;</span></span>
<span id="cb746-462"><a href="#cb746-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-463"><a href="#cb746-463" aria-hidden="true" tabindex="-1"></a>**For censored data (i.e. truncated axis).** The tobit model, also called a censored regression model, is designed to estimate linear relationships between variables when there is either left- or right-censoring in the dependent variable (also known as censoring from below and above, respectively). Censoring from above takes place when cases with a value at or above some threshold, all take on the value of that threshold, so that the true value might be equal to the threshold, but it might also be higher. In the case of censoring from below, values those that fall at or below some threshold are censored.</span>
<span id="cb746-464"><a href="#cb746-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-465"><a href="#cb746-465" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>censored vs truncated : There is sometimes confusion about the difference between truncated data and censored data.</span>
<span id="cb746-466"><a href="#cb746-466" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With censored variables, all of the observations are in the dataset, but we don't know the "true" values of some of them.</span>
<span id="cb746-467"><a href="#cb746-467" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With truncation some of the observations are not included in the analysis because of the value of the variable.</span>
<span id="cb746-468"><a href="#cb746-468" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When a variable is censored, regression models for truncated data provide inconsistent estimates of the parameters. See Long (1997, chapter 7) for a more detailed discussion of problems of using regression models for truncated data to analyze censored data.</span>
<span id="cb746-469"><a href="#cb746-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-472"><a href="#cb746-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-473"><a href="#cb746-473" aria-hidden="true" tabindex="-1"></a><span class="co">#set censoring values </span></span>
<span id="cb746-474"><a href="#cb746-474" aria-hidden="true" tabindex="-1"></a>lo <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb746-475"><a href="#cb746-475" aria-hidden="true" tabindex="-1"></a>hi <span class="ot">=</span> <span class="dv">8</span> </span>
<span id="cb746-476"><a href="#cb746-476" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(df<span class="sc">$</span>test_score)</span>
<span id="cb746-477"><a href="#cb746-477" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Lo and Hi should equate to upper and lower bounds of the # Qs "</span>)</span>
<span id="cb746-478"><a href="#cb746-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-479"><a href="#cb746-479" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb746-480"><a href="#cb746-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-481"><a href="#cb746-481" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb746-482"><a href="#cb746-482" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span> <span class="fu">vglm</span>(test_score <span class="sc">~</span> condition, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span>hi ), <span class="at">data =</span> df)</span>
<span id="cb746-483"><a href="#cb746-483" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb746-484"><a href="#cb746-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-485"><a href="#cb746-485" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb746-486"><a href="#cb746-486" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb746-487"><a href="#cb746-487" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m1)))</span>
<span id="cb746-488"><a href="#cb746-488" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb746-489"><a href="#cb746-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-490"><a href="#cb746-490" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb746-491"><a href="#cb746-491" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb746-492"><a href="#cb746-492" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(test_score <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span> hi), <span class="at">data =</span> df)</span>
<span id="cb746-493"><a href="#cb746-493" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(m1) <span class="sc">-</span> <span class="fu">logLik</span>(m0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb746-494"><a href="#cb746-494" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb746-495"><a href="#cb746-495" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m0,m1)</span>
<span id="cb746-496"><a href="#cb746-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-497"><a href="#cb746-497" aria-hidden="true" tabindex="-1"></a><span class="co">#DIAGNOSTICS</span></span>
<span id="cb746-498"><a href="#cb746-498" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1)</span>
<span id="cb746-499"><a href="#cb746-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-500"><a href="#cb746-500" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m1)[,<span class="dv">1</span>]</span>
<span id="cb746-501"><a href="#cb746-501" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rr <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb746-502"><a href="#cb746-502" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rp <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"pearson"</span>)[,<span class="dv">1</span>]</span>
<span id="cb746-503"><a href="#cb746-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-504"><a href="#cb746-504" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb746-505"><a href="#cb746-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-506"><a href="#cb746-506" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df, {</span>
<span id="cb746-507"><a href="#cb746-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rr, <span class="at">main =</span> <span class="st">"Fitted vs Residuals"</span>)</span>
<span id="cb746-508"><a href="#cb746-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rr)</span>
<span id="cb746-509"><a href="#cb746-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rp, <span class="at">main =</span> <span class="st">"Fitted vs Pearson Residuals"</span>)</span>
<span id="cb746-510"><a href="#cb746-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rp)</span>
<span id="cb746-511"><a href="#cb746-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_score, rp, <span class="at">main =</span> <span class="st">"Actual vs Pearson Residuals"</span>)</span>
<span id="cb746-512"><a href="#cb746-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_score, yhat, <span class="at">main =</span> <span class="st">"Actual vs Fitted"</span>)</span>
<span id="cb746-513"><a href="#cb746-513" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb746-514"><a href="#cb746-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-515"><a href="#cb746-515" aria-hidden="true" tabindex="-1"></a><span class="co">#VARIANCE ACCOUNTED FOR</span></span>
<span id="cb746-516"><a href="#cb746-516" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"VARIANCE ACCOUNTED FOR"</span>)</span>
<span id="cb746-517"><a href="#cb746-517" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation</span></span>
<span id="cb746-518"><a href="#cb746-518" aria-hidden="true" tabindex="-1"></a>(r <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">cor</span>(yhat, test_score)))</span>
<span id="cb746-519"><a href="#cb746-519" aria-hidden="true" tabindex="-1"></a><span class="co"># variance accounted for</span></span>
<span id="cb746-520"><a href="#cb746-520" aria-hidden="true" tabindex="-1"></a>r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb746-521"><a href="#cb746-521" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb746-522"><a href="#cb746-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-523"><a href="#cb746-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-524"><a href="#cb746-524" aria-hidden="true" tabindex="-1"></a><span class="co">#NOTE: censReg package also does Tobit regression [including mixed models]</span></span>
<span id="cb746-525"><a href="#cb746-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-526"><a href="#cb746-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-527"><a href="#cb746-527" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient labeled "(Intercept):1" is the intercept or constant for the model.</span>
<span id="cb746-528"><a href="#cb746-528" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient labeled "(Intercept):2" is an ancillary statistic. If we exponentiate this value, we get a statistic that is analogous to the square root of the residual variance in OLS regression. logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</span>
<span id="cb746-529"><a href="#cb746-529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The predicted value of test_phase_score is 5.75 points *higher* for students in the impasse condition than for students in the control condition. (72% improvement in score!)</span>
<span id="cb746-530"><a href="#cb746-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-531"><a href="#cb746-531" aria-hidden="true" tabindex="-1"></a>**Using censReg package** - https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf</span>
<span id="cb746-532"><a href="#cb746-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-535"><a href="#cb746-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-536"><a href="#cb746-536" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censReg) <span class="co">#censored regression</span></span>
<span id="cb746-537"><a href="#cb746-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-538"><a href="#cb746-538" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb746-539"><a href="#cb746-539" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( test_score <span class="sc">~</span> condition, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb746-540"><a href="#cb746-540" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(c1)</span>
<span id="cb746-541"><a href="#cb746-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-542"><a href="#cb746-542" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb746-543"><a href="#cb746-543" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(c1)</span>
<span id="cb746-544"><a href="#cb746-544" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(c1)))</span>
<span id="cb746-545"><a href="#cb746-545" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb746-546"><a href="#cb746-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-547"><a href="#cb746-547" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb746-548"><a href="#cb746-548" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb746-549"><a href="#cb746-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-550"><a href="#cb746-550" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( test_score <span class="sc">~</span> <span class="dv">1</span>, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb746-551"><a href="#cb746-551" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(c1) <span class="sc">-</span> <span class="fu">logLik</span>(c0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb746-552"><a href="#cb746-552" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb746-553"><a href="#cb746-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-554"><a href="#cb746-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-555"><a href="#cb746-555" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(c1)</span>
<span id="cb746-556"><a href="#cb746-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-557"><a href="#cb746-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-558"><a href="#cb746-558" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</span>
<span id="cb746-559"><a href="#cb746-559" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>output should match that of VGAM</span>
<span id="cb746-560"><a href="#cb746-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-561"><a href="#cb746-561" aria-hidden="true" tabindex="-1"></a><span class="fu">## COUNT OUTCOME</span></span>
<span id="cb746-562"><a href="#cb746-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-563"><a href="#cb746-563" aria-hidden="true" tabindex="-1"></a>**Does CONDITION have an effect on TEST PHASE ABSOLUTE SCORE?\</span>
<span id="cb746-564"><a href="#cb746-564" aria-hidden="true" tabindex="-1"></a>(# questions correct on test phase of task, <span class="sc">\[</span>in lab<span class="sc">\]</span> participants)**</span>
<span id="cb746-565"><a href="#cb746-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-566"><a href="#cb746-566" aria-hidden="true" tabindex="-1"></a>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can try considering it a type of *count*, (i.e. count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function). Note that the process of answering questions on a test do not seem to strictly match the assumptions of a Poisson process.</span>
<span id="cb746-567"><a href="#cb746-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-570"><a href="#cb746-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-571"><a href="#cb746-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-COUNT-TESTSCORE</span></span>
<span id="cb746-572"><a href="#cb746-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb746-573"><a href="#cb746-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb746-574"><a href="#cb746-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-575"><a href="#cb746-575" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::SETUP DATA</span></span>
<span id="cb746-576"><a href="#cb746-576" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb746-577"><a href="#cb746-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-578"><a href="#cb746-578" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb746-579"><a href="#cb746-579" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb746-580"><a href="#cb746-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-581"><a href="#cb746-581" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb746-582"><a href="#cb746-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-583"><a href="#cb746-583" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | FACETED HISTOGRAM</span></span>
<span id="cb746-584"><a href="#cb746-584" aria-hidden="true" tabindex="-1"></a><span class="co"># stats = df %&gt;% group_by(pretty_condition) %&gt;% dplyr::summarise(mean = mean(item_test_NABS))</span></span>
<span id="cb746-585"><a href="#cb746-585" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~item_test_NABS, </span></span>
<span id="cb746-586"><a href="#cb746-586" aria-hidden="true" tabindex="-1"></a><span class="co">#          fill = ~pretty_condition, data = df) %&gt;% </span></span>
<span id="cb746-587"><a href="#cb746-587" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_condition) %&gt;% </span></span>
<span id="cb746-588"><a href="#cb746-588" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_vline(data = stats, xintercept = ~mean, color = "red") +</span></span>
<span id="cb746-589"><a href="#cb746-589" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "# Correct",</span></span>
<span id="cb746-590"><a href="#cb746-590" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "proportion of subjects",</span></span>
<span id="cb746-591"><a href="#cb746-591" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Test Phase Absolute Score (# Correct)",</span></span>
<span id="cb746-592"><a href="#cb746-592" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "") + theme(legend.position = "blank")</span></span>
<span id="cb746-593"><a href="#cb746-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-594"><a href="#cb746-594" aria-hidden="true" tabindex="-1"></a><span class="do">##GGPUBR | HIST+DENSITY SCORE </span></span>
<span id="cb746-595"><a href="#cb746-595" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">gghistogram</span>(df, <span class="at">x =</span> <span class="st">"test_score"</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb746-596"><a href="#cb746-596" aria-hidden="true" tabindex="-1"></a>   <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-597"><a href="#cb746-597" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill =</span> <span class="st">"pretty_condition"</span>, <span class="co">#, palette = c("#00AFBB", "#E7B800"),</span></span>
<span id="cb746-598"><a href="#cb746-598" aria-hidden="true" tabindex="-1"></a>   <span class="at">add_density =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-599"><a href="#cb746-599" aria-hidden="true" tabindex="-1"></a><span class="fu">facet</span>(p, <span class="at">facet.by=</span><span class="fu">c</span>(<span class="st">"condition"</span>)) <span class="sc">+</span></span>
<span id="cb746-600"><a href="#cb746-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score"</span>,</span>
<span id="cb746-601"><a href="#cb746-601" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span><span class="st">"Pattern of response is similar across data collection modes but differs by condition"</span>,</span>
<span id="cb746-602"><a href="#cb746-602" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>, <span class="at">y =</span> <span class="st">"number of subjects"</span>) <span class="sc">+</span></span>
<span id="cb746-603"><a href="#cb746-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb746-604"><a href="#cb746-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-605"><a href="#cb746-605" aria-hidden="true" tabindex="-1"></a><span class="do">##VERTICAL RAINCLOUD USING GGDISTR</span></span>
<span id="cb746-606"><a href="#cb746-606" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> test_score,</span>
<span id="cb746-607"><a href="#cb746-607" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> condition) ) <span class="sc">+</span> </span>
<span id="cb746-608"><a href="#cb746-608" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb746-609"><a href="#cb746-609" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>,</span>
<span id="cb746-610"><a href="#cb746-610" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb746-611"><a href="#cb746-611" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>, </span>
<span id="cb746-612"><a href="#cb746-612" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb746-613"><a href="#cb746-613" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span> </span>
<span id="cb746-614"><a href="#cb746-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb746-615"><a href="#cb746-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb746-616"><a href="#cb746-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score),</span>
<span id="cb746-617"><a href="#cb746-617" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb746-618"><a href="#cb746-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb746-619"><a href="#cb746-619" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb746-620"><a href="#cb746-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb746-621"><a href="#cb746-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="co">#supress fill</span></span>
<span id="cb746-622"><a href="#cb746-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y =</span> test_score, <span class="at">color =</span> condition),</span>
<span id="cb746-623"><a href="#cb746-623" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.3</span>,</span>
<span id="cb746-624"><a href="#cb746-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb746-625"><a href="#cb746-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>( </span>
<span id="cb746-626"><a href="#cb746-626" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">05</span></span>
<span id="cb746-627"><a href="#cb746-627" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> <span class="fu">labs</span>( </span>
<span id="cb746-628"><a href="#cb746-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of TEST Absolute Score "</span>,</span>
<span id="cb746-629"><a href="#cb746-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Total Absolute Score (Test Phase)"</span>) <span class="sc">+</span></span>
<span id="cb746-630"><a href="#cb746-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>) <span class="sc">+</span> </span>
<span id="cb746-631"><a href="#cb746-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>), <span class="at">clip =</span> <span class="st">"off"</span>)</span>
<span id="cb746-632"><a href="#cb746-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-633"><a href="#cb746-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-634"><a href="#cb746-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-635"><a href="#cb746-635" aria-hidden="true" tabindex="-1"></a><span class="fu">### Poisson Regression</span></span>
<span id="cb746-636"><a href="#cb746-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-637"><a href="#cb746-637" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/poisson-regression/&gt;</span>\</span>
<span id="cb746-638"><a href="#cb746-638" aria-hidden="true" tabindex="-1"></a>*General Linear model using the Poisson distribution*</span>
<span id="cb746-639"><a href="#cb746-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-642"><a href="#cb746-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-643"><a href="#cb746-643" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span></span>
<span id="cb746-644"><a href="#cb746-644" aria-hidden="true" tabindex="-1"></a>p<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb746-645"><a href="#cb746-645" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb746-646"><a href="#cb746-646" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(p<span class="fl">.1</span>)</span>
<span id="cb746-647"><a href="#cb746-647" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb746-648"><a href="#cb746-648" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(p<span class="fl">.1</span>)</span>
<span id="cb746-649"><a href="#cb746-649" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb746-650"><a href="#cb746-650" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(p<span class="fl">.1</span>)</span>
<span id="cb746-651"><a href="#cb746-651" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(p<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb746-652"><a href="#cb746-652" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(p<span class="fl">.1</span>)</span>
<span id="cb746-653"><a href="#cb746-653" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(p<span class="fl">.1</span>)</span>
<span id="cb746-654"><a href="#cb746-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-655"><a href="#cb746-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-656"><a href="#cb746-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-657"><a href="#cb746-657" aria-hidden="true" tabindex="-1"></a>*The variable condition has a coefficient of 0.67, (p \&lt; 0.005). This means that for the impasse condition, the expected log count \# of questions increases by 0.67. By exponentiating the estimate we see that \# question correct rate for the impasse condition is 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.*</span>
<span id="cb746-658"><a href="#cb746-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-659"><a href="#cb746-659" aria-hidden="true" tabindex="-1"></a><span class="fu">### Negative Binomial Regression</span></span>
<span id="cb746-660"><a href="#cb746-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-661"><a href="#cb746-661" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/&gt;</span> -*overdispersed count data (variance much greater than mean)*</span>
<span id="cb746-662"><a href="#cb746-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-663"><a href="#cb746-663" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>similar to Poisson regression, but using the negative binomial distribution, which can better account for 'overdispersed' data where variance is much greater than the mean</span>
<span id="cb746-664"><a href="#cb746-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-667"><a href="#cb746-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-668"><a href="#cb746-668" aria-hidden="true" tabindex="-1"></a><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span></span>
<span id="cb746-669"><a href="#cb746-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-670"><a href="#cb746-670" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb746-671"><a href="#cb746-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-672"><a href="#cb746-672" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model </span></span>
<span id="cb746-673"><a href="#cb746-673" aria-hidden="true" tabindex="-1"></a>nb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(test_score <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb746-674"><a href="#cb746-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-675"><a href="#cb746-675" aria-hidden="true" tabindex="-1"></a><span class="co">#check overdispersion need </span></span>
<span id="cb746-676"><a href="#cb746-676" aria-hidden="true" tabindex="-1"></a><span class="co">#assumes conditional means are not equal to conditional variances</span></span>
<span id="cb746-677"><a href="#cb746-677" aria-hidden="true" tabindex="-1"></a><span class="co">#conduct likelihood ration test to compare and test [need poisson]</span></span>
<span id="cb746-678"><a href="#cb746-678" aria-hidden="true" tabindex="-1"></a>m.t <span class="ot">&lt;-</span> <span class="fu">glm</span>(test_score <span class="sc">~</span> condition, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> df)</span>
<span id="cb746-679"><a href="#cb746-679" aria-hidden="true" tabindex="-1"></a><span class="co">#pchisq(2 * (logLik(nb.1) - logLik(m.t)), df = 1, lower.tail = FALSE)</span></span>
<span id="cb746-680"><a href="#cb746-680" aria-hidden="true" tabindex="-1"></a><span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span></span>
<span id="cb746-681"><a href="#cb746-681" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.t, nb<span class="fl">.1</span>)</span>
<span id="cb746-682"><a href="#cb746-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-683"><a href="#cb746-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-684"><a href="#cb746-684" aria-hidden="true" tabindex="-1"></a><span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb746-685"><a href="#cb746-685" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Estimate =</span> <span class="fu">coef</span>(nb<span class="fl">.1</span>), <span class="fu">confint</span>(nb<span class="fl">.1</span>))</span>
<span id="cb746-686"><a href="#cb746-686" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate parameter estimates</span></span>
<span id="cb746-687"><a href="#cb746-687" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Exponentiated Estimates"</span>)</span>
<span id="cb746-688"><a href="#cb746-688" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(est)</span>
<span id="cb746-689"><a href="#cb746-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-690"><a href="#cb746-690" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb<span class="fl">.1</span>)</span>
<span id="cb746-691"><a href="#cb746-691" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(nb<span class="fl">.1</span>)</span>
<span id="cb746-692"><a href="#cb746-692" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(nb<span class="fl">.1</span>)</span>
<span id="cb746-693"><a href="#cb746-693" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(nb<span class="fl">.1</span>)</span>
<span id="cb746-694"><a href="#cb746-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-695"><a href="#cb746-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-696"><a href="#cb746-696" aria-hidden="true" tabindex="-1"></a>*The variable condition has a coefficient of 0.67, (p \&lt; 0.005). This means that for the impasse condition, the expected log count \# of questions increases by 0.67. By exponentiating the estimate we see that \# question correct rate for the impasse condition is nearly 1.95x that of the control condition. However, model diagnostics suggest the residuals are not normally distributed.*</span>
<span id="cb746-697"><a href="#cb746-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-700"><a href="#cb746-700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-701"><a href="#cb746-701" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE POISSON AND NEGATIVE BINOMIAL</span></span>
<span id="cb746-702"><a href="#cb746-702" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(p<span class="fl">.1</span>, nb<span class="fl">.1</span>)</span>
<span id="cb746-703"><a href="#cb746-703" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(p<span class="fl">.1</span>, nb<span class="fl">.1</span>)</span>
<span id="cb746-704"><a href="#cb746-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-705"><a href="#cb746-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-706"><a href="#cb746-706" aria-hidden="true" tabindex="-1"></a>*AIC, Pseudo-R2 and a likelihood ratio test indicate that the negative binomial regression model are a better fit for the distribution of test-phase scores.*</span>
<span id="cb746-707"><a href="#cb746-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-708"><a href="#cb746-708" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXTURE MODELS</span></span>
<span id="cb746-709"><a href="#cb746-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-710"><a href="#cb746-710" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zero Inflated Poisson</span></span>
<span id="cb746-711"><a href="#cb746-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-712"><a href="#cb746-712" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/zip/&gt;</span>\</span>
<span id="cb746-713"><a href="#cb746-713" aria-hidden="true" tabindex="-1"></a>*A Poisson count process with excess zeros*</span>
<span id="cb746-714"><a href="#cb746-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-715"><a href="#cb746-715" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Zero-Inflated model allows specification of two models (a mixture) where *some* of the zeros are included in the DGP for the Poisson model, while only the 'excess' zeros are included in the DGP for the Binomial model <span class="sc">\[</span>the zero-inflated part<span class="sc">\]</span></span>
<span id="cb746-716"><a href="#cb746-716" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The model includes:</span>
<span id="cb746-717"><a href="#cb746-717" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A logistic model to model which of the two processes the zero outcome is associated with</span>
<span id="cb746-718"><a href="#cb746-718" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A poisson model to model the count process</span>
<span id="cb746-719"><a href="#cb746-719" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can specify different predictors for each part of the model</span>
<span id="cb746-720"><a href="#cb746-720" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>predictors after the \| are for the binomial zero-inflated part of the model, while those infront are for the poisson process</span>
<span id="cb746-721"><a href="#cb746-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-724"><a href="#cb746-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-725"><a href="#cb746-725" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED POISSON</span></span>
<span id="cb746-726"><a href="#cb746-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-727"><a href="#cb746-727" aria-hidden="true" tabindex="-1"></a>zinfp<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(test_score <span class="sc">~</span>  condition<span class="sc">|</span> condition , <span class="at">data =</span> df)</span>
<span id="cb746-728"><a href="#cb746-728" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb746-729"><a href="#cb746-729" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb746-730"><a href="#cb746-730" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb746-731"><a href="#cb746-731" aria-hidden="true" tabindex="-1"></a><span class="co">#check_model(zinfp.1)</span></span>
<span id="cb746-732"><a href="#cb746-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-733"><a href="#cb746-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-734"><a href="#cb746-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-735"><a href="#cb746-735" aria-hidden="true" tabindex="-1"></a>*In the count model, the coefficient for the condition is not significant.*</span>
<span id="cb746-736"><a href="#cb746-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-737"><a href="#cb746-737" aria-hidden="true" tabindex="-1"></a>*In the zero-inflation model, the coefficient for the condition variable is -1.23 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.23 if you are in the impasse condition*</span>
<span id="cb746-738"><a href="#cb746-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-739"><a href="#cb746-739" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zero Inflated Negative Binomial Regression</span></span>
<span id="cb746-740"><a href="#cb746-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-741"><a href="#cb746-741" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.oarc.ucla.edu/r/dae/zinb/&gt;</span>\</span>
<span id="cb746-742"><a href="#cb746-742" aria-hidden="true" tabindex="-1"></a>*count data that are overdispersed and have excess zeros*</span>
<span id="cb746-743"><a href="#cb746-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-744"><a href="#cb746-744" aria-hidden="true" tabindex="-1"></a>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the *excess* zeros can be modelled independently.</span>
<span id="cb746-745"><a href="#cb746-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-746"><a href="#cb746-746" aria-hidden="true" tabindex="-1"></a>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different 'process' ... (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) <span class="sc">\&lt;</span>- this could maybe be disentangled by first question latency?</span>
<span id="cb746-747"><a href="#cb746-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-748"><a href="#cb746-748" aria-hidden="true" tabindex="-1"></a>The model includes:</span>
<span id="cb746-749"><a href="#cb746-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-750"><a href="#cb746-750" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A logistic model to model which of the two processes the zero outcome is associated with</span>
<span id="cb746-751"><a href="#cb746-751" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A negative binomial model to model the count process</span>
<span id="cb746-752"><a href="#cb746-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-755"><a href="#cb746-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-756"><a href="#cb746-756" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TESTABS-ZINFNEGBINOM</span></span>
<span id="cb746-757"><a href="#cb746-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-758"><a href="#cb746-758" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#  for zeroinfl negbinomial</span></span>
<span id="cb746-759"><a href="#cb746-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-760"><a href="#cb746-760" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span></span>
<span id="cb746-761"><a href="#cb746-761" aria-hidden="true" tabindex="-1"></a>zinb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , </span>
<span id="cb746-762"><a href="#cb746-762" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> df, <span class="at">dist =</span> <span class="st">"negbin"</span>)</span>
<span id="cb746-763"><a href="#cb746-763" aria-hidden="true" tabindex="-1"></a><span class="co">#before the | is the count part, after the | is the logit model</span></span>
<span id="cb746-764"><a href="#cb746-764" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb746-765"><a href="#cb746-765" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb746-766"><a href="#cb746-766" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb746-767"><a href="#cb746-767" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb746-768"><a href="#cb746-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-769"><a href="#cb746-769" aria-hidden="true" tabindex="-1"></a><span class="co">#   rootogram(zinb.1)</span></span>
<span id="cb746-770"><a href="#cb746-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-771"><a href="#cb746-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-772"><a href="#cb746-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-773"><a href="#cb746-773" aria-hidden="true" tabindex="-1"></a><span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb746-774"><a href="#cb746-774" aria-hidden="true" tabindex="-1"></a><span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span></span>
<span id="cb746-775"><a href="#cb746-775" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate parameter estimates</span></span>
<span id="cb746-776"><a href="#cb746-776" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Exponentiated Estimates")</span></span>
<span id="cb746-777"><a href="#cb746-777" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(est)</span></span>
<span id="cb746-778"><a href="#cb746-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-779"><a href="#cb746-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-780"><a href="#cb746-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-781"><a href="#cb746-781" aria-hidden="true" tabindex="-1"></a>*In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).*</span>
<span id="cb746-782"><a href="#cb746-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-783"><a href="#cb746-783" aria-hidden="true" tabindex="-1"></a>*In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition*</span>
<span id="cb746-784"><a href="#cb746-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-787"><a href="#cb746-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-788"><a href="#cb746-788" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(zinfp<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span>
<span id="cb746-789"><a href="#cb746-789" aria-hidden="true" tabindex="-1"></a><span class="fu">test_likelihoodratio</span>(zinfp<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span>
<span id="cb746-790"><a href="#cb746-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-791"><a href="#cb746-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-792"><a href="#cb746-792" aria-hidden="true" tabindex="-1"></a>**TODO come back to this and discuss further**\</span>
<span id="cb746-793"><a href="#cb746-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-794"><a href="#cb746-794" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hurdle Model</span></span>
<span id="cb746-795"><a href="#cb746-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-796"><a href="#cb746-796" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://data.library.virginia.edu/getting-started-with-hurdle-models/&gt;</span></span>
<span id="cb746-797"><a href="#cb746-797" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.&gt;</span></span>
<span id="cb746-798"><a href="#cb746-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-799"><a href="#cb746-799" aria-hidden="true" tabindex="-1"></a>class of models for count data with both overdispersion and excess zeros;\</span>
<span id="cb746-800"><a href="#cb746-800" aria-hidden="true" tabindex="-1"></a>different from zero-inflated models where the excess zeros are theorized to arise from two *different* processes; in the hurdle model, there is a separate model for P(x=0) and a separate model for P(x!=0)</span>
<span id="cb746-801"><a href="#cb746-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-802"><a href="#cb746-802" aria-hidden="true" tabindex="-1"></a>The model includes:</span>
<span id="cb746-803"><a href="#cb746-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-804"><a href="#cb746-804" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A binary logit model to model whether the observation takes a positive count or not. (1) Does the student get *any* questions right?</span>
<span id="cb746-805"><a href="#cb746-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-806"><a href="#cb746-806" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>a truncated Poisson or Negative binomial model that only fits positive counts (2) How many questions does the student get right?</span>
<span id="cb746-807"><a href="#cb746-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-810"><a href="#cb746-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-811"><a href="#cb746-811" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zero-inf and hurdle models </span></span>
<span id="cb746-812"><a href="#cb746-812" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countreg) <span class="co">#rootogram</span></span>
<span id="cb746-813"><a href="#cb746-813" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span></span>
<span id="cb746-814"><a href="#cb746-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-815"><a href="#cb746-815" aria-hidden="true" tabindex="-1"></a><span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span></span>
<span id="cb746-816"><a href="#cb746-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-817"><a href="#cb746-817" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.1</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df,</span>
<span id="cb746-818"><a href="#cb746-818" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb746-819"><a href="#cb746-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-820"><a href="#cb746-820" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.2</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(test_score <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df,</span>
<span id="cb746-821"><a href="#cb746-821" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"negbin"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb746-822"><a href="#cb746-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-823"><a href="#cb746-823" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.1</span>)</span>
<span id="cb746-824"><a href="#cb746-824" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.2</span>)</span>
<span id="cb746-825"><a href="#cb746-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-826"><a href="#cb746-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-827"><a href="#cb746-827" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.1</span>)</span>
<span id="cb746-828"><a href="#cb746-828" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.2</span>)</span>
<span id="cb746-829"><a href="#cb746-829" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(h<span class="fl">.1</span>,h<span class="fl">.2</span>))</span>
<span id="cb746-830"><a href="#cb746-830" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(h<span class="fl">.1</span>, h<span class="fl">.2</span>)</span>
<span id="cb746-831"><a href="#cb746-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-832"><a href="#cb746-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-833"><a href="#cb746-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-834"><a href="#cb746-834" aria-hidden="true" tabindex="-1"></a><span class="fu">## BETA REGRESSION</span></span>
<span id="cb746-835"><a href="#cb746-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-836"><a href="#cb746-836" aria-hidden="true" tabindex="-1"></a><span class="fu">### BETA Distribution</span></span>
<span id="cb746-837"><a href="#cb746-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-838"><a href="#cb746-838" aria-hidden="true" tabindex="-1"></a>Beta regression on % correct (with standard transformation for including <span class="sc">\[</span>0,1<span class="sc">\]</span>)</span>
<span id="cb746-839"><a href="#cb746-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-840"><a href="#cb746-840" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression&gt;</span></span>
<span id="cb746-841"><a href="#cb746-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-842"><a href="#cb746-842" aria-hidden="true" tabindex="-1"></a>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</span>
<span id="cb746-843"><a href="#cb746-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-844"><a href="#cb746-844" aria-hidden="true" tabindex="-1"></a>If a test score is conceptualized as correct (a) and b (incorrect) score = correct / (correct + incorrect) = a/ (a + b)</span>
<span id="cb746-845"><a href="#cb746-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-846"><a href="#cb746-846" aria-hidden="true" tabindex="-1"></a>In the beta distribution, a and b are the shape parameters!</span>
<span id="cb746-847"><a href="#cb746-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-850"><a href="#cb746-850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-851"><a href="#cb746-851" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb746-852"><a href="#cb746-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb746-853"><a href="#cb746-853" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb746-854"><a href="#cb746-854" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb746-855"><a href="#cb746-855" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb746-856"><a href="#cb746-856" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb746-857"><a href="#cb746-857" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb746-858"><a href="#cb746-858" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb746-859"><a href="#cb746-859" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb746-860"><a href="#cb746-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-861"><a href="#cb746-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-862"><a href="#cb746-862" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb746-863"><a href="#cb746-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">6</span>, <span class="at">shape2 =</span> <span class="dv">4</span>),</span>
<span id="cb746-864"><a href="#cb746-864" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 6, shape2 = 4)"</span>),</span>
<span id="cb746-865"><a href="#cb746-865" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-866"><a href="#cb746-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb746-867"><a href="#cb746-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-868"><a href="#cb746-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb746-869"><a href="#cb746-869" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Beta a = 6, b = 4"</span></span>
<span id="cb746-870"><a href="#cb746-870" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-871"><a href="#cb746-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-872"><a href="#cb746-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-873"><a href="#cb746-873" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb746-874"><a href="#cb746-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">8</span>, <span class="at">shape2 =</span> <span class="fl">0.001</span>),</span>
<span id="cb746-875"><a href="#cb746-875" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 8, shape2 = 0.001)"</span>),</span>
<span id="cb746-876"><a href="#cb746-876" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-877"><a href="#cb746-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb746-878"><a href="#cb746-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-879"><a href="#cb746-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb746-880"><a href="#cb746-880" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL CORRECT"</span></span>
<span id="cb746-881"><a href="#cb746-881" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-882"><a href="#cb746-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-883"><a href="#cb746-883" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb746-884"><a href="#cb746-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.001</span>, <span class="at">shape2 =</span> <span class="dv">8</span>),</span>
<span id="cb746-885"><a href="#cb746-885" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 0.001, shape2 = 8)"</span>),</span>
<span id="cb746-886"><a href="#cb746-886" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-887"><a href="#cb746-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb746-888"><a href="#cb746-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-889"><a href="#cb746-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb746-890"><a href="#cb746-890" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL WRONG"</span></span>
<span id="cb746-891"><a href="#cb746-891" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-892"><a href="#cb746-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-893"><a href="#cb746-893" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb746-894"><a href="#cb746-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">4</span>),</span>
<span id="cb746-895"><a href="#cb746-895" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 4, shape2 = 4)"</span>),</span>
<span id="cb746-896"><a href="#cb746-896" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-897"><a href="#cb746-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb746-898"><a href="#cb746-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-899"><a href="#cb746-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb746-900"><a href="#cb746-900" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FIGURED IT OUT HALFWAY "</span></span>
<span id="cb746-901"><a href="#cb746-901" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-902"><a href="#cb746-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-903"><a href="#cb746-903" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-904"><a href="#cb746-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-905"><a href="#cb746-905" aria-hidden="true" tabindex="-1"></a>ALTERNATIVE conceptualization of a and b is as mean MU and precision PHI (same idea as variance).</span>
<span id="cb746-906"><a href="#cb746-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-907"><a href="#cb746-907" aria-hidden="true" tabindex="-1"></a>a = mu <span class="sc">\*</span> phi b = (1 - mu) <span class="sc">\*</span> phi</span>
<span id="cb746-908"><a href="#cb746-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-909"><a href="#cb746-909" aria-hidden="true" tabindex="-1"></a>MU = a / (a+b) <span class="sc">\[</span>the score<span class="sc">\]</span> PHI = a + b <span class="sc">\[</span> the total <span class="sc">\#</span> items <span class="sc">\]</span></span>
<span id="cb746-910"><a href="#cb746-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-911"><a href="#cb746-911" aria-hidden="true" tabindex="-1"></a>The <span class="in">`extraDistr::dprop`</span> function can also handle mu and phi parameters, named as mean and size</span>
<span id="cb746-912"><a href="#cb746-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-915"><a href="#cb746-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-916"><a href="#cb746-916" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extraDistr)</span>
<span id="cb746-917"><a href="#cb746-917" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb746-918"><a href="#cb746-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.999</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb746-919"><a href="#cb746-919" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.99, size = 8)"</span>),</span>
<span id="cb746-920"><a href="#cb746-920" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-921"><a href="#cb746-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb746-922"><a href="#cb746-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-923"><a href="#cb746-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb746-924"><a href="#cb746-924" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL CORRECT"</span></span>
<span id="cb746-925"><a href="#cb746-925" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-926"><a href="#cb746-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-927"><a href="#cb746-927" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb746-928"><a href="#cb746-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.001</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb746-929"><a href="#cb746-929" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.001, size = 8)"</span>),</span>
<span id="cb746-930"><a href="#cb746-930" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-931"><a href="#cb746-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb746-932"><a href="#cb746-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-933"><a href="#cb746-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb746-934"><a href="#cb746-934" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ALL WRONG"</span></span>
<span id="cb746-935"><a href="#cb746-935" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-936"><a href="#cb746-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-937"><a href="#cb746-937" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb746-938"><a href="#cb746-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dprop, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb746-939"><a href="#cb746-939" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(mean = 0.5, size = 8)"</span>),</span>
<span id="cb746-940"><a href="#cb746-940" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-941"><a href="#cb746-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb746-942"><a href="#cb746-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-943"><a href="#cb746-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb746-944"><a href="#cb746-944" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FIGURED IT OUT HALFWAY "</span></span>
<span id="cb746-945"><a href="#cb746-945" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-946"><a href="#cb746-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-947"><a href="#cb746-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-948"><a href="#cb746-948" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb746-949"><a href="#cb746-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.001</span>, <span class="at">shape2 =</span> <span class="dv">1</span>),</span>
<span id="cb746-950"><a href="#cb746-950" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Beta(shape1 = 6, shape2 = 4)"</span>),</span>
<span id="cb746-951"><a href="#cb746-951" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-952"><a href="#cb746-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb746-953"><a href="#cb746-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-954"><a href="#cb746-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb746-955"><a href="#cb746-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-956"><a href="#cb746-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-957"><a href="#cb746-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-958"><a href="#cb746-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-959"><a href="#cb746-959" aria-hidden="true" tabindex="-1"></a>**Note that in all cases, we have to slightly adjust the parameters because the distribution can't handle values at 0 or 1. So we scrunch the data in just a bit.**</span>
<span id="cb746-960"><a href="#cb746-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-961"><a href="#cb746-961" aria-hidden="true" tabindex="-1"></a><span class="fu">### BETA Regression</span></span>
<span id="cb746-962"><a href="#cb746-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-963"><a href="#cb746-963" aria-hidden="true" tabindex="-1"></a>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</span>
<span id="cb746-964"><a href="#cb746-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-965"><a href="#cb746-965" aria-hidden="true" tabindex="-1"></a>The syntax is just like all other formula-based regression functions, but with an added bit: the first part of the equation (x \~ y) models the mean, or MU, while anything that comes after a \| in the formula will explain variation in the precision, or PHI.</span>
<span id="cb746-966"><a href="#cb746-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-967"><a href="#cb746-967" aria-hidden="true" tabindex="-1"></a>The link parameter determines the link function for the mu estimate?.</span>
<span id="cb746-968"><a href="#cb746-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-969"><a href="#cb746-969" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb746-970"><a href="#cb746-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-973"><a href="#cb746-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-974"><a href="#cb746-974" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb746-975"><a href="#cb746-975" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg)</span>
<span id="cb746-976"><a href="#cb746-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-977"><a href="#cb746-977" aria-hidden="true" tabindex="-1"></a><span class="co">#RESCLAE VARIABLE</span></span>
<span id="cb746-978"><a href="#cb746-978" aria-hidden="true" tabindex="-1"></a><span class="co">#beta reg can't handle 0s and 1s </span></span>
<span id="cb746-979"><a href="#cb746-979" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, DV_percent_NABS)</span>
<span id="cb746-980"><a href="#cb746-980" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(sub) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb746-981"><a href="#cb746-981" aria-hidden="true" tabindex="-1"></a>sub<span class="sc">$</span>dv_transformed <span class="ot">=</span> (sub<span class="sc">$</span>DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb746-982"><a href="#cb746-982" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb746-983"><a href="#cb746-983" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE VARIABLES</span></span>
<span id="cb746-984"><a href="#cb746-984" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Slightly squished data"</span>)</span>
<span id="cb746-985"><a href="#cb746-985" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(sub<span class="sc">$</span>dv_transformed)</span>
<span id="cb746-986"><a href="#cb746-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-987"><a href="#cb746-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-988"><a href="#cb746-988" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb746-989"><a href="#cb746-989" aria-hidden="true" tabindex="-1"></a>mb1 <span class="ot">&lt;-</span> <span class="fu">betareg</span>(dv_transformed <span class="sc">~</span> condition <span class="sc">|</span> condition, </span>
<span id="cb746-990"><a href="#cb746-990" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> sub)</span>
<span id="cb746-991"><a href="#cb746-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-992"><a href="#cb746-992" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mb1)</span>
<span id="cb746-993"><a href="#cb746-993" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mb1)</span>
<span id="cb746-994"><a href="#cb746-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-995"><a href="#cb746-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-996"><a href="#cb746-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-997"><a href="#cb746-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-998"><a href="#cb746-998" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Which link function should be used for each? We now have two sets of coefficients, one set for each parameter (the mean and precision). The parameters for the mean are measured on the logit scale, just like with logistic regression previously, and we can calculate the marginal effect of having a quota by using plogis() and piecing together the coefficient and the intercept:</span>
<span id="cb746-999"><a href="#cb746-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1000"><a href="#cb746-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interpret</span></span>
<span id="cb746-1001"><a href="#cb746-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1004"><a href="#cb746-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1005"><a href="#cb746-1005" aria-hidden="true" tabindex="-1"></a>beta_mu_intercept <span class="ot">&lt;-</span> mb1 <span class="sc">%&gt;%</span> </span>
<span id="cb746-1006"><a href="#cb746-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb746-1007"><a href="#cb746-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1008"><a href="#cb746-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb746-1009"><a href="#cb746-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1010"><a href="#cb746-1010" aria-hidden="true" tabindex="-1"></a>beta_mu_condition <span class="ot">&lt;-</span> mb1 <span class="sc">%&gt;%</span> </span>
<span id="cb746-1011"><a href="#cb746-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb746-1012"><a href="#cb746-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1013"><a href="#cb746-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb746-1014"><a href="#cb746-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1015"><a href="#cb746-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1016"><a href="#cb746-1016" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- PROBABILITIES"</span>)</span>
<span id="cb746-1017"><a href="#cb746-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"[these should math pred plots]"</span>)</span>
<span id="cb746-1018"><a href="#cb746-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at reference level"</span>)</span>
<span id="cb746-1019"><a href="#cb746-1019" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept)</span>
<span id="cb746-1020"><a href="#cb746-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at coefficient level"</span>)</span>
<span id="cb746-1021"><a href="#cb746-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition)</span>
<span id="cb746-1022"><a href="#cb746-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"CHANGE in probability by coefficient"</span>)</span>
<span id="cb746-1023"><a href="#cb746-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition) <span class="sc">-</span> <span class="fu">plogis</span>(beta_mu_intercept)</span>
<span id="cb746-1024"><a href="#cb746-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1025"><a href="#cb746-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mb1, <span class="at">type =</span> <span class="st">"pred"</span>)</span>
<span id="cb746-1026"><a href="#cb746-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1027"><a href="#cb746-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1028"><a href="#cb746-1028" aria-hidden="true" tabindex="-1"></a>Impasse increases the average of the distribution of accuracy by 12% percentage points, on average. This should match the value we get with fractional regression. (logistic regression with count variable instead of binomial)</span>
<span id="cb746-1029"><a href="#cb746-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1030"><a href="#cb746-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercept of MU indicates the average of the distribution of score proportion in the control condition</span>
<span id="cb746-1031"><a href="#cb746-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient of MU indicates the change in the average distribution of score proportion in the impasse condition</span>
<span id="cb746-1032"><a href="#cb746-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1033"><a href="#cb746-1033" aria-hidden="true" tabindex="-1"></a>The PHI parameter estimates are not measured on a logit scale. Instead, they're log values. We can invert them by exponentiating them with exp(). - The phi intercept indicates the precision of the distribution of score proportion in the control condition - The phi coefficient indicates the change in the precision of the distribution of score proportion in the impasse condition</span>
<span id="cb746-1034"><a href="#cb746-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1035"><a href="#cb746-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>CONDITION is a significant predictor of MEAN (location) but not PHI (precision). Put another way, the shape of both distributions is similar, but the impasse condition distribution is shift to the right (higher) than the control distribution.</span>
<span id="cb746-1036"><a href="#cb746-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1037"><a href="#cb746-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1038"><a href="#cb746-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1039"><a href="#cb746-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Compare</span></span>
<span id="cb746-1040"><a href="#cb746-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1043"><a href="#cb746-1043" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1044"><a href="#cb746-1044" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPARE MODELS</span></span>
<span id="cb746-1045"><a href="#cb746-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1046"><a href="#cb746-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1047"><a href="#cb746-1047" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb746-1048"><a href="#cb746-1048" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb746-1049"><a href="#cb746-1049" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(df) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb746-1050"><a href="#cb746-1050" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(</span>
<span id="cb746-1051"><a href="#cb746-1051" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> item_test_NABS<span class="sc">/</span><span class="dv">8</span>,</span>
<span id="cb746-1052"><a href="#cb746-1052" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_trans =</span> (accuracy <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n,</span>
<span id="cb746-1053"><a href="#cb746-1053" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_trans =</span> (DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb746-1054"><a href="#cb746-1054" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-1055"><a href="#cb746-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1056"><a href="#cb746-1056" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION</span></span>
<span id="cb746-1057"><a href="#cb746-1057" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( test_trans <span class="sc">~</span> pretty_condition    , <span class="at">data =</span> df)</span>
<span id="cb746-1058"><a href="#cb746-1058" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm1)</span></span>
<span id="cb746-1059"><a href="#cb746-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1060"><a href="#cb746-1060" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION on LOGTRANSFORMED</span></span>
<span id="cb746-1061"><a href="#cb746-1061" aria-hidden="true" tabindex="-1"></a>qlm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( <span class="fu">qlogis</span>(test_trans) <span class="sc">~</span> pretty_condition    , <span class="at">data =</span> df)</span>
<span id="cb746-1062"><a href="#cb746-1062" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(qlm1)</span></span>
<span id="cb746-1063"><a href="#cb746-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1064"><a href="#cb746-1064" aria-hidden="true" tabindex="-1"></a><span class="co"># FRACTIONAL REGRESSION</span></span>
<span id="cb746-1065"><a href="#cb746-1065" aria-hidden="true" tabindex="-1"></a><span class="co">#uses quasibinomial [like binomial] on proportion </span></span>
<span id="cb746-1066"><a href="#cb746-1066" aria-hidden="true" tabindex="-1"></a><span class="co">#instead of binomial data. coeffs on logit scale</span></span>
<span id="cb746-1067"><a href="#cb746-1067" aria-hidden="true" tabindex="-1"></a>flm1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( test_trans <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">quasibinomial</span>())</span>
<span id="cb746-1068"><a href="#cb746-1068" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flm1)</span>
<span id="cb746-1069"><a href="#cb746-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1070"><a href="#cb746-1070" aria-hidden="true" tabindex="-1"></a><span class="co"># BETA REGRESSION predictor phi</span></span>
<span id="cb746-1071"><a href="#cb746-1071" aria-hidden="true" tabindex="-1"></a>bm1 <span class="ot">&lt;-</span> <span class="fu">betareg</span>(test_trans <span class="sc">~</span> pretty_condition <span class="sc">|</span> pretty_condition, </span>
<span id="cb746-1072"><a href="#cb746-1072" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> df, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb746-1073"><a href="#cb746-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bm1)</span>
<span id="cb746-1074"><a href="#cb746-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1075"><a href="#cb746-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1076"><a href="#cb746-1076" aria-hidden="true" tabindex="-1"></a>models <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"LM"</span> <span class="ot">=</span> lm1, </span>
<span id="cb746-1077"><a href="#cb746-1077" aria-hidden="true" tabindex="-1"></a>              <span class="st">"LM log transform"</span> <span class="ot">=</span> qlm1, </span>
<span id="cb746-1078"><a href="#cb746-1078" aria-hidden="true" tabindex="-1"></a>              <span class="st">"GLM Quasibinomial"</span> <span class="ot">=</span> flm1, </span>
<span id="cb746-1079"><a href="#cb746-1079" aria-hidden="true" tabindex="-1"></a>              <span class="st">"beta"</span> <span class="ot">=</span> bm1)</span>
<span id="cb746-1080"><a href="#cb746-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(models)</span>
<span id="cb746-1081"><a href="#cb746-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1082"><a href="#cb746-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1083"><a href="#cb746-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1084"><a href="#cb746-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1085"><a href="#cb746-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1088"><a href="#cb746-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1089"><a href="#cb746-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#GET ESTIMATES</span></span>
<span id="cb746-1090"><a href="#cb746-1090" aria-hidden="true" tabindex="-1"></a>model_beta <span class="ot">&lt;-</span> bm1</span>
<span id="cb746-1091"><a href="#cb746-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1092"><a href="#cb746-1092" aria-hidden="true" tabindex="-1"></a>beta_mu_intercept <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb746-1093"><a href="#cb746-1093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb746-1094"><a href="#cb746-1094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1095"><a href="#cb746-1095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb746-1096"><a href="#cb746-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1097"><a href="#cb746-1097" aria-hidden="true" tabindex="-1"></a>beta_mu_condition <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb746-1098"><a href="#cb746-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb746-1099"><a href="#cb746-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"mean"</span>, term <span class="sc">==</span> <span class="st">"pretty_conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1100"><a href="#cb746-1100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb746-1101"><a href="#cb746-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1102"><a href="#cb746-1102" aria-hidden="true" tabindex="-1"></a>beta_phi_intercept <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb746-1103"><a href="#cb746-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb746-1104"><a href="#cb746-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"precision"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1105"><a href="#cb746-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb746-1106"><a href="#cb746-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1107"><a href="#cb746-1107" aria-hidden="true" tabindex="-1"></a>beta_phi_condition <span class="ot">&lt;-</span> model_beta <span class="sc">%&gt;%</span> </span>
<span id="cb746-1108"><a href="#cb746-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb746-1109"><a href="#cb746-1109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"precision"</span>, term <span class="sc">==</span> <span class="st">"pretty_conditionimpasse"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1110"><a href="#cb746-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb746-1111"><a href="#cb746-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1112"><a href="#cb746-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1113"><a href="#cb746-1113" aria-hidden="true" tabindex="-1"></a>mu_control <span class="ot">=</span> <span class="fu">plogis</span>(beta_mu_intercept)</span>
<span id="cb746-1114"><a href="#cb746-1114" aria-hidden="true" tabindex="-1"></a>phi_control <span class="ot">=</span> <span class="fu">plogis</span>(beta_phi_intercept)</span>
<span id="cb746-1115"><a href="#cb746-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#when you don’t explicitly model the precision, the resulting coefficient in the table isn’t on the log scale—it’s a regular non-logged number, so there’s no need to exponentiate</span></span>
<span id="cb746-1116"><a href="#cb746-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1117"><a href="#cb746-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT ESTIMATES</span></span>
<span id="cb746-1118"><a href="#cb746-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1119"><a href="#cb746-1119" aria-hidden="true" tabindex="-1"></a>control_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"dprop(mean = plogis("</span>, <span class="fu">round</span>(beta_mu_intercept, <span class="dv">2</span>),</span>
<span id="cb746-1120"><a href="#cb746-1120" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"), size = exp("</span>, <span class="fu">round</span>(beta_phi_intercept, <span class="dv">2</span>), <span class="st">"))"</span>)</span>
<span id="cb746-1121"><a href="#cb746-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1122"><a href="#cb746-1122" aria-hidden="true" tabindex="-1"></a>impasse_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"dprop(mean = plogis("</span>, <span class="fu">round</span>(beta_mu_intercept, <span class="dv">2</span>),</span>
<span id="cb746-1123"><a href="#cb746-1123" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" + "</span>, <span class="fu">round</span>(beta_mu_condition, <span class="dv">2</span>), </span>
<span id="cb746-1124"><a href="#cb746-1124" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"), size = exp("</span>, <span class="fu">round</span>(beta_phi_intercept, <span class="dv">2</span>),</span>
<span id="cb746-1125"><a href="#cb746-1125" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" + "</span>, <span class="fu">round</span>(beta_phi_condition, <span class="dv">2</span>), <span class="st">"))"</span>)</span>
<span id="cb746-1126"><a href="#cb746-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1127"><a href="#cb746-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb746-1128"><a href="#cb746-1128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dprop, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb746-1129"><a href="#cb746-1129" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fu">exp</span>(beta_phi_intercept), </span>
<span id="cb746-1130"><a href="#cb746-1130" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mean =</span> <span class="fu">plogis</span>(beta_mu_intercept)),</span>
<span id="cb746-1131"><a href="#cb746-1131" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> control_title)) <span class="sc">+</span> </span>
<span id="cb746-1132"><a href="#cb746-1132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dprop, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb746-1133"><a href="#cb746-1133" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fu">exp</span>(beta_phi_intercept <span class="sc">+</span> beta_phi_condition), </span>
<span id="cb746-1134"><a href="#cb746-1134" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mean =</span> <span class="fu">plogis</span>(beta_mu_intercept <span class="sc">+</span> beta_mu_condition)),</span>
<span id="cb746-1135"><a href="#cb746-1135" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> impasse_title)) <span class="sc">+</span></span>
<span id="cb746-1136"><a href="#cb746-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> df, </span>
<span id="cb746-1137"><a href="#cb746-1137" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> test_trans, <span class="at">fill =</span> pretty_condition), </span>
<span id="cb746-1138"><a href="#cb746-1138" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb746-1139"><a href="#cb746-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Beta Regression Predictions"</span>) <span class="sc">+</span></span>
<span id="cb746-1140"><a href="#cb746-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-1141"><a href="#cb746-1141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb746-1142"><a href="#cb746-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1143"><a href="#cb746-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1144"><a href="#cb746-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1145"><a href="#cb746-1145" aria-hidden="true" tabindex="-1"></a>We can also convert the parameter estimates back to A and B. for the impasse condition, MU = 0.397 SIZE = 0.666</span>
<span id="cb746-1146"><a href="#cb746-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1147"><a href="#cb746-1147" aria-hidden="true" tabindex="-1"></a>a = mu <span class="sc">\*</span> phi = 0.397 <span class="sc">\*</span> 0.66 = 0.264 b = (1 - mu) <span class="sc">\*</span> phi = (1 - 0.397) <span class="sc">\*</span> 0.666 = 0.402</span>
<span id="cb746-1148"><a href="#cb746-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1149"><a href="#cb746-1149" aria-hidden="true" tabindex="-1"></a>we should expect it to look more like ... (for 50% ) a = correct = 3 b = incorrect = 10 a + b = total = 13</span>
<span id="cb746-1150"><a href="#cb746-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1151"><a href="#cb746-1151" aria-hidden="true" tabindex="-1"></a>MU = a / (a+b) <span class="sc">\[</span>the score<span class="sc">\]</span> = 3 / 13 = 0.23 PHI = a + b <span class="sc">\[</span> the total <span class="sc">\#</span> items <span class="sc">\]</span> = 13</span>
<span id="cb746-1152"><a href="#cb746-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1153"><a href="#cb746-1153" aria-hidden="true" tabindex="-1"></a>mu = 0.277 = a / (a + b) phi = 0.395 = a + b let b = 13</span>
<span id="cb746-1154"><a href="#cb746-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1157"><a href="#cb746-1157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1158"><a href="#cb746-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#RECOVER A AND B FROM MU AND PHI</span></span>
<span id="cb746-1159"><a href="#cb746-1159" aria-hidden="true" tabindex="-1"></a>muphi_to_shapes <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, phi) {</span>
<span id="cb746-1160"><a href="#cb746-1160" aria-hidden="true" tabindex="-1"></a>  shape1 <span class="ot">&lt;-</span> mu <span class="sc">*</span> phi</span>
<span id="cb746-1161"><a href="#cb746-1161" aria-hidden="true" tabindex="-1"></a>  shape2 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> mu) <span class="sc">*</span> phi</span>
<span id="cb746-1162"><a href="#cb746-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">shape1 =</span> shape1, <span class="at">shape2 =</span> shape2))</span>
<span id="cb746-1163"><a href="#cb746-1163" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb746-1164"><a href="#cb746-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1165"><a href="#cb746-1165" aria-hidden="true" tabindex="-1"></a>shapes_to_muphi <span class="ot">&lt;-</span> <span class="cf">function</span>(shape1, shape2) {</span>
<span id="cb746-1166"><a href="#cb746-1166" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> shape1 <span class="sc">/</span> (shape1 <span class="sc">+</span> shape2)</span>
<span id="cb746-1167"><a href="#cb746-1167" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> shape1 <span class="sc">+</span> shape2</span>
<span id="cb746-1168"><a href="#cb746-1168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mu =</span> mu, <span class="at">phi =</span> phi))</span>
<span id="cb746-1169"><a href="#cb746-1169" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb746-1170"><a href="#cb746-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1171"><a href="#cb746-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"model predicts control A and B "</span>)</span>
<span id="cb746-1172"><a href="#cb746-1172" aria-hidden="true" tabindex="-1"></a><span class="fu">muphi_to_shapes</span>(mu_control, phi_control)</span>
<span id="cb746-1173"><a href="#cb746-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"should be something like "</span>)</span>
<span id="cb746-1174"><a href="#cb746-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">shapes_to_muphi</span>(<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb746-1175"><a href="#cb746-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1176"><a href="#cb746-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1177"><a href="#cb746-1177" aria-hidden="true" tabindex="-1"></a>It seems like the although the (shrinkled) beta regression model is working, it is really messing up the estimate of the PHI parameter, such that we can't even recover the A and B. I expect whole numbers, and instead I'm geting values less than 1. I think this might be because the phi value is so low (note that phi = precision, so like inverse of variance. Lower values are more less precise (more variance)). Since I have so many values near 0 and near 1 (even though I've shrunk the estimates to be in the open interval (0,1) rather than <span class="sc">\[</span>0,1<span class="sc">\]</span>, I think it causing problems with the estimation. )</span>
<span id="cb746-1178"><a href="#cb746-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1179"><a href="#cb746-1179" aria-hidden="true" tabindex="-1"></a><span class="fu">#### bayesian version</span></span>
<span id="cb746-1180"><a href="#cb746-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1183"><a href="#cb746-1183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1184"><a href="#cb746-1184" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb746-1185"><a href="#cb746-1185" aria-hidden="true" tabindex="-1"></a>model_beta_bayes <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb746-1186"><a href="#cb746-1186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(test_trans <span class="sc">~</span> pretty_condition,</span>
<span id="cb746-1187"><a href="#cb746-1187" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> pretty_condition),</span>
<span id="cb746-1188"><a href="#cb746-1188" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb746-1189"><a href="#cb746-1189" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">Beta</span>(),</span>
<span id="cb746-1190"><a href="#cb746-1190" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb746-1191"><a href="#cb746-1191" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb746-1192"><a href="#cb746-1192" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the cmdstanr backend for Stan because it's faster and more modern than</span></span>
<span id="cb746-1193"><a href="#cb746-1193" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the default rstan You need to install the cmdstanr package first</span></span>
<span id="cb746-1194"><a href="#cb746-1194" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (https://mc-stan.org/cmdstanr/) and then run cmdstanr::install_cmdstan() to</span></span>
<span id="cb746-1195"><a href="#cb746-1195" aria-hidden="true" tabindex="-1"></a>  <span class="co"># install cmdstan on your computer.</span></span>
<span id="cb746-1196"><a href="#cb746-1196" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span></span>
<span id="cb746-1197"><a href="#cb746-1197" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-1198"><a href="#cb746-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1199"><a href="#cb746-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1202"><a href="#cb746-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1203"><a href="#cb746-1203" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_beta_bayes)</span>
<span id="cb746-1204"><a href="#cb746-1204" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Cool! parameters are almost identical to betareg"</span>)</span>
<span id="cb746-1205"><a href="#cb746-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1206"><a href="#cb746-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1209"><a href="#cb746-1209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1210"><a href="#cb746-1210" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb746-1211"><a href="#cb746-1211" aria-hidden="true" tabindex="-1"></a>posterior_beta <span class="ot">&lt;-</span> model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb746-1212"><a href="#cb746-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(<span class="st">`</span><span class="at">b_.*</span><span class="st">`</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1213"><a href="#cb746-1213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">component =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(.variable, <span class="st">"phi_"</span>), <span class="st">"Precision"</span>, <span class="st">"Mean"</span>),</span>
<span id="cb746-1214"><a href="#cb746-1214" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercept =</span> <span class="fu">str_detect</span>(.variable, <span class="st">"Intercept"</span>))</span>
<span id="cb746-1215"><a href="#cb746-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1216"><a href="#cb746-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(posterior_beta, <span class="fu">aes</span>(<span class="at">x =</span> .value, <span class="at">y =</span> <span class="fu">fct_rev</span>(.variable), <span class="at">fill =</span> component)) <span class="sc">+</span></span>
<span id="cb746-1217"><a href="#cb746-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb746-1218"><a href="#cb746-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">slab_alpha =</span> intercept), </span>
<span id="cb746-1219"><a href="#cb746-1219" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.95</span>), <span class="at">point_interval =</span> <span class="st">"median_hdi"</span>) <span class="sc">+</span></span>
<span id="cb746-1220"><a href="#cb746-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">end =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb746-1221"><a href="#cb746-1221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_slab_alpha_discrete</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb746-1222"><a href="#cb746-1222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">slab_alpha =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb746-1223"><a href="#cb746-1223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Coefficient"</span>, <span class="at">y =</span> <span class="st">"Variable"</span>,</span>
<span id="cb746-1224"><a href="#cb746-1224" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"80% and 95% credible intervals shown in black; RAW COEFF"</span>) <span class="sc">+</span></span>
<span id="cb746-1225"><a href="#cb746-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(component), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb746-1226"><a href="#cb746-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>()</span>
<span id="cb746-1227"><a href="#cb746-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1228"><a href="#cb746-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1229"><a href="#cb746-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1230"><a href="#cb746-1230" aria-hidden="true" tabindex="-1"></a><span class="do">##GET USEFUL ESTIMATES</span></span>
<span id="cb746-1231"><a href="#cb746-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TRANSFORMED ESTIMATES"</span>)</span>
<span id="cb746-1232"><a href="#cb746-1232" aria-hidden="true" tabindex="-1"></a>model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb746-1233"><a href="#cb746-1233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(<span class="st">`</span><span class="at">b_.*</span><span class="st">`</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1234"><a href="#cb746-1234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"b_phi"</span>), <span class="sc">~</span><span class="fu">exp</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb746-1235"><a href="#cb746-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>((<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"."</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"b_phi"</span>)), <span class="sc">~</span><span class="fu">plogis</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb746-1236"><a href="#cb746-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_variables</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb746-1237"><a href="#cb746-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_hdi</span>()</span>
<span id="cb746-1238"><a href="#cb746-1238" aria-hidden="true" tabindex="-1"></a><span class="co"># now phi is a raw value indicating precision</span></span>
<span id="cb746-1239"><a href="#cb746-1239" aria-hidden="true" tabindex="-1"></a><span class="co"># now mu is an odds ratio for median? of the distribution</span></span>
<span id="cb746-1240"><a href="#cb746-1240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1241"><a href="#cb746-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1242"><a href="#cb746-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bayesian predictions</span></span>
<span id="cb746-1243"><a href="#cb746-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1246"><a href="#cb746-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1247"><a href="#cb746-1247" aria-hidden="true" tabindex="-1"></a><span class="co"># Plug a dataset where quota is FALSE and TRUE into the model</span></span>
<span id="cb746-1248"><a href="#cb746-1248" aria-hidden="true" tabindex="-1"></a>beta_bayes_pred <span class="ot">&lt;-</span> model_beta_bayes <span class="sc">%&gt;%</span> </span>
<span id="cb746-1249"><a href="#cb746-1249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epred_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">pretty_condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>)))</span>
<span id="cb746-1250"><a href="#cb746-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1251"><a href="#cb746-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_bayes_pred, </span>
<span id="cb746-1252"><a href="#cb746-1252" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> .epred, <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> pretty_condition)) <span class="sc">+</span></span>
<span id="cb746-1253"><a href="#cb746-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.95</span>), <span class="at">point_interval =</span> <span class="st">"median_hdi"</span>) <span class="sc">+</span></span>
<span id="cb746-1254"><a href="#cb746-1254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb746-1255"><a href="#cb746-1255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb746-1256"><a href="#cb746-1256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted Comprehension Task Score Percentage Correct"</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb746-1257"><a href="#cb746-1257" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"80% and 95% credible intervals shown in black"</span>) <span class="sc">+</span></span>
<span id="cb746-1258"><a href="#cb746-1258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>()</span>
<span id="cb746-1259"><a href="#cb746-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1260"><a href="#cb746-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1261"><a href="#cb746-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1262"><a href="#cb746-1262" aria-hidden="true" tabindex="-1"></a><span class="fu">### ZERO INFLATED BETA </span></span>
<span id="cb746-1263"><a href="#cb746-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1264"><a href="#cb746-1264" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>logistic regression for zero inflated $\alpha$ (logit scale)</span>
<span id="cb746-1265"><a href="#cb746-1265" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>beta regression for proportion $\mu$ (logit scale) and $\phi$ (log scale)</span>
<span id="cb746-1266"><a href="#cb746-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1269"><a href="#cb746-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1270"><a href="#cb746-1270" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, DV_percent_NABS) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1271"><a href="#cb746-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb746-1272"><a href="#cb746-1272" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> pretty_condition,</span>
<span id="cb746-1273"><a href="#cb746-1273" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> DV_percent_NABS</span>
<span id="cb746-1274"><a href="#cb746-1274" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb746-1275"><a href="#cb746-1275" aria-hidden="true" tabindex="-1"></a><span class="co">#shrink accuracy just a tiny bit from 1 for testing purposes </span></span>
<span id="cb746-1276"><a href="#cb746-1276" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyfst)</span>
<span id="cb746-1277"><a href="#cb746-1277" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate_when</span>(accuracy <span class="sc">==</span> <span class="dv">1</span>, <span class="at">accuracy =</span> <span class="fl">0.99</span>)</span>
<span id="cb746-1278"><a href="#cb746-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1279"><a href="#cb746-1279" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERCEPT ONLY model for alpha</span></span>
<span id="cb746-1280"><a href="#cb746-1280" aria-hidden="true" tabindex="-1"></a>zinb <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb746-1281"><a href="#cb746-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(accuracy <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb746-1282"><a href="#cb746-1282" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb746-1283"><a href="#cb746-1283" aria-hidden="true" tabindex="-1"></a>     zi <span class="sc">~</span> condition), <span class="co">#zero inflated is extreme? alpha</span></span>
<span id="cb746-1284"><a href="#cb746-1284" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb746-1285"><a href="#cb746-1285" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_inflated_beta</span>(),</span>
<span id="cb746-1286"><a href="#cb746-1286" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb746-1287"><a href="#cb746-1287" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span></span>
<span id="cb746-1288"><a href="#cb746-1288" aria-hidden="true" tabindex="-1"></a>  <span class="co"># backend = "cmdstanr"</span></span>
<span id="cb746-1289"><a href="#cb746-1289" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-1290"><a href="#cb746-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1293"><a href="#cb746-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1294"><a href="#cb746-1294" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb)</span>
<span id="cb746-1295"><a href="#cb746-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb)</span>
<span id="cb746-1296"><a href="#cb746-1296" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(zinb))</span></span>
<span id="cb746-1297"><a href="#cb746-1297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1298"><a href="#cb746-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1299"><a href="#cb746-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1302"><a href="#cb746-1302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1303"><a href="#cb746-1303" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(zinb, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb746-1304"><a href="#cb746-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1305"><a href="#cb746-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1306"><a href="#cb746-1306" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"INTERPRET ALPHA"</span>)</span>
<span id="cb746-1307"><a href="#cb746-1307" aria-hidden="true" tabindex="-1"></a>zi_intercept <span class="ot">&lt;-</span> <span class="fu">tidy</span>(zinb, <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1308"><a href="#cb746-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"zi"</span>, term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1309"><a href="#cb746-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb746-1310"><a href="#cb746-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1311"><a href="#cb746-1311" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit scale intercept</span></span>
<span id="cb746-1312"><a href="#cb746-1312" aria-hidden="true" tabindex="-1"></a>zi_intercept</span>
<span id="cb746-1313"><a href="#cb746-1313" aria-hidden="true" tabindex="-1"></a><span class="do">## b_zi_Intercept </span></span>
<span id="cb746-1314"><a href="#cb746-1314" aria-hidden="true" tabindex="-1"></a><span class="do">##          0.525</span></span>
<span id="cb746-1315"><a href="#cb746-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1316"><a href="#cb746-1316" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformed to a probability/proportion</span></span>
<span id="cb746-1317"><a href="#cb746-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(zi_intercept)</span>
<span id="cb746-1318"><a href="#cb746-1318" aria-hidden="true" tabindex="-1"></a><span class="do">## b_zi_Intercept </span></span>
<span id="cb746-1319"><a href="#cb746-1319" aria-hidden="true" tabindex="-1"></a><span class="do">##         0.628</span></span>
<span id="cb746-1320"><a href="#cb746-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1321"><a href="#cb746-1321" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(accuracy <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> condition <span class="sc">==</span> <span class="st">"control"</span>))<span class="sc">/</span><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>))</span>
<span id="cb746-1322"><a href="#cb746-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1323"><a href="#cb746-1323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1324"><a href="#cb746-1324" aria-hidden="true" tabindex="-1"></a>The value of the z_intercept should be the same as the proportion of 0s in the control condition. </span>
<span id="cb746-1325"><a href="#cb746-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1326"><a href="#cb746-1326" aria-hidden="true" tabindex="-1"></a>VISUALIZE ZERO INFLATED COMPONENT</span>
<span id="cb746-1329"><a href="#cb746-1329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1330"><a href="#cb746-1330" aria-hidden="true" tabindex="-1"></a>beta_zi_pred_int <span class="ot">&lt;-</span> zinb <span class="sc">%&gt;%</span> </span>
<span id="cb746-1331"><a href="#cb746-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1332"><a href="#cb746-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_zero =</span> .prediction <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb746-1333"><a href="#cb746-1333" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_zero, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb746-1334"><a href="#cb746-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1335"><a href="#cb746-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb746-1336"><a href="#cb746-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_zero), <span class="at">binwidth =</span> <span class="fl">0.025</span>, </span>
<span id="cb746-1337"><a href="#cb746-1337" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb746-1338"><a href="#cb746-1338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb746-1339"><a href="#cb746-1339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb746-1340"><a href="#cb746-1340" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb746-1341"><a href="#cb746-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb746-1342"><a href="#cb746-1342" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is zero?"</span>) <span class="sc">+</span></span>
<span id="cb746-1343"><a href="#cb746-1343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb746-1344"><a href="#cb746-1344" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb746-1345"><a href="#cb746-1345" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb746-1346"><a href="#cb746-1346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-1347"><a href="#cb746-1347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb746-1348"><a href="#cb746-1348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1349"><a href="#cb746-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1350"><a href="#cb746-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1351"><a href="#cb746-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">### ZERO-ONE INFLATED BETA Regression</span></span>
<span id="cb746-1352"><a href="#cb746-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1353"><a href="#cb746-1353" aria-hidden="true" tabindex="-1"></a>https://sometimesir.com/posts/2019-02-18-analyze-analog-scale-ratings-with-zero-one-inflated-beta-models/#zoib-regression</span>
<span id="cb746-1354"><a href="#cb746-1354" aria-hidden="true" tabindex="-1"></a>https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#2-fractional-logistic-regression</span>
<span id="cb746-1355"><a href="#cb746-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1356"><a href="#cb746-1356" aria-hidden="true" tabindex="-1"></a>**TODO** </span>
<span id="cb746-1357"><a href="#cb746-1357" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>explore priors</span>
<span id="cb746-1358"><a href="#cb746-1358" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>explore random effects</span>
<span id="cb746-1359"><a href="#cb746-1359" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>explore non-beta distribution; once the 1s and zeros are gone, do we need the beta? </span>
<span id="cb746-1360"><a href="#cb746-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1361"><a href="#cb746-1361" aria-hidden="true" tabindex="-1"></a>A zero-inflated beta regression allows us to model a separate data generating process for the 0s and 1s and the rest.</span>
<span id="cb746-1362"><a href="#cb746-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1363"><a href="#cb746-1363" aria-hidden="true" tabindex="-1"></a>A ZOINB is a mixture of:</span>
<span id="cb746-1364"><a href="#cb746-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1365"><a href="#cb746-1365" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>A logistic regression model that predicts if an outcome is either 0 or 1 or not 0 or 1, defined by (or alternatively, a model that predicts if outcomes are extreme (0 or 1) or not (between 0 and 1); "IS EXTREME" model; defined by $\alpha$</span>
<span id="cb746-1366"><a href="#cb746-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1367"><a href="#cb746-1367" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>A logistic regression model that predicts if any of the 0 or 1 outcomes are actually 1s, defined by (or alternatively, a model that predicts if the extreme values are 1) "WHICH EXTREME" model defined by $\gamma$</span>
<span id="cb746-1368"><a href="#cb746-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1369"><a href="#cb746-1369" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>A beta regression model that predicts if an outcome is between 0 and 1 if it's not zero or not one, defined by and (or alternatively, a model that predicts the non-extreme (0 or 1) values) "THE REST" model $\mu$ and $\phi$</span>
<span id="cb746-1370"><a href="#cb746-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1371"><a href="#cb746-1371" aria-hidden="true" tabindex="-1"></a>Can also do mixed! (but no reason do this here, as the item level data is not beta reg )</span>
<span id="cb746-1372"><a href="#cb746-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1375"><a href="#cb746-1375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1376"><a href="#cb746-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#DATA SETUP</span></span>
<span id="cb746-1377"><a href="#cb746-1377" aria-hidden="true" tabindex="-1"></a><span class="co"># sub &lt;- df_subjects %&gt;% dplyr::select(condition, DV_percent_NABS) </span></span>
<span id="cb746-1378"><a href="#cb746-1378" aria-hidden="true" tabindex="-1"></a><span class="co"># don't need to transform anymore</span></span>
<span id="cb746-1379"><a href="#cb746-1379" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1380"><a href="#cb746-1380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb746-1381"><a href="#cb746-1381" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> pretty_condition,</span>
<span id="cb746-1382"><a href="#cb746-1382" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaled =</span> (s_SCALED <span class="sc">+</span> <span class="dv">13</span>)<span class="sc">/</span><span class="dv">26</span>,  <span class="co">#transform scaled onto 0-1 scale</span></span>
<span id="cb746-1383"><a href="#cb746-1383" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> item_test_NABS<span class="sc">/</span><span class="dv">8</span></span>
<span id="cb746-1384"><a href="#cb746-1384" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, scaled, accuracy)</span>
<span id="cb746-1385"><a href="#cb746-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1386"><a href="#cb746-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1387"><a href="#cb746-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERCEPT ONLY model for alpha</span></span>
<span id="cb746-1388"><a href="#cb746-1388" aria-hidden="true" tabindex="-1"></a>zoinb <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb746-1389"><a href="#cb746-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(accuracy <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb746-1390"><a href="#cb746-1390" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb746-1391"><a href="#cb746-1391" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition, <span class="co">#is extreme? alpha</span></span>
<span id="cb746-1392"><a href="#cb746-1392" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition), <span class="co">#is 1? gamma</span></span>
<span id="cb746-1393"><a href="#cb746-1393" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb746-1394"><a href="#cb746-1394" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb746-1395"><a href="#cb746-1395" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb746-1396"><a href="#cb746-1396" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb746-1397"><a href="#cb746-1397" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span></span>
<span id="cb746-1398"><a href="#cb746-1398" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-1399"><a href="#cb746-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1400"><a href="#cb746-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1401"><a href="#cb746-1401" aria-hidden="true" tabindex="-1"></a>zoinb_scaled <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb746-1402"><a href="#cb746-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(scaled <span class="sc">~</span> condition, <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb746-1403"><a href="#cb746-1403" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition, <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb746-1404"><a href="#cb746-1404" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition, <span class="co">#is extreme? alpha</span></span>
<span id="cb746-1405"><a href="#cb746-1405" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition), <span class="co">#is 1? gamma</span></span>
<span id="cb746-1406"><a href="#cb746-1406" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb746-1407"><a href="#cb746-1407" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb746-1408"><a href="#cb746-1408" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb746-1409"><a href="#cb746-1409" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb746-1410"><a href="#cb746-1410" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span></span>
<span id="cb746-1411"><a href="#cb746-1411" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-1412"><a href="#cb746-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1413"><a href="#cb746-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1416"><a href="#cb746-1416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1417"><a href="#cb746-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zoinb)</span>
<span id="cb746-1418"><a href="#cb746-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1419"><a href="#cb746-1419" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(zoinb))</span>
<span id="cb746-1420"><a href="#cb746-1420" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb)</span>
<span id="cb746-1421"><a href="#cb746-1421" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(zoinb_scaled))</span>
<span id="cb746-1422"><a href="#cb746-1422" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb_scaled)</span>
<span id="cb746-1423"><a href="#cb746-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1424"><a href="#cb746-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1425"><a href="#cb746-1425" aria-hidden="true" tabindex="-1"></a>More plots </span>
<span id="cb746-1426"><a href="#cb746-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1429"><a href="#cb746-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1430"><a href="#cb746-1430" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(zoinb, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb746-1431"><a href="#cb746-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1432"><a href="#cb746-1432" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"INTERPRET ALPHA"</span>)</span>
<span id="cb746-1433"><a href="#cb746-1433" aria-hidden="true" tabindex="-1"></a>zoi_intercept <span class="ot">&lt;-</span> <span class="fu">tidy</span>(zoinb, <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1434"><a href="#cb746-1434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">"cond"</span>, term <span class="sc">==</span> <span class="st">"zoi_(Intercept)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1435"><a href="#cb746-1435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb746-1436"><a href="#cb746-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1437"><a href="#cb746-1437" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit scale intercept</span></span>
<span id="cb746-1438"><a href="#cb746-1438" aria-hidden="true" tabindex="-1"></a>zoi_intercept</span>
<span id="cb746-1439"><a href="#cb746-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1440"><a href="#cb746-1440" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformed to a probability/proportion</span></span>
<span id="cb746-1441"><a href="#cb746-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(zoi_intercept)</span>
<span id="cb746-1442"><a href="#cb746-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1443"><a href="#cb746-1443" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(accuracy <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">&amp;</span> condition <span class="sc">==</span> <span class="st">"control"</span>))<span class="sc">/</span><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"control"</span>))</span>
<span id="cb746-1444"><a href="#cb746-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1445"><a href="#cb746-1445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1446"><a href="#cb746-1446" aria-hidden="true" tabindex="-1"></a>The value of the zoi_intercept should be the same as the proportion of 0s and 1s (vs non 0s and 1s) in the control condition... and it does!</span>
<span id="cb746-1447"><a href="#cb746-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1448"><a href="#cb746-1448" aria-hidden="true" tabindex="-1"></a>VISUALIZE ZERO INFLATED COMPONENT</span>
<span id="cb746-1451"><a href="#cb746-1451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1452"><a href="#cb746-1452" aria-hidden="true" tabindex="-1"></a>beta_zoi_pred_int <span class="ot">&lt;-</span> zoinb <span class="sc">%&gt;%</span> </span>
<span id="cb746-1453"><a href="#cb746-1453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1454"><a href="#cb746-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_extreme =</span> .prediction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb746-1455"><a href="#cb746-1455" aria-hidden="true" tabindex="-1"></a>         <span class="at">is_one =</span> .prediction <span class="sc">==</span><span class="dv">1</span>, </span>
<span id="cb746-1456"><a href="#cb746-1456" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_extreme <span class="sc">&amp;</span> <span class="sc">!</span>is_one, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction),</span>
<span id="cb746-1457"><a href="#cb746-1457" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_one, .prediction <span class="sc">+</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb746-1458"><a href="#cb746-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1459"><a href="#cb746-1459" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zoi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb746-1460"><a href="#cb746-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_extreme), <span class="at">binwidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb746-1461"><a href="#cb746-1461" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb746-1462"><a href="#cb746-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb746-1463"><a href="#cb746-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-1464"><a href="#cb746-1464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb746-1465"><a href="#cb746-1465" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb746-1466"><a href="#cb746-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb746-1467"><a href="#cb746-1467" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is extreme?"</span>) <span class="sc">+</span></span>
<span id="cb746-1468"><a href="#cb746-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb746-1469"><a href="#cb746-1469" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb746-1470"><a href="#cb746-1470" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb746-1471"><a href="#cb746-1471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-1472"><a href="#cb746-1472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb746-1473"><a href="#cb746-1473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1476"><a href="#cb746-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1477"><a href="#cb746-1477" aria-hidden="true" tabindex="-1"></a>beta_zoi_pred_int <span class="ot">&lt;-</span> zoinb_scaled <span class="sc">%&gt;%</span> </span>
<span id="cb746-1478"><a href="#cb746-1478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predicted_draws</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1479"><a href="#cb746-1479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_extreme =</span> .prediction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb746-1480"><a href="#cb746-1480" aria-hidden="true" tabindex="-1"></a>         <span class="at">is_one =</span> .prediction <span class="sc">==</span><span class="dv">1</span>, </span>
<span id="cb746-1481"><a href="#cb746-1481" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_extreme <span class="sc">&amp;</span> <span class="sc">!</span>is_one, .prediction <span class="sc">-</span> <span class="fl">0.01</span>, .prediction),</span>
<span id="cb746-1482"><a href="#cb746-1482" aria-hidden="true" tabindex="-1"></a>         <span class="at">.prediction =</span> <span class="fu">ifelse</span>(is_one, .prediction <span class="sc">+</span> <span class="fl">0.01</span>, .prediction))</span>
<span id="cb746-1483"><a href="#cb746-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1484"><a href="#cb746-1484" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beta_zoi_pred_int, <span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb746-1485"><a href="#cb746-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_extreme), <span class="at">binwidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb746-1486"><a href="#cb746-1486" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb746-1487"><a href="#cb746-1487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb746-1488"><a href="#cb746-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-1489"><a href="#cb746-1489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> <span class="fl">0.5</span>,</span>
<span id="cb746-1490"><a href="#cb746-1490" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb746-1491"><a href="#cb746-1491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted proportion of Correct Responses"</span>, </span>
<span id="cb746-1492"><a href="#cb746-1492" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Is extreme?"</span>) <span class="sc">+</span></span>
<span id="cb746-1493"><a href="#cb746-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(condition), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb746-1494"><a href="#cb746-1494" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">control</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Control"</span>, </span>
<span id="cb746-1495"><a href="#cb746-1495" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">impasse</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Impasse"</span>))) <span class="sc">+</span> </span>
<span id="cb746-1496"><a href="#cb746-1496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb746-1497"><a href="#cb746-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb746-1498"><a href="#cb746-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1499"><a href="#cb746-1499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1500"><a href="#cb746-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1501"><a href="#cb746-1501" aria-hidden="true" tabindex="-1"></a><span class="fu">### ZOINF NEG BINOM?</span></span>
<span id="cb746-1502"><a href="#cb746-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1503"><a href="#cb746-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1504"><a href="#cb746-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1505"><a href="#cb746-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">### MIXED ZERO-ONE-INFLATED BETA Regression</span></span>
<span id="cb746-1506"><a href="#cb746-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1507"><a href="#cb746-1507" aria-hidden="true" tabindex="-1"></a>Next we'll explore doing a beta regression on a proportion transformed scaled score at the item level, as a zero one inflated mixed beta reg </span>
<span id="cb746-1510"><a href="#cb746-1510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1511"><a href="#cb746-1511" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1512"><a href="#cb746-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1513"><a href="#cb746-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scaled =</span> (score_SCALED <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb746-1514"><a href="#cb746-1514" aria-hidden="true" tabindex="-1"></a>         <span class="at">condition =</span> pretty_condition) <span class="sc">%&gt;%</span> </span>
<span id="cb746-1515"><a href="#cb746-1515" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(subject, scaled, condition)</span>
<span id="cb746-1516"><a href="#cb746-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1517"><a href="#cb746-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1518"><a href="#cb746-1518" aria-hidden="true" tabindex="-1"></a>zoinb_scaled <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb746-1519"><a href="#cb746-1519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(scaled <span class="sc">~</span> condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) , <span class="co">#mean of (0,1) values, mu</span></span>
<span id="cb746-1520"><a href="#cb746-1520" aria-hidden="true" tabindex="-1"></a>     phi <span class="sc">~</span> condition , <span class="co">#precision of (0,1) values, phi</span></span>
<span id="cb746-1521"><a href="#cb746-1521" aria-hidden="true" tabindex="-1"></a>     zoi <span class="sc">~</span> condition , <span class="co">#is extreme? alpha</span></span>
<span id="cb746-1522"><a href="#cb746-1522" aria-hidden="true" tabindex="-1"></a>     coi <span class="sc">~</span> condition ), <span class="co">#is 1? gamma</span></span>
<span id="cb746-1523"><a href="#cb746-1523" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb746-1524"><a href="#cb746-1524" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb746-1525"><a href="#cb746-1525" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb746-1526"><a href="#cb746-1526" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb746-1527"><a href="#cb746-1527" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span></span>
<span id="cb746-1528"><a href="#cb746-1528" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-1529"><a href="#cb746-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1530"><a href="#cb746-1530" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zoinb_scaled)</span>
<span id="cb746-1531"><a href="#cb746-1531" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(zoinb_scaled)</span>
<span id="cb746-1532"><a href="#cb746-1532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1533"><a href="#cb746-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1534"><a href="#cb746-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1535"><a href="#cb746-1535" aria-hidden="true" tabindex="-1"></a><span class="fu">### BETA HURDLE Regression (Frequentist)</span></span>
<span id="cb746-1536"><a href="#cb746-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1537"><a href="#cb746-1537" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf&gt;</span></span>
<span id="cb746-1538"><a href="#cb746-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1539"><a href="#cb746-1539" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MU tells if mean is different by condition</span>
<span id="cb746-1540"><a href="#cb746-1540" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SIGMA tells if variance is different by condition</span>
<span id="cb746-1541"><a href="#cb746-1541" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NU coefficient tells if condition yields different probability at floor</span>
<span id="cb746-1542"><a href="#cb746-1542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAU coefficient tells if condition yields different probability at ceiling</span>
<span id="cb746-1543"><a href="#cb746-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1546"><a href="#cb746-1546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1547"><a href="#cb746-1547" aria-hidden="true" tabindex="-1"></a><span class="co">#BETA HURDLE REGRESSION EXAMPLE</span></span>
<span id="cb746-1548"><a href="#cb746-1548" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span>
<span id="cb746-1549"><a href="#cb746-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1550"><a href="#cb746-1550" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE SAMPLE DATA </span></span>
<span id="cb746-1551"><a href="#cb746-1551" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> </span>
<span id="cb746-1552"><a href="#cb746-1552" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">0.40</span> </span>
<span id="cb746-1553"><a href="#cb746-1553" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.60</span> </span>
<span id="cb746-1554"><a href="#cb746-1554" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.13</span> </span>
<span id="cb746-1555"><a href="#cb746-1555" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.17</span> </span>
<span id="cb746-1556"><a href="#cb746-1556" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> p0<span class="sc">-</span> p1</span>
<span id="cb746-1557"><a href="#cb746-1557" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> mu <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> sigma <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> (sigma <span class="sc">^</span> <span class="dv">2</span>) </span>
<span id="cb746-1558"><a href="#cb746-1558" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> mu) <span class="sc">/</span> mu</span>
<span id="cb746-1559"><a href="#cb746-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1560"><a href="#cb746-1560" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE DIST</span></span>
<span id="cb746-1561"><a href="#cb746-1561" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1839</span>) </span>
<span id="cb746-1562"><a href="#cb746-1562" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, a, b) </span>
<span id="cb746-1563"><a href="#cb746-1563" aria-hidden="true" tabindex="-1"></a>cat <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, n, <span class="at">prob =</span> <span class="fu">c</span>(p0, p2, p1), <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb746-1564"><a href="#cb746-1564" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb746-1565"><a href="#cb746-1565" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb746-1566"><a href="#cb746-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1567"><a href="#cb746-1567" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb746-1568"><a href="#cb746-1568" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y)</span>
<span id="cb746-1569"><a href="#cb746-1569" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>x<span class="sc">$</span>y)</span>
<span id="cb746-1570"><a href="#cb746-1570" aria-hidden="true" tabindex="-1"></a><span class="co">#this looks not unlike my distribution! </span></span>
<span id="cb746-1571"><a href="#cb746-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1572"><a href="#cb746-1572" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb746-1573"><a href="#cb746-1573" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb746-1574"><a href="#cb746-1574" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.sigma =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb746-1575"><a href="#cb746-1575" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.nu =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb746-1576"><a href="#cb746-1576" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.tau =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb746-1577"><a href="#cb746-1577" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">BEINF</span>() )</span>
<span id="cb746-1578"><a href="#cb746-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1579"><a href="#cb746-1579" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb746-1580"><a href="#cb746-1580" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span>
<span id="cb746-1581"><a href="#cb746-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1582"><a href="#cb746-1582" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb746-1583"><a href="#cb746-1583" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb746-1584"><a href="#cb746-1584" aria-hidden="true" tabindex="-1"></a>fit_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>mu.coefficients) </span>
<span id="cb746-1585"><a href="#cb746-1585" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,fit_mu)</span>
<span id="cb746-1586"><a href="#cb746-1586" aria-hidden="true" tabindex="-1"></a>fit_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb746-1587"><a href="#cb746-1587" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,fit_sigma)</span>
<span id="cb746-1588"><a href="#cb746-1588" aria-hidden="true" tabindex="-1"></a>fit_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>nu.coefficients) </span>
<span id="cb746-1589"><a href="#cb746-1589" aria-hidden="true" tabindex="-1"></a>fit_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>tau.coefficients) </span>
<span id="cb746-1590"><a href="#cb746-1590" aria-hidden="true" tabindex="-1"></a>fit_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb746-1591"><a href="#cb746-1591" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,fit_p0)</span>
<span id="cb746-1592"><a href="#cb746-1592" aria-hidden="true" tabindex="-1"></a>fit_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb746-1593"><a href="#cb746-1593" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,fit_p1)</span>
<span id="cb746-1594"><a href="#cb746-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1595"><a href="#cb746-1595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1596"><a href="#cb746-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1597"><a href="#cb746-1597" aria-hidden="true" tabindex="-1"></a>**BETA HURDLE INTERPRETATION** - beta component\</span>
<span id="cb746-1598"><a href="#cb746-1598" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MU "location" (mean)\</span>
<span id="cb746-1599"><a href="#cb746-1599" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SIGMA "scale" (positively related to variance; variance = sigma.squared *mean* (1-mean)\</span>
<span id="cb746-1600"><a href="#cb746-1600" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rigby, Stasinopoulos, Heller, and De Bastiani (2017) "reparameterized" the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</span>
<span id="cb746-1601"><a href="#cb746-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1602"><a href="#cb746-1602" aria-hidden="true" tabindex="-1"></a>**ZERO-ONE HURDLE COMPONENT**\</span>
<span id="cb746-1603"><a href="#cb746-1603" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.\</span>
<span id="cb746-1604"><a href="#cb746-1604" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p0 is the probability that a case equals 0,\</span>
<span id="cb746-1605"><a href="#cb746-1605" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p1 is the probability that a case equals 1,\</span>
<span id="cb746-1606"><a href="#cb746-1606" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</span>
<span id="cb746-1607"><a href="#cb746-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1610"><a href="#cb746-1610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1611"><a href="#cb746-1611" aria-hidden="true" tabindex="-1"></a><span class="co">#MY DATA</span></span>
<span id="cb746-1612"><a href="#cb746-1612" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb746-1613"><a href="#cb746-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1614"><a href="#cb746-1614" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> <span class="dv">0</span> <span class="co">#min possible value of scale</span></span>
<span id="cb746-1615"><a href="#cb746-1615" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="dv">13</span> <span class="co">#max possible value of scale</span></span>
<span id="cb746-1616"><a href="#cb746-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1617"><a href="#cb746-1617" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#for shuffling</span></span>
<span id="cb746-1618"><a href="#cb746-1618" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Rescale accuracy using </span></span>
<span id="cb746-1619"><a href="#cb746-1619" aria-hidden="true" tabindex="-1"></a><span class="co"># recommended adjustment </span></span>
<span id="cb746-1620"><a href="#cb746-1620" aria-hidden="true" tabindex="-1"></a><span class="co">#rescaled = value-min/(max-min)</span></span>
<span id="cb746-1621"><a href="#cb746-1621" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb746-1622"><a href="#cb746-1622" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> s_NABS,</span>
<span id="cb746-1623"><a href="#cb746-1623" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_acc =</span> (accuracy<span class="sc">-</span>min)<span class="sc">/</span>(max<span class="sc">-</span>min), <span class="co">#as %</span></span>
<span id="cb746-1624"><a href="#cb746-1624" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_acc =</span> (accuracy <span class="sc">*</span> (<span class="fu">nrow</span>(df)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fu">nrow</span>(df)<span class="sc">/</span>max, <span class="co">#transform for no 0 and 1</span></span>
<span id="cb746-1625"><a href="#cb746-1625" aria-hidden="true" tabindex="-1"></a>  <span class="co"># perm = shuffle(condition),</span></span>
<span id="cb746-1626"><a href="#cb746-1626" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_rt =</span> item_scaffold_rt</span>
<span id="cb746-1627"><a href="#cb746-1627" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy,R_acc, T_acc, condition,scaffold_rt)</span>
<span id="cb746-1628"><a href="#cb746-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1629"><a href="#cb746-1629" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb746-1630"><a href="#cb746-1630" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of accuracy"</span>)</span>
<span id="cb746-1631"><a href="#cb746-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1632"><a href="#cb746-1632" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb746-1633"><a href="#cb746-1633" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>T_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of [rescaled] accuracy"</span>)</span>
<span id="cb746-1634"><a href="#cb746-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1635"><a href="#cb746-1635" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_histogram(~R_acc, fill = ~perm, data = df) %&gt;% gf_facet_wrap(~perm) + labs(title = "Histogram of shuffled accuracy")</span></span>
<span id="cb746-1636"><a href="#cb746-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1637"><a href="#cb746-1637" aria-hidden="true" tabindex="-1"></a><span class="co">#SUMMARIZE SAMPLE</span></span>
<span id="cb746-1638"><a href="#cb746-1638" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Grand mean"</span>, <span class="fu">mean</span>(df<span class="sc">$</span>R_acc))</span>
<span id="cb746-1639"><a href="#cb746-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1640"><a href="#cb746-1640" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb746-1641"><a href="#cb746-1641" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> <span class="fu">favstats</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb746-1642"><a href="#cb746-1642" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb746-1643"><a href="#cb746-1643" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">var</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb746-1644"><a href="#cb746-1644" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Grand stats"</span>)</span>
<span id="cb746-1645"><a href="#cb746-1645" aria-hidden="true" tabindex="-1"></a>stats </span>
<span id="cb746-1646"><a href="#cb746-1646" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P0"</span>)</span>
<span id="cb746-1647"><a href="#cb746-1647" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">0</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb746-1648"><a href="#cb746-1648" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P1"</span>)</span>
<span id="cb746-1649"><a href="#cb746-1649" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">1</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb746-1650"><a href="#cb746-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1651"><a href="#cb746-1651" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb746-1652"><a href="#cb746-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1653"><a href="#cb746-1653" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb746-1654"><a href="#cb746-1654" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb746-1655"><a href="#cb746-1655" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.sigma =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb746-1656"><a href="#cb746-1656" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.nu =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb746-1657"><a href="#cb746-1657" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.tau =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb746-1658"><a href="#cb746-1658" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">BEINF</span>(), <span class="at">data =</span> df )</span>
<span id="cb746-1659"><a href="#cb746-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1660"><a href="#cb746-1660" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb746-1661"><a href="#cb746-1661" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb746-1662"><a href="#cb746-1662" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE EMPTY MODEL"</span>)</span>
<span id="cb746-1663"><a href="#cb746-1663" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb746-1664"><a href="#cb746-1664" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m0)</span>
<span id="cb746-1665"><a href="#cb746-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1666"><a href="#cb746-1666" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb746-1667"><a href="#cb746-1667" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb746-1668"><a href="#cb746-1668" aria-hidden="true" tabindex="-1"></a>m0_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>mu.coefficients) </span>
<span id="cb746-1669"><a href="#cb746-1669" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m0_mu)</span>
<span id="cb746-1670"><a href="#cb746-1670" aria-hidden="true" tabindex="-1"></a>m0_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb746-1671"><a href="#cb746-1671" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m0_sigma)</span>
<span id="cb746-1672"><a href="#cb746-1672" aria-hidden="true" tabindex="-1"></a>m0_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>nu.coefficients) </span>
<span id="cb746-1673"><a href="#cb746-1673" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m0_nu)</span>
<span id="cb746-1674"><a href="#cb746-1674" aria-hidden="true" tabindex="-1"></a>m0_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>tau.coefficients) </span>
<span id="cb746-1675"><a href="#cb746-1675" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m0_tau)</span>
<span id="cb746-1676"><a href="#cb746-1676" aria-hidden="true" tabindex="-1"></a>m0_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb746-1677"><a href="#cb746-1677" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,m0_p0)</span>
<span id="cb746-1678"><a href="#cb746-1678" aria-hidden="true" tabindex="-1"></a>m0_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb746-1679"><a href="#cb746-1679" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,m0_p1)</span>
<span id="cb746-1680"><a href="#cb746-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1681"><a href="#cb746-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1682"><a href="#cb746-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1683"><a href="#cb746-1683" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL</span></span>
<span id="cb746-1684"><a href="#cb746-1684" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition, </span>
<span id="cb746-1685"><a href="#cb746-1685" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb746-1686"><a href="#cb746-1686" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb746-1687"><a href="#cb746-1687" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span> condition, </span>
<span id="cb746-1688"><a href="#cb746-1688" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb746-1689"><a href="#cb746-1689" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE PREDICTOR MODEL"</span>)</span>
<span id="cb746-1690"><a href="#cb746-1690" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb746-1691"><a href="#cb746-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1692"><a href="#cb746-1692" aria-hidden="true" tabindex="-1"></a><span class="co">#LOOKING PREDICTOR MODEL</span></span>
<span id="cb746-1693"><a href="#cb746-1693" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition , </span>
<span id="cb746-1694"><a href="#cb746-1694" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb746-1695"><a href="#cb746-1695" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb746-1696"><a href="#cb746-1696" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb746-1697"><a href="#cb746-1697" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb746-1698"><a href="#cb746-1698" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"THE PREDICTOR MODEL"</span>)</span>
<span id="cb746-1699"><a href="#cb746-1699" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb746-1700"><a href="#cb746-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1701"><a href="#cb746-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1702"><a href="#cb746-1702" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION </span><span class="al">TEST</span><span class="co">]</span></span>
<span id="cb746-1703"><a href="#cb746-1703" aria-hidden="true" tabindex="-1"></a><span class="co"># mperm &lt;- gamlss(R_acc ~ perm, ~ perm, ~ perm, ~ perm, </span></span>
<span id="cb746-1704"><a href="#cb746-1704" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, family = BEINF())</span></span>
<span id="cb746-1705"><a href="#cb746-1705" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mperm)</span></span>
<span id="cb746-1706"><a href="#cb746-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1707"><a href="#cb746-1707" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check with scaled outcome, no zeros ones</span></span>
<span id="cb746-1708"><a href="#cb746-1708" aria-hidden="true" tabindex="-1"></a><span class="co"># m3 &lt;- gamlss(T_acc ~ condition, ~ condition, ~ condition, ~ condition, </span></span>
<span id="cb746-1709"><a href="#cb746-1709" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, family = BEINF())</span></span>
<span id="cb746-1710"><a href="#cb746-1710" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m3)</span></span>
<span id="cb746-1711"><a href="#cb746-1711" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span></span>
<span id="cb746-1712"><a href="#cb746-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1713"><a href="#cb746-1713" aria-hidden="true" tabindex="-1"></a><span class="co">#investigate beta negative binomial distribution</span></span>
<span id="cb746-1714"><a href="#cb746-1714" aria-hidden="true" tabindex="-1"></a><span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span></span>
<span id="cb746-1715"><a href="#cb746-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1716"><a href="#cb746-1716" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb746-1717"><a href="#cb746-1717" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb746-1718"><a href="#cb746-1718" aria-hidden="true" tabindex="-1"></a>m1_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m1<span class="sc">$</span>mu.coefficients) </span>
<span id="cb746-1719"><a href="#cb746-1719" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m1_mu)</span>
<span id="cb746-1720"><a href="#cb746-1720" aria-hidden="true" tabindex="-1"></a>m1_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb746-1721"><a href="#cb746-1721" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m1_sigma)</span>
<span id="cb746-1722"><a href="#cb746-1722" aria-hidden="true" tabindex="-1"></a>m1_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>nu.coefficients) </span>
<span id="cb746-1723"><a href="#cb746-1723" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m1_nu)</span>
<span id="cb746-1724"><a href="#cb746-1724" aria-hidden="true" tabindex="-1"></a>m1_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>tau.coefficients) </span>
<span id="cb746-1725"><a href="#cb746-1725" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m1_tau)</span>
<span id="cb746-1726"><a href="#cb746-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1727"><a href="#cb746-1727" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb746-1728"><a href="#cb746-1728" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span>
<span id="cb746-1729"><a href="#cb746-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1730"><a href="#cb746-1730" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1731"><a href="#cb746-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1732"><a href="#cb746-1732" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MU tells if mean is different by condition</span>
<span id="cb746-1733"><a href="#cb746-1733" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SIGMA tells if variance is different by condition</span>
<span id="cb746-1734"><a href="#cb746-1734" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NU coefficient tells if condition yields different probability at floor</span>
<span id="cb746-1735"><a href="#cb746-1735" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAU coefficient tells if condition yields different probability at ceiling</span>
<span id="cb746-1736"><a href="#cb746-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1737"><a href="#cb746-1737" aria-hidden="true" tabindex="-1"></a><span class="fu">## BINOMIAL OUTCOME</span></span>
<span id="cb746-1738"><a href="#cb746-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1741"><a href="#cb746-1741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1742"><a href="#cb746-1742" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1-ACCURACY</span></span>
<span id="cb746-1743"><a href="#cb746-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1744"><a href="#cb746-1744" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb746-1745"><a href="#cb746-1745" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb746-1746"><a href="#cb746-1746" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% mutate(</span></span>
<span id="cb746-1747"><a href="#cb746-1747" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = recode_factor(score_niceABS, "0" ="incorrect","1"="correct"),</span></span>
<span id="cb746-1748"><a href="#cb746-1748" aria-hidden="true" tabindex="-1"></a><span class="co">#   scaled = as.ordered(score_SCALED),</span></span>
<span id="cb746-1749"><a href="#cb746-1749" aria-hidden="true" tabindex="-1"></a><span class="co">#   q = as.factor(q),</span></span>
<span id="cb746-1750"><a href="#cb746-1750" aria-hidden="true" tabindex="-1"></a><span class="co">#   high_interpretation = as.factor(high_interpretation)</span></span>
<span id="cb746-1751"><a href="#cb746-1751" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb746-1752"><a href="#cb746-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1753"><a href="#cb746-1753" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb746-1754"><a href="#cb746-1754" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb746-1755"><a href="#cb746-1755" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df) <span class="sc">%&gt;%</span></span>
<span id="cb746-1756"><a href="#cb746-1756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb746-1757"><a href="#cb746-1757" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Question 1 Accuracy"</span>,</span>
<span id="cb746-1758"><a href="#cb746-1758" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Q1"</span>,</span>
<span id="cb746-1759"><a href="#cb746-1759" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb746-1760"><a href="#cb746-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1761"><a href="#cb746-1761" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb746-1762"><a href="#cb746-1762" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb746-1763"><a href="#cb746-1763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb746-1764"><a href="#cb746-1764" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb746-1765"><a href="#cb746-1765" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb746-1766"><a href="#cb746-1766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb746-1767"><a href="#cb746-1767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb746-1768"><a href="#cb746-1768" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb746-1769"><a href="#cb746-1769" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb746-1770"><a href="#cb746-1770" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb746-1771"><a href="#cb746-1771" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb746-1772"><a href="#cb746-1772" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb746-1773"><a href="#cb746-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1774"><a href="#cb746-1774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1775"><a href="#cb746-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1776"><a href="#cb746-1776" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CHI SQUARE</span></span>
<span id="cb746-1777"><a href="#cb746-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1780"><a href="#cb746-1780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1781"><a href="#cb746-1781" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-Q1</span></span>
<span id="cb746-1782"><a href="#cb746-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1783"><a href="#cb746-1783" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::CROSSTABLE</span></span>
<span id="cb746-1784"><a href="#cb746-1784" aria-hidden="true" tabindex="-1"></a><span class="co"># CrossTable( x = df$condition, y = df$accuracy, </span></span>
<span id="cb746-1785"><a href="#cb746-1785" aria-hidden="true" tabindex="-1"></a><span class="co">#              fisher = TRUE, chisq=TRUE, expected = TRUE, sresid = TRUE)</span></span>
<span id="cb746-1786"><a href="#cb746-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1787"><a href="#cb746-1787" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::MOSAIC PLOT</span></span>
<span id="cb746-1788"><a href="#cb746-1788" aria-hidden="true" tabindex="-1"></a><span class="co"># note: blue indicates cell count higher than expected, </span></span>
<span id="cb746-1789"><a href="#cb746-1789" aria-hidden="true" tabindex="-1"></a><span class="co"># red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb746-1790"><a href="#cb746-1790" aria-hidden="true" tabindex="-1"></a><span class="co"># mosaicplot(main="Accuracy on First Question by Condition",</span></span>
<span id="cb746-1791"><a href="#cb746-1791" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = df, pretty_condition ~ accuracy, </span></span>
<span id="cb746-1792"><a href="#cb746-1792" aria-hidden="true" tabindex="-1"></a><span class="co">#             shade = T)</span></span>
<span id="cb746-1793"><a href="#cb746-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1794"><a href="#cb746-1794" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::TABLE</span></span>
<span id="cb746-1795"><a href="#cb746-1795" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">sjtab</span>( <span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb746-1796"><a href="#cb746-1796" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>F, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb746-1797"><a href="#cb746-1797" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="fu">c</span>(<span class="st">"auto"</span>))</span>
<span id="cb746-1798"><a href="#cb746-1798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1799"><a href="#cb746-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1800"><a href="#cb746-1800" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::BAR PLOT</span></span>
<span id="cb746-1801"><a href="#cb746-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> condition,</span>
<span id="cb746-1802"><a href="#cb746-1802" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span>
<span id="cb746-1803"><a href="#cb746-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1804"><a href="#cb746-1804" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::CHISQR </span><span class="al">TEST</span></span>
<span id="cb746-1805"><a href="#cb746-1805" aria-hidden="true" tabindex="-1"></a>(x <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">chisq.test</span>(<span class="at">x =</span> df<span class="sc">$</span>accuracy, <span class="at">y =</span> df<span class="sc">$</span>condition, <span class="at">simulate.p.value =</span> T))</span>
<span id="cb746-1806"><a href="#cb746-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1807"><a href="#cb746-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1808"><a href="#cb746-1808" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::POWER ANALYSIS</span></span>
<span id="cb746-1809"><a href="#cb746-1809" aria-hidden="true" tabindex="-1"></a>(po <span class="ot">&lt;-</span> <span class="fu">pwr.chisq.test</span>( <span class="at">w =</span> <span class="fl">0.1</span>, <span class="at">df=</span>(<span class="dv">2-1</span>), <span class="at">N =</span> <span class="fu">nrow</span>(df), <span class="at">sig.level =</span> <span class="fl">0.05</span>))</span>
<span id="cb746-1810"><a href="#cb746-1810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1811"><a href="#cb746-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1812"><a href="#cb746-1812" aria-hidden="true" tabindex="-1"></a>**A Chi-Square test of independence of Q1 accuracy \[correct,incorrect\] by condition indicates the question accuracy is not dependent on condition. *However, this test may be underpowered, as with the given sample size it has only 20% power to detect a small effect (w = 0.1)***</span>
<span id="cb746-1813"><a href="#cb746-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1814"><a href="#cb746-1814" aria-hidden="true" tabindex="-1"></a><span class="fu">### LOGISTIC REGRESSION</span></span>
<span id="cb746-1815"><a href="#cb746-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1816"><a href="#cb746-1816" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>http://post8000.svmiller.com/lab-scripts/logistic-regression-lab.html</span>
<span id="cb746-1817"><a href="#cb746-1817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1818"><a href="#cb746-1818" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression (at the subject-item level), predicting Q1 accuracy (absolute score) by condition.*\</span>
<span id="cb746-1819"><a href="#cb746-1819" aria-hidden="true" tabindex="-1"></a>*note: this example uses the combined dataset rather than lab-only, as learning notes were done with the combined and I don't want to recalcualte all the marginal probabilities by hand for learning purposes.*</span>
<span id="cb746-1820"><a href="#cb746-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1821"><a href="#cb746-1821" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fit a logistic regression predicting accuracy (absolute score) (n = r nrow(df)) by condition. (k = 2).</span>
<span id="cb746-1822"><a href="#cb746-1822" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{0}$ = Log Odds of (correct) responses in CONTROL condition</span>
<span id="cb746-1823"><a href="#cb746-1823" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{0}}$ = ODDS of correct response in CONTROL condition</span>
<span id="cb746-1824"><a href="#cb746-1824" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{1}$ = $\beta_{1impasse}$ Log Odds (Log OR; change in odds for correct response in impasse (vs) control <span class="sc">\[</span>log scale<span class="sc">\]</span>)</span>
<span id="cb746-1825"><a href="#cb746-1825" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{1}}$ = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</span>
<span id="cb746-1826"><a href="#cb746-1826" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis:$\beta_{impasse} \le 0$ the odds for a correct response does not change, or decreases</span>
<span id="cb746-1827"><a href="#cb746-1827" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative hypothesis: $\beta_{impasse} \gt 0$ the odds of a correct response increases</span>
<span id="cb746-1828"><a href="#cb746-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1829"><a href="#cb746-1829" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb746-1830"><a href="#cb746-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1831"><a href="#cb746-1831" aria-hidden="true" tabindex="-1"></a>*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*</span>
<span id="cb746-1832"><a href="#cb746-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1835"><a href="#cb746-1835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1836"><a href="#cb746-1836" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-Q1ACC-LOG-combined</span></span>
<span id="cb746-1837"><a href="#cb746-1837" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb746-1838"><a href="#cb746-1838" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb746-1839"><a href="#cb746-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1840"><a href="#cb746-1840" aria-hidden="true" tabindex="-1"></a><span class="co">#combined dataset, not lab only</span></span>
<span id="cb746-1841"><a href="#cb746-1841" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb746-1842"><a href="#cb746-1842" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS)</span>
<span id="cb746-1843"><a href="#cb746-1843" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-1844"><a href="#cb746-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1845"><a href="#cb746-1845" aria-hidden="true" tabindex="-1"></a><span class="co"># FREQUENCY TABLE</span></span>
<span id="cb746-1846"><a href="#cb746-1846" aria-hidden="true" tabindex="-1"></a><span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span></span>
<span id="cb746-1847"><a href="#cb746-1847" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(my.table) #counts</span></span>
<span id="cb746-1848"><a href="#cb746-1848" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(prop.table(my.table)) #props</span></span>
<span id="cb746-1849"><a href="#cb746-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1850"><a href="#cb746-1850" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb746-1851"><a href="#cb746-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1852"><a href="#cb746-1852" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb746-1853"><a href="#cb746-1853" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb746-1854"><a href="#cb746-1854" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"EMPTY MODEL"</span>)</span>
<span id="cb746-1855"><a href="#cb746-1855" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb746-1856"><a href="#cb746-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1857"><a href="#cb746-1857" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb746-1858"><a href="#cb746-1858" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb746-1859"><a href="#cb746-1859" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb746-1860"><a href="#cb746-1860" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb746-1861"><a href="#cb746-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1862"><a href="#cb746-1862" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb746-1863"><a href="#cb746-1863" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span>
<span id="cb746-1864"><a href="#cb746-1864" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb746-1865"><a href="#cb746-1865" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb746-1866"><a href="#cb746-1866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1867"><a href="#cb746-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1868"><a href="#cb746-1868" aria-hidden="true" tabindex="-1"></a>*The Condition predictor significantly improves model fit.*</span>
<span id="cb746-1869"><a href="#cb746-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1870"><a href="#cb746-1870" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Learning Notes</span></span>
<span id="cb746-1871"><a href="#cb746-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1874"><a href="#cb746-1874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1875"><a href="#cb746-1875" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-Q1ACC-LOG-combined</span></span>
<span id="cb746-1876"><a href="#cb746-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1877"><a href="#cb746-1877" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb746-1878"><a href="#cb746-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1879"><a href="#cb746-1879" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb746-1880"><a href="#cb746-1880" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb746-1881"><a href="#cb746-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1882"><a href="#cb746-1882" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb746-1883"><a href="#cb746-1883" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- LOG ODDS"</span>)</span>
<span id="cb746-1884"><a href="#cb746-1884" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span>
<span id="cb746-1885"><a href="#cb746-1885" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span>
<span id="cb746-1886"><a href="#cb746-1886" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(<span class="fu">confint</span>(m1)))) <span class="co">#exponentiate)</span></span>
<span id="cb746-1887"><a href="#cb746-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1888"><a href="#cb746-1888" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- PROBABILITIES"</span>)</span>
<span id="cb746-1889"><a href="#cb746-1889" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"[these should math pred plots]"</span>)</span>
<span id="cb746-1890"><a href="#cb746-1890" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at reference level"</span>)</span>
<span id="cb746-1891"><a href="#cb746-1891" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])</span>
<span id="cb746-1892"><a href="#cb746-1892" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Probability at coefficient level"</span>)</span>
<span id="cb746-1893"><a href="#cb746-1893" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]] <span class="sc">+</span> m1<span class="sc">$</span>coefficients[[<span class="dv">2</span>]])</span>
<span id="cb746-1894"><a href="#cb746-1894" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"CHANGE in probability by coefficient"</span>)</span>
<span id="cb746-1895"><a href="#cb746-1895" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]] <span class="sc">+</span> m1<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]) <span class="sc">-</span> <span class="fu">plogis</span>(m1<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])</span>
<span id="cb746-1896"><a href="#cb746-1896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1897"><a href="#cb746-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1898"><a href="#cb746-1898" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb746-1899"><a href="#cb746-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1900"><a href="#cb746-1900" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb746-1901"><a href="#cb746-1901" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb746-1902"><a href="#cb746-1902" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half</span></span>
<span id="cb746-1903"><a href="#cb746-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1904"><a href="#cb746-1904" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb746-1905"><a href="#cb746-1905" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb746-1906"><a href="#cb746-1906" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"p value for two-tailed test, null B = 0 : "</span>,<span class="fu">round</span>(tt,<span class="dv">3</span>))</span>
<span id="cb746-1907"><a href="#cb746-1907" aria-hidden="true" tabindex="-1"></a>ot <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb746-1908"><a href="#cb746-1908" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"BUT we want a one tailed directional, null: B &lt;= 0: "</span>,<span class="fu">round</span>(ot,<span class="dv">3</span>))</span>
<span id="cb746-1909"><a href="#cb746-1909" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"adjusted confint for directional hypothesis"</span>)</span>
<span id="cb746-1910"><a href="#cb746-1910" aria-hidden="true" tabindex="-1"></a>(dcint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1, <span class="at">level =</span> <span class="fl">0.90</span>)) <span class="co"># get 90% for right side))</span></span>
<span id="cb746-1911"><a href="#cb746-1911" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb746-1912"><a href="#cb746-1912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1913"><a href="#cb746-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1914"><a href="#cb746-1914" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS [directional]</span></span>
<span id="cb746-1915"><a href="#cb746-1915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1916"><a href="#cb746-1916" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval —- LOG ODDS")</span></span>
<span id="cb746-1917"><a href="#cb746-1917" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb746-1918"><a href="#cb746-1918" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Coefficients —- ODDS RATIOS")</span></span>
<span id="cb746-1919"><a href="#cb746-1919" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(confint(m1)))) #exponentiated, not adjusted</span></span>
<span id="cb746-1920"><a href="#cb746-1920" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(dcint))) #exponentiated, adjusted</span></span>
<span id="cb746-1921"><a href="#cb746-1921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1922"><a href="#cb746-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1923"><a href="#cb746-1923" aria-hidden="true" tabindex="-1"></a>**Understanding the logistic regression model**</span>
<span id="cb746-1924"><a href="#cb746-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1927"><a href="#cb746-1927" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1928"><a href="#cb746-1928" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb746-1929"><a href="#cb746-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1930"><a href="#cb746-1930" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb746-1931"><a href="#cb746-1931" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb746-1932"><a href="#cb746-1932" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb746-1933"><a href="#cb746-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1934"><a href="#cb746-1934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1935"><a href="#cb746-1935" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb746-1936"><a href="#cb746-1936" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb746-1937"><a href="#cb746-1937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-1938"><a href="#cb746-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1939"><a href="#cb746-1939" aria-hidden="true" tabindex="-1"></a>*The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable*</span>
<span id="cb746-1940"><a href="#cb746-1940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1941"><a href="#cb746-1941" aria-hidden="true" tabindex="-1"></a>*The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.*</span>
<span id="cb746-1942"><a href="#cb746-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1943"><a href="#cb746-1943" aria-hidden="true" tabindex="-1"></a>**\[the empty model**</span>
<span id="cb746-1944"><a href="#cb746-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1945"><a href="#cb746-1945" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercept of an empty model (glm(accuracy \~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df\$accuracy ==1 ).</span>
<span id="cb746-1946"><a href="#cb746-1946" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -<span class="sc">\&gt;</span> log(0.215 / (1-0.215)) = -1.29.</span>
<span id="cb746-1947"><a href="#cb746-1947" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</span>
<span id="cb746-1948"><a href="#cb746-1948" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</span>
<span id="cb746-1949"><a href="#cb746-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1950"><a href="#cb746-1950" aria-hidden="true" tabindex="-1"></a>**\[a dichotomous predictor\]**</span>
<span id="cb746-1951"><a href="#cb746-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1952"><a href="#cb746-1952" aria-hidden="true" tabindex="-1"></a>natural log (odds of +) = -1.822 + 0.901(x1) ; x1 = 0 for control, 1 for impasse - b0 intercept is ODDS OF CORRECT RESPONSE IN REFERENCE (control) - b1 intercept is ODDS RATIO (difference in odds) FOR CORRECT RESPONSE IN IMPASSE</span>
<span id="cb746-1953"><a href="#cb746-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1954"><a href="#cb746-1954" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>INTERCEPT: log odds of (+ response) in control condition</span>
<span id="cb746-1955"><a href="#cb746-1955" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</span>
<span id="cb746-1956"><a href="#cb746-1956" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating the coefficients\</span>
<span id="cb746-1957"><a href="#cb746-1957" aria-hidden="true" tabindex="-1"></a>        log odds of (+) in control = exp(-1.822) = 0.162 odds</span>
<span id="cb746-1958"><a href="#cb746-1958" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb746-1959"><a href="#cb746-1959" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139\</span>
<span id="cb746-1960"><a href="#cb746-1960" aria-hidden="true" tabindex="-1"></a>        probability of (+) in control = \~14%</span>
<span id="cb746-1961"><a href="#cb746-1961" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs. control</span>
<span id="cb746-1962"><a href="#cb746-1962" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</span>
<span id="cb746-1963"><a href="#cb746-1963" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating log odds\</span>
<span id="cb746-1964"><a href="#cb746-1964" aria-hidden="true" tabindex="-1"></a>        log odds (+) in impasse = exp(-0.921) = 0.398</span>
<span id="cb746-1965"><a href="#cb746-1965" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb746-1966"><a href="#cb746-1966" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285\</span>
<span id="cb746-1967"><a href="#cb746-1967" aria-hidden="true" tabindex="-1"></a>        probaility of (+) in impasse = \~ 29%</span>
<span id="cb746-1968"><a href="#cb746-1968" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ODDS RATIO : exponentiated B1 COEFFICIENT</span>
<span id="cb746-1969"><a href="#cb746-1969" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = (slope of logit model = difference in log odds = log odds ratio</span>
<span id="cb746-1970"><a href="#cb746-1970" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = 0.901 is log odds ratio of (+) in impasse vs control</span>
<span id="cb746-1971"><a href="#cb746-1971" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>exp(b1) = exp(0.901) = 2.46</span>
<span id="cb746-1972"><a href="#cb746-1972" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</span>
<span id="cb746-1973"><a href="#cb746-1973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1974"><a href="#cb746-1974" aria-hidden="true" tabindex="-1"></a>+:----------------------------------------------------------------------+</span>
<span id="cb746-1975"><a href="#cb746-1975" aria-hidden="true" tabindex="-1"></a>| MARGINAL\                                                             |</span>
<span id="cb746-1976"><a href="#cb746-1976" aria-hidden="true" tabindex="-1"></a>| total = 330 success : 71, failure : 259\                              |</span>
<span id="cb746-1977"><a href="#cb746-1977" aria-hidden="true" tabindex="-1"></a>| p(+) = 71 / 330 = 0.215 = 22%\                                        |</span>
<span id="cb746-1978"><a href="#cb746-1978" aria-hidden="true" tabindex="-1"></a>| odds(+) = 71 / 259 = 0.274                                            |</span>
<span id="cb746-1979"><a href="#cb746-1979" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb746-1980"><a href="#cb746-1980" aria-hidden="true" tabindex="-1"></a>| CONTROL total = 158 success = 22; failure = 136\                      |</span>
<span id="cb746-1981"><a href="#cb746-1981" aria-hidden="true" tabindex="-1"></a>| p(+) = 22/158 = 0.139 = 14%\                                          |</span>
<span id="cb746-1982"><a href="#cb746-1982" aria-hidden="true" tabindex="-1"></a>| odds(+) = 22/136 = 0.162                                              |</span>
<span id="cb746-1983"><a href="#cb746-1983" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb746-1984"><a href="#cb746-1984" aria-hidden="true" tabindex="-1"></a>| IMPASSE total = 172 success = 49; failure = 123\                      |</span>
<span id="cb746-1985"><a href="#cb746-1985" aria-hidden="true" tabindex="-1"></a>| p(+) = 49/172 = 0.285 = 29%\                                          |</span>
<span id="cb746-1986"><a href="#cb746-1986" aria-hidden="true" tabindex="-1"></a>| odds(+) = 49/123 = 0.398                                              |</span>
<span id="cb746-1987"><a href="#cb746-1987" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb746-1988"><a href="#cb746-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1989"><a href="#cb746-1989" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb746-1990"><a href="#cb746-1990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1993"><a href="#cb746-1993" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-1994"><a href="#cb746-1994" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb746-1995"><a href="#cb746-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-1996"><a href="#cb746-1996" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb746-1997"><a href="#cb746-1997" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoefstats</span>(m1, <span class="at">output =</span> <span class="st">"plot"</span>, </span>
<span id="cb746-1998"><a href="#cb746-1998" aria-hidden="true" tabindex="-1"></a>              <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">+</span> </span>
<span id="cb746-1999"><a href="#cb746-1999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Log Odds Estimate"</span>, </span>
<span id="cb746-2000"><a href="#cb746-2000" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"p is for two tailed test"</span>)</span>
<span id="cb746-2001"><a href="#cb746-2001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2002"><a href="#cb746-2002" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb746-2003"><a href="#cb746-2003" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb746-2004"><a href="#cb746-2004" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb746-2005"><a href="#cb746-2005" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb746-2006"><a href="#cb746-2006" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-2007"><a href="#cb746-2007" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb746-2008"><a href="#cb746-2008" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb746-2009"><a href="#cb746-2009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb746-2010"><a href="#cb746-2010" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb746-2011"><a href="#cb746-2011" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb746-2012"><a href="#cb746-2012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2013"><a href="#cb746-2013" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb746-2014"><a href="#cb746-2014" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">type=</span><span class="st">"eff"</span>,</span>
<span id="cb746-2015"><a href="#cb746-2015" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-2016"><a href="#cb746-2016" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-2017"><a href="#cb746-2017" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb746-2018"><a href="#cb746-2018" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb746-2019"><a href="#cb746-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2020"><a href="#cb746-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2021"><a href="#cb746-2021" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb746-2022"><a href="#cb746-2022" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m1)</span></span>
<span id="cb746-2023"><a href="#cb746-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2024"><a href="#cb746-2024" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELSUMMARY | MODEL | PROBABILITIES</span></span>
<span id="cb746-2025"><a href="#cb746-2025" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m1, exponentiate = TRUE)</span></span>
<span id="cb746-2026"><a href="#cb746-2026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2027"><a href="#cb746-2027" aria-hidden="true" tabindex="-1"></a><span class="co">#MARGINALEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb746-2028"><a href="#cb746-2028" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb746-2029"><a href="#cb746-2029" aria-hidden="true" tabindex="-1"></a><span class="co">#plot adjusted predictions, conditional on the CONDITION variable using the plot_cap</span></span>
<span id="cb746-2030"><a href="#cb746-2030" aria-hidden="true" tabindex="-1"></a><span class="co">#interactions plot_cap(mod, condition = c("length", "style"))</span></span>
<span id="cb746-2031"><a href="#cb746-2031" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cap</span>(m1, <span class="at">condition =</span> <span class="st">"pretty_condition"</span>)</span>
<span id="cb746-2032"><a href="#cb746-2032" aria-hidden="true" tabindex="-1"></a><span class="co"># The plot_cme function can be used to draw “Conditional Marginal Effects.” </span></span>
<span id="cb746-2033"><a href="#cb746-2033" aria-hidden="true" tabindex="-1"></a><span class="co">#use for ixns </span></span>
<span id="cb746-2034"><a href="#cb746-2034" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_cme(m1, effect = "var1", condition = "pretty_condition")</span></span>
<span id="cb746-2035"><a href="#cb746-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2036"><a href="#cb746-2036" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2037"><a href="#cb746-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2038"><a href="#cb746-2038" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb746-2039"><a href="#cb746-2039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2042"><a href="#cb746-2042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2043"><a href="#cb746-2043" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb746-2044"><a href="#cb746-2044" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m1)</span>
<span id="cb746-2045"><a href="#cb746-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2046"><a href="#cb746-2046" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb746-2047"><a href="#cb746-2047" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb746-2048"><a href="#cb746-2048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2049"><a href="#cb746-2049" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span>
<span id="cb746-2050"><a href="#cb746-2050" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span>
<span id="cb746-2051"><a href="#cb746-2051" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(m1)</span>
<span id="cb746-2052"><a href="#cb746-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2053"><a href="#cb746-2053" aria-hidden="true" tabindex="-1"></a><span class="co"># logitgof(df$accuracy, m1$fitted.values, ord=FALSE)</span></span>
<span id="cb746-2054"><a href="#cb746-2054" aria-hidden="true" tabindex="-1"></a><span class="co"># hoslem.test(x = df$accuracy, y = fitted(m1), g =  2)</span></span>
<span id="cb746-2055"><a href="#cb746-2055" aria-hidden="true" tabindex="-1"></a><span class="co"># p should be non significant</span></span>
<span id="cb746-2056"><a href="#cb746-2056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2057"><a href="#cb746-2057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2058"><a href="#cb746-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2059"><a href="#cb746-2059" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb746-2060"><a href="#cb746-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2061"><a href="#cb746-2061" aria-hidden="true" tabindex="-1"></a>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the *impasse condition* increase by 146% ($e^{beta_1}$ = 2.46, 95% CI \[1.42, 4.37\]) over the *control condition*.</span>
<span id="cb746-2062"><a href="#cb746-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2063"><a href="#cb746-2063" aria-hidden="true" tabindex="-1"></a>*Equivalent statements:*</span>
<span id="cb746-2064"><a href="#cb746-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2065"><a href="#cb746-2065" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse condition increases log odds of correct response by 0.901 (over control)</span>
<span id="cb746-2066"><a href="#cb746-2066" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</span>
<span id="cb746-2067"><a href="#cb746-2067" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</span>
<span id="cb746-2068"><a href="#cb746-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2071"><a href="#cb746-2071" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2072"><a href="#cb746-2072" aria-hidden="true" tabindex="-1"></a><span class="co">#PRETTY TABLE SJPLOT</span></span>
<span id="cb746-2073"><a href="#cb746-2073" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1)</span>
<span id="cb746-2074"><a href="#cb746-2074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2075"><a href="#cb746-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2076"><a href="#cb746-2076" aria-hidden="true" tabindex="-1"></a><span class="fu">## ORDINAL OUTCOME</span></span>
<span id="cb746-2077"><a href="#cb746-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2078"><a href="#cb746-2078" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] type of response given?**</span>
<span id="cb746-2079"><a href="#cb746-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2082"><a href="#cb746-2082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2083"><a href="#cb746-2083" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : SETUP-INDEPENDENT-ORDINAL</span></span>
<span id="cb746-2084"><a href="#cb746-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2085"><a href="#cb746-2085" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb746-2086"><a href="#cb746-2086" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb746-2087"><a href="#cb746-2087" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb746-2088"><a href="#cb746-2088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2089"><a href="#cb746-2089" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb746-2090"><a href="#cb746-2090" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>scaled, df<span class="sc">$</span>condition))</span>
<span id="cb746-2091"><a href="#cb746-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2092"><a href="#cb746-2092" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb746-2093"><a href="#cb746-2093" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>scaled, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb746-2094"><a href="#cb746-2094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb746-2095"><a href="#cb746-2095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2096"><a href="#cb746-2096" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb746-2097"><a href="#cb746-2097" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb746-2098"><a href="#cb746-2098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb746-2099"><a href="#cb746-2099" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb746-2100"><a href="#cb746-2100" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> scaled)) <span class="sc">+</span></span>
<span id="cb746-2101"><a href="#cb746-2101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb746-2102"><a href="#cb746-2102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb746-2103"><a href="#cb746-2103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb746-2104"><a href="#cb746-2104" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb746-2105"><a href="#cb746-2105" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb746-2106"><a href="#cb746-2106" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb746-2107"><a href="#cb746-2107" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb746-2108"><a href="#cb746-2108" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb746-2109"><a href="#cb746-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2110"><a href="#cb746-2110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2111"><a href="#cb746-2111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2112"><a href="#cb746-2112" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] state of understanding?**</span>
<span id="cb746-2113"><a href="#cb746-2113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2116"><a href="#cb746-2116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2117"><a href="#cb746-2117" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : SETUP-INDEPENDENT-ORDINAL-STATE</span></span>
<span id="cb746-2118"><a href="#cb746-2118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2119"><a href="#cb746-2119" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb746-2120"><a href="#cb746-2120" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb746-2121"><a href="#cb746-2121" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb746-2122"><a href="#cb746-2122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2123"><a href="#cb746-2123" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb746-2124"><a href="#cb746-2124" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition))</span>
<span id="cb746-2125"><a href="#cb746-2125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2126"><a href="#cb746-2126" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb746-2127"><a href="#cb746-2127" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>state, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb746-2128"><a href="#cb746-2128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb746-2129"><a href="#cb746-2129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2130"><a href="#cb746-2130" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb746-2131"><a href="#cb746-2131" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb746-2132"><a href="#cb746-2132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb746-2133"><a href="#cb746-2133" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb746-2134"><a href="#cb746-2134" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb746-2135"><a href="#cb746-2135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb746-2136"><a href="#cb746-2136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb746-2137"><a href="#cb746-2137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb746-2138"><a href="#cb746-2138" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb746-2139"><a href="#cb746-2139" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 State"</span>,</span>
<span id="cb746-2140"><a href="#cb746-2140" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb746-2141"><a href="#cb746-2141" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb746-2142"><a href="#cb746-2142" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb746-2143"><a href="#cb746-2143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2144"><a href="#cb746-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2145"><a href="#cb746-2145" aria-hidden="true" tabindex="-1"></a><span class="fu">### ORDINAL REGRESSION --- Cumulative Link; Proportional Odds</span></span>
<span id="cb746-2146"><a href="#cb746-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2147"><a href="#cb746-2147" aria-hidden="true" tabindex="-1"></a>*Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.*</span>
<span id="cb746-2148"><a href="#cb746-2148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2149"><a href="#cb746-2149" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/&gt;</span></span>
<span id="cb746-2150"><a href="#cb746-2150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://journals.sagepub.com/doi/full/10.1177/2515245918823199&gt;</span></span>
<span id="cb746-2151"><a href="#cb746-2151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>todo see ordinal regression video: <span class="ot">&lt;https://www.youtube.com/watch?v=rPcMcW25PPA&amp;ab_channel=NCRMUK&gt;</span></span>
<span id="cb746-2152"><a href="#cb746-2152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://peopleanalytics-regression-book.org/ord-reg.html&gt;</span></span>
<span id="cb746-2153"><a href="#cb746-2153" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://medium.com/evangelinelee/brant-test-for-proportional-odds-in-r-b0b373a93aa2&gt;</span></span>
<span id="cb746-2154"><a href="#cb746-2154" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://github.com/runehaubo/ordinal/blob/master/old_vignettes/clm_tutorial.pdf&gt;</span></span>
<span id="cb746-2155"><a href="#cb746-2155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2156"><a href="#cb746-2156" aria-hidden="true" tabindex="-1"></a>**Learning Notes**</span>
<span id="cb746-2157"><a href="#cb746-2157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2158"><a href="#cb746-2158" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>proportional odds regression models effectively act as a series of stratified binomial models under the assumption that the 'slope' of the logistic function of each stratified model is the same.</span>
<span id="cb746-2159"><a href="#cb746-2159" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>thus need to verify proportional odds assumption - ordinal regression requires an **proportional odds assumption** (the same slope holds for each equation)</span>
<span id="cb746-2160"><a href="#cb746-2160" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>this is required because the model simultaneously estimates k-1 equations, but each equation has the same *slope*, with different intercepts.</span>
<span id="cb746-2161"><a href="#cb746-2161" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>conversely, a multinomial (categorical) model will have different slopes as well as intercepts - the intercepts are always ordered in size alpha 1 <span class="sc">\&lt;</span> alpha 2 <span class="sc">\&lt;</span> alpha k-1...</span>
<span id="cb746-2162"><a href="#cb746-2162" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TODO** - see difference between the three types of ordinal models (adjacent category (vs) cumulative proportions; check Agresti book</span>
<span id="cb746-2163"><a href="#cb746-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2164"><a href="#cb746-2164" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb746-2165"><a href="#cb746-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2168"><a href="#cb746-2168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2169"><a href="#cb746-2169" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::ORDINAL REGRESSION MODELS</span></span>
<span id="cb746-2170"><a href="#cb746-2170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2171"><a href="#cb746-2171" aria-hidden="true" tabindex="-1"></a><span class="co">#EMPTY MODEL</span></span>
<span id="cb746-2172"><a href="#cb746-2172" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"EMPTY Ordinal regression of q1 SCALED score (ordered interpretation)"</span>)</span>
<span id="cb746-2173"><a href="#cb746-2173" aria-hidden="true" tabindex="-1"></a>om<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">clm</span>(state <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> df)</span>
<span id="cb746-2174"><a href="#cb746-2174" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(om.0)</span></span>
<span id="cb746-2175"><a href="#cb746-2175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2176"><a href="#cb746-2176" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICTOR MODEL</span></span>
<span id="cb746-2177"><a href="#cb746-2177" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Ordinal regression of q1 SCALED score (ordered interpretation)"</span>)</span>
<span id="cb746-2178"><a href="#cb746-2178" aria-hidden="true" tabindex="-1"></a>om <span class="ot">&lt;-</span> <span class="fu">clm</span>(state <span class="sc">~</span> condition, <span class="at">data =</span> df)</span>
<span id="cb746-2179"><a href="#cb746-2179" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(om)</span></span>
<span id="cb746-2180"><a href="#cb746-2180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2181"><a href="#cb746-2181" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE EMPTY AND PREDICTOR</span></span>
<span id="cb746-2182"><a href="#cb746-2182" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(om<span class="fl">.0</span>, om)</span>
<span id="cb746-2183"><a href="#cb746-2183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2184"><a href="#cb746-2184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2185"><a href="#cb746-2185" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: EQUIVALENT APPROACH USING POLYR </span></span>
<span id="cb746-2186"><a href="#cb746-2186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2187"><a href="#cb746-2187" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL</span></span>
<span id="cb746-2188"><a href="#cb746-2188" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(state <span class="sc">~</span> condition , <span class="at">data =</span> df, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb746-2189"><a href="#cb746-2189" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m)</span></span>
<span id="cb746-2190"><a href="#cb746-2190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2191"><a href="#cb746-2191" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate coefficients and CIs</span></span>
<span id="cb746-2192"><a href="#cb746-2192" aria-hidden="true" tabindex="-1"></a><span class="co"># (ctable &lt;- coef(summary(m)))</span></span>
<span id="cb746-2193"><a href="#cb746-2193" aria-hidden="true" tabindex="-1"></a><span class="co"># (p &lt;- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2)</span></span>
<span id="cb746-2194"><a href="#cb746-2194" aria-hidden="true" tabindex="-1"></a><span class="co"># (ctable &lt;- cbind(ctable, "p value" = p))</span></span>
<span id="cb746-2195"><a href="#cb746-2195" aria-hidden="true" tabindex="-1"></a><span class="co"># (ci &lt;- confint(m))</span></span>
<span id="cb746-2196"><a href="#cb746-2196" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- coef(m))</span></span>
<span id="cb746-2197"><a href="#cb746-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2198"><a href="#cb746-2198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2199"><a href="#cb746-2199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2200"><a href="#cb746-2200" aria-hidden="true" tabindex="-1"></a>*Likelihood ratio test suggests the predictor model is a better fit than the empty (intercept only) model.*</span>
<span id="cb746-2201"><a href="#cb746-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2202"><a href="#cb746-2202" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb746-2203"><a href="#cb746-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2206"><a href="#cb746-2206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2207"><a href="#cb746-2207" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SUMMARY"</span>)</span>
<span id="cb746-2208"><a href="#cb746-2208" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(om)</span>
<span id="cb746-2209"><a href="#cb746-2209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2210"><a href="#cb746-2210" aria-hidden="true" tabindex="-1"></a><span class="co">#LOG ODDS</span></span>
<span id="cb746-2211"><a href="#cb746-2211" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"IN LOG ODDS"</span>)</span>
<span id="cb746-2212"><a href="#cb746-2212" aria-hidden="true" tabindex="-1"></a>(ctable <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(om)))</span>
<span id="cb746-2213"><a href="#cb746-2213" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(om)) </span>
<span id="cb746-2214"><a href="#cb746-2214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2215"><a href="#cb746-2215" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"IN ODDS RATIOS"</span>)</span>
<span id="cb746-2216"><a href="#cb746-2216" aria-hidden="true" tabindex="-1"></a><span class="co">#ODDS RATIOS</span></span>
<span id="cb746-2217"><a href="#cb746-2217" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(om))</span>
<span id="cb746-2218"><a href="#cb746-2218" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(ci)</span>
<span id="cb746-2219"><a href="#cb746-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2220"><a href="#cb746-2220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2221"><a href="#cb746-2221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2222"><a href="#cb746-2222" aria-hidden="true" tabindex="-1"></a>**Overall, participants in the impasse condition had higher odds (6.68 X as likely) to offer *more correct* interpretations than those in the control condition (z = 4.74, p \&lt; 0.001).**</span>
<span id="cb746-2223"><a href="#cb746-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2224"><a href="#cb746-2224" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>we see the estimates for the 2 intercepts, which are sometimes called cutpoints.</span>
<span id="cb746-2225"><a href="#cb746-2225" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercepts indicate where the latent variable is cut to make the three groups that we observe in our data.</span>
<span id="cb746-2226"><a href="#cb746-2226" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that this latent variable is continuous. In general, these are not used in the interpretation of the results.</span>
<span id="cb746-2227"><a href="#cb746-2227" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The cutpoints are closely related to thresholds, which are reported by other statistical packages.</span>
<span id="cb746-2228"><a href="#cb746-2228" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>for k groups there will be k-1 intercepts (cutpoints)</span>
<span id="cb746-2229"><a href="#cb746-2229" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>confirm that the CI does not include 0 (the units are ordered logits <span class="sc">\[</span>ordered log odds<span class="sc">\]</span>)</span>
<span id="cb746-2230"><a href="#cb746-2230" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>as with logistic regression we exponentiate the coefficients and confints to get odds ratio</span>
<span id="cb746-2231"><a href="#cb746-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2232"><a href="#cb746-2232" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize Model</span></span>
<span id="cb746-2233"><a href="#cb746-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2236"><a href="#cb746-2236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2237"><a href="#cb746-2237" aria-hidden="true" tabindex="-1"></a><span class="co"># sjPlot::tab_model(om)</span></span>
<span id="cb746-2238"><a href="#cb746-2238" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(om)</span>
<span id="cb746-2239"><a href="#cb746-2239" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(om, <span class="at">type =</span> <span class="st">"eff"</span>)</span>
<span id="cb746-2240"><a href="#cb746-2240" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># show.data = TRUE, jitter = TRUE)</span></span>
<span id="cb746-2241"><a href="#cb746-2241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2242"><a href="#cb746-2242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2243"><a href="#cb746-2243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2244"><a href="#cb746-2244" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb746-2245"><a href="#cb746-2245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2248"><a href="#cb746-2248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2249"><a href="#cb746-2249" aria-hidden="true" tabindex="-1"></a><span class="co">#:: ASSESS FIT</span></span>
<span id="cb746-2250"><a href="#cb746-2250" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(om)</span>
<span id="cb746-2251"><a href="#cb746-2251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2252"><a href="#cb746-2252" aria-hidden="true" tabindex="-1"></a><span class="co"># #test proporitional odds assumption </span></span>
<span id="cb746-2253"><a href="#cb746-2253" aria-hidden="true" tabindex="-1"></a><span class="fu">brant</span>(m) <span class="co">#only works for polyr type model not clm type model</span></span>
<span id="cb746-2254"><a href="#cb746-2254" aria-hidden="true" tabindex="-1"></a><span class="co"># # A p-value of less than 0.05 on this test—particularly on the Omnibus plus at least one of the variables—should be interpreted as a failure of the proportional odds assumption.</span></span>
<span id="cb746-2255"><a href="#cb746-2255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2256"><a href="#cb746-2256" aria-hidden="true" tabindex="-1"></a><span class="co">#test proportional odds assumption</span></span>
<span id="cb746-2257"><a href="#cb746-2257" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pomcheckr)</span>
<span id="cb746-2258"><a href="#cb746-2258" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/pomcheckr/pomcheckr.pdf</span></span>
<span id="cb746-2259"><a href="#cb746-2259" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pomcheck</span>( scaled <span class="sc">~</span> condition , <span class="at">data =</span> df))</span>
<span id="cb746-2260"><a href="#cb746-2260" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span>
<span id="cb746-2261"><a href="#cb746-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2262"><a href="#cb746-2262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2263"><a href="#cb746-2263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2264"><a href="#cb746-2264" aria-hidden="true" tabindex="-1"></a>**The output of the graphical test for proportional odds assumption suggests that the proportional odds assumption may be unreasonable for this dataset. Also, inspecting the output table, we see the coefficients for each level of the scaled variable are quite different.**</span>
<span id="cb746-2265"><a href="#cb746-2265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2266"><a href="#cb746-2266" aria-hidden="true" tabindex="-1"></a>Thus, an alternative approach may be more appropriate:</span>
<span id="cb746-2267"><a href="#cb746-2267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2268"><a href="#cb746-2268" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Baseline logistic model. This model is the same as the multinomial regression model covered in the previous chapter, using the lowest ordinal value as the reference.</span>
<span id="cb746-2269"><a href="#cb746-2269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2270"><a href="#cb746-2270" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjacent-category logistic model. This model compares each level of the ordinal variable to the next highest level, and it is a constrained version of the baseline logistic model. The brglm2 package in R offers a function bracl() for calculating an adjacent category logistic model.</span>
<span id="cb746-2271"><a href="#cb746-2271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2272"><a href="#cb746-2272" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Continuation-ratio logistic model. This model compares each level of the ordinal variable to all lower levels. This can be modeled using binary logistic regression techniques, but new variables need to be constructed from the data set to allow this. The R package rms has a function cr.setup() which is a utility for preparing an outcome variable for a continuation ratio model.</span>
<span id="cb746-2273"><a href="#cb746-2273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2274"><a href="#cb746-2274" aria-hidden="true" tabindex="-1"></a><span class="sc">\*</span>Note: for multiple regression, the ordinal package offers a parameter (nominal = \~predictors) that allow you to designate some predictors as nominal rather than ordinal. But this is not appropriate for this use case.<span class="sc">\_</span></span>
<span id="cb746-2275"><a href="#cb746-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2276"><a href="#cb746-2276" aria-hidden="true" tabindex="-1"></a><span class="fu">## CATEGORICAL OUTCOME</span></span>
<span id="cb746-2277"><a href="#cb746-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2278"><a href="#cb746-2278" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] type of response given?**</span>
<span id="cb746-2279"><a href="#cb746-2279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2282"><a href="#cb746-2282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2283"><a href="#cb746-2283" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb746-2284"><a href="#cb746-2284" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb746-2285"><a href="#cb746-2285" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb746-2286"><a href="#cb746-2286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2287"><a href="#cb746-2287" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb746-2288"><a href="#cb746-2288" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>scaled, df<span class="sc">$</span>condition))</span>
<span id="cb746-2289"><a href="#cb746-2289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2290"><a href="#cb746-2290" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb746-2291"><a href="#cb746-2291" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>scaled, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb746-2292"><a href="#cb746-2292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb746-2293"><a href="#cb746-2293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2294"><a href="#cb746-2294" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb746-2295"><a href="#cb746-2295" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb746-2296"><a href="#cb746-2296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb746-2297"><a href="#cb746-2297" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb746-2298"><a href="#cb746-2298" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> scaled)) <span class="sc">+</span></span>
<span id="cb746-2299"><a href="#cb746-2299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb746-2300"><a href="#cb746-2300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb746-2301"><a href="#cb746-2301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb746-2302"><a href="#cb746-2302" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb746-2303"><a href="#cb746-2303" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb746-2304"><a href="#cb746-2304" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb746-2305"><a href="#cb746-2305" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb746-2306"><a href="#cb746-2306" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb746-2307"><a href="#cb746-2307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2308"><a href="#cb746-2308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2309"><a href="#cb746-2309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2310"><a href="#cb746-2310" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[ordered\] state of understanding?**</span>
<span id="cb746-2311"><a href="#cb746-2311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2314"><a href="#cb746-2314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2315"><a href="#cb746-2315" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA</span></span>
<span id="cb746-2316"><a href="#cb746-2316" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) </span>
<span id="cb746-2317"><a href="#cb746-2317" aria-hidden="true" tabindex="-1"></a><span class="co">#scaled has already been set as an ordered factor of score_SCALED</span></span>
<span id="cb746-2318"><a href="#cb746-2318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2319"><a href="#cb746-2319" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb746-2320"><a href="#cb746-2320" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb746-2321"><a href="#cb746-2321" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb746-2322"><a href="#cb746-2322" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb746-2323"><a href="#cb746-2323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2324"><a href="#cb746-2324" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::VISUALIZE DISTRIBUTIONS</span></span>
<span id="cb746-2325"><a href="#cb746-2325" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>state, <span class="at">fill=</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb746-2326"><a href="#cb746-2326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(condition <span class="sc">~</span> .) <span class="sc">+</span> <span class="fu">easy_remove_legend</span>()</span>
<span id="cb746-2327"><a href="#cb746-2327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2328"><a href="#cb746-2328" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb746-2329"><a href="#cb746-2329" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb746-2330"><a href="#cb746-2330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb746-2331"><a href="#cb746-2331" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb746-2332"><a href="#cb746-2332" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb746-2333"><a href="#cb746-2333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb746-2334"><a href="#cb746-2334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb746-2335"><a href="#cb746-2335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb746-2336"><a href="#cb746-2336" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb746-2337"><a href="#cb746-2337" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 State"</span>,</span>
<span id="cb746-2338"><a href="#cb746-2338" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb746-2339"><a href="#cb746-2339" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb746-2340"><a href="#cb746-2340" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb746-2341"><a href="#cb746-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2342"><a href="#cb746-2342" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATSPLOT</span></span>
<span id="cb746-2343"><a href="#cb746-2343" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(df, state, condition)</span>
<span id="cb746-2344"><a href="#cb746-2344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2345"><a href="#cb746-2345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2346"><a href="#cb746-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2347"><a href="#cb746-2347" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHI SQUARE</span></span>
<span id="cb746-2348"><a href="#cb746-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2349"><a href="#cb746-2349" aria-hidden="true" tabindex="-1"></a>**Does CONDITION affect the Q1 \[categorical\] type of response given?**</span>
<span id="cb746-2350"><a href="#cb746-2350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2353"><a href="#cb746-2353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2354"><a href="#cb746-2354" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>scaled, </span>
<span id="cb746-2355"><a href="#cb746-2355" aria-hidden="true" tabindex="-1"></a>             <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-2356"><a href="#cb746-2356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2357"><a href="#cb746-2357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2360"><a href="#cb746-2360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2361"><a href="#cb746-2361" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb746-2362"><a href="#cb746-2362" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb746-2363"><a href="#cb746-2363" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Interpretation on First Question by Condition"</span>,</span>
<span id="cb746-2364"><a href="#cb746-2364" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, condition <span class="sc">~</span> scaled, </span>
<span id="cb746-2365"><a href="#cb746-2365" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb746-2366"><a href="#cb746-2366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2367"><a href="#cb746-2367" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::WITH STATISTICS</span></span>
<span id="cb746-2368"><a href="#cb746-2368" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> condition, <span class="at">y =</span> scaled,</span>
<span id="cb746-2369"><a href="#cb746-2369" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"nonparametric"</span>) </span>
<span id="cb746-2370"><a href="#cb746-2370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2371"><a href="#cb746-2371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2374"><a href="#cb746-2374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2375"><a href="#cb746-2375" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-interpreation</span></span>
<span id="cb746-2376"><a href="#cb746-2376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2377"><a href="#cb746-2377" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb746-2378"><a href="#cb746-2378" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb746-2379"><a href="#cb746-2379" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Response Type on First Question by Condition"</span>,</span>
<span id="cb746-2380"><a href="#cb746-2380" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, condition <span class="sc">~</span> scaled, </span>
<span id="cb746-2381"><a href="#cb746-2381" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb746-2382"><a href="#cb746-2382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2383"><a href="#cb746-2383" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>scaled, </span>
<span id="cb746-2384"><a href="#cb746-2384" aria-hidden="true" tabindex="-1"></a>            <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-2385"><a href="#cb746-2385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2386"><a href="#cb746-2386" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb746-2387"><a href="#cb746-2387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"scaled"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb746-2388"><a href="#cb746-2388" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb746-2389"><a href="#cb746-2389" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb746-2390"><a href="#cb746-2390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2391"><a href="#cb746-2391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2392"><a href="#cb746-2392" aria-hidden="true" tabindex="-1"></a>**TODO INFERENCE**</span>
<span id="cb746-2393"><a href="#cb746-2393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2394"><a href="#cb746-2394" aria-hidden="true" tabindex="-1"></a><span class="fu">### MULTINOMIAL REGRESSION</span></span>
<span id="cb746-2395"><a href="#cb746-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2396"><a href="#cb746-2396" aria-hidden="true" tabindex="-1"></a>**TODO** RECONCILE actual predictions with coefficients and visualization of predictions</span>
<span id="cb746-2397"><a href="#cb746-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2398"><a href="#cb746-2398" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of Q1?*</span>
<span id="cb746-2399"><a href="#cb746-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2400"><a href="#cb746-2400" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://peopleanalytics-regression-book.org/multinomial-logistic-regression-for-nominal-category-outcomes.html#running-a-multinomial-regression-model&gt;</span></span>
<span id="cb746-2401"><a href="#cb746-2401" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://bookdown.org/chua/ber642_advanced_regression/multinomial-logistic-regression.html&gt;</span></span>
<span id="cb746-2402"><a href="#cb746-2402" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://www.youtube.com/watch?v=JcCBIPqcwFo&amp;list=PLzv58M2GAfm50X_Twskr1aXaV5qMuIszx&amp;ab_channel=NCRMUK&gt;</span></span>
<span id="cb746-2403"><a href="#cb746-2403" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can use nnet package multinom() or mclogit package mblogit() <span class="sc">\[</span>"baseline logit model"<span class="sc">\]</span> or brms with family = "categorical"</span>
<span id="cb746-2404"><a href="#cb746-2404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2405"><a href="#cb746-2405" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression predicting interpretation (k=#response categories) by condition. (k = 2).*</span>
<span id="cb746-2406"><a href="#cb746-2406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2407"><a href="#cb746-2407" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>2 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer)</span>
<span id="cb746-2408"><a href="#cb746-2408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2409"><a href="#cb746-2409" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>(from experience, seems) Each cell must have at least one observation (if one cell is blank, then it seems to be incorrectly estimated, see predicting high_interpretation vs. state. suggests nonsignificant OR for 'unknown' category, when infact that difference drives the effect</span>
<span id="cb746-2410"><a href="#cb746-2410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2411"><a href="#cb746-2411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For *each* equation:</span>
<span id="cb746-2412"><a href="#cb746-2412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2413"><a href="#cb746-2413" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{0}$ *= Log Odds of \[this category type vs. reference category type) response in CONTROL condition*</span>
<span id="cb746-2414"><a href="#cb746-2414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2415"><a href="#cb746-2415" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$e^{\beta_{0}}$ *= ODDS of \[this category type vs. reference category type\] response in CONTROL condition*</span>
<span id="cb746-2416"><a href="#cb746-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2417"><a href="#cb746-2417" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{1}$ *=* $\beta_{1impasse}$ *Log Odds (Log OR; change in odds for \[this category\] type response in impasse (vs) control \[log scale\])*</span>
<span id="cb746-2418"><a href="#cb746-2418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2419"><a href="#cb746-2419" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{1}}$ *= ODDS RATIO of \[this. vs reference category type\] response in IMPASSE (vs) CONTROL*</span>
<span id="cb746-2420"><a href="#cb746-2420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2421"><a href="#cb746-2421" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*Null hypothesis:* $\beta_{impasse} \le 0$ *the odds for \[this category of response vs. reference\] does not change, or decreases*</span>
<span id="cb746-2422"><a href="#cb746-2422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2423"><a href="#cb746-2423" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*Alternative hypothesis:* $\beta_{impasse} \gt 0$ *the odds of \[this category of response vs. reference\] increases*</span>
<span id="cb746-2424"><a href="#cb746-2424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2425"><a href="#cb746-2425" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span></span>
<span id="cb746-2426"><a href="#cb746-2426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2429"><a href="#cb746-2429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2430"><a href="#cb746-2430" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES RESPONSE STATE</span></span>
<span id="cb746-2431"><a href="#cb746-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2432"><a href="#cb746-2432" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb746-2433"><a href="#cb746-2433" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb746-2434"><a href="#cb746-2434" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb746-2435"><a href="#cb746-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2436"><a href="#cb746-2436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2437"><a href="#cb746-2437" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb746-2438"><a href="#cb746-2438" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb746-2439"><a href="#cb746-2439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2440"><a href="#cb746-2440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2441"><a href="#cb746-2441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2442"><a href="#cb746-2442" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb746-2443"><a href="#cb746-2443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2446"><a href="#cb746-2446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2447"><a href="#cb746-2447" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb746-2448"><a href="#cb746-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2449"><a href="#cb746-2449" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb746-2450"><a href="#cb746-2450" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span>
<span id="cb746-2451"><a href="#cb746-2451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2452"><a href="#cb746-2452" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb746-2453"><a href="#cb746-2453" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb746-2454"><a href="#cb746-2454" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb746-2455"><a href="#cb746-2455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2456"><a href="#cb746-2456" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb746-2457"><a href="#cb746-2457" aria-hidden="true" tabindex="-1"></a>catm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-2458"><a href="#cb746-2458" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm)</span></span>
<span id="cb746-2459"><a href="#cb746-2459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2460"><a href="#cb746-2460" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb746-2461"><a href="#cb746-2461" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm)</span>
<span id="cb746-2462"><a href="#cb746-2462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2463"><a href="#cb746-2463" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb746-2464"><a href="#cb746-2464" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb746-2465"><a href="#cb746-2465" aria-hidden="true" tabindex="-1"></a><span class="co"># bm1 &lt;- brm( state ~ pretty_condition, data = df, family = "categorical")</span></span>
<span id="cb746-2466"><a href="#cb746-2466" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(bm1)</span></span>
<span id="cb746-2467"><a href="#cb746-2467" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(bm1)</span></span>
<span id="cb746-2468"><a href="#cb746-2468" aria-hidden="true" tabindex="-1"></a><span class="co"># report(bm1)</span></span>
<span id="cb746-2469"><a href="#cb746-2469" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb746-2470"><a href="#cb746-2470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2471"><a href="#cb746-2471" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb746-2472"><a href="#cb746-2472" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb746-2473"><a href="#cb746-2473" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb746-2474"><a href="#cb746-2474" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state ~ pretty_condition , data = df)</span></span>
<span id="cb746-2475"><a href="#cb746-2475" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb746-2476"><a href="#cb746-2476" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span>
<span id="cb746-2477"><a href="#cb746-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2478"><a href="#cb746-2478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2479"><a href="#cb746-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2480"><a href="#cb746-2480" aria-hidden="true" tabindex="-1"></a>*Likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*</span>
<span id="cb746-2481"><a href="#cb746-2481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2482"><a href="#cb746-2482" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interpretation</span></span>
<span id="cb746-2483"><a href="#cb746-2483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2486"><a href="#cb746-2486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2487"><a href="#cb746-2487" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb746-2488"><a href="#cb746-2488" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span>
<span id="cb746-2489"><a href="#cb746-2489" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(catm)</span>
<span id="cb746-2490"><a href="#cb746-2490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2491"><a href="#cb746-2491" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb746-2492"><a href="#cb746-2492" aria-hidden="true" tabindex="-1"></a>(z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(catm)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(catm)<span class="sc">$</span>standard.errors)</span>
<span id="cb746-2493"><a href="#cb746-2493" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb746-2494"><a href="#cb746-2494" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb746-2495"><a href="#cb746-2495" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb746-2496"><a href="#cb746-2496" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values))</span>
<span id="cb746-2497"><a href="#cb746-2497" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb746-2498"><a href="#cb746-2498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2499"><a href="#cb746-2499" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb746-2500"><a href="#cb746-2500" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(catm)<span class="sc">$</span>coefficients))</span>
<span id="cb746-2501"><a href="#cb746-2501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2502"><a href="#cb746-2502" aria-hidden="true" tabindex="-1"></a><span class="co"># options(scipen = 3)</span></span>
<span id="cb746-2503"><a href="#cb746-2503" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span>
<span id="cb746-2504"><a href="#cb746-2504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2505"><a href="#cb746-2505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2506"><a href="#cb746-2506" aria-hidden="true" tabindex="-1"></a>**Learning Notes**</span>
<span id="cb746-2507"><a href="#cb746-2507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2508"><a href="#cb746-2508" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model estimates encompass two equations:</span>
<span id="cb746-2509"><a href="#cb746-2509" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>effect of predictor on log odds of being in <span class="sc">\[</span>unknown<span class="sc">\]</span> instead of reference category <span class="sc">\[</span>orth-like<span class="sc">\]</span></span>
<span id="cb746-2510"><a href="#cb746-2510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>effect of predictor on log odds of being in <span class="sc">\[</span>tri-like<span class="sc">\]</span> instead of reference category <span class="sc">\[</span>orth-like<span class="sc">\]</span></span>
<span id="cb746-2511"><a href="#cb746-2511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="sc">\[</span>need to to double check interpretation, but I *think* that the OR intercepts converted to probabilities equate to the marginal probability of being in each state in the <span class="sc">\[</span>reference<span class="sc">\]</span> control condition. which makes sense. I think<span class="sc">\]</span></span>
<span id="cb746-2512"><a href="#cb746-2512" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>IF I change reference category for condition... then the intercepts should no longer be significant. The b1 coefficients should still be significant, but with changed sign (much less likely) <span class="sc">\[</span>Yup! this works!<span class="sc">\]</span></span>
<span id="cb746-2513"><a href="#cb746-2513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2514"><a href="#cb746-2514" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb746-2515"><a href="#cb746-2515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2516"><a href="#cb746-2516" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition increases the odds of giving 'unknown/uncertain' response rather than an orthogonal (or satisficing) response by a factor of 50 (z = 3.59, p <span class="sc">\&lt;</span> 0.001 ).</span>
<span id="cb746-2517"><a href="#cb746-2517" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition increases the odds of giving an 'triangular or line-driven' response rather than an orthogonal (or satisficing) response by a factor of 6 (z = 3.98, p <span class="sc">\&lt;</span>0.001 )</span>
<span id="cb746-2518"><a href="#cb746-2518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2519"><a href="#cb746-2519" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb746-2520"><a href="#cb746-2520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2523"><a href="#cb746-2523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2524"><a href="#cb746-2524" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(catm, <span class="at">vline.color =</span> <span class="st">'red'</span>)</span>
<span id="cb746-2525"><a href="#cb746-2525" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(catm, <span class="at">type =</span> <span class="st">"eff"</span>)</span>
<span id="cb746-2526"><a href="#cb746-2526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2527"><a href="#cb746-2527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2528"><a href="#cb746-2528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2529"><a href="#cb746-2529" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb746-2530"><a href="#cb746-2530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2533"><a href="#cb746-2533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2534"><a href="#cb746-2534" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb746-2535"><a href="#cb746-2535" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb746-2536"><a href="#cb746-2536" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))</span>
<span id="cb746-2537"><a href="#cb746-2537" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(catm, <span class="at">newdata =</span> test, <span class="st">"probs"</span>)</span>
<span id="cb746-2538"><a href="#cb746-2538" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Predicted Probability of Being in Each State"</span>)</span>
<span id="cb746-2539"><a href="#cb746-2539" aria-hidden="true" tabindex="-1"></a>(<span class="fu">cbind</span>(test, pred))</span>
<span id="cb746-2540"><a href="#cb746-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2541"><a href="#cb746-2541" aria-hidden="true" tabindex="-1"></a><span class="co">#performance</span></span>
<span id="cb746-2542"><a href="#cb746-2542" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(catm)</span>
<span id="cb746-2543"><a href="#cb746-2543" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(catm, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span>
<span id="cb746-2544"><a href="#cb746-2544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2545"><a href="#cb746-2545" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb746-2546"><a href="#cb746-2546" aria-hidden="true" tabindex="-1"></a><span class="co"># library(generalhoslem)</span></span>
<span id="cb746-2547"><a href="#cb746-2547" aria-hidden="true" tabindex="-1"></a><span class="co"># logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb746-2548"><a href="#cb746-2548" aria-hidden="true" tabindex="-1"></a><span class="co"># hoslem.test(x = df$state, y = catm$fitted.values, g =  10)</span></span>
<span id="cb746-2549"><a href="#cb746-2549" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb746-2550"><a href="#cb746-2550" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb746-2551"><a href="#cb746-2551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2552"><a href="#cb746-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2553"><a href="#cb746-2553" aria-hidden="true" tabindex="-1"></a><span class="fu"># MIXED (Repeated Measures)</span></span>
<span id="cb746-2554"><a href="#cb746-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2557"><a href="#cb746-2557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2558"><a href="#cb746-2558" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-</span><span class="al">TEST</span><span class="co">-ACC-ITEM</span></span>
<span id="cb746-2559"><a href="#cb746-2559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2560"><a href="#cb746-2560" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb746-2561"><a href="#cb746-2561" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb746-2562"><a href="#cb746-2562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2563"><a href="#cb746-2563" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb746-2564"><a href="#cb746-2564" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb746-2565"><a href="#cb746-2565" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb746-2566"><a href="#cb746-2566" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb746-2567"><a href="#cb746-2567" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-2568"><a href="#cb746-2568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2569"><a href="#cb746-2569" aria-hidden="true" tabindex="-1"></a><span class="co">#FACETED HISTOGRAM</span></span>
<span id="cb746-2570"><a href="#cb746-2570" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(item_test_NABS))</span>
<span id="cb746-2571"><a href="#cb746-2571" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>item_test_NABS, </span>
<span id="cb746-2572"><a href="#cb746-2572" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_subjects) <span class="sc">%&gt;%</span> </span>
<span id="cb746-2573"><a href="#cb746-2573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> pretty_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb746-2574"><a href="#cb746-2574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb746-2575"><a href="#cb746-2575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"# Correct"</span>,</span>
<span id="cb746-2576"><a href="#cb746-2576" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb746-2577"><a href="#cb746-2577" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Test Phase Absolute Score (# Correct)"</span>,</span>
<span id="cb746-2578"><a href="#cb746-2578" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb746-2579"><a href="#cb746-2579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2580"><a href="#cb746-2580" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb746-2581"><a href="#cb746-2581" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb746-2582"><a href="#cb746-2582" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df) <span class="sc">%&gt;%</span></span>
<span id="cb746-2583"><a href="#cb746-2583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb746-2584"><a href="#cb746-2584" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Correct Responses in Test Phase"</span>,</span>
<span id="cb746-2585"><a href="#cb746-2585" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Task by Condition"</span>,</span>
<span id="cb746-2586"><a href="#cb746-2586" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb746-2587"><a href="#cb746-2587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2588"><a href="#cb746-2588" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb746-2589"><a href="#cb746-2589" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb746-2590"><a href="#cb746-2590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb746-2591"><a href="#cb746-2591" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb746-2592"><a href="#cb746-2592" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb746-2593"><a href="#cb746-2593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb746-2594"><a href="#cb746-2594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb746-2595"><a href="#cb746-2595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb746-2596"><a href="#cb746-2596" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb746-2597"><a href="#cb746-2597" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb746-2598"><a href="#cb746-2598" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb746-2599"><a href="#cb746-2599" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb746-2600"><a href="#cb746-2600" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb746-2601"><a href="#cb746-2601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2602"><a href="#cb746-2602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2603"><a href="#cb746-2603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2604"><a href="#cb746-2604" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- CONTINUOUS</span></span>
<span id="cb746-2605"><a href="#cb746-2605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2606"><a href="#cb746-2606" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- BINOMIAL</span></span>
<span id="cb746-2607"><a href="#cb746-2607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2608"><a href="#cb746-2608" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mixed Logistic Regression</span></span>
<span id="cb746-2609"><a href="#cb746-2609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2610"><a href="#cb746-2610" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on test phase questions by condition; accounting for random effects of subject.*</span>
<span id="cb746-2611"><a href="#cb746-2611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2612"><a href="#cb746-2612" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb746-2613"><a href="#cb746-2613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2616"><a href="#cb746-2616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2617"><a href="#cb746-2617" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb746-2618"><a href="#cb746-2618" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb746-2619"><a href="#cb746-2619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2620"><a href="#cb746-2620" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb746-2621"><a href="#cb746-2621" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb746-2622"><a href="#cb746-2622" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb746-2623"><a href="#cb746-2623" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb746-2624"><a href="#cb746-2624" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb746-2625"><a href="#cb746-2625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2626"><a href="#cb746-2626" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb746-2627"><a href="#cb746-2627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2628"><a href="#cb746-2628" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM EFFECT</span></span>
<span id="cb746-2629"><a href="#cb746-2629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2630"><a href="#cb746-2630" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb746-2631"><a href="#cb746-2631" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df) </span>
<span id="cb746-2632"><a href="#cb746-2632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2633"><a href="#cb746-2633" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb746-2634"><a href="#cb746-2634" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb746-2635"><a href="#cb746-2635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2636"><a href="#cb746-2636" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb746-2637"><a href="#cb746-2637" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with random effect is lower than glm empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span>
<span id="cb746-2638"><a href="#cb746-2638" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb746-2639"><a href="#cb746-2639" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb746-2640"><a href="#cb746-2640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2641"><a href="#cb746-2641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2642"><a href="#cb746-2642" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT</span></span>
<span id="cb746-2643"><a href="#cb746-2643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2644"><a href="#cb746-2644" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span></span>
<span id="cb746-2645"><a href="#cb746-2645" aria-hidden="true" tabindex="-1"></a>mm.CrS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), </span>
<span id="cb746-2646"><a href="#cb746-2646" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb746-2647"><a href="#cb746-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2648"><a href="#cb746-2648" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> fixed factor </span></span>
<span id="cb746-2649"><a href="#cb746-2649" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with fixed effect is lower than random intercept only model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrS)) )</span>
<span id="cb746-2650"><a href="#cb746-2650" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS,mm.CrS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb746-2651"><a href="#cb746-2651" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS,mm.CrS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb746-2652"><a href="#cb746-2652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2653"><a href="#cb746-2653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2654"><a href="#cb746-2654" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb746-2655"><a href="#cb746-2655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2658"><a href="#cb746-2658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2659"><a href="#cb746-2659" aria-hidden="true" tabindex="-1"></a><span class="co">#: PRINT MODEL </span></span>
<span id="cb746-2660"><a href="#cb746-2660" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb746-2661"><a href="#cb746-2661" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(mm.CrS)</span>
<span id="cb746-2662"><a href="#cb746-2662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2663"><a href="#cb746-2663" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb746-2664"><a href="#cb746-2664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2665"><a href="#cb746-2665" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb746-2666"><a href="#cb746-2666" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(mm.CrS)</span>
<span id="cb746-2667"><a href="#cb746-2667" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb746-2668"><a href="#cb746-2668" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mm.CrS)</span>
<span id="cb746-2669"><a href="#cb746-2669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2670"><a href="#cb746-2670" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m1)))</span></span>
<span id="cb746-2671"><a href="#cb746-2671" aria-hidden="true" tabindex="-1"></a><span class="co"># # table of estimates with 95% CI</span></span>
<span id="cb746-2672"><a href="#cb746-2672" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m1), LL = fixef(m1) - 1.96 * se, UL = fixef(m1) + 1.96 *</span></span>
<span id="cb746-2673"><a href="#cb746-2673" aria-hidden="true" tabindex="-1"></a><span class="co">#     se))</span></span>
<span id="cb746-2674"><a href="#cb746-2674" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb746-2675"><a href="#cb746-2675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2676"><a href="#cb746-2676" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb746-2677"><a href="#cb746-2677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2678"><a href="#cb746-2678" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb746-2679"><a href="#cb746-2679" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb746-2680"><a href="#cb746-2680" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb746-2681"><a href="#cb746-2681" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb746-2682"><a href="#cb746-2682" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb746-2683"><a href="#cb746-2683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb746-2684"><a href="#cb746-2684" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb746-2685"><a href="#cb746-2685" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb746-2686"><a href="#cb746-2686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2687"><a href="#cb746-2687" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb746-2688"><a href="#cb746-2688" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"pred"</span>,</span>
<span id="cb746-2689"><a href="#cb746-2689" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-2690"><a href="#cb746-2690" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb746-2691"><a href="#cb746-2691" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb746-2692"><a href="#cb746-2692" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb746-2693"><a href="#cb746-2693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2694"><a href="#cb746-2694" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb746-2695"><a href="#cb746-2695" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb746-2696"><a href="#cb746-2696" aria-hidden="true" tabindex="-1"></a><span class="co"># ggeffect(model = mm.CrS) %&gt;% plot()</span></span>
<span id="cb746-2697"><a href="#cb746-2697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2698"><a href="#cb746-2698" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb746-2699"><a href="#cb746-2699" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb746-2700"><a href="#cb746-2700" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(mm.CrS))</span></span>
<span id="cb746-2701"><a href="#cb746-2701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2702"><a href="#cb746-2702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2703"><a href="#cb746-2703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2704"><a href="#cb746-2704" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb746-2705"><a href="#cb746-2705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2708"><a href="#cb746-2708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2709"><a href="#cb746-2709" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mm.CrS)</span>
<span id="cb746-2710"><a href="#cb746-2710" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(mm.CrS)</span>
<span id="cb746-2711"><a href="#cb746-2711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2712"><a href="#cb746-2712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2713"><a href="#cb746-2713" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb746-2714"><a href="#cb746-2714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2715"><a href="#cb746-2715" aria-hidden="true" tabindex="-1"></a>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(3): 4.98, p <span class="sc">\&lt;</span> 0.05). Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 5 over the control condition $e^{\beta_1}$ = 5.11, 95% CI <span class="sc">\[</span>1.17,22,36<span class="sc">\]</span>, p <span class="sc">\&lt;</span> 0.05.</span>
<span id="cb746-2716"><a href="#cb746-2716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2719"><a href="#cb746-2719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2720"><a href="#cb746-2720" aria-hidden="true" tabindex="-1"></a><span class="co"># PRETTY TABLE SJPLOT</span></span>
<span id="cb746-2721"><a href="#cb746-2721" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(mm.CrS)</span>
<span id="cb746-2722"><a href="#cb746-2722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2723"><a href="#cb746-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2724"><a href="#cb746-2724" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- ORDINAL</span></span>
<span id="cb746-2725"><a href="#cb746-2725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2726"><a href="#cb746-2726" aria-hidden="true" tabindex="-1"></a><span class="fu">## MIXED --- CATEGORICAL</span></span>
<span id="cb746-2727"><a href="#cb746-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2730"><a href="#cb746-2730" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2731"><a href="#cb746-2731" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN MIXED VERSION</span></span>
<span id="cb746-2732"><a href="#cb746-2732" aria-hidden="true" tabindex="-1"></a><span class="co">#df &lt;- df_items %&gt;% filter(q %nin% c(1,2,3,4,5,6,9)) %&gt;% filter(term=="spring18")</span></span>
<span id="cb746-2733"><a href="#cb746-2733" aria-hidden="true" tabindex="-1"></a><span class="co"># mm1 &lt;- brm( state ~ condition + (1|subject), data = df, family = "categorical", </span></span>
<span id="cb746-2734"><a href="#cb746-2734" aria-hidden="true" tabindex="-1"></a><span class="co"># file = "analysis/models/sgc3a_brms_mixedcat_teststate.rds" # cache model (can be removed)))</span></span>
<span id="cb746-2735"><a href="#cb746-2735" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm1)</span></span>
<span id="cb746-2736"><a href="#cb746-2736" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(mm1)</span></span>
<span id="cb746-2737"><a href="#cb746-2737" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mm1)</span></span>
<span id="cb746-2738"><a href="#cb746-2738" aria-hidden="true" tabindex="-1"></a><span class="co"># #report(mm1)</span></span>
<span id="cb746-2739"><a href="#cb746-2739" aria-hidden="true" tabindex="-1"></a><span class="co"># #check_posterior_predictions(mm1, draws=100)</span></span>
<span id="cb746-2740"><a href="#cb746-2740" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(bayesplot)</span></span>
<span id="cb746-2741"><a href="#cb746-2741" aria-hidden="true" tabindex="-1"></a><span class="co"># library(bayestestR)</span></span>
<span id="cb746-2742"><a href="#cb746-2742" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(mm1))</span></span>
<span id="cb746-2743"><a href="#cb746-2743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2744"><a href="#cb746-2744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2745"><a href="#cb746-2745" aria-hidden="true" tabindex="-1"></a><span class="fu">## WIP UNKNOWN</span></span>
<span id="cb746-2746"><a href="#cb746-2746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2747"><a href="#cb746-2747" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cummulative Ordinal (Bayesian) --- Equal Variance</span></span>
<span id="cb746-2748"><a href="#cb746-2748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2749"><a href="#cb746-2749" aria-hidden="true" tabindex="-1"></a>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb746-2750"><a href="#cb746-2750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2753"><a href="#cb746-2753" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2754"><a href="#cb746-2754" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb746-2755"><a href="#cb746-2755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2756"><a href="#cb746-2756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2757"><a href="#cb746-2757" aria-hidden="true" tabindex="-1"></a><span class="co">#DEFINE DATA </span></span>
<span id="cb746-2758"><a href="#cb746-2758" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb746-2759"><a href="#cb746-2759" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb746-2760"><a href="#cb746-2760" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: why is this probit instead of logit?</span></span>
<span id="cb746-2761"><a href="#cb746-2761" aria-hidden="true" tabindex="-1"></a>cumord <span class="ot">&lt;-</span> <span class="fu">brm</span>( <span class="at">formula =</span> state <span class="sc">~</span> condition,</span>
<span id="cb746-2762"><a href="#cb746-2762" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb746-2763"><a href="#cb746-2763" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"probit"</span>),</span>
<span id="cb746-2764"><a href="#cb746-2764" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/models/sgc3a_brms_cumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb746-2765"><a href="#cb746-2765" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-2766"><a href="#cb746-2766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2767"><a href="#cb746-2767" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cumord)</span>
<span id="cb746-2768"><a href="#cb746-2768" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-2769"><a href="#cb746-2769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2770"><a href="#cb746-2770" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT</span></span>
<span id="cb746-2771"><a href="#cb746-2771" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(cumord)</span>
<span id="cb746-2772"><a href="#cb746-2772" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cumord)</span>
<span id="cb746-2773"><a href="#cb746-2773" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(cumord))</span>
<span id="cb746-2774"><a href="#cb746-2774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2775"><a href="#cb746-2775" aria-hidden="true" tabindex="-1"></a><span class="co">#REPORT</span></span>
<span id="cb746-2776"><a href="#cb746-2776" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(cumord)</span>
<span id="cb746-2777"><a href="#cb746-2777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2778"><a href="#cb746-2778" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum %&gt;%</span></span>
<span id="cb746-2779"><a href="#cb746-2779" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb746-2780"><a href="#cb746-2780" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb746-2781"><a href="#cb746-2781" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb746-2782"><a href="#cb746-2782" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb746-2783"><a href="#cb746-2783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2784"><a href="#cb746-2784" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(cumord)</span></span>
<span id="cb746-2785"><a href="#cb746-2785" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(cumord)</span></span>
<span id="cb746-2786"><a href="#cb746-2786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2787"><a href="#cb746-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2788"><a href="#cb746-2788" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cummulative Ordinal (Bayesian) --- Unequal Variance</span></span>
<span id="cb746-2789"><a href="#cb746-2789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2790"><a href="#cb746-2790" aria-hidden="true" tabindex="-1"></a>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb746-2791"><a href="#cb746-2791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2794"><a href="#cb746-2794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2795"><a href="#cb746-2795" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb746-2796"><a href="#cb746-2796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2797"><a href="#cb746-2797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2798"><a href="#cb746-2798" aria-hidden="true" tabindex="-1"></a><span class="co">#DEFINE DATA </span></span>
<span id="cb746-2799"><a href="#cb746-2799" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb746-2800"><a href="#cb746-2800" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb746-2801"><a href="#cb746-2801" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: why is this probit instead of logit?</span></span>
<span id="cb746-2802"><a href="#cb746-2802" aria-hidden="true" tabindex="-1"></a>u.cumord <span class="ot">&lt;-</span> <span class="fu">brm</span>( </span>
<span id="cb746-2803"><a href="#cb746-2803" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(state <span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb746-2804"><a href="#cb746-2804" aria-hidden="true" tabindex="-1"></a>               <span class="fu">lf</span>(disc <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> condition, <span class="at">cmc =</span> <span class="cn">FALSE</span>),</span>
<span id="cb746-2805"><a href="#cb746-2805" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb746-2806"><a href="#cb746-2806" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"probit"</span>),</span>
<span id="cb746-2807"><a href="#cb746-2807" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/models/sgc3a_brms_ucumord_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb746-2808"><a href="#cb746-2808" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-2809"><a href="#cb746-2809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2810"><a href="#cb746-2810" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(u.cumord)</span>
<span id="cb746-2811"><a href="#cb746-2811" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(u.cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-2812"><a href="#cb746-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2813"><a href="#cb746-2813" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT</span></span>
<span id="cb746-2814"><a href="#cb746-2814" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(u.cumord)</span>
<span id="cb746-2815"><a href="#cb746-2815" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(u.cumord)</span>
<span id="cb746-2816"><a href="#cb746-2816" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rope</span>(u.cumord))</span>
<span id="cb746-2817"><a href="#cb746-2817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2818"><a href="#cb746-2818" aria-hidden="true" tabindex="-1"></a><span class="co">#REPORT</span></span>
<span id="cb746-2819"><a href="#cb746-2819" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(u.cumord)</span>
<span id="cb746-2820"><a href="#cb746-2820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2821"><a href="#cb746-2821" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum %&gt;%</span></span>
<span id="cb746-2822"><a href="#cb746-2822" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb746-2823"><a href="#cb746-2823" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb746-2824"><a href="#cb746-2824" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb746-2825"><a href="#cb746-2825" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb746-2826"><a href="#cb746-2826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2827"><a href="#cb746-2827" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(cumord)</span></span>
<span id="cb746-2828"><a href="#cb746-2828" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(cumord)</span></span>
<span id="cb746-2829"><a href="#cb746-2829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2830"><a href="#cb746-2830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2831"><a href="#cb746-2831" aria-hidden="true" tabindex="-1"></a>In brms, the parameter related to latent variances is called disc (short for "discrimination"), following conventions in item response theory. Note that disc is not the variance itself, but the inverse of the standard deviation, s. That is, s = 1/disc. Further, because disc must be strictly positive, it is by default modeled on the log scale.</span>
<span id="cb746-2832"><a href="#cb746-2832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2833"><a href="#cb746-2833" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjacent-Category Ordinal (Bayesian)</span></span>
<span id="cb746-2834"><a href="#cb746-2834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2837"><a href="#cb746-2837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb746-2838"><a href="#cb746-2838" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span><span class="st">"lab-synch"</span>)</span>
<span id="cb746-2839"><a href="#cb746-2839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2840"><a href="#cb746-2840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2841"><a href="#cb746-2841" aria-hidden="true" tabindex="-1"></a><span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span></span>
<span id="cb746-2842"><a href="#cb746-2842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2843"><a href="#cb746-2843" aria-hidden="true" tabindex="-1"></a>adjcat <span class="ot">&lt;-</span> <span class="fu">brm</span>( <span class="at">formula =</span> state <span class="sc">~</span> <span class="fu">cs</span>(condition),</span>
<span id="cb746-2844"><a href="#cb746-2844" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df,</span>
<span id="cb746-2845"><a href="#cb746-2845" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">acat</span>(<span class="st">"probit"</span>),</span>
<span id="cb746-2846"><a href="#cb746-2846" aria-hidden="true" tabindex="-1"></a>               <span class="at">file =</span> <span class="st">"analysis/models/sgc3a_brms_adjcat_q1state.rds"</span> <span class="co"># cache model (can be removed)</span></span>
<span id="cb746-2847"><a href="#cb746-2847" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb746-2848"><a href="#cb746-2848" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb746-2849"><a href="#cb746-2849" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adjcat)</span>
<span id="cb746-2850"><a href="#cb746-2850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2851"><a href="#cb746-2851" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(cumord, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-2852"><a href="#cb746-2852" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(adjcat, <span class="st">"condition"</span>, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-2853"><a href="#cb746-2853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2854"><a href="#cb746-2854" aria-hidden="true" tabindex="-1"></a><span class="co">#WHICH IS BETTER? cumulative or adjacent?</span></span>
<span id="cb746-2855"><a href="#cb746-2855" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(cumord, adjcat))</span>
<span id="cb746-2856"><a href="#cb746-2856" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(cumord, adjcat)</span>
<span id="cb746-2857"><a href="#cb746-2857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2858"><a href="#cb746-2858" aria-hidden="true" tabindex="-1"></a><span class="co"># #TIDYBAYES VISUALIZATION</span></span>
<span id="cb746-2859"><a href="#cb746-2859" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidybayes)</span></span>
<span id="cb746-2860"><a href="#cb746-2860" aria-hidden="true" tabindex="-1"></a><span class="co"># adjcat %&gt;%</span></span>
<span id="cb746-2861"><a href="#cb746-2861" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb746-2862"><a href="#cb746-2862" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb746-2863"><a href="#cb746-2863" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb746-2864"><a href="#cb746-2864" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb746-2865"><a href="#cb746-2865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2866"><a href="#cb746-2866" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cumord)</span>
<span id="cb746-2867"><a href="#cb746-2867" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(adjcat)</span>
<span id="cb746-2868"><a href="#cb746-2868" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(adjcat)</span>
<span id="cb746-2869"><a href="#cb746-2869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2870"><a href="#cb746-2870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb746-2871"><a href="#cb746-2871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-2872"><a href="#cb746-2872" aria-hidden="true" tabindex="-1"></a>*Converges, but estimates are unreliable?*</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>