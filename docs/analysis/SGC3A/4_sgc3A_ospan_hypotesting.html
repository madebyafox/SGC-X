<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.328">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SGC-X - 9&nbsp; SGC3 (OSPAN) Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../analysis/SGC3B/1_sgc3B_introduction.html" rel="next">
<link href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">SGC3 (OSPAN) Hypothesis Testing</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC2</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/3_sgc2_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/4_sgc2_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_lab_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">SGC3A (Lab) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SGC3A (Replication) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_ospan_hypotesting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">SGC3 (OSPAN) Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/4_sgc3B_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">SGC3B (Impasse * Explicit) Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/3_sgc4A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">SGC4C</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/2_sgc4C_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">SGC4D</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4D/1_sgc4D_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4D/2_sgc4D_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sample" id="toc-sample" class="nav-link active" data-scroll-target="#sample">SAMPLE</a>
  <ul class="collapse">
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">Data Collection</a></li>
  <li><a href="#participants" id="toc-participants" class="nav-link" data-scroll-target="#participants">Participants</a></li>
  <li><a href="#ospan" id="toc-ospan" class="nav-link" data-scroll-target="#ospan">OSPAN</a></li>
  </ul></li>
  <li><a href="#overall-accuracy" id="toc-overall-accuracy" class="nav-link" data-scroll-target="#overall-accuracy">OVERALL ACCURACY</a>
  <ul class="collapse">
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#describe" id="toc-describe" class="nav-link" data-scroll-target="#describe">Describe</a>
  <ul class="collapse">
  <li><a href="#wilcoxon-rank-sum-mann-whitney-test" id="toc-wilcoxon-rank-sum-mann-whitney-test" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-mann-whitney-test">WILCOXON RANK SUM (Mann-Whitney Test)</a>
  <ul class="collapse">
  <li><a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">Test</a></li>
  <li><a href="#inference-effect" id="toc-inference-effect" class="nav-link" data-scroll-target="#inference-effect">Inference — EFFECT</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  </ul></li>
  <li><a href="#mixed-logistic-regression-ixn" id="toc-mixed-logistic-regression-ixn" class="nav-link" data-scroll-target="#mixed-logistic-regression-ixn">MIXED LOGISTIC REGRESSION [IXN!!]</a>
  <ul class="collapse">
  <li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#describe-1" id="toc-describe-1" class="nav-link" data-scroll-target="#describe-1">Describe</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">INFERENCE</a></li>
  <li><a href="#interactions" id="toc-interactions" class="nav-link" data-scroll-target="#interactions">Interactions</a></li>
  <li><a href="#print" id="toc-print" class="nav-link" data-scroll-target="#print">Print</a></li>
  <li><a href="#visualize-2" id="toc-visualize-2" class="nav-link" data-scroll-target="#visualize-2">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#overall-interpretation-state" id="toc-overall-interpretation-state" class="nav-link" data-scroll-target="#overall-interpretation-state">OVERALL INTERPRETATION STATE</a>
  <ul class="collapse">
  <li><a href="#setup-1" id="toc-setup-1" class="nav-link" data-scroll-target="#setup-1">Setup</a></li>
  <li><a href="#visualize-3" id="toc-visualize-3" class="nav-link" data-scroll-target="#visualize-3">Visualize</a></li>
  <li><a href="#describe-2" id="toc-describe-2" class="nav-link" data-scroll-target="#describe-2">Describe</a></li>
  <li><a href="#mixed-multinomial-regression" id="toc-mixed-multinomial-regression" class="nav-link" data-scroll-target="#mixed-multinomial-regression">MIXED MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model-brms" id="toc-fit-model-brms" class="nav-link" data-scroll-target="#fit-model-brms">Fit Model [brms]</a></li>
  <li><a href="#describe-3" id="toc-describe-3" class="nav-link" data-scroll-target="#describe-3">Describe</a></li>
  <li><a href="#inference-1" id="toc-inference-1" class="nav-link" data-scroll-target="#inference-1">INFERENCE</a></li>
  <li><a href="#interactions-1" id="toc-interactions-1" class="nav-link" data-scroll-target="#interactions-1">Interactions</a></li>
  <li><a href="#print-1" id="toc-print-1" class="nav-link" data-scroll-target="#print-1">Print</a></li>
  <li><a href="#visualize-4" id="toc-visualize-4" class="nav-link" data-scroll-target="#visualize-4">Visualize</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#q1-accuracy" id="toc-q1-accuracy" class="nav-link" data-scroll-target="#q1-accuracy">Q1 ACCURACY</a>
  <ul class="collapse">
  <li><a href="#setup-2" id="toc-setup-2" class="nav-link" data-scroll-target="#setup-2">Setup</a></li>
  <li><a href="#describe-4" id="toc-describe-4" class="nav-link" data-scroll-target="#describe-4">Describe</a></li>
  <li><a href="#chi-square-yes" id="toc-chi-square-yes" class="nav-link" data-scroll-target="#chi-square-yes">CHI SQUARE [YES]</a></li>
  <li><a href="#logistic-regression-main-effect-condition" id="toc-logistic-regression-main-effect-condition" class="nav-link" data-scroll-target="#logistic-regression-main-effect-condition">LOGISTIC REGRESSION (MAIN EFFECT CONDITION)</a>
  <ul class="collapse">
  <li><a href="#fit-condition-model" id="toc-fit-condition-model" class="nav-link" data-scroll-target="#fit-condition-model">Fit CONDITION Model</a></li>
  <li><a href="#describe-5" id="toc-describe-5" class="nav-link" data-scroll-target="#describe-5">Describe</a></li>
  <li><a href="#inference-2" id="toc-inference-2" class="nav-link" data-scroll-target="#inference-2">Inference</a></li>
  <li><a href="#visualize-5" id="toc-visualize-5" class="nav-link" data-scroll-target="#visualize-5">Visualize</a></li>
  <li><a href="#diagnostics-2" id="toc-diagnostics-2" class="nav-link" data-scroll-target="#diagnostics-2">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#q1-interpretation-state" id="toc-q1-interpretation-state" class="nav-link" data-scroll-target="#q1-interpretation-state">Q1 INTERPRETATION STATE</a>
  <ul class="collapse">
  <li><a href="#setup-3" id="toc-setup-3" class="nav-link" data-scroll-target="#setup-3">Setup</a></li>
  <li><a href="#describe-6" id="toc-describe-6" class="nav-link" data-scroll-target="#describe-6">Describe</a></li>
  <li><a href="#multinomial-regression" id="toc-multinomial-regression" class="nav-link" data-scroll-target="#multinomial-regression">MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-condition-model-1" id="toc-fit-condition-model-1" class="nav-link" data-scroll-target="#fit-condition-model-1">Fit CONDITION Model</a></li>
  <li><a href="#fit-ospan-model" id="toc-fit-ospan-model" class="nav-link" data-scroll-target="#fit-ospan-model">Fit OSPAN Model</a></li>
  <li><a href="#describe-7" id="toc-describe-7" class="nav-link" data-scroll-target="#describe-7">Describe</a></li>
  <li><a href="#inference-3" id="toc-inference-3" class="nav-link" data-scroll-target="#inference-3">Inference</a></li>
  <li><a href="#visualize-6" id="toc-visualize-6" class="nav-link" data-scroll-target="#visualize-6">Visualize</a></li>
  <li><a href="#diagnostics-3" id="toc-diagnostics-3" class="nav-link" data-scroll-target="#diagnostics-3">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#q8-interpretation-state" id="toc-q8-interpretation-state" class="nav-link" data-scroll-target="#q8-interpretation-state">Q8 INTERPRETATION STATE</a>
  <ul class="collapse">
  <li><a href="#setup-4" id="toc-setup-4" class="nav-link" data-scroll-target="#setup-4">Setup</a></li>
  <li><a href="#describe-8" id="toc-describe-8" class="nav-link" data-scroll-target="#describe-8">Describe</a></li>
  <li><a href="#multinomial-regression-1" id="toc-multinomial-regression-1" class="nav-link" data-scroll-target="#multinomial-regression-1">MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-condition-model-2" id="toc-fit-condition-model-2" class="nav-link" data-scroll-target="#fit-condition-model-2">Fit CONDITION Model</a></li>
  <li><a href="#fit-ospan-model-1" id="toc-fit-ospan-model-1" class="nav-link" data-scroll-target="#fit-ospan-model-1">Fit OSPAN Model</a></li>
  <li><a href="#describe-9" id="toc-describe-9" class="nav-link" data-scroll-target="#describe-9">Describe</a></li>
  <li><a href="#inference-4" id="toc-inference-4" class="nav-link" data-scroll-target="#inference-4">Inference</a></li>
  <li><a href="#visualize-7" id="toc-visualize-7" class="nav-link" data-scroll-target="#visualize-7">Visualize</a></li>
  <li><a href="#diagnostics-4" id="toc-diagnostics-4" class="nav-link" data-scroll-target="#diagnostics-4">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#explore-specific-question" id="toc-explore-specific-question" class="nav-link" data-scroll-target="#explore-specific-question">EXPLORE specific question</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-SGC3A-ospan-hypotesting" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">SGC3 (OSPAN) Hypothesis Testing</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Study SGC3A | (OSPAN) Hypothesis Testing</p>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<p><em>The purpose of this notebook is test the hypotheses that determined the design of the SGC3A study WITH OSPAN.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UTILITIES</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy model output</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed models</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#favstats</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite) <span class="co">#saving plots as svg</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZATION</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr) #arrange plots</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cowplot) #arrange shift function plots</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcd) #mosaic plots</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcdExtra) #mosaic plots</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr) <span class="co">#needed for ggdist</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves) <span class="co"># plots. in half</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># violin plot stuffs</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with stats</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#latex tables for models!</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange plots</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELLING</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstatix) #helpful testing functions incl wilcoxon, etc</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#easystats model summary and vis</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qqplotr) #confint on qq plot</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gmodels) #contingency table and CHISQR</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic) #extract model equation</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pscl) #zeroinfl / hurdle models </span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools) <span class="co">#predictInterval</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co">#estimated marginal effects and posthocs on interactions</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects) #visualization log regr models</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">#MULTINOMIAL </span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression [not mixed] #no p values</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#frequentist mixed multinomial logistic regression [mblogit] #gives p values</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr) <span class="co">#executing stan</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#bayesian mixed multinomials [+ other bayesian reg models]</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_minimal()) </span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_clean</span>())</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>TODO UPDATE Research Questions</strong></p>
<p>In SGC3A-OSPAN we set out to answer the following question: Does posing a mental impasse improve performance on the interval graph comprehension task? Does WORKING MEMORY CAPACITY (as measured by the OSPAN task) explain performance on the graph comprehension task?</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants_OSPAN.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">task_percent =</span> DV_percent_NABS,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ospan_split =</span> <span class="fu">recode_factor</span>(ospan_split, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"low-memory"</span> <span class="ot">=</span> <span class="st">"low-memory"</span>, <span class="st">"high-memory"</span><span class="ot">=</span><span class="st">"high-memory"</span>)) <span class="sc">%&gt;%</span> <span class="co">#recode ospan_split as factor with low as reference </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items_OSPAN.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span> (</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.factor</span>(q), </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.factor</span>(subject),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS TRI-LIKE</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state = recode_factor(score_SCALED, #for ordinal</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-1" = "orth-like",</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-0.5" = "unknown",</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0" = "unknown",</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0.5" = "tri-like",</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "1" = "tri-like"),</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS OTHER</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orthogonal"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"angular"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"triangular"</span>),</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">as.ordered</span>(state))</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="do">##ADD OSPAN SCORE TO ITEM RECORD</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>subjects <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(subject,OSPAN.weighted, ospan_split)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> df_items </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">merge</span>(items,subjects)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> items</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(subjects,items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="sample" class="level2">
<h2 class="anchored" data-anchor-id="sample">SAMPLE</h2>
<section id="data-collection" class="level3">
<h3 class="anchored" data-anchor-id="data-collection">Data Collection</h3>
<p>Data was collected (online, via SONA) in Fall 2021. Note that approximately 200 subjects were run in Fall 2021, but only 133 of them completed the OSPAN task. Therefore subjects who did not complete the task are discarded from analysis.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Participants by Condition and Data Collection Period"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Control Condition"</span>,<span class="st">"Impasse Condition"</span>,<span class="st">"Total for Period"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">table</span>(df_subjects<span class="sc">$</span>term, df_subjects<span class="sc">$</span>condition)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>cont <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>() <span class="sc">%&gt;%</span> <span class="fu">kbl</span>(<span class="at">caption =</span> title, <span class="at">col.names =</span> cols) <span class="sc">%&gt;%</span>  <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Participants by Condition and Data Collection Period</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Control Condition </th>
   <th style="text-align:right;"> Impasse Condition </th>
   <th style="text-align:right;"> Total for Period </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> fall21 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 68 </td>
   <td style="text-align:right;"> 133 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sum </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 68 </td>
   <td style="text-align:right;"> 133 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="participants" class="level3">
<h3 class="anchored" data-anchor-id="participants">Participants</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Describe participants</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>subject.stats <span class="ot">&lt;-</span>df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(age) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.male <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">"Male"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.female <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">"Female"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.other <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"Female"</span>,<span class="st">"Male"</span>)) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Participant Age and Gender"</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>subject.stats <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Age in Years"</span>, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">general_title =</span> <span class="st">"Note: "</span>,<span class="at">footnote_as_chunk =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>Descriptive Statistics of Participant Age and Gender</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
   <th style="text-align:right;"> percent.male </th>
   <th style="text-align:right;"> percent.female </th>
   <th style="text-align:right;"> percent.other </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 31 </td>
   <td style="text-align:right;"> 20.6 </td>
   <td style="text-align:right;"> 2.18 </td>
   <td style="text-align:right;"> 133 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.316 </td>
   <td style="text-align:right;"> 0.669 </td>
   <td style="text-align:right;"> 0.015 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> Age in Years</td></tr></tfoot>
</table>

</div>
</div>
<p><strong>REPORTED</strong></p>
<p><strong>Overall</strong> 133 participants (32 % male, 67 % female, 2 % other) undergraduate STEM majors at a public American University participated in exchange for course credit (age: 18 - 31 years).</p>
<p>[230 subjects were recorded to study database in FA21 - 32 pilot sgc3b]</p>
</section>
<section id="ospan" class="level3">
<h3 class="anchored" data-anchor-id="ospan">OSPAN</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of OSPAN Task Accuracy"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ospan.stats <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MATH"</span> <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(OSPAN.math_acc) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>(),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ORDER"</span> <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(OSPAN.order_acc) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>(),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"WEIGHTED"</span> <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(OSPAN.weighted) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>()</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>ospan.stats <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"MATH = %correct of all math questions;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">           ORDER = % correct of OSPAN ordering (out of 30); WEIGHTED = math*ospan number correct"</span>, <span class="at">general_title =</span> <span class="st">"Note: "</span>,<span class="at">footnote_as_chunk =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>Descriptive Statistics of OSPAN Task Accuracy</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> MATH </td>
   <td style="text-align:right;"> 0.517 </td>
   <td style="text-align:right;"> 0.897 </td>
   <td style="text-align:right;"> 0.931 </td>
   <td style="text-align:right;"> 0.966 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.924 </td>
   <td style="text-align:right;"> 0.085 </td>
   <td style="text-align:right;"> 133 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ORDER </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.533 </td>
   <td style="text-align:right;"> 0.733 </td>
   <td style="text-align:right;"> 0.867 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.678 </td>
   <td style="text-align:right;"> 0.253 </td>
   <td style="text-align:right;"> 133 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> WEIGHTED </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 13.448 </td>
   <td style="text-align:right;"> 20.276 </td>
   <td style="text-align:right;"> 24.828 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 19.082 </td>
   <td style="text-align:right;"> 7.391 </td>
   <td style="text-align:right;"> 133 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> MATH = %correct of all math questions;<br>           ORDER = % correct of OSPAN ordering (out of 30); WEIGHTED = math*ospan number correct</td></tr></tfoot>
</table>

</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | DENSITY HISTOGRAM </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> med <span class="ot">=</span> <span class="fu">median</span>(df_subjects<span class="sc">$</span>OSPAN.weighted)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_dhistogram</span>(<span class="sc">~</span>OSPAN.weighted, <span class="at">data =</span> df_subjects) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="sc">~</span>med, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"OSPAN (weighted) score"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"% of subjects"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of OSPAN SCORE"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"line indicates median split"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-SUBJ-OSPAN-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> ospan_split)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ospan_split) + </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"OSPAN SPLIT"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"After taking a median split, comparable high(vs) low in each condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-SUBJ-OSPAN-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="overall-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="overall-accuracy">OVERALL ACCURACY</h2>
<section id="setup" class="level4">
<h4 class="anchored" data-anchor-id="setup">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, accuracy, subject,q, ospan_split)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df_s <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, task_percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize" class="level4">
<h4 class="anchored" data-anchor-id="visualize">Visualize</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">width =</span> <span class="fl">0.75</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"lisa::FridaKahlo"</span>, <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split)<span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = paletteer::paletteer_d("ggthemes::Jewel_Bright", 2))+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 2))+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_brewer(palette = "Set1")  +</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Study 3C | DISTRIBUTION of Question Accuracy"</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse is particularly effective for subjects with high-working memory"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/DESC-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i %&gt;% mutate(</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = fct_rev(accuracy)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )  </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE PLOT WITH LABELS</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- grouped_ggbarstats(data = temp, x = accuracy, y = pretty_condition,</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                grouping.var = ospan_split,</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 2))</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                ))  + theme_clean() </span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIX LABELS</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- p[[1]] +  labs(</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   subtitle = "Impasse is particularly effective for subjects with high-working memory",</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response"</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") </span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;-   p[[2]] + labs(</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response",</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "   "</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") +</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggeasy::easy_remove_axes(which="y", what=c("text","title"))</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   # ggeasy::easy_remove_axes(which="y", what= ""))</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE ROW</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_row &lt;- plot_grid(p1,p2, rel_widths = c(1,0.85))</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># title &lt;- ggdraw() + </span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   draw_label(</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     fontface = 'bold',</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0,</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     hjust = 0</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     # add margin on the left of the drawing canvas,</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     # so title is aligned with left edge of first plot</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot.margin = margin(0, 0, 0, 7)</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co"># pg &lt;- plot_grid(</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   title,</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_row,</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   ncol = 1,</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   # rel_heights values control vertical title margins</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   rel_heights = c(0.1, 1)</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean()</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co"># pg</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(pg, filename = "figures/SGC3A_OSPAN_Accuracy.png", width = 6, height =4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( q <span class="sc">~</span> ospan_split) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accuracy by Question"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Q6 and Q9 are non-discriminative"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: FACETED HISTOGRAM</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_s <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(task_percent))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>task_percent,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_s) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> ospan_split) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Overall Absolute Score (% Correct)"</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="describe" class="level3">
<h3 class="anchored" data-anchor-id="describe">Describe</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct)"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span>task_percent, <span class="at">data =</span> df_s) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct)</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 0.462 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.252 </td>
   <td style="text-align:right;"> 0.37 </td>
   <td style="text-align:right;"> 133 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> pretty_condition </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> control </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.154 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.155 </td>
   <td style="text-align:right;"> 0.303 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> impasse </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 0.788 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.345 </td>
   <td style="text-align:right;"> 0.405 </td>
   <td style="text-align:right;"> 68 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY OSPAN SPLIT"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> ospan_split, <span class="at">data =</span> df_s) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct) BY OSPAN SPLIT</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> ospan_split </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> low-memory </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 0.192 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.195 </td>
   <td style="text-align:right;"> 0.314 </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> high-memory </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 0.769 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.310 </td>
   <td style="text-align:right;"> 0.413 </td>
   <td style="text-align:right;"> 66 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY OSPAN SPLIT &amp; CONDITION"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> ospan_split<span class="sc">+</span>pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct) BY OSPAN SPLIT &amp; CONDITION</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> ospan_split.pretty_condition </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> low-memory.control </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.149 </td>
   <td style="text-align:right;"> 0.297 </td>
   <td style="text-align:right;"> 31 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> high-memory.control </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.154 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.161 </td>
   <td style="text-align:right;"> 0.314 </td>
   <td style="text-align:right;"> 34 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> low-memory.impasse </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 0.423 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.235 </td>
   <td style="text-align:right;"> 0.327 </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> high-memory.impasse </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.308 </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.469 </td>
   <td style="text-align:right;"> 0.451 </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Across both conditions, overall accuracy on the task ranges from 0 to 100 with a mean of 25.217. We see that the distribution of this outcome variable is clearly bimodal: with modes near the floor (0% correct) and ceiling (100% correct) of the scale. This bimodality is sensical considering the nature of the task, where each item in the task indexes a different information extraction operation over the same coordinate system.</p>
<p>Task level accuracy on the graph comprehension task follows the same pattern of behaviour observed in Study 3A: the distribution is bimodal. Total scores were higher in the impasse condition (M = 35%, SD = 41%, n = 65) than control condition (M = 15%, SD = 30%, n = 68), implying a likely main effect of scaffold condition. Comparing total scores across the median split on the OSPAN task (high working memory (vs) low working memory), we see readers with high working memory (M = 31 %, SD = 41%, n = 66) performed better than readers with low working memory (M = 19 %, SD = 31%, n = 67). In Figure <span class="math inline">\(\ref{fig_3C_ospan_raw_accuracy}\)</span> we see that while readers in the impasse condition performed consistently better than those in the control condition, the effect is particularly pronounced for readers with high-working memory, implying a potential interaction between condition and working memory.</p>
<section id="wilcoxon-rank-sum-mann-whitney-test" class="level4">
<h4 class="anchored" data-anchor-id="wilcoxon-rank-sum-mann-whitney-test">WILCOXON RANK SUM (Mann-Whitney Test)</h4>
<ul>
<li><strong>Non parametric alternative</strong> to t-test; compares median rather than mean by ranking data</li>
<li>Does not assume normality</li>
<li>Does not assume equal variance of samples (homogeneity of variance)</li>
</ul>
<section id="test" class="level5">
<h5 class="anchored" data-anchor-id="test">Test</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#WILCOXON ON ACCURACY X OSPAN-SPLIT in LOW WORKING MEMORY</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_low <span class="ot">&lt;-</span> df_s <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ospan_split <span class="sc">==</span> <span class="st">"low-memory"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df_low<span class="sc">$</span>task_percent <span class="sc">~</span> df_low<span class="sc">$</span>pretty_condition,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)) <span class="co">#less, greater</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df_low$task_percent by df_low$pretty_condition
W = 458, p-value = 0.09
alternative hypothesis: true location shift is less than 0</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#WILCOXON ON ACCURACY X OSPAN-SPLIT in HIGH</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_high <span class="ot">&lt;-</span> df_s <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ospan_split <span class="sc">==</span> <span class="st">"high-memory"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df_high<span class="sc">$</span>task_percent <span class="sc">~</span> df_high<span class="sc">$</span>pretty_condition,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)) <span class="co">#less, greater</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df_high$task_percent by df_high$pretty_condition
W = 304, p-value = 0.0005
alternative hypothesis: true location shift is less than 0</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbetweenstats</span>( <span class="at">data =</span> df_s, <span class="at">type =</span> <span class="st">"nonparametric"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> task_percent, <span class="at">x =</span> pretty_condition, <span class="at">grouping.var =</span> ospan_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/TEST-ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="inference-effect" class="level5">
<h5 class="anchored" data-anchor-id="inference-effect">Inference — EFFECT</h5>
<p>A Wilcoxon-Rank sum test on task accuracy x condition for the low-memory participants indicate that impasse is not significantly higher. A Wilcoxon rank sum test on task accuracy x condition for high-memory participants indicate that impasse IS higher. Taken together, this indiates there may be an interaction between working memory and condition.</p>
</section>
<section id="visualize-1" class="level5">
<h5 class="anchored" data-anchor-id="visualize-1">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO   </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">grouped_ggbetweenstats</span>(<span class="at">data =</span> df_s,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> task_percent, <span class="at">x =</span> pretty_condition, <span class="at">grouping.var =</span> ospan_split,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.type =</span> <span class="st">"box"</span>, <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">results.subtitle =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.point.args =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">1</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>               <span class="co"># point.args = list(alpha=0), #suppress points</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggplot.component =</span> <span class="do">## modify further with `{ggplot2}` functions</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Percentage of correct responses across task"</span>, <span class="at">x =</span> <span class="st">""</span>),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">color =</span> pretty_condition, <span class="at">fill =</span> pretty_condition),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">scale_fill_grey</span>(), <span class="fu">scale_color_grey</span>()</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 3)),</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_fill_manual(values = paletteer::paletteer_c("viridis::viridis", 3))</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># theme(axis.text.x = element_text(angle = 90)</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'colour' is already present. Adding another scale for 'colour',
which will replace the existing scale.
Scale for 'colour' is already present. Adding another scale for 'colour',
which will replace the existing scale.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>   ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"High working memory yields higher scores and greater variance in impasse condition"</span>) <span class="sc">+</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span> ggeasy<span class="sc">::</span><span class="fu">easy_remove_axes</span>(<span class="at">which =</span> <span class="st">"x"</span>) <span class="sc">+</span> ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p2, p1, <span class="at">ncol=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Medium' not found in PostScript font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'BarlowSemiCondensed-Bold' not found in PostScript font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
'Barlow Semi Condensed' not found in PostScript font database</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="mixed-logistic-regression-ixn" class="level4">
<h4 class="anchored" data-anchor-id="mixed-logistic-regression-ixn">MIXED LOGISTIC REGRESSION [IXN!!]</h4>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.</em></p>
<section id="fit-model" class="level5">
<h5 class="anchored" data-anchor-id="fit-model">Fit Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SETUP</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm 13 items [all discriminating items]</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_i) <span class="sc">/</span> <span class="fu">nrow</span>(df_s) <span class="sc">==</span> <span class="dv">13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm all factors </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df_i<span class="sc">$</span>q) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>subject) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>pretty_condition) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>accuracy) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>ospan_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Empty fixed model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Empty fixed model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df_i) </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + ITEM</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject Intercept + Item intercept random model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject Intercept + Item intercept random model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.rSQ)</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(m0)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0, mm.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |    Chi2 |      p
---------------------------------------------------
m0     |      glm |  1 |         |         |       
mm.rSQ | glmerMod |  3 |       2 | 1067.62 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0, mm.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  1.47511626235535e-232"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT CONDITION</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Item random intercepts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FIXED Condition + Subject &amp; Item random intercepts"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.CrSQ)</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name    |    Model | df | df_diff |  Chi2 |      p
--------------------------------------------------
mm.rSQ  | glmerMod |  3 |         |       |       
mm.CrSQ | glmerMod |  4 |       1 | 17.23 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0000330410023284755"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 | ADD INTERACTION OSPAN</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition * FIXED OSPAN + Subject &amp; Item random intercepts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FIXED Condition * FIXED OSPAN + Subject &amp; Item random intercepts"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mm.COrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">*</span>ospan_split <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.COrSQ)</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.COrSQ)</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.COrSQ)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.CrSQ,mm.COrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name     |    Model | df | df_diff | Chi2 |     p
-------------------------------------------------
mm.CrSQ  | glmerMod |  4 |         |      |      
mm.COrSQ | glmerMod |  6 |       2 | 6.93 | 0.031</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.CrSQ,mm.COrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0312599524800637"</code></pre>
</div>
</div>
<p><em>A likelihood ratio test indicates adding OSPAN as a fixed effect to a logistic regression model including a fixed effect for CONDITION and random intercepts for SUBJECT and QUESTION explains more variance in the data than the CONDITION + random-effects only model.</em></p>
<p><strong>Condition is better than random effects alone</strong> <span class="math inline">\(chi^2(4,6) = 17.23, p &lt; 0.001\)</span></p>
<p><strong>Adding OSPAN and interaction term better than condition</strong> <span class="math inline">\(chi^2(4,6) = 6.93, p &lt; 0.05\)</span></p>
</section>
<section id="describe-1" class="level5">
<h5 class="anchored" data-anchor-id="describe-1">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.COrSQ</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>m <span class="sc">%&gt;%</span> <span class="fu">write_rds</span>(<span class="at">file =</span> <span class="st">"analysis/SGC3A/models/sgc3a_glmer_acc_mm.COrSQ_OSPAN.rds"</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition * ospan_split + (1 | subject) + (1 |  
    q)
   Data: df_i

     AIC      BIC   logLik deviance df.resid 
     873      906     -430      861     1723 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-7.040 -0.129 -0.031  0.024 11.797 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 31.30    5.59    
 q       (Intercept)  1.18    1.09    
Number of obs: 1729, groups:  subject, 133; q, 13

Fixed effects:
                                               Estimate Std. Error z value
(Intercept)                                      -6.832      1.463   -4.67
pretty_conditionimpasse                           2.348      1.599    1.47
ospan_splithigh-memory                           -0.669      1.432   -0.47
pretty_conditionimpasse:ospan_splithigh-memory    4.845      2.255    2.15
                                               Pr(&gt;|z|)    
(Intercept)                                       3e-06 ***
pretty_conditionimpasse                           0.142    
ospan_splithigh-memory                            0.640    
pretty_conditionimpasse:ospan_splithigh-memory    0.032 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) prtty_ ospn_-
prtty_cndtn -0.602              
ospn_splth- -0.594  0.531       
prtty_cn:_-  0.183 -0.657 -0.625</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFICANCE TEST [non directional]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGNIFICANCE TEST [non directional]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>) <span class="co">#TYPE 3 SS FOR IXNS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: accuracy
                             Chisq Df Pr(&gt;Chisq)    
(Intercept)                  21.80  1      3e-06 ***
pretty_condition              2.15  1      0.142    
ospan_split                   0.22  1      0.640    
pretty_condition:ospan_split  4.62  1      0.032 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m),</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se,</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  effect   group  term  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;   (Int…   -6.83       1.46    -4.67   3.03e-6   -9.70      -3.96
2 fixed    &lt;NA&gt;   pret…    2.35       1.60     1.47   1.42e-1   -0.787      5.48
3 fixed    &lt;NA&gt;   ospa…   -0.669      1.43    -0.467  6.40e-1   -3.47       2.14
4 fixed    &lt;NA&gt;   pret…    4.84       2.25     2.15   3.17e-2    0.425      9.26
5 ran_pars subje… sd__…    5.59      NA       NA     NA         NA         NA   
6 ran_pars q      sd__…    1.09      NA       NA     NA         NA         NA   </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  effect   group  term  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;   (Int…  1.08e-3   0.00158    -4.67   3.03e-6  6.13e-5   1.90e-2
2 fixed    &lt;NA&gt;   pret…  1.05e+1  16.7         1.47   1.42e-1  4.55e-1   2.40e+2
3 fixed    &lt;NA&gt;   ospa…  5.12e-1   0.733      -0.467  6.40e-1  3.10e-2   8.47e+0
4 fixed    &lt;NA&gt;   pret…  1.27e+2 286.          2.15   3.17e-2  1.53e+0   1.05e+4
5 ran_pars subje… sd__…  5.59e+0  NA          NA     NA       NA        NA      
6 ran_pars q      sd__…  1.09e+0  NA          NA     NA       NA        NA      </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PROBABILITIES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">#probability control = plogis(intercept)</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#probability impasse = plogis(intercept + coefficient)</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM predict()</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># newdata &lt;- df_i %&gt;% dplyr::select(pretty_condition, subject, q)</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- predict(m, newdata = newdata, type = "response")</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- cbind(newdata, preds)</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- preds %&gt;% </span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, preds) %&gt;% </span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition) %&gt;% </span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     median = median(preds),</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     se = sd(preds)/sqrt(n()),</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     lwr = median - 1.96*se,</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     upr = median + 1.96*se)</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM merTools</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, subject, q)</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="co">#make predictions</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predictInterval</span>(m, <span class="at">newdata =</span> newdata,</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>                              <span class="at">which =</span> <span class="st">"fixed"</span>, <span class="co">#full, fixed or random for those only</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"probability"</span>, <span class="co">#linear.prediction</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>                              <span class="at">stat =</span> <span class="st">"median"</span>,</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n.sims =</span> <span class="dv">1000</span>,</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>                              <span class="at">level =</span> <span class="fl">0.80</span>) <span class="co">#width of prediction interval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: executing %dopar% sequentially: no parallel backend registered</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#join predictions to the new dataframe</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>(summ_preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, fit, lwr, upr) <span class="sc">%&gt;%</span> </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pretty_condition, ospan_split) <span class="sc">%&gt;%</span> </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(fit),</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">median</span>(lwr),</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">median</span>(upr)</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   pretty_condition [2]
  pretty_condition ospan_split   median     lower   upper
  &lt;fct&gt;            &lt;fct&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 control          low-memory  0.00119  0.000115  0.0118 
2 control          high-memory 0.000589 0.0000722 0.00473
3 impasse          low-memory  0.0118   0.00134   0.0931 
4 impasse          high-memory 0.424    0.0899    0.845  </code></pre>
</div>
</div>
</section>
<section id="inference" class="level5">
<h5 class="anchored" data-anchor-id="inference">INFERENCE</h5>
<p><strong>REPORTED</strong></p>
<p>To explore the effect of working memory capacity on ACCURACY, we fit a mixed effects logistic regression model with random intercepts for subjects and questions, with CONDITION, WORKING MEMORY and their interaction term as fixed effects. A likelihood ratio test indicates that a model including the fixed effect of CONDITION explains significantly more variance in the data than an intercepts-only baseline model (<span class="math inline">\(\chi^2 (3,4) = 17.23, p &lt; 0.001\)</span>). The final model including fixed effects and interaction term of OSPAN is a significantly better fit than the CONDITION-only model (<span class="math inline">\(\chi^2(4,6) = 6.93, p &lt; 0.05\)</span>). The explanatory power of the entire model is substantial (<span class="math inline">\(conditional \ R^2 = 0.92\)</span>) and the part related to the fixed effects CONDITION and WORKING MEMORY (<span class="math inline">\(marginal \ R^2\)</span>) explains 18% of variance.</p>
<p>Although Wald Chi-Square tests revealed no significant main effects, there was a significant interaction between CONDITION and OSPAN, (<span class="math inline">\(\chi^2 (1) = 4.62, p &lt; 0.05\)</span>). [SEE POSTHOCS BELOW]</p>
<p>The model predicts that, in the control condition, the probability of a correct response for a participant with high vs.&nbsp;low working memory increases from (0.1 to 0.5%) a negligible difference. In the impasse condition, however, the probability of a correct response increases from only 1% for participants with low working memory, to 42% for participants with high working memory. These results are consistent with the intuition we develop from Figure TODO. Participants with high working memory capacity are most able to take advantage of the impasse scaffold.</p>
</section>
<section id="interactions" class="level5">
<h5 class="anchored" data-anchor-id="interactions">Interactions</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html#simple</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.oarc.ucla.edu/stata/faq/how-can-i-understand-a-categorical-by-categorical-interaction-in-logistic-regression-stata-12/</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.oarc.ucla.edu/stata/seminars/deciphering-interactions-in-logistic-regression/</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check reference grid</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ref_grid</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'emmGrid' object with variables:
    pretty_condition = control, impasse
    ospan_split = low-memory, high-memory
Transformation: "logit" </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PRINT ESTIMATED MARGINAL MEANS</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#should be same as summ_preds</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m,  <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> pretty_condition ospan_split  prob     SE  df asymp.LCL asymp.UCL
 control          low-memory  0.001 0.0016 Inf    0.0001     0.019
 impasse          low-memory  0.011 0.0151 Inf    0.0008     0.142
 control          high-memory 0.001 0.0007 Inf    0.0000     0.007
 impasse          high-memory 0.423 0.2877 Inf    0.0679     0.881

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">##POST-HOC COMPARISONS</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"POSTHOC COMPARISONS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "POSTHOC COMPARISONS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m,  pairwise <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"response"</span> , <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="co">#sidak, tukey</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 pretty_condition ospan_split  prob     SE  df asymp.LCL asymp.UCL
 control          low-memory  0.001 0.0016 Inf    0.0001     0.019
 impasse          low-memory  0.011 0.0151 Inf    0.0008     0.142
 control          high-memory 0.001 0.0007 Inf    0.0000     0.007
 impasse          high-memory 0.423 0.2877 Inf    0.0679     0.881

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale 

$contrasts
 contrast                                      odds.ratio    SE  df null
 (control low-memory) / (impasse low-memory)         0.10  0.15 Inf    1
 (control low-memory) / (control high-memory)        1.95  2.80 Inf    1
 (control low-memory) / (impasse high-memory)        0.00  0.00 Inf    1
 (impasse low-memory) / (control high-memory)       20.42 30.13 Inf    1
 (impasse low-memory) / (impasse high-memory)        0.02  0.03 Inf    1
 (control high-memory) / (impasse high-memory)       0.00  0.00 Inf    1
 z.ratio p.value
  -1.470  0.1420
   0.470  0.6400
  -3.560  &lt;.0001
   2.040  0.0410
  -2.370  0.0180
  -4.220  &lt;.0001

Tests are performed on the log odds ratio scale </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT INTERACTION</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalent to plot_model, type = "int"</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(m, ospan_split <span class="sc">~</span> pretty_condition ,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">linearg =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>),</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">engine =</span> <span class="st">"ggplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT PROBABILITY</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ref_grid</span>(m), <span class="at">by =</span> <span class="st">"ospan_split"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>REPORTED</strong></p>
<p>Posthoc paired comparisons reveal that there is not a significant difference in accuracy between the control and impasse condition for participants in the low-memory group (OR = 0.1, SE = 0.15, z = -1.47, p = 0.46). For those with low working memory capacity, performance with comparably low, regardless of condition.</p>
<p>For those who were assigned to the control condition, working memory capacity did not change performance. There was not significant difference in accuracy between participants with low vs.&nbsp;high working memory (OR = 1.95, SE= 2.80, z = 0.47 p = 0.97).</p>
<p>For those assigned to the impasse condition, however, if you had high working memory capacity, you had significantly higher probability of accurate responses (OR = 0.02, SE = 0.03, z = -2.370 p = 0.0180).</p>
</section>
<section id="print" class="level5">
<h5 class="anchored" data-anchor-id="print">Print</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># title = "Study 3C (OSPAN) | Question Accuracy | Mixed Logistic Regression"</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              paste("n = ",n_obs(m), "R^2(Conditional) =", round(r2(m)[[1]],2),</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                    "R^2(Marginal) =", round(r2(m)[[2]],2)),</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              "Accuracy  ~ Condition * OSPAN +  (1 | subject) + (1 | q)")</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = title,</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "tables/SGC3C_OSPAN_GLMER_OverallAccuracy.tex")</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a><span class="co">#              # coef_omit = "Intercept",</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a><span class="co"># extract_eq(m, use_coefs = TRUE, wrap = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-2" class="level5">
<h5 class="anchored" data-anchor-id="visualize-2">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Estimate | Odds Ratio"</span>,</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m, exponentiate = TRUE, component = "all")</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ONLY FOR BAYESIAN VERSION</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- rope(m)</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- pd(m)</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"int"</span>,</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-ACC-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-ACC-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$ospan_split</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-ACC-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"eff"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-ACC-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$ospan_split</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-ACC-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co">#GGDIST | MODEL | PREDICTED PROBABILITIES</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>preds <span class="sc">%&gt;%</span> </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">x =</span> fit, <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> ospan_split)) <span class="sc">+</span> </span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">normalize =</span> <span class="st">"panels"</span>) <span class="sc">+</span> </span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model PREDICTION | Probability of Accurate Response"</span>,</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"TODO check preds to see if fixed or includes random"</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 416 rows containing missing values (stat_slabinterval).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-ACC-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list('"* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001"',</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                'N(subject) = 133 $\tau_{00}$(subject) = 34.85',</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              'N(question) = 13 $\tau_{00}$(question) = 1.14')</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_online.tex")</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # #              # coef_omit = "Intercept",</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PERFORMANCE")</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DIAGNOSTICS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DIAGNOSTICS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-DIAG-ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="overall-interpretation-state" class="level2">
<h2 class="anchored" data-anchor-id="overall-interpretation-state">OVERALL INTERPRETATION STATE</h2>
<ul>
<li><p><strong>“orthogonal”</strong> [reference category] includes orthogonal and satisficing responses ==&gt; indicates a primarily <em>orthogonal</em> state of coordinate system understanding</p></li>
<li><p><strong>“other”</strong> includes: blank, reference point, responses that can’t be classified (including selecting all datapoints), =&gt; indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly <em>not</em> orthogonal nor triangular</p></li>
<li><p><strong>“angular”</strong> includes ‘lines connecting’ responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
<li><p><strong>“triangular”</strong> includes correct triangular and ‘lines connecting’ responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
</ul>
<section id="setup-1" class="level4">
<h4 class="anchored" data-anchor-id="setup-1">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,subject,state,pretty_condition, ospan_split) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-3" class="level4">
<h4 class="anchored" data-anchor-id="visualize-3">Visualize</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split) <span class="sc">+</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation across all Questions"</span>,</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_brewer(palette = "Set1")  +</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(q <span class="sc">~</span> ospan_split) <span class="sc">+</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation by Question"</span>,</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i %&gt;% mutate(</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   state = fct_rev(state)</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )  </span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;-   grouped_ggbarstats(data = temp, x = state, y = pretty_condition,</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                           grouping.var = ospan_split,</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 4))</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                ))  + theme_clean() + theme(legend.position = "bottom")</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- p + labs(title = "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="co">#          y = "Proportion of Questions", x = "Condition",</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="co">#          subtitle = "Impasse condition yields more correct responses")</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="co"># p</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(p, filename = "figures/SGC3A_LAB_Accuracy.png", width = 6, height =4)</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i </span></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a><span class="co"># # %&gt;% mutate(</span></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a><span class="co"># #   accuracy = fct_rev(accuracy)</span></span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a><span class="co"># # )</span></span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE PLOT WITH LABELS</span></span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- grouped_ggbarstats(data = temp, x = state, y = pretty_condition,</span></span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                grouping.var = ospan_split,</span></span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 4))</span></span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                )) </span></span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIX LABELS</span></span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- p[[1]] +  labs(</span></span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   subtitle = "Impasse is particularly effective for subjects with high-working memory",</span></span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response"</span></span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") </span></span>
<span id="cb113-46"><a href="#cb113-46" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;-   p[[2]] + labs(</span></span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response",</span></span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "   "</span></span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") +</span></span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggeasy::easy_remove_axes(which="y", what=c("text","title"))</span></span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   # ggeasy::easy_remove_axes(which="y", what= ""))</span></span>
<span id="cb113-53"><a href="#cb113-53" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-54"><a href="#cb113-54" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE ROW</span></span>
<span id="cb113-55"><a href="#cb113-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-56"><a href="#cb113-56" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_row &lt;- plot_grid(p1,p2, rel_widths = c(1,0.85))</span></span>
<span id="cb113-57"><a href="#cb113-57" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-58"><a href="#cb113-58" aria-hidden="true" tabindex="-1"></a><span class="co"># title &lt;- ggdraw() + </span></span>
<span id="cb113-59"><a href="#cb113-59" aria-hidden="true" tabindex="-1"></a><span class="co">#   draw_label(</span></span>
<span id="cb113-60"><a href="#cb113-60" aria-hidden="true" tabindex="-1"></a><span class="co">#     "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb113-61"><a href="#cb113-61" aria-hidden="true" tabindex="-1"></a><span class="co">#     fontface = 'bold',</span></span>
<span id="cb113-62"><a href="#cb113-62" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0,</span></span>
<span id="cb113-63"><a href="#cb113-63" aria-hidden="true" tabindex="-1"></a><span class="co">#     hjust = 0</span></span>
<span id="cb113-64"><a href="#cb113-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb113-65"><a href="#cb113-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb113-66"><a href="#cb113-66" aria-hidden="true" tabindex="-1"></a><span class="co">#     # add margin on the left of the drawing canvas,</span></span>
<span id="cb113-67"><a href="#cb113-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     # so title is aligned with left edge of first plot</span></span>
<span id="cb113-68"><a href="#cb113-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot.margin = margin(0, 0, 0, 7)</span></span>
<span id="cb113-69"><a href="#cb113-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb113-70"><a href="#cb113-70" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-71"><a href="#cb113-71" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-72"><a href="#cb113-72" aria-hidden="true" tabindex="-1"></a><span class="co"># pg &lt;- plot_grid(</span></span>
<span id="cb113-73"><a href="#cb113-73" aria-hidden="true" tabindex="-1"></a><span class="co">#   title,</span></span>
<span id="cb113-74"><a href="#cb113-74" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_row,</span></span>
<span id="cb113-75"><a href="#cb113-75" aria-hidden="true" tabindex="-1"></a><span class="co">#   ncol = 1,</span></span>
<span id="cb113-76"><a href="#cb113-76" aria-hidden="true" tabindex="-1"></a><span class="co">#   # rel_heights values control vertical title margins</span></span>
<span id="cb113-77"><a href="#cb113-77" aria-hidden="true" tabindex="-1"></a><span class="co">#   rel_heights = c(0.1, 1)</span></span>
<span id="cb113-78"><a href="#cb113-78" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean()</span></span>
<span id="cb113-79"><a href="#cb113-79" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb113-80"><a href="#cb113-80" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-81"><a href="#cb113-81" aria-hidden="true" tabindex="-1"></a><span class="co"># update_geom_defaults("text", list(colour = "grey20", family = theme_get()$text$family))</span></span>
<span id="cb113-82"><a href="#cb113-82" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-83"><a href="#cb113-83" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-84"><a href="#cb113-84" aria-hidden="true" tabindex="-1"></a><span class="co"># pg</span></span>
<span id="cb113-85"><a href="#cb113-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-86"><a href="#cb113-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-87"><a href="#cb113-87" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(pg, filename = "figures/SGC3A_OSPAN_Accuracy.png", width = 6, height =4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-2" class="level4">
<h4 class="anchored" data-anchor-id="describe-2">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             control impasse    Sum
  orthogonal  0.6686  0.3224 0.4916
  other       0.1361  0.2704 0.2047
  angular     0.0402  0.0622 0.0515
  triangular  0.1550  0.3450 0.2522
  Sum         1.0000  1.0000 1.0000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition, df_i<span class="sc">$</span>ospan_split) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = low-memory

            
             control impasse Sum
  orthogonal     269     171 440
  other           58     151 209
  angular         16      36  52
  triangular      60     110 170
  Sum            403     468 871

, ,  = high-memory

            
             control impasse Sum
  orthogonal     296     114 410
  other           57      88 145
  angular         18      19  37
  triangular      71     195 266
  Sum            442     416 858</code></pre>
</div>
</div>
</section>
<section id="mixed-multinomial-regression" class="level4">
<h4 class="anchored" data-anchor-id="mixed-multinomial-regression">MIXED MULTINOMIAL REGRESSION</h4>
<p><em>Does condition affect the response state of of items across the task?</em></p>
<p><em>Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).</em></p>
<ul>
<li>mblogit version wouldn’t coverge, so using brms</li>
</ul>
<section id="fit-model-brms" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-brms">Fit Model [brms]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>inf_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS </span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on COEFFICIENT</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>ixn_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS </span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on CONDITION COEFFICIENT</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on OSPAN COEFFICIENT</span></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on IXN COEFFICIENT</span></span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse:ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse:ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse:ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN RANDOM ONLY</span></span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>Bmm.cat.rSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.rSQ_OSPAN.rds"</span>)</span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a><span class="co"># CONDITION ONLY MODEL</span></span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a>Bmm.cat.CrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> inf_priors,</span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.CrSQ_OSPAN.rds"</span>)</span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a><span class="do">##MODEL COMPARISON</span></span>
<span id="cb118-62"><a href="#cb118-62" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL COMPARISON: random effects (vs) CONDITION")</span></span>
<span id="cb118-63"><a href="#cb118-63" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesfactor(Bmm.cat.rSQ, Bmm.cat.CrSQ)</span></span>
<span id="cb118-64"><a href="#cb118-64" aria-hidden="true" tabindex="-1"></a><span class="co">#substantial evidence in favor of conditon model over random only BF 1.64e+16</span></span>
<span id="cb118-65"><a href="#cb118-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-66"><a href="#cb118-66" aria-hidden="true" tabindex="-1"></a><span class="co"># CONDITION + OSPAN MODEL</span></span>
<span id="cb118-67"><a href="#cb118-67" aria-hidden="true" tabindex="-1"></a>Bmm.cat.COrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition<span class="sc">*</span>ospan_split <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb118-68"><a href="#cb118-68" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb118-69"><a href="#cb118-69" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> ixn_priors,</span>
<span id="cb118-70"><a href="#cb118-70" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb118-71"><a href="#cb118-71" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb118-72"><a href="#cb118-72" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb118-73"><a href="#cb118-73" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb118-74"><a href="#cb118-74" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb118-75"><a href="#cb118-75" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb118-76"><a href="#cb118-76" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.COrSQ_OSPAN.rds"</span>)</span>
<span id="cb118-77"><a href="#cb118-77" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.cat.COrSQ)</span></span>
<span id="cb118-78"><a href="#cb118-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-79"><a href="#cb118-79" aria-hidden="true" tabindex="-1"></a><span class="do">##MODEL COMPARISON</span></span>
<span id="cb118-80"><a href="#cb118-80" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL COMPARISON: COND*OSPAN (vs) CONDITION")</span></span>
<span id="cb118-81"><a href="#cb118-81" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesfactor(Bmm.cat.COrSQ, Bmm.cat.CrSQ)</span></span>
<span id="cb118-82"><a href="#cb118-82" aria-hidden="true" tabindex="-1"></a><span class="co">#commment out bc we'll do this in next block</span></span>
<span id="cb118-83"><a href="#cb118-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-84"><a href="#cb118-84" aria-hidden="true" tabindex="-1"></a><span class="co">#which model is better?</span></span>
<span id="cb118-85"><a href="#cb118-85" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(Bmm.cat.CrSQ, Bmm.cat.COrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                                                   |         Bmm.cat.CrSQ |        Bmm.cat.COrSQ
---------------------------------------------------------------------------------------------------------
muother_Intercept                                           | -2.03 (-2.82, -1.27) | -1.95 (-2.80, -1.18)
muangular_Intercept                                         | -3.94 (-5.19, -2.71) | -4.10 (-5.53, -2.72)
mutriangular_Intercept                                      | -4.70 (-6.43, -3.14) | -4.82 (-6.86, -2.93)
muother_pretty_conditionimpasse                             |  1.80 ( 1.37,  2.25) |  1.81 ( 1.23,  2.45)
muangular_pretty_conditionimpasse                           |  1.67 ( 0.90,  2.50) |  1.85 ( 0.79,  3.00)
mutriangular_pretty_conditionimpasse                        |  3.56 ( 1.61,  5.54) |  2.45 ( 0.24,  4.68)
muother_ospan_splithighMmemory                              |                      | -0.18 (-0.81,  0.45)
muother_pretty_conditionimpasse:ospan_splithighMmemory      |                      | -0.08 (-0.98,  0.81)
mutriangular_ospan_splithighMmemory                         |                      |  0.07 (-2.25,  2.28)
muangular_ospan_splithighMmemory                            |                      |  0.16 (-1.01,  1.32)
muangular_pretty_conditionimpasse:ospan_splithighMmemory    |                      | -0.33 (-1.84,  1.23)
mutriangular_pretty_conditionimpasse:ospan_splithighMmemory |                      |  2.76 (-0.12,  5.52)
---------------------------------------------------------------------------------------------------------
Observations                                                |                 1729 |                 1729</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare_performance(Bmm.cat.CrSQ, Bmm.cat.COrSQ)</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.cat.CrSQ, mm.cat.COrSQ)</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.cat.COrSQ)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-3" class="level5">
<h5 class="anchored" data-anchor-id="describe-3">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> Bmm.cat.COrSQ</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: categorical 
  Links: muother = logit; muangular = logit; mutriangular = logit 
Formula: state ~ pretty_condition * ospan_split + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 1729) 
  Draws: 4 chains, each with iter = 2500; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Group-Level Effects: 
~q (Number of levels: 13) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muother_Intercept)          1.28      0.32     0.81     2.07 1.00     1338
sd(muangular_Intercept)        1.97      0.56     1.18     3.36 1.00     1556
sd(mutriangular_Intercept)     1.50      0.37     0.95     2.37 1.00     1924
                           Tail_ESS
sd(muother_Intercept)          2804
sd(muangular_Intercept)        2534
sd(mutriangular_Intercept)     3273

~subject (Number of levels: 133) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muother_Intercept)          0.90      0.13     0.66     1.17 1.00     2005
sd(muangular_Intercept)        1.65      0.28     1.15     2.24 1.00     1800
sd(mutriangular_Intercept)     5.33      0.62     4.25     6.65 1.00     1149
                           Tail_ESS
sd(muother_Intercept)          3045
sd(muangular_Intercept)        3459
sd(mutriangular_Intercept)     2307

Population-Level Effects: 
                                                            Estimate Est.Error
muother_Intercept                                              -1.96      0.42
muangular_Intercept                                            -4.11      0.71
mutriangular_Intercept                                         -4.85      1.00
muother_pretty_conditionimpasse                                 1.82      0.31
muother_ospan_splithighMmemory                                 -0.18      0.32
muother_pretty_conditionimpasse:ospan_splithighMmemory         -0.07      0.45
muangular_pretty_conditionimpasse                               1.86      0.56
muangular_ospan_splithighMmemory                                0.16      0.59
muangular_pretty_conditionimpasse:ospan_splithighMmemory       -0.32      0.78
mutriangular_pretty_conditionimpasse                            2.47      1.12
mutriangular_ospan_splithighMmemory                             0.05      1.17
mutriangular_pretty_conditionimpasse:ospan_splithighMmemory     2.74      1.46
                                                            l-95% CI u-95% CI
muother_Intercept                                              -2.80    -1.18
muangular_Intercept                                            -5.53    -2.72
mutriangular_Intercept                                         -6.86    -2.93
muother_pretty_conditionimpasse                                 1.23     2.45
muother_ospan_splithighMmemory                                 -0.81     0.45
muother_pretty_conditionimpasse:ospan_splithighMmemory         -0.98     0.81
muangular_pretty_conditionimpasse                               0.79     3.00
muangular_ospan_splithighMmemory                               -1.01     1.32
muangular_pretty_conditionimpasse:ospan_splithighMmemory       -1.84     1.23
mutriangular_pretty_conditionimpasse                            0.24     4.68
mutriangular_ospan_splithighMmemory                            -2.25     2.28
mutriangular_pretty_conditionimpasse:ospan_splithighMmemory    -0.12     5.52
                                                            Rhat Bulk_ESS
muother_Intercept                                           1.00     1051
muangular_Intercept                                         1.00     1411
mutriangular_Intercept                                      1.00     1109
muother_pretty_conditionimpasse                             1.00     2022
muother_ospan_splithighMmemory                              1.00     2358
muother_pretty_conditionimpasse:ospan_splithighMmemory      1.00     1927
muangular_pretty_conditionimpasse                           1.00     1894
muangular_ospan_splithighMmemory                            1.00     1947
muangular_pretty_conditionimpasse:ospan_splithighMmemory    1.00     1990
mutriangular_pretty_conditionimpasse                        1.00      819
mutriangular_ospan_splithighMmemory                         1.01     1166
mutriangular_pretty_conditionimpasse:ospan_splithighMmemory 1.00     1281
                                                            Tail_ESS
muother_Intercept                                               2068
muangular_Intercept                                             2534
mutriangular_Intercept                                          1663
muother_pretty_conditionimpasse                                 2940
muother_ospan_splithighMmemory                                  3218
muother_pretty_conditionimpasse:ospan_splithighMmemory          3157
muangular_pretty_conditionimpasse                               2465
muangular_ospan_splithighMmemory                                3299
muangular_pretty_conditionimpasse:ospan_splithighMmemory        2629
mutriangular_pretty_conditionimpasse                            1699
mutriangular_ospan_splithighMmemory                             2366
mutriangular_pretty_conditionimpasse:ospan_splithighMmemory     2310

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(<span class="at">ci=</span>.<span class="dv">95</span>, m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Posterior Distribution

Parameter                                                   | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS
--------------------------------------------------------------------------------------------------------------------------------------------
muother_Intercept                                           |  -1.95 | [-2.80, -1.18] |   100% | [-0.18, 0.18] |        0% | 1.001 | 1040.00
muangular_Intercept                                         |  -4.10 | [-5.53, -2.72] |   100% | [-0.18, 0.18] |        0% | 1.000 | 1378.00
mutriangular_Intercept                                      |  -4.82 | [-6.86, -2.93] |   100% | [-0.18, 0.18] |        0% | 1.000 | 1102.00
muother_pretty_conditionimpasse                             |   1.81 | [ 1.23,  2.45] |   100% | [-0.18, 0.18] |        0% | 1.001 | 1993.00
muother_ospan_splithighMmemory                              |  -0.18 | [-0.81,  0.45] | 71.52% | [-0.18, 0.18] |    38.68% | 1.001 | 2323.00
muother_pretty_conditionimpasse:ospan_splithighMmemory      |  -0.08 | [-0.98,  0.81] | 56.37% | [-0.18, 0.18] |    32.33% | 1.001 | 1907.00
muangular_pretty_conditionimpasse                           |   1.85 | [ 0.79,  3.00] | 99.98% | [-0.18, 0.18] |        0% | 1.001 | 1900.00
muangular_ospan_splithighMmemory                            |   0.16 | [-1.01,  1.32] | 60.73% | [-0.18, 0.18] |    25.18% | 1.002 | 1892.00
muangular_pretty_conditionimpasse:ospan_splithighMmemory    |  -0.33 | [-1.84,  1.23] | 66.37% | [-0.18, 0.18] |    17.42% | 1.000 | 1986.00
mutriangular_pretty_conditionimpasse                        |   2.45 | [ 0.24,  4.68] | 98.75% | [-0.18, 0.18] |        0% | 1.002 |  824.00
mutriangular_ospan_splithighMmemory                         |   0.07 | [-2.25,  2.28] | 52.40% | [-0.18, 0.18] |    12.63% | 1.005 | 1164.00
mutriangular_pretty_conditionimpasse:ospan_splithighMmemory |   2.76 | [-0.12,  5.52] | 97.03% | [-0.18, 0.18] |     1.37% | 1.001 | 1268.00</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"BAYES FACTOR [comparison to CONDITION only]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BAYES FACTOR [comparison to CONDITION only]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#think of this like the anova(model) to get p values for each predictor</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co">#has to recompile the models with rstan. total drag</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">bayesfactor</span>(Bmm.cat.CrSQ, m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Bayes factors might not be precise.
For precise Bayes factors, sampling at least 40,000 posterior samples is recommended.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computation of Bayes factors: estimating marginal likelihood, please wait...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Recompiling the model with 'rstan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Recompilation done</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: logml could not be estimated within maxiter, rerunning with adjusted starting value. 
Estimate might be more variable than usual.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: logml could not be estimated within maxiter, rerunning with adjusted starting value. 
Estimate might be more variable than usual.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factors for Model Comparison

    Model                                                       BF
[2] pretty_condition * ospan_split + (1 | subject) + (1 | q) 0.380

* Against Denominator: [1] pretty_condition + (1 | subject) + (1 | q)
*   Bayes Factor Type: marginal likelihoods (bridgesampling)</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># already calculated this in step above</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DESCRIBE POSTERIOR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DESCRIBE POSTERIOR"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>(l <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Posterior Distribution

Parameter                                                   | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS
--------------------------------------------------------------------------------------------------------------------------------------------
muother_Intercept                                           |  -1.95 | [-2.80, -1.18] |   100% | [-0.18, 0.18] |        0% | 1.001 | 1040.00
muangular_Intercept                                         |  -4.10 | [-5.53, -2.72] |   100% | [-0.18, 0.18] |        0% | 1.000 | 1378.00
mutriangular_Intercept                                      |  -4.82 | [-6.86, -2.93] |   100% | [-0.18, 0.18] |        0% | 1.000 | 1102.00
muother_pretty_conditionimpasse                             |   1.81 | [ 1.23,  2.45] |   100% | [-0.18, 0.18] |        0% | 1.001 | 1993.00
muother_ospan_splithighMmemory                              |  -0.18 | [-0.81,  0.45] | 71.52% | [-0.18, 0.18] |    38.68% | 1.001 | 2323.00
muother_pretty_conditionimpasse:ospan_splithighMmemory      |  -0.08 | [-0.98,  0.81] | 56.37% | [-0.18, 0.18] |    32.33% | 1.001 | 1907.00
muangular_pretty_conditionimpasse                           |   1.85 | [ 0.79,  3.00] | 99.98% | [-0.18, 0.18] |        0% | 1.001 | 1900.00
muangular_ospan_splithighMmemory                            |   0.16 | [-1.01,  1.32] | 60.73% | [-0.18, 0.18] |    25.18% | 1.002 | 1892.00
muangular_pretty_conditionimpasse:ospan_splithighMmemory    |  -0.33 | [-1.84,  1.23] | 66.37% | [-0.18, 0.18] |    17.42% | 1.000 | 1986.00
mutriangular_pretty_conditionimpasse                        |   2.45 | [ 0.24,  4.68] | 98.75% | [-0.18, 0.18] |        0% | 1.002 |  824.00
mutriangular_ospan_splithighMmemory                         |   0.07 | [-2.25,  2.28] | 52.40% | [-0.18, 0.18] |    12.63% | 1.005 | 1164.00
mutriangular_pretty_conditionimpasse:ospan_splithighMmemory |   2.76 | [-0.12,  5.52] | 97.03% | [-0.18, 0.18] |     1.37% | 1.001 | 1268.00</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (tm &lt;- tidy(m,   conf.int = TRUE))</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                                                   |   Median |         95% CI |     pd | % in ROPE |  Rhat |     ESS
------------------------------------------------------------------------------------------------------------------------------
muother_Intercept                                           |     0.14 | [0.06,   0.31] |   100% |        0% | 1.001 | 1040.00
muangular_Intercept                                         |     0.02 | [0.00,   0.07] |   100% |        0% | 1.000 | 1378.00
mutriangular_Intercept                                      | 8.07e-03 | [0.00,   0.05] |   100% |        0% | 1.000 | 1102.00
muother_pretty_conditionimpasse                             |     6.13 | [3.42,  11.53] |   100% |        0% | 1.001 | 1993.00
muother_ospan_splithighMmemory                              |     0.83 | [0.44,   1.56] | 71.52% |    38.68% | 1.001 | 2323.00
muother_pretty_conditionimpasse:ospan_splithighMmemory      |     0.93 | [0.38,   2.25] | 56.37% |    32.33% | 1.001 | 1907.00
muangular_pretty_conditionimpasse                           |     6.39 | [2.21,  20.08] | 99.98% |        0% | 1.001 | 1900.00
muangular_ospan_splithighMmemory                            |     1.18 | [0.37,   3.74] | 60.73% |    25.18% | 1.002 | 1892.00
muangular_pretty_conditionimpasse:ospan_splithighMmemory    |     0.72 | [0.16,   3.41] | 66.37% |    17.42% | 1.000 | 1986.00
mutriangular_pretty_conditionimpasse                        |    11.64 | [1.27, 107.34] | 98.75% |        0% | 1.002 |  824.00
mutriangular_ospan_splithighMmemory                         |     1.07 | [0.11,   9.76] | 52.40% |    12.63% | 1.005 | 1164.00
mutriangular_pretty_conditionimpasse:ospan_splithighMmemory |    15.73 | [0.89, 249.91] | 97.03% |     1.37% | 1.001 | 1268.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a MCMC distribution approximation.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PROBABILITIES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICT METHOD</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, subject, q)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> newdata, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lengthen data frame to handle multinomial</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>subject, <span class="sc">-</span>q) <span class="sc">%&gt;%</span> <span class="co">#marginalize over subject and q</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>pretty_condition <span class="sc">&amp;</span> <span class="sc">!</span>ospan_split,</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"preds"</span>,</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"state"</span>,</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pretty_condition, ospan_split, state ) <span class="sc">%&gt;%</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(preds),</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(preds)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwr =</span> median <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">upr =</span> median <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 7
# Groups:   pretty_condition, ospan_split [4]
   pretty_condition ospan_split state             median      se      lwr    upr
   &lt;fct&gt;            &lt;fct&gt;       &lt;chr&gt;              &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 control          low-memory  P(Y = angular)   0.0137  0.00377  0.00627 0.0211
 2 control          low-memory  P(Y = orthogona… 0.755   0.0141   0.728   0.783 
 3 control          low-memory  P(Y = other)     0.133   0.00577  0.122   0.144 
 4 control          low-memory  P(Y = triangula… 0.00983 0.0145  -0.0186  0.0383
 5 control          high-memory P(Y = angular)   0.0158  0.00296  0.0100  0.0216
 6 control          high-memory P(Y = orthogona… 0.774   0.0142   0.746   0.801 
 7 control          high-memory P(Y = other)     0.0963  0.00566  0.0852  0.107 
 8 control          high-memory P(Y = triangula… 0.00717 0.0146  -0.0215  0.0359
 9 impasse          low-memory  P(Y = angular)   0.037   0.00473  0.0277  0.0463
10 impasse          low-memory  P(Y = orthogona… 0.337   0.0119   0.314   0.361 
11 impasse          low-memory  P(Y = other)     0.324   0.00986  0.305   0.343 
12 impasse          low-memory  P(Y = triangula… 0.0512  0.0152   0.0214  0.0811
13 impasse          high-memory P(Y = angular)   0.0123  0.00371  0.00507 0.0196
14 impasse          high-memory P(Y = orthogona… 0.161   0.0140   0.133   0.188 
15 impasse          high-memory P(Y = other)     0.110   0.0112   0.0885  0.133 
16 impasse          high-memory P(Y = triangula… 0.341   0.0215   0.298   0.383 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="do">##DRAWS METHOD</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE draws from model</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a><span class="co"># #OR load from file</span></span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws &lt;- read_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # SUMMARIZE draws from model</span></span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="co"># (k &lt;- kable(draws %&gt;%</span></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition, .category) %&gt;%</span></span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   median_hdci(.value), digits = 4, col.names =</span></span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     c("Condition","Category", "Probability","Lower Cred.I","Upper Cred.I", "CI Width", "Point Type", "Interval Type")) %&gt;%</span></span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   kable_styling())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="inference-1" class="level5">
<h5 class="anchored" data-anchor-id="inference-1">INFERENCE</h5>
<p><strong>Reported</strong></p>
<p>To quantify the effect of working memory capacity on INTERPRETATION, we fit a (bayesian) mixed multinomial regression model with random intercepts for subjects and questions. A Bayes Factor model comparison (against a random intercepts + CONDITION model) indicates strong evidence for a a final model including fixed effects of CONDITION, OSPAN and their interaction term (BF = 8.52).</p>
<p>(note, the BF may change as it is estimated via simulation each time)</p>
</section>
<section id="interactions-1" class="level5">
<h5 class="anchored" data-anchor-id="interactions-1">Interactions</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EMMEANS doesn't support multinomial brms models. BUMMER</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="co">#BUT brms has some built in stuffs. </span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co"># FOR MAIN EFFECTS PLOTS </span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MAIN EFFECTS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MAIN EFFECTS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(m, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Interactions cannot be plotted directly if 'categorical' is TRUE.
Please use argument 'conditions' instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"INTERACTION PLOT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "INTERACTION PLOT"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># conditions &lt;- make_conditions(m, vars = c("pretty_condition","ospan_split"))</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">&lt;-</span> <span class="fu">make_conditions</span>(m, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"pretty_condition"</span>))</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(m, <span class="st">"ospan_split"</span>, <span class="at">conditions =</span> conditions,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"INTERACTION PLOT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "INTERACTION PLOT"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"int"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Note: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-26-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>REPORTED</strong></p>
<p>The model predicts similar probabilities for orthogonal, other, and angular interpretations by high vs.&nbsp;low working memory participants. It is only the (correct) triangular interpretation in which we have evidence for a reliable interaction between OSPAN and CONDITION. Much like the pattern of results for accuracy, it is high working memory participants with higher probability of triangular responses, but only in impasse condition.</p>
</section>
<section id="print-1" class="level5">
<h5 class="anchored" data-anchor-id="print-1">Print</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co">#model summary doesn't work for brms multinomial</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="co"># DOESN'T WORK FOR BRMS</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="co"># extract_eq(m, use_coefs = TRUE, wrap = TRUE)</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="co"># #GET MODEL ESTIMATES</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a><span class="co"># t &lt;- as.data.frame(model_parameters(m, exponentiate = TRUE))</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # #REFORMAT</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- t %&gt;%</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     Parameter = str_remove_all(Parameter,"_pretty"),</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     Parameter = str_remove_all(Parameter,"b_mu"),</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     Interpretation = word(Parameter, 1, sep = "_"),</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     Interpretation = fct_relevel(Interpretation, levels = c("other","angular","triangular")),</span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     Factor = word(Parameter, 2, sep = "_"),</span></span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     Factor = recode_factor(Factor,</span></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "Intercept" = "(Intercept)",</span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "conditionimpasse" = "Condition[impasse]",</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ospan" = "OSPAN[high-memory]",</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "conditionimpasse:ospan" = "Condition:OSPAN"),</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     Median = round(Median,2),</span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     CI_low = round(CI_low,2),</span></span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     CI_high = round(CI_high,2),</span></span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     pd = round(pd,2),</span></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     ROPE_Percentage = round(ROPE_Percentage,2)) %&gt;%</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(Interpretation) %&gt;%</span></span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(-CI, -Rhat, -ESS) %&gt;%</span></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename( "%_in_ROPE"="ROPE_Percentage",</span></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   "(Odds Ratio)" = "Median") %&gt;%</span></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(Interpretation, Factor, `(Odds Ratio)`, CI_low, CI_high, pd, `%_in_ROPE`)</span></span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # #KNIT</span></span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a><span class="co"># title = "Study 3C (OSPAN) | Question Interpretation | Mixed Multinomial Regression"</span></span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a><span class="co"># tab &lt;- kbl(x, format = "latex", caption = title,</span></span>
<span id="cb164-41"><a href="#cb164-41" aria-hidden="true" tabindex="-1"></a><span class="co">#            booktabs = FALSE) %&gt;% kable_classic() %&gt;%</span></span>
<span id="cb164-42"><a href="#cb164-42" aria-hidden="true" tabindex="-1"></a><span class="co"># footnote(general = paste("Model Interpretation ~ ",b$Model[2], "Bayes Factor ", format( exp(b$log_BF[2]), digits =2 ) ), footnote_as_chunk = T, general_title = "")</span></span>
<span id="cb164-43"><a href="#cb164-43" aria-hidden="true" tabindex="-1"></a><span class="co"># writeLines(tab, "tables/SGC3C_OSPAN_BRMS_state.tex")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-4" class="level5">
<h5 class="anchored" data-anchor-id="visualize-4">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red", </span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.1, #manually adjust to account for directional test</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.90 ) + #manually adjusted for directional test   </span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Model Estimate | Odds Ratio",</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "",</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition")</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">TRUE</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-BRMS-STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># + theme_clean()</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0938</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7200 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-BRMS-STATE-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-BRMS-STATE-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO see documentation for removing, reorganizing parameters</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m, <span class="at">effects =</span> <span class="st">"fixed"</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">FALSE</span>,</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">n_columns =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-BRMS-STATE-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"int"</span>,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Note: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-BRMS-STATE-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")  </span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "eff")  </span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="do">##WORKING</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://mjskay.github.io/ggdist/reference/stat_slab.html</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="do">## VIS probability of correct response</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REALLY LONG TIME</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="co">#1 | get draws</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_grid</span>(pretty_condition, ospan_split, subject, q) <span class="sc">%&gt;%</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(m,</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># ndraws = 100, # n = 100,</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># dpar = TRUE,</span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">transform =</span> <span class="cn">TRUE</span>, <span class="co">#gives prob%, otherwise OR</span></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">re_formula =</span> <span class="cn">NA</span>)</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds")</span></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a><span class="co">#OR load from file</span></span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- read_rds(file = "analysis/SGC3A/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds")</span></span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a><span class="co">#2| VISUALIZE PREDICTIONS | GGDIST</span></span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO figure out height normalization.</span></span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a><span class="do">##do it with much smaller number of draws </span></span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REAAALY LONG TIME</span></span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- </span></span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> draws <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb174-28"><a href="#cb174-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .epred,  <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> ospan_split)) <span class="sc">+</span></span>
<span id="cb174-29"><a href="#cb174-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(<span class="at">width =</span> <span class="fu">c</span>(.<span class="dv">95</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">normalize=</span><span class="st">"xy"</span>) <span class="sc">+</span></span>
<span id="cb174-30"><a href="#cb174-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.category) <span class="sc">+</span></span>
<span id="cb174-31"><a href="#cb174-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   #normalize = all, panels, xy, groups, none</span></span>
<span id="cb174-32"><a href="#cb174-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb174-33"><a href="#cb174-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Predicted Probability of Correct Response"</span>,</span>
<span id="cb174-34"><a href="#cb174-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"probability of correct response"</span>,</span>
<span id="cb174-35"><a href="#cb174-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Interpretation"</span></span>
<span id="cb174-36"><a href="#cb174-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>  <span class="fu">theme_clean</span>() <span class="co">#+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb174-37"><a href="#cb174-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb174-38"><a href="#cb174-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb174-39"><a href="#cb174-39" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(d, filename = "figures/sgc3a_BBm.cat.CrSQ_lab_posterior.svg", width = 6, height =4)</span></span>
<span id="cb174-40"><a href="#cb174-40" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="diagnostics-1" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK Fit of posterior predictive to data</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m, <span class="at">ndraws=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK posterior vs. priors</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">estimate_density</span>(m)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">stack =</span> <span class="cn">FALSE</span>, <span class="at">priors=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK model</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-30-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-30-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-30-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-30-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="q1-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="q1-accuracy">Q1 ACCURACY</h2>
<section id="setup-2" class="level4">
<h4 class="anchored" data-anchor-id="setup-2">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy, pretty_condition, ospan_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-4" class="level4">
<h4 class="anchored" data-anchor-id="describe-4">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split) <span class="sc">+</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Accuracy"</span>,</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Proportions of Correct Responses by Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Proportions of Correct Responses by Condition"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse   Sum
  incorrect   0.892   0.765 0.827
  correct     0.108   0.235 0.173
  Sum         1.000   1.000 1.000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Number of Correct Responses by Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of Correct Responses by Condition"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition, df<span class="sc">$</span>ospan_split) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = low-memory

           
            control impasse Sum
  incorrect      28      31  59
  correct         3       5   8
  Sum            31      36  67

, ,  = high-memory

           
            control impasse Sum
  incorrect      30      21  51
  correct         4      11  15
  Sum            34      32  66</code></pre>
</div>
</div>
</section>
<section id="chi-square-yes" class="level4">
<h4 class="anchored" data-anchor-id="chi-square-yes">CHI SQUARE [YES]</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHI SQUARE ON ACCURACY X OSPAN-SPLIT in LOW WORKING MEMORY</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>df_low <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ospan_split <span class="sc">==</span> <span class="st">"low-memory"</span>)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="co"># table(df_low$pretty_condition, df_low$accuracy)</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>( <span class="at">x =</span> df_low<span class="sc">$</span>pretty_condition, <span class="at">y =</span> df_low<span class="sc">$</span>accuracy, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(x = df_low$pretty_condition, y = df_low$accuracy, : Chi-
squared approximation may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  df_low$pretty_condition and df_low$accuracy
X-squared = 0.02, df = 1, p-value = 0.9</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHI SQUARE ON ACCURACY X OSPAN-SPLIT in HIGH WORKING MEMORY</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>df_high <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ospan_split <span class="sc">==</span> <span class="st">"high-memory"</span>)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="co">#table(df_high$pretty_condition, df_high$accuracy)</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>( <span class="at">x =</span> df_high<span class="sc">$</span>pretty_condition, <span class="at">y =</span> df_high<span class="sc">$</span>accuracy,<span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  df_high$pretty_condition and df_high$accuracy
X-squared = 4, df = 1, p-value = 0.06</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">#significant if correct = FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>TODO why do these chisqrs not match the grouped bar stats? ::: {.cell}</p>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># INTERACTION (OSPAN X CONDITION)</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbarstats</span>( <span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> pretty_condition, </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grouping.var =</span> ospan_split,</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MAIN EFFECT CONDITION (yes)</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggbarstats( data = df, x = accuracy, y = pretty_condition, </span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                     type = "nonparametric")</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="co"># MAIN EFFECT OSPAN (none)</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggbarstats( data = df, x = accuracy, y = ospan_split, </span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                     type = "nonparametric")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>:::</p>
<p>There is no non-parametric version of two-way ANOVA, so we perform individual CHI-SQR tests. We split the data into two groups (low memory, and high memory, based on the median split). For each, we run a CHI SQR test of independence testing the null hypothesis that Q1 ACCURACY is independent of CONDITION. In the low-working memory group, we cannot reject the null hypothesis, suggesting that accuracy does not differ by condition. But in the HIGH working memory group we do reject the null hypothesis. The proportion of correct responses in IMPASSE is much higher than in CONTROL, but only in the HIGH WORKING MEMORY group.</p>
</section>
<section id="logistic-regression-main-effect-condition" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression-main-effect-condition">LOGISTIC REGRESSION (MAIN EFFECT CONDITION)</h4>
<p>TODO:: consider weighted(centered) continuous vs ospan split</p>
<p>Fit a logistic regression predicting accuracy (absolute score) (n = 133) by condition (k = 2).<br>
</p>
<ul>
<li>Parameter estimate: <span class="math inline">\(\beta_{0}\)</span> = Log Odds of (correct) responses in CONTROL condition</li>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> = ODDS of correct response in CONTROL condition</li>
<li>Parameter estimate: <span class="math inline">\(\beta_{1}\)</span> = <span class="math inline">\(\beta_{1impasse}\)</span> Log Odds (Log OR; change in odds for correct response in impasse (vs) control [log scale])</li>
<li><span class="math inline">\(e^{\beta_{1}}\)</span> = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</li>
<li><strong>Null hypothesis</strong>:<span class="math inline">\(\beta_{impasse} \le 0\)</span> the odds for a correct response does not change, or decreases</li>
<li><strong>Alternative hypothesis:</strong> <span class="math inline">\(\beta_{impasse} \gt 0\)</span> the odds of a correct response increases</li>
</ul>
<section id="fit-condition-model" class="level5">
<h5 class="anchored" data-anchor-id="fit-condition-model">Fit CONDITION Model</h5>
<p><em>First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING ::::::::</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>m.C <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m1)</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m<span class="fl">.0</span><span class="sc">$</span>aic <span class="sc">&gt;</span> m.C<span class="sc">$</span>aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m<span class="fl">.0</span>,m.C) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name | Model | df | df_diff | Chi2 |     p
------------------------------------------
m.0  |   glm |  1 |         |      |      
m.C  |   glm |  2 |       1 | 3.88 | 0.049</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m<span class="fl">.0</span>,m.C))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0489409367734944"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.733  -0.733  -0.477  -0.477   2.111  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -2.115      0.400   -5.28  1.3e-07 ***
pretty_conditionimpasse    0.936      0.492    1.90    0.057 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 122.49  on 132  degrees of freedom
Residual deviance: 118.62  on 131  degrees of freedom
AIC: 122.6

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### Fit OSPAN Models</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 OSPAN ONLY MODEL </span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>m.O <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> ospan_split, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC OSPAN predictor is lower than CONDITION model?"</span>, m.C<span class="sc">$</span>aic <span class="sc">&gt;</span> m.O<span class="sc">$</span>aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC OSPAN predictor is lower than CONDITION model? FALSE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: 4 OSPAN + CONDITION model</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>m.CO <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.CO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition + ospan_split, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.870  -0.599  -0.559  -0.373   2.323  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -2.629      0.523   -5.03    5e-07 ***
pretty_conditionimpasse    1.002      0.499    2.01    0.045 *  
ospan_splithigh-memory     0.851      0.487    1.75    0.081 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 122.49  on 132  degrees of freedom
Residual deviance: 115.42  on 130  degrees of freedom
AIC: 121.4

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m.CO, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: accuracy
                 LR Chisq Df Pr(&gt;Chisq)  
pretty_condition     4.33  1      0.037 *
ospan_split          3.19  1      0.074 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: 4 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth OSPAN is lower than CONDITION only model?"</span>, m.C<span class="sc">$</span>aic <span class="sc">&gt;</span> m.CO<span class="sc">$</span>aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth OSPAN is lower than CONDITION only model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.C,m.CO) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name | Model | df | df_diff | Chi2 |     p
------------------------------------------
m.C  |   glm |  2 |         |      |      
m.CO |   glm |  3 |       1 | 3.19 | 0.074</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m.C,m.CO))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0739762476630023"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Adding OSPAN as a predictor (no interaction) decreases AIC, but does not improve fit (LRT)</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="co">#: 5 OSPAN + CONDITION INTERACTION model</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>m.C.O <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition <span class="sc">*</span> ospan_split, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m.C.O)</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(m.C.O, type =3)</span></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a><span class="co">#: 5 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth OSPAN IXN lower than CONDITION + OSPAN only model?"</span>, m.CO<span class="sc">$</span>aic <span class="sc">&gt;</span> m.C.O<span class="sc">$</span>aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth OSPAN IXN lower than CONDITION + OSPAN only model? FALSE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.CO,m.C.O) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name  | Model | df | df_diff | Chi2 |     p
-------------------------------------------
m.CO  |   glm |  3 |         |      |      
m.C.O |   glm |  4 |       1 | 0.89 | 0.346</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth OSPAN IXN is lower than CONDITION only model?"</span>, m.C<span class="sc">$</span>aic <span class="sc">&gt;</span> m.C.O<span class="sc">$</span>aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth OSPAN IXN is lower than CONDITION only model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.C,m.C.O) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name  | Model | df | df_diff | Chi2 |     p
-------------------------------------------
m.C   |   glm |  2 |         |      |      
m.C.O |   glm |  4 |       2 | 4.08 | 0.130</code></pre>
</div>
</div>
<p><strong>Adding OSPAN interaction does not improve model fit over condition-only model, or main effects only model.</strong></p>
</section>
<section id="describe-5" class="level5">
<h5 class="anchored" data-anchor-id="describe-5">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m.C.O</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL [default two-tailed sig test]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL [default two-tailed sig test]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition * ospan_split, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.918  -0.547  -0.500  -0.451   2.161  

Coefficients:
                                               Estimate Std. Error z value
(Intercept)                                      -2.234      0.607   -3.68
pretty_conditionimpasse                           0.409      0.775    0.53
ospan_splithigh-memory                            0.219      0.808    0.27
pretty_conditionimpasse:ospan_splithigh-memory    0.959      1.011    0.95
                                               Pr(&gt;|z|)    
(Intercept)                                     0.00024 ***
pretty_conditionimpasse                         0.59782    
ospan_splithigh-memory                          0.78656    
pretty_conditionimpasse:ospan_splithigh-memory  0.34295    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 122.49  on 132  degrees of freedom
Residual deviance: 114.54  on 129  degrees of freedom
AIC: 122.5

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFIGANCE TEST"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGNIFIGANCE TEST"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: accuracy
                             LR Chisq Df Pr(&gt;Chisq)
pretty_condition                0.284  1       0.59
ospan_split                     0.074  1       0.79
pretty_condition:ospan_split    0.887  1       0.35</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tt &lt;- 2*pnorm(summary(m)$coefficients[2:4], lower.tail = F)</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("p value for two-tailed test, null B = 0 : ",round(tt,3))</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ot &lt;- pnorm(summary(m)$coefficients[2:4], lower.tail = F)</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("BUT we want a one tailed directional, null: B &lt;= 0: ",round(ot,3))</span></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("adjusted confint for directional hypothesis")</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (dcint &lt;- confint(m, level = 0.90)) # get 90% for right side))</span></span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval —- LOG ODDS")</span></span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m)), <span class="fu">exp</span>(<span class="fu">confint</span>(m)))) <span class="co">#exponentiated, not adjusted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                      2.5 % 97.5 %
(Intercept)                                    0.107 0.0256  0.302
pretty_conditionimpasse                        1.505 0.3380  7.881
ospan_splithigh-memory                         1.244 0.2528  6.786
pretty_conditionimpasse:ospan_splithigh-memory 2.610 0.3409 19.436</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m)), exp(dcint))) #exponentiated, adjusted</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO INTERACTIONS &amp; ESTIMATED MARGINAL MEANS </span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PREDICTIONS")</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="co"># pred.control &lt;- predict(m,data.frame(pretty_condition="control"),type="response")</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient)</span></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Probability of success in control,", pred.control)</span></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a><span class="co"># pred.impasse &lt;- predict(m,data.frame(pretty_condition="impasse"),type="response")</span></span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient + predictor coeff)</span></span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Probability of success in impasse,", pred.impasse)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="inference-2" class="level5">
<h5 class="anchored" data-anchor-id="inference-2">Inference</h5>
<p>TODO double check chisqrs vs grouped_barstats. Why is the tests not the same. Otherwise report mm.C as ospan didn’t improve fit</p>
</section>
<section id="visualize-5" class="level5">
<h5 class="anchored" data-anchor-id="visualize-5">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Estimate | Odds Ratio"</span>,</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m, exponentiate = TRUE, component = "all")</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ONLY FOR BAYESIAN VERSION</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- rope(m)</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- pd(m)</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"int"</span>,</span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$ospan_split</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"eff"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$ospan_split</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.03&nbsp;–&nbsp;0.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.34&nbsp;–&nbsp;7.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.598</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">ospan split [high-memory]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.25&nbsp;–&nbsp;6.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.787</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse] * ospan split<br>[high-memory]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.34&nbsp;–&nbsp;19.44</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.343</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">133</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.066</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb249-14"><a href="#cb249-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb249-15"><a href="#cb249-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb249-16"><a href="#cb249-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb249-17"><a href="#cb249-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb249-18"><a href="#cb249-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb249-19"><a href="#cb249-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-2" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-2">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="co"># report::report(m)</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print("MODEL PERFORMANCE")</span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL DIAGNOSTICS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/DIAG-MODEL-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="q1-interpretation-state" class="level2">
<h2 class="anchored" data-anchor-id="q1-interpretation-state">Q1 INTERPRETATION STATE</h2>
<p><strong>Do Ss in the IMPASSE condition offer less-orthogonal interpretations on first question?</strong></p>
<p>While absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesn’t allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subject’s response, and determine if these interpretations differ by experimental condition. State is a 3-category derived response variable that groups the following interpretations:</p>
<ul>
<li><p><strong>“orthogonal”</strong> [reference category] includes orthogonal and satisficing responses ==&gt; indicates a primarily <em>orthogonal</em> state of coordinate system understanding</p></li>
<li><p><strong>“other”</strong> includes: blank, reference point, responses that can’t be classified (including selecting all datapoints), =&gt; indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly <em>not</em> orthogonal nor triangular</p></li>
<li><p><strong>“angular”</strong> includes ‘lines connecting’ responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
<li><p><strong>“triangular”</strong> includes correct triangular and ‘lines connecting’ responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th>Research Question</th>
<th>Does Ss in the impasse condition produce less orthogonal responses on the first question?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the IMPASSE condition will have a higher likelihood of producing unknown and and triangle-like response states, relative to orthogonal response states, on the first question</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td><ul>
<li>data: <code>df_items</code> where <code>q == 1</code></li>
<li>outcome: <code>state</code> ( 4 level factor from 5 level high_interpretation )</li>
<li>predictor: <code>condition</code> [between-subjects factor]</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>Multinomial (Logistic) Regression on state predicted by condition</li>
</ol>
<p>Alternative:</p>
<ul>
<li>Ordinal regression on state; but model doesn’t satisfy proportional odds assumption (parallel slopes)</li>
<li>Multinomial or Ordinal regression on high_interpretation (5 category interpretation state which distinguishes between uncertain (blank, reference) unclassifiable, triangle-like and true triangular.) There are some cells with zeros, however (no uncertain responses in control) which means the model can’t accurately estimate those comparisons</li>
</ul></td>
</tr>
</tbody>
</table>
<section id="setup-3" class="level4">
<h4 class="anchored" data-anchor-id="setup-3">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-6" class="level4">
<h4 class="anchored" data-anchor-id="describe-6">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split) <span class="sc">+</span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-Q1STATE-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             control impasse    Sum
  orthogonal  0.8154  0.2647 0.5338
  other       0.0462  0.3824 0.2180
  angular     0.0308  0.1176 0.0752
  triangular  0.1077  0.2353 0.1729
  Sum         1.0000  1.0000 1.0000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition, df<span class="sc">$</span>ospan_split) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = low-memory

            
             control impasse Sum
  orthogonal      26      15  41
  other            1      13  14
  angular          1       3   4
  triangular       3       5   8
  Sum             31      36  67

, ,  = high-memory

            
             control impasse Sum
  orthogonal      27       3  30
  other            2      13  15
  angular          1       5   6
  triangular       4      11  15
  Sum             34      32  66</code></pre>
</div>
</div>
</section>
<section id="multinomial-regression" class="level4">
<h4 class="anchored" data-anchor-id="multinomial-regression">MULTINOMIAL REGRESSION</h4>
<p>TODO:: USE MBLOGIT VERSION WITH P VALUES IN MODEL</p>
<p><em>Does condition affect the response state of Q1?</em></p>
<p><em>Fit a logistic regression predicting interpretation state (k=3) by condition(k = 2).</em></p>
<ul>
<li><p>3 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) [essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing [reference category] vs [this category])</p></li>
<li><p>For <em>each</em> equation:</p>
<ul>
<li><span class="math inline">\(\beta_{0}\)</span> <em>= Log Odds of [this category type vs.&nbsp;reference category type) response in CONTROL condition</em></li>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> <em>= ODDS of [this category type vs.&nbsp;reference category type] response in CONTROL condition</em></li>
<li><span class="math inline">\(\beta_{1}\)</span> <em>=</em> <span class="math inline">\(\beta_{1impasse}\)</span> <em>Log Odds (Log OR; change in odds for [this category] type response in impasse (vs) control [log scale])</em></li>
<li><span class="math inline">\(e^{\beta_{1}}\)</span> <em>= ODDS RATIO of [this. vs reference category type] response in IMPASSE (vs) CONTROL</em></li>
<li>Two-tailed NHST <em>Null hypothesis:</em> <span class="math inline">\(\beta_{impasse} = 0\)</span> <em>the odds for [this category of response vs.&nbsp;reference] are not different for IMPASSE condition</em></li>
<li><em>Alternative hypothesis:</em> <span class="math inline">\(\beta_{impasse} \ne 0\)</span> <em>the odds of [this category of response vs.&nbsp;reference] increases or decreases for IMPASSE condition</em></li>
</ul></li>
</ul>
<section id="fit-condition-model-1" class="level5">
<h5 class="anchored" data-anchor-id="fit-condition-model-1">Fit CONDITION Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categories (first is reference)"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "orthogonal" "other"      "angular"    "triangular"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  8 (3 variable)
initial  value 184.377150 
iter  10 value 155.544397
final  value 154.972366 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>catm.C <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  12 (6 variable)
initial  value 184.377150 
iter  10 value 131.798993
final  value 131.798569 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.C)</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, catm<span class="fl">.0</span><span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.C<span class="sc">$</span>AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm.C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |  Chi2 |      p
-------------------------------------------------
catm.0 | multinom |  3 |         |       |       
catm.C | multinom |  6 |       3 | 46.35 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state2 ~ pretty_condition, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat)</span></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state2 ~ pretty_condition , data = df)</span></span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.</em></p>
</section>
<section id="fit-ospan-model" class="level5">
<h5 class="anchored" data-anchor-id="fit-ospan-model">Fit OSPAN Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN only MODEL</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN ONLY MODEL")</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>catm.O <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> ospan_split, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  12 (6 variable)
initial  value 184.377150 
iter  10 value 152.820024
final  value 152.819667 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.O) </span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(catm.O) </span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"OSPAN ONLY better than empty?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "OSPAN ONLY better than empty?"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm.O)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff | Chi2 |     p
-----------------------------------------------
catm.0 | multinom |  3 |         |      |      
catm.O | multinom |  6 |       3 | 4.31 | 0.230</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN + CONDITION</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN + CONDITION MODEL")</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>catm.CO <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  16 (9 variable)
initial  value 184.377150 
iter  10 value 128.125771
final  value 128.076360 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.CO)</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(catm.CO) <span class="co">#MainEff condition, marginal ospan</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: state
                 LR Chisq Df Pr(&gt;Chisq)    
pretty_condition     49.5  3      1e-10 ***
ospan_split           7.4  3      0.059 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Adding OSPAN to CONDITION lowers AIC?"</span>, catm.C<span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.CO<span class="sc">$</span>AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding OSPAN to CONDITION lowers AIC? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm.C, catm.CO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name    |    Model | df | df_diff | Chi2 |     p
------------------------------------------------
catm.C  | multinom |  6 |         |      |      
catm.CO | multinom |  9 |       3 | 7.44 | 0.059</code></pre>
</div>
</div>
<p><em>Adding (main effect) predictor of OSPAN decreases AIC and is a marginally better fit. In this model, there is still only a main effect of condition. OSPAN is not a significant main effect.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN * CONDITION</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN * CONDITION MODEL")</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>catm.C.O <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition <span class="sc">*</span> ospan_split, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  20 (12 variable)
initial  value 184.377150 
iter  10 value 126.168657
iter  20 value 125.962345
final  value 125.962341 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(catm.C.O, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: state
                             LR Chisq Df Pr(&gt;Chisq)    
pretty_condition                16.37  3    0.00095 ***
ospan_split                      0.36  3    0.94767    
pretty_condition:ospan_split     4.23  3    0.23787    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.C.O)</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(catm.C.O) #MainEff condition, marginal ospan</span></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Adding INTERACTION lowers AIC?"</span>, catm.CO<span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.C.O<span class="sc">$</span>AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding INTERACTION lowers AIC? FALSE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm.CO, catm.C.O)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name     |    Model | df | df_diff | Chi2 |     p
-------------------------------------------------
catm.CO  | multinom |  9 |         |      |      
catm.C.O | multinom | 12 |       3 | 4.23 | 0.238</code></pre>
</div>
</div>
<p><em>Adding interaction of OSPAN does not improve fit and does not lower AIC. In the IXN model, only the main effect of condition is significant.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(brms)</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state ~ pretty_condition*ospan_split, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat) </span></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(equivalence_test(b.cat))</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(b.cat))</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb294-14"><a href="#cb294-14" aria-hidden="true" tabindex="-1"></a>blm1 <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> pretty_condition <span class="sc">*</span>ospan_split , <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 1 - deviance = 253 - criterion = 0.272
Iteration 2 - deviance = 252 - criterion = 0.00566
Iteration 3 - deviance = 252 - criterion = 0.000157
Iteration 4 - deviance = 252 - criterion = 2.98e-07
Iteration 5 - deviance = 252 - criterion = 2.53e-12
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(blm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
mblogit(formula = state ~ pretty_condition * ospan_split, data = df)

Equation for other vs orthogonal:
                                               Estimate Std. Error z value
(Intercept)                                      -3.258      1.019   -3.20
pretty_conditionimpasse                           3.115      1.087    2.87
ospan_splithigh-memory                            0.655      1.255    0.52
pretty_conditionimpasse:ospan_splithigh-memory    0.954      1.459    0.65
                                               Pr(&gt;|z|)   
(Intercept)                                      0.0014 **
pretty_conditionimpasse                          0.0042 **
ospan_splithigh-memory                           0.6016   
pretty_conditionimpasse:ospan_splithigh-memory   0.5132   

Equation for angular vs orthogonal:
                                                  Estimate Std. Error z value
(Intercept)                                        -3.2581     1.0190   -3.20
tri(Intercept)                                     -2.1595     0.6097   -3.54
pretty_conditionimpasse                             1.6487     1.1994    1.37
tripretty_conditionimpasse                          1.0609     0.7990    1.33
ospan_splithigh-memory                             -0.0377     1.4407   -0.03
triospan_splithigh-memory                           0.2499     0.8117    0.31
pretty_conditionimpasse:ospan_splithigh-memory      2.1580     1.7346    1.24
tripretty_conditionimpasse:ospan_splithigh-memory   2.1480     1.1618    1.85
                                                  Pr(&gt;|z|)    
(Intercept)                                         0.0014 ** 
tri(Intercept)                                      0.0004 ***
pretty_conditionimpasse                             0.1693    
tripretty_conditionimpasse                          0.1843    
ospan_splithigh-memory                              0.9791    
triospan_splithigh-memory                           0.7581    
pretty_conditionimpasse:ospan_splithigh-memory      0.2135    
tripretty_conditionimpasse:ospan_splithigh-memory   0.0645 .  

Equation for triangular vs orthogonal:
                                               Estimate Std. Error z value
(Intercept)                                      -2.159      0.610   -3.54
pretty_conditionimpasse                           1.061      0.799    1.33
ospan_splithigh-memory                            0.250      0.812    0.31
pretty_conditionimpasse:ospan_splithigh-memory    2.148      1.162    1.85
                                               Pr(&gt;|z|)    
(Intercept)                                      0.0004 ***
pretty_conditionimpasse                          0.1843    
ospan_splithigh-memory                           0.7581    
pretty_conditionimpasse:ospan_splithigh-memory   0.0645 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Null Deviance:     369 
Residual Deviance: 252 
Number of Fisher Scoring iterations:  5 
Number of observations:  133 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(blm1) #todo need to separate by individual equation</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.</em></p>
</section>
<section id="describe-7" class="level5">
<h5 class="anchored" data-anchor-id="describe-7">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> catm.C.O</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL SUMMARY"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = state ~ pretty_condition * ospan_split, data = df, 
    model = TRUE)

Coefficients:
           (Intercept) pretty_conditionimpasse ospan_splithigh-memory
other            -3.26                    3.11                 0.6553
angular          -3.26                    1.65                -0.0377
triangular       -2.16                    1.06                 0.2500
           pretty_conditionimpasse:ospan_splithigh-memory
other                                               0.954
angular                                             2.158
triangular                                          2.148

Std. Errors:
           (Intercept) pretty_conditionimpasse ospan_splithigh-memory
other             1.02                   1.087                  1.255
angular           1.02                   1.199                  1.441
triangular        0.61                   0.799                  0.812
           pretty_conditionimpasse:ospan_splithigh-memory
other                                                1.46
angular                                              1.73
triangular                                           1.16

Residual Deviance: 252 
AIC: 276 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type =</span><span class="dv">3</span>) <span class="co">#always type 3 for ixns </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: state
                             LR Chisq Df Pr(&gt;Chisq)    
pretty_condition                16.37  3    0.00095 ***
ospan_split                      0.36  3    0.94767    
pretty_condition:ospan_split     4.23  3    0.23787    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(m)<span class="sc">$</span>standard.errors</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>(p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           p..Intercept. p.pretty_conditionimpasse p.ospan_splithigh.memory
other           0.001388                   0.00417                    0.602
angular         0.001387                   0.16927                    0.979
triangular      0.000398                   0.18428                    0.758
           p.pretty_conditionimpasse.ospan_splithigh.memory
other                                                0.5132
angular                                              0.2134
triangular                                           0.0645</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>coefficients))</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           OR..Intercept. OR.pretty_conditionimpasse OR.ospan_splithigh.memory
other              0.0385                      22.53                     1.926
angular            0.0385                       5.20                     0.963
triangular         0.1154                       2.89                     1.284
           OR.pretty_conditionimpasse.ospan_splithigh.memory p..Intercept.
other                                                   2.60      0.001388
angular                                                 8.65      0.001387
triangular                                              8.57      0.000398
           p.pretty_conditionimpasse p.ospan_splithigh.memory
other                        0.00417                    0.602
angular                      0.16927                    0.979
triangular                   0.18428                    0.758
           p.pretty_conditionimpasse.ospan_splithigh.memory
other                                                0.5132
angular                                              0.2134
triangular                                           0.0645</code></pre>
</div>
</div>
</section>
<section id="inference-3" class="level5">
<h5 class="anchored" data-anchor-id="inference-3">Inference</h5>
<p>looking at detailed p values</p>
<p>… OTHER: only main effect of condition TRI-LIKE: no effects TRI: IXN condition * impasse</p>
<p>TODO</p>
<ul>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 45 (z = 3.81, p &lt; 0.001) . <strong>Participants in the impasse condition were 45x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving ‘triangle-like’ response rather than an orthogonal (or satisficing) response by a factor of 17.5 (z = 2.60, p &lt; 0.001 ). <strong>Participants in the impasse condition were almost 6x as likely to give an a triangular response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving ‘triangle-like’ response rather than an orthogonal (or satisficing) response by a factor of 4.8 (z = 3.30, p &lt; 0.001 ). <strong>Participants in the impasse condition were almost 6x as likely to give an a triangular response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>As with the (binary) logistic regression on accuracy ~ condition, significant model intercepts indicate that the odds of being in any particular response state (vs) orthogonal are significantly different than 1 <em>in the control condition.</em> (i.e.&nbsp;not 1:1 odds or 50% chance of being in that response state. Orthogonal is a much more probable response state in control)</p></li>
<li><p>[need to to double check interpretation, but I <em>think</em> that the OR intercepts converted to probabilities equate to the marginal probability of being in each state in the control condition. which makes sense. I think.?]</p></li>
<li><p>IF I change reference category for condition… then the intercepts should no longer be significant. The b1 coefficients should still be significant, but with changed sign (much less likely) [Yup! this works!]</p></li>
</ul>
</section>
<section id="visualize-6" class="level5">
<h5 class="anchored" data-anchor-id="visualize-6">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() + #remove to put on log scale x axis </span></span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c("control","impasse"))+</span></span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-Q1INTERPRETATION-LAB-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"int"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-Q1INTERPRETATION-LAB-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-Q1INTERPRETATION-LAB-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$ospan_split</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/VIS-Q1INTERPRETATION-LAB-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># +  ylim(0,1) +</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "MODEL PREDICTION  | Q1 State ~ condition",</span></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "Impasse increases probability of more accurate response states Q1",</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition") + theme_clean()</span></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO ESTIMAED MARGINALS AND IXN PLOTS </span></span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Response</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.002</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">22.53</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.62&nbsp;–&nbsp;193.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.005</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">ospan split [high-memory]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.16&nbsp;–&nbsp;23.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.603</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse] * ospan split<br>[high-memory]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.14&nbsp;–&nbsp;46.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.514</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.002</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">angular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.48&nbsp;–&nbsp;55.86</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.172</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">angular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">ospan split [high-memory]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06&nbsp;–&nbsp;16.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.979</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">angular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse] * ospan split<br>[high-memory]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">8.65</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.28&nbsp;–&nbsp;268.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.216</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">angular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.03&nbsp;–&nbsp;0.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.59&nbsp;–&nbsp;14.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.187</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">ospan split [high-memory]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.26&nbsp;–&nbsp;6.40</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.759</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse] * ospan split<br>[high-memory]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">8.57</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.86&nbsp;–&nbsp;85.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.067</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">133</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.187 / 0.181</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb318-18"><a href="#cb318-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb318-19"><a href="#cb318-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb318-20"><a href="#cb318-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-21"><a href="#cb318-21" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(mixcat.1, s)</span></span>
<span id="cb318-22"><a href="#cb318-22" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb318-23"><a href="#cb318-23" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-3" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-3">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test &lt;- data.frame(pretty_condition = c("control", "impasse"))</span></span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pred &lt;- predict(m, newdata = test, "probs")</span></span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Predicted Probability of Being in Each State")</span></span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ( x &lt;- cbind(test, pred))</span></span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma
-----------------------------------------------------
275.925 | 310.609 | 0.187 |     0.181 | 0.354 | 1.443</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(m, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  McFadden   CoxSnell Nagelkerke 
     0.187      0.354      0.392 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(generalhoslem)</span></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="co">#logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(df<span class="sc">$</span>state,<span class="fu">predict</span>(m)) <span class="co">#actual states VS predicted states</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(df$state, predict(m)): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  df$state and predict(m)
X-squared = 33, df = 3, p-value = 3e-07</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The chi-square test tests the decrease in unexplained variance from the baseline model to the final model</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL DIAGNOSTICS")</span></span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m) can't do overall diagnostics, have to do them on individual model equations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="q8-interpretation-state" class="level2">
<h2 class="anchored" data-anchor-id="q8-interpretation-state">Q8 INTERPRETATION STATE</h2>
<section id="setup-4" class="level4">
<h4 class="anchored" data-anchor-id="setup-4">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-8" class="level4">
<h4 class="anchored" data-anchor-id="describe-8">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split) <span class="sc">+</span></span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q8 Interpretation"</span>,</span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb331-13"><a href="#cb331-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             control impasse    Sum
  orthogonal  0.6308  0.3971 0.5113
  other       0.2769  0.3088 0.2932
  angular     0.0462  0.0588 0.0526
  triangular  0.0462  0.2353 0.1429
  Sum         1.0000  1.0000 1.0000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition, df<span class="sc">$</span>ospan_split) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = low-memory

            
             control impasse Sum
  orthogonal      19      16  35
  other            9      15  24
  angular          1       2   3
  triangular       2       3   5
  Sum             31      36  67

, ,  = high-memory

            
             control impasse Sum
  orthogonal      22      11  33
  other            9       6  15
  angular          2       2   4
  triangular       1      13  14
  Sum             34      32  66</code></pre>
</div>
</div>
</section>
<section id="multinomial-regression-1" class="level4">
<h4 class="anchored" data-anchor-id="multinomial-regression-1">MULTINOMIAL REGRESSION</h4>
<p>TODO:: USE MBLOGIT VERSION WITH P VALUES IN MODEL</p>
<p><em>Does condition affect the response state of Q?</em></p>
<section id="fit-condition-model-2" class="level5">
<h5 class="anchored" data-anchor-id="fit-condition-model-2">Fit CONDITION Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categories (first is reference)"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "orthogonal" "other"      "angular"    "triangular"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  8 (3 variable)
initial  value 184.377150 
iter  10 value 151.045297
iter  10 value 151.045297
iter  10 value 151.045296
final  value 151.045296 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a>catm.C <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  12 (6 variable)
initial  value 184.377150 
iter  10 value 144.557718
final  value 144.557713 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.C)</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, catm<span class="fl">.0</span><span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.C<span class="sc">$</span>AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm.C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |  Chi2 |     p
------------------------------------------------
catm.0 | multinom |  3 |         |       |      
catm.C | multinom |  6 |       3 | 12.98 | 0.005</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state2 ~ pretty_condition, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat)</span></span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb348-11"><a href="#cb348-11" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb348-12"><a href="#cb348-12" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state2 ~ pretty_condition , data = df)</span></span>
<span id="cb348-13"><a href="#cb348-13" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb348-14"><a href="#cb348-14" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.</em></p>
</section>
<section id="fit-ospan-model-1" class="level5">
<h5 class="anchored" data-anchor-id="fit-ospan-model-1">Fit OSPAN Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN only MODEL</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN ONLY MODEL")</span></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>catm.O <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> ospan_split, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  12 (6 variable)
initial  value 184.377150 
iter  10 value 147.680865
final  value 147.680635 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.O) </span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(catm.O) </span></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"OSPAN ONLY better than empty?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "OSPAN ONLY better than empty?"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm.O)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff | Chi2 |     p
-----------------------------------------------
catm.0 | multinom |  3 |         |      |      
catm.O | multinom |  6 |       3 | 6.73 | 0.081</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN + CONDITION</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN + CONDITION MODEL")</span></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>catm.CO <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  16 (9 variable)
initial  value 184.377150 
iter  10 value 140.787130
final  value 140.643485 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.CO)</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(catm.CO) <span class="co">#MainEff condition, marginal ospan</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: state
                 LR Chisq Df Pr(&gt;Chisq)   
pretty_condition    14.07  3     0.0028 **
ospan_split          7.83  3     0.0497 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Adding OSPAN to CONDITION lowers AIC?"</span>, catm.C<span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.CO<span class="sc">$</span>AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding OSPAN to CONDITION lowers AIC? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm.C, catm.CO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name    |    Model | df | df_diff | Chi2 |     p
------------------------------------------------
catm.C  | multinom |  6 |         |      |      
catm.CO | multinom |  9 |       3 | 7.83 | 0.050</code></pre>
</div>
</div>
<p><em>Adding (main effect) predictor of OSPAN decreases AIC and is a marginally better fit. In this model, there are main effects of condition and OSPAN.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN * CONDITION</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN * CONDITION MODEL")</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>catm.C.O <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition <span class="sc">*</span> ospan_split, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  20 (12 variable)
initial  value 184.377150 
iter  10 value 138.567549
iter  20 value 138.467842
iter  20 value 138.467842
iter  20 value 138.467842
final  value 138.467842 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(catm.C.O, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: state
                             LR Chisq Df Pr(&gt;Chisq)
pretty_condition                 1.94  3       0.58
ospan_split                      0.76  3       0.86
pretty_condition:ospan_split     4.35  3       0.23</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.C.O)</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(catm.C.O) #MainEff condition, marginal ospan</span></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Adding INTERACTION lowers AIC?"</span>, catm.CO<span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.C.O<span class="sc">$</span>AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding INTERACTION lowers AIC? FALSE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm.CO, catm.C.O)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name     |    Model | df | df_diff | Chi2 |     p
-------------------------------------------------
catm.CO  | multinom |  9 |         |      |      
catm.C.O | multinom | 12 |       3 | 4.35 | 0.226</code></pre>
</div>
</div>
<p><em>Adding interaction of OSPAN does not improve fit and does not lower AIC. In the IXN model, no effects are significant.</em> So we conclude that the main effects only model is the final model.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(brms)</span></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state ~ pretty_condition*ospan_split, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat) </span></span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(equivalence_test(b.cat))</span></span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(b.cat))</span></span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb371-14"><a href="#cb371-14" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state ~ pretty_condition *ospan_split , data = df)</span></span>
<span id="cb371-15"><a href="#cb371-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb371-16"><a href="#cb371-16" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(blm1) #todo need to separate by individual equation</span></span>
<span id="cb371-17"><a href="#cb371-17" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-9" class="level5">
<h5 class="anchored" data-anchor-id="describe-9">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> catm.CO</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL SUMMARY"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = state ~ pretty_condition + ospan_split, data = df, 
    model = TRUE)

Coefficients:
           (Intercept) pretty_conditionimpasse ospan_splithigh-memory
other           -0.652                   0.533                 -0.352
angular         -2.866                   0.754                  0.430
triangular      -3.494                   2.224                  1.297

Std. Errors:
           (Intercept) pretty_conditionimpasse ospan_splithigh-memory
other            0.344                   0.409                  0.414
angular          0.785                   0.809                  0.810
triangular       0.765                   0.689                  0.604

Residual Deviance: 281 
AIC: 299 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type =</span><span class="dv">2</span>) <span class="co">#always type 3 for ixns </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: state
                 LR Chisq Df Pr(&gt;Chisq)   
pretty_condition    14.07  3     0.0028 **
ospan_split          7.83  3     0.0497 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(m)<span class="sc">$</span>standard.errors</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>(p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           p..Intercept. p.pretty_conditionimpasse p.ospan_splithigh.memory
other         0.05779206                   0.19245                   0.3953
angular       0.00026029                   0.35180                   0.5951
triangular    0.00000496                   0.00126                   0.0317</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>coefficients))</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           OR..Intercept. OR.pretty_conditionimpasse OR.ospan_splithigh.memory
other              0.5209                       1.70                     0.703
angular            0.0569                       2.12                     1.538
triangular         0.0304                       9.24                     3.660
           p..Intercept. p.pretty_conditionimpasse p.ospan_splithigh.memory
other         0.05779206                   0.19245                   0.3953
angular       0.00026029                   0.35180                   0.5951
triangular    0.00000496                   0.00126                   0.0317</code></pre>
</div>
</div>
</section>
<section id="inference-4" class="level5">
<h5 class="anchored" data-anchor-id="inference-4">Inference</h5>
</section>
<section id="visualize-7" class="level5">
<h5 class="anchored" data-anchor-id="visualize-7">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb384-11"><a href="#cb384-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() + #remove to put on log scale x axis </span></span>
<span id="cb384-12"><a href="#cb384-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c("control","impasse"))+</span></span>
<span id="cb384-13"><a href="#cb384-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb384-14"><a href="#cb384-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb384-15"><a href="#cb384-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "int", ci.lvl = 0.95) </span></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-60-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$ospan_split</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-60-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># +  ylim(0,1) +</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "MODEL PREDICTION  | Q1 State ~ condition",</span></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "Impasse increases probability of more accurate response states Q1",</span></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition") + theme_clean()</span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO ESTIMAED MARGINALS AND IXN PLOTS </span></span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb389-8"><a href="#cb389-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb389-9"><a href="#cb389-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb389-10"><a href="#cb389-10" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb389-11"><a href="#cb389-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb389-12"><a href="#cb389-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb389-13"><a href="#cb389-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb389-14"><a href="#cb389-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb389-15"><a href="#cb389-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb389-16"><a href="#cb389-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb389-17"><a href="#cb389-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb389-18"><a href="#cb389-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb389-19"><a href="#cb389-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb389-20"><a href="#cb389-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb389-21"><a href="#cb389-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb389-22"><a href="#cb389-22" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb389-23"><a href="#cb389-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-24"><a href="#cb389-24" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(mixcat.1, s)</span></span>
<span id="cb389-25"><a href="#cb389-25" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb389-26"><a href="#cb389-26" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-4" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-4">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test &lt;- data.frame(pretty_condition = c("control", "impasse"))</span></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pred &lt;- predict(m, newdata = test, "probs")</span></span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Predicted Probability of Being in Each State")</span></span>
<span id="cb390-6"><a href="#cb390-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ( x &lt;- cbind(test, pred))</span></span>
<span id="cb390-7"><a href="#cb390-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-8"><a href="#cb390-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PERFORMANCE")</span></span>
<span id="cb390-9"><a href="#cb390-9" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb390-10"><a href="#cb390-10" aria-hidden="true" tabindex="-1"></a><span class="co"># DescTools::PseudoR2(m, which = c("McFadden", "CoxSnell", "Nagelkerke"))</span></span>
<span id="cb390-11"><a href="#cb390-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-12"><a href="#cb390-12" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb390-13"><a href="#cb390-13" aria-hidden="true" tabindex="-1"></a><span class="co">#library(generalhoslem)</span></span>
<span id="cb390-14"><a href="#cb390-14" aria-hidden="true" tabindex="-1"></a><span class="co">#logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb390-15"><a href="#cb390-15" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb390-16"><a href="#cb390-16" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb390-17"><a href="#cb390-17" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(df<span class="sc">$</span>state,<span class="fu">predict</span>(m)) <span class="co">#actual states VS predicted states</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(df$state, predict(m)): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  df$state and predict(m)
X-squared = 24, df = 3, p-value = 0.00002</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The chi-square test tests the decrease in unexplained variance from the baseline model to the final model</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL DIAGNOSTICS")</span></span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m) can't do overall diagnostics, have to do them on individual model equations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="explore-specific-question" class="level2">
<h2 class="anchored" data-anchor-id="explore-specific-question">EXPLORE specific question</h2>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">10</span>)</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbarstats</span>( <span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> pretty_condition, <span class="at">grouping.var =</span> ospan_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_ospan_hypotesting_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SGC3A (Replication) Hypothesis Testing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb395" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'Study SGC3A | (OSPAN) Hypothesis Testing'</span></span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a><span class="co"># YAML FOR generating modelsummary tables</span></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment to run those  cells only </span></span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a><span class="co"># \usepackage{booktabs}</span></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a><span class="co"># \usepackage{siunitx}</span></span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a><span class="co"># \newcolumntype{d}{S[input-symbols = ()]}</span></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-12"><a href="#cb395-12" aria-hidden="true" tabindex="-1"></a><span class="fu"># SGC3 (OSPAN) Hypothesis Testing {#sec-SGC3A-ospan-hypotesting}</span></span>
<span id="cb395-13"><a href="#cb395-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-14"><a href="#cb395-14" aria-hidden="true" tabindex="-1"></a>*The purpose of this notebook is test the hypotheses that determined the design of the SGC3A study WITH OSPAN.*</span>
<span id="cb395-15"><a href="#cb395-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-18"><a href="#cb395-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-19"><a href="#cb395-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb395-20"><a href="#cb395-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb395-21"><a href="#cb395-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb395-22"><a href="#cb395-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-23"><a href="#cb395-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-24"><a href="#cb395-24" aria-hidden="true" tabindex="-1"></a><span class="co">#UTILITIES</span></span>
<span id="cb395-25"><a href="#cb395-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb395-26"><a href="#cb395-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy model output</span></span>
<span id="cb395-27"><a href="#cb395-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed models</span></span>
<span id="cb395-28"><a href="#cb395-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#favstats</span></span>
<span id="cb395-29"><a href="#cb395-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite) <span class="co">#saving plots as svg</span></span>
<span id="cb395-30"><a href="#cb395-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb395-31"><a href="#cb395-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-32"><a href="#cb395-32" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZATION</span></span>
<span id="cb395-33"><a href="#cb395-33" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr) #arrange plots</span></span>
<span id="cb395-34"><a href="#cb395-34" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cowplot) #arrange shift function plots</span></span>
<span id="cb395-35"><a href="#cb395-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb395-36"><a href="#cb395-36" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcd) #mosaic plots</span></span>
<span id="cb395-37"><a href="#cb395-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcdExtra) #mosaic plots</span></span>
<span id="cb395-38"><a href="#cb395-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables</span></span>
<span id="cb395-39"><a href="#cb395-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb395-40"><a href="#cb395-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz</span></span>
<span id="cb395-41"><a href="#cb395-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr) <span class="co">#needed for ggdist</span></span>
<span id="cb395-42"><a href="#cb395-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves) <span class="co"># plots. in half</span></span>
<span id="cb395-43"><a href="#cb395-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># violin plot stuffs</span></span>
<span id="cb395-44"><a href="#cb395-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions)</span>
<span id="cb395-45"><a href="#cb395-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with stats</span></span>
<span id="cb395-46"><a href="#cb395-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#latex tables for models!</span></span>
<span id="cb395-47"><a href="#cb395-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange plots</span></span>
<span id="cb395-48"><a href="#cb395-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-49"><a href="#cb395-49" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELLING</span></span>
<span id="cb395-50"><a href="#cb395-50" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstatix) #helpful testing functions incl wilcoxon, etc</span></span>
<span id="cb395-51"><a href="#cb395-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb395-52"><a href="#cb395-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb395-53"><a href="#cb395-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb395-54"><a href="#cb395-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#easystats model summary and vis</span></span>
<span id="cb395-55"><a href="#cb395-55" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qqplotr) #confint on qq plot</span></span>
<span id="cb395-56"><a href="#cb395-56" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gmodels) #contingency table and CHISQR</span></span>
<span id="cb395-57"><a href="#cb395-57" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic) #extract model equation</span></span>
<span id="cb395-58"><a href="#cb395-58" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pscl) #zeroinfl / hurdle models </span></span>
<span id="cb395-59"><a href="#cb395-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models</span></span>
<span id="cb395-60"><a href="#cb395-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer</span></span>
<span id="cb395-61"><a href="#cb395-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools) <span class="co">#predictInterval</span></span>
<span id="cb395-62"><a href="#cb395-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co">#estimated marginal effects and posthocs on interactions</span></span>
<span id="cb395-63"><a href="#cb395-63" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects) #visualization log regr models</span></span>
<span id="cb395-64"><a href="#cb395-64" aria-hidden="true" tabindex="-1"></a><span class="co">#MULTINOMIAL </span></span>
<span id="cb395-65"><a href="#cb395-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression [not mixed] #no p values</span></span>
<span id="cb395-66"><a href="#cb395-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#frequentist mixed multinomial logistic regression [mblogit] #gives p values</span></span>
<span id="cb395-67"><a href="#cb395-67" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN</span></span>
<span id="cb395-68"><a href="#cb395-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr) <span class="co">#executing stan</span></span>
<span id="cb395-69"><a href="#cb395-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#bayesian mixed multinomials [+ other bayesian reg models]</span></span>
<span id="cb395-70"><a href="#cb395-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) </span>
<span id="cb395-71"><a href="#cb395-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb395-72"><a href="#cb395-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb395-73"><a href="#cb395-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-74"><a href="#cb395-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb395-75"><a href="#cb395-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-76"><a href="#cb395-76" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb395-77"><a href="#cb395-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb395-78"><a href="#cb395-78" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb395-79"><a href="#cb395-79" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb395-80"><a href="#cb395-80" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb395-81"><a href="#cb395-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-82"><a href="#cb395-82" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb395-83"><a href="#cb395-83" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_minimal()) </span></span>
<span id="cb395-84"><a href="#cb395-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-85"><a href="#cb395-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb395-86"><a href="#cb395-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed</span></span>
<span id="cb395-87"><a href="#cb395-87" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb395-88"><a href="#cb395-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb395-89"><a href="#cb395-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb395-90"><a href="#cb395-90" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb395-91"><a href="#cb395-91" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb395-92"><a href="#cb395-92" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb395-93"><a href="#cb395-93" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb395-94"><a href="#cb395-94" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb395-95"><a href="#cb395-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb395-96"><a href="#cb395-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-97"><a href="#cb395-97" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_clean</span>())</span>
<span id="cb395-98"><a href="#cb395-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-99"><a href="#cb395-99" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb395-100"><a href="#cb395-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-101"><a href="#cb395-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-102"><a href="#cb395-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-103"><a href="#cb395-103" aria-hidden="true" tabindex="-1"></a>**TODO UPDATE Research Questions**</span>
<span id="cb395-104"><a href="#cb395-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-105"><a href="#cb395-105" aria-hidden="true" tabindex="-1"></a>In SGC3A-OSPAN we set out to answer the following question: Does posing a mental impasse improve performance on the interval graph comprehension task? Does WORKING MEMORY CAPACITY (as measured by the OSPAN task) explain performance on the graph comprehension task?</span>
<span id="cb395-106"><a href="#cb395-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-107"><a href="#cb395-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-110"><a href="#cb395-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-111"><a href="#cb395-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb395-112"><a href="#cb395-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb395-113"><a href="#cb395-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb395-114"><a href="#cb395-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-115"><a href="#cb395-115" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb395-116"><a href="#cb395-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-117"><a href="#cb395-117" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants_OSPAN.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb395-118"><a href="#cb395-118" aria-hidden="true" tabindex="-1"></a>  <span class="at">task_percent =</span> DV_percent_NABS,</span>
<span id="cb395-119"><a href="#cb395-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">ospan_split =</span> <span class="fu">recode_factor</span>(ospan_split, </span>
<span id="cb395-120"><a href="#cb395-120" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"low-memory"</span> <span class="ot">=</span> <span class="st">"low-memory"</span>, <span class="st">"high-memory"</span><span class="ot">=</span><span class="st">"high-memory"</span>)) <span class="sc">%&gt;%</span> <span class="co">#recode ospan_split as factor with low as reference </span></span>
<span id="cb395-121"><a href="#cb395-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb395-122"><a href="#cb395-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-123"><a href="#cb395-123" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items_OSPAN.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb395-124"><a href="#cb395-124" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span> (</span>
<span id="cb395-125"><a href="#cb395-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.factor</span>(q), </span>
<span id="cb395-126"><a href="#cb395-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.factor</span>(subject),</span>
<span id="cb395-127"><a href="#cb395-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb395-128"><a href="#cb395-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS TRI-LIKE</span></span>
<span id="cb395-129"><a href="#cb395-129" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state = recode_factor(score_SCALED, #for ordinal</span></span>
<span id="cb395-130"><a href="#cb395-130" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-1" = "orth-like",</span></span>
<span id="cb395-131"><a href="#cb395-131" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-0.5" = "unknown",</span></span>
<span id="cb395-132"><a href="#cb395-132" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0" = "unknown",</span></span>
<span id="cb395-133"><a href="#cb395-133" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0.5" = "tri-like",</span></span>
<span id="cb395-134"><a href="#cb395-134" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "1" = "tri-like"),</span></span>
<span id="cb395-135"><a href="#cb395-135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS OTHER</span></span>
<span id="cb395-136"><a href="#cb395-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb395-137"><a href="#cb395-137" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orthogonal"</span>,</span>
<span id="cb395-138"><a href="#cb395-138" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb395-139"><a href="#cb395-139" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb395-140"><a href="#cb395-140" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"angular"</span>,</span>
<span id="cb395-141"><a href="#cb395-141" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"triangular"</span>),</span>
<span id="cb395-142"><a href="#cb395-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">as.ordered</span>(state))</span>
<span id="cb395-143"><a href="#cb395-143" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb395-144"><a href="#cb395-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-145"><a href="#cb395-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-146"><a href="#cb395-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-147"><a href="#cb395-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-148"><a href="#cb395-148" aria-hidden="true" tabindex="-1"></a><span class="do">##ADD OSPAN SCORE TO ITEM RECORD</span></span>
<span id="cb395-149"><a href="#cb395-149" aria-hidden="true" tabindex="-1"></a>subjects <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(subject,OSPAN.weighted, ospan_split)</span>
<span id="cb395-150"><a href="#cb395-150" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> df_items </span>
<span id="cb395-151"><a href="#cb395-151" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">merge</span>(items,subjects)</span>
<span id="cb395-152"><a href="#cb395-152" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> items</span>
<span id="cb395-153"><a href="#cb395-153" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(subjects,items)</span>
<span id="cb395-154"><a href="#cb395-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-155"><a href="#cb395-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-156"><a href="#cb395-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-157"><a href="#cb395-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-158"><a href="#cb395-158" aria-hidden="true" tabindex="-1"></a><span class="fu">## SAMPLE</span></span>
<span id="cb395-159"><a href="#cb395-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-160"><a href="#cb395-160" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Collection</span></span>
<span id="cb395-161"><a href="#cb395-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-162"><a href="#cb395-162" aria-hidden="true" tabindex="-1"></a>Data was collected (online, via SONA) in Fall 2021. Note that approximately 200 subjects were run in Fall 2021, but only 133 of them completed the OSPAN task. Therefore subjects who did not complete the task are discarded from analysis.</span>
<span id="cb395-163"><a href="#cb395-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-166"><a href="#cb395-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-167"><a href="#cb395-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : DESC-DATA-COLLECTION</span></span>
<span id="cb395-168"><a href="#cb395-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-169"><a href="#cb395-169" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Participants by Condition and Data Collection Period"</span></span>
<span id="cb395-170"><a href="#cb395-170" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Control Condition"</span>,<span class="st">"Impasse Condition"</span>,<span class="st">"Total for Period"</span>)</span>
<span id="cb395-171"><a href="#cb395-171" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">table</span>(df_subjects<span class="sc">$</span>term, df_subjects<span class="sc">$</span>condition)</span>
<span id="cb395-172"><a href="#cb395-172" aria-hidden="true" tabindex="-1"></a>cont <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>() <span class="sc">%&gt;%</span> <span class="fu">kbl</span>(<span class="at">caption =</span> title, <span class="at">col.names =</span> cols) <span class="sc">%&gt;%</span>  <span class="fu">kable_classic</span>()</span>
<span id="cb395-173"><a href="#cb395-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-174"><a href="#cb395-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-175"><a href="#cb395-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-176"><a href="#cb395-176" aria-hidden="true" tabindex="-1"></a><span class="fu">### Participants</span></span>
<span id="cb395-177"><a href="#cb395-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-180"><a href="#cb395-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-181"><a href="#cb395-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-PARTICIPANTS</span></span>
<span id="cb395-182"><a href="#cb395-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-183"><a href="#cb395-183" aria-hidden="true" tabindex="-1"></a><span class="co">#Describe participants</span></span>
<span id="cb395-184"><a href="#cb395-184" aria-hidden="true" tabindex="-1"></a>subject.stats <span class="ot">&lt;-</span>df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(age) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>()</span>
<span id="cb395-185"><a href="#cb395-185" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.male <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">"Male"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb395-186"><a href="#cb395-186" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.female <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">"Female"</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb395-187"><a href="#cb395-187" aria-hidden="true" tabindex="-1"></a>subject.stats<span class="sc">$</span>percent.other <span class="ot">&lt;-</span> ((df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gender <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"Female"</span>,<span class="st">"Male"</span>)) <span class="sc">%&gt;%</span> <span class="fu">count</span>())<span class="sc">/</span><span class="fu">count</span>(df_subjects))<span class="sc">$</span>n</span>
<span id="cb395-188"><a href="#cb395-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-189"><a href="#cb395-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-190"><a href="#cb395-190" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Participant Age and Gender"</span></span>
<span id="cb395-191"><a href="#cb395-191" aria-hidden="true" tabindex="-1"></a>subject.stats <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb395-192"><a href="#cb395-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Age in Years"</span>, </span>
<span id="cb395-193"><a href="#cb395-193" aria-hidden="true" tabindex="-1"></a>           <span class="at">general_title =</span> <span class="st">"Note: "</span>,<span class="at">footnote_as_chunk =</span> T) </span>
<span id="cb395-194"><a href="#cb395-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-195"><a href="#cb395-195" aria-hidden="true" tabindex="-1"></a>**REPORTED**</span>
<span id="cb395-196"><a href="#cb395-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-197"><a href="#cb395-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-198"><a href="#cb395-198" aria-hidden="true" tabindex="-1"></a>**Overall** <span class="in">`r subject.stats$n`</span> participants (<span class="in">`r round((subject.stats$percent.male),2) * 100`</span> % male, <span class="in">`r round((subject.stats$percent.female),2) * 100`</span> % female, <span class="in">`r round((subject.stats$percent.other),2) * 100`</span> % other)  undergraduate STEM majors at a public American University participated in exchange for course credit (age: <span class="in">`r (subject.stats$min)`</span> - <span class="in">`r (subject.stats$max)`</span> years).</span>
<span id="cb395-199"><a href="#cb395-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-200"><a href="#cb395-200" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">230 subjects were recorded to study database in FA21 - 32 pilot sgc3b</span><span class="co">]</span> </span>
<span id="cb395-201"><a href="#cb395-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-202"><a href="#cb395-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-203"><a href="#cb395-203" aria-hidden="true" tabindex="-1"></a><span class="fu">### OSPAN</span></span>
<span id="cb395-204"><a href="#cb395-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-205"><a href="#cb395-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-206"><a href="#cb395-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-209"><a href="#cb395-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-210"><a href="#cb395-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-SUBJ-OSPAN</span></span>
<span id="cb395-211"><a href="#cb395-211" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb395-212"><a href="#cb395-212" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of OSPAN Task Accuracy"</span></span>
<span id="cb395-213"><a href="#cb395-213" aria-hidden="true" tabindex="-1"></a>ospan.stats <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb395-214"><a href="#cb395-214" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MATH"</span> <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(OSPAN.math_acc) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>(),</span>
<span id="cb395-215"><a href="#cb395-215" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ORDER"</span> <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(OSPAN.order_acc) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>(),</span>
<span id="cb395-216"><a href="#cb395-216" aria-hidden="true" tabindex="-1"></a>  <span class="st">"WEIGHTED"</span> <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(OSPAN.weighted) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">favstats</span>()</span>
<span id="cb395-217"><a href="#cb395-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-218"><a href="#cb395-218" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb395-219"><a href="#cb395-219" aria-hidden="true" tabindex="-1"></a>ospan.stats <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb395-220"><a href="#cb395-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"MATH = %correct of all math questions;</span></span>
<span id="cb395-221"><a href="#cb395-221" aria-hidden="true" tabindex="-1"></a><span class="st">           ORDER = % correct of OSPAN ordering (out of 30); WEIGHTED = math*ospan number correct"</span>, <span class="at">general_title =</span> <span class="st">"Note: "</span>,<span class="at">footnote_as_chunk =</span> T)</span>
<span id="cb395-222"><a href="#cb395-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-223"><a href="#cb395-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-224"><a href="#cb395-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-225"><a href="#cb395-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-228"><a href="#cb395-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-229"><a href="#cb395-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-SUBJ-OSPAN</span></span>
<span id="cb395-230"><a href="#cb395-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-231"><a href="#cb395-231" aria-hidden="true" tabindex="-1"></a><span class="co"># #GGFORMULA | DENSITY HISTOGRAM </span></span>
<span id="cb395-232"><a href="#cb395-232" aria-hidden="true" tabindex="-1"></a> med <span class="ot">=</span> <span class="fu">median</span>(df_subjects<span class="sc">$</span>OSPAN.weighted)</span>
<span id="cb395-233"><a href="#cb395-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_dhistogram</span>(<span class="sc">~</span>OSPAN.weighted, <span class="at">data =</span> df_subjects) <span class="sc">%&gt;%</span> </span>
<span id="cb395-234"><a href="#cb395-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="sc">~</span>med, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb395-235"><a href="#cb395-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"OSPAN (weighted) score"</span>,</span>
<span id="cb395-236"><a href="#cb395-236" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"% of subjects"</span>,</span>
<span id="cb395-237"><a href="#cb395-237" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of OSPAN SCORE"</span>,</span>
<span id="cb395-238"><a href="#cb395-238" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"line indicates median split"</span>)</span>
<span id="cb395-239"><a href="#cb395-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-240"><a href="#cb395-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-241"><a href="#cb395-241" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb395-242"><a href="#cb395-242" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb395-243"><a href="#cb395-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb395-244"><a href="#cb395-244" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb395-245"><a href="#cb395-245" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> ospan_split)) <span class="sc">+</span></span>
<span id="cb395-246"><a href="#cb395-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb395-247"><a href="#cb395-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb395-248"><a href="#cb395-248" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ospan_split) + </span></span>
<span id="cb395-249"><a href="#cb395-249" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"OSPAN SPLIT"</span>,</span>
<span id="cb395-250"><a href="#cb395-250" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb395-251"><a href="#cb395-251" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb395-252"><a href="#cb395-252" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"After taking a median split, comparable high(vs) low in each condition"</span>)</span>
<span id="cb395-253"><a href="#cb395-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-254"><a href="#cb395-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-255"><a href="#cb395-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-256"><a href="#cb395-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-257"><a href="#cb395-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-258"><a href="#cb395-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-259"><a href="#cb395-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-260"><a href="#cb395-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-261"><a href="#cb395-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-262"><a href="#cb395-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-263"><a href="#cb395-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-264"><a href="#cb395-264" aria-hidden="true" tabindex="-1"></a><span class="fu">## OVERALL ACCURACY</span></span>
<span id="cb395-265"><a href="#cb395-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-266"><a href="#cb395-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-267"><a href="#cb395-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-268"><a href="#cb395-268" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb395-271"><a href="#cb395-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-272"><a href="#cb395-272" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-ACC</span></span>
<span id="cb395-273"><a href="#cb395-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-274"><a href="#cb395-274" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb395-275"><a href="#cb395-275" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, accuracy, subject,q, ospan_split)</span>
<span id="cb395-276"><a href="#cb395-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-277"><a href="#cb395-277" aria-hidden="true" tabindex="-1"></a>df_s <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb395-278"><a href="#cb395-278" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, task_percent)</span>
<span id="cb395-279"><a href="#cb395-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-280"><a href="#cb395-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-281"><a href="#cb395-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-282"><a href="#cb395-282" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb395-283"><a href="#cb395-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-286"><a href="#cb395-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-287"><a href="#cb395-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-ACC</span></span>
<span id="cb395-288"><a href="#cb395-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-289"><a href="#cb395-289" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb395-290"><a href="#cb395-290" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb395-291"><a href="#cb395-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb395-292"><a href="#cb395-292" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb395-293"><a href="#cb395-293" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb395-294"><a href="#cb395-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">width =</span> <span class="fl">0.75</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb395-295"><a href="#cb395-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"lisa::FridaKahlo"</span>, <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb395-296"><a href="#cb395-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split)<span class="sc">+</span></span>
<span id="cb395-297"><a href="#cb395-297" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = paletteer::paletteer_d("ggthemes::Jewel_Bright", 2))+</span></span>
<span id="cb395-298"><a href="#cb395-298" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 2))+</span></span>
<span id="cb395-299"><a href="#cb395-299" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_brewer(palette = "Set1")  +</span></span>
<span id="cb395-300"><a href="#cb395-300" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb395-301"><a href="#cb395-301" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb395-302"><a href="#cb395-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb395-303"><a href="#cb395-303" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Study 3C | DISTRIBUTION of Question Accuracy"</span>,</span>
<span id="cb395-304"><a href="#cb395-304" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb395-305"><a href="#cb395-305" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb395-306"><a href="#cb395-306" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb395-307"><a href="#cb395-307" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse is particularly effective for subjects with high-working memory"</span>)</span>
<span id="cb395-308"><a href="#cb395-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-309"><a href="#cb395-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-310"><a href="#cb395-310" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb395-311"><a href="#cb395-311" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-312"><a href="#cb395-312" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i %&gt;% mutate(</span></span>
<span id="cb395-313"><a href="#cb395-313" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = fct_rev(accuracy)</span></span>
<span id="cb395-314"><a href="#cb395-314" aria-hidden="true" tabindex="-1"></a><span class="co"># )  </span></span>
<span id="cb395-315"><a href="#cb395-315" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-316"><a href="#cb395-316" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE PLOT WITH LABELS</span></span>
<span id="cb395-317"><a href="#cb395-317" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- grouped_ggbarstats(data = temp, x = accuracy, y = pretty_condition,</span></span>
<span id="cb395-318"><a href="#cb395-318" aria-hidden="true" tabindex="-1"></a><span class="co">#                grouping.var = ospan_split,</span></span>
<span id="cb395-319"><a href="#cb395-319" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb395-320"><a href="#cb395-320" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb395-321"><a href="#cb395-321" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb395-322"><a href="#cb395-322" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("lisa::FridaKahlo", 2))</span></span>
<span id="cb395-323"><a href="#cb395-323" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb395-324"><a href="#cb395-324" aria-hidden="true" tabindex="-1"></a><span class="co">#                ))  + theme_clean() </span></span>
<span id="cb395-325"><a href="#cb395-325" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-326"><a href="#cb395-326" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIX LABELS</span></span>
<span id="cb395-327"><a href="#cb395-327" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- p[[1]] +  labs(</span></span>
<span id="cb395-328"><a href="#cb395-328" aria-hidden="true" tabindex="-1"></a><span class="co">#   subtitle = "Impasse is particularly effective for subjects with high-working memory",</span></span>
<span id="cb395-329"><a href="#cb395-329" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response"</span></span>
<span id="cb395-330"><a href="#cb395-330" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") </span></span>
<span id="cb395-331"><a href="#cb395-331" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb395-332"><a href="#cb395-332" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;-   p[[2]] + labs(</span></span>
<span id="cb395-333"><a href="#cb395-333" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response",</span></span>
<span id="cb395-334"><a href="#cb395-334" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "   "</span></span>
<span id="cb395-335"><a href="#cb395-335" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") +</span></span>
<span id="cb395-336"><a href="#cb395-336" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggeasy::easy_remove_axes(which="y", what=c("text","title"))</span></span>
<span id="cb395-337"><a href="#cb395-337" aria-hidden="true" tabindex="-1"></a><span class="co">#   # ggeasy::easy_remove_axes(which="y", what= ""))</span></span>
<span id="cb395-338"><a href="#cb395-338" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-339"><a href="#cb395-339" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE ROW</span></span>
<span id="cb395-340"><a href="#cb395-340" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-341"><a href="#cb395-341" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_row &lt;- plot_grid(p1,p2, rel_widths = c(1,0.85))</span></span>
<span id="cb395-342"><a href="#cb395-342" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-343"><a href="#cb395-343" aria-hidden="true" tabindex="-1"></a><span class="co"># title &lt;- ggdraw() + </span></span>
<span id="cb395-344"><a href="#cb395-344" aria-hidden="true" tabindex="-1"></a><span class="co">#   draw_label(</span></span>
<span id="cb395-345"><a href="#cb395-345" aria-hidden="true" tabindex="-1"></a><span class="co">#     "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb395-346"><a href="#cb395-346" aria-hidden="true" tabindex="-1"></a><span class="co">#     fontface = 'bold',</span></span>
<span id="cb395-347"><a href="#cb395-347" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0,</span></span>
<span id="cb395-348"><a href="#cb395-348" aria-hidden="true" tabindex="-1"></a><span class="co">#     hjust = 0</span></span>
<span id="cb395-349"><a href="#cb395-349" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb395-350"><a href="#cb395-350" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb395-351"><a href="#cb395-351" aria-hidden="true" tabindex="-1"></a><span class="co">#     # add margin on the left of the drawing canvas,</span></span>
<span id="cb395-352"><a href="#cb395-352" aria-hidden="true" tabindex="-1"></a><span class="co">#     # so title is aligned with left edge of first plot</span></span>
<span id="cb395-353"><a href="#cb395-353" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot.margin = margin(0, 0, 0, 7)</span></span>
<span id="cb395-354"><a href="#cb395-354" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb395-355"><a href="#cb395-355" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-356"><a href="#cb395-356" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-357"><a href="#cb395-357" aria-hidden="true" tabindex="-1"></a><span class="co"># pg &lt;- plot_grid(</span></span>
<span id="cb395-358"><a href="#cb395-358" aria-hidden="true" tabindex="-1"></a><span class="co">#   title,</span></span>
<span id="cb395-359"><a href="#cb395-359" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_row,</span></span>
<span id="cb395-360"><a href="#cb395-360" aria-hidden="true" tabindex="-1"></a><span class="co">#   ncol = 1,</span></span>
<span id="cb395-361"><a href="#cb395-361" aria-hidden="true" tabindex="-1"></a><span class="co">#   # rel_heights values control vertical title margins</span></span>
<span id="cb395-362"><a href="#cb395-362" aria-hidden="true" tabindex="-1"></a><span class="co">#   rel_heights = c(0.1, 1)</span></span>
<span id="cb395-363"><a href="#cb395-363" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean()</span></span>
<span id="cb395-364"><a href="#cb395-364" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb395-365"><a href="#cb395-365" aria-hidden="true" tabindex="-1"></a><span class="co"># pg</span></span>
<span id="cb395-366"><a href="#cb395-366" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(pg, filename = "figures/SGC3A_OSPAN_Accuracy.png", width = 6, height =4)</span></span>
<span id="cb395-367"><a href="#cb395-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-368"><a href="#cb395-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-369"><a href="#cb395-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-372"><a href="#cb395-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-373"><a href="#cb395-373" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb395-374"><a href="#cb395-374" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb395-375"><a href="#cb395-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb395-376"><a href="#cb395-376" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb395-377"><a href="#cb395-377" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb395-378"><a href="#cb395-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb395-379"><a href="#cb395-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb395-380"><a href="#cb395-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( q <span class="sc">~</span> ospan_split) <span class="sc">+</span></span>
<span id="cb395-381"><a href="#cb395-381" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accuracy by Question"</span>,</span>
<span id="cb395-382"><a href="#cb395-382" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb395-383"><a href="#cb395-383" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb395-384"><a href="#cb395-384" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Q6 and Q9 are non-discriminative"</span>)</span>
<span id="cb395-385"><a href="#cb395-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-386"><a href="#cb395-386" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: FACETED HISTOGRAM</span></span>
<span id="cb395-387"><a href="#cb395-387" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_s <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(task_percent))</span>
<span id="cb395-388"><a href="#cb395-388" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>task_percent,</span>
<span id="cb395-389"><a href="#cb395-389" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_s) <span class="sc">%&gt;%</span></span>
<span id="cb395-390"><a href="#cb395-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> ospan_split) <span class="sc">%&gt;%</span></span>
<span id="cb395-391"><a href="#cb395-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb395-392"><a href="#cb395-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb395-393"><a href="#cb395-393" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb395-394"><a href="#cb395-394" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Overall Absolute Score (% Correct)"</span>,</span>
<span id="cb395-395"><a href="#cb395-395" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb395-396"><a href="#cb395-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-397"><a href="#cb395-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-398"><a href="#cb395-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-399"><a href="#cb395-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-400"><a href="#cb395-400" aria-hidden="true" tabindex="-1"></a><span class="fu">### Describe</span></span>
<span id="cb395-403"><a href="#cb395-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-404"><a href="#cb395-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC2-ACC</span></span>
<span id="cb395-405"><a href="#cb395-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-406"><a href="#cb395-406" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct)"</span></span>
<span id="cb395-407"><a href="#cb395-407" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span>task_percent, <span class="at">data =</span> df_s) </span>
<span id="cb395-408"><a href="#cb395-408" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb395-409"><a href="#cb395-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-410"><a href="#cb395-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-411"><a href="#cb395-411" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION"</span></span>
<span id="cb395-412"><a href="#cb395-412" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb395-413"><a href="#cb395-413" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb395-414"><a href="#cb395-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-415"><a href="#cb395-415" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY OSPAN SPLIT"</span></span>
<span id="cb395-416"><a href="#cb395-416" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> ospan_split, <span class="at">data =</span> df_s) </span>
<span id="cb395-417"><a href="#cb395-417" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb395-418"><a href="#cb395-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-419"><a href="#cb395-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-420"><a href="#cb395-420" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY OSPAN SPLIT &amp; CONDITION"</span></span>
<span id="cb395-421"><a href="#cb395-421" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> ospan_split<span class="sc">+</span>pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb395-422"><a href="#cb395-422" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb395-423"><a href="#cb395-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-424"><a href="#cb395-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-425"><a href="#cb395-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-426"><a href="#cb395-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-427"><a href="#cb395-427" aria-hidden="true" tabindex="-1"></a>Across both conditions, overall accuracy on the task ranges from <span class="in">`r tbl1$min *100`</span> to <span class="in">`r tbl1$max *100`</span> with a mean of <span class="in">`r tbl1$mean * 100`</span>. We see that the distribution of this outcome variable is clearly bimodal: with modes near the floor (0% correct) and ceiling (100% correct) of the scale. This bimodality is sensical considering the nature of the task, where each item in the task indexes a different information extraction operation over the same coordinate system.</span>
<span id="cb395-428"><a href="#cb395-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-429"><a href="#cb395-429" aria-hidden="true" tabindex="-1"></a>Task level accuracy on the graph comprehension task follows the same pattern of behaviour observed in Study 3A: the distribution is bimodal. Total scores were higher in the impasse condition (M = 35\%, SD = 41\%, n = 65)  than control condition (M = 15\%, SD = 30\%, n = 68), implying a likely main effect of scaffold condition.  Comparing total scores across the median split on the OSPAN task (high working memory (vs) low working memory), we see readers with high working memory (M = 31 \%, SD = 41\%, n = 66) performed better than readers with low working memory (M = 19 \%, SD = 31\%, n = 67). In Figure \ref{fig_3C_ospan_raw_accuracy} we see that while readers in the impasse condition performed consistently better than those in the control condition, the effect is particularly pronounced for readers with high-working memory, implying a potential interaction between condition and working memory. </span>
<span id="cb395-430"><a href="#cb395-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-431"><a href="#cb395-431" aria-hidden="true" tabindex="-1"></a><span class="fu">#### WILCOXON RANK SUM (Mann-Whitney Test) </span></span>
<span id="cb395-432"><a href="#cb395-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-433"><a href="#cb395-433" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Non parametric alternative** to t-test; compares median rather than mean by ranking data</span>
<span id="cb395-434"><a href="#cb395-434" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume normality</span>
<span id="cb395-435"><a href="#cb395-435" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume equal variance of samples (homogeneity of variance)</span>
<span id="cb395-436"><a href="#cb395-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-437"><a href="#cb395-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-438"><a href="#cb395-438" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Test</span></span>
<span id="cb395-439"><a href="#cb395-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-442"><a href="#cb395-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-443"><a href="#cb395-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: </span><span class="al">TEST</span><span class="co">-ACC</span></span>
<span id="cb395-444"><a href="#cb395-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-445"><a href="#cb395-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-446"><a href="#cb395-446" aria-hidden="true" tabindex="-1"></a><span class="co">#WILCOXON ON ACCURACY X OSPAN-SPLIT in LOW WORKING MEMORY</span></span>
<span id="cb395-447"><a href="#cb395-447" aria-hidden="true" tabindex="-1"></a>df_low <span class="ot">&lt;-</span> df_s <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ospan_split <span class="sc">==</span> <span class="st">"low-memory"</span>)</span>
<span id="cb395-448"><a href="#cb395-448" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df_low<span class="sc">$</span>task_percent <span class="sc">~</span> df_low<span class="sc">$</span>pretty_condition,</span>
<span id="cb395-449"><a href="#cb395-449" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)) <span class="co">#less, greater</span></span>
<span id="cb395-450"><a href="#cb395-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-451"><a href="#cb395-451" aria-hidden="true" tabindex="-1"></a><span class="co">#WILCOXON ON ACCURACY X OSPAN-SPLIT in HIGH</span></span>
<span id="cb395-452"><a href="#cb395-452" aria-hidden="true" tabindex="-1"></a>df_high <span class="ot">&lt;-</span> df_s <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ospan_split <span class="sc">==</span> <span class="st">"high-memory"</span>)</span>
<span id="cb395-453"><a href="#cb395-453" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df_high<span class="sc">$</span>task_percent <span class="sc">~</span> df_high<span class="sc">$</span>pretty_condition,</span>
<span id="cb395-454"><a href="#cb395-454" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)) <span class="co">#less, greater</span></span>
<span id="cb395-455"><a href="#cb395-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-456"><a href="#cb395-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-457"><a href="#cb395-457" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbetweenstats</span>( <span class="at">data =</span> df_s, <span class="at">type =</span> <span class="st">"nonparametric"</span>,</span>
<span id="cb395-458"><a href="#cb395-458" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> task_percent, <span class="at">x =</span> pretty_condition, <span class="at">grouping.var =</span> ospan_split)</span>
<span id="cb395-459"><a href="#cb395-459" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb395-460"><a href="#cb395-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-461"><a href="#cb395-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-462"><a href="#cb395-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-463"><a href="#cb395-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-464"><a href="#cb395-464" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference — EFFECT</span></span>
<span id="cb395-465"><a href="#cb395-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-466"><a href="#cb395-466" aria-hidden="true" tabindex="-1"></a>A Wilcoxon-Rank sum test on task accuracy x condition for the low-memory participants indicate that impasse is not significantly higher. A Wilcoxon rank sum test on task accuracy x condition for high-memory participants indicate that impasse IS higher. Taken together, this indiates there may be an interaction between working memory and condition. </span>
<span id="cb395-467"><a href="#cb395-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-468"><a href="#cb395-468" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb395-469"><a href="#cb395-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-472"><a href="#cb395-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-473"><a href="#cb395-473" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO   </span></span>
<span id="cb395-474"><a href="#cb395-474" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">grouped_ggbetweenstats</span>(<span class="at">data =</span> df_s,</span>
<span id="cb395-475"><a href="#cb395-475" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> task_percent, <span class="at">x =</span> pretty_condition, <span class="at">grouping.var =</span> ospan_split,</span>
<span id="cb395-476"><a href="#cb395-476" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.type =</span> <span class="st">"box"</span>, <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb395-477"><a href="#cb395-477" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb395-478"><a href="#cb395-478" aria-hidden="true" tabindex="-1"></a>               <span class="at">results.subtitle =</span> <span class="cn">FALSE</span>,</span>
<span id="cb395-479"><a href="#cb395-479" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.point.args =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">1</span>),</span>
<span id="cb395-480"><a href="#cb395-480" aria-hidden="true" tabindex="-1"></a>               <span class="co"># point.args = list(alpha=0), #suppress points</span></span>
<span id="cb395-481"><a href="#cb395-481" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggplot.component =</span> <span class="do">## modify further with `{ggplot2}` functions</span></span>
<span id="cb395-482"><a href="#cb395-482" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(</span>
<span id="cb395-483"><a href="#cb395-483" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Percentage of correct responses across task"</span>, <span class="at">x =</span> <span class="st">""</span>),</span>
<span id="cb395-484"><a href="#cb395-484" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">color =</span> pretty_condition, <span class="at">fill =</span> pretty_condition),</span>
<span id="cb395-485"><a href="#cb395-485" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">scale_fill_grey</span>(), <span class="fu">scale_color_grey</span>()</span>
<span id="cb395-486"><a href="#cb395-486" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 3)),</span></span>
<span id="cb395-487"><a href="#cb395-487" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_fill_manual(values = paletteer::paletteer_c("viridis::viridis", 3))</span></span>
<span id="cb395-488"><a href="#cb395-488" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># theme(axis.text.x = element_text(angle = 90)</span></span>
<span id="cb395-489"><a href="#cb395-489" aria-hidden="true" tabindex="-1"></a>                )) </span>
<span id="cb395-490"><a href="#cb395-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-491"><a href="#cb395-491" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb395-492"><a href="#cb395-492" aria-hidden="true" tabindex="-1"></a>   ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb395-493"><a href="#cb395-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-494"><a href="#cb395-494" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb395-495"><a href="#cb395-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb395-496"><a href="#cb395-496" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"High working memory yields higher scores and greater variance in impasse condition"</span>) <span class="sc">+</span> </span>
<span id="cb395-497"><a href="#cb395-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span> ggeasy<span class="sc">::</span><span class="fu">easy_remove_axes</span>(<span class="at">which =</span> <span class="st">"x"</span>) <span class="sc">+</span> ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend</span>()</span>
<span id="cb395-498"><a href="#cb395-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-499"><a href="#cb395-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-500"><a href="#cb395-500" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p2, p1, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb395-501"><a href="#cb395-501" aria-hidden="true" tabindex="-1"></a>pg</span>
<span id="cb395-502"><a href="#cb395-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-503"><a href="#cb395-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-504"><a href="#cb395-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-505"><a href="#cb395-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-506"><a href="#cb395-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-507"><a href="#cb395-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-508"><a href="#cb395-508" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MIXED LOGISTIC REGRESSION [IXN!!]</span></span>
<span id="cb395-509"><a href="#cb395-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-510"><a href="#cb395-510" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.*</span>
<span id="cb395-511"><a href="#cb395-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-512"><a href="#cb395-512" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb395-513"><a href="#cb395-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-516"><a href="#cb395-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-517"><a href="#cb395-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-FIT-ACC</span></span>
<span id="cb395-518"><a href="#cb395-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-519"><a href="#cb395-519" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SETUP</span></span>
<span id="cb395-520"><a href="#cb395-520" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm 13 items [all discriminating items]</span></span>
<span id="cb395-521"><a href="#cb395-521" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_i) <span class="sc">/</span> <span class="fu">nrow</span>(df_s) <span class="sc">==</span> <span class="dv">13</span></span>
<span id="cb395-522"><a href="#cb395-522" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm all factors </span></span>
<span id="cb395-523"><a href="#cb395-523" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df_i<span class="sc">$</span>q) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>subject) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>pretty_condition) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>accuracy) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>ospan_split)</span>
<span id="cb395-524"><a href="#cb395-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-525"><a href="#cb395-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-526"><a href="#cb395-526" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb395-527"><a href="#cb395-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-528"><a href="#cb395-528" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb395-529"><a href="#cb395-529" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Empty fixed model"</span>)</span>
<span id="cb395-530"><a href="#cb395-530" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df_i) </span>
<span id="cb395-531"><a href="#cb395-531" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb395-532"><a href="#cb395-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-533"><a href="#cb395-533" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + ITEM</span></span>
<span id="cb395-534"><a href="#cb395-534" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject Intercept + Item intercept random model"</span>)</span>
<span id="cb395-535"><a href="#cb395-535" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb395-536"><a href="#cb395-536" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.rSQ)</span></span>
<span id="cb395-537"><a href="#cb395-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-538"><a href="#cb395-538" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb395-539"><a href="#cb395-539" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(m0)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)))</span>
<span id="cb395-540"><a href="#cb395-540" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0, mm.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb395-541"><a href="#cb395-541" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0, mm.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb395-542"><a href="#cb395-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-543"><a href="#cb395-543" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT CONDITION</span></span>
<span id="cb395-544"><a href="#cb395-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-545"><a href="#cb395-545" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Item random intercepts"</span>)</span>
<span id="cb395-546"><a href="#cb395-546" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb395-547"><a href="#cb395-547" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb395-548"><a href="#cb395-548" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.CrSQ)</span></span>
<span id="cb395-549"><a href="#cb395-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-550"><a href="#cb395-550" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) )</span>
<span id="cb395-551"><a href="#cb395-551" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb395-552"><a href="#cb395-552" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb395-553"><a href="#cb395-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-554"><a href="#cb395-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-555"><a href="#cb395-555" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 | ADD INTERACTION OSPAN</span></span>
<span id="cb395-556"><a href="#cb395-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-557"><a href="#cb395-557" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition * FIXED OSPAN + Subject &amp; Item random intercepts"</span>)</span>
<span id="cb395-558"><a href="#cb395-558" aria-hidden="true" tabindex="-1"></a>mm.COrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">*</span>ospan_split <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb395-559"><a href="#cb395-559" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb395-560"><a href="#cb395-560" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.COrSQ)</span></span>
<span id="cb395-561"><a href="#cb395-561" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.COrSQ)</span></span>
<span id="cb395-562"><a href="#cb395-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-563"><a href="#cb395-563" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.COrSQ)) )</span>
<span id="cb395-564"><a href="#cb395-564" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.CrSQ,mm.COrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb395-565"><a href="#cb395-565" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.CrSQ,mm.COrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb395-566"><a href="#cb395-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-567"><a href="#cb395-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-568"><a href="#cb395-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-569"><a href="#cb395-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-570"><a href="#cb395-570" aria-hidden="true" tabindex="-1"></a>*A likelihood ratio test indicates adding OSPAN as a fixed effect to a logistic regression model including a fixed effect for CONDITION and random intercepts for SUBJECT and QUESTION explains more variance in the data than the CONDITION + random-effects only model.*</span>
<span id="cb395-571"><a href="#cb395-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-572"><a href="#cb395-572" aria-hidden="true" tabindex="-1"></a>**Condition is better than random effects alone**</span>
<span id="cb395-573"><a href="#cb395-573" aria-hidden="true" tabindex="-1"></a>$chi^2(4,6) = 17.23, p &lt; 0.001$</span>
<span id="cb395-574"><a href="#cb395-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-575"><a href="#cb395-575" aria-hidden="true" tabindex="-1"></a>**Adding OSPAN and interaction term better than condition**</span>
<span id="cb395-576"><a href="#cb395-576" aria-hidden="true" tabindex="-1"></a>$chi^2(4,6) = 6.93, p &lt; 0.05$</span>
<span id="cb395-577"><a href="#cb395-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-578"><a href="#cb395-578" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb395-579"><a href="#cb395-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-582"><a href="#cb395-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-583"><a href="#cb395-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-ACC</span></span>
<span id="cb395-584"><a href="#cb395-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-585"><a href="#cb395-585" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb395-586"><a href="#cb395-586" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.COrSQ</span>
<span id="cb395-587"><a href="#cb395-587" aria-hidden="true" tabindex="-1"></a>m <span class="sc">%&gt;%</span> <span class="fu">write_rds</span>(<span class="at">file =</span> <span class="st">"analysis/SGC3A/models/sgc3a_glmer_acc_mm.COrSQ_OSPAN.rds"</span>)</span>
<span id="cb395-588"><a href="#cb395-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-589"><a href="#cb395-589" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb395-590"><a href="#cb395-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-591"><a href="#cb395-591" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb395-592"><a href="#cb395-592" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb395-593"><a href="#cb395-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-594"><a href="#cb395-594" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFICANCE TEST [non directional]"</span>)</span>
<span id="cb395-595"><a href="#cb395-595" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>) <span class="co">#TYPE 3 SS FOR IXNS</span></span>
<span id="cb395-596"><a href="#cb395-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-597"><a href="#cb395-597" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb395-598"><a href="#cb395-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-599"><a href="#cb395-599" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span>
<span id="cb395-600"><a href="#cb395-600" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb395-601"><a href="#cb395-601" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m),</span></span>
<span id="cb395-602"><a href="#cb395-602" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se,</span></span>
<span id="cb395-603"><a href="#cb395-603" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb395-604"><a href="#cb395-604" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>)</span>
<span id="cb395-605"><a href="#cb395-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-606"><a href="#cb395-606" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb395-607"><a href="#cb395-607" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb395-608"><a href="#cb395-608" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-609"><a href="#cb395-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-610"><a href="#cb395-610" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span>
<span id="cb395-611"><a href="#cb395-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-612"><a href="#cb395-612" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check</span></span>
<span id="cb395-613"><a href="#cb395-613" aria-hidden="true" tabindex="-1"></a><span class="co">#probability control = plogis(intercept)</span></span>
<span id="cb395-614"><a href="#cb395-614" aria-hidden="true" tabindex="-1"></a><span class="co">#probability impasse = plogis(intercept + coefficient)</span></span>
<span id="cb395-615"><a href="#cb395-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-616"><a href="#cb395-616" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM predict()</span></span>
<span id="cb395-617"><a href="#cb395-617" aria-hidden="true" tabindex="-1"></a><span class="co"># newdata &lt;- df_i %&gt;% dplyr::select(pretty_condition, subject, q)</span></span>
<span id="cb395-618"><a href="#cb395-618" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- predict(m, newdata = newdata, type = "response")</span></span>
<span id="cb395-619"><a href="#cb395-619" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- cbind(newdata, preds)</span></span>
<span id="cb395-620"><a href="#cb395-620" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- preds %&gt;% </span></span>
<span id="cb395-621"><a href="#cb395-621" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, preds) %&gt;% </span></span>
<span id="cb395-622"><a href="#cb395-622" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition) %&gt;% </span></span>
<span id="cb395-623"><a href="#cb395-623" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(</span></span>
<span id="cb395-624"><a href="#cb395-624" aria-hidden="true" tabindex="-1"></a><span class="co">#     median = median(preds),</span></span>
<span id="cb395-625"><a href="#cb395-625" aria-hidden="true" tabindex="-1"></a><span class="co">#     se = sd(preds)/sqrt(n()),</span></span>
<span id="cb395-626"><a href="#cb395-626" aria-hidden="true" tabindex="-1"></a><span class="co">#     lwr = median - 1.96*se,</span></span>
<span id="cb395-627"><a href="#cb395-627" aria-hidden="true" tabindex="-1"></a><span class="co">#     upr = median + 1.96*se)</span></span>
<span id="cb395-628"><a href="#cb395-628" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb395-629"><a href="#cb395-629" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb395-630"><a href="#cb395-630" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM merTools</span></span>
<span id="cb395-631"><a href="#cb395-631" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, subject, q)</span>
<span id="cb395-632"><a href="#cb395-632" aria-hidden="true" tabindex="-1"></a><span class="co">#make predictions</span></span>
<span id="cb395-633"><a href="#cb395-633" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predictInterval</span>(m, <span class="at">newdata =</span> newdata,</span>
<span id="cb395-634"><a href="#cb395-634" aria-hidden="true" tabindex="-1"></a>                              <span class="at">which =</span> <span class="st">"fixed"</span>, <span class="co">#full, fixed or random for those only</span></span>
<span id="cb395-635"><a href="#cb395-635" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"probability"</span>, <span class="co">#linear.prediction</span></span>
<span id="cb395-636"><a href="#cb395-636" aria-hidden="true" tabindex="-1"></a>                              <span class="at">stat =</span> <span class="st">"median"</span>,</span>
<span id="cb395-637"><a href="#cb395-637" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n.sims =</span> <span class="dv">1000</span>,</span>
<span id="cb395-638"><a href="#cb395-638" aria-hidden="true" tabindex="-1"></a>                              <span class="at">level =</span> <span class="fl">0.80</span>) <span class="co">#width of prediction interval</span></span>
<span id="cb395-639"><a href="#cb395-639" aria-hidden="true" tabindex="-1"></a><span class="co">#join predictions to the new dataframe</span></span>
<span id="cb395-640"><a href="#cb395-640" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb395-641"><a href="#cb395-641" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize</span></span>
<span id="cb395-642"><a href="#cb395-642" aria-hidden="true" tabindex="-1"></a>(summ_preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb395-643"><a href="#cb395-643" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, fit, lwr, upr) <span class="sc">%&gt;%</span> </span>
<span id="cb395-644"><a href="#cb395-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pretty_condition, ospan_split) <span class="sc">%&gt;%</span> </span>
<span id="cb395-645"><a href="#cb395-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb395-646"><a href="#cb395-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(fit),</span>
<span id="cb395-647"><a href="#cb395-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">median</span>(lwr),</span>
<span id="cb395-648"><a href="#cb395-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">median</span>(upr)</span>
<span id="cb395-649"><a href="#cb395-649" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb395-650"><a href="#cb395-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-651"><a href="#cb395-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-652"><a href="#cb395-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-653"><a href="#cb395-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-654"><a href="#cb395-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-655"><a href="#cb395-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-656"><a href="#cb395-656" aria-hidden="true" tabindex="-1"></a><span class="fu">##### INFERENCE</span></span>
<span id="cb395-657"><a href="#cb395-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-658"><a href="#cb395-658" aria-hidden="true" tabindex="-1"></a>**REPORTED**</span>
<span id="cb395-659"><a href="#cb395-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-660"><a href="#cb395-660" aria-hidden="true" tabindex="-1"></a>To explore the effect of working memory capacity on ACCURACY, we fit a mixed effects logistic regression model with random intercepts for subjects and questions, with CONDITION, WORKING MEMORY and their interaction term as fixed effects.  A likelihood ratio test indicates that a model including the fixed effect of CONDITION  explains significantly more variance in the data than an intercepts-only baseline model ($\chi^2 (3,4) = 17.23, p &lt; 0.001$). The final model including fixed effects and interaction term of OSPAN is a significantly better fit than the CONDITION-only model  ($\chi^2(4,6) = 6.93, p &lt; 0.05$). The explanatory power of the entire model is substantial ($conditional \ R^2 = 0.92$) and the part related to the fixed effects CONDITION and WORKING MEMORY ($marginal \ R^2$) explains 18\% of variance. </span>
<span id="cb395-661"><a href="#cb395-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-662"><a href="#cb395-662" aria-hidden="true" tabindex="-1"></a>Although Wald Chi-Square tests revealed no significant main effects, there was a significant interaction between CONDITION and OSPAN, ($\chi^2 (1) = 4.62, p &lt; 0.05$).  <span class="co">[</span><span class="ot">SEE POSTHOCS BELOW</span><span class="co">]</span></span>
<span id="cb395-663"><a href="#cb395-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-664"><a href="#cb395-664" aria-hidden="true" tabindex="-1"></a>The model predicts that, in the control condition, the probability of a correct response for a participant with high vs. low working memory increases from (0.1 to 0.5%) a negligible difference. In the impasse condition, however, the probability of a correct response increases from only 1% for participants with low working memory, to 42% for participants with high working memory.  These results are consistent with the intuition we develop from Figure TODO. Participants with high working memory capacity are most able to take advantage of the impasse scaffold.</span>
<span id="cb395-665"><a href="#cb395-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-666"><a href="#cb395-666" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Interactions</span></span>
<span id="cb395-667"><a href="#cb395-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-670"><a href="#cb395-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-671"><a href="#cb395-671" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html#simple</span></span>
<span id="cb395-672"><a href="#cb395-672" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.oarc.ucla.edu/stata/faq/how-can-i-understand-a-categorical-by-categorical-interaction-in-logistic-regression-stata-12/</span></span>
<span id="cb395-673"><a href="#cb395-673" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.oarc.ucla.edu/stata/seminars/deciphering-interactions-in-logistic-regression/</span></span>
<span id="cb395-674"><a href="#cb395-674" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb395-675"><a href="#cb395-675" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb395-676"><a href="#cb395-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-677"><a href="#cb395-677" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check reference grid</span></span>
<span id="cb395-678"><a href="#cb395-678" aria-hidden="true" tabindex="-1"></a><span class="fu">ref_grid</span>(m)</span>
<span id="cb395-679"><a href="#cb395-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-680"><a href="#cb395-680" aria-hidden="true" tabindex="-1"></a><span class="co">#PRINT ESTIMATED MARGINAL MEANS</span></span>
<span id="cb395-681"><a href="#cb395-681" aria-hidden="true" tabindex="-1"></a><span class="co">#should be same as summ_preds</span></span>
<span id="cb395-682"><a href="#cb395-682" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m,  <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb395-683"><a href="#cb395-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-684"><a href="#cb395-684" aria-hidden="true" tabindex="-1"></a><span class="do">##POST-HOC COMPARISONS</span></span>
<span id="cb395-685"><a href="#cb395-685" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"POSTHOC COMPARISONS"</span>)</span>
<span id="cb395-686"><a href="#cb395-686" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m,  pairwise <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, </span>
<span id="cb395-687"><a href="#cb395-687" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"response"</span> , <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="co">#sidak, tukey</span></span>
<span id="cb395-688"><a href="#cb395-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-689"><a href="#cb395-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-690"><a href="#cb395-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-691"><a href="#cb395-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-692"><a href="#cb395-692" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT INTERACTION</span></span>
<span id="cb395-693"><a href="#cb395-693" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalent to plot_model, type = "int"</span></span>
<span id="cb395-694"><a href="#cb395-694" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(m, ospan_split <span class="sc">~</span> pretty_condition ,</span>
<span id="cb395-695"><a href="#cb395-695" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb395-696"><a href="#cb395-696" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-697"><a href="#cb395-697" aria-hidden="true" tabindex="-1"></a>      <span class="at">linearg =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>),</span>
<span id="cb395-698"><a href="#cb395-698" aria-hidden="true" tabindex="-1"></a>      <span class="at">engine =</span> <span class="st">"ggplot"</span>)</span>
<span id="cb395-699"><a href="#cb395-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-700"><a href="#cb395-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-701"><a href="#cb395-701" aria-hidden="true" tabindex="-1"></a><span class="do">##PLOT PROBABILITY</span></span>
<span id="cb395-702"><a href="#cb395-702" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ref_grid</span>(m), <span class="at">by =</span> <span class="st">"ospan_split"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb395-703"><a href="#cb395-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-704"><a href="#cb395-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-705"><a href="#cb395-705" aria-hidden="true" tabindex="-1"></a>**REPORTED**</span>
<span id="cb395-706"><a href="#cb395-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-707"><a href="#cb395-707" aria-hidden="true" tabindex="-1"></a>Posthoc paired comparisons reveal that there is not a significant difference in accuracy between the control and impasse condition for participants in the low-memory group (OR = 0.1, SE  = 0.15, z = -1.47, p = 0.46). </span>
<span id="cb395-708"><a href="#cb395-708" aria-hidden="true" tabindex="-1"></a>For those with low working memory capacity, performance with comparably low, regardless of condition.  </span>
<span id="cb395-709"><a href="#cb395-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-710"><a href="#cb395-710" aria-hidden="true" tabindex="-1"></a>For those who were assigned to the control condition, working memory capacity did not change performance. There was not significant difference in accuracy between participants with low vs. high working memory (OR = 1.95, SE= 2.80, z = 0.47  p = 0.97).  </span>
<span id="cb395-711"><a href="#cb395-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-712"><a href="#cb395-712" aria-hidden="true" tabindex="-1"></a>For those assigned to the impasse condition, however, if you had high working memory capacity, you had significantly higher probability of accurate responses (OR = 0.02, SE = 0.03, z = -2.370  p = 0.0180).  </span>
<span id="cb395-713"><a href="#cb395-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-714"><a href="#cb395-714" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Print</span></span>
<span id="cb395-717"><a href="#cb395-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-718"><a href="#cb395-718" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-ACC</span></span>
<span id="cb395-719"><a href="#cb395-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-720"><a href="#cb395-720" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb395-721"><a href="#cb395-721" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb395-722"><a href="#cb395-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-723"><a href="#cb395-723" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb395-724"><a href="#cb395-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-725"><a href="#cb395-725" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb395-726"><a href="#cb395-726" aria-hidden="true" tabindex="-1"></a><span class="co"># title = "Study 3C (OSPAN) | Question Accuracy | Mixed Logistic Regression"</span></span>
<span id="cb395-727"><a href="#cb395-727" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb395-728"><a href="#cb395-728" aria-hidden="true" tabindex="-1"></a><span class="co">#              paste("n = ",n_obs(m), "R^2(Conditional) =", round(r2(m)[[1]],2),</span></span>
<span id="cb395-729"><a href="#cb395-729" aria-hidden="true" tabindex="-1"></a><span class="co">#                    "R^2(Marginal) =", round(r2(m)[[2]],2)),</span></span>
<span id="cb395-730"><a href="#cb395-730" aria-hidden="true" tabindex="-1"></a><span class="co">#              "Accuracy  ~ Condition * OSPAN +  (1 | subject) + (1 | q)")</span></span>
<span id="cb395-731"><a href="#cb395-731" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-732"><a href="#cb395-732" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb395-733"><a href="#cb395-733" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb395-734"><a href="#cb395-734" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb395-735"><a href="#cb395-735" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb395-736"><a href="#cb395-736" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb395-737"><a href="#cb395-737" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb395-738"><a href="#cb395-738" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb395-739"><a href="#cb395-739" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb395-740"><a href="#cb395-740" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb395-741"><a href="#cb395-741" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = title,</span></span>
<span id="cb395-742"><a href="#cb395-742" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb395-743"><a href="#cb395-743" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "tables/SGC3C_OSPAN_GLMER_OverallAccuracy.tex")</span></span>
<span id="cb395-744"><a href="#cb395-744" aria-hidden="true" tabindex="-1"></a><span class="co">#              # coef_omit = "Intercept",</span></span>
<span id="cb395-745"><a href="#cb395-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-746"><a href="#cb395-746" aria-hidden="true" tabindex="-1"></a><span class="co"># extract_eq(m, use_coefs = TRUE, wrap = TRUE)</span></span>
<span id="cb395-747"><a href="#cb395-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-748"><a href="#cb395-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-749"><a href="#cb395-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-750"><a href="#cb395-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-751"><a href="#cb395-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-752"><a href="#cb395-752" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb395-753"><a href="#cb395-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-756"><a href="#cb395-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-757"><a href="#cb395-757" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-ACC</span></span>
<span id="cb395-758"><a href="#cb395-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-759"><a href="#cb395-759" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb395-760"><a href="#cb395-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-761"><a href="#cb395-761" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb395-762"><a href="#cb395-762" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb395-763"><a href="#cb395-763" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb395-764"><a href="#cb395-764" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-765"><a href="#cb395-765" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb395-766"><a href="#cb395-766" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb395-767"><a href="#cb395-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Estimate | Odds Ratio"</span>,</span>
<span id="cb395-768"><a href="#cb395-768" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb395-769"><a href="#cb395-769" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb395-770"><a href="#cb395-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-771"><a href="#cb395-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-772"><a href="#cb395-772" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb395-773"><a href="#cb395-773" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m, exponentiate = TRUE, component = "all")</span></span>
<span id="cb395-774"><a href="#cb395-774" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb395-775"><a href="#cb395-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-776"><a href="#cb395-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-777"><a href="#cb395-777" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb395-778"><a href="#cb395-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-779"><a href="#cb395-779" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb395-780"><a href="#cb395-780" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb395-781"><a href="#cb395-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-782"><a href="#cb395-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-783"><a href="#cb395-783" aria-hidden="true" tabindex="-1"></a><span class="co">#ONLY FOR BAYESIAN VERSION</span></span>
<span id="cb395-784"><a href="#cb395-784" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- rope(m)</span></span>
<span id="cb395-785"><a href="#cb395-785" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb395-786"><a href="#cb395-786" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-787"><a href="#cb395-787" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- pd(m)</span></span>
<span id="cb395-788"><a href="#cb395-788" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb395-789"><a href="#cb395-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-790"><a href="#cb395-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-791"><a href="#cb395-791" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb395-792"><a href="#cb395-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-793"><a href="#cb395-793" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb395-794"><a href="#cb395-794" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"int"</span>,</span>
<span id="cb395-795"><a href="#cb395-795" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-796"><a href="#cb395-796" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-797"><a href="#cb395-797" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb395-798"><a href="#cb395-798" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb395-799"><a href="#cb395-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-800"><a href="#cb395-800" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb395-801"><a href="#cb395-801" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)  </span>
<span id="cb395-802"><a href="#cb395-802" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"eff"</span>)  </span>
<span id="cb395-803"><a href="#cb395-803" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb395-804"><a href="#cb395-804" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb395-805"><a href="#cb395-805" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb395-806"><a href="#cb395-806" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb395-807"><a href="#cb395-807" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb395-808"><a href="#cb395-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-809"><a href="#cb395-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-810"><a href="#cb395-810" aria-hidden="true" tabindex="-1"></a><span class="co">#GGDIST | MODEL | PREDICTED PROBABILITIES</span></span>
<span id="cb395-811"><a href="#cb395-811" aria-hidden="true" tabindex="-1"></a>preds <span class="sc">%&gt;%</span> </span>
<span id="cb395-812"><a href="#cb395-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">x =</span> fit, <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> ospan_split)) <span class="sc">+</span> </span>
<span id="cb395-813"><a href="#cb395-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">normalize =</span> <span class="st">"panels"</span>) <span class="sc">+</span> </span>
<span id="cb395-814"><a href="#cb395-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb395-815"><a href="#cb395-815" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model PREDICTION | Probability of Accurate Response"</span>,</span>
<span id="cb395-816"><a href="#cb395-816" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"TODO check preds to see if fixed or includes random"</span></span>
<span id="cb395-817"><a href="#cb395-817" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb395-818"><a href="#cb395-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-819"><a href="#cb395-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-820"><a href="#cb395-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-823"><a href="#cb395-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-824"><a href="#cb395-824" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb395-825"><a href="#cb395-825" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb395-826"><a href="#cb395-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-827"><a href="#cb395-827" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb395-828"><a href="#cb395-828" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb395-829"><a href="#cb395-829" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list('"* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001"',</span></span>
<span id="cb395-830"><a href="#cb395-830" aria-hidden="true" tabindex="-1"></a><span class="co">#                'N(subject) = 133 $\tau_{00}$(subject) = 34.85',</span></span>
<span id="cb395-831"><a href="#cb395-831" aria-hidden="true" tabindex="-1"></a><span class="co">#              'N(question) = 13 $\tau_{00}$(question) = 1.14')</span></span>
<span id="cb395-832"><a href="#cb395-832" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-833"><a href="#cb395-833" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb395-834"><a href="#cb395-834" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb395-835"><a href="#cb395-835" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb395-836"><a href="#cb395-836" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb395-837"><a href="#cb395-837" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb395-838"><a href="#cb395-838" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb395-839"><a href="#cb395-839" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb395-840"><a href="#cb395-840" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb395-841"><a href="#cb395-841" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb395-842"><a href="#cb395-842" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',</span></span>
<span id="cb395-843"><a href="#cb395-843" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb395-844"><a href="#cb395-844" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_online.tex")</span></span>
<span id="cb395-845"><a href="#cb395-845" aria-hidden="true" tabindex="-1"></a><span class="co"># # #              # coef_omit = "Intercept",</span></span>
<span id="cb395-846"><a href="#cb395-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-847"><a href="#cb395-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-848"><a href="#cb395-848" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb395-849"><a href="#cb395-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-852"><a href="#cb395-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-853"><a href="#cb395-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DIAG-ACC</span></span>
<span id="cb395-854"><a href="#cb395-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb395-855"><a href="#cb395-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb395-856"><a href="#cb395-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-857"><a href="#cb395-857" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb395-858"><a href="#cb395-858" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb395-859"><a href="#cb395-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-860"><a href="#cb395-860" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PERFORMANCE")</span></span>
<span id="cb395-861"><a href="#cb395-861" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb395-862"><a href="#cb395-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-863"><a href="#cb395-863" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DIAGNOSTICS"</span>)</span>
<span id="cb395-864"><a href="#cb395-864" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span>
<span id="cb395-865"><a href="#cb395-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-866"><a href="#cb395-866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-867"><a href="#cb395-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-868"><a href="#cb395-868" aria-hidden="true" tabindex="-1"></a><span class="fu">## OVERALL INTERPRETATION STATE</span></span>
<span id="cb395-869"><a href="#cb395-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-870"><a href="#cb395-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-871"><a href="#cb395-871" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"orthogonal"** <span class="sc">\[</span>reference category<span class="sc">\]</span> includes orthogonal and satisficing responses ==<span class="sc">\&gt;</span> indicates a primarily *orthogonal* state of coordinate system understanding</span>
<span id="cb395-872"><a href="#cb395-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-873"><a href="#cb395-873" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"other"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =<span class="sc">\&gt;</span> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular</span>
<span id="cb395-874"><a href="#cb395-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-875"><a href="#cb395-875" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"angular"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb395-876"><a href="#cb395-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-877"><a href="#cb395-877" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"triangular"** includes correct triangular and 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb395-878"><a href="#cb395-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-879"><a href="#cb395-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-880"><a href="#cb395-880" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb395-881"><a href="#cb395-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-884"><a href="#cb395-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-885"><a href="#cb395-885" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-STATE</span></span>
<span id="cb395-886"><a href="#cb395-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-887"><a href="#cb395-887" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,subject,state,pretty_condition, ospan_split) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb395-888"><a href="#cb395-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-889"><a href="#cb395-889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-890"><a href="#cb395-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-891"><a href="#cb395-891" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb395-892"><a href="#cb395-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-895"><a href="#cb395-895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-896"><a href="#cb395-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb395-897"><a href="#cb395-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb395-898"><a href="#cb395-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-899"><a href="#cb395-899" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb395-900"><a href="#cb395-900" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb395-901"><a href="#cb395-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb395-902"><a href="#cb395-902" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb395-903"><a href="#cb395-903" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb395-904"><a href="#cb395-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb395-905"><a href="#cb395-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb395-906"><a href="#cb395-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split) <span class="sc">+</span></span>
<span id="cb395-907"><a href="#cb395-907" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation across all Questions"</span>,</span>
<span id="cb395-908"><a href="#cb395-908" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb395-909"><a href="#cb395-909" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb395-910"><a href="#cb395-910" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb395-911"><a href="#cb395-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-912"><a href="#cb395-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-913"><a href="#cb395-913" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb395-914"><a href="#cb395-914" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb395-915"><a href="#cb395-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb395-916"><a href="#cb395-916" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb395-917"><a href="#cb395-917" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb395-918"><a href="#cb395-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb395-919"><a href="#cb395-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb395-920"><a href="#cb395-920" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_brewer(palette = "Set1")  +</span></span>
<span id="cb395-921"><a href="#cb395-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(q <span class="sc">~</span> ospan_split) <span class="sc">+</span></span>
<span id="cb395-922"><a href="#cb395-922" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation by Question"</span>,</span>
<span id="cb395-923"><a href="#cb395-923" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb395-924"><a href="#cb395-924" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb395-925"><a href="#cb395-925" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb395-926"><a href="#cb395-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-927"><a href="#cb395-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-930"><a href="#cb395-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-931"><a href="#cb395-931" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb395-932"><a href="#cb395-932" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb395-933"><a href="#cb395-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-934"><a href="#cb395-934" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb395-935"><a href="#cb395-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-936"><a href="#cb395-936" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i %&gt;% mutate(</span></span>
<span id="cb395-937"><a href="#cb395-937" aria-hidden="true" tabindex="-1"></a><span class="co">#   state = fct_rev(state)</span></span>
<span id="cb395-938"><a href="#cb395-938" aria-hidden="true" tabindex="-1"></a><span class="co"># )  </span></span>
<span id="cb395-939"><a href="#cb395-939" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-940"><a href="#cb395-940" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;-   grouped_ggbarstats(data = temp, x = state, y = pretty_condition,</span></span>
<span id="cb395-941"><a href="#cb395-941" aria-hidden="true" tabindex="-1"></a><span class="co">#                           grouping.var = ospan_split,</span></span>
<span id="cb395-942"><a href="#cb395-942" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb395-943"><a href="#cb395-943" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb395-944"><a href="#cb395-944" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb395-945"><a href="#cb395-945" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 4))</span></span>
<span id="cb395-946"><a href="#cb395-946" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb395-947"><a href="#cb395-947" aria-hidden="true" tabindex="-1"></a><span class="co">#                ))  + theme_clean() + theme(legend.position = "bottom")</span></span>
<span id="cb395-948"><a href="#cb395-948" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-949"><a href="#cb395-949" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- p + labs(title = "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb395-950"><a href="#cb395-950" aria-hidden="true" tabindex="-1"></a><span class="co">#          y = "Proportion of Questions", x = "Condition",</span></span>
<span id="cb395-951"><a href="#cb395-951" aria-hidden="true" tabindex="-1"></a><span class="co">#          subtitle = "Impasse condition yields more correct responses")</span></span>
<span id="cb395-952"><a href="#cb395-952" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-953"><a href="#cb395-953" aria-hidden="true" tabindex="-1"></a><span class="co"># p</span></span>
<span id="cb395-954"><a href="#cb395-954" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(p, filename = "figures/SGC3A_LAB_Accuracy.png", width = 6, height =4)</span></span>
<span id="cb395-955"><a href="#cb395-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-956"><a href="#cb395-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-957"><a href="#cb395-957" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: LABELLED </span></span>
<span id="cb395-958"><a href="#cb395-958" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-959"><a href="#cb395-959" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- df_i </span></span>
<span id="cb395-960"><a href="#cb395-960" aria-hidden="true" tabindex="-1"></a><span class="co"># # %&gt;% mutate(</span></span>
<span id="cb395-961"><a href="#cb395-961" aria-hidden="true" tabindex="-1"></a><span class="co"># #   accuracy = fct_rev(accuracy)</span></span>
<span id="cb395-962"><a href="#cb395-962" aria-hidden="true" tabindex="-1"></a><span class="co"># # )</span></span>
<span id="cb395-963"><a href="#cb395-963" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-964"><a href="#cb395-964" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE PLOT WITH LABELS</span></span>
<span id="cb395-965"><a href="#cb395-965" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- grouped_ggbarstats(data = temp, x = state, y = pretty_condition,</span></span>
<span id="cb395-966"><a href="#cb395-966" aria-hidden="true" tabindex="-1"></a><span class="co">#                grouping.var = ospan_split,</span></span>
<span id="cb395-967"><a href="#cb395-967" aria-hidden="true" tabindex="-1"></a><span class="co">#                results.subtitle = FALSE,</span></span>
<span id="cb395-968"><a href="#cb395-968" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggplot.component = ## modify further with `{ggplot2}` functions</span></span>
<span id="cb395-969"><a href="#cb395-969" aria-hidden="true" tabindex="-1"></a><span class="co">#                 list(</span></span>
<span id="cb395-970"><a href="#cb395-970" aria-hidden="true" tabindex="-1"></a><span class="co">#                   scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 4))</span></span>
<span id="cb395-971"><a href="#cb395-971" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # theme(axis.text.x = element_text(angle = 90)))</span></span>
<span id="cb395-972"><a href="#cb395-972" aria-hidden="true" tabindex="-1"></a><span class="co">#                )) </span></span>
<span id="cb395-973"><a href="#cb395-973" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-974"><a href="#cb395-974" aria-hidden="true" tabindex="-1"></a><span class="co"># #FIX LABELS</span></span>
<span id="cb395-975"><a href="#cb395-975" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- p[[1]] +  labs(</span></span>
<span id="cb395-976"><a href="#cb395-976" aria-hidden="true" tabindex="-1"></a><span class="co">#   subtitle = "Impasse is particularly effective for subjects with high-working memory",</span></span>
<span id="cb395-977"><a href="#cb395-977" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response"</span></span>
<span id="cb395-978"><a href="#cb395-978" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") </span></span>
<span id="cb395-979"><a href="#cb395-979" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb395-980"><a href="#cb395-980" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;-   p[[2]] + labs(</span></span>
<span id="cb395-981"><a href="#cb395-981" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Condition", y = "Probability of Response",</span></span>
<span id="cb395-982"><a href="#cb395-982" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "   "</span></span>
<span id="cb395-983"><a href="#cb395-983" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme_clean() + theme(legend.position = "blank") +</span></span>
<span id="cb395-984"><a href="#cb395-984" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggeasy::easy_remove_axes(which="y", what=c("text","title"))</span></span>
<span id="cb395-985"><a href="#cb395-985" aria-hidden="true" tabindex="-1"></a><span class="co">#   # ggeasy::easy_remove_axes(which="y", what= ""))</span></span>
<span id="cb395-986"><a href="#cb395-986" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-987"><a href="#cb395-987" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE ROW</span></span>
<span id="cb395-988"><a href="#cb395-988" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-989"><a href="#cb395-989" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_row &lt;- plot_grid(p1,p2, rel_widths = c(1,0.85))</span></span>
<span id="cb395-990"><a href="#cb395-990" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-991"><a href="#cb395-991" aria-hidden="true" tabindex="-1"></a><span class="co"># title &lt;- ggdraw() + </span></span>
<span id="cb395-992"><a href="#cb395-992" aria-hidden="true" tabindex="-1"></a><span class="co">#   draw_label(</span></span>
<span id="cb395-993"><a href="#cb395-993" aria-hidden="true" tabindex="-1"></a><span class="co">#     "DISTRIBUTION | Question Accuracy",</span></span>
<span id="cb395-994"><a href="#cb395-994" aria-hidden="true" tabindex="-1"></a><span class="co">#     fontface = 'bold',</span></span>
<span id="cb395-995"><a href="#cb395-995" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0,</span></span>
<span id="cb395-996"><a href="#cb395-996" aria-hidden="true" tabindex="-1"></a><span class="co">#     hjust = 0</span></span>
<span id="cb395-997"><a href="#cb395-997" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb395-998"><a href="#cb395-998" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb395-999"><a href="#cb395-999" aria-hidden="true" tabindex="-1"></a><span class="co">#     # add margin on the left of the drawing canvas,</span></span>
<span id="cb395-1000"><a href="#cb395-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#     # so title is aligned with left edge of first plot</span></span>
<span id="cb395-1001"><a href="#cb395-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot.margin = margin(0, 0, 0, 7)</span></span>
<span id="cb395-1002"><a href="#cb395-1002" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb395-1003"><a href="#cb395-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1004"><a href="#cb395-1004" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1005"><a href="#cb395-1005" aria-hidden="true" tabindex="-1"></a><span class="co"># pg &lt;- plot_grid(</span></span>
<span id="cb395-1006"><a href="#cb395-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#   title,</span></span>
<span id="cb395-1007"><a href="#cb395-1007" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_row,</span></span>
<span id="cb395-1008"><a href="#cb395-1008" aria-hidden="true" tabindex="-1"></a><span class="co">#   ncol = 1,</span></span>
<span id="cb395-1009"><a href="#cb395-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#   # rel_heights values control vertical title margins</span></span>
<span id="cb395-1010"><a href="#cb395-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#   rel_heights = c(0.1, 1)</span></span>
<span id="cb395-1011"><a href="#cb395-1011" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean()</span></span>
<span id="cb395-1012"><a href="#cb395-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb395-1013"><a href="#cb395-1013" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1014"><a href="#cb395-1014" aria-hidden="true" tabindex="-1"></a><span class="co"># update_geom_defaults("text", list(colour = "grey20", family = theme_get()$text$family))</span></span>
<span id="cb395-1015"><a href="#cb395-1015" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1016"><a href="#cb395-1016" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1017"><a href="#cb395-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># pg</span></span>
<span id="cb395-1018"><a href="#cb395-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1019"><a href="#cb395-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1020"><a href="#cb395-1020" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(pg, filename = "figures/SGC3A_OSPAN_Accuracy.png", width = 6, height =4)</span></span>
<span id="cb395-1021"><a href="#cb395-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1022"><a href="#cb395-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1023"><a href="#cb395-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1024"><a href="#cb395-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1025"><a href="#cb395-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe</span></span>
<span id="cb395-1028"><a href="#cb395-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1029"><a href="#cb395-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb395-1030"><a href="#cb395-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1031"><a href="#cb395-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb395-1032"><a href="#cb395-1032" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb395-1033"><a href="#cb395-1033" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb395-1034"><a href="#cb395-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1035"><a href="#cb395-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1036"><a href="#cb395-1036" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition, df_i<span class="sc">$</span>ospan_split) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb395-1037"><a href="#cb395-1037" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb395-1038"><a href="#cb395-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1039"><a href="#cb395-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1040"><a href="#cb395-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1041"><a href="#cb395-1041" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MIXED MULTINOMIAL REGRESSION</span></span>
<span id="cb395-1042"><a href="#cb395-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1043"><a href="#cb395-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1044"><a href="#cb395-1044" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of of items across the task?*</span>
<span id="cb395-1045"><a href="#cb395-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1046"><a href="#cb395-1046" aria-hidden="true" tabindex="-1"></a>*Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).*</span>
<span id="cb395-1047"><a href="#cb395-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1048"><a href="#cb395-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>mblogit version wouldn't coverge, so using brms</span>
<span id="cb395-1049"><a href="#cb395-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1050"><a href="#cb395-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model \[brms\]</span></span>
<span id="cb395-1051"><a href="#cb395-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1054"><a href="#cb395-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1055"><a href="#cb395-1055" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-BRMS-STATE</span></span>
<span id="cb395-1056"><a href="#cb395-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1057"><a href="#cb395-1057" aria-hidden="true" tabindex="-1"></a>inf_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb395-1058"><a href="#cb395-1058" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS </span></span>
<span id="cb395-1059"><a href="#cb395-1059" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb395-1060"><a href="#cb395-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb395-1061"><a href="#cb395-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb395-1062"><a href="#cb395-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb395-1063"><a href="#cb395-1063" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on COEFFICIENT</span></span>
<span id="cb395-1064"><a href="#cb395-1064" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb395-1065"><a href="#cb395-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb395-1066"><a href="#cb395-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb395-1067"><a href="#cb395-1067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb395-1068"><a href="#cb395-1068" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb395-1069"><a href="#cb395-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1070"><a href="#cb395-1070" aria-hidden="true" tabindex="-1"></a>ixn_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb395-1071"><a href="#cb395-1071" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS </span></span>
<span id="cb395-1072"><a href="#cb395-1072" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb395-1073"><a href="#cb395-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb395-1074"><a href="#cb395-1074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb395-1075"><a href="#cb395-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb395-1076"><a href="#cb395-1076" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on CONDITION COEFFICIENT</span></span>
<span id="cb395-1077"><a href="#cb395-1077" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb395-1078"><a href="#cb395-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb395-1079"><a href="#cb395-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb395-1080"><a href="#cb395-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb395-1081"><a href="#cb395-1081" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on OSPAN COEFFICIENT</span></span>
<span id="cb395-1082"><a href="#cb395-1082" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb395-1083"><a href="#cb395-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb395-1084"><a href="#cb395-1084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb395-1085"><a href="#cb395-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb395-1086"><a href="#cb395-1086" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on IXN COEFFICIENT</span></span>
<span id="cb395-1087"><a href="#cb395-1087" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb395-1088"><a href="#cb395-1088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse:ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb395-1089"><a href="#cb395-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse:ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb395-1090"><a href="#cb395-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse:ospan_splithighMmemory"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb395-1091"><a href="#cb395-1091" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb395-1092"><a href="#cb395-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1093"><a href="#cb395-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN RANDOM ONLY</span></span>
<span id="cb395-1094"><a href="#cb395-1094" aria-hidden="true" tabindex="-1"></a>Bmm.cat.rSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb395-1095"><a href="#cb395-1095" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb395-1096"><a href="#cb395-1096" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb395-1097"><a href="#cb395-1097" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb395-1098"><a href="#cb395-1098" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb395-1099"><a href="#cb395-1099" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb395-1100"><a href="#cb395-1100" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb395-1101"><a href="#cb395-1101" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.rSQ_OSPAN.rds"</span>)</span>
<span id="cb395-1102"><a href="#cb395-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1103"><a href="#cb395-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1104"><a href="#cb395-1104" aria-hidden="true" tabindex="-1"></a><span class="co"># CONDITION ONLY MODEL</span></span>
<span id="cb395-1105"><a href="#cb395-1105" aria-hidden="true" tabindex="-1"></a>Bmm.cat.CrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb395-1106"><a href="#cb395-1106" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb395-1107"><a href="#cb395-1107" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> inf_priors,</span>
<span id="cb395-1108"><a href="#cb395-1108" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb395-1109"><a href="#cb395-1109" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb395-1110"><a href="#cb395-1110" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb395-1111"><a href="#cb395-1111" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb395-1112"><a href="#cb395-1112" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb395-1113"><a href="#cb395-1113" aria-hidden="true" tabindex="-1"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb395-1114"><a href="#cb395-1114" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.CrSQ_OSPAN.rds"</span>)</span>
<span id="cb395-1115"><a href="#cb395-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1116"><a href="#cb395-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1117"><a href="#cb395-1117" aria-hidden="true" tabindex="-1"></a><span class="do">##MODEL COMPARISON</span></span>
<span id="cb395-1118"><a href="#cb395-1118" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL COMPARISON: random effects (vs) CONDITION")</span></span>
<span id="cb395-1119"><a href="#cb395-1119" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesfactor(Bmm.cat.rSQ, Bmm.cat.CrSQ)</span></span>
<span id="cb395-1120"><a href="#cb395-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#substantial evidence in favor of conditon model over random only BF 1.64e+16</span></span>
<span id="cb395-1121"><a href="#cb395-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1122"><a href="#cb395-1122" aria-hidden="true" tabindex="-1"></a><span class="co"># CONDITION + OSPAN MODEL</span></span>
<span id="cb395-1123"><a href="#cb395-1123" aria-hidden="true" tabindex="-1"></a>Bmm.cat.COrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition<span class="sc">*</span>ospan_split <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb395-1124"><a href="#cb395-1124" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb395-1125"><a href="#cb395-1125" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> ixn_priors,</span>
<span id="cb395-1126"><a href="#cb395-1126" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb395-1127"><a href="#cb395-1127" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb395-1128"><a href="#cb395-1128" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb395-1129"><a href="#cb395-1129" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb395-1130"><a href="#cb395-1130" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb395-1131"><a href="#cb395-1131" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb395-1132"><a href="#cb395-1132" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.COrSQ_OSPAN.rds"</span>)</span>
<span id="cb395-1133"><a href="#cb395-1133" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.cat.COrSQ)</span></span>
<span id="cb395-1134"><a href="#cb395-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1135"><a href="#cb395-1135" aria-hidden="true" tabindex="-1"></a><span class="do">##MODEL COMPARISON</span></span>
<span id="cb395-1136"><a href="#cb395-1136" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL COMPARISON: COND*OSPAN (vs) CONDITION")</span></span>
<span id="cb395-1137"><a href="#cb395-1137" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesfactor(Bmm.cat.COrSQ, Bmm.cat.CrSQ)</span></span>
<span id="cb395-1138"><a href="#cb395-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#commment out bc we'll do this in next block</span></span>
<span id="cb395-1139"><a href="#cb395-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1140"><a href="#cb395-1140" aria-hidden="true" tabindex="-1"></a><span class="co">#which model is better?</span></span>
<span id="cb395-1141"><a href="#cb395-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(Bmm.cat.CrSQ, Bmm.cat.COrSQ)</span>
<span id="cb395-1142"><a href="#cb395-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># compare_performance(Bmm.cat.CrSQ, Bmm.cat.COrSQ)</span></span>
<span id="cb395-1143"><a href="#cb395-1143" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.cat.CrSQ, mm.cat.COrSQ)</span></span>
<span id="cb395-1144"><a href="#cb395-1144" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(mm.cat.COrSQ)</span></span>
<span id="cb395-1145"><a href="#cb395-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1146"><a href="#cb395-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1147"><a href="#cb395-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1148"><a href="#cb395-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1149"><a href="#cb395-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb395-1150"><a href="#cb395-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1153"><a href="#cb395-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1154"><a href="#cb395-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-BRMS-STATE</span></span>
<span id="cb395-1155"><a href="#cb395-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1156"><a href="#cb395-1156" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb395-1157"><a href="#cb395-1157" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> Bmm.cat.COrSQ</span>
<span id="cb395-1158"><a href="#cb395-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1159"><a href="#cb395-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb395-1160"><a href="#cb395-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1161"><a href="#cb395-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb395-1162"><a href="#cb395-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb395-1163"><a href="#cb395-1163" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(<span class="at">ci=</span>.<span class="dv">95</span>, m))</span>
<span id="cb395-1164"><a href="#cb395-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1165"><a href="#cb395-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"BAYES FACTOR [comparison to CONDITION only]"</span>)</span>
<span id="cb395-1166"><a href="#cb395-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#think of this like the anova(model) to get p values for each predictor</span></span>
<span id="cb395-1167"><a href="#cb395-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#has to recompile the models with rstan. total drag</span></span>
<span id="cb395-1168"><a href="#cb395-1168" aria-hidden="true" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">bayesfactor</span>(Bmm.cat.CrSQ, m))</span>
<span id="cb395-1169"><a href="#cb395-1169" aria-hidden="true" tabindex="-1"></a><span class="co"># already calculated this in step above</span></span>
<span id="cb395-1170"><a href="#cb395-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1171"><a href="#cb395-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DESCRIBE POSTERIOR"</span>)</span>
<span id="cb395-1172"><a href="#cb395-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1173"><a href="#cb395-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb395-1174"><a href="#cb395-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1175"><a href="#cb395-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span>
<span id="cb395-1176"><a href="#cb395-1176" aria-hidden="true" tabindex="-1"></a>(l <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(m))</span>
<span id="cb395-1177"><a href="#cb395-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># (tm &lt;- tidy(m,   conf.int = TRUE))</span></span>
<span id="cb395-1178"><a href="#cb395-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1179"><a href="#cb395-1179" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb395-1180"><a href="#cb395-1180" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>))</span>
<span id="cb395-1181"><a href="#cb395-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1182"><a href="#cb395-1182" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span>
<span id="cb395-1183"><a href="#cb395-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1184"><a href="#cb395-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICT METHOD</span></span>
<span id="cb395-1185"><a href="#cb395-1185" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, subject, q)</span>
<span id="cb395-1186"><a href="#cb395-1186" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> newdata, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb395-1187"><a href="#cb395-1187" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb395-1188"><a href="#cb395-1188" aria-hidden="true" tabindex="-1"></a><span class="co"># lengthen data frame to handle multinomial</span></span>
<span id="cb395-1189"><a href="#cb395-1189" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span></span>
<span id="cb395-1190"><a href="#cb395-1190" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>subject, <span class="sc">-</span>q) <span class="sc">%&gt;%</span> <span class="co">#marginalize over subject and q</span></span>
<span id="cb395-1191"><a href="#cb395-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb395-1192"><a href="#cb395-1192" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>pretty_condition <span class="sc">&amp;</span> <span class="sc">!</span>ospan_split,</span>
<span id="cb395-1193"><a href="#cb395-1193" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"preds"</span>,</span>
<span id="cb395-1194"><a href="#cb395-1194" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"state"</span>,</span>
<span id="cb395-1195"><a href="#cb395-1195" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb395-1196"><a href="#cb395-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1197"><a href="#cb395-1197" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span></span>
<span id="cb395-1198"><a href="#cb395-1198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pretty_condition, ospan_split, state ) <span class="sc">%&gt;%</span></span>
<span id="cb395-1199"><a href="#cb395-1199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb395-1200"><a href="#cb395-1200" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(preds),</span>
<span id="cb395-1201"><a href="#cb395-1201" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(preds)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb395-1202"><a href="#cb395-1202" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwr =</span> median <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb395-1203"><a href="#cb395-1203" aria-hidden="true" tabindex="-1"></a>    <span class="at">upr =</span> median <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se))</span>
<span id="cb395-1204"><a href="#cb395-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1205"><a href="#cb395-1205" aria-hidden="true" tabindex="-1"></a><span class="do">##DRAWS METHOD</span></span>
<span id="cb395-1206"><a href="#cb395-1206" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE draws from model</span></span>
<span id="cb395-1207"><a href="#cb395-1207" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb395-1208"><a href="#cb395-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb395-1209"><a href="#cb395-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb395-1210"><a href="#cb395-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb395-1211"><a href="#cb395-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb395-1212"><a href="#cb395-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb395-1213"><a href="#cb395-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb395-1214"><a href="#cb395-1214" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb395-1215"><a href="#cb395-1215" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1216"><a href="#cb395-1216" aria-hidden="true" tabindex="-1"></a><span class="co"># #OR load from file</span></span>
<span id="cb395-1217"><a href="#cb395-1217" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws &lt;- read_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb395-1218"><a href="#cb395-1218" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1219"><a href="#cb395-1219" aria-hidden="true" tabindex="-1"></a><span class="co"># # SUMMARIZE draws from model</span></span>
<span id="cb395-1220"><a href="#cb395-1220" aria-hidden="true" tabindex="-1"></a><span class="co"># (k &lt;- kable(draws %&gt;%</span></span>
<span id="cb395-1221"><a href="#cb395-1221" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb395-1222"><a href="#cb395-1222" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition, .category) %&gt;%</span></span>
<span id="cb395-1223"><a href="#cb395-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#   median_hdci(.value), digits = 4, col.names =</span></span>
<span id="cb395-1224"><a href="#cb395-1224" aria-hidden="true" tabindex="-1"></a><span class="co">#     c("Condition","Category", "Probability","Lower Cred.I","Upper Cred.I", "CI Width", "Point Type", "Interval Type")) %&gt;%</span></span>
<span id="cb395-1225"><a href="#cb395-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#   kable_styling())</span></span>
<span id="cb395-1226"><a href="#cb395-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1227"><a href="#cb395-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1228"><a href="#cb395-1228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1229"><a href="#cb395-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1230"><a href="#cb395-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">##### INFERENCE</span></span>
<span id="cb395-1231"><a href="#cb395-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1232"><a href="#cb395-1232" aria-hidden="true" tabindex="-1"></a>**Reported** </span>
<span id="cb395-1233"><a href="#cb395-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1234"><a href="#cb395-1234" aria-hidden="true" tabindex="-1"></a>To quantify the effect of working memory capacity on INTERPRETATION, we fit a (bayesian) mixed multinomial regression model with random intercepts for subjects and questions. A Bayes Factor model comparison (against a random intercepts + CONDITION model) indicates strong evidence for a a final model including fixed effects of CONDITION, OSPAN and their interaction term  (BF = 8.52).</span>
<span id="cb395-1235"><a href="#cb395-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1236"><a href="#cb395-1236" aria-hidden="true" tabindex="-1"></a>(note, the BF may change as it is estimated via simulation each time)</span>
<span id="cb395-1237"><a href="#cb395-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1238"><a href="#cb395-1238" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Interactions</span></span>
<span id="cb395-1239"><a href="#cb395-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1242"><a href="#cb395-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1243"><a href="#cb395-1243" aria-hidden="true" tabindex="-1"></a><span class="co">#EMMEANS doesn't support multinomial brms models. BUMMER</span></span>
<span id="cb395-1244"><a href="#cb395-1244" aria-hidden="true" tabindex="-1"></a><span class="co">#BUT brms has some built in stuffs. </span></span>
<span id="cb395-1245"><a href="#cb395-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1246"><a href="#cb395-1246" aria-hidden="true" tabindex="-1"></a><span class="co"># FOR MAIN EFFECTS PLOTS </span></span>
<span id="cb395-1247"><a href="#cb395-1247" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MAIN EFFECTS"</span>)</span>
<span id="cb395-1248"><a href="#cb395-1248" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(m, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-1249"><a href="#cb395-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1250"><a href="#cb395-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1251"><a href="#cb395-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"INTERACTION PLOT"</span>)</span>
<span id="cb395-1252"><a href="#cb395-1252" aria-hidden="true" tabindex="-1"></a><span class="co"># conditions &lt;- make_conditions(m, vars = c("pretty_condition","ospan_split"))</span></span>
<span id="cb395-1253"><a href="#cb395-1253" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">&lt;-</span> <span class="fu">make_conditions</span>(m, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"pretty_condition"</span>))</span>
<span id="cb395-1254"><a href="#cb395-1254" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(m, <span class="st">"ospan_split"</span>, <span class="at">conditions =</span> conditions,</span>
<span id="cb395-1255"><a href="#cb395-1255" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-1256"><a href="#cb395-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1257"><a href="#cb395-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"INTERACTION PLOT"</span>)</span>
<span id="cb395-1258"><a href="#cb395-1258" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"int"</span>)</span>
<span id="cb395-1259"><a href="#cb395-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1260"><a href="#cb395-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1261"><a href="#cb395-1261" aria-hidden="true" tabindex="-1"></a>**REPORTED**</span>
<span id="cb395-1262"><a href="#cb395-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1263"><a href="#cb395-1263" aria-hidden="true" tabindex="-1"></a>The model predicts similar probabilities for orthogonal, other, and angular interpretations by high vs. low working memory participants. It is only the (correct) triangular interpretation in which we have evidence for a reliable interaction between OSPAN and CONDITION. Much like the pattern of results for accuracy, it is high working memory participants with higher probability of triangular responses, but only in impasse condition. </span>
<span id="cb395-1264"><a href="#cb395-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1265"><a href="#cb395-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1266"><a href="#cb395-1266" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Print </span></span>
<span id="cb395-1269"><a href="#cb395-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1270"><a href="#cb395-1270" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-STATE</span></span>
<span id="cb395-1271"><a href="#cb395-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1272"><a href="#cb395-1272" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb395-1273"><a href="#cb395-1273" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb395-1274"><a href="#cb395-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1275"><a href="#cb395-1275" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb395-1276"><a href="#cb395-1276" aria-hidden="true" tabindex="-1"></a><span class="co">#model summary doesn't work for brms multinomial</span></span>
<span id="cb395-1277"><a href="#cb395-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1278"><a href="#cb395-1278" aria-hidden="true" tabindex="-1"></a><span class="co"># DOESN'T WORK FOR BRMS</span></span>
<span id="cb395-1279"><a href="#cb395-1279" aria-hidden="true" tabindex="-1"></a><span class="co"># extract_eq(m, use_coefs = TRUE, wrap = TRUE)</span></span>
<span id="cb395-1280"><a href="#cb395-1280" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1281"><a href="#cb395-1281" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1282"><a href="#cb395-1282" aria-hidden="true" tabindex="-1"></a><span class="co"># #GET MODEL ESTIMATES</span></span>
<span id="cb395-1283"><a href="#cb395-1283" aria-hidden="true" tabindex="-1"></a><span class="co"># t &lt;- as.data.frame(model_parameters(m, exponentiate = TRUE))</span></span>
<span id="cb395-1284"><a href="#cb395-1284" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb395-1285"><a href="#cb395-1285" aria-hidden="true" tabindex="-1"></a><span class="co"># # #REFORMAT</span></span>
<span id="cb395-1286"><a href="#cb395-1286" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- t %&gt;%</span></span>
<span id="cb395-1287"><a href="#cb395-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb395-1288"><a href="#cb395-1288" aria-hidden="true" tabindex="-1"></a><span class="co">#     Parameter = str_remove_all(Parameter,"_pretty"),</span></span>
<span id="cb395-1289"><a href="#cb395-1289" aria-hidden="true" tabindex="-1"></a><span class="co">#     Parameter = str_remove_all(Parameter,"b_mu"),</span></span>
<span id="cb395-1290"><a href="#cb395-1290" aria-hidden="true" tabindex="-1"></a><span class="co">#     Interpretation = word(Parameter, 1, sep = "_"),</span></span>
<span id="cb395-1291"><a href="#cb395-1291" aria-hidden="true" tabindex="-1"></a><span class="co">#     Interpretation = fct_relevel(Interpretation, levels = c("other","angular","triangular")),</span></span>
<span id="cb395-1292"><a href="#cb395-1292" aria-hidden="true" tabindex="-1"></a><span class="co">#     Factor = word(Parameter, 2, sep = "_"),</span></span>
<span id="cb395-1293"><a href="#cb395-1293" aria-hidden="true" tabindex="-1"></a><span class="co">#     Factor = recode_factor(Factor,</span></span>
<span id="cb395-1294"><a href="#cb395-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "Intercept" = "(Intercept)",</span></span>
<span id="cb395-1295"><a href="#cb395-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "conditionimpasse" = "Condition[impasse]",</span></span>
<span id="cb395-1296"><a href="#cb395-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ospan" = "OSPAN[high-memory]",</span></span>
<span id="cb395-1297"><a href="#cb395-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "conditionimpasse:ospan" = "Condition:OSPAN"),</span></span>
<span id="cb395-1298"><a href="#cb395-1298" aria-hidden="true" tabindex="-1"></a><span class="co">#     Median = round(Median,2),</span></span>
<span id="cb395-1299"><a href="#cb395-1299" aria-hidden="true" tabindex="-1"></a><span class="co">#     CI_low = round(CI_low,2),</span></span>
<span id="cb395-1300"><a href="#cb395-1300" aria-hidden="true" tabindex="-1"></a><span class="co">#     CI_high = round(CI_high,2),</span></span>
<span id="cb395-1301"><a href="#cb395-1301" aria-hidden="true" tabindex="-1"></a><span class="co">#     pd = round(pd,2),</span></span>
<span id="cb395-1302"><a href="#cb395-1302" aria-hidden="true" tabindex="-1"></a><span class="co">#     ROPE_Percentage = round(ROPE_Percentage,2)) %&gt;%</span></span>
<span id="cb395-1303"><a href="#cb395-1303" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(Interpretation) %&gt;%</span></span>
<span id="cb395-1304"><a href="#cb395-1304" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(-CI, -Rhat, -ESS) %&gt;%</span></span>
<span id="cb395-1305"><a href="#cb395-1305" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename( "%_in_ROPE"="ROPE_Percentage",</span></span>
<span id="cb395-1306"><a href="#cb395-1306" aria-hidden="true" tabindex="-1"></a><span class="co">#   "(Odds Ratio)" = "Median") %&gt;%</span></span>
<span id="cb395-1307"><a href="#cb395-1307" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(Interpretation, Factor, `(Odds Ratio)`, CI_low, CI_high, pd, `%_in_ROPE`)</span></span>
<span id="cb395-1308"><a href="#cb395-1308" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1309"><a href="#cb395-1309" aria-hidden="true" tabindex="-1"></a><span class="co"># # #KNIT</span></span>
<span id="cb395-1310"><a href="#cb395-1310" aria-hidden="true" tabindex="-1"></a><span class="co"># title = "Study 3C (OSPAN) | Question Interpretation | Mixed Multinomial Regression"</span></span>
<span id="cb395-1311"><a href="#cb395-1311" aria-hidden="true" tabindex="-1"></a><span class="co"># tab &lt;- kbl(x, format = "latex", caption = title,</span></span>
<span id="cb395-1312"><a href="#cb395-1312" aria-hidden="true" tabindex="-1"></a><span class="co">#            booktabs = FALSE) %&gt;% kable_classic() %&gt;%</span></span>
<span id="cb395-1313"><a href="#cb395-1313" aria-hidden="true" tabindex="-1"></a><span class="co"># footnote(general = paste("Model Interpretation ~ ",b$Model[2], "Bayes Factor ", format( exp(b$log_BF[2]), digits =2 ) ), footnote_as_chunk = T, general_title = "")</span></span>
<span id="cb395-1314"><a href="#cb395-1314" aria-hidden="true" tabindex="-1"></a><span class="co"># writeLines(tab, "tables/SGC3C_OSPAN_BRMS_state.tex")</span></span>
<span id="cb395-1315"><a href="#cb395-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1316"><a href="#cb395-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1317"><a href="#cb395-1317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1318"><a href="#cb395-1318" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb395-1319"><a href="#cb395-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1320"><a href="#cb395-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1323"><a href="#cb395-1323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1324"><a href="#cb395-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-BRMS-STATE</span></span>
<span id="cb395-1325"><a href="#cb395-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1326"><a href="#cb395-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1327"><a href="#cb395-1327" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb395-1328"><a href="#cb395-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1329"><a href="#cb395-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb395-1330"><a href="#cb395-1330" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red", </span></span>
<span id="cb395-1331"><a href="#cb395-1331" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb395-1332"><a href="#cb395-1332" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb395-1333"><a href="#cb395-1333" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.1, #manually adjust to account for directional test</span></span>
<span id="cb395-1334"><a href="#cb395-1334" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.90 ) + #manually adjusted for directional test   </span></span>
<span id="cb395-1335"><a href="#cb395-1335" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Model Estimate | Odds Ratio",</span></span>
<span id="cb395-1336"><a href="#cb395-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "",</span></span>
<span id="cb395-1337"><a href="#cb395-1337" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition")</span></span>
<span id="cb395-1338"><a href="#cb395-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1339"><a href="#cb395-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1340"><a href="#cb395-1340" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb395-1341"><a href="#cb395-1341" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb395-1342"><a href="#cb395-1342" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">TRUE</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>) </span>
<span id="cb395-1343"><a href="#cb395-1343" aria-hidden="true" tabindex="-1"></a><span class="co"># + theme_clean()</span></span>
<span id="cb395-1344"><a href="#cb395-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1345"><a href="#cb395-1345" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb395-1346"><a href="#cb395-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1347"><a href="#cb395-1347" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb395-1348"><a href="#cb395-1348" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb395-1349"><a href="#cb395-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1350"><a href="#cb395-1350" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb395-1351"><a href="#cb395-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb395-1352"><a href="#cb395-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1353"><a href="#cb395-1353" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO see documentation for removing, reorganizing parameters</span></span>
<span id="cb395-1354"><a href="#cb395-1354" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m, <span class="at">effects =</span> <span class="st">"fixed"</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb395-1355"><a href="#cb395-1355" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">FALSE</span>,</span>
<span id="cb395-1356"><a href="#cb395-1356" aria-hidden="true" tabindex="-1"></a>     <span class="at">n_columns =</span> <span class="dv">3</span>)</span>
<span id="cb395-1357"><a href="#cb395-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1358"><a href="#cb395-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1359"><a href="#cb395-1359" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb395-1360"><a href="#cb395-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1361"><a href="#cb395-1361" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb395-1362"><a href="#cb395-1362" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"int"</span>,</span>
<span id="cb395-1363"><a href="#cb395-1363" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-1364"><a href="#cb395-1364" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-1365"><a href="#cb395-1365" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb395-1366"><a href="#cb395-1366" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb395-1367"><a href="#cb395-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1368"><a href="#cb395-1368" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb395-1369"><a href="#cb395-1369" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")  </span></span>
<span id="cb395-1370"><a href="#cb395-1370" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "eff")  </span></span>
<span id="cb395-1371"><a href="#cb395-1371" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb395-1372"><a href="#cb395-1372" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb395-1373"><a href="#cb395-1373" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb395-1374"><a href="#cb395-1374" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb395-1375"><a href="#cb395-1375" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb395-1376"><a href="#cb395-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1377"><a href="#cb395-1377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1378"><a href="#cb395-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1381"><a href="#cb395-1381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1382"><a href="#cb395-1382" aria-hidden="true" tabindex="-1"></a><span class="co">#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE</span></span>
<span id="cb395-1383"><a href="#cb395-1383" aria-hidden="true" tabindex="-1"></a><span class="do">##WORKING</span></span>
<span id="cb395-1384"><a href="#cb395-1384" aria-hidden="true" tabindex="-1"></a><span class="co"># https://mjskay.github.io/ggdist/reference/stat_slab.html</span></span>
<span id="cb395-1385"><a href="#cb395-1385" aria-hidden="true" tabindex="-1"></a><span class="do">## VIS probability of correct response</span></span>
<span id="cb395-1386"><a href="#cb395-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REALLY LONG TIME</span></span>
<span id="cb395-1387"><a href="#cb395-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1388"><a href="#cb395-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#1 | get draws</span></span>
<span id="cb395-1389"><a href="#cb395-1389" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span></span>
<span id="cb395-1390"><a href="#cb395-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_grid</span>(pretty_condition, ospan_split, subject, q) <span class="sc">%&gt;%</span></span>
<span id="cb395-1391"><a href="#cb395-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(m,</span>
<span id="cb395-1392"><a href="#cb395-1392" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># ndraws = 100, # n = 100,</span></span>
<span id="cb395-1393"><a href="#cb395-1393" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># dpar = TRUE,</span></span>
<span id="cb395-1394"><a href="#cb395-1394" aria-hidden="true" tabindex="-1"></a>                   <span class="at">transform =</span> <span class="cn">TRUE</span>, <span class="co">#gives prob%, otherwise OR</span></span>
<span id="cb395-1395"><a href="#cb395-1395" aria-hidden="true" tabindex="-1"></a>                   <span class="at">re_formula =</span> <span class="cn">NA</span>)</span>
<span id="cb395-1396"><a href="#cb395-1396" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds")</span></span>
<span id="cb395-1397"><a href="#cb395-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1398"><a href="#cb395-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#OR load from file</span></span>
<span id="cb395-1399"><a href="#cb395-1399" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- read_rds(file = "analysis/SGC3A/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds")</span></span>
<span id="cb395-1400"><a href="#cb395-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1401"><a href="#cb395-1401" aria-hidden="true" tabindex="-1"></a><span class="co">#2| VISUALIZE PREDICTIONS | GGDIST</span></span>
<span id="cb395-1402"><a href="#cb395-1402" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO figure out height normalization.</span></span>
<span id="cb395-1403"><a href="#cb395-1403" aria-hidden="true" tabindex="-1"></a><span class="do">##do it with much smaller number of draws </span></span>
<span id="cb395-1404"><a href="#cb395-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb395-1405"><a href="#cb395-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REAAALY LONG TIME</span></span>
<span id="cb395-1406"><a href="#cb395-1406" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- </span></span>
<span id="cb395-1407"><a href="#cb395-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1408"><a href="#cb395-1408" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> draws <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb395-1409"><a href="#cb395-1409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .epred,  <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> ospan_split)) <span class="sc">+</span></span>
<span id="cb395-1410"><a href="#cb395-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(<span class="at">width =</span> <span class="fu">c</span>(.<span class="dv">95</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">normalize=</span><span class="st">"xy"</span>) <span class="sc">+</span></span>
<span id="cb395-1411"><a href="#cb395-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.category) <span class="sc">+</span></span>
<span id="cb395-1412"><a href="#cb395-1412" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   #normalize = all, panels, xy, groups, none</span></span>
<span id="cb395-1413"><a href="#cb395-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb395-1414"><a href="#cb395-1414" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Predicted Probability of Correct Response"</span>,</span>
<span id="cb395-1415"><a href="#cb395-1415" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"probability of correct response"</span>,</span>
<span id="cb395-1416"><a href="#cb395-1416" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Interpretation"</span></span>
<span id="cb395-1417"><a href="#cb395-1417" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>  <span class="fu">theme_clean</span>() <span class="co">#+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb395-1418"><a href="#cb395-1418" aria-hidden="true" tabindex="-1"></a><span class="co"># # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb395-1419"><a href="#cb395-1419" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb395-1420"><a href="#cb395-1420" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(d, filename = "figures/sgc3a_BBm.cat.CrSQ_lab_posterior.svg", width = 6, height =4)</span></span>
<span id="cb395-1421"><a href="#cb395-1421" aria-hidden="true" tabindex="-1"></a>d</span>
<span id="cb395-1422"><a href="#cb395-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1423"><a href="#cb395-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1424"><a href="#cb395-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1425"><a href="#cb395-1425" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb395-1426"><a href="#cb395-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1429"><a href="#cb395-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1430"><a href="#cb395-1430" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK Fit of posterior predictive to data</span></span>
<span id="cb395-1431"><a href="#cb395-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m, <span class="at">ndraws=</span><span class="dv">1000</span>)</span>
<span id="cb395-1432"><a href="#cb395-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1433"><a href="#cb395-1433" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK posterior vs. priors</span></span>
<span id="cb395-1434"><a href="#cb395-1434" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">estimate_density</span>(m)</span>
<span id="cb395-1435"><a href="#cb395-1435" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">stack =</span> <span class="cn">FALSE</span>, <span class="at">priors=</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-1436"><a href="#cb395-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1437"><a href="#cb395-1437" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK model</span></span>
<span id="cb395-1438"><a href="#cb395-1438" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span>
<span id="cb395-1439"><a href="#cb395-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1440"><a href="#cb395-1440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1441"><a href="#cb395-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1442"><a href="#cb395-1442" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1 ACCURACY</span></span>
<span id="cb395-1443"><a href="#cb395-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1444"><a href="#cb395-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1445"><a href="#cb395-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1446"><a href="#cb395-1446" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb395-1449"><a href="#cb395-1449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1450"><a href="#cb395-1450" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1ACC</span></span>
<span id="cb395-1451"><a href="#cb395-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1452"><a href="#cb395-1452" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy, pretty_condition, ospan_split)</span>
<span id="cb395-1453"><a href="#cb395-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1454"><a href="#cb395-1454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1455"><a href="#cb395-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1456"><a href="#cb395-1456" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe </span></span>
<span id="cb395-1459"><a href="#cb395-1459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1460"><a href="#cb395-1460" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-Q1ACC</span></span>
<span id="cb395-1461"><a href="#cb395-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1462"><a href="#cb395-1462" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb395-1463"><a href="#cb395-1463" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb395-1464"><a href="#cb395-1464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb395-1465"><a href="#cb395-1465" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb395-1466"><a href="#cb395-1466" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb395-1467"><a href="#cb395-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb395-1468"><a href="#cb395-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb395-1469"><a href="#cb395-1469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split) <span class="sc">+</span></span>
<span id="cb395-1470"><a href="#cb395-1470" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb395-1471"><a href="#cb395-1471" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Accuracy"</span>,</span>
<span id="cb395-1472"><a href="#cb395-1472" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb395-1473"><a href="#cb395-1473" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb395-1474"><a href="#cb395-1474" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb395-1475"><a href="#cb395-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1476"><a href="#cb395-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1477"><a href="#cb395-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1478"><a href="#cb395-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1481"><a href="#cb395-1481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1482"><a href="#cb395-1482" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-Q1ACC</span></span>
<span id="cb395-1483"><a href="#cb395-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1484"><a href="#cb395-1484" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb395-1485"><a href="#cb395-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1486"><a href="#cb395-1486" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Proportions of Correct Responses by Condition"</span>)</span>
<span id="cb395-1487"><a href="#cb395-1487" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb395-1488"><a href="#cb395-1488" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb395-1489"><a href="#cb395-1489" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb395-1490"><a href="#cb395-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1491"><a href="#cb395-1491" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Number of Correct Responses by Condition"</span>)</span>
<span id="cb395-1492"><a href="#cb395-1492" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition, df<span class="sc">$</span>ospan_split) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb395-1493"><a href="#cb395-1493" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb395-1494"><a href="#cb395-1494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1495"><a href="#cb395-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1496"><a href="#cb395-1496" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CHI SQUARE [YES]</span></span>
<span id="cb395-1497"><a href="#cb395-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1500"><a href="#cb395-1500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1501"><a href="#cb395-1501" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: TESTS-Q1ACC</span></span>
<span id="cb395-1502"><a href="#cb395-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1503"><a href="#cb395-1503" aria-hidden="true" tabindex="-1"></a><span class="co">#CHI SQUARE ON ACCURACY X OSPAN-SPLIT in LOW WORKING MEMORY</span></span>
<span id="cb395-1504"><a href="#cb395-1504" aria-hidden="true" tabindex="-1"></a>df_low <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ospan_split <span class="sc">==</span> <span class="st">"low-memory"</span>)</span>
<span id="cb395-1505"><a href="#cb395-1505" aria-hidden="true" tabindex="-1"></a><span class="co"># table(df_low$pretty_condition, df_low$accuracy)</span></span>
<span id="cb395-1506"><a href="#cb395-1506" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>( <span class="at">x =</span> df_low<span class="sc">$</span>pretty_condition, <span class="at">y =</span> df_low<span class="sc">$</span>accuracy, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-1507"><a href="#cb395-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1508"><a href="#cb395-1508" aria-hidden="true" tabindex="-1"></a><span class="co">#CHI SQUARE ON ACCURACY X OSPAN-SPLIT in HIGH WORKING MEMORY</span></span>
<span id="cb395-1509"><a href="#cb395-1509" aria-hidden="true" tabindex="-1"></a>df_high <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ospan_split <span class="sc">==</span> <span class="st">"high-memory"</span>)</span>
<span id="cb395-1510"><a href="#cb395-1510" aria-hidden="true" tabindex="-1"></a><span class="co">#table(df_high$pretty_condition, df_high$accuracy)</span></span>
<span id="cb395-1511"><a href="#cb395-1511" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>( <span class="at">x =</span> df_high<span class="sc">$</span>pretty_condition, <span class="at">y =</span> df_high<span class="sc">$</span>accuracy,<span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-1512"><a href="#cb395-1512" aria-hidden="true" tabindex="-1"></a><span class="co">#significant if correct = FALSE</span></span>
<span id="cb395-1513"><a href="#cb395-1513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1514"><a href="#cb395-1514" aria-hidden="true" tabindex="-1"></a>TODO why do these chisqrs not match the grouped bar stats?</span>
<span id="cb395-1517"><a href="#cb395-1517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1518"><a href="#cb395-1518" aria-hidden="true" tabindex="-1"></a><span class="co"># INTERACTION (OSPAN X CONDITION)</span></span>
<span id="cb395-1519"><a href="#cb395-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbarstats</span>( <span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> pretty_condition, </span>
<span id="cb395-1520"><a href="#cb395-1520" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grouping.var =</span> ospan_split,</span>
<span id="cb395-1521"><a href="#cb395-1521" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"nonparametric"</span>)</span>
<span id="cb395-1522"><a href="#cb395-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1523"><a href="#cb395-1523" aria-hidden="true" tabindex="-1"></a><span class="co"># MAIN EFFECT CONDITION (yes)</span></span>
<span id="cb395-1524"><a href="#cb395-1524" aria-hidden="true" tabindex="-1"></a><span class="co"># ggbarstats( data = df, x = accuracy, y = pretty_condition, </span></span>
<span id="cb395-1525"><a href="#cb395-1525" aria-hidden="true" tabindex="-1"></a><span class="co">#                     type = "nonparametric")</span></span>
<span id="cb395-1526"><a href="#cb395-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1527"><a href="#cb395-1527" aria-hidden="true" tabindex="-1"></a><span class="co"># MAIN EFFECT OSPAN (none)</span></span>
<span id="cb395-1528"><a href="#cb395-1528" aria-hidden="true" tabindex="-1"></a><span class="co"># ggbarstats( data = df, x = accuracy, y = ospan_split, </span></span>
<span id="cb395-1529"><a href="#cb395-1529" aria-hidden="true" tabindex="-1"></a><span class="co">#                     type = "nonparametric")</span></span>
<span id="cb395-1530"><a href="#cb395-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1531"><a href="#cb395-1531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1532"><a href="#cb395-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1533"><a href="#cb395-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1534"><a href="#cb395-1534" aria-hidden="true" tabindex="-1"></a>There is no non-parametric version of two-way ANOVA, so we perform individual CHI-SQR tests. We split the data into two groups (low memory, and high memory, based on the median split). For each, we run a CHI SQR test of independence testing the null hypothesis that Q1 ACCURACY is independent of CONDITION.  In the low-working memory group, we cannot reject the null hypothesis, suggesting that accuracy does not differ by condition. But in the HIGH working memory group we do reject the null hypothesis.  The proportion of correct responses in IMPASSE is much higher than in CONTROL, but only in the HIGH WORKING MEMORY group. </span>
<span id="cb395-1535"><a href="#cb395-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1536"><a href="#cb395-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1537"><a href="#cb395-1537" aria-hidden="true" tabindex="-1"></a><span class="fu">#### LOGISTIC REGRESSION (MAIN EFFECT CONDITION)</span></span>
<span id="cb395-1538"><a href="#cb395-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1539"><a href="#cb395-1539" aria-hidden="true" tabindex="-1"></a>TODO:: consider weighted(centered) continuous vs ospan split</span>
<span id="cb395-1540"><a href="#cb395-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1541"><a href="#cb395-1541" aria-hidden="true" tabindex="-1"></a>Fit a logistic regression predicting accuracy (absolute score) (n = <span class="in">`r nrow(df)`</span>) by condition (k = 2).\</span>
<span id="cb395-1542"><a href="#cb395-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1543"><a href="#cb395-1543" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{0}$ = Log Odds of (correct) responses in CONTROL condition</span>
<span id="cb395-1544"><a href="#cb395-1544" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$e^{\beta_{0}}$ = ODDS of correct response in CONTROL condition</span>
<span id="cb395-1545"><a href="#cb395-1545" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{1}$ = $\beta_{1impasse}$ Log Odds (Log OR; change in odds for correct response in impasse (vs) control <span class="sc">\[</span>log scale<span class="sc">\]</span>)</span>
<span id="cb395-1546"><a href="#cb395-1546" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$e^{\beta_{1}}$ = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</span>
<span id="cb395-1547"><a href="#cb395-1547" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Null hypothesis**:$\beta_{impasse} \le 0$ the odds for a correct response does not change, or decreases</span>
<span id="cb395-1548"><a href="#cb395-1548" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Alternative hypothesis:** $\beta_{impasse} \gt 0$ the odds of a correct response increases</span>
<span id="cb395-1549"><a href="#cb395-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1550"><a href="#cb395-1550" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit CONDITION Model</span></span>
<span id="cb395-1551"><a href="#cb395-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1552"><a href="#cb395-1552" aria-hidden="true" tabindex="-1"></a>*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*</span>
<span id="cb395-1553"><a href="#cb395-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1556"><a href="#cb395-1556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1557"><a href="#cb395-1557" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-MODEL-Q1ACC</span></span>
<span id="cb395-1558"><a href="#cb395-1558" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb395-1559"><a href="#cb395-1559" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb395-1560"><a href="#cb395-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1561"><a href="#cb395-1561" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING ::::::::</span></span>
<span id="cb395-1562"><a href="#cb395-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1563"><a href="#cb395-1563" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb395-1564"><a href="#cb395-1564" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb395-1565"><a href="#cb395-1565" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb395-1566"><a href="#cb395-1566" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb395-1567"><a href="#cb395-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1568"><a href="#cb395-1568" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb395-1569"><a href="#cb395-1569" aria-hidden="true" tabindex="-1"></a>m.C <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb395-1570"><a href="#cb395-1570" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb395-1571"><a href="#cb395-1571" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m1)</span></span>
<span id="cb395-1572"><a href="#cb395-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1573"><a href="#cb395-1573" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb395-1574"><a href="#cb395-1574" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m<span class="fl">.0</span><span class="sc">$</span>aic <span class="sc">&gt;</span> m.C<span class="sc">$</span>aic)</span>
<span id="cb395-1575"><a href="#cb395-1575" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m<span class="fl">.0</span>,m.C) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb395-1576"><a href="#cb395-1576" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m<span class="fl">.0</span>,m.C))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb395-1577"><a href="#cb395-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1578"><a href="#cb395-1578" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.C)</span>
<span id="cb395-1579"><a href="#cb395-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1580"><a href="#cb395-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1581"><a href="#cb395-1581" aria-hidden="true" tabindex="-1"></a><span class="do">##### Fit OSPAN Models</span></span>
<span id="cb395-1582"><a href="#cb395-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1583"><a href="#cb395-1583" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 OSPAN ONLY MODEL </span></span>
<span id="cb395-1584"><a href="#cb395-1584" aria-hidden="true" tabindex="-1"></a>m.O <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> ospan_split, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb395-1585"><a href="#cb395-1585" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb395-1586"><a href="#cb395-1586" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb395-1587"><a href="#cb395-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1588"><a href="#cb395-1588" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb395-1589"><a href="#cb395-1589" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC OSPAN predictor is lower than CONDITION model?"</span>, m.C<span class="sc">$</span>aic <span class="sc">&gt;</span> m.O<span class="sc">$</span>aic)</span>
<span id="cb395-1590"><a href="#cb395-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1591"><a href="#cb395-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1592"><a href="#cb395-1592" aria-hidden="true" tabindex="-1"></a><span class="co">#: 4 OSPAN + CONDITION model</span></span>
<span id="cb395-1593"><a href="#cb395-1593" aria-hidden="true" tabindex="-1"></a>m.CO <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb395-1594"><a href="#cb395-1594" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb395-1595"><a href="#cb395-1595" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.CO)</span>
<span id="cb395-1596"><a href="#cb395-1596" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m.CO, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb395-1597"><a href="#cb395-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1598"><a href="#cb395-1598" aria-hidden="true" tabindex="-1"></a><span class="co">#: 4 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb395-1599"><a href="#cb395-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth OSPAN is lower than CONDITION only model?"</span>, m.C<span class="sc">$</span>aic <span class="sc">&gt;</span> m.CO<span class="sc">$</span>aic)</span>
<span id="cb395-1600"><a href="#cb395-1600" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.C,m.CO) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb395-1601"><a href="#cb395-1601" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m.C,m.CO))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb395-1602"><a href="#cb395-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1603"><a href="#cb395-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1604"><a href="#cb395-1604" aria-hidden="true" tabindex="-1"></a><span class="do">##Adding OSPAN as a predictor (no interaction) decreases AIC, but does not improve fit (LRT)</span></span>
<span id="cb395-1605"><a href="#cb395-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1606"><a href="#cb395-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1607"><a href="#cb395-1607" aria-hidden="true" tabindex="-1"></a><span class="co">#: 5 OSPAN + CONDITION INTERACTION model</span></span>
<span id="cb395-1608"><a href="#cb395-1608" aria-hidden="true" tabindex="-1"></a>m.C.O <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition <span class="sc">*</span> ospan_split, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb395-1609"><a href="#cb395-1609" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb395-1610"><a href="#cb395-1610" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m.C.O)</span></span>
<span id="cb395-1611"><a href="#cb395-1611" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(m.C.O, type =3)</span></span>
<span id="cb395-1612"><a href="#cb395-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1613"><a href="#cb395-1613" aria-hidden="true" tabindex="-1"></a><span class="co">#: 5 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb395-1614"><a href="#cb395-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth OSPAN IXN lower than CONDITION + OSPAN only model?"</span>, m.CO<span class="sc">$</span>aic <span class="sc">&gt;</span> m.C.O<span class="sc">$</span>aic)</span>
<span id="cb395-1615"><a href="#cb395-1615" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.CO,m.C.O) </span>
<span id="cb395-1616"><a href="#cb395-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1617"><a href="#cb395-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1618"><a href="#cb395-1618" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth OSPAN IXN is lower than CONDITION only model?"</span>, m.C<span class="sc">$</span>aic <span class="sc">&gt;</span> m.C.O<span class="sc">$</span>aic)</span>
<span id="cb395-1619"><a href="#cb395-1619" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m.C,m.C.O) </span>
<span id="cb395-1620"><a href="#cb395-1620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1621"><a href="#cb395-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1622"><a href="#cb395-1622" aria-hidden="true" tabindex="-1"></a>**Adding OSPAN interaction does not improve model fit over condition-only model, or main effects only model.**</span>
<span id="cb395-1623"><a href="#cb395-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1624"><a href="#cb395-1624" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb395-1625"><a href="#cb395-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1628"><a href="#cb395-1628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1629"><a href="#cb395-1629" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-MODEL-Q1ACC</span></span>
<span id="cb395-1630"><a href="#cb395-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1631"><a href="#cb395-1631" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb395-1632"><a href="#cb395-1632" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m.C.O</span>
<span id="cb395-1633"><a href="#cb395-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1634"><a href="#cb395-1634" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb395-1635"><a href="#cb395-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1636"><a href="#cb395-1636" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL [default two-tailed sig test]"</span>)</span>
<span id="cb395-1637"><a href="#cb395-1637" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb395-1638"><a href="#cb395-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1639"><a href="#cb395-1639" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFIGANCE TEST"</span>)</span>
<span id="cb395-1640"><a href="#cb395-1640" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb395-1641"><a href="#cb395-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1642"><a href="#cb395-1642" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb395-1643"><a href="#cb395-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1644"><a href="#cb395-1644" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb395-1645"><a href="#cb395-1645" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb395-1646"><a href="#cb395-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1647"><a href="#cb395-1647" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb395-1648"><a href="#cb395-1648" aria-hidden="true" tabindex="-1"></a><span class="co"># tt &lt;- 2*pnorm(summary(m)$coefficients[2:4], lower.tail = F)</span></span>
<span id="cb395-1649"><a href="#cb395-1649" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("p value for two-tailed test, null B = 0 : ",round(tt,3))</span></span>
<span id="cb395-1650"><a href="#cb395-1650" aria-hidden="true" tabindex="-1"></a><span class="co"># ot &lt;- pnorm(summary(m)$coefficients[2:4], lower.tail = F)</span></span>
<span id="cb395-1651"><a href="#cb395-1651" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("BUT we want a one tailed directional, null: B &lt;= 0: ",round(ot,3))</span></span>
<span id="cb395-1652"><a href="#cb395-1652" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("adjusted confint for directional hypothesis")</span></span>
<span id="cb395-1653"><a href="#cb395-1653" aria-hidden="true" tabindex="-1"></a><span class="co"># (dcint &lt;- confint(m, level = 0.90)) # get 90% for right side))</span></span>
<span id="cb395-1654"><a href="#cb395-1654" aria-hidden="true" tabindex="-1"></a><span class="co"># # https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb395-1655"><a href="#cb395-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1656"><a href="#cb395-1656" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb395-1657"><a href="#cb395-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1658"><a href="#cb395-1658" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval —- LOG ODDS")</span></span>
<span id="cb395-1659"><a href="#cb395-1659" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb395-1660"><a href="#cb395-1660" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span>
<span id="cb395-1661"><a href="#cb395-1661" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m)), <span class="fu">exp</span>(<span class="fu">confint</span>(m)))) <span class="co">#exponentiated, not adjusted</span></span>
<span id="cb395-1662"><a href="#cb395-1662" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m)), exp(dcint))) #exponentiated, adjusted</span></span>
<span id="cb395-1663"><a href="#cb395-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1664"><a href="#cb395-1664" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO INTERACTIONS &amp; ESTIMATED MARGINAL MEANS </span></span>
<span id="cb395-1665"><a href="#cb395-1665" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PREDICTIONS")</span></span>
<span id="cb395-1666"><a href="#cb395-1666" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb395-1667"><a href="#cb395-1667" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb395-1668"><a href="#cb395-1668" aria-hidden="true" tabindex="-1"></a><span class="co"># pred.control &lt;- predict(m,data.frame(pretty_condition="control"),type="response")</span></span>
<span id="cb395-1669"><a href="#cb395-1669" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient)</span></span>
<span id="cb395-1670"><a href="#cb395-1670" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Probability of success in control,", pred.control)</span></span>
<span id="cb395-1671"><a href="#cb395-1671" aria-hidden="true" tabindex="-1"></a><span class="co"># pred.impasse &lt;- predict(m,data.frame(pretty_condition="impasse"),type="response")</span></span>
<span id="cb395-1672"><a href="#cb395-1672" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient + predictor coeff)</span></span>
<span id="cb395-1673"><a href="#cb395-1673" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Probability of success in impasse,", pred.impasse)</span></span>
<span id="cb395-1674"><a href="#cb395-1674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1675"><a href="#cb395-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1676"><a href="#cb395-1676" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb395-1677"><a href="#cb395-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1678"><a href="#cb395-1678" aria-hidden="true" tabindex="-1"></a>TODO double check chisqrs vs grouped_barstats. Why is the tests not the same. Otherwise report mm.C as ospan didn't improve fit</span>
<span id="cb395-1679"><a href="#cb395-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1680"><a href="#cb395-1680" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb395-1681"><a href="#cb395-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1684"><a href="#cb395-1684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1685"><a href="#cb395-1685" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-Q1ACC</span></span>
<span id="cb395-1686"><a href="#cb395-1686" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb395-1687"><a href="#cb395-1687" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb395-1688"><a href="#cb395-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1689"><a href="#cb395-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1690"><a href="#cb395-1690" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb395-1691"><a href="#cb395-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1692"><a href="#cb395-1692" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb395-1693"><a href="#cb395-1693" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb395-1694"><a href="#cb395-1694" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb395-1695"><a href="#cb395-1695" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-1696"><a href="#cb395-1696" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb395-1697"><a href="#cb395-1697" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb395-1698"><a href="#cb395-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Estimate | Odds Ratio"</span>,</span>
<span id="cb395-1699"><a href="#cb395-1699" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb395-1700"><a href="#cb395-1700" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb395-1701"><a href="#cb395-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1702"><a href="#cb395-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1703"><a href="#cb395-1703" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb395-1704"><a href="#cb395-1704" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m, exponentiate = TRUE, component = "all")</span></span>
<span id="cb395-1705"><a href="#cb395-1705" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb395-1706"><a href="#cb395-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1707"><a href="#cb395-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1708"><a href="#cb395-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1709"><a href="#cb395-1709" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb395-1710"><a href="#cb395-1710" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb395-1711"><a href="#cb395-1711" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb395-1712"><a href="#cb395-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1713"><a href="#cb395-1713" aria-hidden="true" tabindex="-1"></a><span class="co">#ONLY FOR BAYESIAN VERSION</span></span>
<span id="cb395-1714"><a href="#cb395-1714" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- rope(m)</span></span>
<span id="cb395-1715"><a href="#cb395-1715" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb395-1716"><a href="#cb395-1716" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1717"><a href="#cb395-1717" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- pd(m)</span></span>
<span id="cb395-1718"><a href="#cb395-1718" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb395-1719"><a href="#cb395-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1720"><a href="#cb395-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1721"><a href="#cb395-1721" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb395-1722"><a href="#cb395-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1723"><a href="#cb395-1723" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb395-1724"><a href="#cb395-1724" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"int"</span>,</span>
<span id="cb395-1725"><a href="#cb395-1725" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-1726"><a href="#cb395-1726" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-1727"><a href="#cb395-1727" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Prediction | Probability of Accurate Response"</span>,</span>
<span id="cb395-1728"><a href="#cb395-1728" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb395-1729"><a href="#cb395-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1730"><a href="#cb395-1730" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT MODEL PREDICTION</span></span>
<span id="cb395-1731"><a href="#cb395-1731" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)  </span>
<span id="cb395-1732"><a href="#cb395-1732" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"eff"</span>)  </span>
<span id="cb395-1733"><a href="#cb395-1733" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,1) + </span></span>
<span id="cb395-1734"><a href="#cb395-1734" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb395-1735"><a href="#cb395-1735" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb395-1736"><a href="#cb395-1736" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb395-1737"><a href="#cb395-1737" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb395-1738"><a href="#cb395-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1739"><a href="#cb395-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1740"><a href="#cb395-1740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1741"><a href="#cb395-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1744"><a href="#cb395-1744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1745"><a href="#cb395-1745" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: TBL-MODEL-Q1ACC</span></span>
<span id="cb395-1746"><a href="#cb395-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1747"><a href="#cb395-1747" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb395-1748"><a href="#cb395-1748" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb395-1749"><a href="#cb395-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1750"><a href="#cb395-1750" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb395-1751"><a href="#cb395-1751" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb395-1752"><a href="#cb395-1752" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb395-1753"><a href="#cb395-1753" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb395-1754"><a href="#cb395-1754" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb395-1755"><a href="#cb395-1755" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-1756"><a href="#cb395-1756" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb395-1757"><a href="#cb395-1757" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb395-1758"><a href="#cb395-1758" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb395-1759"><a href="#cb395-1759" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb395-1760"><a href="#cb395-1760" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb395-1761"><a href="#cb395-1761" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb395-1762"><a href="#cb395-1762" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb395-1763"><a href="#cb395-1763" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb395-1764"><a href="#cb395-1764" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb395-1765"><a href="#cb395-1765" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb395-1766"><a href="#cb395-1766" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb395-1767"><a href="#cb395-1767" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb395-1768"><a href="#cb395-1768" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb395-1769"><a href="#cb395-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1770"><a href="#cb395-1770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1771"><a href="#cb395-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1772"><a href="#cb395-1772" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb395-1773"><a href="#cb395-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1776"><a href="#cb395-1776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1777"><a href="#cb395-1777" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DIAG-MODEL-Q1ACC</span></span>
<span id="cb395-1778"><a href="#cb395-1778" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb395-1779"><a href="#cb395-1779" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb395-1780"><a href="#cb395-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1781"><a href="#cb395-1781" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb395-1782"><a href="#cb395-1782" aria-hidden="true" tabindex="-1"></a><span class="co"># report::report(m)</span></span>
<span id="cb395-1783"><a href="#cb395-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1784"><a href="#cb395-1784" aria-hidden="true" tabindex="-1"></a><span class="co">#print("MODEL PERFORMANCE")</span></span>
<span id="cb395-1785"><a href="#cb395-1785" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb395-1786"><a href="#cb395-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1787"><a href="#cb395-1787" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span>
<span id="cb395-1788"><a href="#cb395-1788" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span>
<span id="cb395-1789"><a href="#cb395-1789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1790"><a href="#cb395-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1791"><a href="#cb395-1791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1792"><a href="#cb395-1792" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1 INTERPRETATION STATE</span></span>
<span id="cb395-1793"><a href="#cb395-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1794"><a href="#cb395-1794" aria-hidden="true" tabindex="-1"></a>**Do Ss in the IMPASSE condition offer less-orthogonal interpretations on first question?**</span>
<span id="cb395-1795"><a href="#cb395-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1796"><a href="#cb395-1796" aria-hidden="true" tabindex="-1"></a>While absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesn't allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subject's response, and determine if these interpretations differ by experimental condition. State is a 3-category derived response variable that groups the following interpretations:</span>
<span id="cb395-1797"><a href="#cb395-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1798"><a href="#cb395-1798" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"orthogonal"** <span class="sc">\[</span>reference category<span class="sc">\]</span> includes orthogonal and satisficing responses ==<span class="sc">\&gt;</span> indicates a primarily *orthogonal* state of coordinate system understanding</span>
<span id="cb395-1799"><a href="#cb395-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1800"><a href="#cb395-1800" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"other"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =<span class="sc">\&gt;</span> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular</span>
<span id="cb395-1801"><a href="#cb395-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1802"><a href="#cb395-1802" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"angular"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb395-1803"><a href="#cb395-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1804"><a href="#cb395-1804" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"triangular"** includes correct triangular and 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb395-1805"><a href="#cb395-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1806"><a href="#cb395-1806" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb395-1807"><a href="#cb395-1807" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does Ss in the impasse condition produce less orthogonal responses on the first question?                                                                                                                                                                                                                                                                 |</span>
<span id="cb395-1808"><a href="#cb395-1808" aria-hidden="true" tabindex="-1"></a>+=======================+===========================================================================================================================================================================================================================================================================================================================================================+</span>
<span id="cb395-1809"><a href="#cb395-1809" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the IMPASSE condition will have a higher likelihood of producing unknown and and triangle-like response states, relative to orthogonal response states, on the first question                                                                                                                                                                |</span>
<span id="cb395-1810"><a href="#cb395-1810" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb395-1811"><a href="#cb395-1811" aria-hidden="true" tabindex="-1"></a>| **Data**              | -   data: <span class="in">`df_items`</span> where <span class="in">`q == 1`</span>                                                                                                                                                                                                                                                                                                                       |</span>
<span id="cb395-1812"><a href="#cb395-1812" aria-hidden="true" tabindex="-1"></a>|                       | -   outcome: <span class="in">`state`</span> ( 4 level factor from 5 level high_interpretation )                                                                                                                                                                                                                                                                                  |</span>
<span id="cb395-1813"><a href="#cb395-1813" aria-hidden="true" tabindex="-1"></a>|                       | -   predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                                                                                                                                                                                                                    |</span>
<span id="cb395-1814"><a href="#cb395-1814" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb395-1815"><a href="#cb395-1815" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Multinomial (Logistic) Regression on state predicted by condition                                                                                                                                                                                                                                                                                     |</span>
<span id="cb395-1816"><a href="#cb395-1816" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                                                                                           |</span>
<span id="cb395-1817"><a href="#cb395-1817" aria-hidden="true" tabindex="-1"></a>|                       | Alternative:                                                                                                                                                                                                                                                                                                                                              |</span>
<span id="cb395-1818"><a href="#cb395-1818" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                                                                                           |</span>
<span id="cb395-1819"><a href="#cb395-1819" aria-hidden="true" tabindex="-1"></a>|                       | -   Ordinal regression on state; but model doesn't satisfy proportional odds assumption (parallel slopes)                                                                                                                                                                                                                                                 |</span>
<span id="cb395-1820"><a href="#cb395-1820" aria-hidden="true" tabindex="-1"></a>|                       | -   Multinomial or Ordinal regression on high_interpretation (5 category interpretation state which distinguishes between uncertain (blank, reference) unclassifiable, triangle-like and true triangular.) There are some cells with zeros, however (no uncertain responses in control) which means the model can't accurately estimate those comparisons |</span>
<span id="cb395-1821"><a href="#cb395-1821" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb395-1822"><a href="#cb395-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1823"><a href="#cb395-1823" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup </span></span>
<span id="cb395-1826"><a href="#cb395-1826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1827"><a href="#cb395-1827" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1-STATE</span></span>
<span id="cb395-1828"><a href="#cb395-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1829"><a href="#cb395-1829" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb395-1830"><a href="#cb395-1830" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, state)</span>
<span id="cb395-1831"><a href="#cb395-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1832"><a href="#cb395-1832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1833"><a href="#cb395-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1834"><a href="#cb395-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1835"><a href="#cb395-1835" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe </span></span>
<span id="cb395-1838"><a href="#cb395-1838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1839"><a href="#cb395-1839" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-Q1STATE</span></span>
<span id="cb395-1840"><a href="#cb395-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1841"><a href="#cb395-1841" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb395-1842"><a href="#cb395-1842" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb395-1843"><a href="#cb395-1843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb395-1844"><a href="#cb395-1844" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb395-1845"><a href="#cb395-1845" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb395-1846"><a href="#cb395-1846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb395-1847"><a href="#cb395-1847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb395-1848"><a href="#cb395-1848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split) <span class="sc">+</span></span>
<span id="cb395-1849"><a href="#cb395-1849" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb395-1850"><a href="#cb395-1850" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb395-1851"><a href="#cb395-1851" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb395-1852"><a href="#cb395-1852" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb395-1853"><a href="#cb395-1853" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb395-1854"><a href="#cb395-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1855"><a href="#cb395-1855" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1856"><a href="#cb395-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1857"><a href="#cb395-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1860"><a href="#cb395-1860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1861"><a href="#cb395-1861" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-Q1STATE</span></span>
<span id="cb395-1862"><a href="#cb395-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1863"><a href="#cb395-1863" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb395-1864"><a href="#cb395-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1865"><a href="#cb395-1865" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb395-1866"><a href="#cb395-1866" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb395-1867"><a href="#cb395-1867" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb395-1868"><a href="#cb395-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1869"><a href="#cb395-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1870"><a href="#cb395-1870" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition, df<span class="sc">$</span>ospan_split) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb395-1871"><a href="#cb395-1871" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb395-1872"><a href="#cb395-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1873"><a href="#cb395-1873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1874"><a href="#cb395-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1875"><a href="#cb395-1875" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MULTINOMIAL REGRESSION</span></span>
<span id="cb395-1876"><a href="#cb395-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1877"><a href="#cb395-1877" aria-hidden="true" tabindex="-1"></a>TODO:: USE MBLOGIT VERSION WITH P VALUES IN MODEL</span>
<span id="cb395-1878"><a href="#cb395-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1879"><a href="#cb395-1879" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of Q1?*</span>
<span id="cb395-1880"><a href="#cb395-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1881"><a href="#cb395-1881" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression predicting interpretation state (k=3) by condition(k = 2).*</span>
<span id="cb395-1882"><a href="#cb395-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1883"><a href="#cb395-1883" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>3 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) <span class="sc">\[</span>essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing <span class="sc">\[</span>reference category<span class="sc">\]</span> vs <span class="sc">\[</span>this category<span class="sc">\]</span>)</span>
<span id="cb395-1884"><a href="#cb395-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1885"><a href="#cb395-1885" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For *each* equation:</span>
<span id="cb395-1886"><a href="#cb395-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1887"><a href="#cb395-1887" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{0}$ *= Log Odds of \[this category type vs. reference category type) response in CONTROL condition*</span>
<span id="cb395-1888"><a href="#cb395-1888" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{0}}$ *= ODDS of \[this category type vs. reference category type\] response in CONTROL condition*</span>
<span id="cb395-1889"><a href="#cb395-1889" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{1}$ *=* $\beta_{1impasse}$ *Log Odds (Log OR; change in odds for \[this category\] type response in impasse (vs) control \[log scale\])*</span>
<span id="cb395-1890"><a href="#cb395-1890" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{1}}$ *= ODDS RATIO of \[this. vs reference category type\] response in IMPASSE (vs) CONTROL*</span>
<span id="cb395-1891"><a href="#cb395-1891" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Two-tailed NHST *Null hypothesis:* $\beta_{impasse} = 0$ *the odds for \[this category of response vs. reference\] are not different for IMPASSE condition*</span>
<span id="cb395-1892"><a href="#cb395-1892" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*Alternative hypothesis:* $\beta_{impasse} \ne 0$ *the odds of \[this category of response vs. reference\] increases or decreases for IMPASSE condition*</span>
<span id="cb395-1893"><a href="#cb395-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1894"><a href="#cb395-1894" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit CONDITION Model</span></span>
<span id="cb395-1895"><a href="#cb395-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1898"><a href="#cb395-1898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1899"><a href="#cb395-1899" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-Q1-INTERPRETATION</span></span>
<span id="cb395-1900"><a href="#cb395-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1901"><a href="#cb395-1901" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb395-1902"><a href="#cb395-1902" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span>
<span id="cb395-1903"><a href="#cb395-1903" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span>
<span id="cb395-1904"><a href="#cb395-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1905"><a href="#cb395-1905" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb395-1906"><a href="#cb395-1906" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb395-1907"><a href="#cb395-1907" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb395-1908"><a href="#cb395-1908" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb395-1909"><a href="#cb395-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1910"><a href="#cb395-1910" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb395-1911"><a href="#cb395-1911" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb395-1912"><a href="#cb395-1912" aria-hidden="true" tabindex="-1"></a>catm.C <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-1913"><a href="#cb395-1913" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.C)</span></span>
<span id="cb395-1914"><a href="#cb395-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1915"><a href="#cb395-1915" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb395-1916"><a href="#cb395-1916" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, catm<span class="fl">.0</span><span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.C<span class="sc">$</span>AIC)</span>
<span id="cb395-1917"><a href="#cb395-1917" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm.C)</span>
<span id="cb395-1918"><a href="#cb395-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1919"><a href="#cb395-1919" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb395-1920"><a href="#cb395-1920" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb395-1921"><a href="#cb395-1921" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state2 ~ pretty_condition, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb395-1922"><a href="#cb395-1922" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb395-1923"><a href="#cb395-1923" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat)</span></span>
<span id="cb395-1924"><a href="#cb395-1924" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb395-1925"><a href="#cb395-1925" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb395-1926"><a href="#cb395-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1927"><a href="#cb395-1927" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb395-1928"><a href="#cb395-1928" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb395-1929"><a href="#cb395-1929" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb395-1930"><a href="#cb395-1930" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state2 ~ pretty_condition , data = df)</span></span>
<span id="cb395-1931"><a href="#cb395-1931" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb395-1932"><a href="#cb395-1932" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span>
<span id="cb395-1933"><a href="#cb395-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1934"><a href="#cb395-1934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1935"><a href="#cb395-1935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1936"><a href="#cb395-1936" aria-hidden="true" tabindex="-1"></a>*AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*</span>
<span id="cb395-1937"><a href="#cb395-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1938"><a href="#cb395-1938" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit OSPAN Model</span></span>
<span id="cb395-1939"><a href="#cb395-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1942"><a href="#cb395-1942" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1943"><a href="#cb395-1943" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN only MODEL</span></span>
<span id="cb395-1944"><a href="#cb395-1944" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN ONLY MODEL")</span></span>
<span id="cb395-1945"><a href="#cb395-1945" aria-hidden="true" tabindex="-1"></a>catm.O <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> ospan_split, <span class="at">data =</span> df)</span>
<span id="cb395-1946"><a href="#cb395-1946" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.O) </span></span>
<span id="cb395-1947"><a href="#cb395-1947" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(catm.O) </span></span>
<span id="cb395-1948"><a href="#cb395-1948" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"OSPAN ONLY better than empty?"</span>)</span>
<span id="cb395-1949"><a href="#cb395-1949" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm.O)</span>
<span id="cb395-1950"><a href="#cb395-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1951"><a href="#cb395-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1952"><a href="#cb395-1952" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN + CONDITION</span></span>
<span id="cb395-1953"><a href="#cb395-1953" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN + CONDITION MODEL")</span></span>
<span id="cb395-1954"><a href="#cb395-1954" aria-hidden="true" tabindex="-1"></a>catm.CO <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-1955"><a href="#cb395-1955" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.CO)</span></span>
<span id="cb395-1956"><a href="#cb395-1956" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(catm.CO) <span class="co">#MainEff condition, marginal ospan</span></span>
<span id="cb395-1957"><a href="#cb395-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1958"><a href="#cb395-1958" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb395-1959"><a href="#cb395-1959" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Adding OSPAN to CONDITION lowers AIC?"</span>, catm.C<span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.CO<span class="sc">$</span>AIC)</span>
<span id="cb395-1960"><a href="#cb395-1960" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm.C, catm.CO)</span>
<span id="cb395-1961"><a href="#cb395-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1962"><a href="#cb395-1962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1963"><a href="#cb395-1963" aria-hidden="true" tabindex="-1"></a>_Adding (main effect) predictor of OSPAN decreases AIC and is a marginally better fit. In this model, there is still only a main effect of condition. OSPAN is not a significant main effect._</span>
<span id="cb395-1964"><a href="#cb395-1964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1967"><a href="#cb395-1967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1968"><a href="#cb395-1968" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN * CONDITION</span></span>
<span id="cb395-1969"><a href="#cb395-1969" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN * CONDITION MODEL")</span></span>
<span id="cb395-1970"><a href="#cb395-1970" aria-hidden="true" tabindex="-1"></a>catm.C.O <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition <span class="sc">*</span> ospan_split, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-1971"><a href="#cb395-1971" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(catm.C.O, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb395-1972"><a href="#cb395-1972" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.C.O)</span></span>
<span id="cb395-1973"><a href="#cb395-1973" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(catm.C.O) #MainEff condition, marginal ospan</span></span>
<span id="cb395-1974"><a href="#cb395-1974" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb395-1975"><a href="#cb395-1975" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Adding INTERACTION lowers AIC?"</span>, catm.CO<span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.C.O<span class="sc">$</span>AIC)</span>
<span id="cb395-1976"><a href="#cb395-1976" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm.CO, catm.C.O)</span>
<span id="cb395-1977"><a href="#cb395-1977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1978"><a href="#cb395-1978" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-1979"><a href="#cb395-1979" aria-hidden="true" tabindex="-1"></a>_Adding interaction of OSPAN does not improve fit and does not lower AIC. In the IXN model, only the main effect of condition is significant._</span>
<span id="cb395-1980"><a href="#cb395-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1983"><a href="#cb395-1983" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-1984"><a href="#cb395-1984" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb395-1985"><a href="#cb395-1985" aria-hidden="true" tabindex="-1"></a><span class="co"># library(brms)</span></span>
<span id="cb395-1986"><a href="#cb395-1986" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state ~ pretty_condition*ospan_split, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb395-1987"><a href="#cb395-1987" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb395-1988"><a href="#cb395-1988" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat) </span></span>
<span id="cb395-1989"><a href="#cb395-1989" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(equivalence_test(b.cat))</span></span>
<span id="cb395-1990"><a href="#cb395-1990" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(b.cat))</span></span>
<span id="cb395-1991"><a href="#cb395-1991" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb395-1992"><a href="#cb395-1992" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb395-1993"><a href="#cb395-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-1994"><a href="#cb395-1994" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb395-1995"><a href="#cb395-1995" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb395-1996"><a href="#cb395-1996" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb395-1997"><a href="#cb395-1997" aria-hidden="true" tabindex="-1"></a>blm1 <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> pretty_condition <span class="sc">*</span>ospan_split , <span class="at">data =</span> df)</span>
<span id="cb395-1998"><a href="#cb395-1998" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(blm1)</span>
<span id="cb395-1999"><a href="#cb395-1999" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(blm1) #todo need to separate by individual equation</span></span>
<span id="cb395-2000"><a href="#cb395-2000" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span>
<span id="cb395-2001"><a href="#cb395-2001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2002"><a href="#cb395-2002" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2003"><a href="#cb395-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2004"><a href="#cb395-2004" aria-hidden="true" tabindex="-1"></a>*AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*</span>
<span id="cb395-2005"><a href="#cb395-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2006"><a href="#cb395-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2007"><a href="#cb395-2007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2008"><a href="#cb395-2008" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb395-2009"><a href="#cb395-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2012"><a href="#cb395-2012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2013"><a href="#cb395-2013" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-Q1-INTERPRETATION</span></span>
<span id="cb395-2014"><a href="#cb395-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2015"><a href="#cb395-2015" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb395-2016"><a href="#cb395-2016" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> catm.C.O</span>
<span id="cb395-2017"><a href="#cb395-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2018"><a href="#cb395-2018" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb395-2019"><a href="#cb395-2019" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span>
<span id="cb395-2020"><a href="#cb395-2020" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb395-2021"><a href="#cb395-2021" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type =</span><span class="dv">3</span>) <span class="co">#always type 3 for ixns </span></span>
<span id="cb395-2022"><a href="#cb395-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2023"><a href="#cb395-2023" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb395-2024"><a href="#cb395-2024" aria-hidden="true" tabindex="-1"></a>z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(m)<span class="sc">$</span>standard.errors</span>
<span id="cb395-2025"><a href="#cb395-2025" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb395-2026"><a href="#cb395-2026" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb395-2027"><a href="#cb395-2027" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb395-2028"><a href="#cb395-2028" aria-hidden="true" tabindex="-1"></a>(p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values)))</span>
<span id="cb395-2029"><a href="#cb395-2029" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb395-2030"><a href="#cb395-2030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2031"><a href="#cb395-2031" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb395-2032"><a href="#cb395-2032" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>coefficients))</span>
<span id="cb395-2033"><a href="#cb395-2033" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb395-2034"><a href="#cb395-2034" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span>
<span id="cb395-2035"><a href="#cb395-2035" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2036"><a href="#cb395-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2037"><a href="#cb395-2037" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference </span></span>
<span id="cb395-2038"><a href="#cb395-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2039"><a href="#cb395-2039" aria-hidden="true" tabindex="-1"></a>looking at detailed p values </span>
<span id="cb395-2040"><a href="#cb395-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2041"><a href="#cb395-2041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2042"><a href="#cb395-2042" aria-hidden="true" tabindex="-1"></a>... </span>
<span id="cb395-2043"><a href="#cb395-2043" aria-hidden="true" tabindex="-1"></a>OTHER: only main effect of condition </span>
<span id="cb395-2044"><a href="#cb395-2044" aria-hidden="true" tabindex="-1"></a>TRI-LIKE: no effects</span>
<span id="cb395-2045"><a href="#cb395-2045" aria-hidden="true" tabindex="-1"></a>TRI: IXN condition * impasse</span>
<span id="cb395-2046"><a href="#cb395-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2047"><a href="#cb395-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2048"><a href="#cb395-2048" aria-hidden="true" tabindex="-1"></a>TODO</span>
<span id="cb395-2049"><a href="#cb395-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2050"><a href="#cb395-2050" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 45 (z = 3.81, p \&lt; 0.001) . **Participants in the impasse condition were 45x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb395-2051"><a href="#cb395-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2052"><a href="#cb395-2052" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving 'triangle-like' response rather than an orthogonal (or satisficing) response by a factor of 17.5 (z = 2.60, p \&lt; 0.001 ). **Participants in the impasse condition were almost 6x as likely to give an a triangular response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb395-2053"><a href="#cb395-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2054"><a href="#cb395-2054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2055"><a href="#cb395-2055" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving 'triangle-like' response rather than an orthogonal (or satisficing) response by a factor of 4.8 (z = 3.30, p \&lt; 0.001 ). **Participants in the impasse condition were almost 6x as likely to give an a triangular response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb395-2056"><a href="#cb395-2056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2057"><a href="#cb395-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2058"><a href="#cb395-2058" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As with the (binary) logistic regression on accuracy \~ condition, significant model intercepts indicate that the odds of being in any particular response state (vs) orthogonal are significantly different than 1 *in the control condition.* (i.e. not 1:1 odds or 50% chance of being in that response state. Orthogonal is a much more probable response state in control)</span>
<span id="cb395-2059"><a href="#cb395-2059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2060"><a href="#cb395-2060" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="sc">\[</span>need to to double check interpretation, but I *think* that the OR intercepts converted to probabilities equate to the marginal probability of being in each state in the control condition. which makes sense. I think.?<span class="sc">\]</span></span>
<span id="cb395-2061"><a href="#cb395-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2062"><a href="#cb395-2062" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>IF I change reference category for condition... then the intercepts should no longer be significant. The b1 coefficients should still be significant, but with changed sign (much less likely) <span class="sc">\[</span>Yup! this works!<span class="sc">\]</span></span>
<span id="cb395-2063"><a href="#cb395-2063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2064"><a href="#cb395-2064" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb395-2065"><a href="#cb395-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2068"><a href="#cb395-2068" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2069"><a href="#cb395-2069" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-Q1INTERPRETATION-LAB</span></span>
<span id="cb395-2070"><a href="#cb395-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2071"><a href="#cb395-2071" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb395-2072"><a href="#cb395-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2073"><a href="#cb395-2073" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb395-2074"><a href="#cb395-2074" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb395-2075"><a href="#cb395-2075" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb395-2076"><a href="#cb395-2076" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb395-2077"><a href="#cb395-2077" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb395-2078"><a href="#cb395-2078" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-2079"><a href="#cb395-2079" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb395-2080"><a href="#cb395-2080" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb395-2081"><a href="#cb395-2081" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() + #remove to put on log scale x axis </span></span>
<span id="cb395-2082"><a href="#cb395-2082" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c("control","impasse"))+</span></span>
<span id="cb395-2083"><a href="#cb395-2083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb395-2084"><a href="#cb395-2084" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb395-2085"><a href="#cb395-2085" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb395-2086"><a href="#cb395-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2087"><a href="#cb395-2087" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb395-2088"><a href="#cb395-2088" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb395-2089"><a href="#cb395-2089" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"int"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) </span>
<span id="cb395-2090"><a href="#cb395-2090" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) </span>
<span id="cb395-2091"><a href="#cb395-2091" aria-hidden="true" tabindex="-1"></a><span class="co"># +  ylim(0,1) +</span></span>
<span id="cb395-2092"><a href="#cb395-2092" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "MODEL PREDICTION  | Q1 State ~ condition",</span></span>
<span id="cb395-2093"><a href="#cb395-2093" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "Impasse increases probability of more accurate response states Q1",</span></span>
<span id="cb395-2094"><a href="#cb395-2094" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition") + theme_clean()</span></span>
<span id="cb395-2095"><a href="#cb395-2095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2096"><a href="#cb395-2096" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO ESTIMAED MARGINALS AND IXN PLOTS </span></span>
<span id="cb395-2097"><a href="#cb395-2097" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html</span></span>
<span id="cb395-2098"><a href="#cb395-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2099"><a href="#cb395-2099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2100"><a href="#cb395-2100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2101"><a href="#cb395-2101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2104"><a href="#cb395-2104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2105"><a href="#cb395-2105" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb395-2106"><a href="#cb395-2106" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb395-2107"><a href="#cb395-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2108"><a href="#cb395-2108" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb395-2109"><a href="#cb395-2109" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb395-2110"><a href="#cb395-2110" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb395-2111"><a href="#cb395-2111" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb395-2112"><a href="#cb395-2112" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb395-2113"><a href="#cb395-2113" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-2114"><a href="#cb395-2114" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb395-2115"><a href="#cb395-2115" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb395-2116"><a href="#cb395-2116" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb395-2117"><a href="#cb395-2117" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb395-2118"><a href="#cb395-2118" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb395-2119"><a href="#cb395-2119" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb395-2120"><a href="#cb395-2120" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb395-2121"><a href="#cb395-2121" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb395-2122"><a href="#cb395-2122" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb395-2123"><a href="#cb395-2123" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb395-2124"><a href="#cb395-2124" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb395-2125"><a href="#cb395-2125" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb395-2126"><a href="#cb395-2126" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb395-2127"><a href="#cb395-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2128"><a href="#cb395-2128" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(mixcat.1, s)</span></span>
<span id="cb395-2129"><a href="#cb395-2129" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb395-2130"><a href="#cb395-2130" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb395-2131"><a href="#cb395-2131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2132"><a href="#cb395-2132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2133"><a href="#cb395-2133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2134"><a href="#cb395-2134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2135"><a href="#cb395-2135" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb395-2136"><a href="#cb395-2136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2139"><a href="#cb395-2139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2140"><a href="#cb395-2140" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb395-2141"><a href="#cb395-2141" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb395-2142"><a href="#cb395-2142" aria-hidden="true" tabindex="-1"></a><span class="co"># test &lt;- data.frame(pretty_condition = c("control", "impasse"))</span></span>
<span id="cb395-2143"><a href="#cb395-2143" aria-hidden="true" tabindex="-1"></a><span class="co"># pred &lt;- predict(m, newdata = test, "probs")</span></span>
<span id="cb395-2144"><a href="#cb395-2144" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Predicted Probability of Being in Each State")</span></span>
<span id="cb395-2145"><a href="#cb395-2145" aria-hidden="true" tabindex="-1"></a><span class="co"># ( x &lt;- cbind(test, pred))</span></span>
<span id="cb395-2146"><a href="#cb395-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2147"><a href="#cb395-2147" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb395-2148"><a href="#cb395-2148" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m)</span>
<span id="cb395-2149"><a href="#cb395-2149" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(m, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span>
<span id="cb395-2150"><a href="#cb395-2150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2151"><a href="#cb395-2151" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb395-2152"><a href="#cb395-2152" aria-hidden="true" tabindex="-1"></a><span class="co">#library(generalhoslem)</span></span>
<span id="cb395-2153"><a href="#cb395-2153" aria-hidden="true" tabindex="-1"></a><span class="co">#logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb395-2154"><a href="#cb395-2154" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb395-2155"><a href="#cb395-2155" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb395-2156"><a href="#cb395-2156" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(df<span class="sc">$</span>state,<span class="fu">predict</span>(m)) <span class="co">#actual states VS predicted states</span></span>
<span id="cb395-2157"><a href="#cb395-2157" aria-hidden="true" tabindex="-1"></a><span class="co"># The chi-square test tests the decrease in unexplained variance from the baseline model to the final model</span></span>
<span id="cb395-2158"><a href="#cb395-2158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2159"><a href="#cb395-2159" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL DIAGNOSTICS")</span></span>
<span id="cb395-2160"><a href="#cb395-2160" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m) can't do overall diagnostics, have to do them on individual model equations</span></span>
<span id="cb395-2161"><a href="#cb395-2161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2162"><a href="#cb395-2162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2163"><a href="#cb395-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2164"><a href="#cb395-2164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2165"><a href="#cb395-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2166"><a href="#cb395-2166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2167"><a href="#cb395-2167" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q8 INTERPRETATION STATE</span></span>
<span id="cb395-2168"><a href="#cb395-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2169"><a href="#cb395-2169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2170"><a href="#cb395-2170" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup </span></span>
<span id="cb395-2173"><a href="#cb395-2173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2174"><a href="#cb395-2174" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb395-2175"><a href="#cb395-2175" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, ospan_split, state)</span>
<span id="cb395-2176"><a href="#cb395-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2177"><a href="#cb395-2177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2178"><a href="#cb395-2178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2179"><a href="#cb395-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2180"><a href="#cb395-2180" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe </span></span>
<span id="cb395-2183"><a href="#cb395-2183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2184"><a href="#cb395-2184" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb395-2185"><a href="#cb395-2185" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb395-2186"><a href="#cb395-2186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb395-2187"><a href="#cb395-2187" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb395-2188"><a href="#cb395-2188" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb395-2189"><a href="#cb395-2189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb395-2190"><a href="#cb395-2190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb395-2191"><a href="#cb395-2191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ospan_split) <span class="sc">+</span></span>
<span id="cb395-2192"><a href="#cb395-2192" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb395-2193"><a href="#cb395-2193" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q8 Interpretation"</span>,</span>
<span id="cb395-2194"><a href="#cb395-2194" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb395-2195"><a href="#cb395-2195" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb395-2196"><a href="#cb395-2196" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb395-2197"><a href="#cb395-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2198"><a href="#cb395-2198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2199"><a href="#cb395-2199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2200"><a href="#cb395-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2203"><a href="#cb395-2203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2204"><a href="#cb395-2204" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb395-2205"><a href="#cb395-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2206"><a href="#cb395-2206" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb395-2207"><a href="#cb395-2207" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb395-2208"><a href="#cb395-2208" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb395-2209"><a href="#cb395-2209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2210"><a href="#cb395-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2211"><a href="#cb395-2211" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition, df<span class="sc">$</span>ospan_split) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb395-2212"><a href="#cb395-2212" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb395-2213"><a href="#cb395-2213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2214"><a href="#cb395-2214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2215"><a href="#cb395-2215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2216"><a href="#cb395-2216" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MULTINOMIAL REGRESSION</span></span>
<span id="cb395-2217"><a href="#cb395-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2218"><a href="#cb395-2218" aria-hidden="true" tabindex="-1"></a>TODO:: USE MBLOGIT VERSION WITH P VALUES IN MODEL</span>
<span id="cb395-2219"><a href="#cb395-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2220"><a href="#cb395-2220" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of Q?*</span>
<span id="cb395-2221"><a href="#cb395-2221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2222"><a href="#cb395-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2223"><a href="#cb395-2223" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit CONDITION Model</span></span>
<span id="cb395-2224"><a href="#cb395-2224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2227"><a href="#cb395-2227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2228"><a href="#cb395-2228" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb395-2229"><a href="#cb395-2229" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span>
<span id="cb395-2230"><a href="#cb395-2230" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span>
<span id="cb395-2231"><a href="#cb395-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2232"><a href="#cb395-2232" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb395-2233"><a href="#cb395-2233" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb395-2234"><a href="#cb395-2234" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb395-2235"><a href="#cb395-2235" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb395-2236"><a href="#cb395-2236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2237"><a href="#cb395-2237" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb395-2238"><a href="#cb395-2238" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb395-2239"><a href="#cb395-2239" aria-hidden="true" tabindex="-1"></a>catm.C <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-2240"><a href="#cb395-2240" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.C)</span></span>
<span id="cb395-2241"><a href="#cb395-2241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2242"><a href="#cb395-2242" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb395-2243"><a href="#cb395-2243" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, catm<span class="fl">.0</span><span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.C<span class="sc">$</span>AIC)</span>
<span id="cb395-2244"><a href="#cb395-2244" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm.C)</span>
<span id="cb395-2245"><a href="#cb395-2245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2246"><a href="#cb395-2246" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb395-2247"><a href="#cb395-2247" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb395-2248"><a href="#cb395-2248" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state2 ~ pretty_condition, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb395-2249"><a href="#cb395-2249" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb395-2250"><a href="#cb395-2250" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat)</span></span>
<span id="cb395-2251"><a href="#cb395-2251" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb395-2252"><a href="#cb395-2252" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb395-2253"><a href="#cb395-2253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2254"><a href="#cb395-2254" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb395-2255"><a href="#cb395-2255" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb395-2256"><a href="#cb395-2256" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb395-2257"><a href="#cb395-2257" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state2 ~ pretty_condition , data = df)</span></span>
<span id="cb395-2258"><a href="#cb395-2258" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb395-2259"><a href="#cb395-2259" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span>
<span id="cb395-2260"><a href="#cb395-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2261"><a href="#cb395-2261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2262"><a href="#cb395-2262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2263"><a href="#cb395-2263" aria-hidden="true" tabindex="-1"></a>*AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*</span>
<span id="cb395-2264"><a href="#cb395-2264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2265"><a href="#cb395-2265" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit OSPAN Model</span></span>
<span id="cb395-2266"><a href="#cb395-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2269"><a href="#cb395-2269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2270"><a href="#cb395-2270" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN only MODEL</span></span>
<span id="cb395-2271"><a href="#cb395-2271" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN ONLY MODEL")</span></span>
<span id="cb395-2272"><a href="#cb395-2272" aria-hidden="true" tabindex="-1"></a>catm.O <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> ospan_split, <span class="at">data =</span> df)</span>
<span id="cb395-2273"><a href="#cb395-2273" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.O) </span></span>
<span id="cb395-2274"><a href="#cb395-2274" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(catm.O) </span></span>
<span id="cb395-2275"><a href="#cb395-2275" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"OSPAN ONLY better than empty?"</span>)</span>
<span id="cb395-2276"><a href="#cb395-2276" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm.O)</span>
<span id="cb395-2277"><a href="#cb395-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2278"><a href="#cb395-2278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2279"><a href="#cb395-2279" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN + CONDITION</span></span>
<span id="cb395-2280"><a href="#cb395-2280" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN + CONDITION MODEL")</span></span>
<span id="cb395-2281"><a href="#cb395-2281" aria-hidden="true" tabindex="-1"></a>catm.CO <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition <span class="sc">+</span> ospan_split, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-2282"><a href="#cb395-2282" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.CO)</span></span>
<span id="cb395-2283"><a href="#cb395-2283" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(catm.CO) <span class="co">#MainEff condition, marginal ospan</span></span>
<span id="cb395-2284"><a href="#cb395-2284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2285"><a href="#cb395-2285" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb395-2286"><a href="#cb395-2286" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Adding OSPAN to CONDITION lowers AIC?"</span>, catm.C<span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.CO<span class="sc">$</span>AIC)</span>
<span id="cb395-2287"><a href="#cb395-2287" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm.C, catm.CO)</span>
<span id="cb395-2288"><a href="#cb395-2288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2289"><a href="#cb395-2289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2290"><a href="#cb395-2290" aria-hidden="true" tabindex="-1"></a>_Adding (main effect) predictor of OSPAN decreases AIC and is a marginally better fit. In this model, there are main effects of condition and OSPAN._</span>
<span id="cb395-2291"><a href="#cb395-2291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2294"><a href="#cb395-2294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2295"><a href="#cb395-2295" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT OSPAN * CONDITION</span></span>
<span id="cb395-2296"><a href="#cb395-2296" aria-hidden="true" tabindex="-1"></a><span class="co"># print("OSPAN * CONDITION MODEL")</span></span>
<span id="cb395-2297"><a href="#cb395-2297" aria-hidden="true" tabindex="-1"></a>catm.C.O <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition <span class="sc">*</span> ospan_split, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-2298"><a href="#cb395-2298" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(catm.C.O, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb395-2299"><a href="#cb395-2299" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.C.O)</span></span>
<span id="cb395-2300"><a href="#cb395-2300" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(catm.C.O) #MainEff condition, marginal ospan</span></span>
<span id="cb395-2301"><a href="#cb395-2301" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb395-2302"><a href="#cb395-2302" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Adding INTERACTION lowers AIC?"</span>, catm.CO<span class="sc">$</span>AIC <span class="sc">&gt;</span> catm.C.O<span class="sc">$</span>AIC)</span>
<span id="cb395-2303"><a href="#cb395-2303" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm.CO, catm.C.O)</span>
<span id="cb395-2304"><a href="#cb395-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2305"><a href="#cb395-2305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2306"><a href="#cb395-2306" aria-hidden="true" tabindex="-1"></a>_Adding interaction of OSPAN does not improve fit and does not lower AIC. In the IXN model, no effects are significant._ So we conclude that the main effects only model is the final model. </span>
<span id="cb395-2307"><a href="#cb395-2307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2310"><a href="#cb395-2310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2311"><a href="#cb395-2311" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb395-2312"><a href="#cb395-2312" aria-hidden="true" tabindex="-1"></a><span class="co"># library(brms)</span></span>
<span id="cb395-2313"><a href="#cb395-2313" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state ~ pretty_condition*ospan_split, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb395-2314"><a href="#cb395-2314" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb395-2315"><a href="#cb395-2315" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat) </span></span>
<span id="cb395-2316"><a href="#cb395-2316" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(equivalence_test(b.cat))</span></span>
<span id="cb395-2317"><a href="#cb395-2317" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rope(b.cat))</span></span>
<span id="cb395-2318"><a href="#cb395-2318" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb395-2319"><a href="#cb395-2319" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb395-2320"><a href="#cb395-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2321"><a href="#cb395-2321" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb395-2322"><a href="#cb395-2322" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb395-2323"><a href="#cb395-2323" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb395-2324"><a href="#cb395-2324" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state ~ pretty_condition *ospan_split , data = df)</span></span>
<span id="cb395-2325"><a href="#cb395-2325" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb395-2326"><a href="#cb395-2326" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(blm1) #todo need to separate by individual equation</span></span>
<span id="cb395-2327"><a href="#cb395-2327" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span>
<span id="cb395-2328"><a href="#cb395-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2329"><a href="#cb395-2329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2330"><a href="#cb395-2330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2331"><a href="#cb395-2331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2332"><a href="#cb395-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2333"><a href="#cb395-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2334"><a href="#cb395-2334" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb395-2335"><a href="#cb395-2335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2338"><a href="#cb395-2338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2339"><a href="#cb395-2339" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb395-2340"><a href="#cb395-2340" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> catm.CO</span>
<span id="cb395-2341"><a href="#cb395-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2342"><a href="#cb395-2342" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb395-2343"><a href="#cb395-2343" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span>
<span id="cb395-2344"><a href="#cb395-2344" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb395-2345"><a href="#cb395-2345" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m, <span class="at">type =</span><span class="dv">2</span>) <span class="co">#always type 3 for ixns </span></span>
<span id="cb395-2346"><a href="#cb395-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2347"><a href="#cb395-2347" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb395-2348"><a href="#cb395-2348" aria-hidden="true" tabindex="-1"></a>z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(m)<span class="sc">$</span>standard.errors</span>
<span id="cb395-2349"><a href="#cb395-2349" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb395-2350"><a href="#cb395-2350" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb395-2351"><a href="#cb395-2351" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb395-2352"><a href="#cb395-2352" aria-hidden="true" tabindex="-1"></a>(p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values)))</span>
<span id="cb395-2353"><a href="#cb395-2353" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb395-2354"><a href="#cb395-2354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2355"><a href="#cb395-2355" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb395-2356"><a href="#cb395-2356" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>coefficients))</span>
<span id="cb395-2357"><a href="#cb395-2357" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb395-2358"><a href="#cb395-2358" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span>
<span id="cb395-2359"><a href="#cb395-2359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2360"><a href="#cb395-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2361"><a href="#cb395-2361" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference </span></span>
<span id="cb395-2362"><a href="#cb395-2362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2363"><a href="#cb395-2363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2364"><a href="#cb395-2364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2365"><a href="#cb395-2365" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb395-2366"><a href="#cb395-2366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2369"><a href="#cb395-2369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2370"><a href="#cb395-2370" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb395-2371"><a href="#cb395-2371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2372"><a href="#cb395-2372" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb395-2373"><a href="#cb395-2373" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb395-2374"><a href="#cb395-2374" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb395-2375"><a href="#cb395-2375" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb395-2376"><a href="#cb395-2376" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb395-2377"><a href="#cb395-2377" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb395-2378"><a href="#cb395-2378" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb395-2379"><a href="#cb395-2379" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb395-2380"><a href="#cb395-2380" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() + #remove to put on log scale x axis </span></span>
<span id="cb395-2381"><a href="#cb395-2381" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c("control","impasse"))+</span></span>
<span id="cb395-2382"><a href="#cb395-2382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb395-2383"><a href="#cb395-2383" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb395-2384"><a href="#cb395-2384" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb395-2385"><a href="#cb395-2385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2386"><a href="#cb395-2386" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb395-2387"><a href="#cb395-2387" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb395-2388"><a href="#cb395-2388" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "int", ci.lvl = 0.95) </span></span>
<span id="cb395-2389"><a href="#cb395-2389" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) </span>
<span id="cb395-2390"><a href="#cb395-2390" aria-hidden="true" tabindex="-1"></a><span class="co"># +  ylim(0,1) +</span></span>
<span id="cb395-2391"><a href="#cb395-2391" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "MODEL PREDICTION  | Q1 State ~ condition",</span></span>
<span id="cb395-2392"><a href="#cb395-2392" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "Impasse increases probability of more accurate response states Q1",</span></span>
<span id="cb395-2393"><a href="#cb395-2393" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition") + theme_clean()</span></span>
<span id="cb395-2394"><a href="#cb395-2394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2395"><a href="#cb395-2395" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO ESTIMAED MARGINALS AND IXN PLOTS </span></span>
<span id="cb395-2396"><a href="#cb395-2396" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html</span></span>
<span id="cb395-2397"><a href="#cb395-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2398"><a href="#cb395-2398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2399"><a href="#cb395-2399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2400"><a href="#cb395-2400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2403"><a href="#cb395-2403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2404"><a href="#cb395-2404" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb395-2405"><a href="#cb395-2405" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(m)</span></span>
<span id="cb395-2406"><a href="#cb395-2406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2407"><a href="#cb395-2407" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb395-2408"><a href="#cb395-2408" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb395-2409"><a href="#cb395-2409" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb395-2410"><a href="#cb395-2410" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb395-2411"><a href="#cb395-2411" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb395-2412"><a href="#cb395-2412" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb395-2413"><a href="#cb395-2413" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb395-2414"><a href="#cb395-2414" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb395-2415"><a href="#cb395-2415" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb395-2416"><a href="#cb395-2416" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb395-2417"><a href="#cb395-2417" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb395-2418"><a href="#cb395-2418" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb395-2419"><a href="#cb395-2419" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb395-2420"><a href="#cb395-2420" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb395-2421"><a href="#cb395-2421" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb395-2422"><a href="#cb395-2422" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb395-2423"><a href="#cb395-2423" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb395-2424"><a href="#cb395-2424" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb395-2425"><a href="#cb395-2425" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb395-2426"><a href="#cb395-2426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2427"><a href="#cb395-2427" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(mixcat.1, s)</span></span>
<span id="cb395-2428"><a href="#cb395-2428" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb395-2429"><a href="#cb395-2429" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb395-2430"><a href="#cb395-2430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2431"><a href="#cb395-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2432"><a href="#cb395-2432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2433"><a href="#cb395-2433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2434"><a href="#cb395-2434" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb395-2435"><a href="#cb395-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2438"><a href="#cb395-2438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2439"><a href="#cb395-2439" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb395-2440"><a href="#cb395-2440" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb395-2441"><a href="#cb395-2441" aria-hidden="true" tabindex="-1"></a><span class="co"># test &lt;- data.frame(pretty_condition = c("control", "impasse"))</span></span>
<span id="cb395-2442"><a href="#cb395-2442" aria-hidden="true" tabindex="-1"></a><span class="co"># pred &lt;- predict(m, newdata = test, "probs")</span></span>
<span id="cb395-2443"><a href="#cb395-2443" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Predicted Probability of Being in Each State")</span></span>
<span id="cb395-2444"><a href="#cb395-2444" aria-hidden="true" tabindex="-1"></a><span class="co"># ( x &lt;- cbind(test, pred))</span></span>
<span id="cb395-2445"><a href="#cb395-2445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2446"><a href="#cb395-2446" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PERFORMANCE")</span></span>
<span id="cb395-2447"><a href="#cb395-2447" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb395-2448"><a href="#cb395-2448" aria-hidden="true" tabindex="-1"></a><span class="co"># DescTools::PseudoR2(m, which = c("McFadden", "CoxSnell", "Nagelkerke"))</span></span>
<span id="cb395-2449"><a href="#cb395-2449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2450"><a href="#cb395-2450" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb395-2451"><a href="#cb395-2451" aria-hidden="true" tabindex="-1"></a><span class="co">#library(generalhoslem)</span></span>
<span id="cb395-2452"><a href="#cb395-2452" aria-hidden="true" tabindex="-1"></a><span class="co">#logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb395-2453"><a href="#cb395-2453" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb395-2454"><a href="#cb395-2454" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb395-2455"><a href="#cb395-2455" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(df<span class="sc">$</span>state,<span class="fu">predict</span>(m)) <span class="co">#actual states VS predicted states</span></span>
<span id="cb395-2456"><a href="#cb395-2456" aria-hidden="true" tabindex="-1"></a><span class="co"># The chi-square test tests the decrease in unexplained variance from the baseline model to the final model</span></span>
<span id="cb395-2457"><a href="#cb395-2457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2458"><a href="#cb395-2458" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL DIAGNOSTICS")</span></span>
<span id="cb395-2459"><a href="#cb395-2459" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m) can't do overall diagnostics, have to do them on individual model equations</span></span>
<span id="cb395-2460"><a href="#cb395-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2461"><a href="#cb395-2461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb395-2462"><a href="#cb395-2462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2463"><a href="#cb395-2463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2464"><a href="#cb395-2464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2465"><a href="#cb395-2465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2466"><a href="#cb395-2466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2467"><a href="#cb395-2467" aria-hidden="true" tabindex="-1"></a><span class="fu">## EXPLORE specific question </span></span>
<span id="cb395-2468"><a href="#cb395-2468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2471"><a href="#cb395-2471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb395-2472"><a href="#cb395-2472" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">10</span>)</span>
<span id="cb395-2473"><a href="#cb395-2473" aria-hidden="true" tabindex="-1"></a><span class="fu">grouped_ggbarstats</span>( <span class="at">data =</span> df, <span class="at">x =</span> accuracy, <span class="at">y =</span> pretty_condition, <span class="at">grouping.var =</span> ospan_split)</span>
<span id="cb395-2474"><a href="#cb395-2474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2475"><a href="#cb395-2475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>