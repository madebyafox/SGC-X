<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.640">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>SGC-X - Modelling Reference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../analysis/SGC2/1_sgc2_introduction.html" rel="next">
<link href="../../analysis/utils/scoring.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Modelling Reference</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/x_learning.html" class="sidebar-item-text sidebar-link active">Modelling Reference</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC2</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/3_sgc2_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/4_sgc2_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/5_sgc3A_exploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploratory Analyses</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">SGC5A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/1_sgc5A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/2_sgc5A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">COMBINED</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/combined/combined.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#single-item-level" id="toc-single-item-level" class="nav-link active" data-scroll-target="#single-item-level">SINGLE ITEM LEVEL</a>
  <ul class="collapse">
<li>
<a href="#chi-square" id="toc-chi-square" class="nav-link" data-scroll-target="#chi-square">CHI SQUARE</a>
  <ul class="collapse">
<li><a href="#combined" id="toc-combined" class="nav-link" data-scroll-target="#combined">(Combined)</a></li>
  <li><a href="#in-person" id="toc-in-person" class="nav-link" data-scroll-target="#in-person">(In Person)</a></li>
  <li><a href="#online-replication" id="toc-online-replication" class="nav-link" data-scroll-target="#online-replication">(Online Replication)</a></li>
  </ul>
</li>
  <li>
<a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">LOGISTIC REGRESSION</a>
  <ul class="collapse">
<li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#learning-notes" id="toc-learning-notes" class="nav-link" data-scroll-target="#learning-notes">Learning Notes</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  </ul>
</li>
  <li><a href="#todo-ordinal-regression" id="toc-todo-ordinal-regression" class="nav-link" data-scroll-target="#todo-ordinal-regression">TODO ORDINAL REGRESSION</a></li>
  </ul>
</li>
  <li>
<a href="#repeated-item-level" id="toc-repeated-item-level" class="nav-link" data-scroll-target="#repeated-item-level">REPEATED ITEM LEVEL</a>
  <ul class="collapse">
<li>
<a href="#mixed-logistic-regression" id="toc-mixed-logistic-regression" class="nav-link" data-scroll-target="#mixed-logistic-regression">Mixed Logistic Regression</a>
  <ul class="collapse">
<li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1">Fit Model</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  <li><a href="#inference-1" id="toc-inference-1" class="nav-link" data-scroll-target="#inference-1">Inference</a></li>
  </ul>
</li>
  <li><a href="#todo-mixed-ordinal-regression" id="toc-todo-mixed-ordinal-regression" class="nav-link" data-scroll-target="#todo-mixed-ordinal-regression">TODO Mixed Ordinal Regression</a></li>
  </ul>
</li>
  <li>
<a href="#subject-level" id="toc-subject-level" class="nav-link" data-scroll-target="#subject-level">SUBJECT-LEVEL</a>
  <ul class="collapse">
<li><a href="#independent-samples-t-test" id="toc-independent-samples-t-test" class="nav-link" data-scroll-target="#independent-samples-t-test">Independent Samples T-Test</a></li>
  <li><a href="#censored-linear-regression" id="toc-censored-linear-regression" class="nav-link" data-scroll-target="#censored-linear-regression">Censored Linear Regression</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#censored-tobit-regression" id="toc-censored-tobit-regression" class="nav-link" data-scroll-target="#censored-tobit-regression">Censored (Tobit) Regression</a></li>
  <li><a href="#poisson-regression" id="toc-poisson-regression" class="nav-link" data-scroll-target="#poisson-regression">Poisson Regression</a></li>
  <li><a href="#zero-inflated-poisson" id="toc-zero-inflated-poisson" class="nav-link" data-scroll-target="#zero-inflated-poisson">Zero Inflated Poisson</a></li>
  <li><a href="#negative-binomial-regression" id="toc-negative-binomial-regression" class="nav-link" data-scroll-target="#negative-binomial-regression">Negative Binomial Regression</a></li>
  <li><a href="#zero-inflated-negative-binomial-regression" id="toc-zero-inflated-negative-binomial-regression" class="nav-link" data-scroll-target="#zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model Comparison</a></li>
  <li><a href="#hurlde-beta-regression" id="toc-hurlde-beta-regression" class="nav-link" data-scroll-target="#hurlde-beta-regression">HURLDE BETA Regression</a></li>
  <li><a href="#beta-regression-correct" id="toc-beta-regression-correct" class="nav-link" data-scroll-target="#beta-regression-correct">Beta Regression (% Correct)</a></li>
  <li><a href="#wip-hurdle-model" id="toc-wip-hurdle-model" class="nav-link" data-scroll-target="#wip-hurdle-model">WIP | HURDLE MODEL</a></li>
  </ul>
</li>
  <li>
<a href="#wip-unknown" id="toc-wip-unknown" class="nav-link" data-scroll-target="#wip-unknown">WIP UNKNOWN</a>
  <ul class="collapse">
<li><a href="#cummulative-ordinal-bayesian" id="toc-cummulative-ordinal-bayesian" class="nav-link" data-scroll-target="#cummulative-ordinal-bayesian">Cummulative Ordinal (Bayesian)</a></li>
  <li><a href="#adjacent-category-ordinal-bayesian" id="toc-adjacent-category-ordinal-bayesian" class="nav-link" data-scroll-target="#adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="modelling" class="quarto-section-identifier d-none d-lg-block">Modelling Reference</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">SGCX | Modelling Reference</p>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div style="page-break-after: always;"></div>
<p><strong>In this notebook we use data from study SGC3A to explore different modelling techniques and assess their suitability for the bimodal accuracy distributions.</strong></p>
<table class="table">
<colgroup><col style="width: 30%"></colgroup>
<thead><tr class="header">
<th>Pre-Requisite</th>
</tr></thead>
<tbody><tr class="odd">
<td>2_sgc3A_scoring.qmd</td>
</tr></tbody>
</table>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span> <span class="co"># %nin% operator</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span> <span class="co">#arrange plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span> <span class="co">#arrange shift function plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/ggformula">ggformula</a></span><span class="op">)</span> <span class="co">#easy graphs</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=vcdExtra">vcdExtra</a></span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span> <span class="co">#printing tables </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co">#visualize model coefficients</span>

<span class="co">#plot model estimates with uncertainty</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/">ggdist</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://modelr.tidyverse.org">modelr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.mitchelloharawild.com/distributional/">distributional</a></span><span class="op">)</span>

<span class="co">#models and performance</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR">lmerTest</a></span><span class="op">)</span> <span class="co">#for CIs in glmer </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a></span><span class="op">)</span> <span class="co">#plots w/ embedded stats</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/">report</a></span><span class="op">)</span> <span class="co">#easystats reporting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/">see</a></span><span class="op">)</span> <span class="co">#easystats visualization</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span> <span class="co">#easystats model diagnostics</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aloy/qqplotr">qqplotr</a></span><span class="op">)</span> <span class="co">#confint on qq plot</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gmodels</span><span class="op">)</span> <span class="co">#contingency table and CHISQR</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datalorax/equatiomatic">equatiomatic</a></span><span class="op">)</span> <span class="co">#extract model equation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zeroinfl / hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co">#mixed effects models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span> <span class="co">#visualization log regr models</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co">#ALL THE THINGS</span>

<span class="co">#OUTPUT OPTIONS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>ggplot2.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">1</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="co">#GRAPH THEMEING</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># HACK WD FOR LOCAL RUNNING?</span>
<span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="co"># mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="co"># setwd(mbp)</span>

<span class="co">#IMPORT DATA </span>
<span class="va">df_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span><span class="op">)</span>
<span class="va">df_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span><span class="op">)</span>

<span class="co">#PREP DATA </span>
<span class="va">df_lab</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_mode</span> <span class="op">==</span> <span class="st">"laboratory"</span><span class="op">)</span>
<span class="va">df_online</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_mode</span> <span class="op">==</span> <span class="st">"online-replication"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="single-item-level" class="level2"><h2 class="anchored" data-anchor-id="single-item-level">SINGLE ITEM LEVEL</h2>
<p><strong>Q1 Absolute, Interpretation Scores</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FILTER THE DATASET [use subjects, bc it has covariates on that record]</span>
<span class="va">df_q1</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">item_q1_NABS</span>, <span class="st">"0"</span> <span class="op">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"correct"</span><span class="op">)</span>,
  rt <span class="op">=</span> <span class="va">item_q1_rt</span>
<span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>
  <span class="va">accuracy</span>, <span class="va">rt</span>, <span class="va">pretty_condition</span>, <span class="va">pretty_mode</span>
<span class="op">)</span>

<span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="co"># gf_props(~accuracy, fill = ~pretty_condition, </span>
<span class="co">#        position = position_dodge(), data = df_q1) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_mode) +</span>
<span class="co">#    labs(x = "Correct Response on Q 1",</span>
<span class="co">#        title = "Accuracy on First Question by Condition",</span>
<span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses") #theme(legend.position = "none")</span>

<span class="co">#STACKED BAR CHART</span>
<span class="va">df_q1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "Correct Response on Q 1",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on First Question by Condition"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/SETUP-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="chi-square" class="level3"><h3 class="anchored" data-anchor-id="chi-square">CHI SQUARE</h3>
<section id="combined" class="level4"><h4 class="anchored" data-anchor-id="combined">(Combined)</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#combined dataset </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_q1</span> 

<span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Accuracy on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">accuracy</span>, shade <span class="op">=</span> <span class="cn">T</span>, color <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/label%20-%20CHISQR-Q1TRI.by.COND-BOTH-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># CrossTable( x = df$condition, y = df$accuracy, fisher = TRUE, chisq=TRUE, expected = TRUE, sresid = TRUE)</span>


<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">incorrect</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">136</span><br><span style="color:#339999;">124</span><br><span style="color:#333399;">52.5&nbsp;%</span><br><span style="color:#339933;">86.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">123</span><br><span style="color:#339999;">135</span><br><span style="color:#333399;">47.5&nbsp;%</span><br><span style="color:#339933;">71.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">259</span><br><span style="color:#339999;">259</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">78.5&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">correct</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">22</span><br><span style="color:#339999;">34</span><br><span style="color:#333399;">31&nbsp;%</span><br><span style="color:#339933;">13.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">49</span><br><span style="color:#339999;">37</span><br><span style="color:#333399;">69&nbsp;%</span><br><span style="color:#339933;">28.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">71</span><br><span style="color:#339999;">71</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">21.5&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">158</span><br><span style="color:#339999;">158</span><br><span style="color:#333399;">47.9&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">172</span><br><span style="color:#339999;">172</span><br><span style="color:#333399;">52.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">330</span><br><span style="color:#339999;">330</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=9.500 · df=1 · Cramer's V=0.177 · Fisher's p=0.001</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within accuracy</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
</div>
<p><strong>Combining data across both sessions</strong> (n=330), a Pearson’s Chi-squared test suggests a statistically significant relationship between response accuracy on the first question and experimental condition, <span class="math inline">\(\chi_2\)</span> (1) = 10.3, p = 0.001. The sample odds ratio (2.46, p = 0.001, 95% CI [1.37, 4.53]) indicates that the odds of providing a correct response to the first question are 2.46 higher for subjects in the impasse condition than those in the control condition.</p>
</section><section id="in-person" class="level4"><h4 class="anchored" data-anchor-id="in-person">(In Person)</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#lab only</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_q1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_mode</span> <span class="op">==</span> <span class="st">"laboratory"</span><span class="op">)</span>

<span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Accuracy on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">accuracy</span>, 
            shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/label%20-%20CHISQR-Q1TRI.by.COND-LAB-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># CrossTable( x = df$condition, y = df$score_niceABS, </span>
<span class="co">#             fisher = TRUE, chisq=TRUE, expected = TRUE, sresid = TRUE)</span>


<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">incorrect</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">52</span><br><span style="color:#339999;">48</span><br><span style="color:#333399;">53.6&nbsp;%</span><br><span style="color:#339933;">83.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">45</span><br><span style="color:#339999;">49</span><br><span style="color:#333399;">46.4&nbsp;%</span><br><span style="color:#339933;">70.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">97</span><br><span style="color:#339999;">97</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">77&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">correct</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">10</span><br><span style="color:#339999;">14</span><br><span style="color:#333399;">34.5&nbsp;%</span><br><span style="color:#339933;">16.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">19</span><br><span style="color:#339999;">15</span><br><span style="color:#333399;">65.5&nbsp;%</span><br><span style="color:#339933;">29.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">29</span><br><span style="color:#339999;">29</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">23&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">62</span><br><span style="color:#339999;">62</span><br><span style="color:#333399;">49.2&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">64</span><br><span style="color:#339999;">64</span><br><span style="color:#333399;">50.8&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">126</span><br><span style="color:#339999;">126</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=2.547 · df=1 · Cramer's V=0.161 · Fisher's p=0.091</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within accuracy</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
</div>
<p><strong>For (In Person) data collection</strong> (n=126) the Pearson’s Chi-squared test (of independence) indicates a relationship between response accuracy on the first question and experimental condition that is not significant at the alpha level 0.05, <span class="math inline">\(\chi^2\)</span> (1) = 10.3, p = 0.07. Thus we have insufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. In this particular data sample, the odds ratio (Odds Ratio = 2.18, p = 0.055, 95% CI [0.982, +Inf]) indicates that the odds of producing a correct response on the first question were 2.18 times greater if a subject was in the impasse condition, than in the control condition .</p>
</section><section id="online-replication" class="level4"><h4 class="anchored" data-anchor-id="online-replication">(Online Replication)</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#online only</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_q1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_mode</span> <span class="op">==</span> <span class="st">"online-replication"</span><span class="op">)</span>

<span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Accuracy on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">accuracy</span>, shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/label%20-%20CHISQR-Q1TRI.by.COND-ONLINE-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># CrossTable( x = df$condition, y = df$score_niceABS, fisher = TRUE, </span>
<span class="co">#             chisq=TRUE, expected = TRUE, sresid = TRUE)</span>


<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">incorrect</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">84</span><br><span style="color:#339999;">76</span><br><span style="color:#333399;">51.9&nbsp;%</span><br><span style="color:#339933;">87.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">78</span><br><span style="color:#339999;">86</span><br><span style="color:#333399;">48.1&nbsp;%</span><br><span style="color:#339933;">72.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">162</span><br><span style="color:#339999;">162</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">79.4&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">correct</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">12</span><br><span style="color:#339999;">20</span><br><span style="color:#333399;">28.6&nbsp;%</span><br><span style="color:#339933;">12.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">30</span><br><span style="color:#339999;">22</span><br><span style="color:#333399;">71.4&nbsp;%</span><br><span style="color:#339933;">27.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">42</span><br><span style="color:#339999;">42</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">20.6&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">96</span><br><span style="color:#339999;">96</span><br><span style="color:#333399;">47.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">108</span><br><span style="color:#339999;">108</span><br><span style="color:#333399;">52.9&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">204</span><br><span style="color:#339999;">204</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=6.351 · df=1 · Cramer's V=0.189 · Fisher's p=0.009</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within accuracy</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
</div>
<p><strong>For online data collection</strong> (n=204), a Pearson’s Chi-squared test (of independence) indicates a statistically significant relationship between response accuracy on the first question and experimental condition, <span class="math inline">\(\chi^2\)</span> (1) = 7.26, p = 0.009. Thus we have sufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. The odds ratio (Odds Ratio = 2.68, p = 0.005, 95% CI [1.37, +Inf]) indicates that the odds of producing a correct response on the first question were 2.68 times greater if a subject was in the impasse condition, than in the control condition .</p>
</section></section><section id="logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="logistic-regression">LOGISTIC REGRESSION</h3>
<p><em>Fit a logistic regression (at the subject level), predicting Q1 accuracy (absolute score) by condition.</em></p>
<section id="fit-model" class="level4"><h4 class="anchored" data-anchor-id="fit-model">Fit Model</h4>
<p><em>First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#combined</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># FREQUENCY TABLE</span>
<span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span>
<span class="co"># addmargins(my.table) #counts</span>
<span class="co"># addmargins(prop.table(my.table)) #props</span>

<span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span>

<span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span>
<span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"EMPTY MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "EMPTY MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ 1, family = "binomial", data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.696  -0.696  -0.696  -0.696   1.753  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -1.294      0.134   -9.66   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 343.66  on 329  degrees of freedom
AIC: 345.7

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: 2 CONDITION model</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.819  -0.819  -0.548  -0.548   1.986  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.822      0.230   -7.93  2.2e-15 ***
pretty_conditionimpasse    0.901      0.285    3.16   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 333.07  on 328  degrees of freedom
AIC: 337.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: 3 TEST SUPERIOR FIT</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC wth predictor is lower than empty model?"</span>, <span class="va">m0</span><span class="op">$</span><span class="va">aic</span> <span class="op">&gt;</span> <span class="va">m1</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name | Model | df | df_diff |  Chi2 |     p
-------------------------------------------
m0   |   glm |  1 |         |       |      
m1   |   glm |  2 |       1 | 10.59 | 0.001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.00113745235691825"</code></pre>
</div>
</div>
<p><em>The Condition predictor significantly improves model fit.</em></p>
</section><section id="learning-notes" class="level4"><h4 class="anchored" data-anchor-id="learning-notes">Learning Notes</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.819  -0.819  -0.548  -0.548   1.986  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.822      0.230   -7.93  2.2e-15 ***
pretty_conditionimpasse    0.901      0.285    3.16   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 333.07  on 328  degrees of freedom
AIC: 337.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: INTERPRET COEFFICIENTS</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- LOG ODDS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- LOG ODDS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                         2.5 % 97.5 %
(Intercept)             -2.299  -1.39
pretty_conditionimpasse  0.353   1.48</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#exponentiate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                              2.5 % 97.5 %
(Intercept)             0.162  0.10  0.248
pretty_conditionimpasse 2.463  1.42  4.374</code></pre>
</div>
</div>
<p><strong>Understanding the logistic regression model</strong></p>
<p><em>The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable</em></p>
<p><em>The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.</em></p>
<p><strong>[the empty model</strong></p>
<ul>
<li>The intercept of an empty model (glm(accuracy ~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df$accuracy ==1 ).</li>
<li>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -&gt; log(0.215 / (1-0.215)) = -1.29.</li>
<li>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</li>
<li>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</li>
</ul>
<p><strong>[a dichotomous predictor]</strong></p>
<p>natural log (odds of +) = -1.822 + 0.901(x1) ; x1 = 0 for control, 1 for impasse</p>
<ul>
<li>INTERCEPT: log odds of (+ response) in control condition
<ul>
<li>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</li>
<li>convert to odds by exponentiating the coefficients<br>
log odds of (+) in control = exp(-1.822) = 0.162 odds</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139<br>
probability of (+) in control = ~14%</li>
</ul>
</li>
<li>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs.&nbsp;control
<ul>
<li>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</li>
<li>convert to odds by exponentiating log odds<br>
log odds (+) in impasse = exp(-0.921) = 0.398</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285<br>
probaility of (+) in impasse = ~ 29%</li>
</ul>
</li>
<li>ODDS RATIO : exponentiated B1 COEFFICIENT
<ul>
<li><p>B1 = (slope of logit model = difference in log odds = log odds ratio</p></li>
<li><p>B1 = 0.901 is log odds ratio of (+) in impasse vs control</p></li>
<li><p>exp(b1) = exp(0.901) = 2.46</p></li>
<li><p>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</p></li>
</ul>
</li>
</ul>
<table class="table">
<colgroup><col style="width: 100%"></colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">MARGINAL<br>
total = 330 success : 71, failure : 259<br>
p(+) = 71 / 330 = 0.215 = 22%<br>
odds(+) = 71 / 259 = 0.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">CONTROL total = 158 success = 22; failure = 136<br>
p(+) = 22/158 = 0.139 = 14%<br>
odds(+) = 22/136 = 0.162</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMPASSE total = 172 success = 49; failure = 123<br>
p(+) = 49/172 = 0.285 = 29%<br>
odds(+) = 49/123 = 0.398</td>
</tr>
</tbody>
</table></section><section id="visualize" class="level4"><h4 class="anchored" data-anchor-id="visualize">Visualize</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log | Score_spherical |   PCP
----------------------------------------------------------------------------------------------
337.074 | 344.673 |     0.031 | 0.404 | 1.008 |    0.505 |   -16.847 |           0.021 | 0.673</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model's explanatory power is weak (Tjur's R2 = 0.03). The model's intercept, corresponding to pretty_condition = control, is at -1.82 (95% CI [-2.30, -1.39], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.90, 95% CI [0.35, 1.48], p = 0.002; Std. beta = 0.90, 95% CI [0.35, 1.48])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PREDICTIONS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PREDICTIONS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Retrieve predictions as probabilities </span>
<span class="co"># (for each level of the predictor)</span>
<span class="va">p.control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m1</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pretty_condition<span class="op">=</span><span class="st">"control"</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Probability of success in control,"</span>, <span class="va">p.control</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in control, 0.139240506329147"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p.impasse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m1</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pretty_condition<span class="op">=</span><span class="st">"impasse"</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Probability of success in impasse,"</span>, <span class="va">p.impasse</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in impasse, 0.284883720930631"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PLOT</span>

<span class="co">#GGSTATS | MODEL | LOG ODDS </span>
<span class="co"># library(ggstatsplot)</span>
<span class="co"># ggcoefstats(m1, output = "plot") + labs(x = "Log Odds Estimate")</span>

<span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m1</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="co"># plot_model(m1, type="pred",</span>
<span class="co">#            show.intercept = TRUE, </span>
<span class="co">#            show.values = TRUE,</span>
<span class="co">#            title = "Model Predicted Probability of Accuracy",</span>
<span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span>

<span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span>
<span class="co"># library(ggeffects)</span>
<span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggeffect</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">m1</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SANITY CHECK SJPLOT</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics" class="level4"><h4 class="anchored" data-anchor-id="diagnostics">Diagnostics</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Ok: About 100% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="inference" class="level4"><h4 class="anchored" data-anchor-id="inference">Inference</h4>
<p>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the <em>impasse condition</em> increase by 146% (<span class="math inline">\(e^{beta_1}\)</span> = 2.46, 95% CI [1.42, 4.37]) over the <em>control condition</em>.</p>
<p><em>Equivalent statements:</em></p>
<ul>
<li>being in impasse condition increases log odds of correct response by 0.901 (over control)</li>
<li>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</li>
<li>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PRETTY TABLE SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.10&nbsp;–&nbsp;0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.42&nbsp;–&nbsp;4.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.002</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">330</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.031</td>
</tr>
</tbody></table>
</div>
</div>
</section></section><section id="todo-ordinal-regression" class="level3"><h3 class="anchored" data-anchor-id="todo-ordinal-regression">TODO ORDINAL REGRESSION</h3>
<p><em>Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.</em></p>
<ul>
<li>https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</li>
<li>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</li>
<li>todo see ordinal regression video</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># #CREATE DATAFRAME OF Q1</span>
<span class="co"># df &lt;- df_items %&gt;% filter(q ==1) %&gt;% mutate(scaled = as.factor(score_SCALED))</span>
<span class="co"># </span>
<span class="co"># #MODEL</span>
<span class="co"># m &lt;- polr(scaled ~ condition , data = df, Hess=TRUE)</span>
<span class="co"># summary(m)</span>
<span class="co"># confint(m)</span>
<span class="co"># performance(m)</span>
<span class="co"># report(m)</span>
<span class="co"># </span>
<span class="co"># #exponentiate coefficients and CIs </span>
<span class="co"># ci &lt;- confint(m)</span>
<span class="co"># ci</span>
<span class="co"># e &lt;- coef(m)</span>
<span class="co"># e</span>
<span class="co"># # exp(cbind(e,ci))</span>
<span class="co"># </span>
<span class="co"># # Retrieve predictions as probabilities </span>
<span class="co"># # (for each level of the predictor)</span>
<span class="co"># # p.control &lt;- predict(m,data.frame(condition="111"),type="response")</span>
<span class="co"># # paste("Probability of success in control,", p.control)</span>
<span class="co"># # p.impasse &lt;- predict(m,data.frame(condition="121"),type="response")</span>
<span class="co"># # paste("Probability of success in impasse,", p.impasse)</span>
<span class="co"># </span>
<span class="co"># # Plot Predicted data and original data points</span>
<span class="co"># # ggplot(df, aes(x=condition, y=accuracy)) + </span>
<span class="co"># #   geom_point() +</span>
<span class="co"># #   stat_smooth(method="glm", color="green", se=FALSE,</span>
<span class="co"># #                 method.args = list(family=binomial))</span>
<span class="co">#   </span>
<span class="co"># #TO PLOT ALL EFFECTS</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(m))</span>
<span class="co"># </span>
<span class="co"># #SJPLOT</span>
<span class="co"># library(sjPlot)</span>
<span class="co"># plot_model(m, )</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># #CONVERT TO PROBABILITIES</span>
<span class="co"># newdat &lt;- data.frame(condition=c("111","121"))</span>
<span class="co"># prob &lt;- (phat &lt;- predict(object = m, newdat, type="p"))</span>
<span class="co"># prob</span>
<span class="co"># </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="repeated-item-level" class="level2"><h2 class="anchored" data-anchor-id="repeated-item-level">REPEATED ITEM LEVEL</h2>
<p><strong>Test Phase Accuracy (absolute score)</strong></p>
<section id="mixed-logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="mixed-logistic-regression">Mixed Logistic Regression</h4>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on test phase questions by condition; accounting for random effects of subject.</em></p>
<section id="fit-model-1" class="level5"><h5 class="anchored" data-anchor-id="fit-model-1">Fit Model</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA </span>
<span class="co">#PREPARE DATA </span>
<span class="va">n_items</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#number of items in test</span>

<span class="co">#item level</span>
<span class="va">df_test</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_test</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR">lmerTest</a></span><span class="op">)</span> <span class="co">#for CIs in glmer </span>

<span class="co">## 1 | SETUP RANDOM EFFECT</span>

<span class="co">#:: EMPTY MODEL (baseline, no random effect)</span>
<span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> 

<span class="co">#:: RANDOM INTERCEPT SUBJECT</span>
<span class="va">mm.rS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>

<span class="co"># :: TEST random effect</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC with random effect is lower than glm empty model?"</span>, <span class="va">m0</span><span class="op">$</span><span class="va">aic</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC with random effect is lower than glm empty model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">mm.rS</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name  |    Model | df | df_diff |    Chi2 |      p
--------------------------------------------------
m0    |      glm |  1 |         |         |       
mm.rS | glmerMod |  2 |       1 | 1783.73 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## 2 | ADD FIXED EFFECT</span>

<span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span>
<span class="va">mm.CrS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, 
                data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>

<span class="co"># :: TEST fixed factor </span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC with random effect is lower than glm empty model?"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC with random effect is lower than glm empty model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rS</span>,<span class="va">mm.CrS</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name   |    Model | df | df_diff | Chi2 |     p
-----------------------------------------------
mm.rS  | glmerMod |  2 |         |      |      
mm.CrS | glmerMod |  3 |       1 | 4.98 | 0.026</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rS</span>,<span class="va">mm.CrS</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0256331468201315"</code></pre>
</div>
</div>
</section><section id="visualize-1" class="level5"><h5 class="anchored" data-anchor-id="visualize-1">Visualize</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PRINT MODEL </span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition + (1 | subject)
   Data: df

     AIC      BIC   logLik deviance df.resid 
    1385     1402     -689     1379     2637 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5307 -0.0193 -0.0097  0.1135  2.7426 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 117      10.8    
Number of obs: 2640, groups:  subject, 330

Fixed effects:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -9.182      0.677  -13.56   &lt;2e-16 ***
pretty_conditionimpasse    1.632      0.753    2.17     0.03 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
prtty_cndtn -0.394</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: INTERPRET COEFFICIENTS</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma | Log_loss | Score_log | Score_spherical
--------------------------------------------------------------------------------------------------------------
1384.749 | 1402.385 |      0.973 |      0.005 | 0.973 | 0.203 | 1.000 |    0.130 |      -Inf |           0.015</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic mixed model (estimated using ML and Nelder-Mead optimizer) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model included subject as random effect (formula: ~1 | subject). The model's total explanatory power is substantial (conditional R2 = 0.97) and the part related to the fixed effects alone (marginal R2) is of 5.50e-03. The model's intercept, corresponding to pretty_condition = control, is at -9.18 (95% CI [-10.51, -7.85], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 1.63, 95% CI [0.16, 3.11], p = 0.030; Std. beta = 1.63, 95% CI [0.16, 3.11])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PLOT</span>

<span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mm.CrS</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mm.CrS</span>, type<span class="op">=</span><span class="st">"pred"</span>,
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,
           show.values <span class="op">=</span> <span class="cn">TRUE</span>,
           title <span class="op">=</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,
           axis.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span>
<span class="co"># library(ggeffects)</span>
<span class="co"># ggeffect(model = mm.CrS) %&gt;% plot()</span>

<span class="co">#SANITY CHECK SJPLOT</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(mm.CrS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics-1" class="level5"><h5 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Warning: Probably bad model fit. Only about 75% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="inference-1" class="level5"><h5 class="anchored" data-anchor-id="inference-1">Inference</h5>
<p>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(3): 4.98, p &lt; 0.05). Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 5 over the control condition <span class="math inline">\(e^{\beta_1}\)</span> = 5.11, 95% CI [1.17,22,36], p &lt; 0.05.</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># PRETTY TABLE SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition: impasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.17&nbsp;–&nbsp;22.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.030</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">116.99</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.97</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2640</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.005 / 0.973</td>
</tr>
</tbody></table>
</div>
</div>
</section></section><section id="todo-mixed-ordinal-regression" class="level4"><h4 class="anchored" data-anchor-id="todo-mixed-ordinal-regression">TODO Mixed Ordinal Regression</h4>
</section></section><section id="subject-level" class="level2"><h2 class="anchored" data-anchor-id="subject-level">SUBJECT-LEVEL</h2>
<p><strong>Test Phase Absolute Score (# questions)</strong></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PREPARE DATA </span>
<span class="va">n_items</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#number of items in test</span>

<span class="co">#item level</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_niceABS</span>, <span class="st">"0"</span> <span class="op">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"correct"</span><span class="op">)</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on Test Phase"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/SETUP-TEST-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="co"># gf_props(~accuracy, fill = ~pretty_condition, x =~pretty_condition,</span>
<span class="co">#        position = position_dodge(), data = df) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_mode) +</span>
<span class="co">#    labs(x = "Correct Responses in Test Phase",</span>
<span class="co">#        title = "Accuracy on Task by Condition",</span>
<span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses")</span>

 
<span class="co">#FACETED HISTOGRAM</span>
<span class="va">stats</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">pretty_condition</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">item_test_NABS</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">item_test_NABS</span>, 
         fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">pretty_mode</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_lines.html">gf_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stats</span>, xintercept <span class="op">=</span> <span class="op">~</span><span class="va">mean</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"# Correct"</span>,
       y <span class="op">=</span> <span class="st">"proportion of subjects"</span>,
       title <span class="op">=</span> <span class="st">"Test Phase Absolute Score (# Correct)"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/SETUP-TEST-ACC-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="independent-samples-t-test" class="level4"><h4 class="anchored" data-anchor-id="independent-samples-t-test">Independent Samples T-Test</h4>
<p><em>Compare mean ABS score for Ss in control vs.&nbsp;impasse condition.</em></p>
<ul>
<li>The bimodal distribution of the subject-level score data do not meet the requirements for t-tests. However, a non-parametric alternative is available (Wilcoxon rank sum test / Man-Whitney test)</li>
<li>Additional corrections are available for data with ‘floor’ and/or ‘ceiling’ effects via the ‘DACR’ package</li>
<li>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14 see also https://qmliu.shinyapps.io/DACFE/</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'mosaic':
  method                           from   
  fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    cross</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lmerTest':

    rand</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    factorize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelr':

    resample</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    mplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    rescale</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:cowplot':

    theme_map</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">df_subjects</span><span class="op">$</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">df_subjects</span><span class="op">$</span><span class="va">pretty_condition</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  df_subjects$pretty_condition min Q1 median Q3 max mean   sd   n missing
1                      control   0  0      0  1   8 1.52 2.86 158       0
2                      impasse   0  0      1  7   8 3.02 3.41 172       0</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonocarroll/ggeasy">ggeasy</a></span><span class="op">)</span> <span class="co">#easy adjustmenet to ggplots plots </span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span>, width <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_jitter.html">gf_jitter</a></span><span class="op">(</span> width <span class="op">=</span> <span class="fl">0.08</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span> <span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Task Accuracy by Condition"</span>,
        y <span class="op">=</span> <span class="st">"Task Accuracy (# correct)"</span>, x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggeasy/man/easy_remove_legend.html">easy_remove_legend</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>For comparison we run a standard Welch Two-sample T test, for which we do not meet the normal distribution requirement, followed by a Wilcoxon rank-sum (Mann-Whitney) test that is a nonparametric alternative for non-normally distributed data.</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#WELCH TWO SAMPLE T TEST</span>
<span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span><span class="st">"\n --------------DATA DON'T MEET NORMALITY REQS FOR WELCH---------"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 --------------DATA DON'T MEET NORMALITY REQS FOR WELCH---------</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/ttest.html">t.test</a></span><span class="op">(</span><span class="va">df_subjects</span><span class="op">$</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">df_subjects</span><span class="op">$</span><span class="va">pretty_condition</span><span class="op">)</span>
<span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>

The Welch Two Sample t-test testing the difference of df_subjects$item_test_NABS by df_subjects$pretty_condition (mean in group control = 1.52, mean in group impasse = 3.02) suggests that the effect is negative, statistically significant, and small (difference = -1.50, 95% CI [-2.18, -0.82], t(325.38) = -4.34, p &lt; .001; Cohen's d = -0.48, 95% CI [-0.69, -0.26])</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#WILCOXON RANK BASED TEST</span>
<span class="co"># The Wilcoxon rank sum test is a non-parametric alternative to the independent two samples t-test for comparing two independent groups of samples, in the situation where the data are not normally distributed.</span>
<span class="co">#Synonymous: Mann-Whitney test, Mann-Whitney U test, Wilcoxon-Mann-Whitney test and two-sample Wilcoxon test.</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"\n \n --------------ROBUST ALTERNATIVE --------------"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "\n \n --------------ROBUST ALTERNATIVE --------------"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">df_subjects</span><span class="op">$</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">df_subjects</span><span class="op">$</span><span class="va">pretty_condition</span><span class="op">)</span>
<span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>

The Wilcoxon rank sum test with continuity correction testing the difference in ranks between df_subjects$item_test_NABS and df_subjects$pretty_condition suggests that the effect is negative, statistically significant, and medium (W = 10180.00, p &lt; .001; r (rank biserial) = -0.25, 95% CI [-0.36, -0.13])</code></pre>
</div>
</div>
<p>Next, we calculate the t-test and ANOVA (F-test) based on a series of corrections provided for data with floor and/or ceiling effects.</p>
<ul>
<li>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14</li>
</ul>
<p>Using properties from truncated normal distributions, the authors propose an easy-to-use method for the <em>t</em>-test and ANOVA with ceiling/floor data. <em>The proposed method calculates the degrees of freedom based on the after-truncation sample sizes (where l = number of floor observations, and r = number of ceiling observations). The rationale was that the proposed method utilizes full information only from data points of n − r − l participants and partial information from data points of r + l participants of a group for the mean and variance estimation. Specifically, the corrected mean and variance estimates (Eqs. 14 and 15) are functions of mean and variance estimates using after-truncation data (n − r − l participants) and the standardized floor and ceiling threshold estimates. The thresholds are estimated using the ceiling and floor percentage estimates based on data points of n − r and n − l participants, respectively. This is a relatively conservative approach for calculating the degrees of freedom, which can help control the type I error rate. This feature can be beneficial, especially given the “replication crisis” in psychological and behavioral research.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FLOOR-CEILING ADJUSTED T TESTS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DACF</span><span class="op">)</span> <span class="co">#tests for data with floor and ceiling </span>
<span class="co"># https://www.rdocumentation.org/packages/DACF/versions/1.0.0</span>


<span class="co">#prepare data [vector of scores for each group]</span>
<span class="va">score_111</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_condition</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">item_test_NABS</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">score_121</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_condition</span> <span class="op">==</span> <span class="st">"impasse"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">item_test_NABS</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># recover the mean and variance for ceiling/floor data</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DACF/man/rec.mean.var.html">rec.mean.var</a></span><span class="op">(</span><span class="va">score_111</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># recover the mean and variance for ceiling/floor data</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DACF/man/rec.mean.var.html">rec.mean.var</a></span><span class="op">(</span><span class="va">score_121</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="st">"control"</span><span class="op">=</span><span class="va">a</span> ,<span class="st">"impasse"</span><span class="op">=</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>
<span class="va">r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        ceiling.percentage floor.percentage est.mean est.var
control             0.0886            0.728    -7.15   153.3
impasse             0.1802            0.483     1.24    72.7</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># method "a" uses original sample size</span>
<span class="co"># method "b" uses after-truncation sample size</span>

<span class="co"># perform adjusted t test</span>
<span class="fu"><a href="https://rdrr.io/pkg/DACF/man/lw.t.test.html">lw.t.test</a></span><span class="op">(</span><span class="va">score_111</span>,<span class="va">score_121</span>,<span class="st">"a"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in x2 == max(x2) | x1 == min(x2): longer object length is not a multiple
of shorter object length

Warning in x2 == max(x2) | x1 == min(x2): longer object length is not a multiple
of shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistic
[1] -2.95

$p.value
[1] 0.007

$est.d
[1] -0.781

$conf.int
[1] -14.25  -2.52</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FLOOR-CEILING ADJUSTED F* TEST ANOVA</span>
<span class="fu"><a href="https://rdrr.io/pkg/DACF/man/lw.f.star.html">lw.f.star</a></span><span class="op">(</span><span class="va">df_subjects</span>,<span class="va">item_test_NABS</span><span class="op">~</span><span class="va">pretty_condition</span>,<span class="st">"a"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$statistic
[1] 50.6

$p.value
[1] 9.79e-12

$est.f.squared
[1] 0.153</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># method "a" uses original sample size</span>
<span class="co"># method "b" uses after-truncation sample size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Group 1 has ceiling and floor percentage of 10.5% and 30.2%, with corrected mean and variance respectively as 3.434 and 83.157. Group 2 has ceiling and floor percentage of 8.2% and 62.7%, with corrected mean and variance respectively as -6.504 and 210.664. The corrected t statistic is 4.778, p = 0. The estimated Cohen’s d is 0.87 with a confidence interval as [5.742,14.135].</p>
</section><section id="censored-linear-regression" class="level4"><h4 class="anchored" data-anchor-id="censored-linear-regression">Censored Linear Regression</h4>
</section><section id="linear-regression" class="level4"><h4 class="anchored" data-anchor-id="linear-regression">Linear Regression</h4>
<p><em>LM on Test Phase absolute score <strong>as number of questions</strong>, rather than % correct.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SCORE predicted by CONDITION</span>
<span class="va">lm.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = item_test_NABS ~ pretty_condition, data = df_subjects)

Residuals:
   Min     1Q Median     3Q    Max 
 -3.02  -2.77  -1.52   2.98   6.48 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                1.519      0.251    6.04  4.1e-09 ***
pretty_conditionimpasse    1.498      0.348    4.30  2.2e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.16 on 328 degrees of freedom
Multiple R-squared:  0.0535,    Adjusted R-squared:  0.0506 
F-statistic: 18.5 on 1 and 328 DF,  p-value: 0.0000222</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Partition Variance"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: item_test_NABS
                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
pretty_condition   1    185     185    18.5 0.000022 ***
Residuals        328   3274      10                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Confidence Interval on Parameter Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/confint.html">confint</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        2.5 % 97.5 %
(Intercept)             1.025   2.01
pretty_conditionimpasse 0.814   2.18</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span> <span class="co">#sanity check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict item_test_NABS with pretty_condition (formula: item_test_NABS ~ pretty_condition). The model explains a statistically significant and weak proportion of variance (R2 = 0.05, F(1, 328) = 18.52, p &lt; .001, adj. R2 = 0.05). The model's intercept, corresponding to pretty_condition = control, is at 1.52 (95% CI [1.02, 2.01], t(328) = 6.04, p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 1.50, 95% CI [0.81, 2.18], t(328) = 4.30, p &lt; .001; Std. beta = 0.46, 95% CI [0.25, 0.67])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span>

<span class="co">#setup references</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="va">lm.1</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span>
<span class="va">call</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">$</span><span class="va">call</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># uncertainty model visualization</span>
<span class="va">df</span>  <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">modelr</span><span class="fu">::</span><span class="fu"><a href="https://modelr.tidyverse.org/reference/data_grid.html">data_grid</a></span><span class="op">(</span><span class="va">pretty_condition</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">lm.1</span>, newdata <span class="op">=</span> <span class="va">.</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pretty_condition</span>, color <span class="op">=</span> <span class="va">pretty_condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span> scale <span class="op">=</span> <span class="fl">.5</span>,
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
        xdist <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_student_t.html">dist_student_t</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">.fitted</span>, sigma <span class="op">=</span> <span class="va">.se.fit</span><span class="op">)</span>,
        fill <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/interval.html">stat</a></span><span class="op">(</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/cut_cdf_qi.html">cut_cdf_qi</a></span><span class="op">(</span><span class="va">cdf</span>,
                .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.90</span>, <span class="fl">.95</span><span class="op">)</span>,
                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span> <span class="op">(</span>title <span class="op">=</span> <span class="st">"(LAB) Test Phase Accuracy ~ Condition"</span>,
        x <span class="op">=</span> <span class="st">"model predicted mean (% correct)"</span>, y <span class="op">=</span> <span class="st">"Condition"</span>, fill <span class="op">=</span> <span class="st">"Interval"</span>,
        subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"lm("</span>,<span class="va">call</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">")"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/VISMODEL-TEST-ABS-LAB-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="censored-tobit-regression" class="level4"><h4 class="anchored" data-anchor-id="censored-tobit-regression">Censored (Tobit) Regression</h4>
<p>https://stats.oarc.ucla.edu/r/dae/tobit-models/</p>
<p><strong>For censored data (i.e.&nbsp;truncated axis).</strong> The tobit model, also called a censored regression model, is designed to estimate linear relationships between variables when there is either left- or right-censoring in the dependent variable (also known as censoring from below and above, respectively). Censoring from above takes place when cases with a value at or above some threshold, all take on the value of that threshold, so that the true value might be equal to the threshold, but it might also be higher. In the case of censoring from below, values those that fall at or below some threshold are censored.</p>
<ul>
<li>censored vs truncated : There is sometimes confusion about the difference between truncated data and censored data. With censored variables, all of the observations are in the dataset, but we don’t know the “true” values of some of them. With truncation some of the observations are not included in the analysis because of the value of the variable. When a variable is censored, regression models for truncated data provide inconsistent estimates of the parameters. See Long (1997, chapter 7) for a more detailed discussion of problems of using regression models for truncated data to analyze censored data.</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="va">item_test_NABS</span>
<span class="op">)</span>

<span class="va">lo</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">hi</span> <span class="op">=</span> <span class="fl">8</span> 
<span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">accuracy</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0 8</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Lo and Hi should equate to upper and lower bounds of the # Qs "</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Lo and Hi should equate to upper and lower bounds of the # Qs "</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/">VGAM</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'VGAM' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: splines</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'VGAM'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:mosaic':

    chisq, logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:distributional':

    cdf</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT MODEL</span>
<span class="va">m1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html">vglm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">condition</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html">tobit</a></span><span class="op">(</span>Lower <span class="op">=</span> <span class="va">lo</span>, Upper <span class="op">=</span><span class="va">hi</span> <span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
vglm(formula = accuracy ~ condition, family = tobit(Lower = lo, 
    Upper = hi), data = df)

Coefficients: 
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1  -5.4245     1.0366   -5.23  1.7e-07 ***
(Intercept):2   2.2731     0.0797   28.52  &lt; 2e-16 ***
condition121    5.7588     1.3435    4.29  1.8e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Names of linear predictors: mu, loglink(sd)

Log-likelihood: -482 on 657 degrees of freedom

Number of Fisher scoring iterations: 12 

No Hauck-Donner effect found in any of the estimates</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CONFIDENCE INTERVALS</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vcovvlm.html">vcov</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>LL <span class="op">=</span> <span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span>, UL <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 LL    UL
(Intercept):1 -7.46 -3.39
(Intercept):2  2.12  2.43
condition121   3.13  8.39</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TEST FIT</span>
<span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html">vglm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html">tobit</a></span><span class="op">(</span>Lower <span class="op">=</span> <span class="va">lo</span>, Upper <span class="op">=</span> <span class="va">hi</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0000429</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, <span class="va">p</span> <span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P value of likelihood ratio test less than alpha = 0.05?  TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name | Model |     AIC | AIC weights |     BIC | BIC weights |  RMSE | Sigma
----------------------------------------------------------------------------
m0   |  vglm | 988.879 |     &lt; 0.001 | 996.477 |     &lt; 0.001 | 7.989 | 8.002
m1   |  vglm | 970.764 |       1.000 | 982.162 |       0.999 | 7.760 | 7.778</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#DIAGNOSTICS</span>
<span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-23-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-23-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">yhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="op">{</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">rr</span>, main <span class="op">=</span> <span class="st">"Fitted vs Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">rr</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">rp</span>, main <span class="op">=</span> <span class="st">"Fitted vs Pearson Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">rp</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">accuracy</span>, <span class="va">rp</span>, main <span class="op">=</span> <span class="st">"Actual vs Pearson Residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">accuracy</span>, <span class="va">yhat</span>, main <span class="op">=</span> <span class="st">"Actual vs Fitted"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-23-5.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#VARIANCE ACCOUNTED FOR</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"VARIANCE ACCOUNTED FOR"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "VARIANCE ACCOUNTED FOR"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># correlation</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.231</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># variance accounted for</span>
<span class="va">r</span><span class="op">^</span><span class="fl">2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0535</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |  RMSE | Sigma
---------------------------------
970.764 | 982.162 | 7.760 | 7.778</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#NOTE: censReg package also does Tobit regression [including mixed models]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>The coefficient labeled “(Intercept):1” is the intercept or constant for the model.</li>
<li>The coefficient labeled “(Intercept):2” is an ancillary statistic. If we exponentiate this value, we get a statistic that is analogous to the square root of the residual variance in OLS regression. logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</li>
<li>The predicted value of test_phase_score is 5.75 points <em>higher</em> for students in the impasse condition than for students in the control condition. (72% improvement in score!)</li>
</ul>
<p><strong>Using censReg package</strong> - https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sampleSelection.org">censReg</a></span><span class="op">)</span> <span class="co">#censored regression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'censReg' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maxLik</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: miscTools</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite the 'maxLik' package as:
Henningsen, Arne and Toomet, Ott (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics 26(3), 443-458. DOI 10.1007/s00180-010-0217-1.

If you have questions, suggestions, or comments regarding the 'maxLik' package, please use a forum or 'tracker' at maxLik's R-Forge site:
https://r-forge.r-project.org/projects/maxlik/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite the 'censReg' package as:
Henningsen, Arne (2017). censReg: Censored Regression (Tobit) Models. R package version 0.5. http://CRAN.R-Project.org/package=censReg.

If you have questions, suggestions, or comments regarding the 'censReg' package, please use a forum or 'tracker' at the R-Forge site of the 'sampleSelection' project:
https://r-forge.r-project.org/projects/sampleselection/</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="va">item_test_NABS</span>
<span class="op">)</span>

<span class="va">lo</span><span class="op">=</span><span class="fl">0</span>
<span class="va">hi</span><span class="op">=</span><span class="fl">8</span>
<span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">accuracy</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0 8</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT MODEL</span>
<span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/censReg/man/censReg.html">censReg</a></span><span class="op">(</span> <span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span>, left<span class="op">=</span><span class="va">lo</span>, right<span class="op">=</span><span class="va">hi</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = accuracy ~ pretty_condition, left = lo, right = hi, 
    data = df)

Observations:
         Total  Left-censored     Uncensored Right-censored 
           330            198             87             45 

Coefficients:
                        Estimate Std. error t value  Pr(&gt; t)    
(Intercept)             -5.42513    1.21728  -4.457 8.32e-06 ***
pretty_conditionimpasse  5.75908    1.35811   4.241 2.23e-05 ***
logSigma                 2.27314    0.09373  24.251  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 6 iterations
Return code 1: gradient close to zero (gradtol)
Log-likelihood: -482 on 3 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CONFIDENCE INTERVALS</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vcovvlm.html">vcov</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>LL <span class="op">=</span> <span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span>, UL <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                           LL    UL
(Intercept)             -7.81 -3.04
pretty_conditionimpasse  3.10  8.42
logSigma                 2.09  2.46</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TEST FIT</span>
<span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span>

<span class="va">c0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/censReg/man/censReg.html">censReg</a></span><span class="op">(</span> <span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, left<span class="op">=</span><span class="va">lo</span>, right<span class="op">=</span><span class="va">hi</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">c0</span><span class="op">)</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 0.0000429 (df=3)</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, <span class="va">p</span> <span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P value of likelihood ratio test less than alpha = 0.05?  TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in get_residuals.default(model, verbose = verbose, type = "response", :
Can't extract residuals from model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Response residuals not available to calculate mean square error. (R)MSE
  is probably not reliable.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC
-----------------
970.764 | 982.162</code></pre>
</div>
</div>
<ul>
<li>logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</li>
<li>output should match that of VGAM</li>
</ul></section><section id="poisson-regression" class="level4"><h4 class="anchored" data-anchor-id="poisson-regression">Poisson Regression</h4>
<p>https://stats.oarc.ucla.edu/r/dae/poisson-regression/</p>
<p>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can consider it a type of <em>count</em>, (ie. count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function).</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#POISSON</span>

<span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span>
<span class="va">p.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = item_test_NABS ~ pretty_condition, family = "poisson", 
    data = df_subjects)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
 -2.46   -2.28   -1.74    1.51    3.69  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               0.4180     0.0645    6.48  9.4e-11 ***
pretty_conditionimpasse   0.6864     0.0781    8.79  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1579.3  on 329  degrees of freedom
Residual deviance: 1496.7  on 328  degrees of freedom
AIC: 1956

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Partition Variance"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: poisson, link: log

Response: item_test_NABS

Terms added sequentially (first to last)

                 Df Deviance Resid. Df Resid. Dev
NULL                               329       1579
pretty_condition  1     82.7       328       1497</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Confidence Interval on Parameter Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/maxLik/man/confint.maxLik.html">confint</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        2.5 % 97.5 %
(Intercept)             0.289  0.542
pretty_conditionimpasse 0.535  0.841</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb215"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span> <span class="co">#sanity check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a poisson model (estimated using ML) to predict item_test_NABS with pretty_condition (formula: item_test_NABS ~ pretty_condition). The model's explanatory power is moderate (Nagelkerke's R2 = 0.22). The model's intercept, corresponding to pretty_condition = control, is at 0.42 (95% CI [0.29, 0.54], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.69, 95% CI [0.53, 0.84], p &lt; .001; Std. beta = 0.69, 95% CI [0.53, 0.84])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb218"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="zero-inflated-poisson" class="level4"><h4 class="anchored" data-anchor-id="zero-inflated-poisson">Zero Inflated Poisson</h4>
<p>https://stats.oarc.ucla.edu/r/dae/zip/<br>
Poisson count process with excess zeros</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb219"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#ZERO INFLATED POISSON</span>

<span class="va">zinfp.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span>  <span class="va">item_q1_rt</span><span class="op">|</span> <span class="va">pretty_condition</span> , data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = item_test_NABS ~ item_q1_rt | pretty_condition, data = df_subjects)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.934 -0.821 -0.548  0.965  2.421 

Count model coefficients (poisson with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.654243   0.059975   27.58   &lt;2e-16 ***
item_q1_rt  0.001690   0.000849    1.99    0.047 *  

Zero-inflation model coefficients (binomial with logit link):
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                0.978      0.179    5.46  4.7e-08 ***
pretty_conditionimpasse   -1.055      0.236   -4.48  7.5e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 7 
Log-likelihood: -531 on 4 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb221"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated poisson model to predict item_test_NABS with item_q1_rt and pretty_condition (formula: item_test_NABS ~ item_q1_rt). The model's explanatory power is substantial (R2 = 0.35, adj. R2 = 0.35). The model's intercept, corresponding to item_q1_rt = 0, is at 1.65 (95% CI [1.54, 1.77], p &lt; .001). Within this model:

  - The effect of item q1 rt is statistically significant and positive (beta = 1.69e-03, 95% CI [2.52e-05, 3.35e-03], p = 0.047; Std. beta = 0.06, 95% CI [7.11e-04, 0.12])
  - The effect of pretty condition [impasse] is statistically significant and negative (beta = -1.06, 95% CI [-1.52, -0.59], p &lt; .001; Std. beta = -1.06, 95% CI [-1.52, -0.59])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb224"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |      BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-------------------------------------------------------------------------------------
1070.173 | 1085.370 | 0.354 |     0.350 | 3.131 | 3.150 |    -1.609 |           0.044</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb226"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># check_model(zinfp.1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="negative-binomial-regression" class="level4"><h4 class="anchored" data-anchor-id="negative-binomial-regression">Negative Binomial Regression</h4>
<p>https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/ - overdispersed count data (variance much greater than mean)</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb227"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span>
<span class="co"># - https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/</span>
<span class="co"># - Overdispersed Count variables</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'MASS' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb231"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nb.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = item_test_NABS ~ pretty_condition, data = df_subjects, 
    init.theta = 0.253501538, link = log)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.139  -1.102  -0.993   0.378   1.091  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                0.418      0.171    2.45   0.0143 * 
pretty_conditionimpasse    0.686      0.232    2.95   0.0031 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(0.254) family taken to be 1)

    Null deviance: 279.52  on 329  degrees of freedom
Residual deviance: 270.97  on 328  degrees of freedom
AIC: 1194

Number of Fisher Scoring iterations: 1

              Theta:  0.2535 
          Std. Err.:  0.0315 

 2 x log-likelihood:  -1188.1290 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb233"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a negative-binomial model (estimated using ML) to predict item_test_NABS with pretty_condition (formula: item_test_NABS ~ pretty_condition). The model's explanatory power is weak (Nagelkerke's R2 = 0.04). The model's intercept, corresponding to pretty_condition = control, is at 0.42 (95% CI [0.10, 0.77], p = 0.014). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.69, 95% CI [0.23, 1.14], p = 0.003; Std. beta = 0.69, 95% CI [0.23, 1.14])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb237"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb238"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#check model assumption</span>
<span class="co">#assumes conditional means are not equal to conditional variances</span>
<span class="co">#conduct likelihood ration test to compare and test [need poisson]</span>
<span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 4.3e-168 (df=3)</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb240"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span>


<span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span>
<span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb242"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#exponentiate parameter estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Exponentiated Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Exponentiated Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb244"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        Estimate 2.5 % 97.5 %
(Intercept)                 1.52  1.10   2.15
pretty_conditionimpasse     1.99  1.26   3.13</code></pre>
</div>
</div>
<p>The variable condition has a coefficient of 0.67, (p &lt; 0.005). This means that for the impasse condition, the expected log count # of questions increases by 0.67. By exponentiating the estimate we see that # question correct rate for the impasse condition is nearly 2x that of the control condition.</p>
<p><strong>Diagnostics</strong> ??</p>
</section><section id="zero-inflated-negative-binomial-regression" class="level4"><h4 class="anchored" data-anchor-id="zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</h4>
<p>https://stats.oarc.ucla.edu/r/dae/zinb/ count data that are overdispersed and have excess zeros</p>
<p>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the <em>excess</em> zeros can be modelled independently.</p>
<p>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different ‘process’ … (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) &lt;- this could maybe be disentangled by first question latency?</p>
<p>The model includes: - A logistic model to model which of the two processes the zero outcome is associated with - A negative binomial model to model the count process</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb246"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#  for zeroinfl negbinomial</span>

<span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span>
<span class="va">zinb.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">|</span> <span class="va">pretty_condition</span> , data <span class="op">=</span> <span class="va">df_subjects</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span>
<span class="co">#before the | is the count part, after the | is the logit model</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb248"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = item_test_NABS ~ pretty_condition | pretty_condition, 
    data = df_subjects, dist = "negbin")

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.866 -0.794 -0.538  0.856  2.294 

Count model coefficients (negbin with log link):
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               1.7126     0.0728   23.54  &lt; 2e-16 ***
pretty_conditionimpasse   0.0451     0.0880    0.51  0.60810    
Log(theta)                3.1851     0.8732    3.65  0.00026 ***

Zero-inflation model coefficients (binomial with logit link):
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                0.974      0.179    5.43  5.5e-08 ***
pretty_conditionimpasse   -1.056      0.236   -4.47  7.7e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta = 24.169 
Number of iterations in BFGS optimization: 7 
Log-likelihood: -532 on 5 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb250"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated negative-binomial model to predict item_test_NABS with pretty_condition (formula: item_test_NABS ~ pretty_condition). The model's explanatory power is substantial (R2 = 0.36, adj. R2 = 0.36). The model's intercept, corresponding to pretty_condition = control, is at 1.71 (95% CI [1.57, 1.86], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically non-significant and positive (beta = 0.05, 95% CI [-0.13, 0.22], p = 0.608; Std. beta = 0.05, 95% CI [-0.13, 0.22])
  - The effect of pretty condition [impasse] is statistically significant and negative (beta = -1.06, 95% CI [-1.52, -0.59], p &lt; .001; Std. beta = -1.06, 95% CI [-1.52, -0.59])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb253"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |      BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-------------------------------------------------------------------------------------
1073.880 | 1092.876 | 0.363 |     0.359 | 3.150 | 3.174 |    -1.649 |           0.043</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb255"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#   rootogram(zinb.1)</span>



<span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span>
<span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span>
<span class="co"># #exponentiate parameter estimates</span>
<span class="co"># print("Exponentiated Estimates")</span>
<span class="co"># exp(est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).</p>
<p>In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition (exponentiate it?)</p>
<p><strong>TODO come back to this and discuss further</strong><br></p>
</section><section id="model-comparison" class="level4"><h4 class="anchored" data-anchor-id="model-comparison">Model Comparison</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb256"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">lm.1</span>, <span class="va">p.1</span>, <span class="va">nb.1</span>, <span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name   |    Model |      AIC | AIC weights |      BIC | BIC weights |  RMSE | Sigma | Score_log | Score_spherical |    R2 | R2 (adj.) | Nagelkerke's R2
-------------------------------------------------------------------------------------------------------------------------------------------------------
lm.1   |       lm | 1699.782 |     &lt; 0.001 | 1711.179 |     &lt; 0.001 | 3.150 | 3.160 |           |                 | 0.053 |     0.051 |                
p.1    |      glm | 1955.788 |     &lt; 0.001 | 1963.386 |     &lt; 0.001 | 3.150 | 2.136 |    -2.957 |           0.042 |       |           |           0.223
nb.1   |   negbin | 1194.129 |     &lt; 0.001 | 1205.526 |     &lt; 0.001 | 3.150 | 0.909 |    -2.137 |           0.046 |       |           |           0.045
zinb.1 | zeroinfl | 1073.880 |        1.00 | 1092.876 |        1.00 | 3.150 | 3.174 |    -1.649 |           0.043 | 0.363 |     0.359 |                </code></pre>
</div>
</div>
<p>For modelling test phase absolute score (# items correct) it seems that the zero inflated negative binomial model is the best fit according to R2 and AIC, however, I am not clear on the implications of the interpretation (non significant in count process, significant on logit process), and also not clear if # items correct is truly a count process.</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb258"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#uncertainty model visualization</span>
<span class="co"># df %&gt;%</span>
  <span class="co"># data_grid(pretty_condition) %&gt;%</span>
  <span class="co"># augment(m, newdata = ., se_fit = TRUE) %&gt;%</span>
  <span class="co"># ggplot(aes(y = pretty_condition)) +</span>
  <span class="co"># stat_halfeye(</span>
  <span class="co">#   aes(xdist = dist_student_t(df = df.residual(m), </span>
  <span class="co">#       mu = .fitted, sigma = .se.fit)), scale = .5) +</span>
  <span class="co"># # add raw data in too (scale = .5 above adjusts the halfeye height so</span>
  <span class="co"># # that the data fit in as well)</span>
  <span class="co"># geom_jitter(aes(x = x), data = df, pch = "|", size = 2, </span>
  <span class="co">#             position =   position_nudge(y = -.15), alpha = 0.5) +  </span>
  <span class="co"># labs (title = "Model Estimates with Uncertainty", x = "model coefficient") + </span>
  <span class="co"># theme_minimal()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="hurlde-beta-regression" class="level4"><h4 class="anchored" data-anchor-id="hurlde-beta-regression">HURLDE BETA Regression</h4>
<p>https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb259"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.gamlss.com/">gamlss</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gamlss' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    sleep</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.dist</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gamlss.dist' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'nlme' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmList</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: parallel</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> **********   GAMLSS Version 5.4-3  ********** </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>For more on GAMLSS look at https://www.gamlss.com/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type gamlssNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    refit</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb277"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE SAMPLE DATA </span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span> 
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.40</span> 
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.60</span> 
<span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">0.13</span> 
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fl">0.17</span> 
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span> <span class="va">p0</span><span class="op">-</span> <span class="va">p1</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">sigma</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> 
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">/</span> <span class="va">mu</span>

<span class="co">#CREATE DIST</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1839</span><span class="op">)</span> 
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> 
<span class="va">cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/resample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">p0</span>, <span class="va">p2</span>, <span class="va">p1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="va">y</span><span class="op">[</span><span class="va">cat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> 
<span class="va">y</span><span class="op">[</span><span class="va">cat</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">x</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb278"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#this looks not unlike my distribution! </span>

<span class="co">#CREATE AN EMPTY MODEL</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for mu </span>
               formula.sigma <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for sigma </span>
               formula.nu <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for nu </span>
               formula.tau <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for tau </span>
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 7799 
GAMLSS-RS iteration 2: Global Deviance = 7778 
GAMLSS-RS iteration 3: Global Deviance = 7778 
GAMLSS-RS iteration 4: Global Deviance = 7778 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb280"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = y ~ 1, family = BEINF(), formula.sigma = ~1,  
    formula.nu = ~1, formula.tau = ~1) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.3796     0.0196   -19.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.3951     0.0162    24.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.632      0.042   -38.9   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -1.4014     0.0382   -36.7   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  5000 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  4996 
                      at cycle:  4 
 
Global Deviance:     7778 
            AIC:     7786 
            SBC:     7812 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb282"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.000571 
                       variance   =  1 
               coef. of skewness  =  0.0294 
               coef. of kurtosis  =  2.95 
Filliben correlation coefficient  =  1 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb284"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">fit_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">fit_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.406229902102452"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb286"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">fit_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.597499259410111"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb288"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="va">fit_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="va">fit_p0</span> <span class="op">&lt;-</span> <span class="va">fit_nu</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P0: "</span>,<span class="va">fit_p0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb290"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_p1</span> <span class="op">&lt;-</span> <span class="va">fit_tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P1: "</span>,<span class="va">fit_p1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
</div>
<p><strong>BETA HURDLE INTERPRETATION</strong> - beta component<br>
- MU “location” (mean)<br>
- SIGMA “scale” (positively related to variance; variance = sigma.squared <em>mean</em> (1-mean)<br>
- Rigby, Stasinopoulos, Heller, and De Bastiani (2017) “reparameterized” the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</p>
<p><strong>ZERO-ONE HURDLE COMPONENT</strong><br>
- The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.<br>
- p0 is the probability that a case equals 0,<br>
- p1 is the probability that a case equals 1,<br>
- p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb292"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA </span>

<span class="va">min</span> <span class="op">=</span> <span class="fl">0</span> <span class="co">#min possible value of scale</span>
<span class="va">max</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#max possible value of scale</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span> <span class="co">#for shuffling</span>
<span class="co">#1. Rescale accuracy using </span>
<span class="co"># recommended adjustment </span>
<span class="co">#rescaled = value-min/(max-min)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="va">item_test_NABS</span>,
  R_acc <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span><span class="op">-</span><span class="va">min</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">max</span><span class="op">-</span><span class="va">min</span><span class="op">)</span>, <span class="co">#as %</span>
  T_acc <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">8</span>, <span class="co">#transform for no 0 and 1</span>
  perm <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/resample.html">shuffle</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>,
  scaffold_rt <span class="op">=</span> <span class="va">item_scaffold_rt</span>
<span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accuracy</span>,<span class="va">R_acc</span>, <span class="va">T_acc</span>, <span class="va">condition</span>, <span class="va">perm</span>,<span class="va">scaffold_rt</span><span class="op">)</span>

<span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">R_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb293"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">T_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of [rescaled] accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb294"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">R_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">perm</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">perm</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of shuffled accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb295"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SUMMARIZE SAMPLE</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Grand mean"</span>, <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand mean 0.2875"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb297"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span>
<span class="va">stats</span> <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">var</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Grand stats"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand stats"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb299"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">stats</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  df$condition min Q1 median    Q3 max  mean    sd   n missing   var
1          111   0  0  0.000 0.125   1 0.190 0.358 158       0 0.128
2          121   0  0  0.125 0.875   1 0.377 0.426 172       0 0.182</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb301"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"P0"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb303"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb305"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"P1"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb307"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.136</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb309"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE MODEL</span>

<span class="co">#CREATE AN EMPTY MODEL</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">R_acc</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for mu </span>
              formula.sigma <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for sigma </span>
              formula.nu <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for nu </span>
              formula.tau <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for tau </span>
              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 610 
GAMLSS-RS iteration 2: Global Deviance = 609 
GAMLSS-RS iteration 3: Global Deviance = 609 
GAMLSS-RS iteration 4: Global Deviance = 609 
GAMLSS-RS iteration 5: Global Deviance = 609 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb311"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 610 
GAMLSS-RS iteration 2: Global Deviance = 609 
GAMLSS-RS iteration 3: Global Deviance = 609 
GAMLSS-RS iteration 4: Global Deviance = 609 
GAMLSS-RS iteration 5: Global Deviance = 609 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb313"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ 1, sigma.formula = ~1, nu.formula = ~1,  
    tau.formula = ~1, family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    0.225      0.113    1.98    0.048 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    0.177      0.100    1.76    0.079 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    0.822      0.129    6.39  5.7e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.660      0.184   -3.59  0.00038 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  326 
                      at cycle:  5 
 
Global Deviance:     609 
            AIC:     617 
            SBC:     632 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb315"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.0109 
                       variance   =  0.996 
               coef. of skewness  =  -0.0563 
               coef. of kurtosis  =  2.79 
Filliben correlation coefficient  =  0.998 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb317"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">m0_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">m0_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.555931874775555"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb319"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">m0_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.544134514840075"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb321"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"NU: "</span>,<span class="va">m0_nu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  2.27484150905293"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb323"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU: "</span>,<span class="va">m0_tau</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.517080427912532"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb325"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_p0</span> <span class="op">&lt;-</span> <span class="va">fit_nu</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P0: "</span>,<span class="va">m0_p0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb327"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_p1</span> <span class="op">&lt;-</span> <span class="va">fit_tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P1: "</span>,<span class="va">m0_p1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb329"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE PREDICTOR MODEL</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 588 
GAMLSS-RS iteration 2: Global Deviance = 587 
GAMLSS-RS iteration 3: Global Deviance = 587 
GAMLSS-RS iteration 4: Global Deviance = 587 
GAMLSS-RS iteration 5: Global Deviance = 587 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb331"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.144      0.203    0.71     0.48
condition121    0.124      0.244    0.51     0.61

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.280      0.174    1.61     0.11
condition121   -0.164      0.213   -0.77     0.44

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.377      0.208    6.63  1.4e-10 ***
condition121   -1.019      0.269   -3.79  0.00018 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    -0.729      0.325   -2.24    0.026 *
condition121    0.102      0.394    0.26    0.796  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  5 
 
Global Deviance:     587 
            AIC:     603 
            SBC:     633 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb333"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#LOOKING PREDICTOR MODEL</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 588 
GAMLSS-RS iteration 2: Global Deviance = 587 
GAMLSS-RS iteration 3: Global Deviance = 587 
GAMLSS-RS iteration 4: Global Deviance = 587 
GAMLSS-RS iteration 5: Global Deviance = 587 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb335"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.144      0.203    0.71     0.48
condition121    0.124      0.244    0.51     0.61

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.280      0.174    1.61     0.11
condition121   -0.164      0.213   -0.77     0.44

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.377      0.208    6.63  1.4e-10 ***
condition121   -1.019      0.269   -3.79  0.00018 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    -0.729      0.325   -2.24    0.026 *
condition121    0.102      0.394    0.26    0.796  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  5 
 
Global Deviance:     587 
            AIC:     603 
            SBC:     633 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb337"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION TEST]</span>
<span class="va">mperm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 609 
GAMLSS-RS iteration 2: Global Deviance = 608 
GAMLSS-RS iteration 3: Global Deviance = 608 
GAMLSS-RS iteration 4: Global Deviance = 608 
GAMLSS-RS iteration 5: Global Deviance = 608 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb339"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mperm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ perm, sigma.formula = ~perm,  
    nu.formula = ~perm, tau.formula = ~perm, family = BEINF(),      data = df) 


Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.1914     0.1706    1.12     0.26
perm121       0.0635     0.2278    0.28     0.78

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    0.237      0.148    1.60     0.11
perm121       -0.117      0.202   -0.58     0.56

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.8535     0.1887    4.52  8.6e-06 ***
perm121      -0.0595     0.2579   -0.23     0.82    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   -0.511      0.258   -1.98    0.048 *
perm121       -0.294      0.368   -0.80    0.425  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  5 
 
Global Deviance:     608 
            AIC:     624 
            SBC:     654 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb341"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#sanity check with scaled outcome, no zeros ones</span>
<span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">T_acc</span> <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = -1812 
GAMLSS-RS iteration 2: Global Deviance = -2024 
GAMLSS-RS iteration 3: Global Deviance = -2038 
GAMLSS-RS iteration 4: Global Deviance = -2040 
GAMLSS-RS iteration 5: Global Deviance = -2040 
GAMLSS-RS iteration 6: Global Deviance = -2040 
GAMLSS-RS iteration 7: Global Deviance = -2040 
GAMLSS-RS iteration 8: Global Deviance = -2040 
GAMLSS-RS iteration 9: Global Deviance = -2040 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb343"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.gamlss(m3): summary: vcov has failed, option qr is used instead</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = T_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition, family = BEINF(),  
    data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.1492     0.0981  -11.71  &lt; 2e-16 ***
condition121   0.5677     0.1411    4.02 0.000071 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    1.4399     0.0745   19.33   &lt;2e-16 ***
condition121   0.1694     0.1038    1.63      0.1    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -2.25e+01   3.78e+03   -0.01        1
condition121 -6.72e-15   5.24e+03    0.00        1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -2.26e+01   3.96e+03   -0.01        1
condition121  9.20e-15   5.48e+03    0.00        1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  9 
 
Global Deviance:     -2040 
            AIC:     -2024 
            SBC:     -1994 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb346"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span>

<span class="co">#investigate beta negative binomial distribution</span>
<span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span>

<span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">m1_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">m1_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.536038311159578" "MU:  0.531024352873784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb348"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">m1_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.544134514840075"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb350"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"NU: "</span>,<span class="va">m1_nu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  3.96329406964311"  "NU:  0.360974858677686"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb352"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU: "</span>,<span class="va">m1_tau</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.482542801248665" "TAU:  1.10746276561553" </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb354"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.144      0.203    0.71     0.48
condition121    0.124      0.244    0.51     0.61

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.280      0.174    1.61     0.11
condition121   -0.164      0.213   -0.77     0.44

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.377      0.208    6.63  1.4e-10 ***
condition121   -1.019      0.269   -3.79  0.00018 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    -0.729      0.325   -2.24    0.026 *
condition121    0.102      0.394    0.26    0.796  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  5 
 
Global Deviance:     587 
            AIC:     603 
            SBC:     633 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb356"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  -0.00363 
                       variance   =  1.04 
               coef. of skewness  =  -0.0633 
               coef. of kurtosis  =  3.03 
Filliben correlation coefficient  =  0.999 
******************************************************************</code></pre>
</div>
</div>
<ul>
<li>MU tells if mean is different by condition<br>
</li>
<li>SIGMA tells if variance is different by condition<br>
</li>
<li>NU coefficient tells if condition yields different probability at floor</li>
<li>TAU coefficient tells if condition yields different probability at ceiling</li>
</ul></section><section id="beta-regression-correct" class="level4"><h4 class="anchored" data-anchor-id="beta-regression-correct">Beta Regression (% Correct)</h4>
<p>Beta regression on % correct (with standard transformation for including [0,1]) https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb358"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betareg</span><span class="op">)</span>

<span class="co">#RESCLAE VARIABLE</span>
<span class="co">#beta reg can't handle 0s and 1s </span>
<span class="va">sub</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">DV_percent_NABS</span><span class="op">)</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">sub</span><span class="op">$</span><span class="va">dv_transformed</span> <span class="op">=</span> <span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">DV_percent_NABS</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>
 
<span class="co">#VISUALIZE VARIABLES</span>
<span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/xhistogram.html">histogram</a></span><span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">dv_transformed</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb359"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">dv_transformed</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">sub</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb360"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT MODEL</span>
<span class="va">mb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">dv_transformed</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = dv_transformed ~ condition, data = sub)

Standardized weighted residuals 2:
   Min     1Q Median     3Q    Max 
-1.057 -0.453 -0.216  0.541  1.690 

Coefficients (mean model with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -0.969      0.108   -8.97   &lt;2e-16 ***
condition121    0.556      0.143    3.89   0.0001 ***

Phi coefficients (precision model with identity link):
      Estimate Std. Error z value Pr(&gt;|z|)    
(phi)   0.6604     0.0425    15.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood:  506 on 3 Df
Pseudo R-squared: 0.0725
Number of iterations: 12 (BFGS) + 1 (Fisher scoring) </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb362"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-33-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-33-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-33-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="wip-hurdle-model" class="level4"><h4 class="anchored" data-anchor-id="wip-hurdle-model">WIP | HURDLE MODEL</h4>
<ul>
<li>https://data.library.virginia.edu/getting-started-with-hurdle-models/<br>
</li>
<li>https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.</li>
</ul>
<p>class of models for count data with both overdispersion and excess zeros;<br>
different from zero-inflated models where the excess zeros are theorized to arise from two different processes; in the hurdle model, there is a model for P(x=0) and a separate model for P(x!=0)</p>
<p>The model includes: - A binary logit model to model whether the observation takes a positive count or not. - a truncated Poisson or Negative binomial model that only fits positive counts</p>
<p>This allows us to model: (1) Does the student get <em>any</em> questions right? (2) How many questions does the student get right?</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb363"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zero-inf and hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">countreg</span><span class="op">)</span> <span class="co">#rootogram</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'countreg':
  method                 from
  print.zeroinfl         pscl
  print.summary.zeroinfl pscl
  summary.zeroinfl       pscl
  coef.zeroinfl          pscl
  vcov.zeroinfl          pscl
  logLik.zeroinfl        pscl
  predict.zeroinfl       pscl
  residuals.zeroinfl     pscl
  fitted.zeroinfl        pscl
  terms.zeroinfl         pscl
  model.matrix.zeroinfl  pscl
  extractAIC.zeroinfl    pscl
  print.hurdle           pscl
  print.summary.hurdle   pscl
  summary.hurdle         pscl
  coef.hurdle            pscl
  vcov.hurdle            pscl
  logLik.hurdle          pscl
  predict.hurdle         pscl
  residuals.hurdle       pscl
  fitted.hurdle          pscl
  terms.hurdle           pscl
  model.matrix.hurdle    pscl
  extractAIC.hurdle      pscl</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'countreg'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    dzipois, pzipois, qzipois, rzipois</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:pscl':

    hurdle, hurdle.control, hurdletest, zeroinfl, zeroinfl.control</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    rootogram</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb369"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span>

<span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span>

<span class="va">h.1</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df_subjects</span>,
              zero.dist <span class="op">=</span> <span class="st">"binomial"</span>, dist <span class="op">=</span> <span class="st">"poisson"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = zeroDist, gr = zeroGrad, par = c(start$zero, if (zero.dist
== : unknown names in control: size</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb372"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">h.2</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df_subjects</span>,
              zero.dist <span class="op">=</span> <span class="st">"binomial"</span>, dist <span class="op">=</span> <span class="st">"negbin"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size

Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb374"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">h.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = item_test_NABS ~ condition | condition, data = df_subjects, 
    dist = "poisson", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.892 -0.818 -0.549  0.881  2.342 

Count model coefficients (truncated poisson with log link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    1.7156     0.0653   26.29   &lt;2e-16 ***
condition121   0.0447     0.0789    0.57     0.57    
Zero hurdle model coefficients (binomial with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -0.984      0.179   -5.50  3.7e-08 ***
condition121    1.054      0.235    4.48  7.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 10 
Log-likelihood: -533 on 4 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb376"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = item_test_NABS ~ condition | condition, data = df_subjects, 
    dist = "negbin", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.866 -0.794 -0.538  0.856  2.294 

Count model coefficients (truncated negbin with log link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    1.7126     0.0728   23.54  &lt; 2e-16 ***
condition121   0.0451     0.0880    0.51  0.60810    
Log(theta)     3.1851     0.8732    3.65  0.00026 ***
Zero hurdle model coefficients (binomial with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -0.984      0.179   -5.50  3.7e-08 ***
condition121    1.054      0.235    4.48  7.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta: count = 24.169
Number of iterations in BFGS optimization: 20 
Log-likelihood: -532 on 5 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb378"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/countreg/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">h.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb379"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/countreg/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="x_learning_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb380"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">h.1</span>,<span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name |  Model |      AIC | AIC weights |      BIC | BIC weights |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
---------------------------------------------------------------------------------------------------------------------------------
h.1  | hurdle | 1073.583 |       0.537 | 1088.780 |       0.886 | 0.351 |     0.347 | 3.150 | 3.169 |    -2.479 |           0.043
h.2  | hurdle | 1073.880 |       0.463 | 1092.876 |       0.114 | 0.363 |     0.359 | 3.150 | 3.174 |    -2.132 |           0.043</code></pre>
</div>
</div>
</section></section><section id="wip-unknown" class="level2"><h2 class="anchored" data-anchor-id="wip-unknown">WIP UNKNOWN</h2>
<section id="cummulative-ordinal-bayesian" class="level3"><h3 class="anchored" data-anchor-id="cummulative-ordinal-bayesian">Cummulative Ordinal (Bayesian)</h3>
<p>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb382"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># library(brms)</span>


<span class="co"># #DEFINE DATA </span>
<span class="co"># df &lt;- df_items %&gt;% mutate(</span>
<span class="co">#   scaled = factor(score_SCALED, ordered = TRUE,  #ordered factor</span>
<span class="co">#                     levels = c("-1", "-0.5", "0", "0.5","1"))</span>
<span class="co"># )</span>
<span class="co"># </span>
<span class="co"># ord_cum &lt;- brm( formula = scaled ~ condition,</span>
<span class="co">#                data = df,</span>
<span class="co">#                family = cumulative("probit"),</span>
<span class="co">#                file = "analysis/SGC3A/models/m_items_ord.cum.rds" # cache model (can be removed)  </span>
<span class="co"># </span>
<span class="co"># )</span>
<span class="co"># </span>
<span class="co"># summary(ord_cum)</span>
<span class="co"># conditional_effects(ord_cum, "condition", categorical = TRUE)</span>
<span class="co"># </span>
<span class="co"># #SJPLOT</span>
<span class="co"># library(sjPlot)</span>
<span class="co"># plot_model(ord_cum)</span>
<span class="co"># </span>
<span class="co"># # m %&gt;%</span>
<span class="co"># #   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co"># #   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co"># #   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co"># #   stat_halfeye()</span>
<span class="co"># </span>
<span class="co"># # performance(ord_cum)</span>
<span class="co"># # plot(ord_cum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="adjacent-category-ordinal-bayesian" class="level3"><h3 class="anchored" data-anchor-id="adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</h3>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb383"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># </span>
<span class="co"># #DEFINE DATA </span>
<span class="co"># df &lt;- df_items %&gt;% mutate(</span>
<span class="co">#   scaled = factor(score_SCALED, ordered = TRUE,  #ordered factor</span>
<span class="co">#                     levels = c("-1", "-0.5", "0", "0.5","1"))</span>
<span class="co"># )</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span>
<span class="co"># </span>
<span class="co"># ord_acat &lt;- brm( formula = scaled ~ cs(condition),</span>
<span class="co">#                data = df,</span>
<span class="co">#                family = acat("probit"),</span>
<span class="co">#                file = "analysis/SGC3A/models/m_items_ord.acat.rds" # cache model (can be removed)  </span>
<span class="co"># )</span>
<span class="co"># </span>
<span class="co"># summary(ord_acat)</span>
<span class="co"># conditional_effects(ord_cum, "condition", categorical = TRUE)</span>
<span class="co"># conditional_effects(ord_acat, "condition", categorical = TRUE)</span>
<span class="co"># </span>
<span class="co"># #TIDYBAYES VISUALIZATION</span>
<span class="co"># library(tidybayes)</span>
<span class="co"># ord_acat %&gt;%</span>
<span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co">#   stat_halfeye()</span>
<span class="co"># </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../analysis/utils/scoring.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Scoring Strategy</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb384" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'SGCX | Modelling Reference'</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modelling Reference {#modelling .unnumbered}</span></span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a>**In this notebook we use data from study SGC3A to explore different modelling techniques and assess their suitability for the bimodal accuracy distributions.**</span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-11"><a href="#cb384-11" aria-hidden="true" tabindex="-1"></a>+---------------------+</span>
<span id="cb384-12"><a href="#cb384-12" aria-hidden="true" tabindex="-1"></a>| Pre-Requisite       |</span>
<span id="cb384-13"><a href="#cb384-13" aria-hidden="true" tabindex="-1"></a>+=====================+</span>
<span id="cb384-14"><a href="#cb384-14" aria-hidden="true" tabindex="-1"></a>| 2_sgc3A_scoring.qmd |</span>
<span id="cb384-15"><a href="#cb384-15" aria-hidden="true" tabindex="-1"></a>+---------------------+</span>
<span id="cb384-16"><a href="#cb384-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-19"><a href="#cb384-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-20"><a href="#cb384-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb384-21"><a href="#cb384-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb384-22"><a href="#cb384-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb384-23"><a href="#cb384-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-24"><a href="#cb384-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb384-25"><a href="#cb384-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-26"><a href="#cb384-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#arrange plots</span></span>
<span id="cb384-27"><a href="#cb384-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange shift function plots</span></span>
<span id="cb384-28"><a href="#cb384-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb384-29"><a href="#cb384-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd) <span class="co">#mosaic plots</span></span>
<span id="cb384-30"><a href="#cb384-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra) <span class="co">#mosaic plots</span></span>
<span id="cb384-31"><a href="#cb384-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables </span></span>
<span id="cb384-32"><a href="#cb384-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb384-33"><a href="#cb384-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-34"><a href="#cb384-34" aria-hidden="true" tabindex="-1"></a><span class="co">#plot model estimates with uncertainty</span></span>
<span id="cb384-35"><a href="#cb384-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb384-36"><a href="#cb384-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb384-37"><a href="#cb384-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb384-38"><a href="#cb384-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb384-39"><a href="#cb384-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-40"><a href="#cb384-40" aria-hidden="true" tabindex="-1"></a><span class="co">#models and performance</span></span>
<span id="cb384-41"><a href="#cb384-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb384-42"><a href="#cb384-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots w/ embedded stats</span></span>
<span id="cb384-43"><a href="#cb384-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb384-44"><a href="#cb384-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb384-45"><a href="#cb384-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb384-46"><a href="#cb384-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr) <span class="co">#confint on qq plot</span></span>
<span id="cb384-47"><a href="#cb384-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels) <span class="co">#contingency table and CHISQR</span></span>
<span id="cb384-48"><a href="#cb384-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic) <span class="co">#extract model equation</span></span>
<span id="cb384-49"><a href="#cb384-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zeroinfl / hurdle models </span></span>
<span id="cb384-50"><a href="#cb384-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models </span></span>
<span id="cb384-51"><a href="#cb384-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects) <span class="co">#visualization log regr models</span></span>
<span id="cb384-52"><a href="#cb384-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-53"><a href="#cb384-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb384-54"><a href="#cb384-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-55"><a href="#cb384-55" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb384-56"><a href="#cb384-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb384-57"><a href="#cb384-57" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb384-58"><a href="#cb384-58" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb384-59"><a href="#cb384-59" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb384-60"><a href="#cb384-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-61"><a href="#cb384-61" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb384-62"><a href="#cb384-62" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>()) </span>
<span id="cb384-63"><a href="#cb384-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-64"><a href="#cb384-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-65"><a href="#cb384-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-68"><a href="#cb384-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-69"><a href="#cb384-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb384-70"><a href="#cb384-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb384-71"><a href="#cb384-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb384-72"><a href="#cb384-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-73"><a href="#cb384-73" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb384-74"><a href="#cb384-74" aria-hidden="true" tabindex="-1"></a><span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb384-75"><a href="#cb384-75" aria-hidden="true" tabindex="-1"></a><span class="co"># mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb384-76"><a href="#cb384-76" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd(mbp)</span></span>
<span id="cb384-77"><a href="#cb384-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-78"><a href="#cb384-78" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb384-79"><a href="#cb384-79" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span>)</span>
<span id="cb384-80"><a href="#cb384-80" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span>)</span>
<span id="cb384-81"><a href="#cb384-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-82"><a href="#cb384-82" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb384-83"><a href="#cb384-83" aria-hidden="true" tabindex="-1"></a>df_lab <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_mode <span class="sc">==</span> <span class="st">"laboratory"</span>)</span>
<span id="cb384-84"><a href="#cb384-84" aria-hidden="true" tabindex="-1"></a>df_online <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_mode <span class="sc">==</span> <span class="st">"online-replication"</span>)</span>
<span id="cb384-85"><a href="#cb384-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-86"><a href="#cb384-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-87"><a href="#cb384-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-88"><a href="#cb384-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## SINGLE ITEM LEVEL</span></span>
<span id="cb384-89"><a href="#cb384-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-90"><a href="#cb384-90" aria-hidden="true" tabindex="-1"></a>**Q1 Absolute, Interpretation Scores**</span>
<span id="cb384-91"><a href="#cb384-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-94"><a href="#cb384-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-95"><a href="#cb384-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1ACC</span></span>
<span id="cb384-96"><a href="#cb384-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-97"><a href="#cb384-97" aria-hidden="true" tabindex="-1"></a><span class="co">#FILTER THE DATASET [use subjects, bc it has covariates on that record]</span></span>
<span id="cb384-98"><a href="#cb384-98" aria-hidden="true" tabindex="-1"></a>df_q1 <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb384-99"><a href="#cb384-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(item_q1_NABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb384-100"><a href="#cb384-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt =</span> item_q1_rt</span>
<span id="cb384-101"><a href="#cb384-101" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb384-102"><a href="#cb384-102" aria-hidden="true" tabindex="-1"></a>  accuracy, rt, pretty_condition, pretty_mode</span>
<span id="cb384-103"><a href="#cb384-103" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb384-104"><a href="#cb384-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-105"><a href="#cb384-105" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb384-106"><a href="#cb384-106" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~accuracy, fill = ~pretty_condition, </span></span>
<span id="cb384-107"><a href="#cb384-107" aria-hidden="true" tabindex="-1"></a><span class="co">#        position = position_dodge(), data = df_q1) %&gt;% </span></span>
<span id="cb384-108"><a href="#cb384-108" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_mode) +</span></span>
<span id="cb384-109"><a href="#cb384-109" aria-hidden="true" tabindex="-1"></a><span class="co">#    labs(x = "Correct Response on Q 1",</span></span>
<span id="cb384-110"><a href="#cb384-110" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Accuracy on First Question by Condition",</span></span>
<span id="cb384-111"><a href="#cb384-111" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses") #theme(legend.position = "none")</span></span>
<span id="cb384-112"><a href="#cb384-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-113"><a href="#cb384-113" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED BAR CHART</span></span>
<span id="cb384-114"><a href="#cb384-114" aria-hidden="true" tabindex="-1"></a>df_q1 <span class="sc">%&gt;%</span> </span>
<span id="cb384-115"><a href="#cb384-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb384-116"><a href="#cb384-116" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb384-117"><a href="#cb384-117" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb384-118"><a href="#cb384-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb384-119"><a href="#cb384-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb384-120"><a href="#cb384-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb384-121"><a href="#cb384-121" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb384-122"><a href="#cb384-122" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb384-123"><a href="#cb384-123" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb384-124"><a href="#cb384-124" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb384-125"><a href="#cb384-125" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb384-126"><a href="#cb384-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-127"><a href="#cb384-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-128"><a href="#cb384-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-129"><a href="#cb384-129" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHI SQUARE</span></span>
<span id="cb384-130"><a href="#cb384-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-131"><a href="#cb384-131" aria-hidden="true" tabindex="-1"></a><span class="fu">#### (Combined)</span></span>
<span id="cb384-132"><a href="#cb384-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-135"><a href="#cb384-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-136"><a href="#cb384-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-Q1TRI.by.COND-BOTH</span></span>
<span id="cb384-137"><a href="#cb384-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-138"><a href="#cb384-138" aria-hidden="true" tabindex="-1"></a><span class="co">#combined dataset </span></span>
<span id="cb384-139"><a href="#cb384-139" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_q1 </span>
<span id="cb384-140"><a href="#cb384-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-141"><a href="#cb384-141" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb384-142"><a href="#cb384-142" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb384-143"><a href="#cb384-143" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb384-144"><a href="#cb384-144" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, pretty_condition <span class="sc">~</span> accuracy, <span class="at">shade =</span> T, <span class="at">color =</span> <span class="dv">2</span>)</span>
<span id="cb384-145"><a href="#cb384-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-146"><a href="#cb384-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-147"><a href="#cb384-147" aria-hidden="true" tabindex="-1"></a><span class="co"># CrossTable( x = df$condition, y = df$accuracy, fisher = TRUE, chisq=TRUE, expected = TRUE, sresid = TRUE)</span></span>
<span id="cb384-148"><a href="#cb384-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-149"><a href="#cb384-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-150"><a href="#cb384-150" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb384-151"><a href="#cb384-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb384-152"><a href="#cb384-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb384-153"><a href="#cb384-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb384-154"><a href="#cb384-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-155"><a href="#cb384-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-156"><a href="#cb384-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-157"><a href="#cb384-157" aria-hidden="true" tabindex="-1"></a>**Combining data across both sessions** (n=330), a Pearson's Chi-squared test suggests a statistically significant relationship between response accuracy on the first question and experimental condition, $\chi_2$ (1) = 10.3, p = 0.001. The sample odds ratio (2.46, p = 0.001, 95% CI <span class="sc">\[</span>1.37, 4.53<span class="sc">\]</span>) indicates that the odds of providing a correct response to the first question are 2.46 higher for subjects in the impasse condition than those in the control condition.</span>
<span id="cb384-158"><a href="#cb384-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-159"><a href="#cb384-159" aria-hidden="true" tabindex="-1"></a><span class="fu">#### (In Person)</span></span>
<span id="cb384-160"><a href="#cb384-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-163"><a href="#cb384-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-164"><a href="#cb384-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-Q1TRI.by.COND-LAB</span></span>
<span id="cb384-165"><a href="#cb384-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-166"><a href="#cb384-166" aria-hidden="true" tabindex="-1"></a><span class="co">#lab only</span></span>
<span id="cb384-167"><a href="#cb384-167" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_q1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_mode <span class="sc">==</span> <span class="st">"laboratory"</span>)</span>
<span id="cb384-168"><a href="#cb384-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-169"><a href="#cb384-169" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb384-170"><a href="#cb384-170" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb384-171"><a href="#cb384-171" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb384-172"><a href="#cb384-172" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, pretty_condition <span class="sc">~</span> accuracy, </span>
<span id="cb384-173"><a href="#cb384-173" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb384-174"><a href="#cb384-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-175"><a href="#cb384-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-176"><a href="#cb384-176" aria-hidden="true" tabindex="-1"></a><span class="co"># CrossTable( x = df$condition, y = df$score_niceABS, </span></span>
<span id="cb384-177"><a href="#cb384-177" aria-hidden="true" tabindex="-1"></a><span class="co">#             fisher = TRUE, chisq=TRUE, expected = TRUE, sresid = TRUE)</span></span>
<span id="cb384-178"><a href="#cb384-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-179"><a href="#cb384-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-180"><a href="#cb384-180" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb384-181"><a href="#cb384-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb384-182"><a href="#cb384-182" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb384-183"><a href="#cb384-183" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb384-184"><a href="#cb384-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-185"><a href="#cb384-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-186"><a href="#cb384-186" aria-hidden="true" tabindex="-1"></a>**For (In Person) data collection** (n=126) the Pearson's Chi-squared test (of independence) indicates a relationship between response accuracy on the first question and experimental condition that is not significant at the alpha level 0.05, $\chi^2$ (1) = 10.3, p = 0.07. Thus we have insufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. In this particular data sample, the odds ratio (Odds Ratio = 2.18, p = 0.055, 95% CI <span class="sc">\[</span>0.982, +Inf<span class="sc">\]</span>) indicates that the odds of producing a correct response on the first question were 2.18 times greater if a subject was in the impasse condition, than in the control condition .</span>
<span id="cb384-187"><a href="#cb384-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-188"><a href="#cb384-188" aria-hidden="true" tabindex="-1"></a><span class="fu">#### (Online Replication)</span></span>
<span id="cb384-189"><a href="#cb384-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-192"><a href="#cb384-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-193"><a href="#cb384-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-Q1TRI.by.COND-ONLINE</span></span>
<span id="cb384-194"><a href="#cb384-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-195"><a href="#cb384-195" aria-hidden="true" tabindex="-1"></a><span class="co">#online only</span></span>
<span id="cb384-196"><a href="#cb384-196" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_q1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_mode <span class="sc">==</span> <span class="st">"online-replication"</span>)</span>
<span id="cb384-197"><a href="#cb384-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-198"><a href="#cb384-198" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb384-199"><a href="#cb384-199" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb384-200"><a href="#cb384-200" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb384-201"><a href="#cb384-201" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, pretty_condition <span class="sc">~</span> accuracy, <span class="at">shade =</span> T)</span>
<span id="cb384-202"><a href="#cb384-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-203"><a href="#cb384-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-204"><a href="#cb384-204" aria-hidden="true" tabindex="-1"></a><span class="co"># CrossTable( x = df$condition, y = df$score_niceABS, fisher = TRUE, </span></span>
<span id="cb384-205"><a href="#cb384-205" aria-hidden="true" tabindex="-1"></a><span class="co">#             chisq=TRUE, expected = TRUE, sresid = TRUE)</span></span>
<span id="cb384-206"><a href="#cb384-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-207"><a href="#cb384-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-208"><a href="#cb384-208" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb384-209"><a href="#cb384-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb384-210"><a href="#cb384-210" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb384-211"><a href="#cb384-211" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb384-212"><a href="#cb384-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-213"><a href="#cb384-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-214"><a href="#cb384-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-215"><a href="#cb384-215" aria-hidden="true" tabindex="-1"></a>**For online data collection** (n=204), a Pearson's Chi-squared test (of independence) indicates a statistically significant relationship between response accuracy on the first question and experimental condition, $\chi^2$ (1) = 7.26, p = 0.009. Thus we have sufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. The odds ratio (Odds Ratio = 2.68, p = 0.005, 95% CI <span class="sc">\[</span>1.37, +Inf<span class="sc">\]</span>) indicates that the odds of producing a correct response on the first question were 2.68 times greater if a subject was in the impasse condition, than in the control condition .</span>
<span id="cb384-216"><a href="#cb384-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-217"><a href="#cb384-217" aria-hidden="true" tabindex="-1"></a><span class="fu">### LOGISTIC REGRESSION</span></span>
<span id="cb384-218"><a href="#cb384-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-219"><a href="#cb384-219" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression (at the subject level), predicting Q1 accuracy (absolute score) by condition.*</span>
<span id="cb384-220"><a href="#cb384-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-221"><a href="#cb384-221" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb384-222"><a href="#cb384-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-223"><a href="#cb384-223" aria-hidden="true" tabindex="-1"></a>*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*</span>
<span id="cb384-224"><a href="#cb384-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-227"><a href="#cb384-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-228"><a href="#cb384-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-Q1ACC-LOG-combined</span></span>
<span id="cb384-229"><a href="#cb384-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb384-230"><a href="#cb384-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb384-231"><a href="#cb384-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-232"><a href="#cb384-232" aria-hidden="true" tabindex="-1"></a><span class="co">#combined</span></span>
<span id="cb384-233"><a href="#cb384-233" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb384-234"><a href="#cb384-234" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS)</span>
<span id="cb384-235"><a href="#cb384-235" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb384-236"><a href="#cb384-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-237"><a href="#cb384-237" aria-hidden="true" tabindex="-1"></a><span class="co"># FREQUENCY TABLE</span></span>
<span id="cb384-238"><a href="#cb384-238" aria-hidden="true" tabindex="-1"></a><span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span></span>
<span id="cb384-239"><a href="#cb384-239" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(my.table) #counts</span></span>
<span id="cb384-240"><a href="#cb384-240" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(prop.table(my.table)) #props</span></span>
<span id="cb384-241"><a href="#cb384-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-242"><a href="#cb384-242" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb384-243"><a href="#cb384-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-244"><a href="#cb384-244" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb384-245"><a href="#cb384-245" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb384-246"><a href="#cb384-246" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"EMPTY MODEL"</span>)</span>
<span id="cb384-247"><a href="#cb384-247" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb384-248"><a href="#cb384-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-249"><a href="#cb384-249" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb384-250"><a href="#cb384-250" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb384-251"><a href="#cb384-251" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb384-252"><a href="#cb384-252" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb384-253"><a href="#cb384-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-254"><a href="#cb384-254" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb384-255"><a href="#cb384-255" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span>
<span id="cb384-256"><a href="#cb384-256" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb384-257"><a href="#cb384-257" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb384-258"><a href="#cb384-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-259"><a href="#cb384-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-260"><a href="#cb384-260" aria-hidden="true" tabindex="-1"></a>*The Condition predictor significantly improves model fit.*</span>
<span id="cb384-261"><a href="#cb384-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-262"><a href="#cb384-262" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Learning Notes</span></span>
<span id="cb384-263"><a href="#cb384-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-266"><a href="#cb384-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-267"><a href="#cb384-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-Q1ACC-LOG-combined</span></span>
<span id="cb384-268"><a href="#cb384-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-269"><a href="#cb384-269" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb384-270"><a href="#cb384-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-271"><a href="#cb384-271" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb384-272"><a href="#cb384-272" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb384-273"><a href="#cb384-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-274"><a href="#cb384-274" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb384-275"><a href="#cb384-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-276"><a href="#cb384-276" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- LOG ODDS"</span>)</span>
<span id="cb384-277"><a href="#cb384-277" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span>
<span id="cb384-278"><a href="#cb384-278" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span>
<span id="cb384-279"><a href="#cb384-279" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(<span class="fu">confint</span>(m1))) <span class="co">#exponentiate</span></span>
<span id="cb384-280"><a href="#cb384-280" aria-hidden="true" tabindex="-1"></a>e</span>
<span id="cb384-281"><a href="#cb384-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-282"><a href="#cb384-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-283"><a href="#cb384-283" aria-hidden="true" tabindex="-1"></a>**Understanding the logistic regression model**</span>
<span id="cb384-284"><a href="#cb384-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-285"><a href="#cb384-285" aria-hidden="true" tabindex="-1"></a>*The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable*</span>
<span id="cb384-286"><a href="#cb384-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-287"><a href="#cb384-287" aria-hidden="true" tabindex="-1"></a>*The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.*</span>
<span id="cb384-288"><a href="#cb384-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-289"><a href="#cb384-289" aria-hidden="true" tabindex="-1"></a>**\[the empty model**</span>
<span id="cb384-290"><a href="#cb384-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-291"><a href="#cb384-291" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercept of an empty model (glm(accuracy \~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df\$accuracy ==1 ).</span>
<span id="cb384-292"><a href="#cb384-292" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -<span class="sc">\&gt;</span> log(0.215 / (1-0.215)) = -1.29.</span>
<span id="cb384-293"><a href="#cb384-293" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</span>
<span id="cb384-294"><a href="#cb384-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</span>
<span id="cb384-295"><a href="#cb384-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-296"><a href="#cb384-296" aria-hidden="true" tabindex="-1"></a>**\[a dichotomous predictor\]**</span>
<span id="cb384-297"><a href="#cb384-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-298"><a href="#cb384-298" aria-hidden="true" tabindex="-1"></a>natural log (odds of +) = -1.822 + 0.901(x1) ; x1 = 0 for control, 1 for impasse</span>
<span id="cb384-299"><a href="#cb384-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-300"><a href="#cb384-300" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>INTERCEPT: log odds of (+ response) in control condition</span>
<span id="cb384-301"><a href="#cb384-301" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</span>
<span id="cb384-302"><a href="#cb384-302" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating the coefficients\</span>
<span id="cb384-303"><a href="#cb384-303" aria-hidden="true" tabindex="-1"></a>        log odds of (+) in control = exp(-1.822) = 0.162 odds</span>
<span id="cb384-304"><a href="#cb384-304" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb384-305"><a href="#cb384-305" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139\</span>
<span id="cb384-306"><a href="#cb384-306" aria-hidden="true" tabindex="-1"></a>        probability of (+) in control = \~14%</span>
<span id="cb384-307"><a href="#cb384-307" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs. control</span>
<span id="cb384-308"><a href="#cb384-308" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</span>
<span id="cb384-309"><a href="#cb384-309" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating log odds\</span>
<span id="cb384-310"><a href="#cb384-310" aria-hidden="true" tabindex="-1"></a>        log odds (+) in impasse = exp(-0.921) = 0.398</span>
<span id="cb384-311"><a href="#cb384-311" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb384-312"><a href="#cb384-312" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285\</span>
<span id="cb384-313"><a href="#cb384-313" aria-hidden="true" tabindex="-1"></a>        probaility of (+) in impasse = \~ 29%</span>
<span id="cb384-314"><a href="#cb384-314" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ODDS RATIO : exponentiated B1 COEFFICIENT</span>
<span id="cb384-315"><a href="#cb384-315" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = (slope of logit model = difference in log odds = log odds ratio</span>
<span id="cb384-316"><a href="#cb384-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-317"><a href="#cb384-317" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = 0.901 is log odds ratio of (+) in impasse vs control</span>
<span id="cb384-318"><a href="#cb384-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-319"><a href="#cb384-319" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>exp(b1) = exp(0.901) = 2.46</span>
<span id="cb384-320"><a href="#cb384-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-321"><a href="#cb384-321" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</span>
<span id="cb384-322"><a href="#cb384-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-323"><a href="#cb384-323" aria-hidden="true" tabindex="-1"></a>+:----------------------------------------------------------------------+</span>
<span id="cb384-324"><a href="#cb384-324" aria-hidden="true" tabindex="-1"></a>| MARGINAL\                                                             |</span>
<span id="cb384-325"><a href="#cb384-325" aria-hidden="true" tabindex="-1"></a>| total = 330 success : 71, failure : 259\                              |</span>
<span id="cb384-326"><a href="#cb384-326" aria-hidden="true" tabindex="-1"></a>| p(+) = 71 / 330 = 0.215 = 22%\                                        |</span>
<span id="cb384-327"><a href="#cb384-327" aria-hidden="true" tabindex="-1"></a>| odds(+) = 71 / 259 = 0.274                                            |</span>
<span id="cb384-328"><a href="#cb384-328" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb384-329"><a href="#cb384-329" aria-hidden="true" tabindex="-1"></a>| CONTROL total = 158 success = 22; failure = 136\                      |</span>
<span id="cb384-330"><a href="#cb384-330" aria-hidden="true" tabindex="-1"></a>| p(+) = 22/158 = 0.139 = 14%\                                          |</span>
<span id="cb384-331"><a href="#cb384-331" aria-hidden="true" tabindex="-1"></a>| odds(+) = 22/136 = 0.162                                              |</span>
<span id="cb384-332"><a href="#cb384-332" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb384-333"><a href="#cb384-333" aria-hidden="true" tabindex="-1"></a>| IMPASSE total = 172 success = 49; failure = 123\                      |</span>
<span id="cb384-334"><a href="#cb384-334" aria-hidden="true" tabindex="-1"></a>| p(+) = 49/172 = 0.285 = 29%\                                          |</span>
<span id="cb384-335"><a href="#cb384-335" aria-hidden="true" tabindex="-1"></a>| odds(+) = 49/123 = 0.398                                              |</span>
<span id="cb384-336"><a href="#cb384-336" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb384-337"><a href="#cb384-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-338"><a href="#cb384-338" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb384-339"><a href="#cb384-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-342"><a href="#cb384-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-343"><a href="#cb384-343" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb384-344"><a href="#cb384-344" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb384-345"><a href="#cb384-345" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb384-346"><a href="#cb384-346" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m1)</span>
<span id="cb384-347"><a href="#cb384-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-348"><a href="#cb384-348" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span>
<span id="cb384-349"><a href="#cb384-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb384-350"><a href="#cb384-350" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb384-351"><a href="#cb384-351" aria-hidden="true" tabindex="-1"></a>p.control <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"control"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb384-352"><a href="#cb384-352" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in control,"</span>, p.control)</span>
<span id="cb384-353"><a href="#cb384-353" aria-hidden="true" tabindex="-1"></a>p.impasse <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"impasse"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb384-354"><a href="#cb384-354" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in impasse,"</span>, p.impasse)</span>
<span id="cb384-355"><a href="#cb384-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-356"><a href="#cb384-356" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb384-357"><a href="#cb384-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-358"><a href="#cb384-358" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb384-359"><a href="#cb384-359" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggstatsplot)</span></span>
<span id="cb384-360"><a href="#cb384-360" aria-hidden="true" tabindex="-1"></a><span class="co"># ggcoefstats(m1, output = "plot") + labs(x = "Log Odds Estimate")</span></span>
<span id="cb384-361"><a href="#cb384-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-362"><a href="#cb384-362" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb384-363"><a href="#cb384-363" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb384-364"><a href="#cb384-364" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb384-365"><a href="#cb384-365" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb384-366"><a href="#cb384-366" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb384-367"><a href="#cb384-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb384-368"><a href="#cb384-368" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb384-369"><a href="#cb384-369" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb384-370"><a href="#cb384-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-371"><a href="#cb384-371" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb384-372"><a href="#cb384-372" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m1, type="pred",</span></span>
<span id="cb384-373"><a href="#cb384-373" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb384-374"><a href="#cb384-374" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb384-375"><a href="#cb384-375" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Predicted Probability of Accuracy",</span></span>
<span id="cb384-376"><a href="#cb384-376" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb384-377"><a href="#cb384-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-378"><a href="#cb384-378" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb384-379"><a href="#cb384-379" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb384-380"><a href="#cb384-380" aria-hidden="true" tabindex="-1"></a><span class="fu">ggeffect</span>(<span class="at">model =</span> m1) <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span>
<span id="cb384-381"><a href="#cb384-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-382"><a href="#cb384-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-383"><a href="#cb384-383" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb384-384"><a href="#cb384-384" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb384-385"><a href="#cb384-385" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(m))</span></span>
<span id="cb384-386"><a href="#cb384-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-387"><a href="#cb384-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-388"><a href="#cb384-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-389"><a href="#cb384-389" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb384-390"><a href="#cb384-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-393"><a href="#cb384-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-394"><a href="#cb384-394" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span>
<span id="cb384-395"><a href="#cb384-395" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(m1)</span>
<span id="cb384-396"><a href="#cb384-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-397"><a href="#cb384-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-398"><a href="#cb384-398" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb384-399"><a href="#cb384-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-400"><a href="#cb384-400" aria-hidden="true" tabindex="-1"></a>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the *impasse condition* increase by 146% ($e^{beta_1}$ = 2.46, 95% CI \[1.42, 4.37\]) over the *control condition*.</span>
<span id="cb384-401"><a href="#cb384-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-402"><a href="#cb384-402" aria-hidden="true" tabindex="-1"></a>*Equivalent statements:*</span>
<span id="cb384-403"><a href="#cb384-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-404"><a href="#cb384-404" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse condition increases log odds of correct response by 0.901 (over control)</span>
<span id="cb384-405"><a href="#cb384-405" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</span>
<span id="cb384-406"><a href="#cb384-406" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</span>
<span id="cb384-407"><a href="#cb384-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-410"><a href="#cb384-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-411"><a href="#cb384-411" aria-hidden="true" tabindex="-1"></a><span class="co">#PRETTY TABLE SJPLOT</span></span>
<span id="cb384-412"><a href="#cb384-412" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1)</span>
<span id="cb384-413"><a href="#cb384-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-414"><a href="#cb384-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-415"><a href="#cb384-415" aria-hidden="true" tabindex="-1"></a><span class="fu">### TODO ORDINAL REGRESSION</span></span>
<span id="cb384-416"><a href="#cb384-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-417"><a href="#cb384-417" aria-hidden="true" tabindex="-1"></a>*Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.*</span>
<span id="cb384-418"><a href="#cb384-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-419"><a href="#cb384-419" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</span>
<span id="cb384-420"><a href="#cb384-420" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb384-421"><a href="#cb384-421" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>todo see ordinal regression video</span>
<span id="cb384-422"><a href="#cb384-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-425"><a href="#cb384-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-426"><a href="#cb384-426" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE DATAFRAME OF Q1</span></span>
<span id="cb384-427"><a href="#cb384-427" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_items %&gt;% filter(q ==1) %&gt;% mutate(scaled = as.factor(score_SCALED))</span></span>
<span id="cb384-428"><a href="#cb384-428" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-429"><a href="#cb384-429" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL</span></span>
<span id="cb384-430"><a href="#cb384-430" aria-hidden="true" tabindex="-1"></a><span class="co"># m &lt;- polr(scaled ~ condition , data = df, Hess=TRUE)</span></span>
<span id="cb384-431"><a href="#cb384-431" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m)</span></span>
<span id="cb384-432"><a href="#cb384-432" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m)</span></span>
<span id="cb384-433"><a href="#cb384-433" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb384-434"><a href="#cb384-434" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb384-435"><a href="#cb384-435" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-436"><a href="#cb384-436" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate coefficients and CIs </span></span>
<span id="cb384-437"><a href="#cb384-437" aria-hidden="true" tabindex="-1"></a><span class="co"># ci &lt;- confint(m)</span></span>
<span id="cb384-438"><a href="#cb384-438" aria-hidden="true" tabindex="-1"></a><span class="co"># ci</span></span>
<span id="cb384-439"><a href="#cb384-439" aria-hidden="true" tabindex="-1"></a><span class="co"># e &lt;- coef(m)</span></span>
<span id="cb384-440"><a href="#cb384-440" aria-hidden="true" tabindex="-1"></a><span class="co"># e</span></span>
<span id="cb384-441"><a href="#cb384-441" aria-hidden="true" tabindex="-1"></a><span class="co"># # exp(cbind(e,ci))</span></span>
<span id="cb384-442"><a href="#cb384-442" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-443"><a href="#cb384-443" aria-hidden="true" tabindex="-1"></a><span class="co"># # Retrieve predictions as probabilities </span></span>
<span id="cb384-444"><a href="#cb384-444" aria-hidden="true" tabindex="-1"></a><span class="co"># # (for each level of the predictor)</span></span>
<span id="cb384-445"><a href="#cb384-445" aria-hidden="true" tabindex="-1"></a><span class="co"># # p.control &lt;- predict(m,data.frame(condition="111"),type="response")</span></span>
<span id="cb384-446"><a href="#cb384-446" aria-hidden="true" tabindex="-1"></a><span class="co"># # paste("Probability of success in control,", p.control)</span></span>
<span id="cb384-447"><a href="#cb384-447" aria-hidden="true" tabindex="-1"></a><span class="co"># # p.impasse &lt;- predict(m,data.frame(condition="121"),type="response")</span></span>
<span id="cb384-448"><a href="#cb384-448" aria-hidden="true" tabindex="-1"></a><span class="co"># # paste("Probability of success in impasse,", p.impasse)</span></span>
<span id="cb384-449"><a href="#cb384-449" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-450"><a href="#cb384-450" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot Predicted data and original data points</span></span>
<span id="cb384-451"><a href="#cb384-451" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggplot(df, aes(x=condition, y=accuracy)) + </span></span>
<span id="cb384-452"><a href="#cb384-452" aria-hidden="true" tabindex="-1"></a><span class="co"># #   geom_point() +</span></span>
<span id="cb384-453"><a href="#cb384-453" aria-hidden="true" tabindex="-1"></a><span class="co"># #   stat_smooth(method="glm", color="green", se=FALSE,</span></span>
<span id="cb384-454"><a href="#cb384-454" aria-hidden="true" tabindex="-1"></a><span class="co"># #                 method.args = list(family=binomial))</span></span>
<span id="cb384-455"><a href="#cb384-455" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb384-456"><a href="#cb384-456" aria-hidden="true" tabindex="-1"></a><span class="co"># #TO PLOT ALL EFFECTS</span></span>
<span id="cb384-457"><a href="#cb384-457" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb384-458"><a href="#cb384-458" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(m))</span></span>
<span id="cb384-459"><a href="#cb384-459" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-460"><a href="#cb384-460" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT</span></span>
<span id="cb384-461"><a href="#cb384-461" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sjPlot)</span></span>
<span id="cb384-462"><a href="#cb384-462" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, )</span></span>
<span id="cb384-463"><a href="#cb384-463" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-464"><a href="#cb384-464" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-465"><a href="#cb384-465" aria-hidden="true" tabindex="-1"></a><span class="co"># #CONVERT TO PROBABILITIES</span></span>
<span id="cb384-466"><a href="#cb384-466" aria-hidden="true" tabindex="-1"></a><span class="co"># newdat &lt;- data.frame(condition=c("111","121"))</span></span>
<span id="cb384-467"><a href="#cb384-467" aria-hidden="true" tabindex="-1"></a><span class="co"># prob &lt;- (phat &lt;- predict(object = m, newdat, type="p"))</span></span>
<span id="cb384-468"><a href="#cb384-468" aria-hidden="true" tabindex="-1"></a><span class="co"># prob</span></span>
<span id="cb384-469"><a href="#cb384-469" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-470"><a href="#cb384-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-471"><a href="#cb384-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-472"><a href="#cb384-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-473"><a href="#cb384-473" aria-hidden="true" tabindex="-1"></a><span class="fu">## REPEATED ITEM LEVEL</span></span>
<span id="cb384-474"><a href="#cb384-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-475"><a href="#cb384-475" aria-hidden="true" tabindex="-1"></a>**Test Phase Accuracy (absolute score)**</span>
<span id="cb384-476"><a href="#cb384-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-477"><a href="#cb384-477" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mixed Logistic Regression</span></span>
<span id="cb384-478"><a href="#cb384-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-479"><a href="#cb384-479" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on test phase questions by condition; accounting for random effects of subject.*</span>
<span id="cb384-480"><a href="#cb384-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-481"><a href="#cb384-481" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb384-482"><a href="#cb384-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-485"><a href="#cb384-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-486"><a href="#cb384-486" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb384-487"><a href="#cb384-487" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb384-488"><a href="#cb384-488" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb384-489"><a href="#cb384-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-490"><a href="#cb384-490" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb384-491"><a href="#cb384-491" aria-hidden="true" tabindex="-1"></a>df_test <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb384-492"><a href="#cb384-492" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb384-493"><a href="#cb384-493" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb384-494"><a href="#cb384-494" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb384-495"><a href="#cb384-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-496"><a href="#cb384-496" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_test</span>
<span id="cb384-497"><a href="#cb384-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-498"><a href="#cb384-498" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb384-499"><a href="#cb384-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-500"><a href="#cb384-500" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM EFFECT</span></span>
<span id="cb384-501"><a href="#cb384-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-502"><a href="#cb384-502" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb384-503"><a href="#cb384-503" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df) </span>
<span id="cb384-504"><a href="#cb384-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-505"><a href="#cb384-505" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb384-506"><a href="#cb384-506" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb384-507"><a href="#cb384-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-508"><a href="#cb384-508" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb384-509"><a href="#cb384-509" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with random effect is lower than glm empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span>
<span id="cb384-510"><a href="#cb384-510" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb384-511"><a href="#cb384-511" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb384-512"><a href="#cb384-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-513"><a href="#cb384-513" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT</span></span>
<span id="cb384-514"><a href="#cb384-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-515"><a href="#cb384-515" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span></span>
<span id="cb384-516"><a href="#cb384-516" aria-hidden="true" tabindex="-1"></a>mm.CrS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), </span>
<span id="cb384-517"><a href="#cb384-517" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb384-518"><a href="#cb384-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-519"><a href="#cb384-519" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> fixed factor </span></span>
<span id="cb384-520"><a href="#cb384-520" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC with random effect is lower than glm empty model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrS)) )</span>
<span id="cb384-521"><a href="#cb384-521" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS,mm.CrS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb384-522"><a href="#cb384-522" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS,mm.CrS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb384-523"><a href="#cb384-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-524"><a href="#cb384-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-525"><a href="#cb384-525" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb384-526"><a href="#cb384-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-529"><a href="#cb384-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-530"><a href="#cb384-530" aria-hidden="true" tabindex="-1"></a><span class="co">#: PRINT MODEL </span></span>
<span id="cb384-531"><a href="#cb384-531" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb384-532"><a href="#cb384-532" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm.CrS)</span>
<span id="cb384-533"><a href="#cb384-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-534"><a href="#cb384-534" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb384-535"><a href="#cb384-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-536"><a href="#cb384-536" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb384-537"><a href="#cb384-537" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(mm.CrS)</span>
<span id="cb384-538"><a href="#cb384-538" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb384-539"><a href="#cb384-539" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mm.CrS)</span>
<span id="cb384-540"><a href="#cb384-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-541"><a href="#cb384-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-542"><a href="#cb384-542" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb384-543"><a href="#cb384-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-544"><a href="#cb384-544" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb384-545"><a href="#cb384-545" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb384-546"><a href="#cb384-546" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb384-547"><a href="#cb384-547" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb384-548"><a href="#cb384-548" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb384-549"><a href="#cb384-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb384-550"><a href="#cb384-550" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb384-551"><a href="#cb384-551" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb384-552"><a href="#cb384-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-553"><a href="#cb384-553" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb384-554"><a href="#cb384-554" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrS, <span class="at">type=</span><span class="st">"pred"</span>,</span>
<span id="cb384-555"><a href="#cb384-555" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb384-556"><a href="#cb384-556" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb384-557"><a href="#cb384-557" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb384-558"><a href="#cb384-558" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb384-559"><a href="#cb384-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-560"><a href="#cb384-560" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb384-561"><a href="#cb384-561" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb384-562"><a href="#cb384-562" aria-hidden="true" tabindex="-1"></a><span class="co"># ggeffect(model = mm.CrS) %&gt;% plot()</span></span>
<span id="cb384-563"><a href="#cb384-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-564"><a href="#cb384-564" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb384-565"><a href="#cb384-565" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb384-566"><a href="#cb384-566" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(mm.CrS))</span></span>
<span id="cb384-567"><a href="#cb384-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-568"><a href="#cb384-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-569"><a href="#cb384-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-570"><a href="#cb384-570" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb384-571"><a href="#cb384-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-574"><a href="#cb384-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-575"><a href="#cb384-575" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mm.CrS)</span>
<span id="cb384-576"><a href="#cb384-576" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(mm.CrS)</span>
<span id="cb384-577"><a href="#cb384-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-578"><a href="#cb384-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-579"><a href="#cb384-579" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb384-580"><a href="#cb384-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-581"><a href="#cb384-581" aria-hidden="true" tabindex="-1"></a>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(3): 4.98, p <span class="sc">\&lt;</span> 0.05). Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 5 over the control condition $e^{\beta_1}$ = 5.11, 95% CI <span class="sc">\[</span>1.17,22,36<span class="sc">\]</span>, p <span class="sc">\&lt;</span> 0.05.</span>
<span id="cb384-582"><a href="#cb384-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-585"><a href="#cb384-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-586"><a href="#cb384-586" aria-hidden="true" tabindex="-1"></a><span class="co"># PRETTY TABLE SJPLOT</span></span>
<span id="cb384-587"><a href="#cb384-587" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(mm.CrS)</span>
<span id="cb384-588"><a href="#cb384-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-589"><a href="#cb384-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-590"><a href="#cb384-590" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TODO Mixed Ordinal Regression</span></span>
<span id="cb384-591"><a href="#cb384-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-592"><a href="#cb384-592" aria-hidden="true" tabindex="-1"></a><span class="fu">## SUBJECT-LEVEL</span></span>
<span id="cb384-593"><a href="#cb384-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-594"><a href="#cb384-594" aria-hidden="true" tabindex="-1"></a>**Test Phase Absolute Score (# questions)**</span>
<span id="cb384-595"><a href="#cb384-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-598"><a href="#cb384-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-599"><a href="#cb384-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-</span><span class="al">TEST</span><span class="co">-ACC</span></span>
<span id="cb384-600"><a href="#cb384-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-601"><a href="#cb384-601" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb384-602"><a href="#cb384-602" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb384-603"><a href="#cb384-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-604"><a href="#cb384-604" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb384-605"><a href="#cb384-605" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb384-606"><a href="#cb384-606" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb384-607"><a href="#cb384-607" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb384-608"><a href="#cb384-608" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb384-609"><a href="#cb384-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-610"><a href="#cb384-610" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb384-611"><a href="#cb384-611" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb384-612"><a href="#cb384-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb384-613"><a href="#cb384-613" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb384-614"><a href="#cb384-614" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb384-615"><a href="#cb384-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb384-616"><a href="#cb384-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb384-617"><a href="#cb384-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb384-618"><a href="#cb384-618" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "",</span></span>
<span id="cb384-619"><a href="#cb384-619" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase"</span>,</span>
<span id="cb384-620"><a href="#cb384-620" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb384-621"><a href="#cb384-621" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb384-622"><a href="#cb384-622" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb384-623"><a href="#cb384-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-624"><a href="#cb384-624" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb384-625"><a href="#cb384-625" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~accuracy, fill = ~pretty_condition, x =~pretty_condition,</span></span>
<span id="cb384-626"><a href="#cb384-626" aria-hidden="true" tabindex="-1"></a><span class="co">#        position = position_dodge(), data = df) %&gt;% </span></span>
<span id="cb384-627"><a href="#cb384-627" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_mode) +</span></span>
<span id="cb384-628"><a href="#cb384-628" aria-hidden="true" tabindex="-1"></a><span class="co">#    labs(x = "Correct Responses in Test Phase",</span></span>
<span id="cb384-629"><a href="#cb384-629" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Accuracy on Task by Condition",</span></span>
<span id="cb384-630"><a href="#cb384-630" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses")</span></span>
<span id="cb384-631"><a href="#cb384-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-632"><a href="#cb384-632" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb384-633"><a href="#cb384-633" aria-hidden="true" tabindex="-1"></a><span class="co">#FACETED HISTOGRAM</span></span>
<span id="cb384-634"><a href="#cb384-634" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(item_test_NABS))</span>
<span id="cb384-635"><a href="#cb384-635" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>item_test_NABS, </span>
<span id="cb384-636"><a href="#cb384-636" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_subjects) <span class="sc">%&gt;%</span> </span>
<span id="cb384-637"><a href="#cb384-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> pretty_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb384-638"><a href="#cb384-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb384-639"><a href="#cb384-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"# Correct"</span>,</span>
<span id="cb384-640"><a href="#cb384-640" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb384-641"><a href="#cb384-641" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Test Phase Absolute Score (# Correct)"</span>,</span>
<span id="cb384-642"><a href="#cb384-642" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb384-643"><a href="#cb384-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-644"><a href="#cb384-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-645"><a href="#cb384-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-646"><a href="#cb384-646" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Independent Samples T-Test</span></span>
<span id="cb384-647"><a href="#cb384-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-648"><a href="#cb384-648" aria-hidden="true" tabindex="-1"></a>*Compare mean ABS score for Ss in control vs. impasse condition.*</span>
<span id="cb384-649"><a href="#cb384-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-650"><a href="#cb384-650" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The bimodal distribution of the subject-level score data do not meet the requirements for t-tests. However, a non-parametric alternative is available (Wilcoxon rank sum test / Man-Whitney test)</span>
<span id="cb384-651"><a href="#cb384-651" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Additional corrections are available for data with 'floor' and/or 'ceiling' effects via the 'DACR' package</span>
<span id="cb384-652"><a href="#cb384-652" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14 see also https://qmliu.shinyapps.io/DACFE/</span>
<span id="cb384-653"><a href="#cb384-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-656"><a href="#cb384-656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-657"><a href="#cb384-657" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb384-658"><a href="#cb384-658" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(df_subjects<span class="sc">$</span>item_test_NABS <span class="sc">~</span> df_subjects<span class="sc">$</span>pretty_condition)</span>
<span id="cb384-659"><a href="#cb384-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-660"><a href="#cb384-660" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy) <span class="co">#easy adjustmenet to ggplots plots </span></span>
<span id="cb384-661"><a href="#cb384-661" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_boxplot</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_subjects, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb384-662"><a href="#cb384-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_jitter</span>( <span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="sc">~</span>pretty_condition) <span class="sc">+</span> </span>
<span id="cb384-663"><a href="#cb384-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"Distribution of Task Accuracy by Condition"</span>,</span>
<span id="cb384-664"><a href="#cb384-664" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Task Accuracy (# correct)"</span>, <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span></span>
<span id="cb384-665"><a href="#cb384-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">easy_remove_legend</span>()</span>
<span id="cb384-666"><a href="#cb384-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-667"><a href="#cb384-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-668"><a href="#cb384-668" aria-hidden="true" tabindex="-1"></a>For comparison we run a standard Welch Two-sample T test, for which we do not meet the normal distribution requirement, followed by a Wilcoxon rank-sum (Mann-Whitney) test that is a nonparametric alternative for non-normally distributed data.</span>
<span id="cb384-669"><a href="#cb384-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-672"><a href="#cb384-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-673"><a href="#cb384-673" aria-hidden="true" tabindex="-1"></a><span class="co">#WELCH TWO SAMPLE T </span><span class="al">TEST</span></span>
<span id="cb384-674"><a href="#cb384-674" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> --------------DATA DON'T MEET NORMALITY REQS FOR WELCH---------"</span>)</span>
<span id="cb384-675"><a href="#cb384-675" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(df_subjects<span class="sc">$</span>item_test_NABS <span class="sc">~</span> df_subjects<span class="sc">$</span>pretty_condition)</span>
<span id="cb384-676"><a href="#cb384-676" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span>
<span id="cb384-677"><a href="#cb384-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-678"><a href="#cb384-678" aria-hidden="true" tabindex="-1"></a><span class="co">#WILCOXON RANK BASED </span><span class="al">TEST</span></span>
<span id="cb384-679"><a href="#cb384-679" aria-hidden="true" tabindex="-1"></a><span class="co"># The Wilcoxon rank sum test is a non-parametric alternative to the independent two samples t-test for comparing two independent groups of samples, in the situation where the data are not normally distributed.</span></span>
<span id="cb384-680"><a href="#cb384-680" aria-hidden="true" tabindex="-1"></a><span class="co">#Synonymous: Mann-Whitney test, Mann-Whitney U test, Wilcoxon-Mann-Whitney test and two-sample Wilcoxon test.</span></span>
<span id="cb384-681"><a href="#cb384-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-682"><a href="#cb384-682" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> </span><span class="sc">\n</span><span class="st"> --------------ROBUST ALTERNATIVE --------------"</span>)</span>
<span id="cb384-683"><a href="#cb384-683" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df_subjects<span class="sc">$</span>item_test_NABS <span class="sc">~</span> df_subjects<span class="sc">$</span>pretty_condition)</span>
<span id="cb384-684"><a href="#cb384-684" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(t)</span>
<span id="cb384-685"><a href="#cb384-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-686"><a href="#cb384-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-687"><a href="#cb384-687" aria-hidden="true" tabindex="-1"></a>Next, we calculate the t-test and ANOVA (F-test) based on a series of corrections provided for data with floor and/or ceiling effects.</span>
<span id="cb384-688"><a href="#cb384-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-689"><a href="#cb384-689" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://link.springer.com/article/10.3758/s13428-020-01407-2#Sec14</span>
<span id="cb384-690"><a href="#cb384-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-691"><a href="#cb384-691" aria-hidden="true" tabindex="-1"></a>Using properties from truncated normal distributions, the authors propose an easy-to-use method for the *t*-test and ANOVA with ceiling/floor data. *The proposed method calculates the degrees of freedom based on the after-truncation sample sizes (where l = number of floor observations, and r = number of ceiling observations). The rationale was that the proposed method utilizes full information only from data points of n − r − l participants and partial information from data points of r + l participants of a group for the mean and variance estimation. Specifically, the corrected mean and variance estimates (Eqs. 14 and 15) are functions of mean and variance estimates using after-truncation data (n − r − l participants) and the standardized floor and ceiling threshold estimates. The thresholds are estimated using the ceiling and floor percentage estimates based on data points of n − r and n − l participants, respectively. This is a relatively conservative approach for calculating the degrees of freedom, which can help control the type I error rate. This feature can be beneficial, especially given the "replication crisis" in psychological and behavioral research.*</span>
<span id="cb384-692"><a href="#cb384-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-695"><a href="#cb384-695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-696"><a href="#cb384-696" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED T TESTS</span></span>
<span id="cb384-697"><a href="#cb384-697" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DACF) <span class="co">#tests for data with floor and ceiling </span></span>
<span id="cb384-698"><a href="#cb384-698" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.rdocumentation.org/packages/DACF/versions/1.0.0</span></span>
<span id="cb384-699"><a href="#cb384-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-700"><a href="#cb384-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-701"><a href="#cb384-701" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare data [vector of scores for each group]</span></span>
<span id="cb384-702"><a href="#cb384-702" aria-hidden="true" tabindex="-1"></a>score_111 <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_condition <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(item_test_NABS) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb384-703"><a href="#cb384-703" aria-hidden="true" tabindex="-1"></a>score_121 <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_condition <span class="sc">==</span> <span class="st">"impasse"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(item_test_NABS) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb384-704"><a href="#cb384-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-705"><a href="#cb384-705" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb384-706"><a href="#cb384-706" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_111) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb384-707"><a href="#cb384-707" aria-hidden="true" tabindex="-1"></a><span class="co"># recover the mean and variance for ceiling/floor data</span></span>
<span id="cb384-708"><a href="#cb384-708" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rec.mean.var</span>(score_121) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb384-709"><a href="#cb384-709" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(<span class="st">"control"</span><span class="ot">=</span>a ,<span class="st">"impasse"</span><span class="ot">=</span>b))</span>
<span id="cb384-710"><a href="#cb384-710" aria-hidden="true" tabindex="-1"></a>r</span>
<span id="cb384-711"><a href="#cb384-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-712"><a href="#cb384-712" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb384-713"><a href="#cb384-713" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb384-714"><a href="#cb384-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-715"><a href="#cb384-715" aria-hidden="true" tabindex="-1"></a><span class="co"># perform adjusted t test</span></span>
<span id="cb384-716"><a href="#cb384-716" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.t.test</span>(score_111,score_121,<span class="st">"a"</span>)</span>
<span id="cb384-717"><a href="#cb384-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-718"><a href="#cb384-718" aria-hidden="true" tabindex="-1"></a><span class="co">#FLOOR-CEILING ADJUSTED F* </span><span class="al">TEST</span><span class="co"> ANOVA</span></span>
<span id="cb384-719"><a href="#cb384-719" aria-hidden="true" tabindex="-1"></a><span class="fu">lw.f.star</span>(df_subjects,item_test_NABS<span class="sc">~</span>pretty_condition,<span class="st">"a"</span>)</span>
<span id="cb384-720"><a href="#cb384-720" aria-hidden="true" tabindex="-1"></a><span class="co"># method "a" uses original sample size</span></span>
<span id="cb384-721"><a href="#cb384-721" aria-hidden="true" tabindex="-1"></a><span class="co"># method "b" uses after-truncation sample size</span></span>
<span id="cb384-722"><a href="#cb384-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-723"><a href="#cb384-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-724"><a href="#cb384-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-725"><a href="#cb384-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-726"><a href="#cb384-726" aria-hidden="true" tabindex="-1"></a>Group 1 has ceiling and floor percentage of 10.5% and 30.2%, with corrected mean and variance respectively as 3.434 and 83.157. Group 2 has ceiling and floor percentage of 8.2% and 62.7%, with corrected mean and variance respectively as -6.504 and 210.664. The corrected t statistic is 4.778, p = 0. The estimated Cohen's d is 0.87 with a confidence interval as <span class="sc">\[</span>5.742,14.135<span class="sc">\]</span>.</span>
<span id="cb384-727"><a href="#cb384-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-728"><a href="#cb384-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-729"><a href="#cb384-729" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Censored Linear Regression</span></span>
<span id="cb384-730"><a href="#cb384-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-731"><a href="#cb384-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-732"><a href="#cb384-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-733"><a href="#cb384-733" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Linear Regression</span></span>
<span id="cb384-734"><a href="#cb384-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-735"><a href="#cb384-735" aria-hidden="true" tabindex="-1"></a>*LM on Test Phase absolute score **as number of questions**, rather than % correct.*</span>
<span id="cb384-736"><a href="#cb384-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-739"><a href="#cb384-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-740"><a href="#cb384-740" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION</span></span>
<span id="cb384-741"><a href="#cb384-741" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_subjects)</span>
<span id="cb384-742"><a href="#cb384-742" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb384-743"><a href="#cb384-743" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm<span class="fl">.1</span>)</span>
<span id="cb384-744"><a href="#cb384-744" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb384-745"><a href="#cb384-745" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span>
<span id="cb384-746"><a href="#cb384-746" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb384-747"><a href="#cb384-747" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm<span class="fl">.1</span>)</span>
<span id="cb384-748"><a href="#cb384-748" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(lm<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb384-749"><a href="#cb384-749" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm<span class="fl">.1</span>)</span>
<span id="cb384-750"><a href="#cb384-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-751"><a href="#cb384-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-754"><a href="#cb384-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-755"><a href="#cb384-755" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VISMODEL-</span><span class="al">TEST</span><span class="co">-ABS-LAB</span></span>
<span id="cb384-756"><a href="#cb384-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-757"><a href="#cb384-757" aria-hidden="true" tabindex="-1"></a><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span></span>
<span id="cb384-758"><a href="#cb384-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-759"><a href="#cb384-759" aria-hidden="true" tabindex="-1"></a><span class="co">#setup references</span></span>
<span id="cb384-760"><a href="#cb384-760" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> lm<span class="fl">.1</span></span>
<span id="cb384-761"><a href="#cb384-761" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects</span>
<span id="cb384-762"><a href="#cb384-762" aria-hidden="true" tabindex="-1"></a>call <span class="ot">&lt;-</span> m<span class="sc">$</span>call <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()</span>
<span id="cb384-763"><a href="#cb384-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-764"><a href="#cb384-764" aria-hidden="true" tabindex="-1"></a><span class="co"># uncertainty model visualization</span></span>
<span id="cb384-765"><a href="#cb384-765" aria-hidden="true" tabindex="-1"></a>df  <span class="sc">%&gt;%</span></span>
<span id="cb384-766"><a href="#cb384-766" aria-hidden="true" tabindex="-1"></a>  modelr<span class="sc">::</span><span class="fu">data_grid</span>(pretty_condition) <span class="sc">%&gt;%</span></span>
<span id="cb384-767"><a href="#cb384-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(lm<span class="fl">.1</span>, <span class="at">newdata =</span> ., <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb384-768"><a href="#cb384-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pretty_condition, <span class="at">color =</span> pretty_condition)) <span class="sc">+</span></span>
<span id="cb384-769"><a href="#cb384-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>( <span class="at">scale =</span> .<span class="dv">5</span>,</span>
<span id="cb384-770"><a href="#cb384-770" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb384-771"><a href="#cb384-771" aria-hidden="true" tabindex="-1"></a>        <span class="at">xdist =</span> <span class="fu">dist_student_t</span>(<span class="at">df =</span> <span class="fu">df.residual</span>(m), <span class="at">mu =</span> .fitted, <span class="at">sigma =</span> .se.fit),</span>
<span id="cb384-772"><a href="#cb384-772" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">stat</span>(<span class="fu">cut_cdf_qi</span>(cdf,</span>
<span id="cb384-773"><a href="#cb384-773" aria-hidden="true" tabindex="-1"></a>                <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">95</span>),</span>
<span id="cb384-774"><a href="#cb384-774" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())))) <span class="sc">+</span></span>
<span id="cb384-775"><a href="#cb384-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb384-776"><a href="#cb384-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">"(LAB) Test Phase Accuracy ~ Condition"</span>,</span>
<span id="cb384-777"><a href="#cb384-777" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"model predicted mean (% correct)"</span>, <span class="at">y =</span> <span class="st">"Condition"</span>, <span class="at">fill =</span> <span class="st">"Interval"</span>,</span>
<span id="cb384-778"><a href="#cb384-778" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"lm("</span>,call[<span class="dv">2</span>],<span class="st">")"</span>)</span>
<span id="cb384-779"><a href="#cb384-779" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb384-780"><a href="#cb384-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-781"><a href="#cb384-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-782"><a href="#cb384-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-783"><a href="#cb384-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-784"><a href="#cb384-784" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Censored (Tobit) Regression</span></span>
<span id="cb384-785"><a href="#cb384-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-786"><a href="#cb384-786" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/tobit-models/</span>
<span id="cb384-787"><a href="#cb384-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-788"><a href="#cb384-788" aria-hidden="true" tabindex="-1"></a>**For censored data (i.e. truncated axis).** The tobit model, also called a censored regression model, is designed to estimate linear relationships between variables when there is either left- or right-censoring in the dependent variable (also known as censoring from below and above, respectively). Censoring from above takes place when cases with a value at or above some threshold, all take on the value of that threshold, so that the true value might be equal to the threshold, but it might also be higher. In the case of censoring from below, values those that fall at or below some threshold are censored.</span>
<span id="cb384-789"><a href="#cb384-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-790"><a href="#cb384-790" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>censored vs truncated : There is sometimes confusion about the difference between truncated data and censored data. With censored variables, all of the observations are in the dataset, but we don’t know the “true” values of some of them. With truncation some of the observations are not included in the analysis because of the value of the variable. When a variable is censored, regression models for truncated data provide inconsistent estimates of the parameters. See Long (1997, chapter 7) for a more detailed discussion of problems of using regression models for truncated data to analyze censored data.</span>
<span id="cb384-791"><a href="#cb384-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-794"><a href="#cb384-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-795"><a href="#cb384-795" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP</span></span>
<span id="cb384-796"><a href="#cb384-796" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb384-797"><a href="#cb384-797" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> item_test_NABS</span>
<span id="cb384-798"><a href="#cb384-798" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb384-799"><a href="#cb384-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-800"><a href="#cb384-800" aria-hidden="true" tabindex="-1"></a>lo <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb384-801"><a href="#cb384-801" aria-hidden="true" tabindex="-1"></a>hi <span class="ot">=</span> <span class="dv">8</span> </span>
<span id="cb384-802"><a href="#cb384-802" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(df<span class="sc">$</span>accuracy)</span>
<span id="cb384-803"><a href="#cb384-803" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Lo and Hi should equate to upper and lower bounds of the # Qs "</span>)</span>
<span id="cb384-804"><a href="#cb384-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-805"><a href="#cb384-805" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb384-806"><a href="#cb384-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-807"><a href="#cb384-807" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb384-808"><a href="#cb384-808" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span> <span class="fu">vglm</span>(accuracy <span class="sc">~</span> condition, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span>hi ), <span class="at">data =</span> df)</span>
<span id="cb384-809"><a href="#cb384-809" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb384-810"><a href="#cb384-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-811"><a href="#cb384-811" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb384-812"><a href="#cb384-812" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb384-813"><a href="#cb384-813" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m1)))</span>
<span id="cb384-814"><a href="#cb384-814" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb384-815"><a href="#cb384-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-816"><a href="#cb384-816" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb384-817"><a href="#cb384-817" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb384-818"><a href="#cb384-818" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">tobit</span>(<span class="at">Lower =</span> lo, <span class="at">Upper =</span> hi), <span class="at">data =</span> df)</span>
<span id="cb384-819"><a href="#cb384-819" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(m1) <span class="sc">-</span> <span class="fu">logLik</span>(m0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb384-820"><a href="#cb384-820" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb384-821"><a href="#cb384-821" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m0,m1)</span>
<span id="cb384-822"><a href="#cb384-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-823"><a href="#cb384-823" aria-hidden="true" tabindex="-1"></a><span class="co">#DIAGNOSTICS</span></span>
<span id="cb384-824"><a href="#cb384-824" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1)</span>
<span id="cb384-825"><a href="#cb384-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-826"><a href="#cb384-826" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m1)[,<span class="dv">1</span>]</span>
<span id="cb384-827"><a href="#cb384-827" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rr <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb384-828"><a href="#cb384-828" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rp <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1, <span class="at">type =</span> <span class="st">"pearson"</span>)[,<span class="dv">1</span>]</span>
<span id="cb384-829"><a href="#cb384-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-830"><a href="#cb384-830" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb384-831"><a href="#cb384-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-832"><a href="#cb384-832" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df, {</span>
<span id="cb384-833"><a href="#cb384-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rr, <span class="at">main =</span> <span class="st">"Fitted vs Residuals"</span>)</span>
<span id="cb384-834"><a href="#cb384-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rr)</span>
<span id="cb384-835"><a href="#cb384-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(yhat, rp, <span class="at">main =</span> <span class="st">"Fitted vs Pearson Residuals"</span>)</span>
<span id="cb384-836"><a href="#cb384-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(rp)</span>
<span id="cb384-837"><a href="#cb384-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(accuracy, rp, <span class="at">main =</span> <span class="st">"Actual vs Pearson Residuals"</span>)</span>
<span id="cb384-838"><a href="#cb384-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(accuracy, yhat, <span class="at">main =</span> <span class="st">"Actual vs Fitted"</span>)</span>
<span id="cb384-839"><a href="#cb384-839" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb384-840"><a href="#cb384-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-841"><a href="#cb384-841" aria-hidden="true" tabindex="-1"></a><span class="co">#VARIANCE ACCOUNTED FOR</span></span>
<span id="cb384-842"><a href="#cb384-842" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"VARIANCE ACCOUNTED FOR"</span>)</span>
<span id="cb384-843"><a href="#cb384-843" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation</span></span>
<span id="cb384-844"><a href="#cb384-844" aria-hidden="true" tabindex="-1"></a>(r <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">cor</span>(yhat, accuracy)))</span>
<span id="cb384-845"><a href="#cb384-845" aria-hidden="true" tabindex="-1"></a><span class="co"># variance accounted for</span></span>
<span id="cb384-846"><a href="#cb384-846" aria-hidden="true" tabindex="-1"></a>r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb384-847"><a href="#cb384-847" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb384-848"><a href="#cb384-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-849"><a href="#cb384-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-850"><a href="#cb384-850" aria-hidden="true" tabindex="-1"></a><span class="co">#NOTE: censReg package also does Tobit regression [including mixed models]</span></span>
<span id="cb384-851"><a href="#cb384-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-852"><a href="#cb384-852" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient labeled “(Intercept):1” is the intercept or constant for the model.</span>
<span id="cb384-853"><a href="#cb384-853" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The coefficient labeled “(Intercept):2” is an ancillary statistic. If we exponentiate this value, we get a statistic that is analogous to the square root of the residual variance in OLS regression. logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</span>
<span id="cb384-854"><a href="#cb384-854" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The predicted value of test_phase_score is 5.75 points _higher_ for students in the impasse condition than for students in the control condition. (72% improvement in score!)</span>
<span id="cb384-855"><a href="#cb384-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-856"><a href="#cb384-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-857"><a href="#cb384-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-858"><a href="#cb384-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-859"><a href="#cb384-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-860"><a href="#cb384-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-861"><a href="#cb384-861" aria-hidden="true" tabindex="-1"></a>**Using censReg package**</span>
<span id="cb384-862"><a href="#cb384-862" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf</span>
<span id="cb384-863"><a href="#cb384-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-866"><a href="#cb384-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-867"><a href="#cb384-867" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censReg) <span class="co">#censored regression</span></span>
<span id="cb384-868"><a href="#cb384-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-869"><a href="#cb384-869" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP</span></span>
<span id="cb384-870"><a href="#cb384-870" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb384-871"><a href="#cb384-871" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> item_test_NABS</span>
<span id="cb384-872"><a href="#cb384-872" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb384-873"><a href="#cb384-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-874"><a href="#cb384-874" aria-hidden="true" tabindex="-1"></a>lo<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb384-875"><a href="#cb384-875" aria-hidden="true" tabindex="-1"></a>hi<span class="ot">=</span><span class="dv">8</span></span>
<span id="cb384-876"><a href="#cb384-876" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(df<span class="sc">$</span>accuracy)</span>
<span id="cb384-877"><a href="#cb384-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-878"><a href="#cb384-878" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb384-879"><a href="#cb384-879" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb384-880"><a href="#cb384-880" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(c1)</span>
<span id="cb384-881"><a href="#cb384-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-882"><a href="#cb384-882" aria-hidden="true" tabindex="-1"></a><span class="co">#CONFIDENCE INTERVALS</span></span>
<span id="cb384-883"><a href="#cb384-883" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(c1)</span>
<span id="cb384-884"><a href="#cb384-884" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(c1)))</span>
<span id="cb384-885"><a href="#cb384-885" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">LL =</span> b <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se, <span class="at">UL =</span> b <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se)</span>
<span id="cb384-886"><a href="#cb384-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-887"><a href="#cb384-887" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST FIT</span></span>
<span id="cb384-888"><a href="#cb384-888" aria-hidden="true" tabindex="-1"></a><span class="co">#We can test the significance of condition overall by fitting an empty model and using a likelihood ratio test.</span></span>
<span id="cb384-889"><a href="#cb384-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-890"><a href="#cb384-890" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">censReg</span>( accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">left=</span>lo, <span class="at">right=</span>hi, <span class="at">data =</span> df )</span>
<span id="cb384-891"><a href="#cb384-891" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(c1) <span class="sc">-</span> <span class="fu">logLik</span>(c0)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb384-892"><a href="#cb384-892" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P value of likelihood ratio test less than alpha = 0.05? "</span>, p <span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb384-893"><a href="#cb384-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-894"><a href="#cb384-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-895"><a href="#cb384-895" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(c1)</span>
<span id="cb384-896"><a href="#cb384-896" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-897"><a href="#cb384-897" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>logSigma is the variance of the model (logarithmized) (same as the second intercept in the VGAM output)</span>
<span id="cb384-898"><a href="#cb384-898" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>output should match that of VGAM</span>
<span id="cb384-899"><a href="#cb384-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-900"><a href="#cb384-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-901"><a href="#cb384-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-902"><a href="#cb384-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-903"><a href="#cb384-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-904"><a href="#cb384-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-905"><a href="#cb384-905" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Poisson Regression</span></span>
<span id="cb384-906"><a href="#cb384-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-907"><a href="#cb384-907" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/poisson-regression/</span>
<span id="cb384-908"><a href="#cb384-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-909"><a href="#cb384-909" aria-hidden="true" tabindex="-1"></a>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can consider it a type of *count*, (ie. count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function).</span>
<span id="cb384-910"><a href="#cb384-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-913"><a href="#cb384-913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-914"><a href="#cb384-914" aria-hidden="true" tabindex="-1"></a><span class="co">#POISSON</span></span>
<span id="cb384-915"><a href="#cb384-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-916"><a href="#cb384-916" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span></span>
<span id="cb384-917"><a href="#cb384-917" aria-hidden="true" tabindex="-1"></a>p<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_subjects, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb384-918"><a href="#cb384-918" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb384-919"><a href="#cb384-919" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(p<span class="fl">.1</span>)</span>
<span id="cb384-920"><a href="#cb384-920" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb384-921"><a href="#cb384-921" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(p<span class="fl">.1</span>)</span>
<span id="cb384-922"><a href="#cb384-922" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb384-923"><a href="#cb384-923" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(p<span class="fl">.1</span>)</span>
<span id="cb384-924"><a href="#cb384-924" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(p<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb384-925"><a href="#cb384-925" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(p<span class="fl">.1</span>)</span>
<span id="cb384-926"><a href="#cb384-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-927"><a href="#cb384-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-928"><a href="#cb384-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-929"><a href="#cb384-929" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zero Inflated Poisson</span></span>
<span id="cb384-930"><a href="#cb384-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-931"><a href="#cb384-931" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/zip/\</span>
<span id="cb384-932"><a href="#cb384-932" aria-hidden="true" tabindex="-1"></a>Poisson count process with excess zeros</span>
<span id="cb384-933"><a href="#cb384-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-936"><a href="#cb384-936" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-937"><a href="#cb384-937" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED POISSON</span></span>
<span id="cb384-938"><a href="#cb384-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-939"><a href="#cb384-939" aria-hidden="true" tabindex="-1"></a>zinfp<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(item_test_NABS <span class="sc">~</span>  item_q1_rt<span class="sc">|</span> pretty_condition , <span class="at">data =</span> df_subjects)</span>
<span id="cb384-940"><a href="#cb384-940" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb384-941"><a href="#cb384-941" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb384-942"><a href="#cb384-942" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb384-943"><a href="#cb384-943" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(zinfp.1)</span></span>
<span id="cb384-944"><a href="#cb384-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-945"><a href="#cb384-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-946"><a href="#cb384-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-947"><a href="#cb384-947" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Negative Binomial Regression</span></span>
<span id="cb384-948"><a href="#cb384-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-949"><a href="#cb384-949" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/ - overdispersed count data (variance much greater than mean)</span>
<span id="cb384-950"><a href="#cb384-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-953"><a href="#cb384-953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-954"><a href="#cb384-954" aria-hidden="true" tabindex="-1"></a><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span></span>
<span id="cb384-955"><a href="#cb384-955" aria-hidden="true" tabindex="-1"></a><span class="co"># - https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/</span></span>
<span id="cb384-956"><a href="#cb384-956" aria-hidden="true" tabindex="-1"></a><span class="co"># - Overdispersed Count variables</span></span>
<span id="cb384-957"><a href="#cb384-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-958"><a href="#cb384-958" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb384-959"><a href="#cb384-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-960"><a href="#cb384-960" aria-hidden="true" tabindex="-1"></a>nb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_subjects)</span>
<span id="cb384-961"><a href="#cb384-961" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb<span class="fl">.1</span>)</span>
<span id="cb384-962"><a href="#cb384-962" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(nb<span class="fl">.1</span>)</span>
<span id="cb384-963"><a href="#cb384-963" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(nb<span class="fl">.1</span>)</span>
<span id="cb384-964"><a href="#cb384-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-965"><a href="#cb384-965" aria-hidden="true" tabindex="-1"></a><span class="co">#check model assumption</span></span>
<span id="cb384-966"><a href="#cb384-966" aria-hidden="true" tabindex="-1"></a><span class="co">#assumes conditional means are not equal to conditional variances</span></span>
<span id="cb384-967"><a href="#cb384-967" aria-hidden="true" tabindex="-1"></a><span class="co">#conduct likelihood ration test to compare and test [need poisson]</span></span>
<span id="cb384-968"><a href="#cb384-968" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> df_subjects)</span>
<span id="cb384-969"><a href="#cb384-969" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(nb<span class="fl">.1</span>) <span class="sc">-</span> <span class="fu">logLik</span>(m3)), <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb384-970"><a href="#cb384-970" aria-hidden="true" tabindex="-1"></a><span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span></span>
<span id="cb384-971"><a href="#cb384-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-972"><a href="#cb384-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-973"><a href="#cb384-973" aria-hidden="true" tabindex="-1"></a><span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb384-974"><a href="#cb384-974" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Estimate =</span> <span class="fu">coef</span>(nb<span class="fl">.1</span>), <span class="fu">confint</span>(nb<span class="fl">.1</span>))</span>
<span id="cb384-975"><a href="#cb384-975" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate parameter estimates</span></span>
<span id="cb384-976"><a href="#cb384-976" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Exponentiated Estimates"</span>)</span>
<span id="cb384-977"><a href="#cb384-977" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(est)</span>
<span id="cb384-978"><a href="#cb384-978" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-979"><a href="#cb384-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-980"><a href="#cb384-980" aria-hidden="true" tabindex="-1"></a>The variable condition has a coefficient of 0.67, (p <span class="sc">\&lt;</span> 0.005). This means that for the impasse condition, the expected log count <span class="sc">\#</span> of questions increases by 0.67. By exponentiating the estimate we see that <span class="sc">\#</span> question correct rate for the impasse condition is nearly 2x that of the control condition.</span>
<span id="cb384-981"><a href="#cb384-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-982"><a href="#cb384-982" aria-hidden="true" tabindex="-1"></a>**Diagnostics** ??</span>
<span id="cb384-983"><a href="#cb384-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-984"><a href="#cb384-984" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zero Inflated Negative Binomial Regression</span></span>
<span id="cb384-985"><a href="#cb384-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-986"><a href="#cb384-986" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/zinb/ count data that are overdispersed and have excess zeros</span>
<span id="cb384-987"><a href="#cb384-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-988"><a href="#cb384-988" aria-hidden="true" tabindex="-1"></a>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the *excess* zeros can be modelled independently.</span>
<span id="cb384-989"><a href="#cb384-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-990"><a href="#cb384-990" aria-hidden="true" tabindex="-1"></a>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different 'process' ... (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) <span class="sc">\&lt;</span>- this could maybe be disentangled by first question latency?</span>
<span id="cb384-991"><a href="#cb384-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-992"><a href="#cb384-992" aria-hidden="true" tabindex="-1"></a>The model includes: - A logistic model to model which of the two processes the zero outcome is associated with - A negative binomial model to model the count process</span>
<span id="cb384-993"><a href="#cb384-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-996"><a href="#cb384-996" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-997"><a href="#cb384-997" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TESTABS-ZINFNEGBINOM</span></span>
<span id="cb384-998"><a href="#cb384-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-999"><a href="#cb384-999" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#  for zeroinfl negbinomial</span></span>
<span id="cb384-1000"><a href="#cb384-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1001"><a href="#cb384-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span></span>
<span id="cb384-1002"><a href="#cb384-1002" aria-hidden="true" tabindex="-1"></a>zinb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(item_test_NABS <span class="sc">~</span> pretty_condition <span class="sc">|</span> pretty_condition , <span class="at">data =</span> df_subjects, <span class="at">dist =</span> <span class="st">"negbin"</span>)</span>
<span id="cb384-1003"><a href="#cb384-1003" aria-hidden="true" tabindex="-1"></a><span class="co">#before the | is the count part, after the | is the logit model</span></span>
<span id="cb384-1004"><a href="#cb384-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb384-1005"><a href="#cb384-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb384-1006"><a href="#cb384-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb384-1007"><a href="#cb384-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb384-1008"><a href="#cb384-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1009"><a href="#cb384-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#   rootogram(zinb.1)</span></span>
<span id="cb384-1010"><a href="#cb384-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1011"><a href="#cb384-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1012"><a href="#cb384-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1013"><a href="#cb384-1013" aria-hidden="true" tabindex="-1"></a><span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb384-1014"><a href="#cb384-1014" aria-hidden="true" tabindex="-1"></a><span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span></span>
<span id="cb384-1015"><a href="#cb384-1015" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate parameter estimates</span></span>
<span id="cb384-1016"><a href="#cb384-1016" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Exponentiated Estimates")</span></span>
<span id="cb384-1017"><a href="#cb384-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(est)</span></span>
<span id="cb384-1018"><a href="#cb384-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1019"><a href="#cb384-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-1020"><a href="#cb384-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1021"><a href="#cb384-1021" aria-hidden="true" tabindex="-1"></a>In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).</span>
<span id="cb384-1022"><a href="#cb384-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1023"><a href="#cb384-1023" aria-hidden="true" tabindex="-1"></a>In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition (exponentiate it?)</span>
<span id="cb384-1024"><a href="#cb384-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1025"><a href="#cb384-1025" aria-hidden="true" tabindex="-1"></a>**TODO come back to this and discuss further**\</span>
<span id="cb384-1026"><a href="#cb384-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1027"><a href="#cb384-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1028"><a href="#cb384-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1029"><a href="#cb384-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1030"><a href="#cb384-1030" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Comparison</span></span>
<span id="cb384-1031"><a href="#cb384-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1034"><a href="#cb384-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-1035"><a href="#cb384-1035" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(lm<span class="fl">.1</span>, p<span class="fl">.1</span>, nb<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span>
<span id="cb384-1036"><a href="#cb384-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-1037"><a href="#cb384-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1038"><a href="#cb384-1038" aria-hidden="true" tabindex="-1"></a>For modelling test phase absolute score (# items correct) it seems that the zero inflated negative binomial model is the best fit according to R2 and AIC, however, I am not clear on the implications of the interpretation (non significant in count process, significant on logit process), and also not clear if <span class="sc">\#</span> items correct is truly a count process.</span>
<span id="cb384-1039"><a href="#cb384-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1042"><a href="#cb384-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-1043"><a href="#cb384-1043" aria-hidden="true" tabindex="-1"></a><span class="co">#uncertainty model visualization</span></span>
<span id="cb384-1044"><a href="#cb384-1044" aria-hidden="true" tabindex="-1"></a><span class="co"># df %&gt;%</span></span>
<span id="cb384-1045"><a href="#cb384-1045" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data_grid(pretty_condition) %&gt;%</span></span>
<span id="cb384-1046"><a href="#cb384-1046" aria-hidden="true" tabindex="-1"></a>  <span class="co"># augment(m, newdata = ., se_fit = TRUE) %&gt;%</span></span>
<span id="cb384-1047"><a href="#cb384-1047" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot(aes(y = pretty_condition)) +</span></span>
<span id="cb384-1048"><a href="#cb384-1048" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_halfeye(</span></span>
<span id="cb384-1049"><a href="#cb384-1049" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   aes(xdist = dist_student_t(df = df.residual(m), </span></span>
<span id="cb384-1050"><a href="#cb384-1050" aria-hidden="true" tabindex="-1"></a>  <span class="co">#       mu = .fitted, sigma = .se.fit)), scale = .5) +</span></span>
<span id="cb384-1051"><a href="#cb384-1051" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # add raw data in too (scale = .5 above adjusts the halfeye height so</span></span>
<span id="cb384-1052"><a href="#cb384-1052" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # that the data fit in as well)</span></span>
<span id="cb384-1053"><a href="#cb384-1053" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_jitter(aes(x = x), data = df, pch = "|", size = 2, </span></span>
<span id="cb384-1054"><a href="#cb384-1054" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             position =   position_nudge(y = -.15), alpha = 0.5) +  </span></span>
<span id="cb384-1055"><a href="#cb384-1055" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs (title = "Model Estimates with Uncertainty", x = "model coefficient") + </span></span>
<span id="cb384-1056"><a href="#cb384-1056" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb384-1057"><a href="#cb384-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1058"><a href="#cb384-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-1059"><a href="#cb384-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1060"><a href="#cb384-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">#### HURLDE BETA Regression</span></span>
<span id="cb384-1061"><a href="#cb384-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1062"><a href="#cb384-1062" aria-hidden="true" tabindex="-1"></a>https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf</span>
<span id="cb384-1063"><a href="#cb384-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1066"><a href="#cb384-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-1067"><a href="#cb384-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span>
<span id="cb384-1068"><a href="#cb384-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1069"><a href="#cb384-1069" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE SAMPLE DATA </span></span>
<span id="cb384-1070"><a href="#cb384-1070" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> </span>
<span id="cb384-1071"><a href="#cb384-1071" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">0.40</span> </span>
<span id="cb384-1072"><a href="#cb384-1072" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.60</span> </span>
<span id="cb384-1073"><a href="#cb384-1073" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.13</span> </span>
<span id="cb384-1074"><a href="#cb384-1074" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.17</span> </span>
<span id="cb384-1075"><a href="#cb384-1075" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> p0<span class="sc">-</span> p1</span>
<span id="cb384-1076"><a href="#cb384-1076" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> mu <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> sigma <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> (sigma <span class="sc">^</span> <span class="dv">2</span>) </span>
<span id="cb384-1077"><a href="#cb384-1077" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> mu) <span class="sc">/</span> mu</span>
<span id="cb384-1078"><a href="#cb384-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1079"><a href="#cb384-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE DIST</span></span>
<span id="cb384-1080"><a href="#cb384-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1839</span>) </span>
<span id="cb384-1081"><a href="#cb384-1081" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, a, b) </span>
<span id="cb384-1082"><a href="#cb384-1082" aria-hidden="true" tabindex="-1"></a>cat <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, n, <span class="at">prob =</span> <span class="fu">c</span>(p0, p2, p1), <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb384-1083"><a href="#cb384-1083" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb384-1084"><a href="#cb384-1084" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb384-1085"><a href="#cb384-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1086"><a href="#cb384-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb384-1087"><a href="#cb384-1087" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y)</span>
<span id="cb384-1088"><a href="#cb384-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>x<span class="sc">$</span>y)</span>
<span id="cb384-1089"><a href="#cb384-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#this looks not unlike my distribution! </span></span>
<span id="cb384-1090"><a href="#cb384-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1091"><a href="#cb384-1091" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb384-1092"><a href="#cb384-1092" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb384-1093"><a href="#cb384-1093" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.sigma =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb384-1094"><a href="#cb384-1094" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.nu =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb384-1095"><a href="#cb384-1095" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.tau =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb384-1096"><a href="#cb384-1096" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">BEINF</span>() )</span>
<span id="cb384-1097"><a href="#cb384-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1098"><a href="#cb384-1098" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb384-1099"><a href="#cb384-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span>
<span id="cb384-1100"><a href="#cb384-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1101"><a href="#cb384-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb384-1102"><a href="#cb384-1102" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb384-1103"><a href="#cb384-1103" aria-hidden="true" tabindex="-1"></a>fit_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>mu.coefficients) </span>
<span id="cb384-1104"><a href="#cb384-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,fit_mu)</span>
<span id="cb384-1105"><a href="#cb384-1105" aria-hidden="true" tabindex="-1"></a>fit_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb384-1106"><a href="#cb384-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,fit_sigma)</span>
<span id="cb384-1107"><a href="#cb384-1107" aria-hidden="true" tabindex="-1"></a>fit_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>nu.coefficients) </span>
<span id="cb384-1108"><a href="#cb384-1108" aria-hidden="true" tabindex="-1"></a>fit_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>tau.coefficients) </span>
<span id="cb384-1109"><a href="#cb384-1109" aria-hidden="true" tabindex="-1"></a>fit_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb384-1110"><a href="#cb384-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,fit_p0)</span>
<span id="cb384-1111"><a href="#cb384-1111" aria-hidden="true" tabindex="-1"></a>fit_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb384-1112"><a href="#cb384-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,fit_p1)</span>
<span id="cb384-1113"><a href="#cb384-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1114"><a href="#cb384-1114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-1115"><a href="#cb384-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1116"><a href="#cb384-1116" aria-hidden="true" tabindex="-1"></a>**BETA HURDLE INTERPRETATION** - beta component\</span>
<span id="cb384-1117"><a href="#cb384-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MU "location" (mean)\</span>
<span id="cb384-1118"><a href="#cb384-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SIGMA "scale" (positively related to variance; variance = sigma.squared *mean* (1-mean)\</span>
<span id="cb384-1119"><a href="#cb384-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rigby, Stasinopoulos, Heller, and De Bastiani (2017) "reparameterized" the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</span>
<span id="cb384-1120"><a href="#cb384-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1121"><a href="#cb384-1121" aria-hidden="true" tabindex="-1"></a>**ZERO-ONE HURDLE COMPONENT**\</span>
<span id="cb384-1122"><a href="#cb384-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.\</span>
<span id="cb384-1123"><a href="#cb384-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p0 is the probability that a case equals 0,\</span>
<span id="cb384-1124"><a href="#cb384-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p1 is the probability that a case equals 1,\</span>
<span id="cb384-1125"><a href="#cb384-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</span>
<span id="cb384-1126"><a href="#cb384-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1129"><a href="#cb384-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-1130"><a href="#cb384-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb384-1131"><a href="#cb384-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1132"><a href="#cb384-1132" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> <span class="dv">0</span> <span class="co">#min possible value of scale</span></span>
<span id="cb384-1133"><a href="#cb384-1133" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="dv">8</span> <span class="co">#max possible value of scale</span></span>
<span id="cb384-1134"><a href="#cb384-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1135"><a href="#cb384-1135" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#for shuffling</span></span>
<span id="cb384-1136"><a href="#cb384-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Rescale accuracy using </span></span>
<span id="cb384-1137"><a href="#cb384-1137" aria-hidden="true" tabindex="-1"></a><span class="co"># recommended adjustment </span></span>
<span id="cb384-1138"><a href="#cb384-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#rescaled = value-min/(max-min)</span></span>
<span id="cb384-1139"><a href="#cb384-1139" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb384-1140"><a href="#cb384-1140" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> item_test_NABS,</span>
<span id="cb384-1141"><a href="#cb384-1141" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_acc =</span> (accuracy<span class="sc">-</span>min)<span class="sc">/</span>(max<span class="sc">-</span>min), <span class="co">#as %</span></span>
<span id="cb384-1142"><a href="#cb384-1142" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_acc =</span> (accuracy <span class="sc">*</span> (<span class="fu">nrow</span>(df)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">8</span>, <span class="co">#transform for no 0 and 1</span></span>
<span id="cb384-1143"><a href="#cb384-1143" aria-hidden="true" tabindex="-1"></a>  <span class="at">perm =</span> <span class="fu">shuffle</span>(condition),</span>
<span id="cb384-1144"><a href="#cb384-1144" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_rt =</span> item_scaffold_rt</span>
<span id="cb384-1145"><a href="#cb384-1145" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy,R_acc, T_acc, condition, perm,scaffold_rt)</span>
<span id="cb384-1146"><a href="#cb384-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1147"><a href="#cb384-1147" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb384-1148"><a href="#cb384-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of accuracy"</span>)</span>
<span id="cb384-1149"><a href="#cb384-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1150"><a href="#cb384-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb384-1151"><a href="#cb384-1151" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>T_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of [rescaled] accuracy"</span>)</span>
<span id="cb384-1152"><a href="#cb384-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1153"><a href="#cb384-1153" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>perm, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>perm) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of shuffled accuracy"</span>)</span>
<span id="cb384-1154"><a href="#cb384-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1155"><a href="#cb384-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#SUMMARIZE SAMPLE</span></span>
<span id="cb384-1156"><a href="#cb384-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Grand mean"</span>, <span class="fu">mean</span>(df<span class="sc">$</span>R_acc))</span>
<span id="cb384-1157"><a href="#cb384-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1158"><a href="#cb384-1158" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb384-1159"><a href="#cb384-1159" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> <span class="fu">favstats</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb384-1160"><a href="#cb384-1160" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb384-1161"><a href="#cb384-1161" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">var</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb384-1162"><a href="#cb384-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Grand stats"</span>)</span>
<span id="cb384-1163"><a href="#cb384-1163" aria-hidden="true" tabindex="-1"></a>stats </span>
<span id="cb384-1164"><a href="#cb384-1164" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P0"</span>)</span>
<span id="cb384-1165"><a href="#cb384-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">0</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb384-1166"><a href="#cb384-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P1"</span>)</span>
<span id="cb384-1167"><a href="#cb384-1167" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">1</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb384-1168"><a href="#cb384-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1169"><a href="#cb384-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb384-1170"><a href="#cb384-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1171"><a href="#cb384-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb384-1172"><a href="#cb384-1172" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb384-1173"><a href="#cb384-1173" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.sigma =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb384-1174"><a href="#cb384-1174" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.nu =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb384-1175"><a href="#cb384-1175" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.tau =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb384-1176"><a href="#cb384-1176" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">BEINF</span>(), <span class="at">data =</span> df )</span>
<span id="cb384-1177"><a href="#cb384-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1178"><a href="#cb384-1178" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb384-1179"><a href="#cb384-1179" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb384-1180"><a href="#cb384-1180" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb384-1181"><a href="#cb384-1181" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m0)</span>
<span id="cb384-1182"><a href="#cb384-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1183"><a href="#cb384-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb384-1184"><a href="#cb384-1184" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb384-1185"><a href="#cb384-1185" aria-hidden="true" tabindex="-1"></a>m0_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>mu.coefficients) </span>
<span id="cb384-1186"><a href="#cb384-1186" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m0_mu)</span>
<span id="cb384-1187"><a href="#cb384-1187" aria-hidden="true" tabindex="-1"></a>m0_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb384-1188"><a href="#cb384-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m0_sigma)</span>
<span id="cb384-1189"><a href="#cb384-1189" aria-hidden="true" tabindex="-1"></a>m0_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>nu.coefficients) </span>
<span id="cb384-1190"><a href="#cb384-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m0_nu)</span>
<span id="cb384-1191"><a href="#cb384-1191" aria-hidden="true" tabindex="-1"></a>m0_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>tau.coefficients) </span>
<span id="cb384-1192"><a href="#cb384-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m0_tau)</span>
<span id="cb384-1193"><a href="#cb384-1193" aria-hidden="true" tabindex="-1"></a>m0_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb384-1194"><a href="#cb384-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,m0_p0)</span>
<span id="cb384-1195"><a href="#cb384-1195" aria-hidden="true" tabindex="-1"></a>m0_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb384-1196"><a href="#cb384-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,m0_p1)</span>
<span id="cb384-1197"><a href="#cb384-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1198"><a href="#cb384-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1199"><a href="#cb384-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1200"><a href="#cb384-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL</span></span>
<span id="cb384-1201"><a href="#cb384-1201" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, </span>
<span id="cb384-1202"><a href="#cb384-1202" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb384-1203"><a href="#cb384-1203" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb384-1204"><a href="#cb384-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1205"><a href="#cb384-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#LOOKING PREDICTOR MODEL</span></span>
<span id="cb384-1206"><a href="#cb384-1206" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition , </span>
<span id="cb384-1207"><a href="#cb384-1207" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb384-1208"><a href="#cb384-1208" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb384-1209"><a href="#cb384-1209" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb384-1210"><a href="#cb384-1210" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb384-1211"><a href="#cb384-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb384-1212"><a href="#cb384-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1213"><a href="#cb384-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1214"><a href="#cb384-1214" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION </span><span class="al">TEST</span><span class="co">]</span></span>
<span id="cb384-1215"><a href="#cb384-1215" aria-hidden="true" tabindex="-1"></a>mperm <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> perm, <span class="sc">~</span> perm, <span class="sc">~</span> perm, <span class="sc">~</span> perm, </span>
<span id="cb384-1216"><a href="#cb384-1216" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb384-1217"><a href="#cb384-1217" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mperm)</span>
<span id="cb384-1218"><a href="#cb384-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1219"><a href="#cb384-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check with scaled outcome, no zeros ones</span></span>
<span id="cb384-1220"><a href="#cb384-1220" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(T_acc <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, </span>
<span id="cb384-1221"><a href="#cb384-1221" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb384-1222"><a href="#cb384-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span>
<span id="cb384-1223"><a href="#cb384-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span></span>
<span id="cb384-1224"><a href="#cb384-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1225"><a href="#cb384-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#investigate beta negative binomial distribution</span></span>
<span id="cb384-1226"><a href="#cb384-1226" aria-hidden="true" tabindex="-1"></a><span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span></span>
<span id="cb384-1227"><a href="#cb384-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1228"><a href="#cb384-1228" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb384-1229"><a href="#cb384-1229" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb384-1230"><a href="#cb384-1230" aria-hidden="true" tabindex="-1"></a>m1_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m1<span class="sc">$</span>mu.coefficients) </span>
<span id="cb384-1231"><a href="#cb384-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m1_mu)</span>
<span id="cb384-1232"><a href="#cb384-1232" aria-hidden="true" tabindex="-1"></a>m1_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb384-1233"><a href="#cb384-1233" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m1_sigma)</span>
<span id="cb384-1234"><a href="#cb384-1234" aria-hidden="true" tabindex="-1"></a>m1_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>nu.coefficients) </span>
<span id="cb384-1235"><a href="#cb384-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m1_nu)</span>
<span id="cb384-1236"><a href="#cb384-1236" aria-hidden="true" tabindex="-1"></a>m1_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>tau.coefficients) </span>
<span id="cb384-1237"><a href="#cb384-1237" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m1_tau)</span>
<span id="cb384-1238"><a href="#cb384-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1239"><a href="#cb384-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb384-1240"><a href="#cb384-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span>
<span id="cb384-1241"><a href="#cb384-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1242"><a href="#cb384-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1243"><a href="#cb384-1243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-1244"><a href="#cb384-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1245"><a href="#cb384-1245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MU tells if mean is different by condition\</span>
<span id="cb384-1246"><a href="#cb384-1246" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SIGMA tells if variance is different by condition\</span>
<span id="cb384-1247"><a href="#cb384-1247" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NU coefficient tells if condition yields different probability at floor</span>
<span id="cb384-1248"><a href="#cb384-1248" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAU coefficient tells if condition yields different probability at ceiling</span>
<span id="cb384-1249"><a href="#cb384-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1250"><a href="#cb384-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Beta Regression (% Correct)</span></span>
<span id="cb384-1251"><a href="#cb384-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1252"><a href="#cb384-1252" aria-hidden="true" tabindex="-1"></a>Beta regression on % correct (with standard transformation for including <span class="sc">\[</span>0,1<span class="sc">\]</span>) https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression</span>
<span id="cb384-1253"><a href="#cb384-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1256"><a href="#cb384-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-1257"><a href="#cb384-1257" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1258"><a href="#cb384-1258" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg)</span>
<span id="cb384-1259"><a href="#cb384-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1260"><a href="#cb384-1260" aria-hidden="true" tabindex="-1"></a><span class="co">#RESCLAE VARIABLE</span></span>
<span id="cb384-1261"><a href="#cb384-1261" aria-hidden="true" tabindex="-1"></a><span class="co">#beta reg can't handle 0s and 1s </span></span>
<span id="cb384-1262"><a href="#cb384-1262" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, DV_percent_NABS)</span>
<span id="cb384-1263"><a href="#cb384-1263" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(sub) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb384-1264"><a href="#cb384-1264" aria-hidden="true" tabindex="-1"></a>sub<span class="sc">$</span>dv_transformed <span class="ot">=</span> (sub<span class="sc">$</span>DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb384-1265"><a href="#cb384-1265" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb384-1266"><a href="#cb384-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE VARIABLES</span></span>
<span id="cb384-1267"><a href="#cb384-1267" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(sub<span class="sc">$</span>dv_transformed)</span>
<span id="cb384-1268"><a href="#cb384-1268" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>dv_transformed, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> sub) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition)</span>
<span id="cb384-1269"><a href="#cb384-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1270"><a href="#cb384-1270" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb384-1271"><a href="#cb384-1271" aria-hidden="true" tabindex="-1"></a>mb <span class="ot">&lt;-</span> <span class="fu">betareg</span>(dv_transformed <span class="sc">~</span> condition, <span class="at">data =</span> sub)</span>
<span id="cb384-1272"><a href="#cb384-1272" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mb)</span>
<span id="cb384-1273"><a href="#cb384-1273" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mb)</span>
<span id="cb384-1274"><a href="#cb384-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1275"><a href="#cb384-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-1276"><a href="#cb384-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1277"><a href="#cb384-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">#### WIP \| HURDLE MODEL</span></span>
<span id="cb384-1278"><a href="#cb384-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1279"><a href="#cb384-1279" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://data.library.virginia.edu/getting-started-with-hurdle-models/\</span>
<span id="cb384-1280"><a href="#cb384-1280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://en.wikipedia.org/wiki/Hurdle_model#:\~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.</span>
<span id="cb384-1281"><a href="#cb384-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1282"><a href="#cb384-1282" aria-hidden="true" tabindex="-1"></a>class of models for count data with both overdispersion and excess zeros;\</span>
<span id="cb384-1283"><a href="#cb384-1283" aria-hidden="true" tabindex="-1"></a>different from zero-inflated models where the excess zeros are theorized to arise from two different processes; in the hurdle model, there is a model for P(x=0) and a separate model for P(x!=0)</span>
<span id="cb384-1284"><a href="#cb384-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1285"><a href="#cb384-1285" aria-hidden="true" tabindex="-1"></a>The model includes: - A binary logit model to model whether the observation takes a positive count or not. - a truncated Poisson or Negative binomial model that only fits positive counts</span>
<span id="cb384-1286"><a href="#cb384-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1287"><a href="#cb384-1287" aria-hidden="true" tabindex="-1"></a>This allows us to model: (1) Does the student get *any* questions right? (2) How many questions does the student get right?</span>
<span id="cb384-1288"><a href="#cb384-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1291"><a href="#cb384-1291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-1292"><a href="#cb384-1292" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zero-inf and hurdle models </span></span>
<span id="cb384-1293"><a href="#cb384-1293" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countreg) <span class="co">#rootogram</span></span>
<span id="cb384-1294"><a href="#cb384-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span></span>
<span id="cb384-1295"><a href="#cb384-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1296"><a href="#cb384-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span></span>
<span id="cb384-1297"><a href="#cb384-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1298"><a href="#cb384-1298" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.1</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(item_test_NABS <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df_subjects,</span>
<span id="cb384-1299"><a href="#cb384-1299" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb384-1300"><a href="#cb384-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1301"><a href="#cb384-1301" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.2</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(item_test_NABS <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df_subjects,</span>
<span id="cb384-1302"><a href="#cb384-1302" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"negbin"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb384-1303"><a href="#cb384-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1304"><a href="#cb384-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.1</span>)</span>
<span id="cb384-1305"><a href="#cb384-1305" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.2</span>)</span>
<span id="cb384-1306"><a href="#cb384-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1307"><a href="#cb384-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1308"><a href="#cb384-1308" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.1</span>)</span>
<span id="cb384-1309"><a href="#cb384-1309" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.2</span>)</span>
<span id="cb384-1310"><a href="#cb384-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(h<span class="fl">.1</span>,h<span class="fl">.2</span>)</span>
<span id="cb384-1311"><a href="#cb384-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1312"><a href="#cb384-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1313"><a href="#cb384-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-1314"><a href="#cb384-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1315"><a href="#cb384-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">## WIP UNKNOWN</span></span>
<span id="cb384-1316"><a href="#cb384-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1317"><a href="#cb384-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cummulative Ordinal (Bayesian)</span></span>
<span id="cb384-1318"><a href="#cb384-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1319"><a href="#cb384-1319" aria-hidden="true" tabindex="-1"></a>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb384-1320"><a href="#cb384-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1323"><a href="#cb384-1323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-1324"><a href="#cb384-1324" aria-hidden="true" tabindex="-1"></a><span class="co"># library(brms)</span></span>
<span id="cb384-1325"><a href="#cb384-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1326"><a href="#cb384-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1327"><a href="#cb384-1327" aria-hidden="true" tabindex="-1"></a><span class="co"># #DEFINE DATA </span></span>
<span id="cb384-1328"><a href="#cb384-1328" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_items %&gt;% mutate(</span></span>
<span id="cb384-1329"><a href="#cb384-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#   scaled = factor(score_SCALED, ordered = TRUE,  #ordered factor</span></span>
<span id="cb384-1330"><a href="#cb384-1330" aria-hidden="true" tabindex="-1"></a><span class="co">#                     levels = c("-1", "-0.5", "0", "0.5","1"))</span></span>
<span id="cb384-1331"><a href="#cb384-1331" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb384-1332"><a href="#cb384-1332" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1333"><a href="#cb384-1333" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum &lt;- brm( formula = scaled ~ condition,</span></span>
<span id="cb384-1334"><a href="#cb384-1334" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = df,</span></span>
<span id="cb384-1335"><a href="#cb384-1335" aria-hidden="true" tabindex="-1"></a><span class="co">#                family = cumulative("probit"),</span></span>
<span id="cb384-1336"><a href="#cb384-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#                file = "analysis/SGC3A/models/m_items_ord.cum.rds" # cache model (can be removed)  </span></span>
<span id="cb384-1337"><a href="#cb384-1337" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1338"><a href="#cb384-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb384-1339"><a href="#cb384-1339" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1340"><a href="#cb384-1340" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(ord_cum)</span></span>
<span id="cb384-1341"><a href="#cb384-1341" aria-hidden="true" tabindex="-1"></a><span class="co"># conditional_effects(ord_cum, "condition", categorical = TRUE)</span></span>
<span id="cb384-1342"><a href="#cb384-1342" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1343"><a href="#cb384-1343" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT</span></span>
<span id="cb384-1344"><a href="#cb384-1344" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sjPlot)</span></span>
<span id="cb384-1345"><a href="#cb384-1345" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(ord_cum)</span></span>
<span id="cb384-1346"><a href="#cb384-1346" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1347"><a href="#cb384-1347" aria-hidden="true" tabindex="-1"></a><span class="co"># # m %&gt;%</span></span>
<span id="cb384-1348"><a href="#cb384-1348" aria-hidden="true" tabindex="-1"></a><span class="co"># #   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb384-1349"><a href="#cb384-1349" aria-hidden="true" tabindex="-1"></a><span class="co"># #   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb384-1350"><a href="#cb384-1350" aria-hidden="true" tabindex="-1"></a><span class="co"># #   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb384-1351"><a href="#cb384-1351" aria-hidden="true" tabindex="-1"></a><span class="co"># #   stat_halfeye()</span></span>
<span id="cb384-1352"><a href="#cb384-1352" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1353"><a href="#cb384-1353" aria-hidden="true" tabindex="-1"></a><span class="co"># # performance(ord_cum)</span></span>
<span id="cb384-1354"><a href="#cb384-1354" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot(ord_cum)</span></span>
<span id="cb384-1355"><a href="#cb384-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb384-1356"><a href="#cb384-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1357"><a href="#cb384-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjacent-Category Ordinal (Bayesian)</span></span>
<span id="cb384-1358"><a href="#cb384-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1361"><a href="#cb384-1361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb384-1362"><a href="#cb384-1362" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1363"><a href="#cb384-1363" aria-hidden="true" tabindex="-1"></a><span class="co"># #DEFINE DATA </span></span>
<span id="cb384-1364"><a href="#cb384-1364" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_items %&gt;% mutate(</span></span>
<span id="cb384-1365"><a href="#cb384-1365" aria-hidden="true" tabindex="-1"></a><span class="co">#   scaled = factor(score_SCALED, ordered = TRUE,  #ordered factor</span></span>
<span id="cb384-1366"><a href="#cb384-1366" aria-hidden="true" tabindex="-1"></a><span class="co">#                     levels = c("-1", "-0.5", "0", "0.5","1"))</span></span>
<span id="cb384-1367"><a href="#cb384-1367" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb384-1368"><a href="#cb384-1368" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1369"><a href="#cb384-1369" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1370"><a href="#cb384-1370" aria-hidden="true" tabindex="-1"></a><span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span></span>
<span id="cb384-1371"><a href="#cb384-1371" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1372"><a href="#cb384-1372" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_acat &lt;- brm( formula = scaled ~ cs(condition),</span></span>
<span id="cb384-1373"><a href="#cb384-1373" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = df,</span></span>
<span id="cb384-1374"><a href="#cb384-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#                family = acat("probit"),</span></span>
<span id="cb384-1375"><a href="#cb384-1375" aria-hidden="true" tabindex="-1"></a><span class="co">#                file = "analysis/SGC3A/models/m_items_ord.acat.rds" # cache model (can be removed)  </span></span>
<span id="cb384-1376"><a href="#cb384-1376" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb384-1377"><a href="#cb384-1377" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1378"><a href="#cb384-1378" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(ord_acat)</span></span>
<span id="cb384-1379"><a href="#cb384-1379" aria-hidden="true" tabindex="-1"></a><span class="co"># conditional_effects(ord_cum, "condition", categorical = TRUE)</span></span>
<span id="cb384-1380"><a href="#cb384-1380" aria-hidden="true" tabindex="-1"></a><span class="co"># conditional_effects(ord_acat, "condition", categorical = TRUE)</span></span>
<span id="cb384-1381"><a href="#cb384-1381" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1382"><a href="#cb384-1382" aria-hidden="true" tabindex="-1"></a><span class="co"># #TIDYBAYES VISUALIZATION</span></span>
<span id="cb384-1383"><a href="#cb384-1383" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidybayes)</span></span>
<span id="cb384-1384"><a href="#cb384-1384" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_acat %&gt;%</span></span>
<span id="cb384-1385"><a href="#cb384-1385" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb384-1386"><a href="#cb384-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb384-1387"><a href="#cb384-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb384-1388"><a href="#cb384-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb384-1389"><a href="#cb384-1389" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb384-1390"><a href="#cb384-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1391"><a href="#cb384-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-1392"><a href="#cb384-1392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>