<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.640">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>SGC-X - 4&nbsp; Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../analysis/SGC3A/5_sgc3A_exploration.html" rel="next">
<link href="../../analysis/SGC3A/3_sgc3A_description.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/x_learning.html" class="sidebar-item-text sidebar-link">Modelling Reference</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_hypotesting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/5_sgc3A_exploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploratory Analyses</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC5A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/1_sgc5A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/2_sgc5A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">COMBINED</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/combined/combined.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#h1a-q1-accuracy" id="toc-h1a-q1-accuracy" class="nav-link active" data-scroll-target="#h1a-q1-accuracy">H1A | Q1 ACCURACY</a>
  <ul class="collapse">
<li>
<a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">LOGISTIC REGRESSION</a>
  <ul class="collapse">
<li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo">TODO</a></li>
  </ul>
</li>
  <li><a href="#todo-ordinal-regression" id="toc-todo-ordinal-regression" class="nav-link" data-scroll-target="#todo-ordinal-regression">TODO ORDINAL REGRESSION</a></li>
  </ul>
</li>
  <li>
<a href="#h1b-overall-accuracy" id="toc-h1b-overall-accuracy" class="nav-link" data-scroll-target="#h1b-overall-accuracy">H1B | OVERALL ACCURACY</a>
  <ul class="collapse">
<li>
<a href="#mixed-logistic-regression" id="toc-mixed-logistic-regression" class="nav-link" data-scroll-target="#mixed-logistic-regression">MIXED LOGISTIC REGRESSION</a>
  <ul class="collapse">
<li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1">Fit Model</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  <li><a href="#inference-1" id="toc-inference-1" class="nav-link" data-scroll-target="#inference-1">Inference</a></li>
  <li><a href="#todo-1" id="toc-todo-1" class="nav-link" data-scroll-target="#todo-1">TODO</a></li>
  </ul>
</li>
  <li><a href="#todo-ordinal-regression-on-item-interpretation" id="toc-todo-ordinal-regression-on-item-interpretation" class="nav-link" data-scroll-target="#todo-ordinal-regression-on-item-interpretation">TODO | Ordinal Regression on ITEM-Interpretation</a></li>
  <li><a href="#shift-in-modal-mass" id="toc-shift-in-modal-mass" class="nav-link" data-scroll-target="#shift-in-modal-mass">SHIFT IN MODAL MASS</a></li>
  </ul>
</li>
  <li>
<a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">RESOURCES</a>
  <ul class="collapse">
<li><a href="#logistic-regression-notes" id="toc-logistic-regression-notes" class="nav-link" data-scroll-target="#logistic-regression-notes">Logistic Regression Notes</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-SGC3A-hypotesting" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Study SGC3A | 4 Hypothesis Testing</p>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div style="page-break-after: always;"></div>
<p><strong>TODO</strong></p>
<ul>
<li>ORDINAL models on interpretation scale<br>
</li>
<li>HURDLE MODEL? (mixture model w/ 0 + count)</li>
<li>review models already created in ARCHIVE?</li>
<li>separate combined (vs) lab (vs) online replication [once analysis strategy locked down]</li>
</ul>
<p><em>The purpose of this notebook is test the hypotheses that determined the design of the SGC3A study.</em></p>
<table class="table">
<colgroup><col style="width: 30%"></colgroup>
<thead><tr class="header">
<th>Pre-Requisite</th>
</tr></thead>
<tbody><tr class="odd">
<td>2_sgc3A_scoring.qmd</td>
</tr></tbody>
</table>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span> <span class="co"># %nin% operator</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span> <span class="co">#arrange plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span> <span class="co">#arrange shift function plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/ggformula">ggformula</a></span><span class="op">)</span> <span class="co">#easy graphs</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=vcdExtra">vcdExtra</a></span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span> <span class="co">#printing tables </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co">#visualize model coefficients</span>

<span class="co">#plot model estimates with uncertainty</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/">ggdist</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://modelr.tidyverse.org">modelr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.mitchelloharawild.com/distributional/">distributional</a></span><span class="op">)</span>

<span class="co">#models and performance</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR">lmerTest</a></span><span class="op">)</span> <span class="co">#for CIs in glmer </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a></span><span class="op">)</span> <span class="co">#plots w/ embedded stats</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/">report</a></span><span class="op">)</span> <span class="co">#easystats reporting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/">see</a></span><span class="op">)</span> <span class="co">#easystats visualization</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span> <span class="co">#easystats model diagnostics</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aloy/qqplotr">qqplotr</a></span><span class="op">)</span> <span class="co">#confint on qq plot</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gmodels</span><span class="op">)</span> <span class="co">#contingency table and CHISQR</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datalorax/equatiomatic">equatiomatic</a></span><span class="op">)</span> <span class="co">#extract model equation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zeroinfl / hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co">#mixed effects models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span> <span class="co">#visualization log regr models</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co">#ALL THE THINGS</span>

<span class="co">#OUTPUT OPTIONS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>ggplot2.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">1</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="co">#GRAPH THEMEING</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Research Questions</strong></p>
<p>In SGC3A we set out to answer the following question: Does posing a mental impasse improve performance on the graph comprehension task?</p>
<p><strong>Experimental Hypothesis</strong><br><em>Learners posed with scenario designed to evoke a mental impasse will be more likely to correct interpret the graph.</em></p>
<ul>
<li>H1A | Learners in the IMPASSE condition will be more likely to correctly answer the first question than learners in CONTROL.</li>
<li>H1B | Learners in the IMPASSE condition will score higher on the TEST Phase than learners in CONTROL.</li>
</ul>
<p><strong>Null Hypothesis</strong><br><em>No significant differences in performance will exist between learners in the IMPASSE and CONTROL conditions.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># HACK WD FOR LOCAL RUNNING?</span>
<span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="va">mbp</span> <span class="op">=</span> <span class="st">"/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="va">mbp</span><span class="op">)</span>

<span class="co">#IMPORT DATA </span>
<span class="va">df_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span><span class="op">)</span>
<span class="va">df_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span><span class="op">)</span>

<span class="co">#PREP DATA </span>
<span class="va">df_lab</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_mode</span> <span class="op">==</span> <span class="st">"laboratory"</span><span class="op">)</span>
<span class="va">df_online</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_mode</span> <span class="op">==</span> <span class="st">"online-replication"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="h1a-q1-accuracy" class="level2"><h2 class="anchored" data-anchor-id="h1a-q1-accuracy">H1A | Q1 ACCURACY</h2>
<p><strong>Do Ss in the IMPASSE condition have a higher likelihood of producing a correct response to the first question?</strong></p>
<p>The graph comprehension tasks includes 15 questions completed in sequence. But the first question the reader encounters (Q1) is the most important, as it is their <em>first exposure</em> to the unconventional triangular coordinate system.</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 90%">
</colgroup>
<thead><tr class="header">
<th>Research Question</th>
<th>Does the frequency of correct (vs) incorrect responses on the first question differ by condition? [Is response accuracy independent of condition?]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the IMPASSE condition will have a higher likelihood of correctly responding to the first question than those in the CONTROL condition</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td>
<p>data: <code>df_items</code> where <code>q == 1</code></p>
<p>outcome:</p>
<ul>
<li><p><em>accuracy</em> ( factor(incorrect/correct) from <code>score_niceABS</code> [absolute score]</p></li>
<li><p><em>interpretation</em> (ordered factor from <code>interpretation</code>)</p></li>
</ul>
<p>predictor: <code>condition</code> [between-subjects factor]</p>
</td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td>
<ol type="1">
<li>Logistic Regression on <code>accuracy</code> predicted by <code>condition</code>
<ul>
<li>account for difference in odds of correct score by condition</li>
</ul>
</li>
<li>Ordinal Regression on <code>interpretation</code> predicted by <code>condition</code>
<ul>
<li>account for difference in (ordered correctness of interpretation) by condition</li>
</ul>
</li>
</ol>
<p>Alternative:</p>
<ul>
<li>Chi-Square test of independence on outcome <code>score_niceABS</code> by <code>condition</code>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td><strong>Notes</strong></td>
<td><ul>
<li>CHIQ SQR is simplest method to examine independence of two categorical factors; LOGISTIC REGRESSION is recommended for binomial ~ continuous; though with regression we can quantify the size of the effect and overall model fit</li>
<li>independence assumption : (CHI SQR) as we only consider responses on the first question, each observation corresponds to an individual subject, and are thus independent</li>
<li>cell frequency : (CHI SQR) expected frequency in each cell of the contingency table is greater than 5 (more than 5 correct , more than 5 incorrect responses)</li>
</ul></td>
</tr>
</tbody>
</table>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FILTER THE DATASET [use subjects, bc it has covariates on that record]</span>
<span class="co"># df_q1 = df_items %&gt;% filter(q==1) %&gt;% mutate(</span>
<span class="co">#   accuracy = recode_factor(score_niceABS, "0" = "incorrect", "1"="correct")</span>
<span class="co"># )</span>
<span class="va">df_q1</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">item_q1_NABS</span>, <span class="st">"0"</span> <span class="op">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"correct"</span><span class="op">)</span>,
  rt <span class="op">=</span> <span class="va">item_q1_rt</span>
<span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>
  <span class="va">accuracy</span>, <span class="va">rt</span>, <span class="va">pretty_condition</span>, <span class="va">pretty_mode</span>
<span class="op">)</span>

<span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="co"># gf_props(~accuracy, fill = ~pretty_condition, </span>
<span class="co">#        position = position_dodge(), data = df_q1) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_mode) +</span>
<span class="co">#    labs(x = "Correct Response on Q 1",</span>
<span class="co">#        title = "Accuracy on First Question by Condition",</span>
<span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses") #theme(legend.position = "none")</span>

<span class="co">#STACKED BAR CHART</span>
<span class="va">df_q1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "Correct Response on Q 1",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on First Question by Condition"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/SETUP-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A proportional bar chart visualizing the proportion of incorrect (vs) correct responses in each condition for each data collection modality (left/right facet) reveals that the pattern of responses appear the same regardless of the data collection modality. In both data collection sessions, the proportion of incorrect responses is much greater than the proportion of correct responses, regardless of condition (marginal probability of incorrect). In the impasse condition, the difference in proportions is smaller than the control condition (conditional probability of success in impasse; (i.e) There are more correct responses in the impasse condition than the control condition).</p>
<section id="logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="logistic-regression">LOGISTIC REGRESSION</h3>
<p><em>Fit a logistic regression (at the subject level), predicting Q1 accuracy (absolute score) by condition.</em></p>
<section id="fit-model" class="level4"><h4 class="anchored" data-anchor-id="fit-model">Fit Model</h4>
<p><em>First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#combined</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_q1</span> 

<span class="co"># FREQUENCY TABLE</span>
<span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span>
<span class="co"># addmargins(my.table) #counts</span>
<span class="co"># addmargins(prop.table(my.table)) #props</span>

<span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span>

<span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span>
<span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"EMPTY MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "EMPTY MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ 1, family = "binomial", data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.696  -0.696  -0.696  -0.696   1.753  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -1.294      0.134   -9.66   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 343.66  on 329  degrees of freedom
AIC: 345.7

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: 2 CONDITION model</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.819  -0.819  -0.548  -0.548   1.986  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.822      0.230   -7.93  2.2e-15 ***
pretty_conditionimpasse    0.901      0.285    3.16   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 333.07  on 328  degrees of freedom
AIC: 337.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: 3 TEST SUPERIOR FIT</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC wth predictor is lower than empty model?"</span>, <span class="va">m0</span><span class="op">$</span><span class="va">aic</span> <span class="op">&gt;</span> <span class="va">m1</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name | Model | df | df_diff |  Chi2 |     p
-------------------------------------------
m0   |   glm |  1 |         |       |      
m1   |   glm |  2 |       1 | 10.59 | 0.001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.00113745235691825"</code></pre>
</div>
</div>
<p><em>The Condition predictor significantly improves model fit.</em></p>
</section><section id="visualize" class="level4"><h4 class="anchored" data-anchor-id="visualize">Visualize</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># summary(m1)</span>

<span class="co">#: INTERPRET COEFFICIENTS</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- LOG ODDS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- LOG ODDS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                         2.5 % 97.5 %
(Intercept)             -2.299  -1.39
pretty_conditionimpasse  0.353   1.48</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#exponentiate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                              2.5 % 97.5 %
(Intercept)             0.162  0.10  0.248
pretty_conditionimpasse 2.463  1.42  4.374</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log | Score_spherical |   PCP
----------------------------------------------------------------------------------------------
337.074 | 344.673 |     0.031 | 0.404 | 1.008 |    0.505 |   -16.847 |           0.021 | 0.673</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model's explanatory power is weak (Tjur's R2 = 0.03). The model's intercept, corresponding to pretty_condition = control, is at -1.82 (95% CI [-2.30, -1.39], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.90, 95% CI [0.35, 1.48], p = 0.002; Std. beta = 0.90, 95% CI [0.35, 1.48])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PREDICTIONS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PREDICTIONS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Retrieve predictions as probabilities </span>
<span class="co"># (for each level of the predictor)</span>
<span class="va">p.control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m1</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pretty_condition<span class="op">=</span><span class="st">"control"</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Probability of success in control,"</span>, <span class="va">p.control</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in control, 0.139240506329147"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p.impasse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m1</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pretty_condition<span class="op">=</span><span class="st">"impasse"</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Probability of success in impasse,"</span>, <span class="va">p.impasse</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in impasse, 0.28488372093063"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PLOT</span>

<span class="co">#GGSTATS | MODEL | LOG ODDS </span>
<span class="co"># library(ggstatsplot)</span>
<span class="co"># ggcoefstats(m1, output = "plot") + labs(x = "Log Odds Estimate")</span>

<span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m1</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/MODEL-Q1ACC-LOG-combined-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="co"># plot_model(m1, type="pred",</span>
<span class="co">#            show.intercept = TRUE, </span>
<span class="co">#            show.values = TRUE,</span>
<span class="co">#            title = "Model Predicted Probability of Accuracy",</span>
<span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span>

<span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span>
<span class="co"># library(ggeffects)</span>
<span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggeffect</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">m1</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/MODEL-Q1ACC-LOG-combined-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SANITY CHECK SJPLOT</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics" class="level4"><h4 class="anchored" data-anchor-id="diagnostics">Diagnostics</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Ok: About 100% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="inference" class="level4"><h4 class="anchored" data-anchor-id="inference">Inference</h4>
<p>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the <em>impasse condition</em> increase by 146% (<span class="math inline">\(e^{beta_1}\)</span> = 2.46, 95% CI [1.42, 4.37]) over the <em>control condition</em>.</p>
<p><em>Equivalent statements:</em></p>
<ul>
<li>being in impasse condition increases log odds of correct response by 0.901 (over control)</li>
<li>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</li>
<li>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PRETTY TABLE SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.10&nbsp;–&nbsp;0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.42&nbsp;–&nbsp;4.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.002</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">330</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.031</td>
</tr>
</tbody></table>
</div>
</div>
</section><section id="todo" class="level4"><h4 class="anchored" data-anchor-id="todo">TODO</h4>
<ul>
<li>Are these residuals OK? I didn’t think normally distributed residuals were an assumption for logistic regression.</li>
<li>Interpretation/reporting of model fit?</li>
<li>sanity check correct interpretation of coefficients &amp; reporting</li>
</ul></section></section><section id="todo-ordinal-regression" class="level3"><h3 class="anchored" data-anchor-id="todo-ordinal-regression">TODO ORDINAL REGRESSION</h3>
<p><em>Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.</em></p>
<ul>
<li>https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</li>
<li>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</li>
<li>todo see ordinal regression video</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># #CREATE DATAFRAME OF Q1</span>
<span class="co"># df &lt;- df_items %&gt;% filter(q ==1) %&gt;% mutate(scaled = as.factor(score_SCALED))</span>
<span class="co"># </span>
<span class="co"># #MODEL</span>
<span class="co"># m &lt;- polr(scaled ~ condition , data = df, Hess=TRUE)</span>
<span class="co"># summary(m)</span>
<span class="co"># confint(m)</span>
<span class="co"># performance(m)</span>
<span class="co"># report(m)</span>
<span class="co"># </span>
<span class="co"># #exponentiate coefficients and CIs </span>
<span class="co"># ci &lt;- confint(m)</span>
<span class="co"># ci</span>
<span class="co"># e &lt;- coef(m)</span>
<span class="co"># e</span>
<span class="co"># # exp(cbind(e,ci))</span>
<span class="co"># </span>
<span class="co"># # Retrieve predictions as probabilities </span>
<span class="co"># # (for each level of the predictor)</span>
<span class="co"># # p.control &lt;- predict(m,data.frame(condition="111"),type="response")</span>
<span class="co"># # paste("Probability of success in control,", p.control)</span>
<span class="co"># # p.impasse &lt;- predict(m,data.frame(condition="121"),type="response")</span>
<span class="co"># # paste("Probability of success in impasse,", p.impasse)</span>
<span class="co"># </span>
<span class="co"># # Plot Predicted data and original data points</span>
<span class="co"># # ggplot(df, aes(x=condition, y=accuracy)) + </span>
<span class="co"># #   geom_point() +</span>
<span class="co"># #   stat_smooth(method="glm", color="green", se=FALSE,</span>
<span class="co"># #                 method.args = list(family=binomial))</span>
<span class="co">#   </span>
<span class="co"># #TO PLOT ALL EFFECTS</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(m))</span>
<span class="co"># </span>
<span class="co"># #SJPLOT</span>
<span class="co"># library(sjPlot)</span>
<span class="co"># plot_model(m, )</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># #CONVERT TO PROBABILITIES</span>
<span class="co"># newdat &lt;- data.frame(condition=c("111","121"))</span>
<span class="co"># prob &lt;- (phat &lt;- predict(object = m, newdat, type="p"))</span>
<span class="co"># prob</span>
<span class="co"># </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="h1b-overall-accuracy" class="level2"><h2 class="anchored" data-anchor-id="h1b-overall-accuracy">H1B | OVERALL ACCURACY</h2>
<p><strong>Do Ss in the IMPASSE condition have higher scores across the entire task?</strong></p>
<p>The graph comprehension tasks includes 13 interpretation-discriminant questions completed in sequence.</p>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<thead><tr class="header">
<th>Research Question</th>
<th>Do Ss in the IMPASSE condition score higher across the entire task than those in the CONTROL group.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>(H1B) Participants in the IMPASSE condition will have higher test phase performance than those in the CONTROL condition.</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td>
<p><strong>data</strong>: <code>df_items</code> where <code>q nin 6,9</code> (the 13 discriminating Qs ), <code>df_subjects</code></p>
<p><strong>outcome</strong>:</p>
<ul>
<li>[at item level]
<ul>
<li>
<em>accuracy</em> ( factor(incorrect/correct) from <code>score_niceABS</code> [absolute score]</li>
<li>
<em>interpretation</em> (ordered factor from <code>interpretation</code>)</li>
</ul>
</li>
<li>[subject level]
<ul>
<li>p_accuracy (percent of correct responses)</li>
</ul>
</li>
</ul>
<p><strong>predictor</strong>: <code>condition</code> [between-subjects factor]</p>
</td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>Mixed Logistic Regression<br><code>accuracy</code> ~ <code>condition</code> + (1 | <code>subject</code> )<br>
model effect of condition on probability of correct response [during test phase] while accounting for subject (and item-level?) effects</li>
<li>Ordinal Mixed Logistic Regression<br><code>interpretation</code> ~ <code>condition</code> + (1 | <code>subject</code> )<br>
model effect of condition on [ordered correctness of interpretation] [during test phase] while accounting for subject (and item-level?) effects</li>
<li>Shift in Modal Mass (descriptive)<br>
describe &amp; visualize shift in deciles between conditions for <code>`scaled_score`</code> (at subject level)</li>
</ol></td>
</tr>
<tr class="even">
<td><strong>Alternatives</strong></td>
<td><ul>
<li>OLS LINEAR REGRESSION
<ul>
<li>bimodal distribution at tails makes the mean a poor predictor; LMs violate assumptions of normally distributed residuals</li>
<li>lm <code>DV_percent_test_NABS</code> ~ <code>condition</code> (absolute scoring) OR lm <code>item_test_SCALED</code> ~ <code>condition</code> (scaled scoring)</li>
<li>both absolute and scaled scores yield non-normal residuals</li>
<li>no transformation of the outcome variables yield normal residuals</li>
</ul>
</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Notes</strong></td>
<td>
<p><strong>Also exploring:</strong></p>
<ul>
<li>Hurdle model (mixture model w/ binomial + [poisson or negbinom count; 0s from 1 DGP)</li>
<li>Zero Inflated model (mixture model w/ binomial + poisson or negbinom count; 0s from 2 DGPs)</li>
<li>Beta regression hurdle model? (mixture with location and scale parameters [mean, variance] and hurdles for floor and ceiling effects)</li>
<li>Other way to account for the severe bimodality?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PREPARE DATA </span>
<span class="va">n_items</span> <span class="op">=</span> <span class="fl">13</span> <span class="co">#number of items in test</span>

<span class="co">#item level</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_niceABS</span>, <span class="st">"0"</span> <span class="op">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"correct"</span><span class="op">)</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "Correct Response on Q 1",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on Task"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/SETUP-TEST-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="co"># gf_props(~accuracy, fill = ~pretty_condition, x =~pretty_condition,</span>
<span class="co">#        position = position_dodge(), data = df) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_mode) +</span>
<span class="co">#    labs(x = "Correct Responses in Test Phase",</span>
<span class="co">#        title = "Accuracy on Task by Condition",</span>
<span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses")</span>

 
<span class="co">#FACETED HISTOGRAM</span>
<span class="va">stats</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">pretty_condition</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">s_NABS</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">s_NABS</span>, 
         fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">pretty_mode</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_lines.html">gf_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stats</span>, xintercept <span class="op">=</span> <span class="op">~</span><span class="va">mean</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"# Correct"</span>,
       y <span class="op">=</span> <span class="st">"proportion of subjects"</span>,
       title <span class="op">=</span> <span class="st">"Overall Absolute Score (# Correct)"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/SETUP-TEST-ACC-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="mixed-logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="mixed-logistic-regression">MIXED LOGISTIC REGRESSION</h3>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.</em></p>
<section id="fit-model-1" class="level4"><h4 class="anchored" data-anchor-id="fit-model-1">Fit Model</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## 1 | SETUP RANDOM INTERCEPT SUBJECT</span>

<span class="co">#:: EMPTY MODEL (baseline, no random effect)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Empty fixed model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Empty fixed model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> 
<span class="va">m0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = accuracy ~ 1, family = "binomial", data = df)

Coefficients:
(Intercept)  
     -0.903  

Degrees of Freedom: 4289 Total (i.e. Null);  4289 Residual
Null Deviance:      5150 
Residual Deviance: 5150     AIC: 5160</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#:: RANDOM INTERCEPT SUBJECT</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Subject intercept random model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject intercept random model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">mm.rS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="va">mm.rS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ (1 | subject)
   Data: df
     AIC      BIC   logLik deviance df.resid 
    2588     2601    -1292     2584     4288 
Random effects:
 Groups  Name        Std.Dev.
 subject (Intercept) 4.25    
Number of obs: 4290, groups:  subject, 330
Fixed Effects:
(Intercept)  
      -2.96  </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># :: TEST random effect</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC decreases w/ new model?"</span>, <span class="va">m0</span><span class="op">$</span><span class="va">aic</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">mm.rS</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name  |    Model | df | df_diff |    Chi2 |      p
--------------------------------------------------
m0    |      glm |  1 |         |         |       
mm.rS | glmerMod |  2 |       1 | 2569.38 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## 2 | ADD RANDOM RANDOM INTERCEPT ITEM</span>

<span class="co">#:: RANDOM INTERCEPT SUBJECT + INTERCEPT Q</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Subject &amp; Question random intercepts"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject &amp; Question random intercepts"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">mm.rSQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">q</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="va">mm.rSQ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ (1 | subject) + (1 | q)
   Data: df
     AIC      BIC   logLik deviance df.resid 
    2476     2495    -1235     2470     4287 
Random effects:
 Groups  Name        Std.Dev.
 subject (Intercept) 4.622   
 q       (Intercept) 0.685   
Number of obs: 4290, groups:  subject, 330; q, 13
Fixed Effects:
(Intercept)  
       -3.2  </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># :: TEST random effect</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC decreases w/ new model?"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rSQ</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model? TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rS</span>,<span class="va">mm.rSQ</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical and probably only vary in
  their random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name   |    Model | df | df_diff |   Chi2 |      p
--------------------------------------------------
mm.rS  | glmerMod |  2 |         |        |       
mm.rSQ | glmerMod |  3 |       1 | 114.70 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rS</span>,<span class="va">mm.rSQ</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical and probably only vary in
  their random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  9.1748198033228e-27"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## 3 | ADD FIXED EFFECT</span>

<span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"FIXED Condition + Subject &amp; Question random intercepts"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "FIXED Condition + Subject &amp; Question random intercepts"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">mm.CrSQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">q</span><span class="op">)</span>, 
                data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="va">mm.CrSQ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition + (1 | subject) + (1 | q)
   Data: df
     AIC      BIC   logLik deviance df.resid 
    2439     2464    -1215     2431     4286 
Random effects:
 Groups  Name        Std.Dev.
 subject (Intercept) 4.773   
 q       (Intercept) 0.681   
Number of obs: 4290, groups:  subject, 330; q, 13
Fixed Effects:
            (Intercept)  pretty_conditionimpasse  
                  -5.68                     4.00  </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"AIC decreases w/ new model"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.rSQ</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mm.CrSQ</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model TRUE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rSQ</span>,<span class="va">mm.CrSQ</span><span class="op">)</span> <span class="co">#same as anova(m0, m1, test = "Chi")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison

Name    |    Model | df | df_diff |  Chi2 |      p
--------------------------------------------------
mm.rSQ  | glmerMod |  3 |         |       |       
mm.CrSQ | glmerMod |  4 |       1 | 38.72 | &lt; .001</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test is significant? p = "</span>,<span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html">test_lrt</a></span><span class="op">(</span><span class="va">mm.rSQ</span>,<span class="va">mm.CrSQ</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  4.88960391831629e-10"</code></pre>
</div>
</div>
</section><section id="visualize-1" class="level4"><h4 class="anchored" data-anchor-id="visualize-1">Visualize</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PRINT MODEL </span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"PREDICTOR MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition + (1 | subject) + (1 | q)
   Data: df

     AIC      BIC   logLik deviance df.resid 
    2439     2464    -1215     2431     4286 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-8.166 -0.154 -0.052  0.122  7.646 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 22.785   4.773   
 q       (Intercept)  0.463   0.681   
Number of obs: 4290, groups:  subject, 330; q, 13

Fixed effects:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -5.679      0.703   -8.08  6.3e-16 ***
pretty_conditionimpasse    4.003      0.726    5.51  3.5e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
prtty_cndtn -0.791</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: INTERPRET COEFFICIENTS</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma | Log_loss | Score_log | Score_spherical
--------------------------------------------------------------------------------------------------------------
2438.890 | 2464.346 |      0.892 |      0.131 | 0.876 | 0.229 | 1.000 |    0.174 |      -Inf |           0.005</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic mixed model (estimated using ML and Nelder-Mead optimizer) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model included subject and q as random effects (formula: list(~1 | subject, ~1 | q)). The model's total explanatory power is substantial (conditional R2 = 0.89) and the part related to the fixed effects alone (marginal R2) is of 0.13. The model's intercept, corresponding to pretty_condition = control, is at -5.68 (95% CI [-7.06, -4.30], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 4.00, 95% CI [2.58, 5.43], p &lt; .001; Std. beta = 4.00, 95% CI [2.58, 5.43])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#: PLOT</span>

<span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mm.CrSQ</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mm.CrSQ</span>, type<span class="op">=</span><span class="st">"pred"</span>,
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,
           show.values <span class="op">=</span> <span class="cn">TRUE</span>,
           title <span class="op">=</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,
           axis.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span>
<span class="co"># library(ggeffects)</span>
<span class="co"># ggeffect(model = mm.CrSQ) %&gt;% plot()</span>

<span class="co">#SANITY CHECK SJPLOT</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(mm.CrSQ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics-1" class="level4"><h4 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Warning: Probably bad model fit. Only about 37% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="inference-1" class="level4"><h4 class="anchored" data-anchor-id="inference-1">Inference</h4>
<p>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects and items; to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(4): 38.72, p &lt; 0.001); and the total explanatory power is substantial (conditional R2 = 0.89) and the part related to the fixed effects alone (marginal R2) is 0.13. Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 55 over the control condition <span class="math inline">\(e^{\beta_1}\)</span> = 54.79, 95% CI [13.2, 227.39], p &lt; 0.001.</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># PRETTY TABLE SJPLOT</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition: impasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">54.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">13.20&nbsp;–&nbsp;227.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">22.79</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>q</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.46</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.88</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>q</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">13</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">4290</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.131 / 0.892</td>
</tr>
</tbody></table>
</div>
</div>
</section><section id="todo-1" class="level4"><h4 class="anchored" data-anchor-id="todo-1">TODO</h4>
<ul>
<li>sanity check interpretation</li>
<li>sanity check random effects structure : ITEM appropriate as random intercept? What does it mean to have two random intercepts?</li>
<li>DIAGNOSTICS: What in the world is happening with the normality of random effects plot? Do the fixed effects residuals need to be normally distributed?</li>
<li>Are there other plots or recommended diagnostics for mixed log regression</li>
<li>consider multiple regression with rt, sequence cluster, confidence, etc.</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#STEPWISE FIT ALT </span>

<span class="co">#:: EMPTY MODEL (baseline, no random effect)</span>
<span class="co"># m0 = glm(accuracy ~ 1, family = "binomial", data = df) </span>

<span class="co">#:: EMPTY MODEL (baseline, no random effect)</span>
<span class="co"># m0 = glm(accuracy ~ 1, family = "binomial", data = df) </span>
<span class="co"># </span>
<span class="co"># #:: RANDOM INTERCEPT SUBJECT</span>
<span class="co"># mm.rS &lt;- glmer(accuracy ~ (1|subject), data = df,family = "binomial")</span>
<span class="co"># </span>
<span class="co"># # :: TEST random effect</span>
<span class="co"># paste("AIC with random effect is lower than glm empty model?", m0$aic &gt; AIC(logLik(mm.rS)))</span>
<span class="co"># test_lrt(m0,mm.rS) #same as anova(m0, m1, test = "Chi")</span>
<span class="co"># paste("Likelihood Ratio test is significant? p = ",(test_lrt(m0,mm.rS))$p[2])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="todo-ordinal-regression-on-item-interpretation" class="level3"><h3 class="anchored" data-anchor-id="todo-ordinal-regression-on-item-interpretation">TODO | Ordinal Regression on ITEM-Interpretation</h3>
</section><section id="shift-in-modal-mass" class="level3"><h3 class="anchored" data-anchor-id="shift-in-modal-mass">SHIFT IN MODAL MASS</h3>
<p>The Effect of Condition on Total Scaled Score can be described as a ‘shift’ in mass between the low and high modes of each distribution.</p>
<p><em>First, we use the Kolmogorov-Smirnov test as a Robust alternative to the t-test to test if the two distributions likely come from different populations.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># HACK WD FOR LOCAL RUNNING?</span>
<span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="va">mbp</span> <span class="op">=</span> <span class="st">"/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="va">mbp</span><span class="op">)</span>

<span class="co">#(requires shift function files loaded)</span>
<span class="co">#LOAD MODAL SHIFT FUNCTION RESOURCES</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"analysis/utils/shift_function/Rallfun-v30.txt"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"analysis/utils/shift_function/wilcox_modified.txt"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"analysis/utils/shift_function/rgar_visualisation.txt"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"analysis/utils/shift_function/rgar_utils.txt"</span><span class="op">)</span>
<span class="co">#NOTE: something in these breaks the stat_ecdf in ggplot2</span>

<span class="co">#PREP DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">s_SCALED</span>, <span class="va">pretty_condition</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">s_SCALED</span><span class="op">)</span>,
    <span class="co">#flip order levels to correctly orient graph</span>
    <span class="co"># gr = recode_factor(pretty_condition, "impasse" = "impasse", "control"="control")</span>
    gr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">pretty_condition</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">gr</span><span class="op">)</span>


<span class="va">g1</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">gr</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">gr</span> <span class="op">==</span> <span class="st">"impasse"</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>


<span class="co">#COMPARE DISTRIBUTIONS WITH ROBUST TESTS</span>

<span class="co">#What do common tests say about the difference?</span>

<span class="co"># Kolmogorov-Smirnov test</span>
<span class="co">#If y is numeric, a two-sample (Smirnov) test of the null hypothesis that x and y </span>
<span class="co">#were drawn from the same continuous distribution is performed. Alternatively, y ...</span>

<span class="co">#null is X is drawn from CDF EQUAL TO Y</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test(g1, g2): p-value will be approximate in the presence of ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  g1 and g2
D = 0.5, p-value &lt;2e-16
alternative hypothesis: two-sided</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SUGGESTS that impasse and control come from different population distributions"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SUGGESTS that impasse and control come from different population distributions"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># #null is X is NOT LESS THAN Y</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test(g1, g2, alternative = "greater"): p-value will be approximate
in the presence of ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  g1 and g2
D^+ = 0.5, p-value &lt;2e-16
alternative hypothesis: the CDF of x lies above that of y</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SUGGESTS that true CDF of CONTROL is greater than that of IMPASSE [consistent with higher probability of low scores]"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SUGGESTS that true CDF of CONTROL is greater than that of IMPASSE [consistent with higher probability of low scores]"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#REGULAR T-TEST</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span><span class="op">)</span> <span class="co"># regular Welsh t-test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  g1 and g2
t = -7, df = 325, p-value = 7e-12
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -8.93 -5.06
sample estimates:
mean of x mean of y 
   -6.427     0.567 </code></pre>
</div>
</div>
<div class="cell" data-warnings="false" data-messages="false">
<details><summary>CODE</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#IF THIS ERRORS, consider loadling plyr (older than dplyr)</span>
<span class="co"># kernel density estimate + rug plot + superimposed deciles</span>
<span class="va">kde</span> <span class="op">&lt;-</span> <span class="fu">plot.kde_rug_dec2</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: plyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>You have loaded plyr after dplyr - this is likely to cause problems.
If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
library(plyr); library(dplyr)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    compact</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcdExtra':

    summarise</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggpubr':

    mutate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:Hmisc':

    is.discrete, summarize</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># kde</span>

<span class="co"># compute shift function</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">shifthd</span><span class="op">(</span> <span class="va">g1</span>, <span class="va">g2</span>, nboot<span class="op">=</span><span class="fl">200</span><span class="op">)</span>

<span class="co"># plot shift function</span>
<span class="va">sf</span> <span class="op">&lt;-</span> <span class="fu">plot.sf</span><span class="op">(</span>data<span class="op">=</span><span class="va">out</span><span class="op">)</span> <span class="co"># function from rgar_visualisation.txt</span>
<span class="co"># sf</span>

<span class="co"># combine KDE + SF</span>
<span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">kde</span>, <span class="va">sf</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span>, rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">1</span><span class="op">)</span>,label_size <span class="op">=</span> <span class="fl">18</span>,hjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,scale<span class="op">=</span><span class="fl">.95</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/SHIFT-FN-NABS-comb-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="resources" class="level2"><h2 class="anchored" data-anchor-id="resources">RESOURCES</h2>
<p>reset plot margins par(mar=c(1,1,1,1))</p>
<section id="logistic-regression-notes" class="level3"><h3 class="anchored" data-anchor-id="logistic-regression-notes">Logistic Regression Notes</h3>
<p><em>The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable</em></p>
<p><em>The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.</em></p>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Description</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC3A/5_sgc3A_exploration.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploratory Analyses</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb139" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'Study SGC3A | 4 Hypothesis Testing'</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis Testing {#sec-SGC3A-hypotesting}</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>**TODO**</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ORDINAL models on interpretation scale  </span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>HURDLE MODEL? (mixture model w/ 0 + count)</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>review models already created in ARCHIVE?</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>separate combined (vs) lab (vs) online replication <span class="sc">\[</span>once analysis strategy locked down<span class="sc">\]</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>*The purpose of this notebook is test the hypotheses that determined the design of the SGC3A study.*</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>+---------------------+</span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>| Pre-Requisite       |</span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>+=====================+</span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>| 2_sgc3A_scoring.qmd |</span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>+---------------------+</span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#arrange plots</span></span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange shift function plots</span></span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd) <span class="co">#mosaic plots</span></span>
<span id="cb139-37"><a href="#cb139-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra) <span class="co">#mosaic plots</span></span>
<span id="cb139-38"><a href="#cb139-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables </span></span>
<span id="cb139-39"><a href="#cb139-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb139-40"><a href="#cb139-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-41"><a href="#cb139-41" aria-hidden="true" tabindex="-1"></a><span class="co">#plot model estimates with uncertainty</span></span>
<span id="cb139-42"><a href="#cb139-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb139-43"><a href="#cb139-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb139-44"><a href="#cb139-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb139-45"><a href="#cb139-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb139-46"><a href="#cb139-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-47"><a href="#cb139-47" aria-hidden="true" tabindex="-1"></a><span class="co">#models and performance</span></span>
<span id="cb139-48"><a href="#cb139-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer </span></span>
<span id="cb139-49"><a href="#cb139-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots w/ embedded stats</span></span>
<span id="cb139-50"><a href="#cb139-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb139-51"><a href="#cb139-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb139-52"><a href="#cb139-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb139-53"><a href="#cb139-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr) <span class="co">#confint on qq plot</span></span>
<span id="cb139-54"><a href="#cb139-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels) <span class="co">#contingency table and CHISQR</span></span>
<span id="cb139-55"><a href="#cb139-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic) <span class="co">#extract model equation</span></span>
<span id="cb139-56"><a href="#cb139-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zeroinfl / hurdle models </span></span>
<span id="cb139-57"><a href="#cb139-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models </span></span>
<span id="cb139-58"><a href="#cb139-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects) <span class="co">#visualization log regr models</span></span>
<span id="cb139-59"><a href="#cb139-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-60"><a href="#cb139-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb139-61"><a href="#cb139-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-62"><a href="#cb139-62" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb139-63"><a href="#cb139-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb139-64"><a href="#cb139-64" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb139-65"><a href="#cb139-65" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb139-66"><a href="#cb139-66" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb139-67"><a href="#cb139-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-68"><a href="#cb139-68" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb139-69"><a href="#cb139-69" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>()) </span>
<span id="cb139-70"><a href="#cb139-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-71"><a href="#cb139-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-72"><a href="#cb139-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-73"><a href="#cb139-73" aria-hidden="true" tabindex="-1"></a>**Research Questions**</span>
<span id="cb139-74"><a href="#cb139-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-75"><a href="#cb139-75" aria-hidden="true" tabindex="-1"></a>In SGC3A we set out to answer the following question: Does posing a mental impasse improve performance on the graph comprehension task?</span>
<span id="cb139-76"><a href="#cb139-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-77"><a href="#cb139-77" aria-hidden="true" tabindex="-1"></a>**Experimental Hypothesis**\</span>
<span id="cb139-78"><a href="#cb139-78" aria-hidden="true" tabindex="-1"></a>*Learners posed with scenario designed to evoke a mental impasse will be more likely to correct interpret the graph.*</span>
<span id="cb139-79"><a href="#cb139-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-80"><a href="#cb139-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1A \| Learners in the IMPASSE condition will be more likely to correctly answer the first question than learners in CONTROL.</span>
<span id="cb139-81"><a href="#cb139-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1B \| Learners in the IMPASSE condition will score higher on the TEST Phase than learners in CONTROL.</span>
<span id="cb139-82"><a href="#cb139-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-83"><a href="#cb139-83" aria-hidden="true" tabindex="-1"></a>**Null Hypothesis**\</span>
<span id="cb139-84"><a href="#cb139-84" aria-hidden="true" tabindex="-1"></a>*No significant differences in performance will exist between learners in the IMPASSE and CONTROL conditions.*</span>
<span id="cb139-85"><a href="#cb139-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-88"><a href="#cb139-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-89"><a href="#cb139-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb139-90"><a href="#cb139-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb139-91"><a href="#cb139-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb139-92"><a href="#cb139-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-93"><a href="#cb139-93" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb139-94"><a href="#cb139-94" aria-hidden="true" tabindex="-1"></a><span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb139-95"><a href="#cb139-95" aria-hidden="true" tabindex="-1"></a>mbp <span class="ot">=</span> <span class="st">"/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb139-96"><a href="#cb139-96" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(mbp)</span>
<span id="cb139-97"><a href="#cb139-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-98"><a href="#cb139-98" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb139-99"><a href="#cb139-99" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span>)</span>
<span id="cb139-100"><a href="#cb139-100" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span>)</span>
<span id="cb139-101"><a href="#cb139-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-102"><a href="#cb139-102" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb139-103"><a href="#cb139-103" aria-hidden="true" tabindex="-1"></a>df_lab <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_mode <span class="sc">==</span> <span class="st">"laboratory"</span>)</span>
<span id="cb139-104"><a href="#cb139-104" aria-hidden="true" tabindex="-1"></a>df_online <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_mode <span class="sc">==</span> <span class="st">"online-replication"</span>)</span>
<span id="cb139-105"><a href="#cb139-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-106"><a href="#cb139-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-107"><a href="#cb139-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-108"><a href="#cb139-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1A \| Q1 ACCURACY</span></span>
<span id="cb139-109"><a href="#cb139-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-110"><a href="#cb139-110" aria-hidden="true" tabindex="-1"></a>**Do Ss in the IMPASSE condition have a higher likelihood of producing a correct response to the first question?**</span>
<span id="cb139-111"><a href="#cb139-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-112"><a href="#cb139-112" aria-hidden="true" tabindex="-1"></a>The graph comprehension tasks includes 15 questions completed in sequence. But the first question the reader encounters (Q1) is the most important, as it is their *first exposure* to the unconventional triangular coordinate system.</span>
<span id="cb139-113"><a href="#cb139-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-114"><a href="#cb139-114" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-115"><a href="#cb139-115" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does the frequency of correct (vs) incorrect responses on the first question differ by condition? <span class="sc">\[</span>Is response accuracy independent of condition?<span class="sc">\]</span>                                                                                   |</span>
<span id="cb139-116"><a href="#cb139-116" aria-hidden="true" tabindex="-1"></a>+=======================+========================================================================================================================================================================================================================================+</span>
<span id="cb139-117"><a href="#cb139-117" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the IMPASSE condition will have a higher likelihood of correctly responding to the first question than those in the CONTROL condition                                                                                     |</span>
<span id="cb139-118"><a href="#cb139-118" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-119"><a href="#cb139-119" aria-hidden="true" tabindex="-1"></a>| **Data**              | data: <span class="in">`df_items`</span> where <span class="in">`q == 1`</span>                                                                                                                                                                                                        |</span>
<span id="cb139-120"><a href="#cb139-120" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb139-121"><a href="#cb139-121" aria-hidden="true" tabindex="-1"></a>|                       | outcome:                                                                                                                                                                                                                               |</span>
<span id="cb139-122"><a href="#cb139-122" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb139-123"><a href="#cb139-123" aria-hidden="true" tabindex="-1"></a>|                       | -   *accuracy* ( factor(incorrect/correct) from <span class="in">`score_niceABS`</span> <span class="sc">\[</span>absolute score<span class="sc">\]</span>                                                                                                                                                     |</span>
<span id="cb139-124"><a href="#cb139-124" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb139-125"><a href="#cb139-125" aria-hidden="true" tabindex="-1"></a>|                       | -   *interpretation* (ordered factor from <span class="in">`interpretation`</span>)                                                                                                                                                                            |</span>
<span id="cb139-126"><a href="#cb139-126" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb139-127"><a href="#cb139-127" aria-hidden="true" tabindex="-1"></a>|                       | predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                                                                                                     |</span>
<span id="cb139-128"><a href="#cb139-128" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-129"><a href="#cb139-129" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Logistic Regression on <span class="in">`accuracy`</span> predicted by <span class="in">`condition`</span>                                                                                                                                                                         |</span>
<span id="cb139-130"><a href="#cb139-130" aria-hidden="true" tabindex="-1"></a>|                       |     -   account for difference in odds of correct score by condition                                                                                                                                                                   |</span>
<span id="cb139-131"><a href="#cb139-131" aria-hidden="true" tabindex="-1"></a>|                       | 2.  Ordinal Regression on <span class="in">`interpretation`</span> predicted by <span class="in">`condition`</span>                                                                                                                                                                    |</span>
<span id="cb139-132"><a href="#cb139-132" aria-hidden="true" tabindex="-1"></a>|                       |     -   account for difference in (ordered correctness of interpretation) by condition                                                                                                                                                 |</span>
<span id="cb139-133"><a href="#cb139-133" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb139-134"><a href="#cb139-134" aria-hidden="true" tabindex="-1"></a>|                       | Alternative:                                                                                                                                                                                                                           |</span>
<span id="cb139-135"><a href="#cb139-135" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb139-136"><a href="#cb139-136" aria-hidden="true" tabindex="-1"></a>|                       | -   Chi-Square test of independence on outcome <span class="in">`score_niceABS`</span> by <span class="in">`condition`</span>                                                                                                                                                          |</span>
<span id="cb139-137"><a href="#cb139-137" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-138"><a href="#cb139-138" aria-hidden="true" tabindex="-1"></a>| **Notes**             | -   CHIQ SQR is simplest method to examine independence of two categorical factors; LOGISTIC REGRESSION is recommended for binomial \~ continuous; though with regression we can quantify the size of the effect and overall model fit |</span>
<span id="cb139-139"><a href="#cb139-139" aria-hidden="true" tabindex="-1"></a>|                       | -   independence assumption : (CHI SQR) as we only consider responses on the first question, each observation corresponds to an individual subject, and are thus independent                                                           |</span>
<span id="cb139-140"><a href="#cb139-140" aria-hidden="true" tabindex="-1"></a>|                       | -   cell frequency : (CHI SQR) expected frequency in each cell of the contingency table is greater than 5 (more than 5 correct , more than 5 incorrect responses)                                                                      |</span>
<span id="cb139-141"><a href="#cb139-141" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-142"><a href="#cb139-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-145"><a href="#cb139-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-146"><a href="#cb139-146" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1ACC</span></span>
<span id="cb139-147"><a href="#cb139-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-148"><a href="#cb139-148" aria-hidden="true" tabindex="-1"></a><span class="co">#FILTER THE DATASET [use subjects, bc it has covariates on that record]</span></span>
<span id="cb139-149"><a href="#cb139-149" aria-hidden="true" tabindex="-1"></a><span class="co"># df_q1 = df_items %&gt;% filter(q==1) %&gt;% mutate(</span></span>
<span id="cb139-150"><a href="#cb139-150" aria-hidden="true" tabindex="-1"></a><span class="co">#   accuracy = recode_factor(score_niceABS, "0" = "incorrect", "1"="correct")</span></span>
<span id="cb139-151"><a href="#cb139-151" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb139-152"><a href="#cb139-152" aria-hidden="true" tabindex="-1"></a>df_q1 <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb139-153"><a href="#cb139-153" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(item_q1_NABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb139-154"><a href="#cb139-154" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt =</span> item_q1_rt</span>
<span id="cb139-155"><a href="#cb139-155" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb139-156"><a href="#cb139-156" aria-hidden="true" tabindex="-1"></a>  accuracy, rt, pretty_condition, pretty_mode</span>
<span id="cb139-157"><a href="#cb139-157" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb139-158"><a href="#cb139-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-159"><a href="#cb139-159" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb139-160"><a href="#cb139-160" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~accuracy, fill = ~pretty_condition, </span></span>
<span id="cb139-161"><a href="#cb139-161" aria-hidden="true" tabindex="-1"></a><span class="co">#        position = position_dodge(), data = df_q1) %&gt;% </span></span>
<span id="cb139-162"><a href="#cb139-162" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_mode) +</span></span>
<span id="cb139-163"><a href="#cb139-163" aria-hidden="true" tabindex="-1"></a><span class="co">#    labs(x = "Correct Response on Q 1",</span></span>
<span id="cb139-164"><a href="#cb139-164" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Accuracy on First Question by Condition",</span></span>
<span id="cb139-165"><a href="#cb139-165" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses") #theme(legend.position = "none")</span></span>
<span id="cb139-166"><a href="#cb139-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-167"><a href="#cb139-167" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED BAR CHART</span></span>
<span id="cb139-168"><a href="#cb139-168" aria-hidden="true" tabindex="-1"></a>df_q1 <span class="sc">%&gt;%</span> </span>
<span id="cb139-169"><a href="#cb139-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb139-170"><a href="#cb139-170" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb139-171"><a href="#cb139-171" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb139-172"><a href="#cb139-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb139-173"><a href="#cb139-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb139-174"><a href="#cb139-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb139-175"><a href="#cb139-175" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb139-176"><a href="#cb139-176" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb139-177"><a href="#cb139-177" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb139-178"><a href="#cb139-178" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb139-179"><a href="#cb139-179" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb139-180"><a href="#cb139-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-181"><a href="#cb139-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-182"><a href="#cb139-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-183"><a href="#cb139-183" aria-hidden="true" tabindex="-1"></a>A proportional bar chart visualizing the proportion of incorrect (vs) correct responses in each condition for each data collection modality (left/right facet) reveals that the pattern of responses appear the same regardless of the data collection modality. In both data collection sessions, the proportion of incorrect responses is much greater than the proportion of correct responses, regardless of condition (marginal probability of incorrect). In the impasse condition, the difference in proportions is smaller than the control condition (conditional probability of success in impasse; (i.e) There are more correct responses in the impasse condition than the control condition).</span>
<span id="cb139-184"><a href="#cb139-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-185"><a href="#cb139-185" aria-hidden="true" tabindex="-1"></a><span class="fu">### LOGISTIC REGRESSION</span></span>
<span id="cb139-186"><a href="#cb139-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-187"><a href="#cb139-187" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression (at the subject level), predicting Q1 accuracy (absolute score) by condition.*</span>
<span id="cb139-188"><a href="#cb139-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-189"><a href="#cb139-189" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb139-190"><a href="#cb139-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-191"><a href="#cb139-191" aria-hidden="true" tabindex="-1"></a>*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*</span>
<span id="cb139-192"><a href="#cb139-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-195"><a href="#cb139-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-196"><a href="#cb139-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-Q1ACC-LOG-combined</span></span>
<span id="cb139-197"><a href="#cb139-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb139-198"><a href="#cb139-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb139-199"><a href="#cb139-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-200"><a href="#cb139-200" aria-hidden="true" tabindex="-1"></a><span class="co">#combined</span></span>
<span id="cb139-201"><a href="#cb139-201" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_q1 </span>
<span id="cb139-202"><a href="#cb139-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-203"><a href="#cb139-203" aria-hidden="true" tabindex="-1"></a><span class="co"># FREQUENCY TABLE</span></span>
<span id="cb139-204"><a href="#cb139-204" aria-hidden="true" tabindex="-1"></a><span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span></span>
<span id="cb139-205"><a href="#cb139-205" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(my.table) #counts</span></span>
<span id="cb139-206"><a href="#cb139-206" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(prop.table(my.table)) #props</span></span>
<span id="cb139-207"><a href="#cb139-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-208"><a href="#cb139-208" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING:::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb139-209"><a href="#cb139-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-210"><a href="#cb139-210" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb139-211"><a href="#cb139-211" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb139-212"><a href="#cb139-212" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"EMPTY MODEL"</span>)</span>
<span id="cb139-213"><a href="#cb139-213" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb139-214"><a href="#cb139-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-215"><a href="#cb139-215" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb139-216"><a href="#cb139-216" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb139-217"><a href="#cb139-217" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb139-218"><a href="#cb139-218" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb139-219"><a href="#cb139-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-220"><a href="#cb139-220" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb139-221"><a href="#cb139-221" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span>
<span id="cb139-222"><a href="#cb139-222" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb139-223"><a href="#cb139-223" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb139-224"><a href="#cb139-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-225"><a href="#cb139-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-226"><a href="#cb139-226" aria-hidden="true" tabindex="-1"></a>*The Condition predictor significantly improves model fit.*</span>
<span id="cb139-227"><a href="#cb139-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-228"><a href="#cb139-228" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb139-229"><a href="#cb139-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-232"><a href="#cb139-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-233"><a href="#cb139-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-Q1ACC-LOG-combined</span></span>
<span id="cb139-234"><a href="#cb139-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-235"><a href="#cb139-235" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb139-236"><a href="#cb139-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-237"><a href="#cb139-237" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb139-238"><a href="#cb139-238" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m1)</span></span>
<span id="cb139-239"><a href="#cb139-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-240"><a href="#cb139-240" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb139-241"><a href="#cb139-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-242"><a href="#cb139-242" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- LOG ODDS"</span>)</span>
<span id="cb139-243"><a href="#cb139-243" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span>
<span id="cb139-244"><a href="#cb139-244" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span>
<span id="cb139-245"><a href="#cb139-245" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(<span class="fu">confint</span>(m1))) <span class="co">#exponentiate</span></span>
<span id="cb139-246"><a href="#cb139-246" aria-hidden="true" tabindex="-1"></a>e</span>
<span id="cb139-247"><a href="#cb139-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-248"><a href="#cb139-248" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb139-249"><a href="#cb139-249" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span>
<span id="cb139-250"><a href="#cb139-250" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb139-251"><a href="#cb139-251" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m1)</span>
<span id="cb139-252"><a href="#cb139-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-253"><a href="#cb139-253" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span>
<span id="cb139-254"><a href="#cb139-254" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb139-255"><a href="#cb139-255" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb139-256"><a href="#cb139-256" aria-hidden="true" tabindex="-1"></a>p.control <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"control"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb139-257"><a href="#cb139-257" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in control,"</span>, p.control)</span>
<span id="cb139-258"><a href="#cb139-258" aria-hidden="true" tabindex="-1"></a>p.impasse <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"impasse"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb139-259"><a href="#cb139-259" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in impasse,"</span>, p.impasse)</span>
<span id="cb139-260"><a href="#cb139-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-261"><a href="#cb139-261" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb139-262"><a href="#cb139-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-263"><a href="#cb139-263" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb139-264"><a href="#cb139-264" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggstatsplot)</span></span>
<span id="cb139-265"><a href="#cb139-265" aria-hidden="true" tabindex="-1"></a><span class="co"># ggcoefstats(m1, output = "plot") + labs(x = "Log Odds Estimate")</span></span>
<span id="cb139-266"><a href="#cb139-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-267"><a href="#cb139-267" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb139-268"><a href="#cb139-268" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb139-269"><a href="#cb139-269" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb139-270"><a href="#cb139-270" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb139-271"><a href="#cb139-271" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb139-272"><a href="#cb139-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb139-273"><a href="#cb139-273" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb139-274"><a href="#cb139-274" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb139-275"><a href="#cb139-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-276"><a href="#cb139-276" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb139-277"><a href="#cb139-277" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m1, type="pred",</span></span>
<span id="cb139-278"><a href="#cb139-278" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb139-279"><a href="#cb139-279" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb139-280"><a href="#cb139-280" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Predicted Probability of Accuracy",</span></span>
<span id="cb139-281"><a href="#cb139-281" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb139-282"><a href="#cb139-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-283"><a href="#cb139-283" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb139-284"><a href="#cb139-284" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb139-285"><a href="#cb139-285" aria-hidden="true" tabindex="-1"></a><span class="fu">ggeffect</span>(<span class="at">model =</span> m1) <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span>
<span id="cb139-286"><a href="#cb139-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-287"><a href="#cb139-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-288"><a href="#cb139-288" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb139-289"><a href="#cb139-289" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb139-290"><a href="#cb139-290" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(m))</span></span>
<span id="cb139-291"><a href="#cb139-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-292"><a href="#cb139-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-293"><a href="#cb139-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-294"><a href="#cb139-294" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb139-295"><a href="#cb139-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-298"><a href="#cb139-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-299"><a href="#cb139-299" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span>
<span id="cb139-300"><a href="#cb139-300" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(m1)</span>
<span id="cb139-301"><a href="#cb139-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-302"><a href="#cb139-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-303"><a href="#cb139-303" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb139-304"><a href="#cb139-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-305"><a href="#cb139-305" aria-hidden="true" tabindex="-1"></a>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the *impasse condition* increase by 146% ($e^{beta_1}$ = 2.46, 95% CI \[1.42, 4.37\]) over the *control condition*.</span>
<span id="cb139-306"><a href="#cb139-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-307"><a href="#cb139-307" aria-hidden="true" tabindex="-1"></a>*Equivalent statements:*</span>
<span id="cb139-308"><a href="#cb139-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-309"><a href="#cb139-309" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse condition increases log odds of correct response by 0.901 (over control)</span>
<span id="cb139-310"><a href="#cb139-310" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</span>
<span id="cb139-311"><a href="#cb139-311" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</span>
<span id="cb139-312"><a href="#cb139-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-315"><a href="#cb139-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-316"><a href="#cb139-316" aria-hidden="true" tabindex="-1"></a><span class="co">#PRETTY TABLE SJPLOT</span></span>
<span id="cb139-317"><a href="#cb139-317" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1)</span>
<span id="cb139-318"><a href="#cb139-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-319"><a href="#cb139-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-320"><a href="#cb139-320" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TODO</span></span>
<span id="cb139-321"><a href="#cb139-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-322"><a href="#cb139-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Are these residuals OK? I didn't think normally distributed residuals were an assumption for logistic regression.</span>
<span id="cb139-323"><a href="#cb139-323" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation/reporting of model fit?</span>
<span id="cb139-324"><a href="#cb139-324" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>sanity check correct interpretation of coefficients &amp; reporting</span>
<span id="cb139-325"><a href="#cb139-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-326"><a href="#cb139-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### TODO ORDINAL REGRESSION</span></span>
<span id="cb139-327"><a href="#cb139-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-328"><a href="#cb139-328" aria-hidden="true" tabindex="-1"></a>*Fit an ordinal logistic regression (at the subject level), predicting Q1 interpretation by condition.*</span>
<span id="cb139-329"><a href="#cb139-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-330"><a href="#cb139-330" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</span>
<span id="cb139-331"><a href="#cb139-331" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb139-332"><a href="#cb139-332" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>todo see ordinal regression video</span>
<span id="cb139-333"><a href="#cb139-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-336"><a href="#cb139-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-337"><a href="#cb139-337" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE DATAFRAME OF Q1</span></span>
<span id="cb139-338"><a href="#cb139-338" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_items %&gt;% filter(q ==1) %&gt;% mutate(scaled = as.factor(score_SCALED))</span></span>
<span id="cb139-339"><a href="#cb139-339" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-340"><a href="#cb139-340" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL</span></span>
<span id="cb139-341"><a href="#cb139-341" aria-hidden="true" tabindex="-1"></a><span class="co"># m &lt;- polr(scaled ~ condition , data = df, Hess=TRUE)</span></span>
<span id="cb139-342"><a href="#cb139-342" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m)</span></span>
<span id="cb139-343"><a href="#cb139-343" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m)</span></span>
<span id="cb139-344"><a href="#cb139-344" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb139-345"><a href="#cb139-345" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb139-346"><a href="#cb139-346" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-347"><a href="#cb139-347" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate coefficients and CIs </span></span>
<span id="cb139-348"><a href="#cb139-348" aria-hidden="true" tabindex="-1"></a><span class="co"># ci &lt;- confint(m)</span></span>
<span id="cb139-349"><a href="#cb139-349" aria-hidden="true" tabindex="-1"></a><span class="co"># ci</span></span>
<span id="cb139-350"><a href="#cb139-350" aria-hidden="true" tabindex="-1"></a><span class="co"># e &lt;- coef(m)</span></span>
<span id="cb139-351"><a href="#cb139-351" aria-hidden="true" tabindex="-1"></a><span class="co"># e</span></span>
<span id="cb139-352"><a href="#cb139-352" aria-hidden="true" tabindex="-1"></a><span class="co"># # exp(cbind(e,ci))</span></span>
<span id="cb139-353"><a href="#cb139-353" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-354"><a href="#cb139-354" aria-hidden="true" tabindex="-1"></a><span class="co"># # Retrieve predictions as probabilities </span></span>
<span id="cb139-355"><a href="#cb139-355" aria-hidden="true" tabindex="-1"></a><span class="co"># # (for each level of the predictor)</span></span>
<span id="cb139-356"><a href="#cb139-356" aria-hidden="true" tabindex="-1"></a><span class="co"># # p.control &lt;- predict(m,data.frame(condition="111"),type="response")</span></span>
<span id="cb139-357"><a href="#cb139-357" aria-hidden="true" tabindex="-1"></a><span class="co"># # paste("Probability of success in control,", p.control)</span></span>
<span id="cb139-358"><a href="#cb139-358" aria-hidden="true" tabindex="-1"></a><span class="co"># # p.impasse &lt;- predict(m,data.frame(condition="121"),type="response")</span></span>
<span id="cb139-359"><a href="#cb139-359" aria-hidden="true" tabindex="-1"></a><span class="co"># # paste("Probability of success in impasse,", p.impasse)</span></span>
<span id="cb139-360"><a href="#cb139-360" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-361"><a href="#cb139-361" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot Predicted data and original data points</span></span>
<span id="cb139-362"><a href="#cb139-362" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggplot(df, aes(x=condition, y=accuracy)) + </span></span>
<span id="cb139-363"><a href="#cb139-363" aria-hidden="true" tabindex="-1"></a><span class="co"># #   geom_point() +</span></span>
<span id="cb139-364"><a href="#cb139-364" aria-hidden="true" tabindex="-1"></a><span class="co"># #   stat_smooth(method="glm", color="green", se=FALSE,</span></span>
<span id="cb139-365"><a href="#cb139-365" aria-hidden="true" tabindex="-1"></a><span class="co"># #                 method.args = list(family=binomial))</span></span>
<span id="cb139-366"><a href="#cb139-366" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb139-367"><a href="#cb139-367" aria-hidden="true" tabindex="-1"></a><span class="co"># #TO PLOT ALL EFFECTS</span></span>
<span id="cb139-368"><a href="#cb139-368" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb139-369"><a href="#cb139-369" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(m))</span></span>
<span id="cb139-370"><a href="#cb139-370" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-371"><a href="#cb139-371" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT</span></span>
<span id="cb139-372"><a href="#cb139-372" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sjPlot)</span></span>
<span id="cb139-373"><a href="#cb139-373" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, )</span></span>
<span id="cb139-374"><a href="#cb139-374" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-375"><a href="#cb139-375" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-376"><a href="#cb139-376" aria-hidden="true" tabindex="-1"></a><span class="co"># #CONVERT TO PROBABILITIES</span></span>
<span id="cb139-377"><a href="#cb139-377" aria-hidden="true" tabindex="-1"></a><span class="co"># newdat &lt;- data.frame(condition=c("111","121"))</span></span>
<span id="cb139-378"><a href="#cb139-378" aria-hidden="true" tabindex="-1"></a><span class="co"># prob &lt;- (phat &lt;- predict(object = m, newdat, type="p"))</span></span>
<span id="cb139-379"><a href="#cb139-379" aria-hidden="true" tabindex="-1"></a><span class="co"># prob</span></span>
<span id="cb139-380"><a href="#cb139-380" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-381"><a href="#cb139-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-382"><a href="#cb139-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-383"><a href="#cb139-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-384"><a href="#cb139-384" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1B \| OVERALL ACCURACY</span></span>
<span id="cb139-385"><a href="#cb139-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-386"><a href="#cb139-386" aria-hidden="true" tabindex="-1"></a>**Do Ss in the IMPASSE condition have higher scores across the entire task?**</span>
<span id="cb139-387"><a href="#cb139-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-388"><a href="#cb139-388" aria-hidden="true" tabindex="-1"></a>The graph comprehension tasks includes 13 interpretation-discriminant questions completed in sequence.</span>
<span id="cb139-389"><a href="#cb139-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-390"><a href="#cb139-390" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-391"><a href="#cb139-391" aria-hidden="true" tabindex="-1"></a>| Research Question     | Do Ss in the IMPASSE condition score higher across the entire task than those in the CONTROL group.                                                     |</span>
<span id="cb139-392"><a href="#cb139-392" aria-hidden="true" tabindex="-1"></a>+=======================+=========================================================================================================================================================+</span>
<span id="cb139-393"><a href="#cb139-393" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | (H1B) Participants in the IMPASSE condition will have higher test phase performance than those in the CONTROL condition.                                |</span>
<span id="cb139-394"><a href="#cb139-394" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-395"><a href="#cb139-395" aria-hidden="true" tabindex="-1"></a>| **Data**              | **data**: <span class="in">`df_items`</span> where <span class="in">`q nin 6,9`</span> (the 13 discriminating Qs ), <span class="in">`df_subjects`</span>                                                                       |</span>
<span id="cb139-396"><a href="#cb139-396" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                         |</span>
<span id="cb139-397"><a href="#cb139-397" aria-hidden="true" tabindex="-1"></a>|                       | **outcome**:                                                                                                                                            |</span>
<span id="cb139-398"><a href="#cb139-398" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                         |</span>
<span id="cb139-399"><a href="#cb139-399" aria-hidden="true" tabindex="-1"></a>|                       | -   <span class="sc">\[</span>at item level<span class="sc">\]</span>                                                                                                                                   |</span>
<span id="cb139-400"><a href="#cb139-400" aria-hidden="true" tabindex="-1"></a>|                       |     -   *accuracy* ( factor(incorrect/correct) from <span class="in">`score_niceABS`</span> <span class="sc">\[</span>absolute score<span class="sc">\]</span>                                                                  |</span>
<span id="cb139-401"><a href="#cb139-401" aria-hidden="true" tabindex="-1"></a>|                       |     -   *interpretation* (ordered factor from <span class="in">`interpretation`</span>)                                                                                         |</span>
<span id="cb139-402"><a href="#cb139-402" aria-hidden="true" tabindex="-1"></a>|                       | -   <span class="sc">\[</span>subject level<span class="sc">\]</span>                                                                                                                                   |</span>
<span id="cb139-403"><a href="#cb139-403" aria-hidden="true" tabindex="-1"></a>|                       |     -   p_accuracy (percent of correct responses)                                                                                                       |</span>
<span id="cb139-404"><a href="#cb139-404" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                         |</span>
<span id="cb139-405"><a href="#cb139-405" aria-hidden="true" tabindex="-1"></a>|                       | **predictor**: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                  |</span>
<span id="cb139-406"><a href="#cb139-406" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-407"><a href="#cb139-407" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Mixed Logistic Regression\                                                                                                                          |</span>
<span id="cb139-408"><a href="#cb139-408" aria-hidden="true" tabindex="-1"></a>|                       |     <span class="in">`accuracy`</span> \~ <span class="in">`condition`</span> + (1 \| <span class="in">`subject`</span> )\                                                                                                      |</span>
<span id="cb139-409"><a href="#cb139-409" aria-hidden="true" tabindex="-1"></a>|                       |     model effect of condition on probability of correct response <span class="sc">\[</span>during test phase<span class="sc">\]</span> while accounting for subject (and item-level?) effects           |</span>
<span id="cb139-410"><a href="#cb139-410" aria-hidden="true" tabindex="-1"></a>|                       | 2.  Ordinal Mixed Logistic Regression\                                                                                                                  |</span>
<span id="cb139-411"><a href="#cb139-411" aria-hidden="true" tabindex="-1"></a>|                       |     <span class="in">`interpretation`</span> \~ <span class="in">`condition`</span> + (1 \| <span class="in">`subject`</span> )\                                                                                                |</span>
<span id="cb139-412"><a href="#cb139-412" aria-hidden="true" tabindex="-1"></a>|                       |     model effect of condition on <span class="sc">\[</span>ordered correctness of interpretation<span class="sc">\]</span> <span class="sc">\[</span>during test phase<span class="sc">\]</span> while accounting for subject (and item-level?) effects |</span>
<span id="cb139-413"><a href="#cb139-413" aria-hidden="true" tabindex="-1"></a>|                       | 3.  Shift in Modal Mass (descriptive)\                                                                                                                  |</span>
<span id="cb139-414"><a href="#cb139-414" aria-hidden="true" tabindex="-1"></a>|                       |     describe &amp; visualize shift in deciles between conditions for `<span class="in">` `</span>scaled_score` `` (at subject level)                                                |</span>
<span id="cb139-415"><a href="#cb139-415" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-416"><a href="#cb139-416" aria-hidden="true" tabindex="-1"></a>| **Alternatives**      | -   OLS LINEAR REGRESSION                                                                                                                               |</span>
<span id="cb139-417"><a href="#cb139-417" aria-hidden="true" tabindex="-1"></a>|                       |     -   bimodal distribution at tails makes the mean a poor predictor; LMs violate assumptions of normally distributed residuals                        |</span>
<span id="cb139-418"><a href="#cb139-418" aria-hidden="true" tabindex="-1"></a>|                       |     -   lm <span class="in">`DV_percent_test_NABS`</span> \~ <span class="in">`condition`</span> (absolute scoring) OR lm <span class="in">`item_test_SCALED`</span> \~ <span class="in">`condition`</span> (scaled scoring)                            |</span>
<span id="cb139-419"><a href="#cb139-419" aria-hidden="true" tabindex="-1"></a>|                       |     -   both absolute and scaled scores yield non-normal residuals                                                                                      |</span>
<span id="cb139-420"><a href="#cb139-420" aria-hidden="true" tabindex="-1"></a>|                       |     -   no transformation of the outcome variables yield normal residuals                                                                               |</span>
<span id="cb139-421"><a href="#cb139-421" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-422"><a href="#cb139-422" aria-hidden="true" tabindex="-1"></a>| **Notes**             | **Also exploring:**                                                                                                                                     |</span>
<span id="cb139-423"><a href="#cb139-423" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                         |</span>
<span id="cb139-424"><a href="#cb139-424" aria-hidden="true" tabindex="-1"></a>|                       | -   Hurdle model (mixture model w/ binomial + <span class="sc">\[</span>poisson or negbinom count; 0s from 1 DGP)                                                               |</span>
<span id="cb139-425"><a href="#cb139-425" aria-hidden="true" tabindex="-1"></a>|                       | -   Zero Inflated model (mixture model w/ binomial + poisson or negbinom count; 0s from 2 DGPs)                                                         |</span>
<span id="cb139-426"><a href="#cb139-426" aria-hidden="true" tabindex="-1"></a>|                       | -   Beta regression hurdle model? (mixture with location and scale parameters <span class="sc">\[</span>mean, variance<span class="sc">\]</span> and hurdles for floor and ceiling effects)             |</span>
<span id="cb139-427"><a href="#cb139-427" aria-hidden="true" tabindex="-1"></a>|                       | -   Other way to account for the severe bimodality?                                                                                                     |</span>
<span id="cb139-428"><a href="#cb139-428" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb139-429"><a href="#cb139-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-432"><a href="#cb139-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-433"><a href="#cb139-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-</span><span class="al">TEST</span><span class="co">-ACC</span></span>
<span id="cb139-434"><a href="#cb139-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-435"><a href="#cb139-435" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb139-436"><a href="#cb139-436" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">13</span> <span class="co">#number of items in test</span></span>
<span id="cb139-437"><a href="#cb139-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-438"><a href="#cb139-438" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb139-439"><a href="#cb139-439" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb139-440"><a href="#cb139-440" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb139-441"><a href="#cb139-441" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb139-442"><a href="#cb139-442" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb139-443"><a href="#cb139-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-444"><a href="#cb139-444" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb139-445"><a href="#cb139-445" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb139-446"><a href="#cb139-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb139-447"><a href="#cb139-447" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb139-448"><a href="#cb139-448" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb139-449"><a href="#cb139-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb139-450"><a href="#cb139-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb139-451"><a href="#cb139-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb139-452"><a href="#cb139-452" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb139-453"><a href="#cb139-453" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Task"</span>,</span>
<span id="cb139-454"><a href="#cb139-454" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb139-455"><a href="#cb139-455" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb139-456"><a href="#cb139-456" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb139-457"><a href="#cb139-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-458"><a href="#cb139-458" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb139-459"><a href="#cb139-459" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~accuracy, fill = ~pretty_condition, x =~pretty_condition,</span></span>
<span id="cb139-460"><a href="#cb139-460" aria-hidden="true" tabindex="-1"></a><span class="co">#        position = position_dodge(), data = df) %&gt;% </span></span>
<span id="cb139-461"><a href="#cb139-461" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_mode) +</span></span>
<span id="cb139-462"><a href="#cb139-462" aria-hidden="true" tabindex="-1"></a><span class="co">#    labs(x = "Correct Responses in Test Phase",</span></span>
<span id="cb139-463"><a href="#cb139-463" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Accuracy on Task by Condition",</span></span>
<span id="cb139-464"><a href="#cb139-464" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses")</span></span>
<span id="cb139-465"><a href="#cb139-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-466"><a href="#cb139-466" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb139-467"><a href="#cb139-467" aria-hidden="true" tabindex="-1"></a><span class="co">#FACETED HISTOGRAM</span></span>
<span id="cb139-468"><a href="#cb139-468" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(s_NABS))</span>
<span id="cb139-469"><a href="#cb139-469" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>s_NABS, </span>
<span id="cb139-470"><a href="#cb139-470" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_subjects) <span class="sc">%&gt;%</span> </span>
<span id="cb139-471"><a href="#cb139-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> pretty_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb139-472"><a href="#cb139-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb139-473"><a href="#cb139-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"# Correct"</span>,</span>
<span id="cb139-474"><a href="#cb139-474" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb139-475"><a href="#cb139-475" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Overall Absolute Score (# Correct)"</span>,</span>
<span id="cb139-476"><a href="#cb139-476" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb139-477"><a href="#cb139-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-478"><a href="#cb139-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-479"><a href="#cb139-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-480"><a href="#cb139-480" aria-hidden="true" tabindex="-1"></a><span class="fu">### MIXED LOGISTIC REGRESSION</span></span>
<span id="cb139-481"><a href="#cb139-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-482"><a href="#cb139-482" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.*</span>
<span id="cb139-483"><a href="#cb139-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-484"><a href="#cb139-484" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb139-485"><a href="#cb139-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-488"><a href="#cb139-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-489"><a href="#cb139-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-MLOG-ABS-comb</span></span>
<span id="cb139-490"><a href="#cb139-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-491"><a href="#cb139-491" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb139-492"><a href="#cb139-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-493"><a href="#cb139-493" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb139-494"><a href="#cb139-494" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Empty fixed model"</span>)</span>
<span id="cb139-495"><a href="#cb139-495" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df) </span>
<span id="cb139-496"><a href="#cb139-496" aria-hidden="true" tabindex="-1"></a>m0</span>
<span id="cb139-497"><a href="#cb139-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-498"><a href="#cb139-498" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb139-499"><a href="#cb139-499" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject intercept random model"</span>)</span>
<span id="cb139-500"><a href="#cb139-500" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb139-501"><a href="#cb139-501" aria-hidden="true" tabindex="-1"></a>mm.rS</span>
<span id="cb139-502"><a href="#cb139-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-503"><a href="#cb139-503" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb139-504"><a href="#cb139-504" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span>
<span id="cb139-505"><a href="#cb139-505" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb139-506"><a href="#cb139-506" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb139-507"><a href="#cb139-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-508"><a href="#cb139-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-509"><a href="#cb139-509" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD RANDOM RANDOM INTERCEPT ITEM</span></span>
<span id="cb139-510"><a href="#cb139-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-511"><a href="#cb139-511" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + INTERCEPT Q</span></span>
<span id="cb139-512"><a href="#cb139-512" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject &amp; Question random intercepts"</span>)</span>
<span id="cb139-513"><a href="#cb139-513" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb139-514"><a href="#cb139-514" aria-hidden="true" tabindex="-1"></a>mm.rSQ</span>
<span id="cb139-515"><a href="#cb139-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-516"><a href="#cb139-516" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb139-517"><a href="#cb139-517" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) )</span>
<span id="cb139-518"><a href="#cb139-518" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS,mm.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb139-519"><a href="#cb139-519" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS,mm.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb139-520"><a href="#cb139-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-521"><a href="#cb139-521" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 | ADD FIXED EFFECT</span></span>
<span id="cb139-522"><a href="#cb139-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-523"><a href="#cb139-523" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | FIXED CONDITION </span></span>
<span id="cb139-524"><a href="#cb139-524" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Question random intercepts"</span>)</span>
<span id="cb139-525"><a href="#cb139-525" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb139-526"><a href="#cb139-526" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb139-527"><a href="#cb139-527" aria-hidden="true" tabindex="-1"></a>mm.CrSQ</span>
<span id="cb139-528"><a href="#cb139-528" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) )</span>
<span id="cb139-529"><a href="#cb139-529" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb139-530"><a href="#cb139-530" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb139-531"><a href="#cb139-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-532"><a href="#cb139-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-533"><a href="#cb139-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-534"><a href="#cb139-534" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb139-535"><a href="#cb139-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-538"><a href="#cb139-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-539"><a href="#cb139-539" aria-hidden="true" tabindex="-1"></a><span class="co">#: PRINT MODEL </span></span>
<span id="cb139-540"><a href="#cb139-540" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb139-541"><a href="#cb139-541" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm.CrSQ)</span>
<span id="cb139-542"><a href="#cb139-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-543"><a href="#cb139-543" aria-hidden="true" tabindex="-1"></a><span class="co">#: INTERPRET COEFFICIENTS</span></span>
<span id="cb139-544"><a href="#cb139-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-545"><a href="#cb139-545" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb139-546"><a href="#cb139-546" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(mm.CrSQ)</span>
<span id="cb139-547"><a href="#cb139-547" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb139-548"><a href="#cb139-548" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mm.CrSQ)</span>
<span id="cb139-549"><a href="#cb139-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-550"><a href="#cb139-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-551"><a href="#cb139-551" aria-hidden="true" tabindex="-1"></a><span class="co">#: PLOT</span></span>
<span id="cb139-552"><a href="#cb139-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-553"><a href="#cb139-553" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb139-554"><a href="#cb139-554" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb139-555"><a href="#cb139-555" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrSQ, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb139-556"><a href="#cb139-556" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb139-557"><a href="#cb139-557" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb139-558"><a href="#cb139-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb139-559"><a href="#cb139-559" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb139-560"><a href="#cb139-560" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb139-561"><a href="#cb139-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-562"><a href="#cb139-562" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb139-563"><a href="#cb139-563" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mm.CrSQ, <span class="at">type=</span><span class="st">"pred"</span>,</span>
<span id="cb139-564"><a href="#cb139-564" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb139-565"><a href="#cb139-565" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb139-566"><a href="#cb139-566" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb139-567"><a href="#cb139-567" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb139-568"><a href="#cb139-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-569"><a href="#cb139-569" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb139-570"><a href="#cb139-570" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects)</span></span>
<span id="cb139-571"><a href="#cb139-571" aria-hidden="true" tabindex="-1"></a><span class="co"># ggeffect(model = mm.CrSQ) %&gt;% plot()</span></span>
<span id="cb139-572"><a href="#cb139-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-573"><a href="#cb139-573" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb139-574"><a href="#cb139-574" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb139-575"><a href="#cb139-575" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(mm.CrSQ))</span></span>
<span id="cb139-576"><a href="#cb139-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-577"><a href="#cb139-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-578"><a href="#cb139-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-579"><a href="#cb139-579" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics</span></span>
<span id="cb139-580"><a href="#cb139-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-583"><a href="#cb139-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-584"><a href="#cb139-584" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mm.CrSQ)</span>
<span id="cb139-585"><a href="#cb139-585" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(mm.CrSQ)</span>
<span id="cb139-586"><a href="#cb139-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-587"><a href="#cb139-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-588"><a href="#cb139-588" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference</span></span>
<span id="cb139-589"><a href="#cb139-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-590"><a href="#cb139-590" aria-hidden="true" tabindex="-1"></a>We fit a mixed-effect binomial logistic regression model with random intercepts for subjects and items; to investigate the effect of condition on test phase item accuracy. The model including a fixed effect of condition performed significantly better than an intercept-only baseline model (χ2(4): 38.72, p <span class="sc">\&lt;</span> 0.001); and the total explanatory power is substantial (conditional R2 = 0.89) and the part related to the fixed effects alone (marginal R2) is 0.13. Consistent with the pattern of results for the first question only, across all test-phase items, being in the impasse condition increases the odds of a correct response by a factor of 55 over the control condition $e^{\beta_1}$ = 54.79, 95% CI <span class="sc">\[</span>13.2, 227.39<span class="sc">\]</span>, p <span class="sc">\&lt;</span> 0.001.</span>
<span id="cb139-591"><a href="#cb139-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-594"><a href="#cb139-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-595"><a href="#cb139-595" aria-hidden="true" tabindex="-1"></a><span class="co"># PRETTY TABLE SJPLOT</span></span>
<span id="cb139-596"><a href="#cb139-596" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(mm.CrSQ)</span>
<span id="cb139-597"><a href="#cb139-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-598"><a href="#cb139-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-599"><a href="#cb139-599" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TODO</span></span>
<span id="cb139-600"><a href="#cb139-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-601"><a href="#cb139-601" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>sanity check interpretation</span>
<span id="cb139-602"><a href="#cb139-602" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>sanity check random effects structure : ITEM appropriate as random intercept? What does it mean to have two random intercepts?</span>
<span id="cb139-603"><a href="#cb139-603" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>DIAGNOSTICS: What in the world is happening with the normality of random effects plot? Do the fixed effects residuals need to be normally distributed?</span>
<span id="cb139-604"><a href="#cb139-604" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Are there other plots or recommended diagnostics for mixed log regression</span>
<span id="cb139-605"><a href="#cb139-605" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>consider multiple regression with rt, sequence cluster, confidence, etc.</span>
<span id="cb139-606"><a href="#cb139-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-609"><a href="#cb139-609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-610"><a href="#cb139-610" aria-hidden="true" tabindex="-1"></a><span class="co">#STEPWISE FIT ALT </span></span>
<span id="cb139-611"><a href="#cb139-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-612"><a href="#cb139-612" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb139-613"><a href="#cb139-613" aria-hidden="true" tabindex="-1"></a><span class="co"># m0 = glm(accuracy ~ 1, family = "binomial", data = df) </span></span>
<span id="cb139-614"><a href="#cb139-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-615"><a href="#cb139-615" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb139-616"><a href="#cb139-616" aria-hidden="true" tabindex="-1"></a><span class="co"># m0 = glm(accuracy ~ 1, family = "binomial", data = df) </span></span>
<span id="cb139-617"><a href="#cb139-617" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-618"><a href="#cb139-618" aria-hidden="true" tabindex="-1"></a><span class="co"># #:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb139-619"><a href="#cb139-619" aria-hidden="true" tabindex="-1"></a><span class="co"># mm.rS &lt;- glmer(accuracy ~ (1|subject), data = df,family = "binomial")</span></span>
<span id="cb139-620"><a href="#cb139-620" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb139-621"><a href="#cb139-621" aria-hidden="true" tabindex="-1"></a><span class="co"># # :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb139-622"><a href="#cb139-622" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("AIC with random effect is lower than glm empty model?", m0$aic &gt; AIC(logLik(mm.rS)))</span></span>
<span id="cb139-623"><a href="#cb139-623" aria-hidden="true" tabindex="-1"></a><span class="co"># test_lrt(m0,mm.rS) #same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb139-624"><a href="#cb139-624" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("Likelihood Ratio test is significant? p = ",(test_lrt(m0,mm.rS))$p[2])</span></span>
<span id="cb139-625"><a href="#cb139-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-626"><a href="#cb139-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-627"><a href="#cb139-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-628"><a href="#cb139-628" aria-hidden="true" tabindex="-1"></a><span class="fu">### TODO \| Ordinal Regression on ITEM-Interpretation</span></span>
<span id="cb139-629"><a href="#cb139-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-630"><a href="#cb139-630" aria-hidden="true" tabindex="-1"></a><span class="fu">### SHIFT IN MODAL MASS</span></span>
<span id="cb139-631"><a href="#cb139-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-632"><a href="#cb139-632" aria-hidden="true" tabindex="-1"></a>The Effect of Condition on Total Scaled Score can be described as a 'shift' in mass between the low and high modes of each distribution.</span>
<span id="cb139-633"><a href="#cb139-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-634"><a href="#cb139-634" aria-hidden="true" tabindex="-1"></a>_First, we use the Kolmogorov-Smirnov test as a Robust alternative to the t-test to test if the two distributions likely come from different populations._</span>
<span id="cb139-635"><a href="#cb139-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-638"><a href="#cb139-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-639"><a href="#cb139-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: COMPARE-DIST-NABS-comb</span></span>
<span id="cb139-640"><a href="#cb139-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-641"><a href="#cb139-641" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb139-642"><a href="#cb139-642" aria-hidden="true" tabindex="-1"></a><span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb139-643"><a href="#cb139-643" aria-hidden="true" tabindex="-1"></a>mbp <span class="ot">=</span> <span class="st">"/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb139-644"><a href="#cb139-644" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(mbp)</span>
<span id="cb139-645"><a href="#cb139-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-646"><a href="#cb139-646" aria-hidden="true" tabindex="-1"></a><span class="co">#(requires shift function files loaded)</span></span>
<span id="cb139-647"><a href="#cb139-647" aria-hidden="true" tabindex="-1"></a><span class="co">#LOAD MODAL SHIFT FUNCTION RESOURCES</span></span>
<span id="cb139-648"><a href="#cb139-648" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"analysis/utils/shift_function/Rallfun-v30.txt"</span>)</span>
<span id="cb139-649"><a href="#cb139-649" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"analysis/utils/shift_function/wilcox_modified.txt"</span>)</span>
<span id="cb139-650"><a href="#cb139-650" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"analysis/utils/shift_function/rgar_visualisation.txt"</span>)</span>
<span id="cb139-651"><a href="#cb139-651" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"analysis/utils/shift_function/rgar_utils.txt"</span>)</span>
<span id="cb139-652"><a href="#cb139-652" aria-hidden="true" tabindex="-1"></a><span class="co">#NOTE: something in these breaks the stat_ecdf in ggplot2</span></span>
<span id="cb139-653"><a href="#cb139-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-654"><a href="#cb139-654" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb139-655"><a href="#cb139-655" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span></span>
<span id="cb139-656"><a href="#cb139-656" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(s_SCALED, pretty_condition) <span class="sc">%&gt;%</span></span>
<span id="cb139-657"><a href="#cb139-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-658"><a href="#cb139-658" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">as.numeric</span>(s_SCALED),</span>
<span id="cb139-659"><a href="#cb139-659" aria-hidden="true" tabindex="-1"></a>    <span class="co">#flip order levels to correctly orient graph</span></span>
<span id="cb139-660"><a href="#cb139-660" aria-hidden="true" tabindex="-1"></a>    <span class="co"># gr = recode_factor(pretty_condition, "impasse" = "impasse", "control"="control")</span></span>
<span id="cb139-661"><a href="#cb139-661" aria-hidden="true" tabindex="-1"></a>    <span class="at">gr =</span> <span class="fu">as.character</span>(pretty_condition)</span>
<span id="cb139-662"><a href="#cb139-662" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(data,gr)</span>
<span id="cb139-663"><a href="#cb139-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-664"><a href="#cb139-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-665"><a href="#cb139-665" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gr <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(data)</span>
<span id="cb139-666"><a href="#cb139-666" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gr <span class="sc">==</span> <span class="st">"impasse"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(data)</span>
<span id="cb139-667"><a href="#cb139-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-668"><a href="#cb139-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-669"><a href="#cb139-669" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE DISTRIBUTIONS WITH ROBUST TESTS</span></span>
<span id="cb139-670"><a href="#cb139-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-671"><a href="#cb139-671" aria-hidden="true" tabindex="-1"></a><span class="co">#What do common tests say about the difference?</span></span>
<span id="cb139-672"><a href="#cb139-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-673"><a href="#cb139-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Kolmogorov-Smirnov test</span></span>
<span id="cb139-674"><a href="#cb139-674" aria-hidden="true" tabindex="-1"></a><span class="co">#If y is numeric, a two-sample (Smirnov) test of the null hypothesis that x and y </span></span>
<span id="cb139-675"><a href="#cb139-675" aria-hidden="true" tabindex="-1"></a><span class="co">#were drawn from the same continuous distribution is performed. Alternatively, y ...</span></span>
<span id="cb139-676"><a href="#cb139-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-677"><a href="#cb139-677" aria-hidden="true" tabindex="-1"></a><span class="co">#null is X is drawn from CDF EQUAL TO Y</span></span>
<span id="cb139-678"><a href="#cb139-678" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(g1,g2) </span>
<span id="cb139-679"><a href="#cb139-679" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SUGGESTS that impasse and control come from different population distributions"</span>)</span>
<span id="cb139-680"><a href="#cb139-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-681"><a href="#cb139-681" aria-hidden="true" tabindex="-1"></a><span class="co"># #null is X is NOT LESS THAN Y</span></span>
<span id="cb139-682"><a href="#cb139-682" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(g1,g2, <span class="at">alternative =</span> <span class="st">"greater"</span>) </span>
<span id="cb139-683"><a href="#cb139-683" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SUGGESTS that true CDF of CONTROL is greater than that of IMPASSE [consistent with higher probability of low scores]"</span>)</span>
<span id="cb139-684"><a href="#cb139-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-685"><a href="#cb139-685" aria-hidden="true" tabindex="-1"></a><span class="co">#REGULAR T-</span><span class="al">TEST</span></span>
<span id="cb139-686"><a href="#cb139-686" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(g1,g2) <span class="co"># regular Welsh t-test</span></span>
<span id="cb139-687"><a href="#cb139-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-688"><a href="#cb139-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-689"><a href="#cb139-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-692"><a href="#cb139-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-693"><a href="#cb139-693" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SHIFT-FN-NABS-comb</span></span>
<span id="cb139-694"><a href="#cb139-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| warnings: false</span></span>
<span id="cb139-695"><a href="#cb139-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| messages: false</span></span>
<span id="cb139-696"><a href="#cb139-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-697"><a href="#cb139-697" aria-hidden="true" tabindex="-1"></a><span class="co">#IF THIS ERRORS, consider loadling plyr (older than dplyr)</span></span>
<span id="cb139-698"><a href="#cb139-698" aria-hidden="true" tabindex="-1"></a><span class="co"># kernel density estimate + rug plot + superimposed deciles</span></span>
<span id="cb139-699"><a href="#cb139-699" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> <span class="fu">plot.kde_rug_dec2</span>(df)</span>
<span id="cb139-700"><a href="#cb139-700" aria-hidden="true" tabindex="-1"></a><span class="co"># kde</span></span>
<span id="cb139-701"><a href="#cb139-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-702"><a href="#cb139-702" aria-hidden="true" tabindex="-1"></a><span class="co"># compute shift function</span></span>
<span id="cb139-703"><a href="#cb139-703" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">shifthd</span>( g1, g2, <span class="at">nboot=</span><span class="dv">200</span>)</span>
<span id="cb139-704"><a href="#cb139-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-705"><a href="#cb139-705" aria-hidden="true" tabindex="-1"></a><span class="co"># plot shift function</span></span>
<span id="cb139-706"><a href="#cb139-706" aria-hidden="true" tabindex="-1"></a>sf <span class="ot">&lt;-</span> <span class="fu">plot.sf</span>(<span class="at">data=</span>out) <span class="co"># function from rgar_visualisation.txt</span></span>
<span id="cb139-707"><a href="#cb139-707" aria-hidden="true" tabindex="-1"></a><span class="co"># sf</span></span>
<span id="cb139-708"><a href="#cb139-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-709"><a href="#cb139-709" aria-hidden="true" tabindex="-1"></a><span class="co"># combine KDE + SF</span></span>
<span id="cb139-710"><a href="#cb139-710" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(kde, sf, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">1</span>),<span class="at">label_size =</span> <span class="dv">18</span>,<span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>,<span class="at">scale=</span>.<span class="dv">95</span>)</span>
<span id="cb139-711"><a href="#cb139-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-712"><a href="#cb139-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-713"><a href="#cb139-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-714"><a href="#cb139-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-715"><a href="#cb139-715" aria-hidden="true" tabindex="-1"></a><span class="fu">## RESOURCES</span></span>
<span id="cb139-716"><a href="#cb139-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-717"><a href="#cb139-717" aria-hidden="true" tabindex="-1"></a>reset plot margins par(mar=c(1,1,1,1))</span>
<span id="cb139-718"><a href="#cb139-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-719"><a href="#cb139-719" aria-hidden="true" tabindex="-1"></a><span class="fu">### Logistic Regression Notes</span></span>
<span id="cb139-720"><a href="#cb139-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-721"><a href="#cb139-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-722"><a href="#cb139-722" aria-hidden="true" tabindex="-1"></a>*The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable*</span>
<span id="cb139-723"><a href="#cb139-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-724"><a href="#cb139-724" aria-hidden="true" tabindex="-1"></a>*The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.*</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>