<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.640">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>SGC-X - 4&nbsp; Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../analysis/SGC3A/5_sgc3A_exploration.html" rel="next">
<link href="../../analysis/SGC3A/3_sgc3A_description.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_hypotesting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/5_sgc3A_exploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploratory Analyses</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC5A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/1_sgc5A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/2_sgc5A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">COMBINED</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/combined/combined.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#h1a-q1-accuracy" id="toc-h1a-q1-accuracy" class="nav-link active" data-scroll-target="#h1a-q1-accuracy">H1A | Q1 ACCURACY</a>
  <ul class="collapse">
<li>
<a href="#accuracy-of-q1-by-condition" id="toc-accuracy-of-q1-by-condition" class="nav-link" data-scroll-target="#accuracy-of-q1-by-condition">Accuracy of Q1 by Condition</a>
  <ul class="collapse">
<li>
<a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">LOGISTIC REGRESSION</a>
  <ul class="collapse">
<li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo">TODO</a></li>
  </ul>
</li>
  <li><a href="#todo-ordinal-regression" id="toc-todo-ordinal-regression" class="nav-link" data-scroll-target="#todo-ordinal-regression">TODO ORDINAL REGRESSION</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#h1b-test-phase-accuracy" id="toc-h1b-test-phase-accuracy" class="nav-link" data-scroll-target="#h1b-test-phase-accuracy">H1B | TEST PHASE ACCURACY</a>
  <ul class="collapse">
<li>
<a href="#test-phase-absolute-score" id="toc-test-phase-absolute-score" class="nav-link" data-scroll-target="#test-phase-absolute-score">Test Phase Absolute Score</a>
  <ul class="collapse">
<li>
<a href="#wip-mixed-logistic-regression" id="toc-wip-mixed-logistic-regression" class="nav-link" data-scroll-target="#wip-mixed-logistic-regression">WIP | MIXED LOGISTIC REGRESSION</a>
  <ul class="collapse">
<li><a href="#combined" id="toc-combined" class="nav-link" data-scroll-target="#combined">(Combined)</a></li>
  </ul>
</li>
  <li><a href="#todo-ordinal-regression-on-item-interpretation" id="toc-todo-ordinal-regression-on-item-interpretation" class="nav-link" data-scroll-target="#todo-ordinal-regression-on-item-interpretation">TODO | Ordinal Regression on ITEM-Interpretation</a></li>
  <li><a href="#cummulative-ordinal-bayesian" id="toc-cummulative-ordinal-bayesian" class="nav-link" data-scroll-target="#cummulative-ordinal-bayesian">Cummulative Ordinal (Bayesian)</a></li>
  <li><a href="#adjacent-category-ordinal-bayesian" id="toc-adjacent-category-ordinal-bayesian" class="nav-link" data-scroll-target="#adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">RESOURCES</a>
  <ul class="collapse">
<li><a href="#log-regresision-notes" id="toc-log-regresision-notes" class="nav-link" data-scroll-target="#log-regresision-notes">LOG REGRESISION NOTES</a></li>
  </ul>
</li>
  <li>
<a href="#wip-exploring" id="toc-wip-exploring" class="nav-link" data-scroll-target="#wip-exploring">WIP EXPLORING</a>
  <ul class="collapse">
<li>
<a href="#test-phase-accuracy" id="toc-test-phase-accuracy" class="nav-link" data-scroll-target="#test-phase-accuracy">Test Phase Accuracy</a>
  <ul class="collapse">
<li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#poisson-regression-todo" id="toc-poisson-regression-todo" class="nav-link" data-scroll-target="#poisson-regression-todo">Poisson Regression TODO</a></li>
  <li><a href="#zero-inflated-poisson" id="toc-zero-inflated-poisson" class="nav-link" data-scroll-target="#zero-inflated-poisson">Zero Inflated Poisson</a></li>
  <li><a href="#negative-binomial-regression" id="toc-negative-binomial-regression" class="nav-link" data-scroll-target="#negative-binomial-regression">Negative Binomial Regression</a></li>
  <li><a href="#zero-inflated-negative-binomial-regression" id="toc-zero-inflated-negative-binomial-regression" class="nav-link" data-scroll-target="#zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model Comparison</a></li>
  <li><a href="#hurdle-beta-regression" id="toc-hurdle-beta-regression" class="nav-link" data-scroll-target="#hurdle-beta-regression">Hurdle Beta Regression</a></li>
  <li><a href="#beta-regression-correct" id="toc-beta-regression-correct" class="nav-link" data-scroll-target="#beta-regression-correct">Beta Regression (% Correct)</a></li>
  <li><a href="#tobit-regression" id="toc-tobit-regression" class="nav-link" data-scroll-target="#tobit-regression">TOBIT Regression</a></li>
  <li><a href="#wip-hurdle-model" id="toc-wip-hurdle-model" class="nav-link" data-scroll-target="#wip-hurdle-model">WIP | HURDLE MODEL</a></li>
  </ul>
</li>
  <li>
<a href="#q1-accuracy" id="toc-q1-accuracy" class="nav-link" data-scroll-target="#q1-accuracy">Q1 Accuracy</a>
  <ul class="collapse">
<li>
<a href="#chi-square" id="toc-chi-square" class="nav-link" data-scroll-target="#chi-square">CHI SQUARE</a>
  <ul class="collapse">
<li><a href="#combined-1" id="toc-combined-1" class="nav-link" data-scroll-target="#combined-1">(Combined)</a></li>
  <li><a href="#in-person" id="toc-in-person" class="nav-link" data-scroll-target="#in-person">(In Person)</a></li>
  <li><a href="#online-replication" id="toc-online-replication" class="nav-link" data-scroll-target="#online-replication">(Online Replication)</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-SGC3A-hypotesting" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Study SGC3A | 4 Hypothesis Testing</p>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div style="page-break-after: always;"></div>
<p><strong>TODO</strong></p>
<ul>
<li>HURDLE MODEL? (mixture model w/ 0 + count)</li>
<li>review models already created in ARCHIVE?</li>
<li>separate combined (vs) lab (vs) online replication [once analysis strategy locked down]</li>
</ul>
<p><em>The purpose of this notebook is test the hypotheses that determined the design of the SGC3A study.</em></p>
<table class="table">
<colgroup><col style="width: 30%"></colgroup>
<thead><tr class="header">
<th>Pre-Requisite</th>
</tr></thead>
<tbody><tr class="odd">
<td>2_sgc3A_scoring.qmd</td>
</tr></tbody>
</table>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span> <span class="co"># %nin% operator</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span> <span class="co">#arrange plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span> <span class="co">#arrange shift function plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/ggformula">ggformula</a></span><span class="op">)</span> <span class="co">#easy graphs</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=vcdExtra">vcdExtra</a></span><span class="op">)</span> <span class="co">#mosaic plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span> <span class="co">#printing tables </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co">#visualize model coefficients</span>

<span class="co">#plot model estimates with uncertainty</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/">ggdist</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://modelr.tidyverse.org">modelr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.mitchelloharawild.com/distributional/">distributional</a></span><span class="op">)</span>

<span class="co">#models and performance</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a></span><span class="op">)</span> <span class="co">#plots w/ embedded stats</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/">report</a></span><span class="op">)</span> <span class="co">#easystats reporting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/">see</a></span><span class="op">)</span> <span class="co">#easystats visualization</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span> <span class="co">#easystats model diagnostics</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aloy/qqplotr">qqplotr</a></span><span class="op">)</span> <span class="co">#confint on qq plot</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gmodels</span><span class="op">)</span> <span class="co">#contingency table and CHISQR</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datalorax/equatiomatic">equatiomatic</a></span><span class="op">)</span> <span class="co">#extract model equation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zeroinfl / hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co">#mixed effects models </span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co">#ALL THE THINGS</span>

<span class="co">#OUTPUT OPTIONS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>ggplot2.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">1</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="co">#GRAPH THEMEING</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Research Questions</strong></p>
<p>In SGC3A we set out to answer the following question: Does posing a mental impasse improve performance on the graph comprehension task?</p>
<p><strong>Experimental Hypothesis</strong><br><em>Learners posed with scenario designed to evoke a mental impasse will be more likely to correct interpret the graph.</em></p>
<ul>
<li>H1A | Learners in the IMPASSE condition will be more likely to correctly answer the first question than learners in CONTROL.</li>
<li>H1B | Learners in the IMPASSE condition will score higher on the TEST Phase than learners in CONTROL.</li>
</ul>
<p><strong>Null Hypothesis</strong><br><em>No significant differences in performance will exist between learners in the IMPASSE and CONTROL conditions.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># HACK WD FOR LOCAL RUNNING?</span>
<span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="va">mbp</span> <span class="op">=</span> <span class="st">"/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span>
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="va">mbp</span><span class="op">)</span>

<span class="co">#IMPORT DATA </span>
<span class="va">df_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span><span class="op">)</span>
<span class="va">df_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span><span class="op">)</span>

<span class="co">#PREP DATA </span>
<span class="va">df_lab</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_mode</span> <span class="op">==</span> <span class="st">"laboratory"</span><span class="op">)</span>
<span class="va">df_online</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pretty_mode</span> <span class="op">==</span> <span class="st">"online-replication"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="h1a-q1-accuracy" class="level2"><h2 class="anchored" data-anchor-id="h1a-q1-accuracy">H1A | Q1 ACCURACY</h2>
<p><strong>Do Ss in the IMPASSE condition have a higher likelihood of producing a correct response to the first question?</strong></p>
<p>The graph comprehension tasks includes 15 questions completed in sequence. But the first question the reader encounters (Q1) is the most important, as it is their <em>first exposure</em> to the unconventional triangular coordinate system.</p>
<section id="accuracy-of-q1-by-condition" class="level3"><h3 class="anchored" data-anchor-id="accuracy-of-q1-by-condition">Accuracy of Q1 by Condition</h3>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 90%">
</colgroup>
<thead><tr class="header">
<th>Research Question</th>
<th>Does the frequency of correct (vs) incorrect responses on the first question differ by condition? [Is response accuracy independent of condition?]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the IMPASSE condition will have a higher likelihood of correctly responding to the first question than those in the CONTROL condition</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td>
<p>data: <code>df_items</code> where <code>q == 1</code></p>
<p>outcome:</p>
<ul>
<li><p><em>accuracy</em> ( factor(incorrect/correct) from <code>score_niceABS</code> [absolute score]</p></li>
<li><p><em>interpretation</em> (ordered factor from <code>interpretation</code>)</p></li>
</ul>
<p>predictor: <code>condition</code> [between-subjects factor]</p>
</td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td>
<ol type="1">
<li>Logistic Regression on <code>accuracy</code> predicted by <code>condition</code>
<ul>
<li>account for difference in odds of correct score by condition</li>
</ul>
</li>
<li>Ordinal Regression on <code>interpretation</code> predicted by <code>condition</code>
<ul>
<li>account for difference in (ordered correctness of interpretation) by condition</li>
</ul>
</li>
</ol>
<p>Alternative:</p>
<ul>
<li>Chi-Square test of independence on outcome <code>score_niceABS</code> by <code>condition</code>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td><strong>Notes</strong></td>
<td><ul>
<li>CHIQ SQR is simplest method to examine independence of two categorical factors; LOGISTIC REGRESSION is recommended for binomial ~ continuous; though with regression we can quantify the size of the effect and overall model fit</li>
<li>independence assumption : (CHI SQR) as we only consider responses on the first question, each observation corresponds to an individual subject, and are thus independent</li>
<li>cell frequency : (CHI SQR) expected frequency in each cell of the contingency table is greater than 5 (more than 5 correct , more than 5 incorrect responses)</li>
</ul></td>
</tr>
</tbody>
</table>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FILTER THE DATASET</span>
<span class="va">df_q1</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">score_niceABS</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="st">"incorrect"</span>, <span class="st">"1"</span><span class="op">=</span><span class="st">"correct"</span><span class="op">)</span>
<span class="op">)</span>
 
<span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="co"># gf_props(~accuracy, fill = ~pretty_condition, </span>
<span class="co">#        position = position_dodge(), data = df_q1) %&gt;% </span>
<span class="co">#   gf_facet_grid(~pretty_mode) +</span>
<span class="co">#    labs(x = "Correct Response on Q 1",</span>
<span class="co">#        title = "Accuracy on First Question by Condition",</span>
<span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses") #theme(legend.position = "none")</span>

<span class="co">#STACKED BAR CHART</span>
<span class="va">df_q1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "Correct Response on Q 1",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on First Question by Condition"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/SETUP-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A proportional bar chart visualizing the proportion of incorrect (vs) correct responses in each condition for each data collection modality (left/right facet) reveals that the pattern of responses appear the same regardless of the data collection modality. In both data collection sessions, the proportion of incorrect responses is much greater than the proportion of correct responses, regardless of condition (marginal probability of incorrect). In the impasse condition, the difference in proportions is smaller than the control condition (conditional probability of success in impasse; (i.e) There are more correct responses in the impasse condition than the control condition).</p>
<section id="logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="logistic-regression">LOGISTIC REGRESSION</h4>
<section id="model" class="level5"><h5 class="anchored" data-anchor-id="model">Model</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#combined</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_q1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accuracy</span>,<span class="va">score_niceABS</span>,<span class="va">pretty_condition</span>,<span class="va">pretty_mode</span>, <span class="va">rt_s</span><span class="op">)</span>

<span class="co"># FREQUENCY TABLE</span>
<span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span>
<span class="co"># addmargins(my.table) #counts</span>
<span class="co"># addmargins(prop.table(my.table)) #props</span>

<span class="co">#:::::::::::::::::::::::::::::::::::::::</span>
<span class="co">#CONDITION MODEL</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"LOGISTIC REGRESSION MODEL"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "LOGISTIC REGRESSION MODEL"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span>, 
          data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.819  -0.819  -0.548  -0.548   1.986  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.822      0.230   -7.93  2.2e-15 ***
pretty_conditionimpasse    0.901      0.285    3.16   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 343.66  on 329  degrees of freedom
Residual deviance: 333.07  on 328  degrees of freedom
AIC: 337.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- LOG ODDS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- LOG ODDS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         2.5 % 97.5 %
(Intercept)             -2.299  -1.39
pretty_conditionimpasse  0.353   1.48</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Coefficients —- ODDS RATIOS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients —- ODDS RATIOS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#exponentiate</span>
<span class="va">e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                              2.5 % 97.5 %
(Intercept)             0.162  0.10  0.248
pretty_conditionimpasse 2.463  1.42  4.374</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PERFORMANCE"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log | Score_spherical |   PCP
----------------------------------------------------------------------------------------------
337.074 | 344.673 |     0.031 | 0.404 | 1.008 |    0.505 |   -16.847 |           0.021 | 0.673</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"SANITY CHECK REPORTING"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SANITY CHECK REPORTING"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model's explanatory power is weak (Tjur's R2 = 0.03). The model's intercept, corresponding to pretty_condition = control, is at -1.82 (95% CI [-2.30, -1.39], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.90, 95% CI [0.35, 1.48], p = 0.002; Std. beta = 0.90, 95% CI [0.35, 1.48])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"MODEL PREDICTIONS"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PREDICTIONS"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Retrieve predictions as probabilities </span>
<span class="co"># (for each level of the predictor)</span>
<span class="va">p.control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pretty_condition<span class="op">=</span><span class="st">"control"</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Probability of success in control,"</span>, <span class="va">p.control</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in control, 0.139240506329147"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p.impasse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pretty_condition<span class="op">=</span><span class="st">"impasse"</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Probability of success in impasse,"</span>, <span class="va">p.impasse</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in impasse, 0.284883720930631"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GGSTATS | MODEL | LOG ODDS </span>
<span class="co"># library(ggstatsplot)</span>
<span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggcoefstats.html">ggcoefstats</a></span><span class="op">(</span><span class="va">m</span>, output <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Log Odds Estimate"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/MODEL-Q1ACC-LOG-combined-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/MODEL-Q1ACC-LOG-combined-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="co"># plot_model(m, type="pred",</span>
<span class="co">#            show.intercept = TRUE, </span>
<span class="co">#            show.values = TRUE,</span>
<span class="co">#            title = "Model Predicted Probability of Accuracy",</span>
<span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span>

<span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span>
<span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggeffect</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">m</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/MODEL-Q1ACC-LOG-combined-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SANITY CHECK SJPLOT</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="diagnostics" class="level5"><h5 class="anchored" data-anchor-id="diagnostics">Diagnostics</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/binned_residuals.html">binned_residuals</a></span><span class="op">(</span><span class="va">m</span>, n_bins<span class="op">=</span><span class="fl">10</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Ok: About 100% of the residuals are inside the error bounds.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="inference" class="level5"><h5 class="anchored" data-anchor-id="inference">Inference</h5>
<p>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the <em>impasse condition</em> increase by 146% (<span class="math inline">\(e^{beta_1}\)</span> = 2.46, 95% CI [1.42, 4.37]) over the <em>control condition</em>.</p>
<p><em>Equivalent statements:</em></p>
<ul>
<li>being in impasse condition increases log odds of correct response by 0.901 (over control)</li>
<li>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</li>
<li>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</li>
</ul></section><section id="todo" class="level5"><h5 class="anchored" data-anchor-id="todo">TODO</h5>
<ul>
<li>Are these residuals OK? I didn’t think normally distributed residuals were an assumption for logistic regression.</li>
<li>Interpretation/reporting of model fit?</li>
<li>sanity check correct interpretation of coefficients &amp; reporting</li>
</ul></section></section><section id="todo-ordinal-regression" class="level4"><h4 class="anchored" data-anchor-id="todo-ordinal-regression">TODO ORDINAL REGRESSION</h4>
<ul>
<li>https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</li>
<li>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</li>
<li>todo see ordinal regression video</li>
</ul>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># #CREATE DATAFRAME OF Q1</span>
<span class="co"># df &lt;- df_items %&gt;% filter(q ==1) %&gt;% mutate(scaled = as.factor(score_SCALED))</span>
<span class="co"># </span>
<span class="co"># #MODEL</span>
<span class="co"># m &lt;- polr(scaled ~ condition , data = df, Hess=TRUE)</span>
<span class="co"># summary(m)</span>
<span class="co"># confint(m)</span>
<span class="co"># performance(m)</span>
<span class="co"># report(m)</span>
<span class="co"># </span>
<span class="co"># #exponentiate coefficients and CIs </span>
<span class="co"># ci &lt;- confint(m)</span>
<span class="co"># ci</span>
<span class="co"># e &lt;- coef(m)</span>
<span class="co"># e</span>
<span class="co"># # exp(cbind(e,ci))</span>
<span class="co"># </span>
<span class="co"># # Retrieve predictions as probabilities </span>
<span class="co"># # (for each level of the predictor)</span>
<span class="co"># # p.control &lt;- predict(m,data.frame(condition="111"),type="response")</span>
<span class="co"># # paste("Probability of success in control,", p.control)</span>
<span class="co"># # p.impasse &lt;- predict(m,data.frame(condition="121"),type="response")</span>
<span class="co"># # paste("Probability of success in impasse,", p.impasse)</span>
<span class="co"># </span>
<span class="co"># # Plot Predicted data and original data points</span>
<span class="co"># # ggplot(df, aes(x=condition, y=accuracy)) + </span>
<span class="co"># #   geom_point() +</span>
<span class="co"># #   stat_smooth(method="glm", color="green", se=FALSE,</span>
<span class="co"># #                 method.args = list(family=binomial))</span>
<span class="co">#   </span>
<span class="co"># #TO PLOT ALL EFFECTS</span>
<span class="co"># library(effects)</span>
<span class="co"># plot(allEffects(m))</span>
<span class="co"># </span>
<span class="co"># #SJPLOT</span>
<span class="co"># library(sjPlot)</span>
<span class="co"># plot_model(m, )</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># #CONVERT TO PROBABILITIES</span>
<span class="co"># newdat &lt;- data.frame(condition=c("111","121"))</span>
<span class="co"># prob &lt;- (phat &lt;- predict(object = m, newdat, type="p"))</span>
<span class="co"># prob</span>
<span class="co"># </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section><section id="h1b-test-phase-accuracy" class="level2"><h2 class="anchored" data-anchor-id="h1b-test-phase-accuracy">H1B | TEST PHASE ACCURACY</h2>
<p><strong>Do Ss in the IMPASSE condition have higher scores in the TEST Phase of the task?</strong></p>
<p>The graph comprehension tasks includes 13 interpretation-discriminant questions completed in sequence. The first five questions constitute the ‘scaffold’ phase, and the remaining 8 the test phase. By examining the effect of condition on test-phase scores, we can evaluate if the impasse scaffold has an effect after it it has been removed.</p>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<thead><tr class="header">
<th>Research Question</th>
<th>Do Ss in the IMPASSE condition score higher in the test phase than those in the CONTROL group.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>(H1B) Participants in the IMPASSE condition will have higher test phase performance than those in the CONTROL condition.</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td>
<p><strong>data</strong>: <code>df_items</code> where <code>q in 7,8,10,11,12,13,14,15</code> (the 8 discriminating test phase questions), <code>df_subjects</code></p>
<p><strong>outcome</strong>:</p>
<ul>
<li>[at item level]
<ul>
<li>
<em>accuracy</em> ( factor(incorrect/correct) from <code>score_niceABS</code> [absolute score]</li>
<li>
<em>interpretation</em> (ordered factor from <code>interpretation</code>)</li>
</ul>
</li>
<li>[subject level]
<ul>
<li>p_accuracy (percent of correct responses)</li>
</ul>
</li>
</ul>
<p><strong>predictor</strong>: <code>condition</code> [between-subjects factor]</p>
</td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>Shift in Modal Mass (descriptive)<br>
describe &amp; visualize shift in deciles between conditions for <code>`scaled_score`</code> (at subject level)</li>
<li>Mixed Logistic Regression<br><code>accuracy</code> ~ <code>condition</code> + (1 | <code>subject</code> )<br>
model effect of condition on probability of correct response [during test phase] while accounting for subject (and item-level?) effects</li>
<li>Ordinal Mixed Logistic Regression<br><code>interpretation</code> ~ <code>condition</code> + (1 | <code>subject</code> )<br>
model effect of condition on [ordered correctness of interpretation] [during test phase] while accounting for subject (and item-level?) effects</li>
</ol></td>
</tr>
<tr class="even">
<td><strong>Alternatives</strong></td>
<td><ul>
<li>OLS LINEAR REGRESSION
<ul>
<li>bimodal distribution at tails makes the mean a poor predictor; LMs violate assumptions of normally distributed residuals</li>
<li>lm <code>DV_percent_test_NABS</code> ~ <code>condition</code> (absolute scoring) OR lm <code>item_test_SCALED</code> ~ <code>condition</code> (scaled scoring)</li>
<li>both absolute and scaled scores yield non-normal residuals</li>
<li>no transformation of the outcome variables yield normal residuals</li>
</ul>
</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Notes</strong></td>
<td>
<p><strong>Also exploring:</strong></p>
<ul>
<li>Hurdle model (mixture model w/ binomial + [poisson or negbinom count; 0s from 1 DGP)</li>
<li>Zero Inflated model (mixture model w/ binomial + poisson or negbinom count; 0s from 2 DGPs)</li>
<li>Beta regression hurdle model? (mixture with location and scale parameters [mean, variance] and hurdles for floor and ceiling effects)</li>
<li>Other way to account for the severe bimodality?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PREPARE DATA </span>
<span class="va">n_items</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#number of items in test</span>

<span class="co">#item level</span>
<span class="va">df_test</span> <span class="op">=</span> <span class="va">df_items</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/pkg/Hmisc/man/nin.html">%nin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">score_niceABS</span><span class="op">)</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">#subject level</span>
<span class="va">df_Stest</span> <span class="op">=</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  p_accuracy <span class="op">=</span> <span class="va">item_test_NABS</span><span class="op">/</span><span class="va">n_items</span>
<span class="op">)</span>

<span class="co">#STACKED PROPORTIONAL BAR CHART</span>
<span class="va">df_test</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>,
         mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pretty_condition</span>,
                       fill <span class="op">=</span> <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span> <span class="op">)</span> <span class="op">+</span> <span class="co">#,color = "black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span><span class="co">#y = "Correct Response on Q 1",</span>
       title <span class="op">=</span> <span class="st">"Accuracy on Test Phase Questions"</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span>,
       fill <span class="op">=</span> <span class="st">""</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/SETUP-TEST-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#GROUPED PROPORTIONAL BAR CHART</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">accuracy</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, x <span class="op">=</span><span class="op">~</span><span class="va">pretty_condition</span>,
       position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df_test</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">pretty_mode</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Correct Responses in Test Phase"</span>,
       title <span class="op">=</span> <span class="st">"Accuracy in Test Phase by Condition"</span>,
       subtitle<span class="op">=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/SETUP-TEST-ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FACETED HISTOGRAM</span>
<span class="va">stats</span> <span class="op">=</span> <span class="va">df_Stest</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">pretty_condition</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_accuracy</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_bar.html">gf_props</a></span><span class="op">(</span><span class="op">~</span><span class="va">p_accuracy</span>, 
         fill <span class="op">=</span> <span class="op">~</span><span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_Stest</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">pretty_mode</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_lines.html">gf_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stats</span>, xintercept <span class="op">=</span> <span class="op">~</span><span class="va">mean</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"% Correct"</span>,
       y <span class="op">=</span> <span class="st">"proportion of subjects"</span>,
       title <span class="op">=</span> <span class="st">"Test Phase Absolute Score (% Correct)"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/SETUP-TEST-ACC-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="test-phase-absolute-score" class="level3"><h3 class="anchored" data-anchor-id="test-phase-absolute-score">Test Phase Absolute Score</h3>
<section id="wip-mixed-logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="wip-mixed-logistic-regression">WIP | MIXED LOGISTIC REGRESSION</h4>
<section id="combined" class="level5"><h5 class="anchored" data-anchor-id="combined">(Combined)</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_test</span> 

<span class="co"># SUBJECT INTERCEPT </span>
<span class="va">mm.rS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm.rS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ (1 | subject)
   Data: df

     AIC      BIC   logLik deviance df.resid 
    1388     1400     -692     1384     2638 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5320 -0.0121 -0.0121  0.1117  2.7246 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 132      11.5    
Number of obs: 2640, groups:  subject, 330

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -8.66       0.55   -15.8   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># SUBJECT + ITEM INTERCEPT </span>
<span class="va">mm.rSQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">q</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm.rSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ (1 | subject) + (1 | q)
   Data: df

     AIC      BIC   logLik deviance df.resid 
    1326     1344     -660     1320     2637 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.396 -0.011 -0.008  0.066  7.858 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 180.606  13.44   
 q       (Intercept)   0.563   0.75   
Number of obs: 2640, groups:  subject, 330; q, 8

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -9.995      0.596   -16.8   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># SUBJECT INTERCEPT | CONDITION FIXED</span>
<span class="va">mm.CrS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm.CrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition + (1 | subject)
   Data: df

     AIC      BIC   logLik deviance df.resid 
    1385     1402     -689     1379     2637 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5307 -0.0193 -0.0097  0.1135  2.7426 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 117      10.8    
Number of obs: 2640, groups:  subject, 330

Fixed effects:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -9.182      0.677  -13.56   &lt;2e-16 ***
pretty_conditionimpasse    1.632      0.753    2.17     0.03 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
prtty_cndtn -0.394</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># SUBJECT INTERCEPT | ITEM FIXED</span>
<span class="va">mm.QrS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">q</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,
                family <span class="op">=</span> <span class="st">"binomial"</span>,nAGQ<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm.QrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Adaptive
  Gauss-Hermite Quadrature, nAGQ = 0) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ q + (1 | subject)
   Data: df

     AIC      BIC   logLik deviance df.resid 
    1421     1474     -701     1403     2631 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.243 -0.119 -0.082  0.105  7.488 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 33.7     5.81    
Number of obs: 2640, groups:  subject, 330

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -2.413      0.433   -5.57  2.5e-08 ***
q8            -1.748      0.361   -4.84  1.3e-06 ***
q10            0.733      0.367    2.00    0.045 *  
q11            0.397      0.364    1.09    0.276    
q12            0.532      0.365    1.46    0.146    
q13           -0.130      0.360   -0.36    0.719    
q14            0.934      0.367    2.54    0.011 *  
q15            0.464      0.365    1.27    0.203    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
    (Intr) q8     q10    q11    q12    q13    q14   
q8  -0.418                                          
q10 -0.433  0.475                                   
q11 -0.424  0.485  0.496                            
q12 -0.427  0.481  0.497  0.495                     
q13 -0.416  0.506  0.492  0.496  0.494              
q14 -0.441  0.469  0.503  0.497  0.499  0.490       
q15 -0.425  0.483  0.497  0.495  0.496  0.495  0.498</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># SUBJECT INTERCEPT | CONDITION + ITEM FIXED</span>
<span class="va">mm.CQrS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">+</span> <span class="va">q</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,
                family <span class="op">=</span> <span class="st">"binomial"</span>,nAGQ<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm.CQrS</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Adaptive
  Gauss-Hermite Quadrature, nAGQ = 0) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition + q + (1 | subject)
   Data: df

     AIC      BIC   logLik deviance df.resid 
    1399     1458     -690     1379     2630 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.283 -0.116 -0.089  0.101  7.353 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 31.6     5.62    
Number of obs: 2640, groups:  subject, 330

Fixed effects:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -3.529      0.583   -6.06  1.4e-09 ***
pretty_conditionimpasse    2.075      0.704    2.95   0.0032 ** 
q8                        -1.744      0.360   -4.84  1.3e-06 ***
q10                        0.734      0.367    2.00   0.0453 *  
q11                        0.397      0.364    1.09   0.2754    
q12                        0.532      0.365    1.46   0.1455    
q13                       -0.130      0.360   -0.36   0.7188    
q14                        0.935      0.368    2.54   0.0110 *  
q15                        0.465      0.365    1.27   0.2030    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) prtty_ q8     q10    q11    q12    q13    q14   
prtty_cndtn -0.680                                                 
q8          -0.303 -0.013                                          
q10         -0.327  0.008  0.475                                   
q11         -0.317  0.004  0.486  0.495                            
q12         -0.321  0.006  0.481  0.497  0.495                     
q13         -0.308 -0.001  0.506  0.492  0.496  0.494              
q14         -0.335  0.011  0.469  0.502  0.496  0.498  0.490       
q15         -0.319  0.005  0.483  0.496  0.495  0.495  0.495  0.497</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># SUBJECT + ITEM INTERCEPT | CONDITION FIXED</span>
<span class="va">mm.CrSQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">q</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>,family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition + (1 | subject) + (1 | q)
   Data: df

     AIC      BIC   logLik deviance df.resid 
    1324     1348     -658     1316     2636 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.386 -0.014 -0.008  0.067  7.780 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 166.294  12.896  
 q       (Intercept)   0.543   0.737  
Number of obs: 2640, groups:  subject, 330; q, 8

Fixed effects:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -10.562      0.733  -14.41   &lt;2e-16 ***
pretty_conditionimpasse    1.501      0.775    1.94    0.053 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
prtty_cndtn -0.485</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">mm.rS</span>, <span class="va">mm.rSQ</span>, <span class="va">mm.CrS</span>, <span class="va">mm.QrS</span>, <span class="va">mm.CQrS</span>,<span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name    |    Model |      AIC | AIC weights |      BIC | BIC weights | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma | Log_loss | Score_log | Score_spherical
---------------------------------------------------------------------------------------------------------------------------------------------------------------
mm.rS   | glmerMod | 1387.730 |     &lt; 0.001 | 1399.487 |     &lt; 0.001 |      0.976 |      0.000 | 0.976 | 0.203 | 1.000 |    0.129 |      -Inf |           0.015
mm.rSQ  | glmerMod | 1326.298 |       0.277 | 1343.934 |       0.878 |      0.982 |      0.000 | 0.982 | 0.186 | 1.000 |    0.111 |      -Inf |           0.015
mm.CrS  | glmerMod | 1384.749 |     &lt; 0.001 | 1402.385 |     &lt; 0.001 |      0.973 |      0.005 | 0.973 | 0.203 | 1.000 |    0.130 |      -Inf |           0.015
mm.QrS  | glmerMod | 1420.795 |     &lt; 0.001 | 1473.702 |     &lt; 0.001 |      0.913 |      0.016 | 0.911 | 0.187 | 1.000 |    0.119 |      -Inf |           0.006
mm.CQrS | glmerMod | 1398.915 |     &lt; 0.001 | 1457.701 |     &lt; 0.001 |      0.910 |      0.046 | 0.906 | 0.187 | 1.000 |    0.119 |      -Inf |           0.006
mm.CrSQ | glmerMod | 1324.375 |       0.723 | 1347.889 |       0.122 |      0.981 |      0.003 | 0.981 | 0.186 | 1.000 |    0.112 |      -Inf |           0.015</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJ PLOTS TABLES</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">mm.rS</span>, <span class="va">mm.rSQ</span>, <span class="va">mm.CrS</span>, <span class="va">mm.QrS</span>, <span class="va">mm.CQrS</span>,<span class="va">mm.CrSQ</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  4">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  5">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  6">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  7">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  8">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  9">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">0.00&nbsp;–&nbsp;0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">0.04&nbsp;–&nbsp;0.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">0.01&nbsp;–&nbsp;0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8">0.00&nbsp;–&nbsp;0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition: impasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">5.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">1.17&nbsp;–&nbsp;22.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"><strong>0.030</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">7.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">2.00&nbsp;–&nbsp;31.65</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6"><strong>0.003</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7">4.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8">0.98&nbsp;–&nbsp;20.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9">0.053</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">q8</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">0.09&nbsp;–&nbsp;0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">0.09&nbsp;–&nbsp;0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9"></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">q10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">2.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">1.02&nbsp;–&nbsp;4.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3"><strong>0.045</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">2.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">1.02&nbsp;–&nbsp;4.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6"><strong>0.045</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9"></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">q11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">1.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">0.73&nbsp;–&nbsp;3.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">0.276</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">1.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">0.73&nbsp;–&nbsp;3.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6">0.275</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9"></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">q12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">1.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">0.83&nbsp;–&nbsp;3.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">0.146</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">1.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">0.83&nbsp;–&nbsp;3.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6">0.146</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9"></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">q13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">0.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">0.43&nbsp;–&nbsp;1.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">0.719</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">0.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">0.43&nbsp;–&nbsp;1.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6">0.719</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9"></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">q14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">2.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">1.24&nbsp;–&nbsp;5.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3"><strong>0.011</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">2.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">1.24&nbsp;–&nbsp;5.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6"><strong>0.011</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9"></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">q15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">1.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">0.78&nbsp;–&nbsp;3.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">0.203</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  4">1.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  5">0.78&nbsp;–&nbsp;3.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  6">0.203</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  9"></td>
</tr>
<tr>
<td colspan="19" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">132.45 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">180.61 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">116.99 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">33.73 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">31.64 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">166.29 <sub>subject</sub>
</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.56 <sub>q</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.54 <sub>q</sub>
</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.98</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330 <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330 <sub>subject</sub>
</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">8 <sub>q</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">8 <sub>q</sub>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2640</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2640</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2640</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2640</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2640</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2640</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.976</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.982</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.005 / 0.973</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.016 / 0.913</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.046 / 0.910</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.003 / 0.981</td>
</tr>
</tbody></table>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#THEORETICALLY MOTIVATED MODEL</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="va">mm.CrS</span>
<span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Package 'merDeriv' needs to be installed to compute confidence intervals
  for random effect parameters.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Package 'merDeriv' needs to be installed to compute confidence intervals
  for random effect parameters.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic mixed model (estimated using ML and Nelder-Mead optimizer) to predict accuracy with pretty_condition (formula: accuracy ~ pretty_condition). The model included subject as random effect (formula: ~1 | subject). The model's total explanatory power is substantial (conditional R2 = 0.97) and the part related to the fixed effects alone (marginal R2) is of 5.50e-03. The model's intercept, corresponding to pretty_condition = control, is at -9.18 (95% CI [-10.51, -7.85], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 1.63, 95% CI [0.16, 3.11], p = 0.030; Std. beta = 1.63, 95% CI [0.16, 3.11])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MODEL FORMULA"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL FORMULA"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">m</span><span class="op">@</span><span class="va">call</span><span class="op">[[</span><span class="st">"formula"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "~"                                "accuracy"                        
[3] "pretty_condition + (1 | subject)"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJ PLOTS</span>
<span class="co">#table of effects</span>
<span class="fu">sjPlot</span><span class="fu">::</span> <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition: impasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.17&nbsp;–&nbsp;22.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.030</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">116.99</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.97</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">330</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2640</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.005 / 0.973</td>
</tr>
</tbody></table>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#PLOT RANDOM EFFECTS</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span>
<span class="va">randoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/ranef.html">ranef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">dotplot</a></span><span class="op">(</span><span class="va">randoms</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$subject</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | ODDS RATIO</span>
<span class="co">#library(sjPlot)</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m</span>, type<span class="op">=</span><span class="st">"std2"</span>, vline.color <span class="op">=</span> <span class="st">"red"</span>, 
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Predicted Odds Ratio"</span>,
       subtitle <span class="op">=</span> <span class="st">""</span>,
       x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SJPLOT | MODEL | PROBABILITIES</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m</span>, type<span class="op">=</span><span class="st">"pred"</span>,
           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>, 
           show.values <span class="op">=</span> <span class="cn">TRUE</span>,
           title <span class="op">=</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,
           axis.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SANITY CHECK SJPLOT</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">effects</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'effects' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'carData' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'carData'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcdExtra':

    Burt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Use the command
    lattice::trellis.par.set(effectsTheme())
  to customize lattice options for effects plots.
See ?effectsTheme for details.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">allEffects</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="todo-ordinal-regression-on-item-interpretation" class="level4"><h4 class="anchored" data-anchor-id="todo-ordinal-regression-on-item-interpretation">TODO | Ordinal Regression on ITEM-Interpretation</h4>
</section><section id="cummulative-ordinal-bayesian" class="level4"><h4 class="anchored" data-anchor-id="cummulative-ordinal-bayesian">Cummulative Ordinal (Bayesian)</h4>
<p>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># library(brms)</span>


<span class="co"># #DEFINE DATA </span>
<span class="co"># df &lt;- df_items %&gt;% mutate(</span>
<span class="co">#   scaled = factor(score_SCALED, ordered = TRUE,  #ordered factor</span>
<span class="co">#                     levels = c("-1", "-0.5", "0", "0.5","1"))</span>
<span class="co"># )</span>
<span class="co"># </span>
<span class="co"># ord_cum &lt;- brm( formula = scaled ~ condition,</span>
<span class="co">#                data = df,</span>
<span class="co">#                family = cumulative("probit"),</span>
<span class="co">#                file = "analysis/SGC3A/models/m_items_ord.cum.rds" # cache model (can be removed)  </span>
<span class="co"># </span>
<span class="co"># )</span>
<span class="co"># </span>
<span class="co"># summary(ord_cum)</span>
<span class="co"># conditional_effects(ord_cum, "condition", categorical = TRUE)</span>
<span class="co"># </span>
<span class="co"># #SJPLOT</span>
<span class="co"># library(sjPlot)</span>
<span class="co"># plot_model(ord_cum)</span>
<span class="co"># </span>
<span class="co"># # m %&gt;%</span>
<span class="co"># #   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co"># #   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co"># #   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co"># #   stat_halfeye()</span>
<span class="co"># </span>
<span class="co"># # performance(ord_cum)</span>
<span class="co"># # plot(ord_cum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="adjacent-category-ordinal-bayesian" class="level4"><h4 class="anchored" data-anchor-id="adjacent-category-ordinal-bayesian">Adjacent-Category Ordinal (Bayesian)</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># </span>
<span class="co"># #DEFINE DATA </span>
<span class="co"># df &lt;- df_items %&gt;% mutate(</span>
<span class="co">#   scaled = factor(score_SCALED, ordered = TRUE,  #ordered factor</span>
<span class="co">#                     levels = c("-1", "-0.5", "0", "0.5","1"))</span>
<span class="co"># )</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span>
<span class="co"># </span>
<span class="co"># ord_acat &lt;- brm( formula = scaled ~ cs(condition),</span>
<span class="co">#                data = df,</span>
<span class="co">#                family = acat("probit"),</span>
<span class="co">#                file = "analysis/SGC3A/models/m_items_ord.acat.rds" # cache model (can be removed)  </span>
<span class="co"># )</span>
<span class="co"># </span>
<span class="co"># summary(ord_acat)</span>
<span class="co"># conditional_effects(ord_cum, "condition", categorical = TRUE)</span>
<span class="co"># conditional_effects(ord_acat, "condition", categorical = TRUE)</span>
<span class="co"># </span>
<span class="co"># #TIDYBAYES VISUALIZATION</span>
<span class="co"># library(tidybayes)</span>
<span class="co"># ord_acat %&gt;%</span>
<span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span>
<span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span>
<span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span>
<span class="co">#   stat_halfeye()</span>
<span class="co"># </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section><section id="resources" class="level2"><h2 class="anchored" data-anchor-id="resources">RESOURCES</h2>
<p>reset plot margins par(mar=c(1,1,1,1))</p>
<section id="log-regresision-notes" class="level3"><h3 class="anchored" data-anchor-id="log-regresision-notes">LOG REGRESISION NOTES</h3>
<p><strong>Understanding the logistic regression model</strong></p>
<p><em>The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable</em></p>
<p><em>The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.</em></p>
<p><strong>[the empty model</strong></p>
<ul>
<li>The intercept of an empty model (glm(accuracy ~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df$accuracy ==1 ).</li>
<li>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -&gt; log(0.215 / (1-0.215)) = -1.29.</li>
<li>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</li>
<li>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</li>
</ul>
<p><strong>[a dichotomous predictor]</strong></p>
<p>natural log (odds of +) = -1.822 + 0.9(x1) ; x1 = 0 for control, 1 for impasse</p>
<ul>
<li>INTERCEPT: log odds of (+ response) in control condition
<ul>
<li>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</li>
<li>convert to odds by exponentiating the coefficients<br>
log odds of (+) in control = exp(-1.822) = 0.162 odds</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139<br>
probability of (+) in control = ~14%</li>
</ul>
</li>
<li>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs.&nbsp;control
<ul>
<li>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</li>
<li>convert to odds by exponentiating log odds<br>
log odds (+) in impasse = exp(-0.921) = 0.398</li>
<li>convert to probability by formula =&gt;<br>
p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285<br>
probaility of (+) in impasse = ~ 29%</li>
</ul>
</li>
<li>ODDS RATIO : exponentiated B1 COEFFICIENT
<ul>
<li><p>B1 = (slope of logit model = difference in log odds = log odds ratio</p></li>
<li><p>B1 = 0.901 is log odds ratio of (+) in impasse vs control</p></li>
<li><p>exp(b1) = exp(0.901) = 2.46</p></li>
<li><p>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</p></li>
</ul>
</li>
</ul>
<table class="table">
<colgroup><col style="width: 100%"></colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">MARGINAL<br>
total = 330 success : 71, failure : 259<br>
p(+) = 71 / 330 = 0.215 = 22%<br>
odds(+) = 71 / 259 = 0.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">CONTROL total = 158 success = 22; failure = 136<br>
p(+) = 22/158 = 0.139 = 14%<br>
odds(+) = 22/136 = 0.162</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMPASSE total = 172 success = 49; failure = 123<br>
p(+) = 49/172 = 0.285 = 29%<br>
odds(+) = 49/123 = 0.398</td>
</tr>
</tbody>
</table></section></section><section id="wip-exploring" class="level2"><h2 class="anchored" data-anchor-id="wip-exploring">WIP EXPLORING</h2>
<section id="test-phase-accuracy" class="level3"><h3 class="anchored" data-anchor-id="test-phase-accuracy">Test Phase Accuracy</h3>
<p><strong>Test Phase Absolute Score (# questions)</strong></p>
<section id="linear-regression" class="level4"><h4 class="anchored" data-anchor-id="linear-regression">Linear Regression</h4>
<p><em>LM on Test Phase absolute score <strong>as number of questions</strong>, rather than % correct.</em></p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SCORE predicted by CONDITION</span>
<span class="va">lm.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = item_test_NABS ~ pretty_condition, data = df_subjects)

Residuals:
   Min     1Q Median     3Q    Max 
 -3.02  -2.77  -1.52   2.98   6.48 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                1.519      0.251    6.04  4.1e-09 ***
pretty_conditionimpasse    1.498      0.348    4.30  2.2e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.16 on 328 degrees of freedom
Multiple R-squared:  0.0535,    Adjusted R-squared:  0.0506 
F-statistic: 18.5 on 1 and 328 DF,  p-value: 0.0000222</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Partition Variance"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: item_test_NABS
                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
pretty_condition   1    185     185    18.5 0.000022 ***
Residuals        328   3274      10                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Confidence Interval on Parameter Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        2.5 % 97.5 %
(Intercept)             1.025   2.01
pretty_conditionimpasse 0.814   2.18</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span> <span class="co">#sanity check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict item_test_NABS with pretty_condition (formula: item_test_NABS ~ pretty_condition). The model explains a statistically significant and weak proportion of variance (R2 = 0.05, F(1, 328) = 18.52, p &lt; .001, adj. R2 = 0.05). The model's intercept, corresponding to pretty_condition = control, is at 1.52 (95% CI [1.02, 2.01], t(328) = 6.04, p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 1.50, 95% CI [0.81, 2.18], t(328) = 4.30, p &lt; .001; Std. beta = 0.46, 95% CI [0.25, 0.67])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span>

<span class="co"># #setup references </span>
<span class="co"># m &lt;- lm.1</span>
<span class="co"># df &lt;- df_subjects</span>
<span class="co"># call &lt;- m$call %&gt;% as.character()</span>
<span class="co"># </span>
<span class="co"># # uncertainty model visualization</span>
<span class="co"># df  %&gt;%</span>
<span class="co">#   data_grid(pretty_condition) %&gt;%</span>
<span class="co">#   augment(lm.1, newdata = ., se_fit = TRUE) %&gt;% </span>
<span class="co">#   ggplot(aes(y = pretty_condition, color = pretty_condition)) </span>
<span class="co"># </span>
<span class="co"># +</span>
<span class="co">#   stat_halfeye( scale = .5,</span>
<span class="co">#       aes(</span>
<span class="co">#         xdist = dist_student_t(df = df.residual(m), mu = .fitted, sigma = .se.fit),</span>
<span class="co">#         fill = stat(cut_cdf_qi(cdf, </span>
<span class="co">#                 .width = c(.90, .95),</span>
<span class="co">#                 labels = scales::percent_format())))) +</span>
<span class="co">#   scale_fill_brewer(direction = -1) + </span>
<span class="co">#   labs (title = "(LAB) Test Phase Accuracy ~ Condition", </span>
<span class="co">#         x = "model predicted mean (% correct)", y = "Condition", fill = "Interval",</span>
<span class="co">#         subtitle = paste("lm(",call[2],")")</span>
<span class="co">#   ) + theme(legend.position = "blank")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="poisson-regression-todo" class="level4"><h4 class="anchored" data-anchor-id="poisson-regression-todo">Poisson Regression TODO</h4>
<p>https://stats.oarc.ucla.edu/r/dae/poisson-regression/</p>
<p>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can consider it a type of <em>count</em>, (ie. count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function).</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#POISSON</span>

<span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span>
<span class="va">p.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = item_test_NABS ~ pretty_condition, family = "poisson", 
    data = df_subjects)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
 -2.46   -2.28   -1.74    1.51    3.69  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               0.4180     0.0645    6.48  9.4e-11 ***
pretty_conditionimpasse   0.6864     0.0781    8.79  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1579.3  on 329  degrees of freedom
Residual deviance: 1496.7  on 328  degrees of freedom
AIC: 1956

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Partition Variance"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Partition Variance"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: poisson, link: log

Response: item_test_NABS

Terms added sequentially (first to last)

                 Df Deviance Resid. Df Resid. Dev
NULL                               329       1579
pretty_condition  1     82.7       328       1497</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Confidence Interval on Parameter Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Confidence Interval on Parameter Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        2.5 % 97.5 %
(Intercept)             0.289  0.542
pretty_conditionimpasse 0.535  0.841</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span> <span class="co">#sanity check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a poisson model (estimated using ML) to predict item_test_NABS with pretty_condition (formula: item_test_NABS ~ pretty_condition). The model's explanatory power is moderate (Nagelkerke's R2 = 0.22). The model's intercept, corresponding to pretty_condition = control, is at 0.42 (95% CI [0.29, 0.54], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.69, 95% CI [0.53, 0.84], p &lt; .001; Std. beta = 0.69, 95% CI [0.53, 0.84])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">p.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="zero-inflated-poisson" class="level4"><h4 class="anchored" data-anchor-id="zero-inflated-poisson">Zero Inflated Poisson</h4>
<p>https://stats.oarc.ucla.edu/r/dae/zip/<br>
Poisson count process with excess zeros</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#ZERO INFLATED POISSON</span>

<span class="va">zinfp.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span>  <span class="va">item_q1_rt</span><span class="op">|</span> <span class="va">pretty_condition</span> , data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = item_test_NABS ~ item_q1_rt | pretty_condition, data = df_subjects)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.934 -0.821 -0.548  0.965  2.421 

Count model coefficients (poisson with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.654243   0.059975   27.58   &lt;2e-16 ***
item_q1_rt  0.001690   0.000849    1.99    0.047 *  

Zero-inflation model coefficients (binomial with logit link):
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                0.978      0.179    5.46  4.7e-08 ***
pretty_conditionimpasse   -1.055      0.236   -4.48  7.5e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 7 
Log-likelihood: -531 on 4 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated poisson model to predict item_test_NABS with item_q1_rt and pretty_condition (formula: item_test_NABS ~ item_q1_rt). The model's explanatory power is substantial (R2 = 0.35, adj. R2 = 0.35). The model's intercept, corresponding to item_q1_rt = 0, is at 1.65 (95% CI [1.54, 1.77], p &lt; .001). Within this model:

  - The effect of item q1 rt is statistically significant and positive (beta = 1.69e-03, 95% CI [2.52e-05, 3.35e-03], p = 0.047; Std. beta = 0.06, 95% CI [7.11e-04, 0.12])
  - The effect of pretty condition [impasse] is statistically significant and negative (beta = -1.06, 95% CI [-1.52, -0.59], p &lt; .001; Std. beta = -1.06, 95% CI [-1.52, -0.59])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinfp.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |      BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-------------------------------------------------------------------------------------
1070.173 | 1085.370 | 0.354 |     0.350 | 3.131 | 3.150 |    -1.609 |           0.044</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># check_model(zinfp.1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="negative-binomial-regression" class="level4"><h4 class="anchored" data-anchor-id="negative-binomial-regression">Negative Binomial Regression</h4>
<p>https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/ - overdispersed count data (variance much greater than mean)</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span>
<span class="co"># - https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/</span>
<span class="co"># - Overdispersed Count variables</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'MASS' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nb.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = item_test_NABS ~ pretty_condition, data = df_subjects, 
    init.theta = 0.253501538, link = log)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.139  -1.102  -0.993   0.378   1.091  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                0.418      0.171    2.45   0.0143 * 
pretty_conditionimpasse    0.686      0.232    2.95   0.0031 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(0.254) family taken to be 1)

    Null deviance: 279.52  on 329  degrees of freedom
Residual deviance: 270.97  on 328  degrees of freedom
AIC: 1194

Number of Fisher Scoring iterations: 1

              Theta:  0.2535 
          Std. Err.:  0.0315 

 2 x log-likelihood:  -1188.1290 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a negative-binomial model (estimated using ML) to predict item_test_NABS with pretty_condition (formula: item_test_NABS ~ pretty_condition). The model's explanatory power is weak (Nagelkerke's R2 = 0.04). The model's intercept, corresponding to pretty_condition = control, is at 0.42 (95% CI [0.10, 0.77], p = 0.014). Within this model:

  - The effect of pretty condition [impasse] is statistically significant and positive (beta = 0.69, 95% CI [0.23, 1.14], p = 0.003; Std. beta = 0.69, 95% CI [0.23, 1.14])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#check model assumption</span>
<span class="co">#assumes conditional means are not equal to conditional variances</span>
<span class="co">#conduct likelihood ration test to compare and test [need poisson]</span>
<span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, data <span class="op">=</span> <span class="va">df_subjects</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 4.3e-168 (df=3)</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span>


<span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span>
<span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">nb.1</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#exponentiate parameter estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Exponentiated Estimates"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Exponentiated Estimates"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        Estimate 2.5 % 97.5 %
(Intercept)                 1.52  1.10   2.15
pretty_conditionimpasse     1.99  1.26   3.13</code></pre>
</div>
</div>
<p>The variable condition has a coefficient of 0.67, (p &lt; 0.005). This means that for the impasse condition, the expected log count # of questions increases by 0.67. By exponentiating the estimate we see that # question correct rate for the impasse condition is nearly 2x that of the control condition.</p>
<p><strong>Diagnostics</strong> ??</p>
</section><section id="zero-inflated-negative-binomial-regression" class="level4"><h4 class="anchored" data-anchor-id="zero-inflated-negative-binomial-regression">Zero Inflated Negative Binomial Regression</h4>
<p>https://stats.oarc.ucla.edu/r/dae/zinb/ count data that are overdispersed and have excess zeros</p>
<p>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the <em>excess</em> zeros can be modelled independently.</p>
<p>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different ‘process’ … (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) &lt;- this could maybe be disentangled by first question latency?</p>
<p>The model includes: - A logistic model to model which of the two processes the zero outcome is associated with - A negative binomial model to model the count process</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#  for zeroinfl negbinomial</span>

<span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span>
<span class="va">zinb.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">pretty_condition</span> <span class="op">|</span> <span class="va">pretty_condition</span> , data <span class="op">=</span> <span class="va">df_subjects</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span>
<span class="co">#before the | is the count part, after the | is the logit model</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Model"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
zeroinfl(formula = item_test_NABS ~ pretty_condition | pretty_condition, 
    data = df_subjects, dist = "negbin")

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.866 -0.794 -0.538  0.856  2.294 

Count model coefficients (negbin with log link):
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               1.7126     0.0728   23.54  &lt; 2e-16 ***
pretty_conditionimpasse   0.0451     0.0880    0.51  0.60810    
Log(theta)                3.1851     0.8732    3.65  0.00026 ***

Zero-inflation model coefficients (binomial with logit link):
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                0.974      0.179    5.43  5.5e-08 ***
pretty_conditionimpasse   -1.056      0.236   -4.47  7.7e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta = 24.169 
Number of iterations in BFGS optimization: 7 
Log-likelihood: -532 on 5 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.

Warning: 'data_findcols()' is deprecated and will be removed in a future update.
  Its usage is discouraged. Please use 'data_find()' instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a zero-inflated negative-binomial model to predict item_test_NABS with pretty_condition (formula: item_test_NABS ~ pretty_condition). The model's explanatory power is substantial (R2 = 0.36, adj. R2 = 0.36). The model's intercept, corresponding to pretty_condition = control, is at 1.71 (95% CI [1.57, 1.86], p &lt; .001). Within this model:

  - The effect of pretty condition [impasse] is statistically non-significant and positive (beta = 0.05, 95% CI [-0.13, 0.22], p = 0.608; Std. beta = 0.05, 95% CI [-0.13, 0.22])
  - The effect of pretty condition [impasse] is statistically significant and negative (beta = -1.06, 95% CI [-1.52, -0.59], p &lt; .001; Std. beta = -1.06, 95% CI [-1.52, -0.59])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/model_performance.html">performance</a></span><span class="op">(</span><span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |      BIC |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
-------------------------------------------------------------------------------------
1073.880 | 1092.876 | 0.363 |     0.359 | 3.150 | 3.174 |    -1.649 |           0.043</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#   rootogram(zinb.1)</span>



<span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span>
<span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span>
<span class="co"># #exponentiate parameter estimates</span>
<span class="co"># print("Exponentiated Estimates")</span>
<span class="co"># exp(est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).</p>
<p>In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition (exponentiate it?)</p>
<p><strong>TODO come back to this and discuss further</strong><br></p>
</section><section id="model-comparison" class="level4"><h4 class="anchored" data-anchor-id="model-comparison">Model Comparison</h4>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">lm.1</span>, <span class="va">p.1</span>, <span class="va">nb.1</span>, <span class="va">zinb.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name   |    Model |      AIC | AIC weights |      BIC | BIC weights |  RMSE | Sigma | Score_log | Score_spherical |    R2 | R2 (adj.) | Nagelkerke's R2
-------------------------------------------------------------------------------------------------------------------------------------------------------
lm.1   |       lm | 1699.782 |     &lt; 0.001 | 1711.179 |     &lt; 0.001 | 3.150 | 3.160 |           |                 | 0.053 |     0.051 |                
p.1    |      glm | 1955.788 |     &lt; 0.001 | 1963.386 |     &lt; 0.001 | 3.150 | 2.136 |    -2.957 |           0.042 |       |           |           0.223
nb.1   |   negbin | 1194.129 |     &lt; 0.001 | 1205.526 |     &lt; 0.001 | 3.150 | 0.909 |    -2.137 |           0.046 |       |           |           0.045
zinb.1 | zeroinfl | 1073.880 |        1.00 | 1092.876 |        1.00 | 3.150 | 3.174 |    -1.649 |           0.043 | 0.363 |     0.359 |                </code></pre>
</div>
</div>
<p>For modelling test phase absolute score (# items correct) it seems that the zero inflated negative binomial model is the best fit according to R2 and AIC, however, I am not clear on the implications of the interpretation (non significant in count process, significant on logit process), and also not clear if # items correct is truly a count process.</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb157"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#uncertainty model visualization</span>
<span class="co"># df %&gt;%</span>
  <span class="co"># data_grid(pretty_condition) %&gt;%</span>
  <span class="co"># augment(m, newdata = ., se_fit = TRUE) %&gt;%</span>
  <span class="co"># ggplot(aes(y = pretty_condition)) +</span>
  <span class="co"># stat_halfeye(</span>
  <span class="co">#   aes(xdist = dist_student_t(df = df.residual(m), </span>
  <span class="co">#       mu = .fitted, sigma = .se.fit)), scale = .5) +</span>
  <span class="co"># # add raw data in too (scale = .5 above adjusts the halfeye height so</span>
  <span class="co"># # that the data fit in as well)</span>
  <span class="co"># geom_jitter(aes(x = x), data = df, pch = "|", size = 2, </span>
  <span class="co">#             position =   position_nudge(y = -.15), alpha = 0.5) +  </span>
  <span class="co"># labs (title = "Model Estimates with Uncertainty", x = "model coefficient") + </span>
  <span class="co"># theme_minimal()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="hurdle-beta-regression" class="level4"><h4 class="anchored" data-anchor-id="hurdle-beta-regression">Hurdle Beta Regression</h4>
<p>https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.gamlss.com/">gamlss</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gamlss' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: splines</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    sleep</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gamlss.dist</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gamlss.dist' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'nlme' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmList</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: parallel</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> **********   GAMLSS Version 5.4-3  ********** </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>For more on GAMLSS look at https://www.gamlss.com/</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type gamlssNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gamlss'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    refit</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE SAMPLE DATA </span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span> 
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.40</span> 
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.60</span> 
<span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">0.13</span> 
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fl">0.17</span> 
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span> <span class="va">p0</span><span class="op">-</span> <span class="va">p1</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">sigma</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> 
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">/</span> <span class="va">mu</span>

<span class="co">#CREATE DIST</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1839</span><span class="op">)</span> 
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> 
<span class="va">cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">p0</span>, <span class="va">p2</span>, <span class="va">p1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="va">y</span><span class="op">[</span><span class="va">cat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> 
<span class="va">y</span><span class="op">[</span><span class="va">cat</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">x</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb178"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#this looks not unlike my distribution! </span>

<span class="co">#CREATE AN EMPTY MODEL</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for mu </span>
               formula.sigma <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for sigma </span>
               formula.nu <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for nu </span>
               formula.tau <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for tau </span>
               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 7799 
GAMLSS-RS iteration 2: Global Deviance = 7778 
GAMLSS-RS iteration 3: Global Deviance = 7778 
GAMLSS-RS iteration 4: Global Deviance = 7778 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = y ~ 1, family = BEINF(), formula.sigma = ~1,  
    formula.nu = ~1, formula.tau = ~1) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.3796     0.0196   -19.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.3951     0.0162    24.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.632      0.042   -38.9   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -1.4014     0.0382   -36.7   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  5000 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  4996 
                      at cycle:  4 
 
Global Deviance:     7778 
            AIC:     7786 
            SBC:     7812 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.000571 
                       variance   =  1 
               coef. of skewness  =  0.0294 
               coef. of kurtosis  =  2.95 
Filliben correlation coefficient  =  1 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">fit_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">fit_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.406229902102452"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">fit_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.597499259410111"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="va">fit_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="va">fit_p0</span> <span class="op">&lt;-</span> <span class="va">fit_nu</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P0: "</span>,<span class="va">fit_p0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit_p1</span> <span class="op">&lt;-</span> <span class="va">fit_tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P1: "</span>,<span class="va">fit_p1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
</div>
<p><strong>BETA HURDLE INTERPRETATION</strong> - beta component<br>
- MU “location” (mean)<br>
- SIGMA “scale” (positively related to variance; variance = sigma.squared <em>mean</em> (1-mean)<br>
- Rigby, Stasinopoulos, Heller, and De Bastiani (2017) “reparameterized” the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</p>
<p><strong>ZERO-ONE HURDLE COMPONENT</strong><br>
- The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.<br>
- p0 is the probability that a case equals 0,<br>
- p1 is the probability that a case equals 1,<br>
- p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SETUP DATA </span>

<span class="va">min</span> <span class="op">=</span> <span class="fl">0</span> <span class="co">#min possible value of scale</span>
<span class="va">max</span> <span class="op">=</span> <span class="fl">8</span> <span class="co">#max possible value of scale</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span> <span class="co">#for shuffling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'mosaic':
  method                           from   
  fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    cross</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    factorize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modelr':

    resample</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    mplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    rescale</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:cowplot':

    theme_map</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb207"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#1. Rescale accuracy using </span>
<span class="co"># recommended adjustment </span>
<span class="co">#rescaled = value-min/(max-min)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="va">item_test_NABS</span>,
  R_acc <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span><span class="op">-</span><span class="va">min</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">max</span><span class="op">-</span><span class="va">min</span><span class="op">)</span>, <span class="co">#as %</span>
  T_acc <span class="op">=</span> <span class="op">(</span><span class="va">accuracy</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">8</span>, <span class="co">#transform for no 0 and 1</span>
  perm <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/resample.html">shuffle</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>,
  scaffold_rt <span class="op">=</span> <span class="va">item_scaffold_rt</span>
<span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accuracy</span>,<span class="va">R_acc</span>, <span class="va">T_acc</span>, <span class="va">condition</span>, <span class="va">perm</span>,<span class="va">scaffold_rt</span><span class="op">)</span>

<span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">R_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#VISUALIZE DISTRIBUTION</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">T_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of [rescaled] accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb209"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">R_acc</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">perm</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">perm</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of shuffled accuracy"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#SUMMARIZE SAMPLE</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Grand mean"</span>, <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand mean 0.2875"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span>
<span class="va">stats</span> <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">var</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Grand stats"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Grand stats"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">stats</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  df$condition min Q1 median    Q3 max  mean    sd   n missing   var
1          111   0  0  0.000 0.125   1 0.190 0.358 158       0 0.128
2          121   0  0  0.125 0.875   1 0.377 0.426 172       0 0.182</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"P0"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb218"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb220"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"P1"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb222"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.136</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb224"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE MODEL</span>

<span class="co">#CREATE AN EMPTY MODEL</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span> formula <span class="op">=</span> <span class="va">R_acc</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for mu </span>
              formula.sigma <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for sigma </span>
              formula.nu <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for nu </span>
              formula.tau <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span>, <span class="co"># formula for tau </span>
              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 610 
GAMLSS-RS iteration 2: Global Deviance = 609 
GAMLSS-RS iteration 3: Global Deviance = 609 
GAMLSS-RS iteration 4: Global Deviance = 609 
GAMLSS-RS iteration 5: Global Deviance = 609 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb226"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 610 
GAMLSS-RS iteration 2: Global Deviance = 609 
GAMLSS-RS iteration 3: Global Deviance = 609 
GAMLSS-RS iteration 4: Global Deviance = 609 
GAMLSS-RS iteration 5: Global Deviance = 609 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb228"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ 1, sigma.formula = ~1, nu.formula = ~1,  
    tau.formula = ~1, family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    0.225      0.113    1.98    0.048 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    0.177      0.100    1.76    0.079 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    0.822      0.129    6.39  5.7e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.660      0.184   -3.59  0.00038 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  326 
                      at cycle:  5 
 
Global Deviance:     609 
            AIC:     617 
            SBC:     632 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb230"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  0.0109 
                       variance   =  0.996 
               coef. of skewness  =  -0.0563 
               coef. of kurtosis  =  2.79 
Filliben correlation coefficient  =  0.998 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb232"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">m0_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">m0_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.555931874775555"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb234"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">m0_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.544134514840075"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb236"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"NU: "</span>,<span class="va">m0_nu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  2.27484150905293"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb238"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU: "</span>,<span class="va">m0_tau</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.517080427912532"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb240"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_p0</span> <span class="op">&lt;-</span> <span class="va">fit_nu</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P0: "</span>,<span class="va">m0_p0</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P0:  0.135600165493784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb242"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m0_p1</span> <span class="op">&lt;-</span> <span class="va">fit_tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fit_nu</span> <span class="op">+</span> <span class="va">fit_tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"P1: "</span>,<span class="va">m0_p1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "P1:  0.170800000002391"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb244"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE PREDICTOR MODEL</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 588 
GAMLSS-RS iteration 2: Global Deviance = 587 
GAMLSS-RS iteration 3: Global Deviance = 587 
GAMLSS-RS iteration 4: Global Deviance = 587 
GAMLSS-RS iteration 5: Global Deviance = 587 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb246"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.144      0.203    0.71     0.48
condition121    0.124      0.244    0.51     0.61

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.280      0.174    1.61     0.11
condition121   -0.164      0.213   -0.77     0.44

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.377      0.208    6.63  1.4e-10 ***
condition121   -1.019      0.269   -3.79  0.00018 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    -0.729      0.325   -2.24    0.026 *
condition121    0.102      0.394    0.26    0.796  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  5 
 
Global Deviance:     587 
            AIC:     603 
            SBC:     633 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb248"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#LOOKING PREDICTOR MODEL</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            <span class="op">~</span> <span class="va">condition</span> , 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 588 
GAMLSS-RS iteration 2: Global Deviance = 587 
GAMLSS-RS iteration 3: Global Deviance = 587 
GAMLSS-RS iteration 4: Global Deviance = 587 
GAMLSS-RS iteration 5: Global Deviance = 587 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb250"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.144      0.203    0.71     0.48
condition121    0.124      0.244    0.51     0.61

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.280      0.174    1.61     0.11
condition121   -0.164      0.213   -0.77     0.44

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.377      0.208    6.63  1.4e-10 ***
condition121   -1.019      0.269   -3.79  0.00018 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    -0.729      0.325   -2.24    0.026 *
condition121    0.102      0.394    0.26    0.796  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  5 
 
Global Deviance:     587 
            AIC:     603 
            SBC:     633 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb252"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION TEST]</span>
<span class="va">mperm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">R_acc</span> <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, <span class="op">~</span> <span class="va">perm</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 609 
GAMLSS-RS iteration 2: Global Deviance = 608 
GAMLSS-RS iteration 3: Global Deviance = 608 
GAMLSS-RS iteration 4: Global Deviance = 608 
GAMLSS-RS iteration 5: Global Deviance = 608 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb254"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mperm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ perm, sigma.formula = ~perm,  
    nu.formula = ~perm, tau.formula = ~perm, family = BEINF(),      data = df) 


Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.1914     0.1706    1.12     0.26
perm121       0.0635     0.2278    0.28     0.78

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    0.237      0.148    1.60     0.11
perm121       -0.117      0.202   -0.58     0.56

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.8535     0.1887    4.52  8.6e-06 ***
perm121      -0.0595     0.2579   -0.23     0.82    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   -0.511      0.258   -1.98    0.048 *
perm121       -0.294      0.368   -0.80    0.425  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  5 
 
Global Deviance:     608 
            AIC:     624 
            SBC:     654 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb256"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#sanity check with scaled outcome, no zeros ones</span>
<span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span><span class="op">(</span><span class="va">T_acc</span> <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, <span class="op">~</span> <span class="va">condition</span>, 
            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/BEINF.html">BEINF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = -2573 
GAMLSS-RS iteration 2: Global Deviance = -2875 
GAMLSS-RS iteration 3: Global Deviance = -2894 
GAMLSS-RS iteration 4: Global Deviance = -2896 
GAMLSS-RS iteration 5: Global Deviance = -2897 
GAMLSS-RS iteration 6: Global Deviance = -2897 
GAMLSS-RS iteration 7: Global Deviance = -2897 
GAMLSS-RS iteration 8: Global Deviance = -2897 
GAMLSS-RS iteration 9: Global Deviance = -2897 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb258"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.gamlss(m3): summary: vcov has failed, option qr is used instead</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = T_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition, family = BEINF(),  
    data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.1227     0.0991  -11.33  &lt; 2e-16 ***
condition121   0.5628     0.1426    3.95 0.000097 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    1.6806     0.0751   22.36   &lt;2e-16 ***
condition121   0.1626     0.1046    1.55     0.12    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -2.25e+01   3.78e+03   -0.01        1
condition121 -6.72e-15   5.24e+03    0.00        1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -2.26e+01   3.96e+03   -0.01        1
condition121  9.20e-15   5.48e+03    0.00        1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  9 
 
Global Deviance:     -2897 
            AIC:     -2881 
            SBC:     -2850 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb261"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span>

<span class="co">#investigate beta negative binomial distribution</span>
<span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span>

<span class="co">#TRANSFORM PARAMETRS BACK </span>
<span class="va">inv_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># inverse of link function</span>
<span class="va">m1_mu</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">mu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MU: "</span>,<span class="va">m1_mu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "MU:  0.536038311159578" "MU:  0.531024352873784"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb263"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_sigma</span> <span class="op">&lt;-</span> <span class="fu">inv_logit</span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">sigma.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SIGMA: "</span>,<span class="va">m1_sigma</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGMA:  0.544134514840075"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb265"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">nu.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"NU: "</span>,<span class="va">m1_nu</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "NU:  3.96329406964311"  "NU:  0.360974858677686"</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb267"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m1_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">tau.coefficients</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU: "</span>,<span class="va">m1_tau</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "TAU:  0.482542801248665" "TAU:  1.10746276561553" </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb269"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BEINF", "Beta Inflated") 

Call:  gamlss(formula = R_acc ~ condition, sigma.formula = ~condition,  
    nu.formula = ~condition, tau.formula = ~condition,  
    family = BEINF(), data = df) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  logit
Mu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.144      0.203    0.71     0.48
condition121    0.124      0.244    0.51     0.61

------------------------------------------------------------------
Sigma link function:  logit
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     0.280      0.174    1.61     0.11
condition121   -0.164      0.213   -0.77     0.44

------------------------------------------------------------------
Nu link function:  log 
Nu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.377      0.208    6.63  1.4e-10 ***
condition121   -1.019      0.269   -3.79  0.00018 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    -0.729      0.325   -2.24    0.026 *
condition121    0.102      0.394    0.26    0.796  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  330 
Degrees of Freedom for the fit:  8
      Residual Deg. of Freedom:  322 
                      at cycle:  5 
 
Global Deviance:     587 
            AIC:     603 
            SBC:     633 
******************************************************************</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb271"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-21-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
     Summary of the Randomised Quantile Residuals
                           mean   =  -0.00363 
                       variance   =  1.04 
               coef. of skewness  =  -0.0633 
               coef. of kurtosis  =  3.03 
Filliben correlation coefficient  =  0.999 
******************************************************************</code></pre>
</div>
</div>
<ul>
<li>MU tells if mean is different by condition<br>
</li>
<li>SIGMA tells if variance is different by condition<br>
</li>
<li>NU coefficient tells if condition yields different probability at floor</li>
<li>TAU coefficient tells if condition yields different probability at ceiling</li>
</ul></section><section id="beta-regression-correct" class="level4"><h4 class="anchored" data-anchor-id="beta-regression-correct">Beta Regression (% Correct)</h4>
<p>Beta regression on % correct (with standard transformation for including [0,1]) https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb273"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betareg</span><span class="op">)</span>

<span class="co">#RESCLAE VARIABLE</span>
<span class="co">#beta reg can't handle 0s and 1s </span>
<span class="va">sub</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">DV_percent_NABS</span><span class="op">)</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">sub</span><span class="op">$</span><span class="va">dv_transformed</span> <span class="op">=</span> <span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">DV_percent_NABS</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>
 
<span class="co">#VISUALIZE VARIABLES</span>
<span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/xhistogram.html">histogram</a></span><span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">dv_transformed</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb274"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_histogram.html">gf_histogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">dv_transformed</span>, fill <span class="op">=</span> <span class="op">~</span><span class="va">condition</span>, data <span class="op">=</span> <span class="va">sub</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggformula/man/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb275"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#FIT MODEL</span>
<span class="va">mb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">dv_transformed</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = dv_transformed ~ condition, data = sub)

Standardized weighted residuals 2:
   Min     1Q Median     3Q    Max 
-1.057 -0.453 -0.216  0.541  1.690 

Coefficients (mean model with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -0.969      0.108   -8.97   &lt;2e-16 ***
condition121    0.556      0.143    3.89   0.0001 ***

Phi coefficients (precision model with identity link):
      Estimate Std. Error z value Pr(&gt;|z|)    
(phi)   0.6604     0.0425    15.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood:  506 on 3 Df
Pseudo R-squared: 0.0725
Number of iterations: 12 (BFGS) + 1 (Fisher scoring) </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb277"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-22-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-22-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-22-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="tobit-regression" class="level4"><h4 class="anchored" data-anchor-id="tobit-regression">TOBIT Regression</h4>
<p>https://stats.oarc.ucla.edu/r/dae/tobit-models/</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb278"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#set up data </span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_subjects</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  accuracy <span class="op">=</span> <span class="va">s_NABS</span>
<span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/">VGAM</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'VGAM' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'VGAM'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:mosaic':

    chisq, logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:distributional':

    cdf</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb284"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html">vglm</a></span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">condition</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html">tobit</a></span><span class="op">(</span>Upper <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
vglm(formula = accuracy ~ condition, family = tobit(Upper = 13), 
    data = df)

Coefficients: 
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1  -2.3913     0.8854   -2.70   0.0069 ** 
(Intercept):2   2.2155     0.0653   33.93   &lt;2e-16 ***
condition121    5.9518     1.1742    5.07    4e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Names of linear predictors: mu, loglink(sd)

Log-likelihood: -677 on 657 degrees of freedom

Number of Fisher scoring iterations: 7 

No Hauck-Donner effect found in any of the estimates</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb286"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-23-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-23-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="wip-hurdle-model" class="level4"><h4 class="anchored" data-anchor-id="wip-hurdle-model">WIP | HURDLE MODEL</h4>
<ul>
<li>https://data.library.virginia.edu/getting-started-with-hurdle-models/<br>
</li>
<li>https://en.wikipedia.org/wiki/Hurdle_model#:~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.</li>
</ul>
<p>class of models for count data with both overdispersion and excess zeros;<br>
different from zero-inflated models where the excess zeros are theorized to arise from two different processes; in the hurdle model, there is a model for P(x=0) and a separate model for P(x!=0)</p>
<p>The model includes: - A binary logit model to model whether the observation takes a positive count or not. - a truncated Poisson or Negative binomial model that only fits positive counts</p>
<p>This allows us to model: (1) Does the student get <em>any</em> questions right? (2) How many questions does the student get right?</p>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb287"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl">pscl</a></span><span class="op">)</span> <span class="co">#zero-inf and hurdle models </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">countreg</span><span class="op">)</span> <span class="co">#rootogram</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'countreg':
  method                 from
  print.zeroinfl         pscl
  print.summary.zeroinfl pscl
  summary.zeroinfl       pscl
  coef.zeroinfl          pscl
  vcov.zeroinfl          pscl
  logLik.zeroinfl        pscl
  predict.zeroinfl       pscl
  residuals.zeroinfl     pscl
  fitted.zeroinfl        pscl
  terms.zeroinfl         pscl
  model.matrix.zeroinfl  pscl
  extractAIC.zeroinfl    pscl
  print.hurdle           pscl
  print.summary.hurdle   pscl
  summary.hurdle         pscl
  coef.hurdle            pscl
  vcov.hurdle            pscl
  logLik.hurdle          pscl
  predict.hurdle         pscl
  residuals.hurdle       pscl
  fitted.hurdle          pscl
  terms.hurdle           pscl
  model.matrix.hurdle    pscl
  extractAIC.hurdle      pscl</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'countreg'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:VGAM':

    dzipois, pzipois, qzipois, rzipois</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:pscl':

    hurdle, hurdle.control, hurdletest, zeroinfl, zeroinfl.control</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vcd':

    rootogram</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb293"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span>

<span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span>

<span class="va">h.1</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df_subjects</span>,
              zero.dist <span class="op">=</span> <span class="st">"binomial"</span>, dist <span class="op">=</span> <span class="st">"poisson"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = zeroDist, gr = zeroGrad, par = c(start$zero, if (zero.dist
== : unknown names in control: size</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb296"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">h.2</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span><span class="op">(</span><span class="va">item_test_NABS</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">condition</span> , data <span class="op">=</span> <span class="va">df_subjects</span>,
              zero.dist <span class="op">=</span> <span class="st">"binomial"</span>, dist <span class="op">=</span> <span class="st">"negbin"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size

Warning in optim(fn = countDist, gr = countGrad, par = c(start$count, if (dist
== : unknown names in control: size</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb298"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">h.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = item_test_NABS ~ condition | condition, data = df_subjects, 
    dist = "poisson", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.892 -0.818 -0.549  0.881  2.342 

Count model coefficients (truncated poisson with log link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    1.7156     0.0653   26.29   &lt;2e-16 ***
condition121   0.0447     0.0789    0.57     0.57    
Zero hurdle model coefficients (binomial with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -0.984      0.179   -5.50  3.7e-08 ***
condition121    1.054      0.235    4.48  7.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Number of iterations in BFGS optimization: 10 
Log-likelihood: -533 on 4 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb300"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
pscl::hurdle(formula = item_test_NABS ~ condition | condition, data = df_subjects, 
    dist = "negbin", zero.dist = "binomial", size = 8)

Pearson residuals:
   Min     1Q Median     3Q    Max 
-0.866 -0.794 -0.538  0.856  2.294 

Count model coefficients (truncated negbin with log link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    1.7126     0.0728   23.54  &lt; 2e-16 ***
condition121   0.0451     0.0880    0.51  0.60810    
Log(theta)     3.1851     0.8732    3.65  0.00026 ***
Zero hurdle model coefficients (binomial with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -0.984      0.179   -5.50  3.7e-08 ***
condition121    1.054      0.235    4.48  7.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta: count = 24.169
Number of iterations in BFGS optimization: 20 
Log-likelihood: -532 on 5 Df</code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb302"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/countreg/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">h.1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb303"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/countreg/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb304"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://easystats.github.io/performance/reference/compare_performance.html">compare_performance</a></span><span class="op">(</span><span class="va">h.1</span>,<span class="va">h.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name |  Model |      AIC | AIC weights |      BIC | BIC weights |    R2 | R2 (adj.) |  RMSE | Sigma | Score_log | Score_spherical
---------------------------------------------------------------------------------------------------------------------------------
h.1  | hurdle | 1073.583 |       0.537 | 1088.780 |       0.886 | 0.351 |     0.347 | 3.150 | 3.169 |    -2.479 |           0.043
h.2  | hurdle | 1073.880 |       0.463 | 1092.876 |       0.114 | 0.363 |     0.359 | 3.150 | 3.174 |    -2.132 |           0.043</code></pre>
</div>
</div>
</section></section><section id="q1-accuracy" class="level3"><h3 class="anchored" data-anchor-id="q1-accuracy">Q1 Accuracy</h3>
<section id="chi-square" class="level4"><h4 class="anchored" data-anchor-id="chi-square">CHI SQUARE</h4>
<section id="combined-1" class="level5"><h5 class="anchored" data-anchor-id="combined-1">(Combined)</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb306"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#lab only</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_q1</span> 

<span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Accuracy on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">accuracy</span>, shade <span class="op">=</span> <span class="cn">T</span>, color <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/label%20-%20CHISQR-Q1TRI.by.COND-BOTH-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb307"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">score_niceABS</span>, fisher <span class="op">=</span> <span class="cn">TRUE</span>, chisq<span class="op">=</span><span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span>, sresid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  330 

 
             | df$score_niceABS 
df$condition |         0 |         1 | Row Total | 
-------------|-----------|-----------|-----------|
         111 |       136 |        22 |       158 | 
             |   124.006 |    33.994 |           | 
             |     1.160 |     4.232 |           | 
             |     0.861 |     0.139 |     0.479 | 
             |     0.525 |     0.310 |           | 
             |     0.412 |     0.067 |           | 
-------------|-----------|-----------|-----------|
         121 |       123 |        49 |       172 | 
             |   134.994 |    37.006 |           | 
             |     1.066 |     3.887 |           | 
             |     0.715 |     0.285 |     0.521 | 
             |     0.475 |     0.690 |           | 
             |     0.373 |     0.148 |           | 
-------------|-----------|-----------|-----------|
Column Total |       259 |        71 |       330 | 
             |     0.785 |     0.215 |           | 
-------------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  10.3     d.f. =  1     p =  0.0013 

Pearson's Chi-squared test with Yates' continuity correction 
------------------------------------------------------------
Chi^2 =  9.5     d.f. =  1     p =  0.00205 

 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Sample estimate odds ratio:  2.46 

Alternative hypothesis: true odds ratio is not equal to 1
p =  0.00131 
95% confidence interval:  1.37 4.53 

Alternative hypothesis: true odds ratio is less than 1
p =  1 
95% confidence interval:  0 4.12 

Alternative hypothesis: true odds ratio is greater than 1
p =  0.000928 
95% confidence interval:  1.49 Inf 


 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb309"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">incorrect</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">136</span><br><span style="color:#339999;">124</span><br><span style="color:#333399;">52.5&nbsp;%</span><br><span style="color:#339933;">86.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">123</span><br><span style="color:#339999;">135</span><br><span style="color:#333399;">47.5&nbsp;%</span><br><span style="color:#339933;">71.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">259</span><br><span style="color:#339999;">259</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">78.5&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">correct</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">22</span><br><span style="color:#339999;">34</span><br><span style="color:#333399;">31&nbsp;%</span><br><span style="color:#339933;">13.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">49</span><br><span style="color:#339999;">37</span><br><span style="color:#333399;">69&nbsp;%</span><br><span style="color:#339933;">28.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">71</span><br><span style="color:#339999;">71</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">21.5&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">158</span><br><span style="color:#339999;">158</span><br><span style="color:#333399;">47.9&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">172</span><br><span style="color:#339999;">172</span><br><span style="color:#333399;">52.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">330</span><br><span style="color:#339999;">330</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=9.500 · df=1 · Cramer's V=0.177 · Fisher's p=0.001</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within accuracy</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
</div>
<p><strong>Combining data across both sessions</strong> (n=330), a Pearson’s Chi-squared test suggests a statistically significant relationship between response accuracy on the first question and experimental condition, <span class="math inline">\(\chi_2\)</span> (1) = 10.3, p = 0.001. The sample odds ratio (2.46, p = 0.001, 95% CI [1.37, 4.53]) indicates that the odds of providing a correct response to the first question are 2.46 higher for subjects in the impasse condition than those in the control condition.</p>
</section><section id="in-person" class="level5"><h5 class="anchored" data-anchor-id="in-person">(In Person)</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb310"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#lab only</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_q1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"lab-synch"</span><span class="op">)</span>

<span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Accuracy on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">accuracy</span>, 
            shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/label%20-%20CHISQR-Q1TRI.by.COND-LAB-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb311"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">score_niceABS</span>, 
            fisher <span class="op">=</span> <span class="cn">TRUE</span>, chisq<span class="op">=</span><span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span>, sresid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  126 

 
             | df$score_niceABS 
df$condition |         0 |         1 | Row Total | 
-------------|-----------|-----------|-----------|
         111 |        52 |        10 |        62 | 
             |    47.730 |    14.270 |           | 
             |     0.382 |     1.278 |           | 
             |     0.839 |     0.161 |     0.492 | 
             |     0.536 |     0.345 |           | 
             |     0.413 |     0.079 |           | 
-------------|-----------|-----------|-----------|
         121 |        45 |        19 |        64 | 
             |    49.270 |    14.730 |           | 
             |     0.370 |     1.238 |           | 
             |     0.703 |     0.297 |     0.508 | 
             |     0.464 |     0.655 |           | 
             |     0.357 |     0.151 |           | 
-------------|-----------|-----------|-----------|
Column Total |        97 |        29 |       126 | 
             |     0.770 |     0.230 |           | 
-------------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  3.27     d.f. =  1     p =  0.0707 

Pearson's Chi-squared test with Yates' continuity correction 
------------------------------------------------------------
Chi^2 =  2.55     d.f. =  1     p =  0.111 

 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Sample estimate odds ratio:  2.18 

Alternative hypothesis: true odds ratio is not equal to 1
p =  0.0909 
95% confidence interval:  0.86 5.84 

Alternative hypothesis: true odds ratio is less than 1
p =  0.979 
95% confidence interval:  0 5.03 

Alternative hypothesis: true odds ratio is greater than 1
p =  0.0547 
95% confidence interval:  0.982 Inf 


 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb313"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">incorrect</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">52</span><br><span style="color:#339999;">48</span><br><span style="color:#333399;">53.6&nbsp;%</span><br><span style="color:#339933;">83.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">45</span><br><span style="color:#339999;">49</span><br><span style="color:#333399;">46.4&nbsp;%</span><br><span style="color:#339933;">70.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">97</span><br><span style="color:#339999;">97</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">77&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">correct</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">10</span><br><span style="color:#339999;">14</span><br><span style="color:#333399;">34.5&nbsp;%</span><br><span style="color:#339933;">16.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">19</span><br><span style="color:#339999;">15</span><br><span style="color:#333399;">65.5&nbsp;%</span><br><span style="color:#339933;">29.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">29</span><br><span style="color:#339999;">29</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">23&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">62</span><br><span style="color:#339999;">62</span><br><span style="color:#333399;">49.2&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">64</span><br><span style="color:#339999;">64</span><br><span style="color:#333399;">50.8&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">126</span><br><span style="color:#339999;">126</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=2.547 · df=1 · Cramer's V=0.161 · Fisher's p=0.091</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within accuracy</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
</div>
<p><strong>For (In Person) data collection</strong> (n=126) the Pearson’s Chi-squared test (of independence) indicates a relationship between response accuracy on the first question and experimental condition that is not significant at the alpha level 0.05, <span class="math inline">\(\chi^2\)</span> (1) = 10.3, p = 0.07. Thus we have insufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. In this particular data sample, the odds ratio (Odds Ratio = 2.18, p = 0.055, 95% CI [0.982, +Inf]) indicates that the odds of producing a correct response on the first question were 2.18 times greater if a subject was in the impasse condition, than in the control condition .</p>
</section><section id="online-replication" class="level5"><h5 class="anchored" data-anchor-id="online-replication">(Online Replication)</h5>
<div class="cell">
<details><summary>CODE</summary><div class="sourceCode" id="cb314"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#online only</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_q1</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"asynch"</span><span class="op">)</span>

<span class="co">#MOSAIC PLOT</span>
<span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Accuracy on First Question by Condition"</span>,
            data <span class="op">=</span> <span class="va">df</span>, <span class="va">pretty_condition</span> <span class="op">~</span> <span class="va">accuracy</span>, shade <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="4_sgc3A_hypotesting_files/figure-html/label%20-%20CHISQR-Q1TRI.by.COND-ONLINE-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb315"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">score_niceABS</span>, fisher <span class="op">=</span> <span class="cn">TRUE</span>, 
            chisq<span class="op">=</span><span class="cn">TRUE</span>, expected <span class="op">=</span> <span class="cn">TRUE</span>, sresid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|              Expected N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  204 

 
             | df$score_niceABS 
df$condition |         0 |         1 | Row Total | 
-------------|-----------|-----------|-----------|
         111 |        84 |        12 |        96 | 
             |    76.235 |    19.765 |           | 
             |     0.791 |     3.050 |           | 
             |     0.875 |     0.125 |     0.471 | 
             |     0.519 |     0.286 |           | 
             |     0.412 |     0.059 |           | 
-------------|-----------|-----------|-----------|
         121 |        78 |        30 |       108 | 
             |    85.765 |    22.235 |           | 
             |     0.703 |     2.711 |           | 
             |     0.722 |     0.278 |     0.529 | 
             |     0.481 |     0.714 |           | 
             |     0.382 |     0.147 |           | 
-------------|-----------|-----------|-----------|
Column Total |       162 |        42 |       204 | 
             |     0.794 |     0.206 |           | 
-------------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  7.26     d.f. =  1     p =  0.00707 

Pearson's Chi-squared test with Yates' continuity correction 
------------------------------------------------------------
Chi^2 =  6.35     d.f. =  1     p =  0.0117 

 
Fisher's Exact Test for Count Data
------------------------------------------------------------
Sample estimate odds ratio:  2.68 

Alternative hypothesis: true odds ratio is not equal to 1
p =  0.00894 
95% confidence interval:  1.23 6.17 

Alternative hypothesis: true odds ratio is less than 1
p =  0.998 
95% confidence interval:  0 5.42 

Alternative hypothesis: true odds ratio is greater than 1
p =  0.00539 
95% confidence interval:  1.37 Inf 


 </code></pre>
</div>
<details><summary>CODE</summary><div class="sourceCode" id="cb317"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjplot.html">sjtab</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"xtab"</span>, var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span><span class="op">)</span>,
        show.row.prc<span class="op">=</span><span class="cn">T</span>, show.col.prc<span class="op">=</span><span class="cn">T</span>, show.summary<span class="op">=</span><span class="cn">T</span>, show.exp<span class="op">=</span><span class="cn">T</span>, show.legend<span class="op">=</span><span class="cn">T</span>,
        statistics <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">accuracy</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2">pretty_condition</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">control</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">impasse</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">incorrect</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">84</span><br><span style="color:#339999;">76</span><br><span style="color:#333399;">51.9&nbsp;%</span><br><span style="color:#339933;">87.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">78</span><br><span style="color:#339999;">86</span><br><span style="color:#333399;">48.1&nbsp;%</span><br><span style="color:#339933;">72.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">162</span><br><span style="color:#339999;">162</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">79.4&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">correct</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">12</span><br><span style="color:#339999;">20</span><br><span style="color:#333399;">28.6&nbsp;%</span><br><span style="color:#339933;">12.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">30</span><br><span style="color:#339999;">22</span><br><span style="color:#333399;">71.4&nbsp;%</span><br><span style="color:#339933;">27.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">42</span><br><span style="color:#339999;">42</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">20.6&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">96</span><br><span style="color:#339999;">96</span><br><span style="color:#333399;">47.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">108</span><br><span style="color:#339999;">108</span><br><span style="color:#333399;">52.9&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">204</span><br><span style="color:#339999;">204</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="4">χ<sup>2</sup>=6.351 · df=1 · Cramer's V=0.189 · Fisher's p=0.009</td> 

 
</tr></tbody></table>
<p>
 <span style="color:black;">observed values</span><br><span style="color:#339999;">expected values</span><br><span style="color:#333399;">% within accuracy</span><br><span style="color:#339933;">% within pretty_condition</span><br></p>

</div>
</div>
<p><strong>For online data collection</strong> (n=204), a Pearson’s Chi-squared test (of independence) indicates a statistically significant relationship between response accuracy on the first question and experimental condition, <span class="math inline">\(\chi^2\)</span> (1) = 7.26, p = 0.009. Thus we have sufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. The odds ratio (Odds Ratio = 2.68, p = 0.005, 95% CI [1.37, +Inf]) indicates that the odds of producing a correct response on the first question were 2.68 times greater if a subject was in the impasse condition, than in the control condition .</p>


<!-- -->

</section></section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Description</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC3A/5_sgc3A_exploration.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploratory Analyses</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb318" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'Study SGC3A | 4 Hypothesis Testing'</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis Testing {#sec-SGC3A-hypotesting}</span></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a>**TODO**</span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>HURDLE MODEL? (mixture model w/ 0 + count)</span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>review models already created in ARCHIVE?</span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>separate combined (vs) lab (vs) online replication <span class="sc">\[</span>once analysis strategy locked down<span class="sc">\]</span></span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a>*The purpose of this notebook is test the hypotheses that determined the design of the SGC3A study.*</span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a>+---------------------+</span>
<span id="cb318-18"><a href="#cb318-18" aria-hidden="true" tabindex="-1"></a>| Pre-Requisite       |</span>
<span id="cb318-19"><a href="#cb318-19" aria-hidden="true" tabindex="-1"></a>+=====================+</span>
<span id="cb318-20"><a href="#cb318-20" aria-hidden="true" tabindex="-1"></a>| 2_sgc3A_scoring.qmd |</span>
<span id="cb318-21"><a href="#cb318-21" aria-hidden="true" tabindex="-1"></a>+---------------------+</span>
<span id="cb318-22"><a href="#cb318-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-25"><a href="#cb318-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-26"><a href="#cb318-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb318-27"><a href="#cb318-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb318-28"><a href="#cb318-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb318-29"><a href="#cb318-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-30"><a href="#cb318-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb318-31"><a href="#cb318-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-32"><a href="#cb318-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#arrange plots</span></span>
<span id="cb318-33"><a href="#cb318-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#arrange shift function plots</span></span>
<span id="cb318-34"><a href="#cb318-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb318-35"><a href="#cb318-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd) <span class="co">#mosaic plots</span></span>
<span id="cb318-36"><a href="#cb318-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra) <span class="co">#mosaic plots</span></span>
<span id="cb318-37"><a href="#cb318-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables </span></span>
<span id="cb318-38"><a href="#cb318-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb318-39"><a href="#cb318-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-40"><a href="#cb318-40" aria-hidden="true" tabindex="-1"></a><span class="co">#plot model estimates with uncertainty</span></span>
<span id="cb318-41"><a href="#cb318-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb318-42"><a href="#cb318-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb318-43"><a href="#cb318-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb318-44"><a href="#cb318-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb318-45"><a href="#cb318-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-46"><a href="#cb318-46" aria-hidden="true" tabindex="-1"></a><span class="co">#models and performance</span></span>
<span id="cb318-47"><a href="#cb318-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots w/ embedded stats</span></span>
<span id="cb318-48"><a href="#cb318-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb318-49"><a href="#cb318-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb318-50"><a href="#cb318-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb318-51"><a href="#cb318-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr) <span class="co">#confint on qq plot</span></span>
<span id="cb318-52"><a href="#cb318-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels) <span class="co">#contingency table and CHISQR</span></span>
<span id="cb318-53"><a href="#cb318-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic) <span class="co">#extract model equation</span></span>
<span id="cb318-54"><a href="#cb318-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zeroinfl / hurdle models </span></span>
<span id="cb318-55"><a href="#cb318-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models </span></span>
<span id="cb318-56"><a href="#cb318-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-57"><a href="#cb318-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb318-58"><a href="#cb318-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-59"><a href="#cb318-59" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb318-60"><a href="#cb318-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb318-61"><a href="#cb318-61" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb318-62"><a href="#cb318-62" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb318-63"><a href="#cb318-63" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb318-64"><a href="#cb318-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-65"><a href="#cb318-65" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb318-66"><a href="#cb318-66" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>()) </span>
<span id="cb318-67"><a href="#cb318-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-68"><a href="#cb318-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-69"><a href="#cb318-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-70"><a href="#cb318-70" aria-hidden="true" tabindex="-1"></a>**Research Questions**</span>
<span id="cb318-71"><a href="#cb318-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-72"><a href="#cb318-72" aria-hidden="true" tabindex="-1"></a>In SGC3A we set out to answer the following question: Does posing a mental impasse improve performance on the graph comprehension task?</span>
<span id="cb318-73"><a href="#cb318-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-74"><a href="#cb318-74" aria-hidden="true" tabindex="-1"></a>**Experimental Hypothesis**\</span>
<span id="cb318-75"><a href="#cb318-75" aria-hidden="true" tabindex="-1"></a>*Learners posed with scenario designed to evoke a mental impasse will be more likely to correct interpret the graph.*</span>
<span id="cb318-76"><a href="#cb318-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-77"><a href="#cb318-77" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1A \| Learners in the IMPASSE condition will be more likely to correctly answer the first question than learners in CONTROL.</span>
<span id="cb318-78"><a href="#cb318-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1B \| Learners in the IMPASSE condition will score higher on the TEST Phase than learners in CONTROL.</span>
<span id="cb318-79"><a href="#cb318-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-80"><a href="#cb318-80" aria-hidden="true" tabindex="-1"></a>**Null Hypothesis**\</span>
<span id="cb318-81"><a href="#cb318-81" aria-hidden="true" tabindex="-1"></a>*No significant differences in performance will exist between learners in the IMPASSE and CONTROL conditions.*</span>
<span id="cb318-82"><a href="#cb318-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-85"><a href="#cb318-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-86"><a href="#cb318-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb318-87"><a href="#cb318-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb318-88"><a href="#cb318-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb318-89"><a href="#cb318-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-90"><a href="#cb318-90" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb318-91"><a href="#cb318-91" aria-hidden="true" tabindex="-1"></a><span class="co"># imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb318-92"><a href="#cb318-92" aria-hidden="true" tabindex="-1"></a>mbp <span class="ot">=</span> <span class="st">"/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb318-93"><a href="#cb318-93" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(mbp)</span>
<span id="cb318-94"><a href="#cb318-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-95"><a href="#cb318-95" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb318-96"><a href="#cb318-96" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span>)</span>
<span id="cb318-97"><a href="#cb318-97" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span>)</span>
<span id="cb318-98"><a href="#cb318-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-99"><a href="#cb318-99" aria-hidden="true" tabindex="-1"></a><span class="co">#PREP DATA </span></span>
<span id="cb318-100"><a href="#cb318-100" aria-hidden="true" tabindex="-1"></a>df_lab <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_mode <span class="sc">==</span> <span class="st">"laboratory"</span>)</span>
<span id="cb318-101"><a href="#cb318-101" aria-hidden="true" tabindex="-1"></a>df_online <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pretty_mode <span class="sc">==</span> <span class="st">"online-replication"</span>)</span>
<span id="cb318-102"><a href="#cb318-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-103"><a href="#cb318-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-104"><a href="#cb318-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-105"><a href="#cb318-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1A \| Q1 ACCURACY</span></span>
<span id="cb318-106"><a href="#cb318-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-107"><a href="#cb318-107" aria-hidden="true" tabindex="-1"></a>**Do Ss in the IMPASSE condition have a higher likelihood of producing a correct response to the first question?**</span>
<span id="cb318-108"><a href="#cb318-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-109"><a href="#cb318-109" aria-hidden="true" tabindex="-1"></a>The graph comprehension tasks includes 15 questions completed in sequence. But the first question the reader encounters (Q1) is the most important, as it is their *first exposure* to the unconventional triangular coordinate system.</span>
<span id="cb318-110"><a href="#cb318-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-111"><a href="#cb318-111" aria-hidden="true" tabindex="-1"></a><span class="fu">### Accuracy of Q1 by Condition</span></span>
<span id="cb318-112"><a href="#cb318-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-113"><a href="#cb318-113" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-114"><a href="#cb318-114" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does the frequency of correct (vs) incorrect responses on the first question differ by condition? <span class="sc">\[</span>Is response accuracy independent of condition?<span class="sc">\]</span>                                                                                   |</span>
<span id="cb318-115"><a href="#cb318-115" aria-hidden="true" tabindex="-1"></a>+=======================+========================================================================================================================================================================================================================================+</span>
<span id="cb318-116"><a href="#cb318-116" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the IMPASSE condition will have a higher likelihood of correctly responding to the first question than those in the CONTROL condition                                                                                     |</span>
<span id="cb318-117"><a href="#cb318-117" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-118"><a href="#cb318-118" aria-hidden="true" tabindex="-1"></a>| **Data**              | data: <span class="in">`df_items`</span> where <span class="in">`q == 1`</span>                                                                                                                                                                                                        |</span>
<span id="cb318-119"><a href="#cb318-119" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb318-120"><a href="#cb318-120" aria-hidden="true" tabindex="-1"></a>|                       | outcome:                                                                                                                                                                                                                               |</span>
<span id="cb318-121"><a href="#cb318-121" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb318-122"><a href="#cb318-122" aria-hidden="true" tabindex="-1"></a>|                       | -   *accuracy* ( factor(incorrect/correct) from <span class="in">`score_niceABS`</span> <span class="sc">\[</span>absolute score<span class="sc">\]</span>                                                                                                                                                     |</span>
<span id="cb318-123"><a href="#cb318-123" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb318-124"><a href="#cb318-124" aria-hidden="true" tabindex="-1"></a>|                       | -   *interpretation* (ordered factor from <span class="in">`interpretation`</span>)                                                                                                                                                                            |</span>
<span id="cb318-125"><a href="#cb318-125" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb318-126"><a href="#cb318-126" aria-hidden="true" tabindex="-1"></a>|                       | predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                                                                                                     |</span>
<span id="cb318-127"><a href="#cb318-127" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-128"><a href="#cb318-128" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Logistic Regression on <span class="in">`accuracy`</span> predicted by <span class="in">`condition`</span>                                                                                                                                                                         |</span>
<span id="cb318-129"><a href="#cb318-129" aria-hidden="true" tabindex="-1"></a>|                       |     -   account for difference in odds of correct score by condition                                                                                                                                                                   |</span>
<span id="cb318-130"><a href="#cb318-130" aria-hidden="true" tabindex="-1"></a>|                       | 2.  Ordinal Regression on <span class="in">`interpretation`</span> predicted by <span class="in">`condition`</span>                                                                                                                                                                    |</span>
<span id="cb318-131"><a href="#cb318-131" aria-hidden="true" tabindex="-1"></a>|                       |     -   account for difference in (ordered correctness of interpretation) by condition                                                                                                                                                 |</span>
<span id="cb318-132"><a href="#cb318-132" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb318-133"><a href="#cb318-133" aria-hidden="true" tabindex="-1"></a>|                       | Alternative:                                                                                                                                                                                                                           |</span>
<span id="cb318-134"><a href="#cb318-134" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb318-135"><a href="#cb318-135" aria-hidden="true" tabindex="-1"></a>|                       | -   Chi-Square test of independence on outcome <span class="in">`score_niceABS`</span> by <span class="in">`condition`</span>                                                                                                                                                          |</span>
<span id="cb318-136"><a href="#cb318-136" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-137"><a href="#cb318-137" aria-hidden="true" tabindex="-1"></a>| **Notes**             | -   CHIQ SQR is simplest method to examine independence of two categorical factors; LOGISTIC REGRESSION is recommended for binomial \~ continuous; though with regression we can quantify the size of the effect and overall model fit |</span>
<span id="cb318-138"><a href="#cb318-138" aria-hidden="true" tabindex="-1"></a>|                       | -   independence assumption : (CHI SQR) as we only consider responses on the first question, each observation corresponds to an individual subject, and are thus independent                                                           |</span>
<span id="cb318-139"><a href="#cb318-139" aria-hidden="true" tabindex="-1"></a>|                       | -   cell frequency : (CHI SQR) expected frequency in each cell of the contingency table is greater than 5 (more than 5 correct , more than 5 incorrect responses)                                                                      |</span>
<span id="cb318-140"><a href="#cb318-140" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-141"><a href="#cb318-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-144"><a href="#cb318-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-145"><a href="#cb318-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1ACC</span></span>
<span id="cb318-146"><a href="#cb318-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-147"><a href="#cb318-147" aria-hidden="true" tabindex="-1"></a><span class="co">#FILTER THE DATASET</span></span>
<span id="cb318-148"><a href="#cb318-148" aria-hidden="true" tabindex="-1"></a>df_q1 <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb318-149"><a href="#cb318-149" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"incorrect"</span>, <span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>)</span>
<span id="cb318-150"><a href="#cb318-150" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb318-151"><a href="#cb318-151" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb318-152"><a href="#cb318-152" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb318-153"><a href="#cb318-153" aria-hidden="true" tabindex="-1"></a><span class="co"># gf_props(~accuracy, fill = ~pretty_condition, </span></span>
<span id="cb318-154"><a href="#cb318-154" aria-hidden="true" tabindex="-1"></a><span class="co">#        position = position_dodge(), data = df_q1) %&gt;% </span></span>
<span id="cb318-155"><a href="#cb318-155" aria-hidden="true" tabindex="-1"></a><span class="co">#   gf_facet_grid(~pretty_mode) +</span></span>
<span id="cb318-156"><a href="#cb318-156" aria-hidden="true" tabindex="-1"></a><span class="co">#    labs(x = "Correct Response on Q 1",</span></span>
<span id="cb318-157"><a href="#cb318-157" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "Accuracy on First Question by Condition",</span></span>
<span id="cb318-158"><a href="#cb318-158" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle="Impasse Condition yields a greater proportion of correct responses") #theme(legend.position = "none")</span></span>
<span id="cb318-159"><a href="#cb318-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-160"><a href="#cb318-160" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED BAR CHART</span></span>
<span id="cb318-161"><a href="#cb318-161" aria-hidden="true" tabindex="-1"></a>df_q1 <span class="sc">%&gt;%</span> </span>
<span id="cb318-162"><a href="#cb318-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb318-163"><a href="#cb318-163" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb318-164"><a href="#cb318-164" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb318-165"><a href="#cb318-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb318-166"><a href="#cb318-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb318-167"><a href="#cb318-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb318-168"><a href="#cb318-168" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb318-169"><a href="#cb318-169" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb318-170"><a href="#cb318-170" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb318-171"><a href="#cb318-171" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb318-172"><a href="#cb318-172" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb318-173"><a href="#cb318-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-174"><a href="#cb318-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-175"><a href="#cb318-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-176"><a href="#cb318-176" aria-hidden="true" tabindex="-1"></a>A proportional bar chart visualizing the proportion of incorrect (vs) correct responses in each condition for each data collection modality (left/right facet) reveals that the pattern of responses appear the same regardless of the data collection modality. In both data collection sessions, the proportion of incorrect responses is much greater than the proportion of correct responses, regardless of condition (marginal probability of incorrect). In the impasse condition, the difference in proportions is smaller than the control condition (conditional probability of success in impasse; (i.e) There are more correct responses in the impasse condition than the control condition).</span>
<span id="cb318-177"><a href="#cb318-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-178"><a href="#cb318-178" aria-hidden="true" tabindex="-1"></a><span class="fu">#### LOGISTIC REGRESSION</span></span>
<span id="cb318-179"><a href="#cb318-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-180"><a href="#cb318-180" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model</span></span>
<span id="cb318-181"><a href="#cb318-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-184"><a href="#cb318-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-185"><a href="#cb318-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-Q1ACC-LOG-combined</span></span>
<span id="cb318-186"><a href="#cb318-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb318-187"><a href="#cb318-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb318-188"><a href="#cb318-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-189"><a href="#cb318-189" aria-hidden="true" tabindex="-1"></a><span class="co">#combined</span></span>
<span id="cb318-190"><a href="#cb318-190" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_q1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy,score_niceABS,pretty_condition,pretty_mode, rt_s)</span>
<span id="cb318-191"><a href="#cb318-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-192"><a href="#cb318-192" aria-hidden="true" tabindex="-1"></a><span class="co"># FREQUENCY TABLE</span></span>
<span id="cb318-193"><a href="#cb318-193" aria-hidden="true" tabindex="-1"></a><span class="co"># my.table &lt;- table(df$accuracy, df$pretty_condition)</span></span>
<span id="cb318-194"><a href="#cb318-194" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(my.table) #counts</span></span>
<span id="cb318-195"><a href="#cb318-195" aria-hidden="true" tabindex="-1"></a><span class="co"># addmargins(prop.table(my.table)) #props</span></span>
<span id="cb318-196"><a href="#cb318-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-197"><a href="#cb318-197" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::::::::::::::::::::::::::::::::::</span></span>
<span id="cb318-198"><a href="#cb318-198" aria-hidden="true" tabindex="-1"></a><span class="co">#CONDITION MODEL</span></span>
<span id="cb318-199"><a href="#cb318-199" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"LOGISTIC REGRESSION MODEL"</span>)</span>
<span id="cb318-200"><a href="#cb318-200" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, </span>
<span id="cb318-201"><a href="#cb318-201" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb318-202"><a href="#cb318-202" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb318-203"><a href="#cb318-203" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- LOG ODDS"</span>)</span>
<span id="cb318-204"><a href="#cb318-204" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m)</span>
<span id="cb318-205"><a href="#cb318-205" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients —- ODDS RATIOS"</span>)</span>
<span id="cb318-206"><a href="#cb318-206" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m)), <span class="fu">exp</span>(<span class="fu">confint</span>(m))) <span class="co">#exponentiate</span></span>
<span id="cb318-207"><a href="#cb318-207" aria-hidden="true" tabindex="-1"></a>e</span>
<span id="cb318-208"><a href="#cb318-208" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb318-209"><a href="#cb318-209" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m)</span>
<span id="cb318-210"><a href="#cb318-210" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SANITY CHECK REPORTING"</span>)</span>
<span id="cb318-211"><a href="#cb318-211" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m)</span>
<span id="cb318-212"><a href="#cb318-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-213"><a href="#cb318-213" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span>
<span id="cb318-214"><a href="#cb318-214" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb318-215"><a href="#cb318-215" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb318-216"><a href="#cb318-216" aria-hidden="true" tabindex="-1"></a>p.control <span class="ot">&lt;-</span> <span class="fu">predict</span>(m,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"control"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb318-217"><a href="#cb318-217" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in control,"</span>, p.control)</span>
<span id="cb318-218"><a href="#cb318-218" aria-hidden="true" tabindex="-1"></a>p.impasse <span class="ot">&lt;-</span> <span class="fu">predict</span>(m,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"impasse"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb318-219"><a href="#cb318-219" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in impasse,"</span>, p.impasse)</span>
<span id="cb318-220"><a href="#cb318-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-221"><a href="#cb318-221" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb318-222"><a href="#cb318-222" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggstatsplot)</span></span>
<span id="cb318-223"><a href="#cb318-223" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoefstats</span>(m, <span class="at">output =</span> <span class="st">"plot"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Log Odds Estimate"</span>)</span>
<span id="cb318-224"><a href="#cb318-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-225"><a href="#cb318-225" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb318-226"><a href="#cb318-226" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb318-227"><a href="#cb318-227" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb318-228"><a href="#cb318-228" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb318-229"><a href="#cb318-229" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb318-230"><a href="#cb318-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb318-231"><a href="#cb318-231" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb318-232"><a href="#cb318-232" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb318-233"><a href="#cb318-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-234"><a href="#cb318-234" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb318-235"><a href="#cb318-235" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="pred",</span></span>
<span id="cb318-236"><a href="#cb318-236" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE, </span></span>
<span id="cb318-237"><a href="#cb318-237" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb318-238"><a href="#cb318-238" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Predicted Probability of Accuracy",</span></span>
<span id="cb318-239"><a href="#cb318-239" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb318-240"><a href="#cb318-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-241"><a href="#cb318-241" aria-hidden="true" tabindex="-1"></a><span class="co">#GGEFFECTS | MODEL | PROBABILITIES</span></span>
<span id="cb318-242"><a href="#cb318-242" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb318-243"><a href="#cb318-243" aria-hidden="true" tabindex="-1"></a><span class="fu">ggeffect</span>(<span class="at">model =</span> m) <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span>
<span id="cb318-244"><a href="#cb318-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-245"><a href="#cb318-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-246"><a href="#cb318-246" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb318-247"><a href="#cb318-247" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb318-248"><a href="#cb318-248" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(m))</span></span>
<span id="cb318-249"><a href="#cb318-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-250"><a href="#cb318-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-251"><a href="#cb318-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-252"><a href="#cb318-252" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb318-253"><a href="#cb318-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-256"><a href="#cb318-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-257"><a href="#cb318-257" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span>
<span id="cb318-258"><a href="#cb318-258" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(m, <span class="at">n_bins=</span><span class="dv">10</span>)</span>
<span id="cb318-259"><a href="#cb318-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-260"><a href="#cb318-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-261"><a href="#cb318-261" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb318-262"><a href="#cb318-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-263"><a href="#cb318-263" aria-hidden="true" tabindex="-1"></a>We fit a logistic regression model to analyze the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 3.16, p = 0.0016). The model predicts that the odds of a correct response on the first question in the *impasse condition* increase by 146% ($e^{beta_1}$ = 2.46, 95% CI \[1.42, 4.37\]) over the *control condition*.</span>
<span id="cb318-264"><a href="#cb318-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-265"><a href="#cb318-265" aria-hidden="true" tabindex="-1"></a>*Equivalent statements:*</span>
<span id="cb318-266"><a href="#cb318-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-267"><a href="#cb318-267" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse condition increases log odds of correct response by 0.901 (over control)</span>
<span id="cb318-268"><a href="#cb318-268" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse increases odds of correct response in impasse over control increases by factor of 2.46</span>
<span id="cb318-269"><a href="#cb318-269" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>probability of correct response in control predicted as 28.5%, vs only 14% in control condition</span>
<span id="cb318-270"><a href="#cb318-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-271"><a href="#cb318-271" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO</span></span>
<span id="cb318-272"><a href="#cb318-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-273"><a href="#cb318-273" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Are these residuals OK? I didn't think normally distributed residuals were an assumption for logistic regression.</span>
<span id="cb318-274"><a href="#cb318-274" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation/reporting of model fit?</span>
<span id="cb318-275"><a href="#cb318-275" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>sanity check correct interpretation of coefficients &amp; reporting</span>
<span id="cb318-276"><a href="#cb318-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-277"><a href="#cb318-277" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TODO ORDINAL REGRESSION</span></span>
<span id="cb318-278"><a href="#cb318-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-279"><a href="#cb318-279" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://stats.oarc.ucla.edu/r/faq/ologit-coefficients/</span>
<span id="cb318-280"><a href="#cb318-280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb318-281"><a href="#cb318-281" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>todo see ordinal regression video</span>
<span id="cb318-282"><a href="#cb318-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-285"><a href="#cb318-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-286"><a href="#cb318-286" aria-hidden="true" tabindex="-1"></a><span class="co"># #CREATE DATAFRAME OF Q1</span></span>
<span id="cb318-287"><a href="#cb318-287" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_items %&gt;% filter(q ==1) %&gt;% mutate(scaled = as.factor(score_SCALED))</span></span>
<span id="cb318-288"><a href="#cb318-288" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-289"><a href="#cb318-289" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL</span></span>
<span id="cb318-290"><a href="#cb318-290" aria-hidden="true" tabindex="-1"></a><span class="co"># m &lt;- polr(scaled ~ condition , data = df, Hess=TRUE)</span></span>
<span id="cb318-291"><a href="#cb318-291" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m)</span></span>
<span id="cb318-292"><a href="#cb318-292" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m)</span></span>
<span id="cb318-293"><a href="#cb318-293" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb318-294"><a href="#cb318-294" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb318-295"><a href="#cb318-295" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-296"><a href="#cb318-296" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate coefficients and CIs </span></span>
<span id="cb318-297"><a href="#cb318-297" aria-hidden="true" tabindex="-1"></a><span class="co"># ci &lt;- confint(m)</span></span>
<span id="cb318-298"><a href="#cb318-298" aria-hidden="true" tabindex="-1"></a><span class="co"># ci</span></span>
<span id="cb318-299"><a href="#cb318-299" aria-hidden="true" tabindex="-1"></a><span class="co"># e &lt;- coef(m)</span></span>
<span id="cb318-300"><a href="#cb318-300" aria-hidden="true" tabindex="-1"></a><span class="co"># e</span></span>
<span id="cb318-301"><a href="#cb318-301" aria-hidden="true" tabindex="-1"></a><span class="co"># # exp(cbind(e,ci))</span></span>
<span id="cb318-302"><a href="#cb318-302" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-303"><a href="#cb318-303" aria-hidden="true" tabindex="-1"></a><span class="co"># # Retrieve predictions as probabilities </span></span>
<span id="cb318-304"><a href="#cb318-304" aria-hidden="true" tabindex="-1"></a><span class="co"># # (for each level of the predictor)</span></span>
<span id="cb318-305"><a href="#cb318-305" aria-hidden="true" tabindex="-1"></a><span class="co"># # p.control &lt;- predict(m,data.frame(condition="111"),type="response")</span></span>
<span id="cb318-306"><a href="#cb318-306" aria-hidden="true" tabindex="-1"></a><span class="co"># # paste("Probability of success in control,", p.control)</span></span>
<span id="cb318-307"><a href="#cb318-307" aria-hidden="true" tabindex="-1"></a><span class="co"># # p.impasse &lt;- predict(m,data.frame(condition="121"),type="response")</span></span>
<span id="cb318-308"><a href="#cb318-308" aria-hidden="true" tabindex="-1"></a><span class="co"># # paste("Probability of success in impasse,", p.impasse)</span></span>
<span id="cb318-309"><a href="#cb318-309" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-310"><a href="#cb318-310" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot Predicted data and original data points</span></span>
<span id="cb318-311"><a href="#cb318-311" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggplot(df, aes(x=condition, y=accuracy)) + </span></span>
<span id="cb318-312"><a href="#cb318-312" aria-hidden="true" tabindex="-1"></a><span class="co"># #   geom_point() +</span></span>
<span id="cb318-313"><a href="#cb318-313" aria-hidden="true" tabindex="-1"></a><span class="co"># #   stat_smooth(method="glm", color="green", se=FALSE,</span></span>
<span id="cb318-314"><a href="#cb318-314" aria-hidden="true" tabindex="-1"></a><span class="co"># #                 method.args = list(family=binomial))</span></span>
<span id="cb318-315"><a href="#cb318-315" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb318-316"><a href="#cb318-316" aria-hidden="true" tabindex="-1"></a><span class="co"># #TO PLOT ALL EFFECTS</span></span>
<span id="cb318-317"><a href="#cb318-317" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb318-318"><a href="#cb318-318" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(allEffects(m))</span></span>
<span id="cb318-319"><a href="#cb318-319" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-320"><a href="#cb318-320" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT</span></span>
<span id="cb318-321"><a href="#cb318-321" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sjPlot)</span></span>
<span id="cb318-322"><a href="#cb318-322" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, )</span></span>
<span id="cb318-323"><a href="#cb318-323" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-324"><a href="#cb318-324" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-325"><a href="#cb318-325" aria-hidden="true" tabindex="-1"></a><span class="co"># #CONVERT TO PROBABILITIES</span></span>
<span id="cb318-326"><a href="#cb318-326" aria-hidden="true" tabindex="-1"></a><span class="co"># newdat &lt;- data.frame(condition=c("111","121"))</span></span>
<span id="cb318-327"><a href="#cb318-327" aria-hidden="true" tabindex="-1"></a><span class="co"># prob &lt;- (phat &lt;- predict(object = m, newdat, type="p"))</span></span>
<span id="cb318-328"><a href="#cb318-328" aria-hidden="true" tabindex="-1"></a><span class="co"># prob</span></span>
<span id="cb318-329"><a href="#cb318-329" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-330"><a href="#cb318-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-331"><a href="#cb318-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-332"><a href="#cb318-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-333"><a href="#cb318-333" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1B \| TEST PHASE ACCURACY</span></span>
<span id="cb318-334"><a href="#cb318-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-335"><a href="#cb318-335" aria-hidden="true" tabindex="-1"></a>**Do Ss in the IMPASSE condition have higher scores in the TEST Phase of the task?**</span>
<span id="cb318-336"><a href="#cb318-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-337"><a href="#cb318-337" aria-hidden="true" tabindex="-1"></a>The graph comprehension tasks includes 13 interpretation-discriminant questions completed in sequence. The first five questions constitute the 'scaffold' phase, and the remaining 8 the test phase. By examining the effect of condition on test-phase scores, we can evaluate if the impasse scaffold has an effect after it it has been removed.</span>
<span id="cb318-338"><a href="#cb318-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-339"><a href="#cb318-339" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-340"><a href="#cb318-340" aria-hidden="true" tabindex="-1"></a>| Research Question     | Do Ss in the IMPASSE condition score higher in the test phase than those in the CONTROL group.                                                          |</span>
<span id="cb318-341"><a href="#cb318-341" aria-hidden="true" tabindex="-1"></a>+=======================+=========================================================================================================================================================+</span>
<span id="cb318-342"><a href="#cb318-342" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | (H1B) Participants in the IMPASSE condition will have higher test phase performance than those in the CONTROL condition.                                |</span>
<span id="cb318-343"><a href="#cb318-343" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-344"><a href="#cb318-344" aria-hidden="true" tabindex="-1"></a>| **Data**              | **data**: <span class="in">`df_items`</span> where <span class="in">`q in 7,8,10,11,12,13,14,15`</span> (the 8 discriminating test phase questions), <span class="in">`df_subjects`</span>                                      |</span>
<span id="cb318-345"><a href="#cb318-345" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                         |</span>
<span id="cb318-346"><a href="#cb318-346" aria-hidden="true" tabindex="-1"></a>|                       | **outcome**:                                                                                                                                            |</span>
<span id="cb318-347"><a href="#cb318-347" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                         |</span>
<span id="cb318-348"><a href="#cb318-348" aria-hidden="true" tabindex="-1"></a>|                       | -   <span class="sc">\[</span>at item level<span class="sc">\]</span>                                                                                                                                   |</span>
<span id="cb318-349"><a href="#cb318-349" aria-hidden="true" tabindex="-1"></a>|                       |     -   *accuracy* ( factor(incorrect/correct) from <span class="in">`score_niceABS`</span> <span class="sc">\[</span>absolute score<span class="sc">\]</span>                                                                  |</span>
<span id="cb318-350"><a href="#cb318-350" aria-hidden="true" tabindex="-1"></a>|                       |     -   *interpretation* (ordered factor from <span class="in">`interpretation`</span>)                                                                                         |</span>
<span id="cb318-351"><a href="#cb318-351" aria-hidden="true" tabindex="-1"></a>|                       | -   <span class="sc">\[</span>subject level<span class="sc">\]</span>                                                                                                                                   |</span>
<span id="cb318-352"><a href="#cb318-352" aria-hidden="true" tabindex="-1"></a>|                       |     -   p_accuracy (percent of correct responses)                                                                                                       |</span>
<span id="cb318-353"><a href="#cb318-353" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                         |</span>
<span id="cb318-354"><a href="#cb318-354" aria-hidden="true" tabindex="-1"></a>|                       | **predictor**: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                  |</span>
<span id="cb318-355"><a href="#cb318-355" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-356"><a href="#cb318-356" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Shift in Modal Mass (descriptive)\                                                                                                                  |</span>
<span id="cb318-357"><a href="#cb318-357" aria-hidden="true" tabindex="-1"></a>|                       |     describe &amp; visualize shift in deciles between conditions for `<span class="in">` `</span>scaled_score` `` (at subject level)                                                |</span>
<span id="cb318-358"><a href="#cb318-358" aria-hidden="true" tabindex="-1"></a>|                       | 2.  Mixed Logistic Regression\                                                                                                                          |</span>
<span id="cb318-359"><a href="#cb318-359" aria-hidden="true" tabindex="-1"></a>|                       |     <span class="in">`accuracy`</span> \~ <span class="in">`condition`</span> + (1 \| <span class="in">`subject`</span> )\                                                                                                      |</span>
<span id="cb318-360"><a href="#cb318-360" aria-hidden="true" tabindex="-1"></a>|                       |     model effect of condition on probability of correct response <span class="sc">\[</span>during test phase<span class="sc">\]</span> while accounting for subject (and item-level?) effects           |</span>
<span id="cb318-361"><a href="#cb318-361" aria-hidden="true" tabindex="-1"></a>|                       | 3.  Ordinal Mixed Logistic Regression\                                                                                                                  |</span>
<span id="cb318-362"><a href="#cb318-362" aria-hidden="true" tabindex="-1"></a>|                       |     <span class="in">`interpretation`</span> \~ <span class="in">`condition`</span> + (1 \| <span class="in">`subject`</span> )\                                                                                                |</span>
<span id="cb318-363"><a href="#cb318-363" aria-hidden="true" tabindex="-1"></a>|                       |     model effect of condition on <span class="sc">\[</span>ordered correctness of interpretation<span class="sc">\]</span> <span class="sc">\[</span>during test phase<span class="sc">\]</span> while accounting for subject (and item-level?) effects |</span>
<span id="cb318-364"><a href="#cb318-364" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-365"><a href="#cb318-365" aria-hidden="true" tabindex="-1"></a>| **Alternatives**      | -   OLS LINEAR REGRESSION                                                                                                                               |</span>
<span id="cb318-366"><a href="#cb318-366" aria-hidden="true" tabindex="-1"></a>|                       |     -   bimodal distribution at tails makes the mean a poor predictor; LMs violate assumptions of normally distributed residuals                        |</span>
<span id="cb318-367"><a href="#cb318-367" aria-hidden="true" tabindex="-1"></a>|                       |     -   lm <span class="in">`DV_percent_test_NABS`</span> \~ <span class="in">`condition`</span> (absolute scoring) OR lm <span class="in">`item_test_SCALED`</span> \~ <span class="in">`condition`</span> (scaled scoring)                            |</span>
<span id="cb318-368"><a href="#cb318-368" aria-hidden="true" tabindex="-1"></a>|                       |     -   both absolute and scaled scores yield non-normal residuals                                                                                      |</span>
<span id="cb318-369"><a href="#cb318-369" aria-hidden="true" tabindex="-1"></a>|                       |     -   no transformation of the outcome variables yield normal residuals                                                                               |</span>
<span id="cb318-370"><a href="#cb318-370" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-371"><a href="#cb318-371" aria-hidden="true" tabindex="-1"></a>| **Notes**             | **Also exploring:**                                                                                                                                     |</span>
<span id="cb318-372"><a href="#cb318-372" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                         |</span>
<span id="cb318-373"><a href="#cb318-373" aria-hidden="true" tabindex="-1"></a>|                       | -   Hurdle model (mixture model w/ binomial + <span class="sc">\[</span>poisson or negbinom count; 0s from 1 DGP)                                                               |</span>
<span id="cb318-374"><a href="#cb318-374" aria-hidden="true" tabindex="-1"></a>|                       | -   Zero Inflated model (mixture model w/ binomial + poisson or negbinom count; 0s from 2 DGPs)                                                         |</span>
<span id="cb318-375"><a href="#cb318-375" aria-hidden="true" tabindex="-1"></a>|                       | -   Beta regression hurdle model? (mixture with location and scale parameters <span class="sc">\[</span>mean, variance<span class="sc">\]</span> and hurdles for floor and ceiling effects)             |</span>
<span id="cb318-376"><a href="#cb318-376" aria-hidden="true" tabindex="-1"></a>|                       | -   Other way to account for the severe bimodality?                                                                                                     |</span>
<span id="cb318-377"><a href="#cb318-377" aria-hidden="true" tabindex="-1"></a>+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb318-378"><a href="#cb318-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-381"><a href="#cb318-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-382"><a href="#cb318-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-</span><span class="al">TEST</span><span class="co">-ACC</span></span>
<span id="cb318-383"><a href="#cb318-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-384"><a href="#cb318-384" aria-hidden="true" tabindex="-1"></a><span class="co">#PREPARE DATA </span></span>
<span id="cb318-385"><a href="#cb318-385" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">=</span> <span class="dv">8</span> <span class="co">#number of items in test</span></span>
<span id="cb318-386"><a href="#cb318-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-387"><a href="#cb318-387" aria-hidden="true" tabindex="-1"></a><span class="co">#item level</span></span>
<span id="cb318-388"><a href="#cb318-388" aria-hidden="true" tabindex="-1"></a>df_test <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb318-389"><a href="#cb318-389" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> <span class="fu">as.factor</span>(score_niceABS),</span>
<span id="cb318-390"><a href="#cb318-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">as.factor</span>(q)</span>
<span id="cb318-391"><a href="#cb318-391" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb318-392"><a href="#cb318-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-393"><a href="#cb318-393" aria-hidden="true" tabindex="-1"></a><span class="co">#subject level</span></span>
<span id="cb318-394"><a href="#cb318-394" aria-hidden="true" tabindex="-1"></a>df_Stest <span class="ot">=</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb318-395"><a href="#cb318-395" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_accuracy =</span> item_test_NABS<span class="sc">/</span>n_items</span>
<span id="cb318-396"><a href="#cb318-396" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb318-397"><a href="#cb318-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-398"><a href="#cb318-398" aria-hidden="true" tabindex="-1"></a><span class="co">#STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb318-399"><a href="#cb318-399" aria-hidden="true" tabindex="-1"></a>df_test <span class="sc">%&gt;%</span> </span>
<span id="cb318-400"><a href="#cb318-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb318-401"><a href="#cb318-401" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb318-402"><a href="#cb318-402" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb318-403"><a href="#cb318-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb318-404"><a href="#cb318-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb318-405"><a href="#cb318-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span> </span>
<span id="cb318-406"><a href="#cb318-406" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb318-407"><a href="#cb318-407" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy on Test Phase Questions"</span>,</span>
<span id="cb318-408"><a href="#cb318-408" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb318-409"><a href="#cb318-409" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb318-410"><a href="#cb318-410" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb318-411"><a href="#cb318-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-412"><a href="#cb318-412" aria-hidden="true" tabindex="-1"></a><span class="co">#GROUPED PROPORTIONAL BAR CHART</span></span>
<span id="cb318-413"><a href="#cb318-413" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>accuracy, <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">x =</span><span class="sc">~</span>pretty_condition,</span>
<span id="cb318-414"><a href="#cb318-414" aria-hidden="true" tabindex="-1"></a>       <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">data =</span> df_test) <span class="sc">%&gt;%</span> </span>
<span id="cb318-415"><a href="#cb318-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_mode) <span class="sc">+</span></span>
<span id="cb318-416"><a href="#cb318-416" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Correct Responses in Test Phase"</span>,</span>
<span id="cb318-417"><a href="#cb318-417" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Accuracy in Test Phase by Condition"</span>,</span>
<span id="cb318-418"><a href="#cb318-418" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb318-419"><a href="#cb318-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-420"><a href="#cb318-420" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb318-421"><a href="#cb318-421" aria-hidden="true" tabindex="-1"></a><span class="co">#FACETED HISTOGRAM</span></span>
<span id="cb318-422"><a href="#cb318-422" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_Stest <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(p_accuracy))</span>
<span id="cb318-423"><a href="#cb318-423" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>p_accuracy, </span>
<span id="cb318-424"><a href="#cb318-424" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_Stest) <span class="sc">%&gt;%</span> </span>
<span id="cb318-425"><a href="#cb318-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(pretty_condition <span class="sc">~</span> pretty_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb318-426"><a href="#cb318-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb318-427"><a href="#cb318-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb318-428"><a href="#cb318-428" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb318-429"><a href="#cb318-429" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Test Phase Absolute Score (% Correct)"</span>,</span>
<span id="cb318-430"><a href="#cb318-430" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb318-431"><a href="#cb318-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-432"><a href="#cb318-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-433"><a href="#cb318-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-434"><a href="#cb318-434" aria-hidden="true" tabindex="-1"></a><span class="fu">### Test Phase Absolute Score</span></span>
<span id="cb318-435"><a href="#cb318-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-436"><a href="#cb318-436" aria-hidden="true" tabindex="-1"></a><span class="fu">#### WIP \| MIXED LOGISTIC REGRESSION</span></span>
<span id="cb318-437"><a href="#cb318-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-438"><a href="#cb318-438" aria-hidden="true" tabindex="-1"></a><span class="fu">##### (Combined)</span></span>
<span id="cb318-439"><a href="#cb318-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-442"><a href="#cb318-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-443"><a href="#cb318-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-MLOG-ABS-comb</span></span>
<span id="cb318-444"><a href="#cb318-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-445"><a href="#cb318-445" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb318-446"><a href="#cb318-446" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_test </span>
<span id="cb318-447"><a href="#cb318-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-448"><a href="#cb318-448" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT </span></span>
<span id="cb318-449"><a href="#cb318-449" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb318-450"><a href="#cb318-450" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm.rS)</span>
<span id="cb318-451"><a href="#cb318-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-452"><a href="#cb318-452" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT + ITEM INTERCEPT </span></span>
<span id="cb318-453"><a href="#cb318-453" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb318-454"><a href="#cb318-454" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm.rSQ)</span>
<span id="cb318-455"><a href="#cb318-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-456"><a href="#cb318-456" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | CONDITION FIXED</span></span>
<span id="cb318-457"><a href="#cb318-457" aria-hidden="true" tabindex="-1"></a>mm.CrS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb318-458"><a href="#cb318-458" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm.CrS)</span>
<span id="cb318-459"><a href="#cb318-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-460"><a href="#cb318-460" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | ITEM FIXED</span></span>
<span id="cb318-461"><a href="#cb318-461" aria-hidden="true" tabindex="-1"></a>mm.QrS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> q <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,</span>
<span id="cb318-462"><a href="#cb318-462" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="st">"binomial"</span>,<span class="at">nAGQ=</span><span class="dv">0</span>)</span>
<span id="cb318-463"><a href="#cb318-463" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm.QrS)</span>
<span id="cb318-464"><a href="#cb318-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-465"><a href="#cb318-465" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT INTERCEPT | CONDITION + ITEM FIXED</span></span>
<span id="cb318-466"><a href="#cb318-466" aria-hidden="true" tabindex="-1"></a>mm.CQrS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> q <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df,</span>
<span id="cb318-467"><a href="#cb318-467" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="st">"binomial"</span>,<span class="at">nAGQ=</span><span class="dv">0</span>)</span>
<span id="cb318-468"><a href="#cb318-468" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm.CQrS)</span>
<span id="cb318-469"><a href="#cb318-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-470"><a href="#cb318-470" aria-hidden="true" tabindex="-1"></a><span class="co"># SUBJECT + ITEM INTERCEPT | CONDITION FIXED</span></span>
<span id="cb318-471"><a href="#cb318-471" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb318-472"><a href="#cb318-472" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm.CrSQ)</span>
<span id="cb318-473"><a href="#cb318-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-474"><a href="#cb318-474" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(mm.rS, mm.rSQ, mm.CrS, mm.QrS, mm.CQrS,mm.CrSQ)</span>
<span id="cb318-475"><a href="#cb318-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-476"><a href="#cb318-476" aria-hidden="true" tabindex="-1"></a><span class="co">#SJ PLOTS TABLES</span></span>
<span id="cb318-477"><a href="#cb318-477" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(mm.rS, mm.rSQ, mm.CrS, mm.QrS, mm.CQrS,mm.CrSQ)</span>
<span id="cb318-478"><a href="#cb318-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-479"><a href="#cb318-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-482"><a href="#cb318-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-483"><a href="#cb318-483" aria-hidden="true" tabindex="-1"></a><span class="co">#THEORETICALLY MOTIVATED MODEL</span></span>
<span id="cb318-484"><a href="#cb318-484" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.CrS</span>
<span id="cb318-485"><a href="#cb318-485" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m)</span>
<span id="cb318-486"><a href="#cb318-486" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span>
<span id="cb318-487"><a href="#cb318-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-488"><a href="#cb318-488" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL FORMULA"</span>)</span>
<span id="cb318-489"><a href="#cb318-489" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(m<span class="sc">@</span>call[[<span class="st">"formula"</span>]])</span>
<span id="cb318-490"><a href="#cb318-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-491"><a href="#cb318-491" aria-hidden="true" tabindex="-1"></a><span class="co">#SJ PLOTS</span></span>
<span id="cb318-492"><a href="#cb318-492" aria-hidden="true" tabindex="-1"></a><span class="co">#table of effects</span></span>
<span id="cb318-493"><a href="#cb318-493" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span> <span class="fu">tab_model</span>(m)</span>
<span id="cb318-494"><a href="#cb318-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-495"><a href="#cb318-495" aria-hidden="true" tabindex="-1"></a><span class="co">#PLOT RANDOM EFFECTS</span></span>
<span id="cb318-496"><a href="#cb318-496" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb318-497"><a href="#cb318-497" aria-hidden="true" tabindex="-1"></a>randoms <span class="ot">&lt;-</span> <span class="fu">ranef</span>(m)</span>
<span id="cb318-498"><a href="#cb318-498" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(randoms)</span>
<span id="cb318-499"><a href="#cb318-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-500"><a href="#cb318-500" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb318-501"><a href="#cb318-501" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb318-502"><a href="#cb318-502" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"std2"</span>, <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb318-503"><a href="#cb318-503" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb318-504"><a href="#cb318-504" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb318-505"><a href="#cb318-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Predicted Odds Ratio"</span>,</span>
<span id="cb318-506"><a href="#cb318-506" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb318-507"><a href="#cb318-507" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb318-508"><a href="#cb318-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-509"><a href="#cb318-509" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb318-510"><a href="#cb318-510" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"pred"</span>,</span>
<span id="cb318-511"><a href="#cb318-511" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb318-512"><a href="#cb318-512" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb318-513"><a href="#cb318-513" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Model Predicted Probability of Accuracy"</span>,</span>
<span id="cb318-514"><a href="#cb318-514" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Probability of Accurate Response"</span>))</span>
<span id="cb318-515"><a href="#cb318-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-516"><a href="#cb318-516" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK SJPLOT</span></span>
<span id="cb318-517"><a href="#cb318-517" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb318-518"><a href="#cb318-518" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(m)) </span>
<span id="cb318-519"><a href="#cb318-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-520"><a href="#cb318-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-521"><a href="#cb318-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-522"><a href="#cb318-522" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TODO \| Ordinal Regression on ITEM-Interpretation</span></span>
<span id="cb318-523"><a href="#cb318-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-524"><a href="#cb318-524" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cummulative Ordinal (Bayesian)</span></span>
<span id="cb318-525"><a href="#cb318-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-526"><a href="#cb318-526" aria-hidden="true" tabindex="-1"></a>https://journals.sagepub.com/doi/full/10.1177/2515245918823199</span>
<span id="cb318-527"><a href="#cb318-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-530"><a href="#cb318-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-531"><a href="#cb318-531" aria-hidden="true" tabindex="-1"></a><span class="co"># library(brms)</span></span>
<span id="cb318-532"><a href="#cb318-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-533"><a href="#cb318-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-534"><a href="#cb318-534" aria-hidden="true" tabindex="-1"></a><span class="co"># #DEFINE DATA </span></span>
<span id="cb318-535"><a href="#cb318-535" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_items %&gt;% mutate(</span></span>
<span id="cb318-536"><a href="#cb318-536" aria-hidden="true" tabindex="-1"></a><span class="co">#   scaled = factor(score_SCALED, ordered = TRUE,  #ordered factor</span></span>
<span id="cb318-537"><a href="#cb318-537" aria-hidden="true" tabindex="-1"></a><span class="co">#                     levels = c("-1", "-0.5", "0", "0.5","1"))</span></span>
<span id="cb318-538"><a href="#cb318-538" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb318-539"><a href="#cb318-539" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-540"><a href="#cb318-540" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_cum &lt;- brm( formula = scaled ~ condition,</span></span>
<span id="cb318-541"><a href="#cb318-541" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = df,</span></span>
<span id="cb318-542"><a href="#cb318-542" aria-hidden="true" tabindex="-1"></a><span class="co">#                family = cumulative("probit"),</span></span>
<span id="cb318-543"><a href="#cb318-543" aria-hidden="true" tabindex="-1"></a><span class="co">#                file = "analysis/SGC3A/models/m_items_ord.cum.rds" # cache model (can be removed)  </span></span>
<span id="cb318-544"><a href="#cb318-544" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-545"><a href="#cb318-545" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb318-546"><a href="#cb318-546" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-547"><a href="#cb318-547" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(ord_cum)</span></span>
<span id="cb318-548"><a href="#cb318-548" aria-hidden="true" tabindex="-1"></a><span class="co"># conditional_effects(ord_cum, "condition", categorical = TRUE)</span></span>
<span id="cb318-549"><a href="#cb318-549" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-550"><a href="#cb318-550" aria-hidden="true" tabindex="-1"></a><span class="co"># #SJPLOT</span></span>
<span id="cb318-551"><a href="#cb318-551" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sjPlot)</span></span>
<span id="cb318-552"><a href="#cb318-552" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(ord_cum)</span></span>
<span id="cb318-553"><a href="#cb318-553" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-554"><a href="#cb318-554" aria-hidden="true" tabindex="-1"></a><span class="co"># # m %&gt;%</span></span>
<span id="cb318-555"><a href="#cb318-555" aria-hidden="true" tabindex="-1"></a><span class="co"># #   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb318-556"><a href="#cb318-556" aria-hidden="true" tabindex="-1"></a><span class="co"># #   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb318-557"><a href="#cb318-557" aria-hidden="true" tabindex="-1"></a><span class="co"># #   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb318-558"><a href="#cb318-558" aria-hidden="true" tabindex="-1"></a><span class="co"># #   stat_halfeye()</span></span>
<span id="cb318-559"><a href="#cb318-559" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-560"><a href="#cb318-560" aria-hidden="true" tabindex="-1"></a><span class="co"># # performance(ord_cum)</span></span>
<span id="cb318-561"><a href="#cb318-561" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot(ord_cum)</span></span>
<span id="cb318-562"><a href="#cb318-562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-563"><a href="#cb318-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-564"><a href="#cb318-564" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Adjacent-Category Ordinal (Bayesian)</span></span>
<span id="cb318-565"><a href="#cb318-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-568"><a href="#cb318-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-569"><a href="#cb318-569" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-570"><a href="#cb318-570" aria-hidden="true" tabindex="-1"></a><span class="co"># #DEFINE DATA </span></span>
<span id="cb318-571"><a href="#cb318-571" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_items %&gt;% mutate(</span></span>
<span id="cb318-572"><a href="#cb318-572" aria-hidden="true" tabindex="-1"></a><span class="co">#   scaled = factor(score_SCALED, ordered = TRUE,  #ordered factor</span></span>
<span id="cb318-573"><a href="#cb318-573" aria-hidden="true" tabindex="-1"></a><span class="co">#                     levels = c("-1", "-0.5", "0", "0.5","1"))</span></span>
<span id="cb318-574"><a href="#cb318-574" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb318-575"><a href="#cb318-575" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-576"><a href="#cb318-576" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-577"><a href="#cb318-577" aria-hidden="true" tabindex="-1"></a><span class="co"># # To specify an adjacent-category model, we use family = acat() instead of family = cumulative() as an argument to the brm() function. Then, to model condition with possible category-specific effects, we wrap this variable in cs() in the model’s formula:</span></span>
<span id="cb318-578"><a href="#cb318-578" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-579"><a href="#cb318-579" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_acat &lt;- brm( formula = scaled ~ cs(condition),</span></span>
<span id="cb318-580"><a href="#cb318-580" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = df,</span></span>
<span id="cb318-581"><a href="#cb318-581" aria-hidden="true" tabindex="-1"></a><span class="co">#                family = acat("probit"),</span></span>
<span id="cb318-582"><a href="#cb318-582" aria-hidden="true" tabindex="-1"></a><span class="co">#                file = "analysis/SGC3A/models/m_items_ord.acat.rds" # cache model (can be removed)  </span></span>
<span id="cb318-583"><a href="#cb318-583" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb318-584"><a href="#cb318-584" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-585"><a href="#cb318-585" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(ord_acat)</span></span>
<span id="cb318-586"><a href="#cb318-586" aria-hidden="true" tabindex="-1"></a><span class="co"># conditional_effects(ord_cum, "condition", categorical = TRUE)</span></span>
<span id="cb318-587"><a href="#cb318-587" aria-hidden="true" tabindex="-1"></a><span class="co"># conditional_effects(ord_acat, "condition", categorical = TRUE)</span></span>
<span id="cb318-588"><a href="#cb318-588" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-589"><a href="#cb318-589" aria-hidden="true" tabindex="-1"></a><span class="co"># #TIDYBAYES VISUALIZATION</span></span>
<span id="cb318-590"><a href="#cb318-590" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidybayes)</span></span>
<span id="cb318-591"><a href="#cb318-591" aria-hidden="true" tabindex="-1"></a><span class="co"># ord_acat %&gt;%</span></span>
<span id="cb318-592"><a href="#cb318-592" aria-hidden="true" tabindex="-1"></a><span class="co">#   spread_draws(b_Intercept, r_condition[condition,]) %&gt;%</span></span>
<span id="cb318-593"><a href="#cb318-593" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(condition_mean = b_Intercept + r_condition) %&gt;%</span></span>
<span id="cb318-594"><a href="#cb318-594" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = condition, x = condition_mean)) +</span></span>
<span id="cb318-595"><a href="#cb318-595" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye()</span></span>
<span id="cb318-596"><a href="#cb318-596" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-597"><a href="#cb318-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-598"><a href="#cb318-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-599"><a href="#cb318-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-600"><a href="#cb318-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-601"><a href="#cb318-601" aria-hidden="true" tabindex="-1"></a><span class="fu">## RESOURCES</span></span>
<span id="cb318-602"><a href="#cb318-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-603"><a href="#cb318-603" aria-hidden="true" tabindex="-1"></a>reset plot margins par(mar=c(1,1,1,1))</span>
<span id="cb318-604"><a href="#cb318-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-605"><a href="#cb318-605" aria-hidden="true" tabindex="-1"></a><span class="fu">### LOG REGRESISION NOTES</span></span>
<span id="cb318-606"><a href="#cb318-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-607"><a href="#cb318-607" aria-hidden="true" tabindex="-1"></a>**Understanding the logistic regression model**</span>
<span id="cb318-608"><a href="#cb318-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-609"><a href="#cb318-609" aria-hidden="true" tabindex="-1"></a>*The logistic regression intercept gives the log odds of the outcome for the reference level of the predictor variable*</span>
<span id="cb318-610"><a href="#cb318-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-611"><a href="#cb318-611" aria-hidden="true" tabindex="-1"></a>*The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.*</span>
<span id="cb318-612"><a href="#cb318-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-613"><a href="#cb318-613" aria-hidden="true" tabindex="-1"></a>**\[the empty model**</span>
<span id="cb318-614"><a href="#cb318-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-615"><a href="#cb318-615" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intercept of an empty model (glm(accuracy \~ 1) is equal to log(p/(1-p)), where p = the overall probability of a correct response (df\$accuracy ==1 ).</span>
<span id="cb318-616"><a href="#cb318-616" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In SGC3A Q1 accuracy this = 71 correct / 330 = 0.215 -<span class="sc">\&gt;</span> log(0.215 / (1-0.215)) = -1.29.</span>
<span id="cb318-617"><a href="#cb318-617" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In other words, the intercept from the model with no predictor variables is the estimated log odds of a correct response for the whole sample.</span>
<span id="cb318-618"><a href="#cb318-618" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We can also transform the log of the odds back to a probability: p = ODDS/ (1+ODDS) = exp(-1.29)/(1+exp(-1.29)) = 0.215. This should matched the prediction of the empty model</span>
<span id="cb318-619"><a href="#cb318-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-620"><a href="#cb318-620" aria-hidden="true" tabindex="-1"></a>**\[a dichotomous predictor\]**</span>
<span id="cb318-621"><a href="#cb318-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-622"><a href="#cb318-622" aria-hidden="true" tabindex="-1"></a>natural log (odds of +) = -1.822 + 0.9(x1) ; x1 = 0 for control, 1 for impasse</span>
<span id="cb318-623"><a href="#cb318-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-624"><a href="#cb318-624" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>INTERCEPT: log odds of (+ response) in control condition</span>
<span id="cb318-625"><a href="#cb318-625" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in control : -1.822 + 0.9(0) = -1.822</span>
<span id="cb318-626"><a href="#cb318-626" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating the coefficients\</span>
<span id="cb318-627"><a href="#cb318-627" aria-hidden="true" tabindex="-1"></a>        log odds of (+) in control = exp(-1.822) = 0.162 odds</span>
<span id="cb318-628"><a href="#cb318-628" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb318-629"><a href="#cb318-629" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1+odds) = 0.162 / (1 + 0.162) = 0.139\</span>
<span id="cb318-630"><a href="#cb318-630" aria-hidden="true" tabindex="-1"></a>        probability of (+) in control = \~14%</span>
<span id="cb318-631"><a href="#cb318-631" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>B1 COEFFICIENT: DIFFERENCE in log odds of (+) in impasse vs. control</span>
<span id="cb318-632"><a href="#cb318-632" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>log odds of (+) in impasse: -1.822 + 0.901 = -0.921</span>
<span id="cb318-633"><a href="#cb318-633" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to odds by exponentiating log odds\</span>
<span id="cb318-634"><a href="#cb318-634" aria-hidden="true" tabindex="-1"></a>        log odds (+) in impasse = exp(-0.921) = 0.398</span>
<span id="cb318-635"><a href="#cb318-635" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>convert to probability by formula =<span class="sc">\&gt;</span>\</span>
<span id="cb318-636"><a href="#cb318-636" aria-hidden="true" tabindex="-1"></a>        p(+) = odds / (1 + odds) = 0.398 / (1+0.398) = 0.285\</span>
<span id="cb318-637"><a href="#cb318-637" aria-hidden="true" tabindex="-1"></a>        probaility of (+) in impasse = \~ 29%</span>
<span id="cb318-638"><a href="#cb318-638" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ODDS RATIO : exponentiated B1 COEFFICIENT</span>
<span id="cb318-639"><a href="#cb318-639" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = (slope of logit model = difference in log odds = log odds ratio</span>
<span id="cb318-640"><a href="#cb318-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-641"><a href="#cb318-641" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>B1 = 0.901 is log odds ratio of (+) in impasse vs control</span>
<span id="cb318-642"><a href="#cb318-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-643"><a href="#cb318-643" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>exp(b1) = exp(0.901) = 2.46</span>
<span id="cb318-644"><a href="#cb318-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-645"><a href="#cb318-645" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Ratio of odds in impasse are 2.46 times higher than in control. Bein in the impasse condition yields odds athat are 2.46 X higher than in control.</span>
<span id="cb318-646"><a href="#cb318-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-647"><a href="#cb318-647" aria-hidden="true" tabindex="-1"></a>+:----------------------------------------------------------------------+</span>
<span id="cb318-648"><a href="#cb318-648" aria-hidden="true" tabindex="-1"></a>| MARGINAL\                                                             |</span>
<span id="cb318-649"><a href="#cb318-649" aria-hidden="true" tabindex="-1"></a>| total = 330 success : 71, failure : 259\                              |</span>
<span id="cb318-650"><a href="#cb318-650" aria-hidden="true" tabindex="-1"></a>| p(+) = 71 / 330 = 0.215 = 22%\                                        |</span>
<span id="cb318-651"><a href="#cb318-651" aria-hidden="true" tabindex="-1"></a>| odds(+) = 71 / 259 = 0.274                                            |</span>
<span id="cb318-652"><a href="#cb318-652" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb318-653"><a href="#cb318-653" aria-hidden="true" tabindex="-1"></a>| CONTROL total = 158 success = 22; failure = 136\                      |</span>
<span id="cb318-654"><a href="#cb318-654" aria-hidden="true" tabindex="-1"></a>| p(+) = 22/158 = 0.139 = 14%\                                          |</span>
<span id="cb318-655"><a href="#cb318-655" aria-hidden="true" tabindex="-1"></a>| odds(+) = 22/136 = 0.162                                              |</span>
<span id="cb318-656"><a href="#cb318-656" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb318-657"><a href="#cb318-657" aria-hidden="true" tabindex="-1"></a>| IMPASSE total = 172 success = 49; failure = 123\                      |</span>
<span id="cb318-658"><a href="#cb318-658" aria-hidden="true" tabindex="-1"></a>| p(+) = 49/172 = 0.285 = 29%\                                          |</span>
<span id="cb318-659"><a href="#cb318-659" aria-hidden="true" tabindex="-1"></a>| odds(+) = 49/123 = 0.398                                              |</span>
<span id="cb318-660"><a href="#cb318-660" aria-hidden="true" tabindex="-1"></a>+-----------------------------------------------------------------------+</span>
<span id="cb318-661"><a href="#cb318-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-662"><a href="#cb318-662" aria-hidden="true" tabindex="-1"></a><span class="fu">## WIP EXPLORING</span></span>
<span id="cb318-663"><a href="#cb318-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-664"><a href="#cb318-664" aria-hidden="true" tabindex="-1"></a><span class="fu">### Test Phase Accuracy</span></span>
<span id="cb318-665"><a href="#cb318-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-666"><a href="#cb318-666" aria-hidden="true" tabindex="-1"></a>**Test Phase Absolute Score (# questions)**</span>
<span id="cb318-667"><a href="#cb318-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-668"><a href="#cb318-668" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Linear Regression</span></span>
<span id="cb318-669"><a href="#cb318-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-670"><a href="#cb318-670" aria-hidden="true" tabindex="-1"></a>*LM on Test Phase absolute score **as number of questions**, rather than % correct.*</span>
<span id="cb318-671"><a href="#cb318-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-674"><a href="#cb318-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-675"><a href="#cb318-675" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION</span></span>
<span id="cb318-676"><a href="#cb318-676" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_subjects)</span>
<span id="cb318-677"><a href="#cb318-677" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb318-678"><a href="#cb318-678" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm<span class="fl">.1</span>)</span>
<span id="cb318-679"><a href="#cb318-679" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb318-680"><a href="#cb318-680" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span>
<span id="cb318-681"><a href="#cb318-681" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb318-682"><a href="#cb318-682" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm<span class="fl">.1</span>)</span>
<span id="cb318-683"><a href="#cb318-683" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(lm<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb318-684"><a href="#cb318-684" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm<span class="fl">.1</span>)</span>
<span id="cb318-685"><a href="#cb318-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-686"><a href="#cb318-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-689"><a href="#cb318-689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-690"><a href="#cb318-690" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VISMODEL-</span><span class="al">TEST</span><span class="co">-ABS-LAB</span></span>
<span id="cb318-691"><a href="#cb318-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-692"><a href="#cb318-692" aria-hidden="true" tabindex="-1"></a><span class="co">#MODEL ESTIMATES WITH UNCERTAINTY</span></span>
<span id="cb318-693"><a href="#cb318-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-694"><a href="#cb318-694" aria-hidden="true" tabindex="-1"></a><span class="co"># #setup references </span></span>
<span id="cb318-695"><a href="#cb318-695" aria-hidden="true" tabindex="-1"></a><span class="co"># m &lt;- lm.1</span></span>
<span id="cb318-696"><a href="#cb318-696" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df_subjects</span></span>
<span id="cb318-697"><a href="#cb318-697" aria-hidden="true" tabindex="-1"></a><span class="co"># call &lt;- m$call %&gt;% as.character()</span></span>
<span id="cb318-698"><a href="#cb318-698" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-699"><a href="#cb318-699" aria-hidden="true" tabindex="-1"></a><span class="co"># # uncertainty model visualization</span></span>
<span id="cb318-700"><a href="#cb318-700" aria-hidden="true" tabindex="-1"></a><span class="co"># df  %&gt;%</span></span>
<span id="cb318-701"><a href="#cb318-701" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition) %&gt;%</span></span>
<span id="cb318-702"><a href="#cb318-702" aria-hidden="true" tabindex="-1"></a><span class="co">#   augment(lm.1, newdata = ., se_fit = TRUE) %&gt;% </span></span>
<span id="cb318-703"><a href="#cb318-703" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = pretty_condition, color = pretty_condition)) </span></span>
<span id="cb318-704"><a href="#cb318-704" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-705"><a href="#cb318-705" aria-hidden="true" tabindex="-1"></a><span class="co"># +</span></span>
<span id="cb318-706"><a href="#cb318-706" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_halfeye( scale = .5,</span></span>
<span id="cb318-707"><a href="#cb318-707" aria-hidden="true" tabindex="-1"></a><span class="co">#       aes(</span></span>
<span id="cb318-708"><a href="#cb318-708" aria-hidden="true" tabindex="-1"></a><span class="co">#         xdist = dist_student_t(df = df.residual(m), mu = .fitted, sigma = .se.fit),</span></span>
<span id="cb318-709"><a href="#cb318-709" aria-hidden="true" tabindex="-1"></a><span class="co">#         fill = stat(cut_cdf_qi(cdf, </span></span>
<span id="cb318-710"><a href="#cb318-710" aria-hidden="true" tabindex="-1"></a><span class="co">#                 .width = c(.90, .95),</span></span>
<span id="cb318-711"><a href="#cb318-711" aria-hidden="true" tabindex="-1"></a><span class="co">#                 labels = scales::percent_format())))) +</span></span>
<span id="cb318-712"><a href="#cb318-712" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_brewer(direction = -1) + </span></span>
<span id="cb318-713"><a href="#cb318-713" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs (title = "(LAB) Test Phase Accuracy ~ Condition", </span></span>
<span id="cb318-714"><a href="#cb318-714" aria-hidden="true" tabindex="-1"></a><span class="co">#         x = "model predicted mean (% correct)", y = "Condition", fill = "Interval",</span></span>
<span id="cb318-715"><a href="#cb318-715" aria-hidden="true" tabindex="-1"></a><span class="co">#         subtitle = paste("lm(",call[2],")")</span></span>
<span id="cb318-716"><a href="#cb318-716" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + theme(legend.position = "blank")</span></span>
<span id="cb318-717"><a href="#cb318-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-718"><a href="#cb318-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-719"><a href="#cb318-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-720"><a href="#cb318-720" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Poisson Regression TODO</span></span>
<span id="cb318-721"><a href="#cb318-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-722"><a href="#cb318-722" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/poisson-regression/</span>
<span id="cb318-723"><a href="#cb318-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-724"><a href="#cb318-724" aria-hidden="true" tabindex="-1"></a>The outcome variable absolute score is clearly not normal. As it represents the cumulative number of items a participant has answered correctly, we can consider it a type of *count*, (ie. count of the number of questions the participant got correct) and attempt to model it using a General Linear Model with the Poisson distribution (and the default log-link function).</span>
<span id="cb318-725"><a href="#cb318-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-728"><a href="#cb318-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-729"><a href="#cb318-729" aria-hidden="true" tabindex="-1"></a><span class="co">#POISSON</span></span>
<span id="cb318-730"><a href="#cb318-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-731"><a href="#cb318-731" aria-hidden="true" tabindex="-1"></a><span class="co">#SCORE predicted by CONDITION --&gt; POISSON DISTRIBUTION</span></span>
<span id="cb318-732"><a href="#cb318-732" aria-hidden="true" tabindex="-1"></a>p<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_subjects, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb318-733"><a href="#cb318-733" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb318-734"><a href="#cb318-734" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(p<span class="fl">.1</span>)</span>
<span id="cb318-735"><a href="#cb318-735" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Partition Variance"</span>)</span>
<span id="cb318-736"><a href="#cb318-736" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(p<span class="fl">.1</span>)</span>
<span id="cb318-737"><a href="#cb318-737" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Confidence Interval on Parameter Estimates"</span>)</span>
<span id="cb318-738"><a href="#cb318-738" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(p<span class="fl">.1</span>)</span>
<span id="cb318-739"><a href="#cb318-739" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(p<span class="fl">.1</span>) <span class="co">#sanity check</span></span>
<span id="cb318-740"><a href="#cb318-740" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(p<span class="fl">.1</span>)</span>
<span id="cb318-741"><a href="#cb318-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-742"><a href="#cb318-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-743"><a href="#cb318-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-744"><a href="#cb318-744" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zero Inflated Poisson</span></span>
<span id="cb318-745"><a href="#cb318-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-746"><a href="#cb318-746" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/zip/\</span>
<span id="cb318-747"><a href="#cb318-747" aria-hidden="true" tabindex="-1"></a>Poisson count process with excess zeros</span>
<span id="cb318-748"><a href="#cb318-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-751"><a href="#cb318-751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-752"><a href="#cb318-752" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED POISSON</span></span>
<span id="cb318-753"><a href="#cb318-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-754"><a href="#cb318-754" aria-hidden="true" tabindex="-1"></a>zinfp<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(item_test_NABS <span class="sc">~</span>  item_q1_rt<span class="sc">|</span> pretty_condition , <span class="at">data =</span> df_subjects)</span>
<span id="cb318-755"><a href="#cb318-755" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb318-756"><a href="#cb318-756" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb318-757"><a href="#cb318-757" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinfp<span class="fl">.1</span>)</span>
<span id="cb318-758"><a href="#cb318-758" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(zinfp.1)</span></span>
<span id="cb318-759"><a href="#cb318-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-760"><a href="#cb318-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-761"><a href="#cb318-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-762"><a href="#cb318-762" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Negative Binomial Regression</span></span>
<span id="cb318-763"><a href="#cb318-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-764"><a href="#cb318-764" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/ - overdispersed count data (variance much greater than mean)</span>
<span id="cb318-765"><a href="#cb318-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-768"><a href="#cb318-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-769"><a href="#cb318-769" aria-hidden="true" tabindex="-1"></a><span class="co">#NEGATIVE BIONOMIAL REGRESSION</span></span>
<span id="cb318-770"><a href="#cb318-770" aria-hidden="true" tabindex="-1"></a><span class="co"># - https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/</span></span>
<span id="cb318-771"><a href="#cb318-771" aria-hidden="true" tabindex="-1"></a><span class="co"># - Overdispersed Count variables</span></span>
<span id="cb318-772"><a href="#cb318-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-773"><a href="#cb318-773" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb318-774"><a href="#cb318-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-775"><a href="#cb318-775" aria-hidden="true" tabindex="-1"></a>nb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_subjects)</span>
<span id="cb318-776"><a href="#cb318-776" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb<span class="fl">.1</span>)</span>
<span id="cb318-777"><a href="#cb318-777" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(nb<span class="fl">.1</span>)</span>
<span id="cb318-778"><a href="#cb318-778" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(nb<span class="fl">.1</span>)</span>
<span id="cb318-779"><a href="#cb318-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-780"><a href="#cb318-780" aria-hidden="true" tabindex="-1"></a><span class="co">#check model assumption</span></span>
<span id="cb318-781"><a href="#cb318-781" aria-hidden="true" tabindex="-1"></a><span class="co">#assumes conditional means are not equal to conditional variances</span></span>
<span id="cb318-782"><a href="#cb318-782" aria-hidden="true" tabindex="-1"></a><span class="co">#conduct likelihood ration test to compare and test [need poisson]</span></span>
<span id="cb318-783"><a href="#cb318-783" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(item_test_NABS <span class="sc">~</span> pretty_condition, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> df_subjects)</span>
<span id="cb318-784"><a href="#cb318-784" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(nb<span class="fl">.1</span>) <span class="sc">-</span> <span class="fu">logLik</span>(m3)), <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb318-785"><a href="#cb318-785" aria-hidden="true" tabindex="-1"></a><span class="co">#A large (+) log likelihood suggests that the negative binomial is more appropriate than the Poisson model</span></span>
<span id="cb318-786"><a href="#cb318-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-787"><a href="#cb318-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-788"><a href="#cb318-788" aria-hidden="true" tabindex="-1"></a><span class="co">#EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb318-789"><a href="#cb318-789" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Estimate =</span> <span class="fu">coef</span>(nb<span class="fl">.1</span>), <span class="fu">confint</span>(nb<span class="fl">.1</span>))</span>
<span id="cb318-790"><a href="#cb318-790" aria-hidden="true" tabindex="-1"></a><span class="co">#exponentiate parameter estimates</span></span>
<span id="cb318-791"><a href="#cb318-791" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Exponentiated Estimates"</span>)</span>
<span id="cb318-792"><a href="#cb318-792" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(est)</span>
<span id="cb318-793"><a href="#cb318-793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-794"><a href="#cb318-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-795"><a href="#cb318-795" aria-hidden="true" tabindex="-1"></a>The variable condition has a coefficient of 0.67, (p <span class="sc">\&lt;</span> 0.005). This means that for the impasse condition, the expected log count <span class="sc">\#</span> of questions increases by 0.67. By exponentiating the estimate we see that <span class="sc">\#</span> question correct rate for the impasse condition is nearly 2x that of the control condition.</span>
<span id="cb318-796"><a href="#cb318-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-797"><a href="#cb318-797" aria-hidden="true" tabindex="-1"></a>**Diagnostics** ??</span>
<span id="cb318-798"><a href="#cb318-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-799"><a href="#cb318-799" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zero Inflated Negative Binomial Regression</span></span>
<span id="cb318-800"><a href="#cb318-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-801"><a href="#cb318-801" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/zinb/ count data that are overdispersed and have excess zeros</span>
<span id="cb318-802"><a href="#cb318-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-803"><a href="#cb318-803" aria-hidden="true" tabindex="-1"></a>Zero-inflated negative binomial regression is for modelling count variables with excessive zeros, and especially when the count data are overdispersed (mean is much larger than variance). It can help account for situations where theory suggests that excess zeros are generated by 2 separate processes, one that includes the other count values, and the other that is just the zeros, and thus that the *excess* zeros can be modelled independently.</span>
<span id="cb318-804"><a href="#cb318-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-805"><a href="#cb318-805" aria-hidden="true" tabindex="-1"></a>Total Absolute Score (# items correct) may fit this situation, as the data are overdispersed (variance much greater than the mean) and there are are very large number of zeros. It is theoretically plausible that these excess zeros (no answers correct) are the result of a different 'process' ... (i.e) little understanding and/or resistance to restructuring understanding of the coordinate system. However, I am not certain if it is plausible to suggest that the zeros themselves are the result of two different processes: (ie. perhaps trying to understand, and not trying to understand?) <span class="sc">\&lt;</span>- this could maybe be disentangled by first question latency?</span>
<span id="cb318-806"><a href="#cb318-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-807"><a href="#cb318-807" aria-hidden="true" tabindex="-1"></a>The model includes: - A logistic model to model which of the two processes the zero outcome is associated with - A negative binomial model to model the count process</span>
<span id="cb318-808"><a href="#cb318-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-811"><a href="#cb318-811" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-812"><a href="#cb318-812" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TESTABS-ZINFNEGBINOM</span></span>
<span id="cb318-813"><a href="#cb318-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-814"><a href="#cb318-814" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#  for zeroinfl negbinomial</span></span>
<span id="cb318-815"><a href="#cb318-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-816"><a href="#cb318-816" aria-hidden="true" tabindex="-1"></a><span class="co">#ZERO INFLATED NEGATIVE BINOMIAL</span></span>
<span id="cb318-817"><a href="#cb318-817" aria-hidden="true" tabindex="-1"></a>zinb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(item_test_NABS <span class="sc">~</span> pretty_condition <span class="sc">|</span> pretty_condition , <span class="at">data =</span> df_subjects, <span class="at">dist =</span> <span class="st">"negbin"</span>)</span>
<span id="cb318-818"><a href="#cb318-818" aria-hidden="true" tabindex="-1"></a><span class="co">#before the | is the count part, after the | is the logit model</span></span>
<span id="cb318-819"><a href="#cb318-819" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Model"</span>)</span>
<span id="cb318-820"><a href="#cb318-820" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb318-821"><a href="#cb318-821" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb318-822"><a href="#cb318-822" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(zinb<span class="fl">.1</span>)</span>
<span id="cb318-823"><a href="#cb318-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-824"><a href="#cb318-824" aria-hidden="true" tabindex="-1"></a><span class="co">#   rootogram(zinb.1)</span></span>
<span id="cb318-825"><a href="#cb318-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-826"><a href="#cb318-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-827"><a href="#cb318-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-828"><a href="#cb318-828" aria-hidden="true" tabindex="-1"></a><span class="co"># #EXPONENTIATE PARAMETER ESTIMATES</span></span>
<span id="cb318-829"><a href="#cb318-829" aria-hidden="true" tabindex="-1"></a><span class="co"># est &lt;- cbind(Estimate = coef(zinb.1), confint(zinb.1))</span></span>
<span id="cb318-830"><a href="#cb318-830" aria-hidden="true" tabindex="-1"></a><span class="co"># #exponentiate parameter estimates</span></span>
<span id="cb318-831"><a href="#cb318-831" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Exponentiated Estimates")</span></span>
<span id="cb318-832"><a href="#cb318-832" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(est)</span></span>
<span id="cb318-833"><a href="#cb318-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-834"><a href="#cb318-834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-835"><a href="#cb318-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-836"><a href="#cb318-836" aria-hidden="true" tabindex="-1"></a>In the count model, the coefficient for the condition is very small, and not significant (suggesting it does not contribute to the count yielding process?).</span>
<span id="cb318-837"><a href="#cb318-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-838"><a href="#cb318-838" aria-hidden="true" tabindex="-1"></a>In the zero-inflation model, the coefficient for the condition variable is -1.056 and statistically significant. This suggests that the log odds of being an excessive zero decrease by 1.06 if you are in the impasse condition (exponentiate it?)</span>
<span id="cb318-839"><a href="#cb318-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-840"><a href="#cb318-840" aria-hidden="true" tabindex="-1"></a>**TODO come back to this and discuss further**\</span>
<span id="cb318-841"><a href="#cb318-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-842"><a href="#cb318-842" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Comparison</span></span>
<span id="cb318-843"><a href="#cb318-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-846"><a href="#cb318-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-847"><a href="#cb318-847" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(lm<span class="fl">.1</span>, p<span class="fl">.1</span>, nb<span class="fl">.1</span>, zinb<span class="fl">.1</span>)</span>
<span id="cb318-848"><a href="#cb318-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-849"><a href="#cb318-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-850"><a href="#cb318-850" aria-hidden="true" tabindex="-1"></a>For modelling test phase absolute score (# items correct) it seems that the zero inflated negative binomial model is the best fit according to R2 and AIC, however, I am not clear on the implications of the interpretation (non significant in count process, significant on logit process), and also not clear if <span class="sc">\#</span> items correct is truly a count process.</span>
<span id="cb318-851"><a href="#cb318-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-854"><a href="#cb318-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-855"><a href="#cb318-855" aria-hidden="true" tabindex="-1"></a><span class="co">#uncertainty model visualization</span></span>
<span id="cb318-856"><a href="#cb318-856" aria-hidden="true" tabindex="-1"></a><span class="co"># df %&gt;%</span></span>
<span id="cb318-857"><a href="#cb318-857" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data_grid(pretty_condition) %&gt;%</span></span>
<span id="cb318-858"><a href="#cb318-858" aria-hidden="true" tabindex="-1"></a>  <span class="co"># augment(m, newdata = ., se_fit = TRUE) %&gt;%</span></span>
<span id="cb318-859"><a href="#cb318-859" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot(aes(y = pretty_condition)) +</span></span>
<span id="cb318-860"><a href="#cb318-860" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_halfeye(</span></span>
<span id="cb318-861"><a href="#cb318-861" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   aes(xdist = dist_student_t(df = df.residual(m), </span></span>
<span id="cb318-862"><a href="#cb318-862" aria-hidden="true" tabindex="-1"></a>  <span class="co">#       mu = .fitted, sigma = .se.fit)), scale = .5) +</span></span>
<span id="cb318-863"><a href="#cb318-863" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # add raw data in too (scale = .5 above adjusts the halfeye height so</span></span>
<span id="cb318-864"><a href="#cb318-864" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # that the data fit in as well)</span></span>
<span id="cb318-865"><a href="#cb318-865" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_jitter(aes(x = x), data = df, pch = "|", size = 2, </span></span>
<span id="cb318-866"><a href="#cb318-866" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             position =   position_nudge(y = -.15), alpha = 0.5) +  </span></span>
<span id="cb318-867"><a href="#cb318-867" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs (title = "Model Estimates with Uncertainty", x = "model coefficient") + </span></span>
<span id="cb318-868"><a href="#cb318-868" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb318-869"><a href="#cb318-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-870"><a href="#cb318-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-871"><a href="#cb318-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-872"><a href="#cb318-872" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hurdle Beta Regression</span></span>
<span id="cb318-873"><a href="#cb318-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-874"><a href="#cb318-874" aria-hidden="true" tabindex="-1"></a>https://github.com/markhwhiteii/beta_hurdle/blob/master/manuscript/beta_hurdle.pdf</span>
<span id="cb318-875"><a href="#cb318-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-878"><a href="#cb318-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-879"><a href="#cb318-879" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span>
<span id="cb318-880"><a href="#cb318-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-881"><a href="#cb318-881" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE SAMPLE DATA </span></span>
<span id="cb318-882"><a href="#cb318-882" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> </span>
<span id="cb318-883"><a href="#cb318-883" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">0.40</span> </span>
<span id="cb318-884"><a href="#cb318-884" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.60</span> </span>
<span id="cb318-885"><a href="#cb318-885" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.13</span> </span>
<span id="cb318-886"><a href="#cb318-886" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.17</span> </span>
<span id="cb318-887"><a href="#cb318-887" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> p0<span class="sc">-</span> p1</span>
<span id="cb318-888"><a href="#cb318-888" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> mu <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> sigma <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> (sigma <span class="sc">^</span> <span class="dv">2</span>) </span>
<span id="cb318-889"><a href="#cb318-889" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> mu) <span class="sc">/</span> mu</span>
<span id="cb318-890"><a href="#cb318-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-891"><a href="#cb318-891" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE DIST</span></span>
<span id="cb318-892"><a href="#cb318-892" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1839</span>) </span>
<span id="cb318-893"><a href="#cb318-893" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, a, b) </span>
<span id="cb318-894"><a href="#cb318-894" aria-hidden="true" tabindex="-1"></a>cat <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, n, <span class="at">prob =</span> <span class="fu">c</span>(p0, p2, p1), <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb318-895"><a href="#cb318-895" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb318-896"><a href="#cb318-896" aria-hidden="true" tabindex="-1"></a>y[cat <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb318-897"><a href="#cb318-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-898"><a href="#cb318-898" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb318-899"><a href="#cb318-899" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y)</span>
<span id="cb318-900"><a href="#cb318-900" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>x<span class="sc">$</span>y)</span>
<span id="cb318-901"><a href="#cb318-901" aria-hidden="true" tabindex="-1"></a><span class="co">#this looks not unlike my distribution! </span></span>
<span id="cb318-902"><a href="#cb318-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-903"><a href="#cb318-903" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb318-904"><a href="#cb318-904" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb318-905"><a href="#cb318-905" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.sigma =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb318-906"><a href="#cb318-906" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.nu =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb318-907"><a href="#cb318-907" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula.tau =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb318-908"><a href="#cb318-908" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">BEINF</span>() )</span>
<span id="cb318-909"><a href="#cb318-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-910"><a href="#cb318-910" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb318-911"><a href="#cb318-911" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span>
<span id="cb318-912"><a href="#cb318-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-913"><a href="#cb318-913" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb318-914"><a href="#cb318-914" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb318-915"><a href="#cb318-915" aria-hidden="true" tabindex="-1"></a>fit_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>mu.coefficients) </span>
<span id="cb318-916"><a href="#cb318-916" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,fit_mu)</span>
<span id="cb318-917"><a href="#cb318-917" aria-hidden="true" tabindex="-1"></a>fit_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(fit<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb318-918"><a href="#cb318-918" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,fit_sigma)</span>
<span id="cb318-919"><a href="#cb318-919" aria-hidden="true" tabindex="-1"></a>fit_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>nu.coefficients) </span>
<span id="cb318-920"><a href="#cb318-920" aria-hidden="true" tabindex="-1"></a>fit_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit<span class="sc">$</span>tau.coefficients) </span>
<span id="cb318-921"><a href="#cb318-921" aria-hidden="true" tabindex="-1"></a>fit_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb318-922"><a href="#cb318-922" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,fit_p0)</span>
<span id="cb318-923"><a href="#cb318-923" aria-hidden="true" tabindex="-1"></a>fit_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb318-924"><a href="#cb318-924" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,fit_p1)</span>
<span id="cb318-925"><a href="#cb318-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-926"><a href="#cb318-926" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-927"><a href="#cb318-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-928"><a href="#cb318-928" aria-hidden="true" tabindex="-1"></a>**BETA HURDLE INTERPRETATION** - beta component\</span>
<span id="cb318-929"><a href="#cb318-929" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MU "location" (mean)\</span>
<span id="cb318-930"><a href="#cb318-930" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SIGMA "scale" (positively related to variance; variance = sigma.squared *mean* (1-mean)\</span>
<span id="cb318-931"><a href="#cb318-931" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rigby, Stasinopoulos, Heller, and De Bastiani (2017) "reparameterized" the beta distribution so that the two parameters determining the shape of the distribution would be more useful in a regression framework (see Ferrari &amp; Cribari-Neto, 2004 for a different parameterization)</span>
<span id="cb318-932"><a href="#cb318-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-933"><a href="#cb318-933" aria-hidden="true" tabindex="-1"></a>**ZERO-ONE HURDLE COMPONENT**\</span>
<span id="cb318-934"><a href="#cb318-934" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The two additional parameters, ν NU and τTAU , are related to p0 and p1, respectively.\</span>
<span id="cb318-935"><a href="#cb318-935" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p0 is the probability that a case equals 0,\</span>
<span id="cb318-936"><a href="#cb318-936" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p1 is the probability that a case equals 1,\</span>
<span id="cb318-937"><a href="#cb318-937" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p2 (i.e., 1 −p0 −p1) is the probability that the case comes from the beta distribution</span>
<span id="cb318-938"><a href="#cb318-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-941"><a href="#cb318-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-942"><a href="#cb318-942" aria-hidden="true" tabindex="-1"></a><span class="co">#SETUP DATA </span></span>
<span id="cb318-943"><a href="#cb318-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-944"><a href="#cb318-944" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> <span class="dv">0</span> <span class="co">#min possible value of scale</span></span>
<span id="cb318-945"><a href="#cb318-945" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="dv">8</span> <span class="co">#max possible value of scale</span></span>
<span id="cb318-946"><a href="#cb318-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-947"><a href="#cb318-947" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#for shuffling</span></span>
<span id="cb318-948"><a href="#cb318-948" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Rescale accuracy using </span></span>
<span id="cb318-949"><a href="#cb318-949" aria-hidden="true" tabindex="-1"></a><span class="co"># recommended adjustment </span></span>
<span id="cb318-950"><a href="#cb318-950" aria-hidden="true" tabindex="-1"></a><span class="co">#rescaled = value-min/(max-min)</span></span>
<span id="cb318-951"><a href="#cb318-951" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb318-952"><a href="#cb318-952" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> item_test_NABS,</span>
<span id="cb318-953"><a href="#cb318-953" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_acc =</span> (accuracy<span class="sc">-</span>min)<span class="sc">/</span>(max<span class="sc">-</span>min), <span class="co">#as %</span></span>
<span id="cb318-954"><a href="#cb318-954" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_acc =</span> (accuracy <span class="sc">*</span> (<span class="fu">nrow</span>(df)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">8</span>, <span class="co">#transform for no 0 and 1</span></span>
<span id="cb318-955"><a href="#cb318-955" aria-hidden="true" tabindex="-1"></a>  <span class="at">perm =</span> <span class="fu">shuffle</span>(condition),</span>
<span id="cb318-956"><a href="#cb318-956" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_rt =</span> item_scaffold_rt</span>
<span id="cb318-957"><a href="#cb318-957" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy,R_acc, T_acc, condition, perm,scaffold_rt)</span>
<span id="cb318-958"><a href="#cb318-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-959"><a href="#cb318-959" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb318-960"><a href="#cb318-960" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of accuracy"</span>)</span>
<span id="cb318-961"><a href="#cb318-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-962"><a href="#cb318-962" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE DISTRIBUTION</span></span>
<span id="cb318-963"><a href="#cb318-963" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>T_acc, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of [rescaled] accuracy"</span>)</span>
<span id="cb318-964"><a href="#cb318-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-965"><a href="#cb318-965" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>R_acc, <span class="at">fill =</span> <span class="sc">~</span>perm, <span class="at">data =</span> df) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>perm) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of shuffled accuracy"</span>)</span>
<span id="cb318-966"><a href="#cb318-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-967"><a href="#cb318-967" aria-hidden="true" tabindex="-1"></a><span class="co">#SUMMARIZE SAMPLE</span></span>
<span id="cb318-968"><a href="#cb318-968" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Grand mean"</span>, <span class="fu">mean</span>(df<span class="sc">$</span>R_acc))</span>
<span id="cb318-969"><a href="#cb318-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-970"><a href="#cb318-970" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb318-971"><a href="#cb318-971" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> <span class="fu">favstats</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb318-972"><a href="#cb318-972" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb318-973"><a href="#cb318-973" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">var</span>(df<span class="sc">$</span>R_acc <span class="sc">~</span> df<span class="sc">$</span>condition)</span>
<span id="cb318-974"><a href="#cb318-974" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Grand stats"</span>)</span>
<span id="cb318-975"><a href="#cb318-975" aria-hidden="true" tabindex="-1"></a>stats </span>
<span id="cb318-976"><a href="#cb318-976" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P0"</span>)</span>
<span id="cb318-977"><a href="#cb318-977" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">0</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb318-978"><a href="#cb318-978" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"P1"</span>)</span>
<span id="cb318-979"><a href="#cb318-979" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(R_acc <span class="sc">==</span><span class="dv">1</span>))<span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb318-980"><a href="#cb318-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-981"><a href="#cb318-981" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb318-982"><a href="#cb318-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-983"><a href="#cb318-983" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE AN EMPTY MODEL</span></span>
<span id="cb318-984"><a href="#cb318-984" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( <span class="at">formula =</span> R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for mu </span></span>
<span id="cb318-985"><a href="#cb318-985" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.sigma =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for sigma </span></span>
<span id="cb318-986"><a href="#cb318-986" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.nu =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for nu </span></span>
<span id="cb318-987"><a href="#cb318-987" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula.tau =</span>  <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula for tau </span></span>
<span id="cb318-988"><a href="#cb318-988" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">BEINF</span>(), <span class="at">data =</span> df )</span>
<span id="cb318-989"><a href="#cb318-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-990"><a href="#cb318-990" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb318-991"><a href="#cb318-991" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb318-992"><a href="#cb318-992" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m0)</span>
<span id="cb318-993"><a href="#cb318-993" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m0)</span>
<span id="cb318-994"><a href="#cb318-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-995"><a href="#cb318-995" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb318-996"><a href="#cb318-996" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb318-997"><a href="#cb318-997" aria-hidden="true" tabindex="-1"></a>m0_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>mu.coefficients) </span>
<span id="cb318-998"><a href="#cb318-998" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m0_mu)</span>
<span id="cb318-999"><a href="#cb318-999" aria-hidden="true" tabindex="-1"></a>m0_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb318-1000"><a href="#cb318-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m0_sigma)</span>
<span id="cb318-1001"><a href="#cb318-1001" aria-hidden="true" tabindex="-1"></a>m0_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>nu.coefficients) </span>
<span id="cb318-1002"><a href="#cb318-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m0_nu)</span>
<span id="cb318-1003"><a href="#cb318-1003" aria-hidden="true" tabindex="-1"></a>m0_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m0<span class="sc">$</span>tau.coefficients) </span>
<span id="cb318-1004"><a href="#cb318-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m0_tau)</span>
<span id="cb318-1005"><a href="#cb318-1005" aria-hidden="true" tabindex="-1"></a>m0_p0 <span class="ot">&lt;-</span> fit_nu <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau) </span>
<span id="cb318-1006"><a href="#cb318-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P0: "</span>,m0_p0)</span>
<span id="cb318-1007"><a href="#cb318-1007" aria-hidden="true" tabindex="-1"></a>m0_p1 <span class="ot">&lt;-</span> fit_tau <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> fit_nu <span class="sc">+</span> fit_tau)</span>
<span id="cb318-1008"><a href="#cb318-1008" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"P1: "</span>,m0_p1)</span>
<span id="cb318-1009"><a href="#cb318-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1010"><a href="#cb318-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1011"><a href="#cb318-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1012"><a href="#cb318-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL</span></span>
<span id="cb318-1013"><a href="#cb318-1013" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, </span>
<span id="cb318-1014"><a href="#cb318-1014" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb318-1015"><a href="#cb318-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb318-1016"><a href="#cb318-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1017"><a href="#cb318-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#LOOKING PREDICTOR MODEL</span></span>
<span id="cb318-1018"><a href="#cb318-1018" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> condition , </span>
<span id="cb318-1019"><a href="#cb318-1019" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb318-1020"><a href="#cb318-1020" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb318-1021"><a href="#cb318-1021" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> condition , </span>
<span id="cb318-1022"><a href="#cb318-1022" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb318-1023"><a href="#cb318-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb318-1024"><a href="#cb318-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1025"><a href="#cb318-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1026"><a href="#cb318-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE PREDICTOR MODEL ON SHUFFLED [PERMUTATION </span><span class="al">TEST</span><span class="co">]</span></span>
<span id="cb318-1027"><a href="#cb318-1027" aria-hidden="true" tabindex="-1"></a>mperm <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(R_acc <span class="sc">~</span> perm, <span class="sc">~</span> perm, <span class="sc">~</span> perm, <span class="sc">~</span> perm, </span>
<span id="cb318-1028"><a href="#cb318-1028" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb318-1029"><a href="#cb318-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mperm)</span>
<span id="cb318-1030"><a href="#cb318-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1031"><a href="#cb318-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#sanity check with scaled outcome, no zeros ones</span></span>
<span id="cb318-1032"><a href="#cb318-1032" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(T_acc <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, <span class="sc">~</span> condition, </span>
<span id="cb318-1033"><a href="#cb318-1033" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">BEINF</span>())</span>
<span id="cb318-1034"><a href="#cb318-1034" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span>
<span id="cb318-1035"><a href="#cb318-1035" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 shouldn't show condition as significant for nu and tau, because T_acc was scaled to not include any 0s and 1s</span></span>
<span id="cb318-1036"><a href="#cb318-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1037"><a href="#cb318-1037" aria-hidden="true" tabindex="-1"></a><span class="co">#investigate beta negative binomial distribution</span></span>
<span id="cb318-1038"><a href="#cb318-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution</span></span>
<span id="cb318-1039"><a href="#cb318-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1040"><a href="#cb318-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#TRANSFORM PARAMETRS BACK </span></span>
<span id="cb318-1041"><a href="#cb318-1041" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="co"># inverse of link function</span></span>
<span id="cb318-1042"><a href="#cb318-1042" aria-hidden="true" tabindex="-1"></a>m1_mu <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m1<span class="sc">$</span>mu.coefficients) </span>
<span id="cb318-1043"><a href="#cb318-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MU: "</span>,m1_mu)</span>
<span id="cb318-1044"><a href="#cb318-1044" aria-hidden="true" tabindex="-1"></a>m1_sigma <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(m0<span class="sc">$</span>sigma.coefficients) </span>
<span id="cb318-1045"><a href="#cb318-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"SIGMA: "</span>,m1_sigma)</span>
<span id="cb318-1046"><a href="#cb318-1046" aria-hidden="true" tabindex="-1"></a>m1_nu <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>nu.coefficients) </span>
<span id="cb318-1047"><a href="#cb318-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"NU: "</span>,m1_nu)</span>
<span id="cb318-1048"><a href="#cb318-1048" aria-hidden="true" tabindex="-1"></a>m1_tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>tau.coefficients) </span>
<span id="cb318-1049"><a href="#cb318-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"TAU: "</span>,m1_tau)</span>
<span id="cb318-1050"><a href="#cb318-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1051"><a href="#cb318-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb318-1052"><a href="#cb318-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span>
<span id="cb318-1053"><a href="#cb318-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1054"><a href="#cb318-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1055"><a href="#cb318-1055" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1056"><a href="#cb318-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1057"><a href="#cb318-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MU tells if mean is different by condition\</span>
<span id="cb318-1058"><a href="#cb318-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SIGMA tells if variance is different by condition\</span>
<span id="cb318-1059"><a href="#cb318-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NU coefficient tells if condition yields different probability at floor</span>
<span id="cb318-1060"><a href="#cb318-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAU coefficient tells if condition yields different probability at ceiling</span>
<span id="cb318-1061"><a href="#cb318-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1062"><a href="#cb318-1062" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Beta Regression (% Correct)</span></span>
<span id="cb318-1063"><a href="#cb318-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1064"><a href="#cb318-1064" aria-hidden="true" tabindex="-1"></a>Beta regression on % correct (with standard transformation for including <span class="sc">\[</span>0,1<span class="sc">\]</span>) https://stats.stackexchange.com/questions/63350/how-to-interpret-the-coefficients-from-a-beta-regression</span>
<span id="cb318-1065"><a href="#cb318-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1068"><a href="#cb318-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1069"><a href="#cb318-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-1070"><a href="#cb318-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg)</span>
<span id="cb318-1071"><a href="#cb318-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1072"><a href="#cb318-1072" aria-hidden="true" tabindex="-1"></a><span class="co">#RESCLAE VARIABLE</span></span>
<span id="cb318-1073"><a href="#cb318-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#beta reg can't handle 0s and 1s </span></span>
<span id="cb318-1074"><a href="#cb318-1074" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(condition, DV_percent_NABS)</span>
<span id="cb318-1075"><a href="#cb318-1075" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(sub) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb318-1076"><a href="#cb318-1076" aria-hidden="true" tabindex="-1"></a>sub<span class="sc">$</span>dv_transformed <span class="ot">=</span> (sub<span class="sc">$</span>DV_percent_NABS <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fl">0.5</span>)<span class="sc">/</span>n</span>
<span id="cb318-1077"><a href="#cb318-1077" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb318-1078"><a href="#cb318-1078" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZE VARIABLES</span></span>
<span id="cb318-1079"><a href="#cb318-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(sub<span class="sc">$</span>dv_transformed)</span>
<span id="cb318-1080"><a href="#cb318-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>dv_transformed, <span class="at">fill =</span> <span class="sc">~</span>condition, <span class="at">data =</span> sub) <span class="sc">%&gt;%</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span>condition)</span>
<span id="cb318-1081"><a href="#cb318-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1082"><a href="#cb318-1082" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT MODEL</span></span>
<span id="cb318-1083"><a href="#cb318-1083" aria-hidden="true" tabindex="-1"></a>mb <span class="ot">&lt;-</span> <span class="fu">betareg</span>(dv_transformed <span class="sc">~</span> condition, <span class="at">data =</span> sub)</span>
<span id="cb318-1084"><a href="#cb318-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mb)</span>
<span id="cb318-1085"><a href="#cb318-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mb)</span>
<span id="cb318-1086"><a href="#cb318-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1087"><a href="#cb318-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1088"><a href="#cb318-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1089"><a href="#cb318-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TOBIT Regression</span></span>
<span id="cb318-1090"><a href="#cb318-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1091"><a href="#cb318-1091" aria-hidden="true" tabindex="-1"></a>https://stats.oarc.ucla.edu/r/dae/tobit-models/</span>
<span id="cb318-1092"><a href="#cb318-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1095"><a href="#cb318-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1096"><a href="#cb318-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#set up data </span></span>
<span id="cb318-1097"><a href="#cb318-1097" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb318-1098"><a href="#cb318-1098" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy =</span> s_NABS</span>
<span id="cb318-1099"><a href="#cb318-1099" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb318-1100"><a href="#cb318-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1101"><a href="#cb318-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb318-1102"><a href="#cb318-1102" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">vglm</span>(accuracy <span class="sc">~</span> condition, <span class="fu">tobit</span>(<span class="at">Upper =</span> <span class="dv">13</span>), <span class="at">data =</span> df)</span>
<span id="cb318-1103"><a href="#cb318-1103" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(t)</span>
<span id="cb318-1104"><a href="#cb318-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t)</span>
<span id="cb318-1105"><a href="#cb318-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1106"><a href="#cb318-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1107"><a href="#cb318-1107" aria-hidden="true" tabindex="-1"></a><span class="fu">#### WIP \| HURDLE MODEL</span></span>
<span id="cb318-1108"><a href="#cb318-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1109"><a href="#cb318-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://data.library.virginia.edu/getting-started-with-hurdle-models/\</span>
<span id="cb318-1110"><a href="#cb318-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://en.wikipedia.org/wiki/Hurdle_model#:\~:text=A%20hurdle%20model%20is%20a,of%20the%20non%2Dzero%20values.</span>
<span id="cb318-1111"><a href="#cb318-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1112"><a href="#cb318-1112" aria-hidden="true" tabindex="-1"></a>class of models for count data with both overdispersion and excess zeros;\</span>
<span id="cb318-1113"><a href="#cb318-1113" aria-hidden="true" tabindex="-1"></a>different from zero-inflated models where the excess zeros are theorized to arise from two different processes; in the hurdle model, there is a model for P(x=0) and a separate model for P(x!=0)</span>
<span id="cb318-1114"><a href="#cb318-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1115"><a href="#cb318-1115" aria-hidden="true" tabindex="-1"></a>The model includes: - A binary logit model to model whether the observation takes a positive count or not. - a truncated Poisson or Negative binomial model that only fits positive counts</span>
<span id="cb318-1116"><a href="#cb318-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1117"><a href="#cb318-1117" aria-hidden="true" tabindex="-1"></a>This allows us to model: (1) Does the student get *any* questions right? (2) How many questions does the student get right?</span>
<span id="cb318-1118"><a href="#cb318-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1121"><a href="#cb318-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1122"><a href="#cb318-1122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co">#zero-inf and hurdle models </span></span>
<span id="cb318-1123"><a href="#cb318-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countreg) <span class="co">#rootogram</span></span>
<span id="cb318-1124"><a href="#cb318-1124" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("countreg", repos="http://R-Forge.R-project.org")</span></span>
<span id="cb318-1125"><a href="#cb318-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1126"><a href="#cb318-1126" aria-hidden="true" tabindex="-1"></a><span class="co">#SYNTAX OUTCOME ~ count model predictor | hurdle predictor</span></span>
<span id="cb318-1127"><a href="#cb318-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1128"><a href="#cb318-1128" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.1</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(item_test_NABS <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df_subjects,</span>
<span id="cb318-1129"><a href="#cb318-1129" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb318-1130"><a href="#cb318-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1131"><a href="#cb318-1131" aria-hidden="true" tabindex="-1"></a>h<span class="fl">.2</span> <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(item_test_NABS <span class="sc">~</span> condition <span class="sc">|</span> condition , <span class="at">data =</span> df_subjects,</span>
<span id="cb318-1132"><a href="#cb318-1132" aria-hidden="true" tabindex="-1"></a>              <span class="at">zero.dist =</span> <span class="st">"binomial"</span>, <span class="at">dist =</span> <span class="st">"negbin"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb318-1133"><a href="#cb318-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1134"><a href="#cb318-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.1</span>)</span>
<span id="cb318-1135"><a href="#cb318-1135" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h<span class="fl">.2</span>)</span>
<span id="cb318-1136"><a href="#cb318-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1137"><a href="#cb318-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1138"><a href="#cb318-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.1</span>)</span>
<span id="cb318-1139"><a href="#cb318-1139" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(h<span class="fl">.2</span>)</span>
<span id="cb318-1140"><a href="#cb318-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(h<span class="fl">.1</span>,h<span class="fl">.2</span>)</span>
<span id="cb318-1141"><a href="#cb318-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1142"><a href="#cb318-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1143"><a href="#cb318-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1144"><a href="#cb318-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1145"><a href="#cb318-1145" aria-hidden="true" tabindex="-1"></a><span class="fu">### Q1 Accuracy</span></span>
<span id="cb318-1146"><a href="#cb318-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1147"><a href="#cb318-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CHI SQUARE</span></span>
<span id="cb318-1148"><a href="#cb318-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1149"><a href="#cb318-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">##### (Combined)</span></span>
<span id="cb318-1150"><a href="#cb318-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1153"><a href="#cb318-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1154"><a href="#cb318-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-Q1TRI.by.COND-BOTH</span></span>
<span id="cb318-1155"><a href="#cb318-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1156"><a href="#cb318-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#lab only</span></span>
<span id="cb318-1157"><a href="#cb318-1157" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_q1 </span>
<span id="cb318-1158"><a href="#cb318-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1159"><a href="#cb318-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb318-1160"><a href="#cb318-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb318-1161"><a href="#cb318-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb318-1162"><a href="#cb318-1162" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, pretty_condition <span class="sc">~</span> accuracy, <span class="at">shade =</span> T, <span class="at">color =</span> <span class="dv">2</span>)</span>
<span id="cb318-1163"><a href="#cb318-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1164"><a href="#cb318-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1165"><a href="#cb318-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>score_niceABS, <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb318-1166"><a href="#cb318-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1167"><a href="#cb318-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1168"><a href="#cb318-1168" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb318-1169"><a href="#cb318-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb318-1170"><a href="#cb318-1170" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb318-1171"><a href="#cb318-1171" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb318-1172"><a href="#cb318-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1173"><a href="#cb318-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1174"><a href="#cb318-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1175"><a href="#cb318-1175" aria-hidden="true" tabindex="-1"></a>**Combining data across both sessions** (n=330), a Pearson's Chi-squared test suggests a statistically significant relationship between response accuracy on the first question and experimental condition, $\chi_2$ (1) = 10.3, p = 0.001. The sample odds ratio (2.46, p = 0.001, 95% CI <span class="sc">\[</span>1.37, 4.53<span class="sc">\]</span>) indicates that the odds of providing a correct response to the first question are 2.46 higher for subjects in the impasse condition than those in the control condition.</span>
<span id="cb318-1176"><a href="#cb318-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1177"><a href="#cb318-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">##### (In Person)</span></span>
<span id="cb318-1178"><a href="#cb318-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1181"><a href="#cb318-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1182"><a href="#cb318-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-Q1TRI.by.COND-LAB</span></span>
<span id="cb318-1183"><a href="#cb318-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1184"><a href="#cb318-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#lab only</span></span>
<span id="cb318-1185"><a href="#cb318-1185" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_q1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>)</span>
<span id="cb318-1186"><a href="#cb318-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1187"><a href="#cb318-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb318-1188"><a href="#cb318-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb318-1189"><a href="#cb318-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb318-1190"><a href="#cb318-1190" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, pretty_condition <span class="sc">~</span> accuracy, </span>
<span id="cb318-1191"><a href="#cb318-1191" aria-hidden="true" tabindex="-1"></a>            <span class="at">shade =</span> T)</span>
<span id="cb318-1192"><a href="#cb318-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1193"><a href="#cb318-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1194"><a href="#cb318-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>score_niceABS, </span>
<span id="cb318-1195"><a href="#cb318-1195" aria-hidden="true" tabindex="-1"></a>            <span class="at">fisher =</span> <span class="cn">TRUE</span>, <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb318-1196"><a href="#cb318-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1197"><a href="#cb318-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1198"><a href="#cb318-1198" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb318-1199"><a href="#cb318-1199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb318-1200"><a href="#cb318-1200" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb318-1201"><a href="#cb318-1201" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb318-1202"><a href="#cb318-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1203"><a href="#cb318-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1204"><a href="#cb318-1204" aria-hidden="true" tabindex="-1"></a>**For (In Person) data collection** (n=126) the Pearson's Chi-squared test (of independence) indicates a relationship between response accuracy on the first question and experimental condition that is not significant at the alpha level 0.05, $\chi^2$ (1) = 10.3, p = 0.07. Thus we have insufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. In this particular data sample, the odds ratio (Odds Ratio = 2.18, p = 0.055, 95% CI <span class="sc">\[</span>0.982, +Inf<span class="sc">\]</span>) indicates that the odds of producing a correct response on the first question were 2.18 times greater if a subject was in the impasse condition, than in the control condition .</span>
<span id="cb318-1205"><a href="#cb318-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1206"><a href="#cb318-1206" aria-hidden="true" tabindex="-1"></a><span class="fu">##### (Online Replication)</span></span>
<span id="cb318-1207"><a href="#cb318-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1210"><a href="#cb318-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1211"><a href="#cb318-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#| label : CHISQR-Q1TRI.by.COND-ONLINE</span></span>
<span id="cb318-1212"><a href="#cb318-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1213"><a href="#cb318-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#online only</span></span>
<span id="cb318-1214"><a href="#cb318-1214" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_q1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"asynch"</span>)</span>
<span id="cb318-1215"><a href="#cb318-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1216"><a href="#cb318-1216" aria-hidden="true" tabindex="-1"></a><span class="co">#MOSAIC PLOT</span></span>
<span id="cb318-1217"><a href="#cb318-1217" aria-hidden="true" tabindex="-1"></a><span class="co">#note: blue indicates cell count higher than expected, red indicates cell count less than expected; under null hypothesis</span></span>
<span id="cb318-1218"><a href="#cb318-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="at">main=</span><span class="st">"Accuracy on First Question by Condition"</span>,</span>
<span id="cb318-1219"><a href="#cb318-1219" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df, pretty_condition <span class="sc">~</span> accuracy, <span class="at">shade =</span> T)</span>
<span id="cb318-1220"><a href="#cb318-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1221"><a href="#cb318-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1222"><a href="#cb318-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>( <span class="at">x =</span> df<span class="sc">$</span>condition, <span class="at">y =</span> df<span class="sc">$</span>score_niceABS, <span class="at">fisher =</span> <span class="cn">TRUE</span>, </span>
<span id="cb318-1223"><a href="#cb318-1223" aria-hidden="true" tabindex="-1"></a>            <span class="at">chisq=</span><span class="cn">TRUE</span>, <span class="at">expected =</span> <span class="cn">TRUE</span>, <span class="at">sresid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb318-1224"><a href="#cb318-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1225"><a href="#cb318-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1226"><a href="#cb318-1226" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb318-1227"><a href="#cb318-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sjtab</span>(<span class="at">fun =</span> <span class="st">"xtab"</span>, <span class="at">var.labels=</span><span class="fu">c</span>(<span class="st">"accuracy"</span>, <span class="st">"pretty_condition"</span>),</span>
<span id="cb318-1228"><a href="#cb318-1228" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.row.prc=</span>T, <span class="at">show.col.prc=</span>T, <span class="at">show.summary=</span>T, <span class="at">show.exp=</span>T, <span class="at">show.legend=</span>T,</span>
<span id="cb318-1229"><a href="#cb318-1229" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistics =</span> <span class="st">"fisher"</span>)</span>
<span id="cb318-1230"><a href="#cb318-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1231"><a href="#cb318-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1232"><a href="#cb318-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1233"><a href="#cb318-1233" aria-hidden="true" tabindex="-1"></a>**For online data collection** (n=204), a Pearson's Chi-squared test (of independence) indicates a statistically significant relationship between response accuracy on the first question and experimental condition, $\chi^2$ (1) = 7.26, p = 0.009. Thus we have sufficient evidence to reject the null hypothesis that the odds ratio is equal to 1. The odds ratio (Odds Ratio = 2.68, p = 0.005, 95% CI <span class="sc">\[</span>1.37, +Inf<span class="sc">\]</span>) indicates that the odds of producing a correct response on the first question were 2.68 times greater if a subject was in the impasse condition, than in the control condition .</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>