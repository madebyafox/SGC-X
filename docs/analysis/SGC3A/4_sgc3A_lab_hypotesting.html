<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.328">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SGC-X - 6&nbsp; (Lab) Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" rel="next">
<link href="../../analysis/SGC3A/3_sgc3A_description.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">(Lab) Hypothesis Testing</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">SGC-X</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../../index.html" class="sidebar-item-text sidebar-link">MAIN</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/scoring.html" class="sidebar-item-text sidebar-link">Scoring Strategy</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/utils/modelling_ref.html" class="sidebar-item-text sidebar-link">Modelling Reference</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">SGC2</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/1_sgc2_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC2/3_sgc2_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">SGC3A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/1_sgc3A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/2_sgc3A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_lab_hypotesting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">(Lab) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">(Lab) Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3A/4_sgc3A_ospan_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">(Online) Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">SGC3B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/1_sgc3B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC3B/2_sgc3B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">SGC4A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/1_sgc4A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/2_sgc4A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/3_sgc4A_description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4A/4_sgc4A_hypotesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SGC4B</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/1_sgc4B_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4B/2_sgc4B_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">SGC4C</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/1_sgc4C_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC4C/2_sgc4C_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">SGC5A</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/1_sgc5A_introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../analysis/SGC5A/2_sgc5A_scoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Response Scoring</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#h1a-overall-accuracy" id="toc-h1a-overall-accuracy" class="nav-link active" data-scroll-target="#h1a-overall-accuracy">H1A | OVERALL ACCURACY</a>
  <ul class="collapse">
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#describe" id="toc-describe" class="nav-link" data-scroll-target="#describe">Describe</a>
  <ul class="collapse">
  <li><a href="#wilcoxon-rank-sum-mann-whitney-test" id="toc-wilcoxon-rank-sum-mann-whitney-test" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-mann-whitney-test">WILCOXON RANK SUM (Mann-Whitney Test)</a>
  <ul class="collapse">
  <li><a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">Test</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  </ul></li>
  <li><a href="#mixed-logistic-regression" id="toc-mixed-logistic-regression" class="nav-link" data-scroll-target="#mixed-logistic-regression">MIXED LOGISTIC REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#describe-1" id="toc-describe-1" class="nav-link" data-scroll-target="#describe-1">Describe</a></li>
  <li><a href="#inference-1" id="toc-inference-1" class="nav-link" data-scroll-target="#inference-1">INFERENCE</a></li>
  <li><a href="#visualize-2" id="toc-visualize-2" class="nav-link" data-scroll-target="#visualize-2">Visualize</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">Diagnostics</a></li>
  <li><a href="#sanity-check-bayesian" id="toc-sanity-check-bayesian" class="nav-link" data-scroll-target="#sanity-check-bayesian">Sanity Check :: Bayesian</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#h1a-overall-interpretation-state" id="toc-h1a-overall-interpretation-state" class="nav-link" data-scroll-target="#h1a-overall-interpretation-state">H1A | OVERALL INTERPRETATION STATE</a>
  <ul class="collapse">
  <li><a href="#setup-1" id="toc-setup-1" class="nav-link" data-scroll-target="#setup-1">Setup</a></li>
  <li><a href="#mixed-multinomial-regression" id="toc-mixed-multinomial-regression" class="nav-link" data-scroll-target="#mixed-multinomial-regression">MIXED MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model-mblogit" id="toc-fit-model-mblogit" class="nav-link" data-scroll-target="#fit-model-mblogit">Fit Model [mblogit]</a></li>
  <li><a href="#describe-2" id="toc-describe-2" class="nav-link" data-scroll-target="#describe-2">Describe</a></li>
  <li><a href="#todo-inference" id="toc-todo-inference" class="nav-link" data-scroll-target="#todo-inference">TODO Inference</a></li>
  <li><a href="#visualize-3" id="toc-visualize-3" class="nav-link" data-scroll-target="#visualize-3">Visualize</a></li>
  <li><a href="#diagnostics-1" id="toc-diagnostics-1" class="nav-link" data-scroll-target="#diagnostics-1">Diagnostics</a></li>
  <li><a href="#fit-model-brms" id="toc-fit-model-brms" class="nav-link" data-scroll-target="#fit-model-brms">Fit Model [brms]</a></li>
  <li><a href="#describe-3" id="toc-describe-3" class="nav-link" data-scroll-target="#describe-3">Describe</a></li>
  <li><a href="#inference-2" id="toc-inference-2" class="nav-link" data-scroll-target="#inference-2">INFERENCE</a></li>
  <li><a href="#visualize-4" id="toc-visualize-4" class="nav-link" data-scroll-target="#visualize-4">Visualize</a></li>
  <li><a href="#diagnostics-2" id="toc-diagnostics-2" class="nav-link" data-scroll-target="#diagnostics-2">Diagnostics</a></li>
  <li><a href="#compare-mblogit-to-brms" id="toc-compare-mblogit-to-brms" class="nav-link" data-scroll-target="#compare-mblogit-to-brms">COMPARE MBLOGIT to BRMS</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#h1b-q1-accuracy" id="toc-h1b-q1-accuracy" class="nav-link" data-scroll-target="#h1b-q1-accuracy">H1B | Q1 ACCURACY</a>
  <ul class="collapse">
  <li><a href="#setup-2" id="toc-setup-2" class="nav-link" data-scroll-target="#setup-2">Setup</a></li>
  <li><a href="#describe-4" id="toc-describe-4" class="nav-link" data-scroll-target="#describe-4">Describe</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">LOGISTIC REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1">Fit Model</a></li>
  <li><a href="#describe-5" id="toc-describe-5" class="nav-link" data-scroll-target="#describe-5">Describe</a></li>
  <li><a href="#inference-3" id="toc-inference-3" class="nav-link" data-scroll-target="#inference-3">Inference</a></li>
  <li><a href="#visualize-5" id="toc-visualize-5" class="nav-link" data-scroll-target="#visualize-5">Visualize</a></li>
  <li><a href="#diagnostics-3" id="toc-diagnostics-3" class="nav-link" data-scroll-target="#diagnostics-3">Diagnostics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#h1b-q1-interpretation-state" id="toc-h1b-q1-interpretation-state" class="nav-link" data-scroll-target="#h1b-q1-interpretation-state">H1B | Q1 INTERPRETATION STATE</a>
  <ul class="collapse">
  <li><a href="#setup-3" id="toc-setup-3" class="nav-link" data-scroll-target="#setup-3">Setup</a></li>
  <li><a href="#describe-6" id="toc-describe-6" class="nav-link" data-scroll-target="#describe-6">Describe</a></li>
  <li><a href="#multinomial-regression" id="toc-multinomial-regression" class="nav-link" data-scroll-target="#multinomial-regression">MULTINOMIAL REGRESSION</a>
  <ul class="collapse">
  <li><a href="#fit-model-2" id="toc-fit-model-2" class="nav-link" data-scroll-target="#fit-model-2">Fit Model</a></li>
  <li><a href="#describe-7" id="toc-describe-7" class="nav-link" data-scroll-target="#describe-7">Describe</a></li>
  <li><a href="#inference-4" id="toc-inference-4" class="nav-link" data-scroll-target="#inference-4">Inference</a></li>
  <li><a href="#visualize-6" id="toc-visualize-6" class="nav-link" data-scroll-target="#visualize-6">Visualize</a></li>
  <li><a href="#diagnostics-4" id="toc-diagnostics-4" class="nav-link" data-scroll-target="#diagnostics-4">Diagnostics</a></li>
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo">TODO</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-SGC3A-lab-hypotesting" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">(Lab) Hypothesis Testing</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Study SGC3A | (Lab) Hypothesis Testing</p>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<p><em>The purpose of this notebook is test the hypotheses that determined the design of the SGC3A study.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UTILITIES</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy model output</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed models</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#favstats</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite) <span class="co">#saving plots as svg</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZATION</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr) #arrange plots</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cowplot) #arrange shift function plots</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcd) #mosaic plots</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcdExtra) #mosaic plots</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves) <span class="co"># plots. in half</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># violin plot stuffs</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with stats</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#latex tables for models!</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELLING</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstatix) #helpful testing functions incl wilcoxon, etc</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#easystats model summary and vis</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qqplotr) #confint on qq plot</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gmodels) #contingency table and CHISQR</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic) #extract model equation</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pscl) #zeroinfl / hurdle models </span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools) <span class="co">#prediction intervalus for glmers </span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects) #visualization log regr models</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">#MULTINOMIAL </span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression [not mixed] #no p values</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#frequentist mixed multinomial logistic regression [mblogit] #gives p values</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr) <span class="co">#executing stan</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#bayesian mixed multinomials [+ other bayesian reg models]</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr) <span class="co">#helping with tidybayes</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_minimal()) </span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_clean</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Research Questions</strong></p>
<p>In SGC3A we set out to answer the following question: Does posing a mental impasse improve performance on the interval graph comprehension task?</p>
<p><strong>Experimental Hypothesis</strong><br>
<em>Learners posed with scenario designed to evoke a mental impasse will be more likely to correct interpret the graph.</em></p>
<ul>
<li>H1A | Learners in the IMPASSE condition will score higher overall than learners in CONTROL.</li>
<li>H1B | Learners in the IMPASSE condition will be more likely to correctly answer the first question than learners in CONTROL.</li>
</ul>
<p><strong>Null Hypothesis</strong><br>
<em>No significant differences in performance will exist between learners in the IMPASSE and CONTROL conditions.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> <span class="co">#only get lab-run participants</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">task_percent =</span> DV_percent_NABS</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(subject <span class="sc">%in%</span> df_subjects<span class="sc">$</span>subject) <span class="sc">%&gt;%</span> <span class="co">#only get lab-run participants</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.factor</span>(q), </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.factor</span>(subject),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS TRI-LIKE</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state = recode_factor(score_SCALED, #for ordinal</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-1" = "orth-like",</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-0.5" = "unknown",</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0" = "unknown",</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0.5" = "tri-like",</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "1" = "tri-like"),</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS OTHER</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orthogonal"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"angular"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"triangular"</span>),</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">as.ordered</span>(state)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="h1a-overall-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="h1a-overall-accuracy">H1A | OVERALL ACCURACY</h2>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 92%">
</colgroup>
<thead>
<tr class="header">
<th>Research Question</th>
<th>Do Ss in the IMPASSE condition score higher across the entire task than those in the CONTROL group?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>(H1) Participants in the IMPASSE condition will be more likely to correctly interpret the graph than those in the CONTROL condition.</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td><p><strong>data</strong>: <code>df_items</code> where <code>q nin 6,9</code> (the 13 discriminating Qs ), <code>df_subjects</code></p>
<p><strong>outcome</strong>:</p>
<ul>
<li>[at item level] : <em>accuracy</em> ( factor(incorrect/correct) from <code>score_niceABS</code> [absolute score]</li>
<li>[subject level]: accuracy (number of test phase qs correct from total <code>s_NABS</code>)</li>
</ul>
<p><strong>predictor</strong>: <code>condition</code> [between-subjects factor]</p></td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>Wilcoxon-Rank Sum (Mann-Whitney) test on subject-level total accuracy of test phase (<code>s_NABS</code>)</li>
<li>Mixed Logistic Regression<br>
<code>accuracy</code> ~ <code>condition</code> + (1 | <code>subject</code> ) + (1 | <code>question</code>)<br>
model effect of condition on probability of correct response [during test phase] while accounting for subject (and item-level?) effects</li>
</ol></td>
</tr>
<tr class="even">
<td><strong>Alternatives</strong></td>
<td><ul>
<li>Ordinal Mixed Logistic Regression on <code>scaled_score</code></li>
<li>OLS Linear Regression: bimodal distribution at tails makes the mean a poor predictor; LMs violate assumptions of normally distributed residuals; both absolute and scaled scores yield non-normal residuals; no transformation of the outcome variables yield normal residuals</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Notes</strong></td>
<td><p><strong>Also exploring:</strong></p>
<ul>
<li>Hurdle model (mixture model w/ binomial + [poisson or negbinom count; 0s from 1 DGP)</li>
<li>Zero Inflated model (mixture model w/ binomial + poisson or negbinom count; 0s from 2 DGPs)</li>
<li>Beta regression hurdle model? (mixture with location and scale parameters [mean, variance] and hurdles for floor and ceiling effects)</li>
<li>Other way to account for the severe bimodality?</li>
</ul></td>
</tr>
</tbody>
</table>
<section id="setup" class="level4">
<h4 class="anchored" data-anchor-id="setup">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, accuracy, subject,q)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>df_s <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, task_percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize" class="level4">
<h4 class="anchored" data-anchor-id="visualize">Visualize</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 2))+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION | Question Accuracy"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/DESC-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df_items <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>q) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION | Accuracy by Question"</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Q6 and Q9 are non-discriminative"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/DESC-ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: FACETED HISTOGRAM</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_s <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(task_percent))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>task_percent,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_s) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gf_facet_grid(pretty_condition ~ pretty_mode) %&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_condition) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"DISTRIBUTION | Total Absolute Score (% Correct)"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/DESC-ACC-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: RAINCLOUD WITH STATS</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_s <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">task_percent =</span> task_percent<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span>   <span class="fu">ggbetweenstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> pretty_condition, <span class="at">y =</span> task_percent,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.type =</span> <span class="st">"box"</span>, <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>               <span class="co"># package = "RColorBrewer",</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>               <span class="co"># palette = "PRGn",</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.point.args =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">1</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.args =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="dv">0</span>), <span class="co">#suppress points</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggplot.component =</span> <span class="do">## modify further with `{ggplot2}` functions</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># aes(color = pretty_condition, fill = pretty_condition),</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 3)),</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_fill_manual(values = paletteer::paletteer_c("viridis::viridis", 3)),</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>               ) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>, </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">5</span>, <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.1</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">2</span>, </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>(</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">08</span>, <span class="at">height =</span> <span class="fl">1.5</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>layers[[<span class="dv">3</span>]]<span class="ot">=</span><span class="cn">NULL</span> <span class="co">#remove default boxplot</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> statsExpressions<span class="sc">::</span><span class="fu">two_sample_test</span>(<span class="at">y =</span> task_percent, <span class="at">x =</span> pretty_condition, <span class="at">data =</span> df,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">alternative =</span> <span class="st">"less"</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>                                <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co">#labels are layer 4</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION of Total Score"</span>,</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Percentage of correct responses across task"</span>, <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>         <span class="co"># caption=e$expression[[1]],</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Impasse condition yields greater variance and more high scores"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/DESC-ACC-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="describe" class="level3">
<h3 class="anchored" data-anchor-id="describe">Describe</h3>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct)"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span>task_percent, <span class="at">data =</span> df_s) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct)</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.077 </td>
   <td style="text-align:right;"> 0.692 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.316 </td>
   <td style="text-align:right;"> 0.392 </td>
   <td style="text-align:right;"> 126 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> pretty_condition </th>
   <th style="text-align:right;"> min </th>
   <th style="text-align:right;"> Q1 </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> Q3 </th>
   <th style="text-align:right;"> max </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> missing </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> control </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.154 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.210 </td>
   <td style="text-align:right;"> 0.370 </td>
   <td style="text-align:right;"> 62 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> impasse </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.058 </td>
   <td style="text-align:right;"> 0.346 </td>
   <td style="text-align:right;"> 0.846 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.419 </td>
   <td style="text-align:right;"> 0.387 </td>
   <td style="text-align:right;"> 64 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<section id="wilcoxon-rank-sum-mann-whitney-test" class="level4">
<h4 class="anchored" data-anchor-id="wilcoxon-rank-sum-mann-whitney-test">WILCOXON RANK SUM (Mann-Whitney Test)</h4>
<ul>
<li><strong>Non parametric alternative</strong> to t-test; compares median rather than mean by ranking data</li>
<li>Does not assume normality</li>
<li>Does not assume equal variance of samples (homogeneity of variance)</li>
</ul>
<section id="test" class="level5">
<h5 class="anchored" data-anchor-id="test">Test</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df_s<span class="sc">$</span>task_percent <span class="sc">~</span> df_s<span class="sc">$</span>pretty_condition,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)) <span class="co">#less, greater</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  df_s$task_percent by df_s$pretty_condition
W = 1243, p-value = 7e-05
alternative hypothesis: true location shift is less than 0</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Funder's (2019) recommendations.

The Wilcoxon rank sum test with continuity correction testing the difference in ranks between df_s$task_percent and df_s$pretty_condition suggests that the effect is negative, statistically significant, and large (W = 1243.00, p &lt; .001; r (rank biserial) = -0.37, 95% CI [-1.00, -0.22])</code></pre>
</div>
</div>
</section>
<section id="inference" class="level5">
<h5 class="anchored" data-anchor-id="inference">Inference</h5>
<p><strong>(not reported)</strong></p>
<p>Because the distribution of the outcome variable is not normally distributed, we evaluate the effect of CONDITION on ACCURACY via a non-parametric test. Consistent with our hypothesis, a Wilcoxon rank sum test (with continuity correction) on ACCURACY by CONDITION indicates that data in each condition likely come from different population distributions (W = 1243, p &lt; 0.001; one-tailed), and that the distribution of the control condition is less (i.e.&nbsp;shifted to the left/ lower scores) than the impasse condition (^{r} = -0.37, 95% CI [-1.00, -0.22]), a large-sized effect.</p>
</section>
<section id="visualize-1" class="level5">
<h5 class="anchored" data-anchor-id="visualize-1">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>( <span class="at">x =</span> pretty_condition, <span class="at">y =</span> task_percent, <span class="at">data =</span> df_s,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIZ-TEST-ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="mixed-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="mixed-logistic-regression">MIXED LOGISTIC REGRESSION</h4>
<p><em>Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.</em></p>
<section id="fit-model" class="level5">
<h5 class="anchored" data-anchor-id="fit-model">Fit Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SETUP</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm 13 items [all discriminating items]</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_i) <span class="sc">/</span> <span class="fu">nrow</span>(df_s) <span class="sc">==</span> <span class="dv">13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm all factors </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df_i<span class="sc">$</span>q) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>subject) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>pretty_condition) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>accuracy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Empty fixed model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Empty fixed model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df_i) </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject intercept random model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject intercept random model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.rS)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name  |    Model | df | df_diff |    Chi2 |      p
--------------------------------------------------
m0    |      glm |  1 |         |         |       
mm.rS | glmerMod |  2 |       1 | 1011.83 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  4.82063151679782e-222"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + ITEM</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject Intercept + Item intercept random model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject Intercept + Item intercept random model"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.rSQ)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS, mm.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical and probably only vary in
  their random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |  Chi2 |      p
-------------------------------------------------
mm.rS  | glmerMod |  2 |         |       |       
mm.rSQ | glmerMod |  3 |       1 | 15.82 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS, mm.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical and probably only vary in
  their random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0000697594950188617"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT CONDITION</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Item random intercepts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FIXED Condition + Subject &amp; Item random intercepts"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.CrSQ)</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC decreases w/ new model TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name    |    Model | df | df_diff |  Chi2 |      p
--------------------------------------------------
mm.rSQ  | glmerMod |  3 |         |       |       
mm.CrSQ | glmerMod |  4 |       1 | 18.66 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0000156066263742927"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>A likelihood ratio test indicates adding CONDITION as a fixed effect to a logistic regression model including a fixed effect random intercepts for SUBJECT and QUESTION explains more variance in the data than random-effects only model.</em></p>
</section>
<section id="describe-1" class="level5">
<h5 class="anchored" data-anchor-id="describe-1">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: SETUP</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.CrSQ</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: accuracy ~ pretty_condition + (1 | subject) + (1 | q)
   Data: df_i

     AIC      BIC   logLik deviance df.resid 
    1006     1028     -499      998     1634 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.316 -0.136 -0.052  0.168  5.522 

Random effects:
 Groups  Name        Variance Std.Dev.
 subject (Intercept) 22.216   4.713   
 q       (Intercept)  0.308   0.555   
Number of obs: 1638, groups:  subject, 126; q, 13

Fixed effects:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -5.51       1.02   -5.40  6.5e-08 ***
pretty_conditionimpasse     4.32       1.12    3.87  0.00011 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
prtty_cndtn -0.802</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFICANCE TEST [non directional]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SIGNIFICANCE TEST [non directional]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: accuracy
                 Chisq Df Pr(&gt;Chisq)    
pretty_condition    15  1    0.00011 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL INFO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL INFO"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1  7
   nobs sigma logLik   AIC   BIC deviance df.residual
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
1  1638     1  -499. 1006. 1028.     630.        1634</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: MANUAL ONE-SIDED SIGTEST </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#note: anova and chi square are always one-tailed, but that is independent of being one-sided</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tt &lt;- 2*pnorm(summary(m)$coefficients[2,3], lower.tail = F)</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("p value for two-tailed test, null B = 0 : ",round(tt,5))</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ot &lt;- pnorm(summary(m)$coefficients[2,3], lower.tail = F)</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("BUT we want a one  directional, null: B &lt;= 0: ",round(ot,5))</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m),</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se,</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4  9
  effect   group  term  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;   (Int   -5.51       1.02     -5.40  6.49e-8    -7.51     -3.51
2 fixed    &lt;NA&gt;   pret    4.32       1.12      3.87  1.08e-4     2.14      6.51
3 ran_pars subje sd__    4.71      NA        NA    NA          NA        NA   
4 ran_pars q      sd__    0.555     NA        NA    NA          NA        NA   </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4  9
  effect   group  term  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;   (Int  0.00406   0.00413     -5.40  6.49e-8  5.50e-4    0.0299
2 fixed    &lt;NA&gt;   pret 75.5      84.3          3.87  1.08e-4  8.46e+0  674.    
3 ran_pars subje sd__  4.71     NA           NA    NA       NA         NA     
4 ran_pars q      sd__  0.555    NA           NA    NA       NA         NA     </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PROBABILITIES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#probability control = plogis(intercept)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#probability impasse = plogis(intercept + coefficient)</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM predict()</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># newdata &lt;- df_i %&gt;% dplyr::select(pretty_condition, subject, q)</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- predict(m, newdata = newdata, type = "response")</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- cbind(newdata, preds)</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- preds %&gt;% </span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, preds) %&gt;% </span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition) %&gt;% </span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     median = median(preds),</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     se = sd(preds)/sqrt(n()),</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     lwr = median - 1.96*se,</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     upr = median + 1.96*se)</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM merTools</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="co">#setup df </span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, subject, q)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="co">#make predictions</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predictInterval</span>(m, <span class="at">newdata =</span> newdata,</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>                              <span class="at">which =</span> <span class="st">"fixed"</span>, <span class="co">#full, fixed or random for those only</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"probability"</span>, <span class="co">#linear.prediction</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>                              <span class="at">stat =</span> <span class="st">"median"</span>,</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n.sims =</span> <span class="dv">1000</span>,</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>                              <span class="at">level =</span> <span class="fl">0.80</span>) <span class="co">#width of prediction interval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: executing %dopar% sequentially: no parallel backend registered</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#join predictions to the new dataframe</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>(summ_preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, fit, lwr, upr) <span class="sc">%&gt;%</span> </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(fit),</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">median</span>(lwr),</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">median</span>(upr)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2  4
  pretty_condition  median    lower  upper
  &lt;fct&gt;              &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 control          0.00408 0.000648 0.0249
2 impasse          0.234   0.0626   0.585 </code></pre>
</div>
</div>
</section>
<section id="inference-1" class="level5">
<h5 class="anchored" data-anchor-id="inference-1">INFERENCE</h5>
<p><strong><em>(In Dissertation)</em></strong></p>
<p>We fit a mixed effects binomial logistic regression model with random intercepts for subjects and questions. Note that we choose to model these data at the item (i.e.&nbsp;question) rather than than subject (i.e.&nbsp;total score) level because the structure of a mixed effects model allows us to differentiate between random variance introduced by individual subjects and questions, versus the expected systematic variance of CONDITION. A likelihood ratio test indicates that a model including a fixed effect of CONDITION explains significantly more variance in the data than an intercepts-only baseline model (<span class="math inline">\(\chi^2 (3) = 18.66, p &lt; 0.001\)</span>). The explanatory power of the entire model is substantial (<span class="math inline">\(conditional \ R^2 = 0.89\)</span>) and the part related to the fixed effect CONDITION (<span class="math inline">\(marginal \ R^2\)</span>) explains 15% of variance. <strong>Consistent with our hypothesis, the impasse condition substantially increases the odds of a correct response.</strong> Across the entire task participants in the impasse condition were 75 times more likely to offer a correct response, compared with those in the control condition ( <span class="math inline">\(e^{\beta_1} = 75.51, p &lt; 0.001\)</span>, <span class="math inline">\(95 \% \  CI [8.46, 674]\)</span>). Based on the fixed effect of CONDITION, The model predicts that the probability of a correct response in the control condition is effectively 0% (95% CI [6.8e-4, 0.02]), and the probability of a correct response in the impasse condition increases to 24% (95% CI [0.06, 0.60]).</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;&nbsp;0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">75.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">8.46&nbsp;&nbsp;673.76</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"><sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"><sub>00</sub> <sub>subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">22.22</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"><sub>00</sub> <sub>q</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.31</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.87</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">126</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>q</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">13</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1638</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.153 / 0.892</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes)</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              # output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-2" class="level5">
<h5 class="anchored" data-anchor-id="visualize-2">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | lOG ODDS</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">transform =</span> <span class="cn">NULL</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.05</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.95</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model ESTIMATE | Odds Ratio"</span>,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">transform =</span> <span class="st">"exp"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.05</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.95</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model ESTIMATE | Log Odds"</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-ACC-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m, exponentiate = TRUE, component = "all")</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result) + labs(</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model ESTIMATE | ODDS RATIO"</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- equivalence_test(m, rule = "classic", ci=0.9) #classic[tost], , bayes</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="eff",</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)[[<span class="dv">1</span>]]  <span class="sc">+</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model PREDICTION | Probability of Accurate Response"</span>,</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of correct response"</span>,</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability of Correct Response"</span>, <span class="at">x =</span> <span class="st">"Condition"</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'y' is already present. Adding another scale for 'y', which will
replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-ACC-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GGDIST | MODEL | PREDICTED PROBABILITIES</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>preds <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">x =</span> fit, <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> pretty_condition)) <span class="sc">+</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">normalize =</span> <span class="st">"xy"</span>) <span class="sc">+</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model PREDICTION | Probability of Accurate Response"</span>,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"TODO check preds to see if fixed or includes random"</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-ACC-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMULATE FIXED EFFECTS</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate values of fixed effects </span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (feEx &lt;- FEsim(m,  oddsRatio = FALSE, n.sims = 1000))</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT estimates of fixed effects</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plotFEsim(feEx) +</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() + labs(title = "Coefficient Plot of InstEval Model",</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                     x = "Median Effect Estimate")</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMULATE RANDOM EFFECTS</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate values of random effects</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># reEx &lt;- REsim(m)</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT estimates of random effects</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plotREsim(reEx)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PERFORMANCE")</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DIAGNOSTICS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DIAGNOSTICS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-DIAG-ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sanity-check-bayesian" class="level5">
<h5 class="anchored" data-anchor-id="sanity-check-bayesian">Sanity Check :: Bayesian</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## 0 | SETUP</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #confirm 13 items [all discriminating items]</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow(df_i) / nrow(df_s) == 13</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #confirm all factors </span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># is.factor(df_i$q) &amp;&amp; is.factor(df_i$subject) &amp;&amp; is.factor(df_i$pretty_condition) &amp;&amp; is.factor(df_i$accuracy)</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print("FIXED Condition + Subject &amp; Item random intercepts")</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Bmm.CrSQ &lt;- brm( accuracy ~ pretty_condition + (1|subject) + (1|q), </span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = df_i, </span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                  family = "bernoulli",</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                  chains = 4, iter = 2000, warmup = 1000,</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                  cores = 4, seed = 1234,</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                  backend = "cmdstanr",</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                  file ="analysis/SGC3A/models/sgc3a_brms_acc_Bmm.CrSQ_LAB.rds")</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="co"># #get Priors </span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # describe_priors(Bmm.CrSQ)</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="co"># #GRAPHICAL POSTERIOR PREDICTION CHECKS</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="co"># pp_check(Bmm.CrSQ)</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a><span class="co"># #DESCRIBE MODEL</span></span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a><span class="co"># (d &lt;- describe_posterior(ci=.95, Bmm.CrSQ))</span></span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="co"># #SEE MODEL</span></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(pd(Bmm.CrSQ))</span></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a><span class="co"># #convert to a pd value</span></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a><span class="co"># (pds &lt;- pd_to_p(d$pd))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>A likelihood ratio test indicates adding CONDITION as a fixed effect to a logistic regression model including a fixed effect random intercepts for SUBJECT and QUESTION explains more variance in the data than random-effects only model.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ##WORKING</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ## VIS probability of correct response</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #TAKES A REALLY LONG TIME</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #1 | get draws</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;%</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.CrSQ,</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co"># #OR load from file</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws &lt;- read_rds("analysis/SGC3A/models/draws_BB.catCrSQ.rds")</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #2| VISUALIZE PREDICTIONS | GGDIST</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ##TODO figure out height normalization.</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ##do it with much smaller number of draws </span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="co"># #TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="co"># #TAKES A REAAALY LONG TIME</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% sample_n(1000) %&gt;% </span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="co"># #   ggplot(aes(x = .value,  y = 0, fill = pretty_condition)) +</span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="co"># #   stat_slab(width = c(.95), alpha = 1, normalize="xy") +</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a><span class="co"># #   #normalize = all, panels, xy, groups, none</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="co"># #   xlim(0,1) + labs(</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a><span class="co"># #     title = "Model Predicted Probability of Correct Response",</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="co"># #     x = "probability of correct response",</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a><span class="co"># #     y = "Interpretation"</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a><span class="co"># #   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a><span class="co"># # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="h1a-overall-interpretation-state" class="level2">
<h2 class="anchored" data-anchor-id="h1a-overall-interpretation-state">H1A | OVERALL INTERPRETATION STATE</h2>
<p><strong>Do Ss in the IMPASSE condition offer less-orthogonal interpretations across the test phase questions?</strong></p>
<p>While absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesnt allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subjects response, and determine if these interpretations differ by experimental condition. State is a 3-category variable that groups the following interpretations:</p>
<ul>
<li><p><strong>orthogonal</strong> [reference category] includes orthogonal and satisficing responses ==&gt; indicates a primarily <em>orthogonal</em> state of coordinate system understanding</p></li>
<li><p><strong>other</strong> includes: blank, reference point, responses that cant be classified (including selecting all datapoints), =&gt; indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly <em>not</em> orthogonal nor triangular</p></li>
<li><p><strong>angular</strong> includes lines connecting responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
<li><p><strong>triangular</strong> includes correct triangular and lines connecting responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="header">
<th>Research Question</th>
<th>Does Ss in the impasse condition produce less orthogonal responses across questions?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the IMPASSE condition will have a higher likelihood of producing unknown and triangle-like response states across all items</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td><ul>
<li>data: <code>df_items</code> where <code>q nin 6,9</code> (13 discriminant test phase items)</li>
<li>outcome: <code>state</code> ( 3 level factor from high_interpretation )</li>
<li>predictor: <code>condition</code> [between-subjects factor]</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>MIXED Multinomial (Logistic) Regression on state predicted by condition</li>
</ol>
<p>Alternative:</p>
<ul>
<li>MIXED Ordinal regression on state (doesnt meet proportional odds assumption-I think)</li>
<li>MIXED Multinomial or Ordinal regression on high_interpretation (some cells are 0, produces problems)</li>
</ul></td>
</tr>
</tbody>
</table>
<section id="setup-1" class="level4">
<h4 class="anchored" data-anchor-id="setup-1">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,subject,state,pretty_condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION of Interpretation"</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>q) <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation by Question"</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A proportional bar chart visualizing the proportion of each interpretations type by condition for each data collection modality (left/right facet) reveals that the pattern of responses are similar regardless of the data collection modality, by differ by condition. In the impasse condition, there are more triangular responses than in control. In the impasse condition, there are also more positive transition (i.e.&nbsp;triangle-like) and neutral (ie. blank or uncertain response types) than in the control condition.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             control impasse     Sum
  orthogonal 0.69727 0.32692 0.50916
  other      0.07320 0.19231 0.13370
  angular    0.00993 0.03846 0.02442
  triangular 0.21960 0.44231 0.33272
  Sum        1.00000 1.00000 1.00000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             control impasse  Sum
  orthogonal     562     272  834
  other           59     160  219
  angular          8      32   40
  triangular     177     368  545
  Sum            806     832 1638</code></pre>
</div>
</div>
</section>
<section id="mixed-multinomial-regression" class="level4">
<h4 class="anchored" data-anchor-id="mixed-multinomial-regression">MIXED MULTINOMIAL REGRESSION</h4>
<p><em>Does condition affect the response state of of items across the task?</em></p>
<p><em>Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).</em></p>
<ul>
<li><p>Can use mclogit mblogit() with random effect <em>or</em> bayesian brms package b/c nlme, lme4 dont support random effects on multinomial (ie no categorical family on glmer())</p></li>
<li><p>Alternative would be to manually run [k-1] X binomial mixed models [should compare outcomes]</p></li>
<li><p>[k-1] equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) [essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing [reference category] vs [this category])</p></li>
<li><p>For <em>each</em> equation:</p>
<ul>
<li><span class="math inline">\(\beta_{0}\)</span> <em>= Log Odds of [this category type vs.&nbsp;reference category type) response in CONTROL condition</em></li>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> <em>= ODDS of [this category type vs.&nbsp;reference category type] response in CONTROL condition</em></li>
<li><span class="math inline">\(\beta_{1}\)</span> <em>=</em> <span class="math inline">\(\beta_{1impasse}\)</span> <em>Log Odds (Log OR; change in odds for [this category] type response in impasse (vs) control [log scale])</em></li>
<li><span class="math inline">\(e^{\beta_{1}}\)</span> <em>= ODDS RATIO of [this. vs reference category type] response in IMPASSE (vs) CONTROL</em></li>
<li>Two-tailed NHST <em>Null hypothesis:</em> <span class="math inline">\(\beta_{impasse} = 0\)</span> <em>the odds for [this category of response vs.&nbsp;reference] are not different for IMPASSE condition</em></li>
<li><em>Alternative hypothesis:</em> <span class="math inline">\(\beta_{impasse} \ne 0\)</span> <em>the odds of [this category of response vs.&nbsp;reference] increases or decreases for IMPASSE condition</em></li>
</ul></li>
</ul>
<section id="fit-model-mblogit" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-mblogit">Fit Model [mblogit]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline category logit" model matches multinom()</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categories (first is reference)"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_i<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "orthogonal" "other"      "angular"    "triangular"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>mm.cat.rSQ <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> <span class="dv">1</span> , </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">random =</span> <span class="fu">list</span>( <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>subject, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> df_i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 1 - deviance = 2540 - criterion = 0.821
Iteration 2 - deviance = 2130 - criterion = 0.0764
Iteration 3 - deviance = 2018 - criterion = 0.0241
Iteration 4 - deviance = 1942 - criterion = 0.00947
Iteration 5 - deviance = 1890 - criterion = 0.00588
Iteration 6 - deviance = 1908 - criterion = 0.00469
Iteration 7 - deviance = 1881 - criterion = 0.0216
Iteration 8 - deviance = 1912 - criterion = 0.0101
Iteration 9 - deviance = 1897 - criterion = 0.0089
Iteration 10 - deviance = 1905 - criterion = 0.00172
Iteration 11 - deviance = 1934 - criterion = 0.000253
Iteration 12 - deviance = 1887 - criterion = 0.0168
Iteration 13 - deviance = 1906 - criterion = 0.00498
Iteration 14 - deviance = 1917 - criterion = 0.0023
Iteration 15 - deviance = 1828 - criterion = 0.0177
Iteration 16 - deviance = 1851 - criterion = 0.00603
Iteration 17 - deviance = 1903 - criterion = 0.000756
Iteration 18 - deviance = 1885 - criterion = 0.0197
Iteration 19 - deviance = 1899 - criterion = 0.00449
Iteration 20 - deviance = 1915 - criterion = 0.00144
Iteration 21 - deviance = 1879 - criterion = 0.00235
Iteration 22 - deviance = 1911 - criterion = 0.00166
Iteration 23 - deviance = 1888 - criterion = 0.0101
Iteration 24 - deviance = 1921 - criterion = 0.00392
Iteration 25 - deviance = 1898 - criterion = 0.00654</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Algorithm did not converge</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.cat.rSQ)</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>mm.cat.CrSQ <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> pretty_condition , </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>( <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>subject, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> df_i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 1 - deviance = 2516 - criterion = 0.818
Iteration 2 - deviance = 2152 - criterion = 0.0677
Iteration 3 - deviance = 1988 - criterion = 0.0332
Iteration 4 - deviance = 1943 - criterion = 0.00696
Iteration 5 - deviance = 1920 - criterion = 0.00226
Iteration 6 - deviance = 1903 - criterion = 0.000947
Iteration 7 - deviance = 1895 - criterion = 0.00044
Iteration 8 - deviance = 1891 - criterion = 0.000212
Iteration 9 - deviance = 1891 - criterion = 0.0000998
Iteration 10 - deviance = 1891 - criterion = 0.0000456
Iteration 11 - deviance = 1891 - criterion = 0.0000207
Iteration 12 - deviance = 1891 - criterion = 9.59e-06
Iteration 13 - deviance = 1891 - criterion = 4.67e-06
Iteration 14 - deviance = 1891 - criterion = 2.41e-06
Iteration 15 - deviance = 1891 - criterion = 1.32e-06
Iteration 16 - deviance = 1891 - criterion = 7.49e-07
Iteration 17 - deviance = 1891 - criterion = 4.38e-07
Iteration 18 - deviance = 1891 - criterion = 2.6e-07
Iteration 19 - deviance = 1891 - criterion = 1.55e-07
Iteration 20 - deviance = 1891 - criterion = 9.29e-08
Iteration 21 - deviance = 1891 - criterion = 5.56e-08
Iteration 22 - deviance = 1891 - criterion = 3.32e-08
Iteration 23 - deviance = 1891 - criterion = 1.98e-08
Iteration 24 - deviance = 1891 - criterion = 1.18e-08
Iteration 25 - deviance = 1891 - criterion = 7.04e-09
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.cat.CrSQ)</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, <span class="fu">AIC</span>(mm.cat.rSQ) <span class="sc">&gt;</span> <span class="fu">AIC</span>(mm.cat.CrSQ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.cat.rSQ, mm.cat.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name        |    Model | df | df_diff |  Chi2 |      p
------------------------------------------------------
mm.cat.rSQ  | mmblogit | 15 |         |       |       
mm.cat.CrSQ | mmblogit | 18 |       3 | 18.39 | &lt; .001</code></pre>
</div>
</div>
</section>
<section id="describe-2" class="level5">
<h5 class="anchored" data-anchor-id="describe-2">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.cat.CrSQ</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co">#DESCRIBE MODEL</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(diag(vcov.phi)): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
mblogit(formula = state ~ pretty_condition, data = df_i, random = list(~1 | 
    subject, ~1 | q))

Equation for other vs orthogonal:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -2.574      0.527   -4.88  1.1e-06 ***
pretty_conditionimpasse    2.488      0.385    6.47  9.9e-11 ***

Equation for angular vs orthogonal:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -4.804      0.800   -6.00  1.9e-09 ***
tri(Intercept)               -2.924      0.782   -3.74  0.00018 ***
pretty_conditionimpasse       2.989      0.614    4.87  1.1e-06 ***
tripretty_conditionimpasse    3.454      0.795    4.34  1.4e-05 ***

Equation for triangular vs orthogonal:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -2.924      0.782   -3.74  0.00018 ***
pretty_conditionimpasse    3.454      0.795    4.34 0.000014 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Co-)Variances:
Grouping level: subject 
             Estimate            Std.Err.      
other~1       2.93                NaN          
angular~1     3.15  5.29         1.25 2.60     
triangular~1  5.43  8.25 16.08   3.26 5.21 8.49

Grouping level: q 
             Estimate         Std.Err.      
other~1      2.54             12.0          
angular~1    2.88 4.91        19.0 29.7     
triangular~1 2.13 3.54 3.36   15.1 23.6 18.6

Null Deviance:     4540 
Residual Deviance: 1890 
Number of Fisher Scoring iterations:  25
Number of observations
  Groups by subject: 126
  Groups by q: 13
  Individual observations:  1638</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERPRET COEFFICIENTS</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `tidy()` method for objects of class mmblogit is not maintained by
the broom team, and is only supported through the lm tidier method. Please be
cautious in interpreting and reporting broom output.

Warning: NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6  7
  term                  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 other~(Intercept)        -2.57     0.527     -4.88 1.06e- 6    -3.61     -1.54
2 angular~(Intercept)      -4.80     0.800     -6.00 1.92e- 9    -6.37     -3.24
3 triangular~(Intercep    -2.92     0.782     -3.74 1.85e- 4    -4.46     -1.39
4 other~pretty_conditi     2.49     0.385      6.47 9.94e-11     1.73      3.24
5 angular~pretty_condi     2.99     0.614      4.87 1.13e- 6     1.78      4.19
6 triangular~pretty_co     3.45     0.795      4.34 1.40e- 5     1.90      5.01</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `tidy()` method for objects of class mmblogit is not maintained by
the broom team, and is only supported through the lm tidier method. Please be
cautious in interpreting and reporting broom output.

Warning: NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6  7
  term                  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 other~(Intercept)        -2.57     0.527     -4.88 1.06e- 6    -3.61     -1.54
2 angular~(Intercept)      -4.80     0.800     -6.00 1.92e- 9    -6.37     -3.24
3 triangular~(Intercep    -2.92     0.782     -3.74 1.85e- 4    -4.46     -1.39
4 other~pretty_conditi     2.49     0.385      6.47 9.94e-11     1.73      3.24
5 angular~pretty_condi     2.99     0.614      4.87 1.13e- 6     1.78      4.19
6 triangular~pretty_co     3.45     0.795      4.34 1.40e- 5     1.90      5.01</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("MODEL INFO")</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># glance(m)</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#PERFORMANCE</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |       BIC |  RMSE | Sigma
-------------------------------------
21103.626 | 21200.848 | 0.242 | 1.077</code></pre>
</div>
</div>
</section>
<section id="todo-inference" class="level5">
<h5 class="anchored" data-anchor-id="todo-inference">TODO Inference</h5>
<ul>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 12 (z = 6.48, p &lt; 0.001) . <strong>Participants in the impasse condition were 12x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving triangle-like response rather than an orthogonal (or satisficing) response by a factor of 29 (z = 4.63, p &lt; 0.001 ). <strong>Participants in the impasse condition were more than 29x as likely to give an a triangular response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>As with the (binary) logistic regression on accuracy ~ condition, significant model intercepts indicate that the odds of being in any particular response state (vs) orthogonal are significantly different than 1 <em>in the control condition.</em> (i.e.&nbsp;not 1:1 odds or 50% chance of being in that response state. Orthogonal is a much more probable response state in control)</p></li>
</ul>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">other~(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.57</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.61&nbsp;&nbsp;-1.54</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">angular~(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.80</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-6.37&nbsp;&nbsp;-3.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">triangular~(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.92</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.46&nbsp;&nbsp;-1.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">other~pretty<br>conditionimpasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.73&nbsp;&nbsp;3.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">angular~pretty<br>conditionimpasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.78&nbsp;&nbsp;4.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">triangular~pretty<br>conditionimpasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.90&nbsp;&nbsp;5.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">126</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>q</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">13</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1638</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes)</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              # output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-3" class="level5">
<h5 class="anchored" data-anchor-id="visualize-3">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">transform =</span> <span class="st">"exp"</span>,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-MBLOGIT-STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO SEPARATE THIS BY EQUATION </span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ms &lt;- model_parameters(Bmm.cat.CrSQ, component = "conditional")</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># m1 &lt;- ms %&gt;% filter(str_detect(Parameter, "muother"))</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(m1)</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_labels =</span> <span class="cn">TRUE</span>, <span class="at">n_columns =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-MBLOGIT-STATE-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- simulate_parameters(m)</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE)</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Could not estimate a good default ROPE range. Using 'c(-0.1, 0.1)'.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-MBLOGIT-STATE-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="eff",</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co"># #PLOT MODEL PREDICTION</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")[[1]] + </span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0,1) + labs(</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO EMMEANS for the estimated marginal means</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-1" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-1">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="fit-model-brms" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-brms">Fit Model [brms]</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN RANDOM ONLY</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>Bmm.cat.rSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.rSQ_LAB.rds"</span>)</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="co">#UNINFORMATIVE PRIOR BAYESIAN MIXED VERSION</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="co"># flat_Bmm.cat.CrSQ &lt;- brm( state ~ pretty_condition + (1|subject) + (1|q), </span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = df_i, </span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                  family = "categorical",</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                  chains = 4, iter = 2500, warmup = 1000,</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                  cores = 4, seed = 1234,</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                  save_pars = save_pars(all = TRUE),</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                  # backend = "cmdstanr",</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                  file ="analysis/SGC3A/models/sgc3a_brms_state_FLAT_Bmm.cat.CrSQ_LAB.rds")</span></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a><span class="co"># determine default priors </span></span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a><span class="co"># prior_summary(flat_Bmm.cat.CrSQ)</span></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a><span class="co">#set priors [see justification, below]</span></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>inf_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># too strong?</span></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prior(normal(-6.91, 0.201),  class = "Intercept", dpar = "muangular"),</span></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prior(normal(-6.91, 0.201),  class = "Intercept", dpar = "muother"),</span></span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prior(normal(-6.91, 0.201),  class = "Intercept", dpar = "mutriangular"),</span></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS </span></span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on COEFFICIENT</span></span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a><span class="co">#INFORMATIVE PRIORS</span></span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a>Bmm.cat.CrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> inf_priors,</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.CrSQ_LAB.rds"</span></span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a><span class="co">#a bayes factor model comparison of the flat vs informative prior models suggest convicing evidence that </span></span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a><span class="co">#informative prior model is a better fit</span></span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesfactor(Bmm.cat.CrSQ, flat_Bmm.cat.CrSQ)</span></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a><span class="co"># PRIORS LOGIC </span></span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.bayesrulesbook.com/chapter-13.html#building-the-logistic-regression-model</span></span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a><span class="co">#expectation for probability of _better_ response [in control]?</span></span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a><span class="co">#very low probability center: 0.1% [very low]; as logodds = logit(0.001) = -6.91</span></span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a><span class="co">#range from 0 to 55%  logit(0.55) = 0.201</span></span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a><span class="co">#probability of 0.1 to 55% is equivalent to [logodds] -6.91 +/ 2* 0.201</span></span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a><span class="co">#therefore... prior for intercept =&gt; Normal(6.91, 0)</span></span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a><span class="co">#expectation for probability of _better_ response [in impasse]?</span></span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a><span class="co">#increases probablity from 0 % </span></span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 [very low]; as OR  = exp(0) = 1</span></span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a><span class="co">#range from 0 to 90%  exp(0.9) = 2.46</span></span>
<span id="cb131-75"><a href="#cb131-75" aria-hidden="true" tabindex="-1"></a><span class="co">#probability of 0 to 90% is equivalent to [ODDS scale] 1 +/ 2* 2.42</span></span>
<span id="cb131-76"><a href="#cb131-76" aria-hidden="true" tabindex="-1"></a><span class="co">#on log odds scale ? [0, ]</span></span>
<span id="cb131-77"><a href="#cb131-77" aria-hidden="true" tabindex="-1"></a><span class="co">#therefore... prior for intercept =&gt; Normal(1, 2.42)</span></span>
<span id="cb131-78"><a href="#cb131-78" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># prior = normal(0.07, 0.035),</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-3" class="level5">
<h5 class="anchored" data-anchor-id="describe-3">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> Bmm.cat.CrSQ</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: categorical 
  Links: muother = logit; muangular = logit; mutriangular = logit 
Formula: state ~ pretty_condition + (1 | subject) + (1 | q) 
   Data: df_i (Number of observations: 1638) 
  Draws: 4 chains, each with iter = 2500; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Group-Level Effects: 
~q (Number of levels: 13) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muother_Intercept)          1.43      0.36     0.89     2.29 1.00     1738
sd(muangular_Intercept)        2.24      0.85     1.08     4.35 1.00     1351
sd(mutriangular_Intercept)     0.99      0.27     0.59     1.59 1.00     1710
                           Tail_ESS
sd(muother_Intercept)          3069
sd(muangular_Intercept)        2388
sd(mutriangular_Intercept)     2989

~subject (Number of levels: 126) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(muother_Intercept)          1.32      0.19     0.99     1.71 1.00     1738
sd(muangular_Intercept)        1.78      0.40     1.05     2.63 1.00     1839
sd(mutriangular_Intercept)     4.51      0.50     3.63     5.59 1.00     1084
                           Tail_ESS
sd(muother_Intercept)          3080
sd(muangular_Intercept)        2074
sd(mutriangular_Intercept)     2016

Population-Level Effects: 
                                     Estimate Est.Error l-95% CI u-95% CI Rhat
muother_Intercept                       -3.09      0.47    -4.02    -2.18 1.00
muangular_Intercept                     -5.71      0.81    -7.29    -4.14 1.00
mutriangular_Intercept                  -3.63      0.74    -5.13    -2.19 1.00
muother_pretty_conditionimpasse          2.46      0.35     1.80     3.14 1.00
muangular_pretty_conditionimpasse        2.74      0.61     1.59     3.99 1.00
mutriangular_pretty_conditionimpasse     3.58      0.88     1.91     5.41 1.01
                                     Bulk_ESS Tail_ESS
muother_Intercept                        1223     2382
muangular_Intercept                      1676     3000
mutriangular_Intercept                    985     1988
muother_pretty_conditionimpasse          2101     3314
muangular_pretty_conditionimpasse        3170     3521
mutriangular_pretty_conditionimpasse      658     1468

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(<span class="at">ci=</span>.<span class="dv">95</span>, Bmm.cat.CrSQ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Posterior Distribution

Parameter                            | Median |         95% CI |   pd |          ROPE | % in ROPE |  Rhat |     ESS
-------------------------------------------------------------------------------------------------------------------
muother_Intercept                    |  -3.09 | [-4.02, -2.18] | 100% | [-0.18, 0.18] |        0% | 1.003 | 1218.00
muangular_Intercept                  |  -5.69 | [-7.29, -4.14] | 100% | [-0.18, 0.18] |        0% | 1.002 | 1620.00
mutriangular_Intercept               |  -3.60 | [-5.13, -2.19] | 100% | [-0.18, 0.18] |        0% | 1.004 |  983.00
muother_pretty_conditionimpasse      |   2.45 | [ 1.80,  3.14] | 100% | [-0.18, 0.18] |        0% | 1.000 | 2080.00
muangular_pretty_conditionimpasse    |   2.73 | [ 1.59,  3.99] | 100% | [-0.18, 0.18] |        0% | 1.000 | 3066.00
mutriangular_pretty_conditionimpasse |   3.55 | [ 1.91,  5.41] | 100% | [-0.18, 0.18] |        0% | 1.006 |  652.00</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"BAYES FACTOR [comparison to null]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BAYES FACTOR [comparison to null]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#think of this like the anova(model) to get p values for each predictor</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co">#has to recompile the models with rstan. total drag</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">bayesfactor</span>(Bmm.cat.rSQ, m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Bayes factors might not be precise.
For precise Bayes factors, sampling at least 40,000 posterior samples is recommended.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computation of Bayes factors: estimating marginal likelihood, please wait...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: logml could not be estimated within maxiter, rerunning with adjusted starting value. 
Estimate might be more variable than usual.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: logml could not be estimated within maxiter, rerunning with adjusted starting value. 
Estimate might be more variable than usual.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factors for Model Comparison

    Model                                            BF
[2] pretty_condition + (1 | subject) + (1 | q) 9.14e+14

* Against Denominator: [1] 1 + (1 | subject) + (1 | q)
*   Bayes Factor Type: marginal likelihoods (bridgesampling)</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DESCRIBE POSTERIOR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DESCRIBE POSTERIOR"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # table of estimates with 95% CI</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m),</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se,</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOG ODDS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>(l <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Posterior Distribution

Parameter                            | Median |         95% CI |   pd |          ROPE | % in ROPE |  Rhat |     ESS
-------------------------------------------------------------------------------------------------------------------
muother_Intercept                    |  -3.09 | [-4.02, -2.18] | 100% | [-0.18, 0.18] |        0% | 1.003 | 1218.00
muangular_Intercept                  |  -5.69 | [-7.29, -4.14] | 100% | [-0.18, 0.18] |        0% | 1.002 | 1620.00
mutriangular_Intercept               |  -3.60 | [-5.13, -2.19] | 100% | [-0.18, 0.18] |        0% | 1.004 |  983.00
muother_pretty_conditionimpasse      |   2.45 | [ 1.80,  3.14] | 100% | [-0.18, 0.18] |        0% | 1.000 | 2080.00
muangular_pretty_conditionimpasse    |   2.73 | [ 1.59,  3.99] | 100% | [-0.18, 0.18] |        0% | 1.000 | 3066.00
mutriangular_pretty_conditionimpasse |   3.55 | [ 1.91,  5.41] | 100% | [-0.18, 0.18] |        0% | 1.006 |  652.00</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (tm &lt;- tidy(m,   conf.int = TRUE))</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                            |   Median |         95% CI |   pd | % in ROPE |  Rhat |     ESS
-----------------------------------------------------------------------------------------------------
muother_Intercept                    |     0.05 | [0.02,   0.11] | 100% |        0% | 1.003 | 1218.00
muangular_Intercept                  | 3.38e-03 | [0.00,   0.02] | 100% |        0% | 1.002 | 1620.00
mutriangular_Intercept               |     0.03 | [0.01,   0.11] | 100% |        0% | 1.004 |  983.00
muother_pretty_conditionimpasse      |    11.58 | [6.03,  23.19] | 100% |        0% | 1.000 | 2080.00
muangular_pretty_conditionimpasse    |    15.30 | [4.89,  54.22] | 100% |        0% | 1.000 | 3066.00
mutriangular_pretty_conditionimpasse |    34.71 | [6.72, 223.29] | 100% |        0% | 1.006 |  652.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a MCMC distribution approximation.</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy(m,   conf.int = TRUE, exponentiate = TRUE)</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tm %&gt;% mutate(</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   OR.est = exp(estimate),</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   exp.low = exp(conf.low),</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   exp.high = exp(conf.high)</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ) %&gt;% dplyr::select(effect, component, group, term, OR.est, exp.low, exp.high)</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PROBABILITIES"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICT METHOD</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, subject, q)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> newdata, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="co">#lengthen data frame to handle multinomial</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>subject, <span class="sc">-</span>q) <span class="sc">%&gt;%</span> <span class="co">#marginalize over subject and q</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>pretty_condition,</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"preds"</span>,</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"state"</span>,</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pretty_condition, state ) <span class="sc">%&gt;%</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(preds),</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(preds)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwr =</span> median <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">upr =</span> median <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8  6
# Groups:   pretty_condition [2]
  pretty_condition state             median       se      lwr     upr
  &lt;fct&gt;            &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 control          P(Y = angular)    0.003  0.000735  0.00156 0.00444
2 control          P(Y = orthogonal) 0.879  0.0123    0.855   0.903  
3 control          P(Y = other)      0.0365 0.00361   0.0294  0.0436 
4 control          P(Y = triangular) 0.0152 0.0127   -0.00967 0.0400 
5 impasse          P(Y = angular)    0.0132 0.00210   0.00912 0.0174 
6 impasse          P(Y = orthogonal) 0.241  0.0100    0.222   0.261  
7 impasse          P(Y = other)      0.126  0.00656   0.114   0.139  
8 impasse          P(Y = triangular) 0.372  0.0131    0.346   0.397  </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="do">##DRAWS METHOD</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE draws from model</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="co"># #OR load from file</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws &lt;- read_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # SUMMARIZE draws from model</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="co"># (k &lt;- kable(draws %&gt;%</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition, .category) %&gt;%</span></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   median_hdci(.value), digits = 4, col.names =</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     c("Condition","Category", "Probability","Lower Cred.I","Upper Cred.I", "CI Width", "Point Type", "Interval Type")) %&gt;%</span></span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   kable_styling())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="inference-2" class="level5">
<h5 class="anchored" data-anchor-id="inference-2">INFERENCE</h5>
<p>[REPORT POSTERIOR MEDIAN <span class="math inline">\(\exp_{beta}\)</span>, 95 % credible interval, % probability of direction]</p>
<p>We fit a (bayesian) multinomial logistic regression model with random intercepts for subjects and questions. A Bayes Factor model comparison (against a random intercepts-only model) indicates extreme evidence for a main effect of CONDITION (BF = 9.31e+15). <strong>Consistent with our hypothesis, the impasse condition substantially increases the odds of transitional interpretations.</strong></p>
<p>Across the entire task participants in the impasse condition were 12 times more likely to offer an unknown rather than orthogonal response compared with those in the control condition ( <span class="math inline">\(e^{\beta_1} = 11.58, 95 \% CI [6.03, 23.19], pd = 100\%\)</span>). Participants in the impasse condition were 15 times more likely to offer an angular rather than orthogonal response compared with those in the control condition ( <span class="math inline">\(e^{\beta_1} = 15.30, 95 \% CI [4.89, 54.22], pd = 100\%\)</span>), and 35 times more likely to offer an triangular rather than orthogonal response compared with those in the control condition ( <span class="math inline">\(e^{\beta_1} = 34.71, 95 \% CI [6.72, 223.29], pd = 100\%\)</span>).</p>
<p>The model estimates that probability of an orthogonal response in the control condition is 92% vs only 38% in IMPASSE The probability of an unknown/uncertain response in the control condition is 4%, vs 20% in impasse The probability of an angular response in the control condition is less than 1%, vs 2% in impasse. The probability of an triangular response in the control condition is 3%, vs 40% in impasse.</p>
<p>The impasse condition decreases the probability of an orthogonal response by 54% The impasse condition increases the probability of an uknown/uncertain response by 16% The impasse condition increases the probability of an angular response by 1% the impasse condition increase the probability of a triangular response by 37%</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'bayes_R2' is not defined for unordered categorical models.</code></pre>
</div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state: other</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state: angular</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state: triangular</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state: other_pretty</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state: angular_pretty</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state: triangular_pretty</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI (95%)</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI (95%)</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">CI (95%)</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">CI (95%)</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">CI (95%)</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">CI (95%)</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Intercept</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;&nbsp;0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.02&nbsp;&nbsp;0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">0.01&nbsp;&nbsp;0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3"></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">conditionimpasse</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">15.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.89&nbsp;&nbsp;54.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">11.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">6.03&nbsp;&nbsp;23.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">34.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">6.72&nbsp;&nbsp;223.29</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"><sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="12">0.40</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"><sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="12">1.43</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="12">0.22</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="12">126</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>q</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="12">13</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="12">1638</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',</span></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes)</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              # output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ## POINT ESTIMATES IN PROBABILITY</span></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a><span class="co"># #1 | get draws</span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;%</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a><span class="co"># #2 | SUMMARIZE draws </span></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a><span class="co"># k &lt;- kable(draws %&gt;%</span></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition, .category) %&gt;%</span></span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   median_hdci(.value), digits = 2, col.names = </span></span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     c("Condition","Category", "Probability","Lower Cred.I","Upper Cred.I", "CI Width", "Point Type", "Interval Type")) %&gt;% </span></span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   kable_styling()</span></span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a><span class="co"># k</span></span>
<span id="cb164-41"><a href="#cb164-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-42"><a href="#cb164-42" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARISONS</span></span>
<span id="cb164-43"><a href="#cb164-43" aria-hidden="true" tabindex="-1"></a><span class="co"># c &lt;- draws %&gt;% </span></span>
<span id="cb164-44"><a href="#cb164-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   # dplyr::select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb164-45"><a href="#cb164-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   compare_levels(variable = .value, by = pretty_condition, </span></span>
<span id="cb164-46"><a href="#cb164-46" aria-hidden="true" tabindex="-1"></a><span class="co">#                  comparison = list(c("control","impasse"))) </span></span>
<span id="cb164-47"><a href="#cb164-47" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("adots","interval"),</span></span>
<span id="cb164-48"><a href="#cb164-48" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("adots","mean"),</span></span>
<span id="cb164-49"><a href="#cb164-49" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("adots","text"),</span></span>
<span id="cb164-50"><a href="#cb164-50" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("density","interval"),</span></span>
<span id="cb164-51"><a href="#cb164-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("density","mean"),</span></span>
<span id="cb164-52"><a href="#cb164-52" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("density","text"),</span></span>
<span id="cb164-53"><a href="#cb164-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("interval","mean"),</span></span>
<span id="cb164-54"><a href="#cb164-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("interval","text"),</span></span>
<span id="cb164-55"><a href="#cb164-55" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("mean","text")</span></span>
<span id="cb164-56"><a href="#cb164-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    </span></span>
<span id="cb164-57"><a href="#cb164-57" aria-hidden="true" tabindex="-1"></a><span class="co"># c %&gt;%</span></span>
<span id="cb164-58"><a href="#cb164-58" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .value, y = reorder(x =pretty_condition, X = .value)))+</span></span>
<span id="cb164-59"><a href="#cb164-59" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_interval(.width = .95, color = "black") +</span></span>
<span id="cb164-60"><a href="#cb164-60" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_vline(xintercept = 0)+</span></span>
<span id="cb164-61"><a href="#cb164-61" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw()+</span></span>
<span id="cb164-62"><a href="#cb164-62" aria-hidden="true" tabindex="-1"></a><span class="co">#   # coord_cartesian(xlim = c(-.5,1)) +</span></span>
<span id="cb164-63"><a href="#cb164-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_tidybayes() </span></span>
<span id="cb164-64"><a href="#cb164-64" aria-hidden="true" tabindex="-1"></a><span class="co"># comps</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-4" class="level5">
<h5 class="anchored" data-anchor-id="visualize-4">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red",</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.1, #manually adjust to account for directional test</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.90 ) + #manually adjusted for directional test</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Model Estimate | Odds Ratio",</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "",</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition")</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(Bmm.cat.CrSQ, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">TRUE</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-BRMS-STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># + theme_clean()</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- estimate_density(m,exponentiate = TRUE)</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result,  stack = FALSE, priors = TRUE)</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0804</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3600 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-BRMS-STATE-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-BRMS-STATE-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>(result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m,<span class="at">exponentiate =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Probability of Direction

Parameter                            |   pd
-------------------------------------------
muother_Intercept                    | 100%
muangular_Intercept                  | 100%
mutriangular_Intercept               | 100%
muother_pretty_conditionimpasse      | 100%
muangular_pretty_conditionimpasse    | 100%
mutriangular_pretty_conditionimpasse | 100%</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">TRUE</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-BRMS-STATE-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="eff",</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="co"># #PLOT MODEL PREDICTION</span></span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Note: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$pretty_condition</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-BRMS-STATE-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO EMMEANS for the estimated marginal means</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="do">##WORKING</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://mjskay.github.io/ggdist/reference/stat_slab.html</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="do">## VIS probability of correct response</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REALLY LONG TIME</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="co">#1 | get draws</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA) </span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a><span class="co">#OR load from file</span></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- read_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a><span class="co">#2| VISUALIZE PREDICTIONS | GGDIST</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO figure out height normalization.</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a><span class="do">##do it with much smaller number of draws </span></span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REAAALY LONG TIME</span></span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- draws %&gt;%</span></span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .value,  y = pretty_condition, fill = .category)) +</span></span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab(width = c(.95), alpha = 1, normalize="xy") +</span></span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   #   #normalize = all, panels, xy, groups, none</span></span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim(0,1) + labs(</span></span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Predicted Probability of Correct Response",</span></span>
<span id="cb177-31"><a href="#cb177-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "probability of correct response",</span></span>
<span id="cb177-32"><a href="#cb177-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "Interpretation"</span></span>
<span id="cb177-33"><a href="#cb177-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb177-34"><a href="#cb177-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb177-35"><a href="#cb177-35" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb177-36"><a href="#cb177-36" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(d, filename = "figures/sgc3a_BBm.cat.CrSQ_lab_posterior.svg", width = 6, height =4)</span></span>
<span id="cb177-37"><a href="#cb177-37" aria-hidden="true" tabindex="-1"></a><span class="co"># d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-2" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-2">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK Fit of posterior predictive to data</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(Bmm.cat.CrSQ, <span class="at">ndraws=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK posterior vs. priors</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">estimate_density</span>(Bmm.cat.CrSQ)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">stack =</span> <span class="cn">FALSE</span>, <span class="at">priors=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK model</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Bmm.cat.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/unnamed-chunk-28-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="compare-mblogit-to-brms" class="level5">
<h5 class="anchored" data-anchor-id="compare-mblogit-to-brms">COMPARE MBLOGIT to BRMS</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(mm.cat.CrSQ, Bmm.cat.CrSQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                            |          mm.cat.CrSQ |         Bmm.cat.CrSQ
----------------------------------------------------------------------------------
other~(Intercept)                    | -2.57 (-3.61, -1.54) |                     
angular~(Intercept)                  | -4.80 (-6.37, -3.24) |                     
triangular~(Intercept)               | -2.92 (-4.46, -1.39) |                     
other~pretty conditionimpasse        |  2.49 ( 1.73,  3.24) |                     
angular~pretty conditionimpasse      |  2.99 ( 1.78,  4.19) |                     
triangular~pretty conditionimpasse   |  3.45 ( 1.90,  5.01) |                     
muother_Intercept                    |                      | -3.09 (-4.02, -2.18)
muangular_Intercept                  |                      | -5.69 (-7.29, -4.14)
mutriangular_Intercept               |                      | -3.60 (-5.13, -2.19)
muother_pretty_conditionimpasse      |                      |  2.45 ( 1.80,  3.14)
muangular_pretty_conditionimpasse    |                      |  2.73 ( 1.59,  3.99)
mutriangular_pretty_conditionimpasse |                      |  3.55 ( 1.91,  5.41)
----------------------------------------------------------------------------------
Observations                         |                 1638 |                 1638</code></pre>
</div>
</div>
<p>The predictions of the manual, frequentist mixed multinomial and bayesian mixed multinomial models are comparable.</p>
</section>
</section>
</section>
<section id="h1b-q1-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="h1b-q1-accuracy">H1B | Q1 ACCURACY</h2>
<p><strong>Do Ss in the IMPASSE condition have a higher likelihood of producing a correct response to the first question?</strong></p>
<p>The graph comprehension task includes 15 questions completed in sequence. But the first question the reader encounters (Q1) is the most important, as it is their <em>first exposure</em> to the unconventional triangular coordinate system.</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 90%">
</colgroup>
<thead>
<tr class="header">
<th>Research Question</th>
<th>Does the frequency of correct (vs) incorrect responses on the first question differ by condition? [Is response accuracy independent of condition?]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the IMPASSE condition will have a higher likelihood of correctly responding to the first question than those in the CONTROL condition</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td><ul>
<li>data: <code>df_items</code> where <code>q == 1</code></li>
<li>outcome: <em>accuracy</em> ( factor(incorrect/correct) from <code>score_niceABS</code> [absolute score]</li>
<li>predictor: <code>condition</code> [between-subjects factor]</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>Logistic Regression on <code>accuracy</code> predicted by <code>condition</code>
<ul>
<li>account for difference in odds of correct score by condition</li>
</ul></li>
</ol>
<p>Alternatives:</p>
<ul>
<li>Chi-Square test of independence on outcome <code>accuracy</code> by <code>condition</code></li>
</ul></td>
</tr>
<tr class="even">
<td><strong>Notes</strong></td>
<td><ul>
<li>CHIQ SQR is simplest method to examine independence of two categorical factors; LOGISTIC REGRESSION is recommended for binomial ~ continuous; though with regression we can quantify the size of the effect and overall model fit</li>
<li>independence assumption : (CHI SQR) as we only consider responses on the first question, each observation corresponds to an individual subject, and are thus independent</li>
<li>cell frequency : (CHI SQR) expected frequency in each cell of the contingency table is greater than 5 (more than 5 correct , more than 5 incorrect responses)</li>
</ul></td>
</tr>
</tbody>
</table>
<section id="setup-2" class="level4">
<h4 class="anchored" data-anchor-id="setup-2">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy, pretty_condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-4" class="level4">
<h4 class="anchored" data-anchor-id="describe-4">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Accuracy"</span>,</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A proportional bar chart visualizing the proportion of incorrect (vs) correct responses in each condition for each data collection modality (left/right facet) reveals that the pattern of responses appear the same regardless of the data collection modality. In both data collection sessions, the proportion of incorrect responses is much greater than the proportion of correct responses, regardless of condition (marginal probability of incorrect). In the impasse condition, the difference in proportions is smaller than the control condition (conditional probability of success in impasse; (i.e) There are more correct responses in the impasse condition than the control condition).</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Proportions of Correct Responses by Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Proportions of Correct Responses by Condition"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse   Sum
  incorrect   0.839   0.703 0.770
  correct     0.161   0.297 0.230
  Sum         1.000   1.000 1.000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Number of Correct Responses by Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of Correct Responses by Condition"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            control impasse Sum
  incorrect      52      45  97
  correct        10      19  29
  Sum            62      64 126</code></pre>
</div>
</div>
</section>
<section id="logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression">LOGISTIC REGRESSION</h4>
<p>Fit a logistic regression predicting accuracy (absolute score) (n = 126) by condition (k = 2).<br>
</p>
<ul>
<li>Parameter estimate: <span class="math inline">\(\beta_{0}\)</span> = Log Odds of (correct) responses in CONTROL condition</li>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> = ODDS of correct response in CONTROL condition</li>
<li>Parameter estimate: <span class="math inline">\(\beta_{1}\)</span> = <span class="math inline">\(\beta_{1impasse}\)</span> Log Odds (Log OR; change in odds for correct response in impasse (vs) control [log scale])</li>
<li><span class="math inline">\(e^{\beta_{1}}\)</span> = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</li>
<li><strong>Null hypothesis</strong>:<span class="math inline">\(\beta_{impasse} \le 0\)</span> the odds for a correct response does not change, or decreases</li>
<li><strong>Alternative hypothesis:</strong> <span class="math inline">\(\beta_{impasse} \gt 0\)</span> the odds of a correct response increases</li>
</ul>
<section id="fit-model-1" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-1">Fit Model</h5>
<p><em>First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.</em></p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING ::::::::</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.839  -0.839  -0.593  -0.593   1.910  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.649      0.345   -4.77  1.8e-06 ***
pretty_conditionimpasse    0.786      0.441    1.79    0.074 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 135.95  on 125  degrees of freedom
Residual deviance: 132.63  on 124  degrees of freedom
AIC: 136.6

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: accuracy
                 LR Chisq Df Pr(&gt;Chisq)  
pretty_condition     3.31  1      0.069 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name | Model | df | df_diff | Chi2 |     p
------------------------------------------
m0   |   glm |  1 |         |      |      
m1   |   glm |  2 |       1 | 3.31 | 0.069</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Likelihood Ratio test is significant? p =  0.0687084837283363"</code></pre>
</div>
</div>
<p><em>The Condition predictor decreases AIC, but the Likelihood Ratio Test is marginal. We proceed to examine the predictor model, as we plan to do a 1-tailed NHST .</em></p>
</section>
<section id="describe-5" class="level5">
<h5 class="anchored" data-anchor-id="describe-5">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL [default two-tailed sig test]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREDICTOR MODEL [default two-tailed sig test]"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accuracy ~ pretty_condition, family = "binomial", 
    data = df)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-0.839  -0.839  -0.593  -0.593   1.910  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.649      0.345   -4.77  1.8e-06 ***
pretty_conditionimpasse    0.786      0.441    1.79    0.074 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 135.95  on 125  degrees of freedom
Residual deviance: 132.63  on 124  degrees of freedom
AIC: 136.6

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: accuracy
                 LR Chisq Df Pr(&gt;Chisq)  
pretty_condition     3.31  1      0.069 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"p value for two-tailed test, null B = 0 : "</span>,<span class="fu">round</span>(tt,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p value for two-tailed test, null B = 0 :  0.074"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>ot <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"BUT we want a one tailed directional, null: B &lt;= 0: "</span>,<span class="fu">round</span>(ot,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BUT we want a one tailed directional, null: B &lt;= 0:  0.037"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"adjusted confint for directional hypothesis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "adjusted confint for directional hypothesis"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>(dcint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1, <span class="at">level =</span> <span class="fl">0.90</span>)) <span class="co"># get 90% for right side))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                            5 %  95 %
(Intercept)             -2.2578 -1.11
pretty_conditionimpasse  0.0749  1.53</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval - LOG ODDS")</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients - ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficients - ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(confint(m1)))) #exponentiated, not adjusted</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(dcint))) <span class="co">#exponentiated, adjusted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                5 %  95 %
(Intercept)             0.192 0.105 0.329
pretty_conditionimpasse 2.196 1.078 4.631</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PREDICTIONS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>pred.control <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"control"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient)</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in control,"</span>, pred.control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in control, 0.161290322580645"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>pred.impasse <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"impasse"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient + predictor coeff)</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in impasse,"</span>, pred.impasse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probability of success in impasse, 0.296875000000275"</code></pre>
</div>
</div>
</section>
<section id="inference-3" class="level5">
<h5 class="anchored" data-anchor-id="inference-3">Inference</h5>
<p><strong>In Dissertation</strong></p>
<p><strong>We fit a logistic regression model to explore the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 1.79, p = 0.04, one-tailed). The model predicts that the odds of a correct response on the first question in the impasse condition increase by nearly 120% (<span class="math inline">\(e^{beta_{impasse}}\)</span> = 2.19, 95% CI [1.08, 4.63]) over the control condition. The intercept</strong> <span class="math inline">\(\beta_{0}\)</span> <strong>parameter is also significant, (<span class="math inline">\(e^{b_{0}}\)</span> = 0.19, p &lt; 0.001, 95% CI [0.11, 0.33]) indicating that the odds of a correct response in the control condition are significantly less than even (less than 50/50 chance of correct response in control condition).</strong></p>
<p><em>Equivalent statements:</em></p>
<ul>
<li>being in impasse condition increases log odds of correct response by 0.79 (over control)</li>
<li>being in impasse increases odds of correct response in impasse over control increases by factor of 2.19</li>
<li>probability of correct response in impasse predicted as 30%, vs only 16% in control condition</li>
</ul>
</section>
<section id="visualize-5" class="level5">
<h5 class="anchored" data-anchor-id="visualize-5">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SET MODEL</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m1</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggcoefstats(m1, output = "plot", </span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="co">#               conf.level = 0.90) + </span></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "Log Odds Estimate", </span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "LOGODDS | Q1 Accuracy ~ condition",</span></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "(p is for two tailed test)")</span></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a><span class="co">#PARAMETERS | MODEL | SIMULATED PARAMETERS</span></span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a><span class="co"># similar to bayesian dist of estimate</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- simulate_parameters(m1)</span></span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a><span class="co"># #rename params so intercept is plotted </span></span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[1] &lt;- "condition [control]"</span></span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[2] &lt;- "condition [impasse]"</span></span>
<span id="cb228-18"><a href="#cb228-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result) </span></span>
<span id="cb228-19"><a href="#cb228-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-20"><a href="#cb228-20" aria-hidden="true" tabindex="-1"></a><span class="co">#EQUIVALENCE </span><span class="al">TEST</span><span class="co"> [not sure if appropriate for log model?]</span></span>
<span id="cb228-21"><a href="#cb228-21" aria-hidden="true" tabindex="-1"></a><span class="co"># https://journals.sagepub.com/doi/10.1177/2515245918770963#:~:text=Consequently%2C%20when%20reporting%20an%20equivalence,values%20is%20smaller%20than%20alpha.</span></span>
<span id="cb228-22"><a href="#cb228-22" aria-hidden="true" tabindex="-1"></a><span class="co"># https://easystats.github.io/parameters/reference/equivalence_test.lm.html</span></span>
<span id="cb228-23"><a href="#cb228-23" aria-hidden="true" tabindex="-1"></a><span class="co"># (result &lt;- equivalence_test(m1, rule = "classic", component = c("all")))</span></span>
<span id="cb228-24"><a href="#cb228-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result,   show_intercept = TRUE) + </span></span>
<span id="cb228-25"><a href="#cb228-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_discrete(labels = c("impasse", "control")) + </span></span>
<span id="cb228-26"><a href="#cb228-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs( title = "Equivalence Test for Model Parameter Estimates")</span></span>
<span id="cb228-27"><a href="#cb228-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-28"><a href="#cb228-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-29"><a href="#cb228-29" aria-hidden="true" tabindex="-1"></a><span class="co">#PARAMETERS | MODEL | ODDS RATIO </span></span>
<span id="cb228-30"><a href="#cb228-30" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m1,exponentiate = TRUE)</span></span>
<span id="cb228-31"><a href="#cb228-31" aria-hidden="true" tabindex="-1"></a><span class="co"># #rename params </span></span>
<span id="cb228-32"><a href="#cb228-32" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[1] &lt;- "condition [control]"</span></span>
<span id="cb228-33"><a href="#cb228-33" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[2] &lt;- "condition [impasse]"</span></span>
<span id="cb228-34"><a href="#cb228-34" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result,   show_intercept = TRUE) +  labs(</span></span>
<span id="cb228-35"><a href="#cb228-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   title = "Model Parameter Estimates"</span></span>
<span id="cb228-36"><a href="#cb228-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean() + theme(legend.position="blank")</span></span>
<span id="cb228-37"><a href="#cb228-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-38"><a href="#cb228-38" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb228-39"><a href="#cb228-39" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb228-40"><a href="#cb228-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb228-41"><a href="#cb228-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb228-42"><a href="#cb228-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb228-43"><a href="#cb228-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-44"><a href="#cb228-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb228-45"><a href="#cb228-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb228-46"><a href="#cb228-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span> <span class="co">#remove to put on log scale x axis </span></span>
<span id="cb228-47"><a href="#cb228-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"control"</span>,<span class="st">"impasse"</span>))<span class="sc">+</span></span>
<span id="cb228-48"><a href="#cb228-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb228-49"><a href="#cb228-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb228-50"><a href="#cb228-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"pred"</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="co">#scale y axis to actual range</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL PREDICTION  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of correct response on Q1"</span>,</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">accuracy</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.09&nbsp;&nbsp;0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94&nbsp;&nbsp;5.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.074</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">126</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.026</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-3" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-3">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="co"># report::report(m1)</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print("MODEL PERFORMANCE")</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m1)</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL DIAGNOSTICS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-DIAG-Q1ACC-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="h1b-q1-interpretation-state" class="level2">
<h2 class="anchored" data-anchor-id="h1b-q1-interpretation-state">H1B | Q1 INTERPRETATION STATE</h2>
<p><strong>Do Ss in the IMPASSE condition offer less-orthogonal interpretations on first question?</strong></p>
<p>While absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesnt allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subjects response, and determine if these interpretations differ by experimental condition. State is a 3-category derived response variable that groups the following interpretations:</p>
<ul>
<li><p><strong>orthogonal</strong> [reference category] includes orthogonal and satisficing responses ==&gt; indicates a primarily <em>orthogonal</em> state of coordinate system understanding</p></li>
<li><p><strong>other</strong> includes: blank, reference point, responses that cant be classified (including selecting all datapoints), =&gt; indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly <em>not</em> orthogonal nor triangular</p></li>
<li><p><strong>angular</strong> includes lines connecting responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
<li><p><strong>triangular</strong> includes correct triangular and lines connecting responses as well as responses that include both orthogonal <em>and</em> triangular answers =&gt; indicates some degree of angular/triangular coordinate understanding</p></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th>Research Question</th>
<th>Does Ss in the impasse condition produce less orthogonal responses on the first question?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Hypothesis</strong></td>
<td>H1A | Ss in the IMPASSE condition will have a higher likelihood of producing unknown and and triangle-like response states, relative to orthogonal response states, on the first question</td>
</tr>
<tr class="even">
<td><strong>Data</strong></td>
<td><ul>
<li>data: <code>df_items</code> where <code>q == 1</code></li>
<li>outcome: <code>state</code> ( 4 level factor from 5 level high_interpretation )</li>
<li>predictor: <code>condition</code> [between-subjects factor]</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Analysis Strategy</strong></td>
<td><ol type="1">
<li>Multinomial (Logistic) Regression on state predicted by condition</li>
</ol>
<p>Alternative:</p>
<ul>
<li>Ordinal regression on state; but model doesnt satisfy proportional odds assumption (parallel slopes)</li>
<li>Multinomial or Ordinal regression on high_interpretation (5 category interpretation state which distinguishes between uncertain (blank, reference) unclassifiable, triangle-like and true triangular.) There are some cells with zeros, however (no uncertain responses in control) which means the model cant accurately estimate those comparisons</li>
</ul></td>
</tr>
</tbody>
</table>
<section id="setup-3" class="level4">
<h4 class="anchored" data-anchor-id="setup-3">Setup</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-6" class="level4">
<h4 class="anchored" data-anchor-id="describe-6">Describe</h4>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/VIS-Q1STATE-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A proportional bar chart visualizing the proportion of each interpretations type by condition for each data collection modality (left/right facet) reveals that the pattern of responses are similar regardless of the data collection modality, by differ by condition. In the impasse condition, there are more triangular responses than in control. We see that around half of the incorrect (i.e.&nbsp;not triangular) responses in the impasse condition are not orthogonal-like, but other/unknown.</p>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             control impasse    Sum
  orthogonal  0.8065  0.3125 0.5556
  other       0.0161  0.2812 0.1508
  angular     0.0161  0.1094 0.0635
  triangular  0.1613  0.2969 0.2302
  Sum         1.0000  1.0000 1.0000</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             control impasse Sum
  orthogonal      50      20  70
  other            1      18  19
  angular          1       7   8
  triangular      10      19  29
  Sum             62      64 126</code></pre>
</div>
</div>
</section>
<section id="multinomial-regression" class="level4">
<h4 class="anchored" data-anchor-id="multinomial-regression">MULTINOMIAL REGRESSION</h4>
<p><em>Does condition affect the response state of Q1?</em></p>
<p><em>Fit a logistic regression predicting interpretation state (k=3) by condition(k = 2).</em></p>
<ul>
<li><p>3 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) [essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing [reference category] vs [this category])</p></li>
<li><p>For <em>each</em> equation:</p>
<ul>
<li><span class="math inline">\(\beta_{0}\)</span> <em>= Log Odds of [this category type vs.&nbsp;reference category type) response in CONTROL condition</em></li>
<li><span class="math inline">\(e^{\beta_{0}}\)</span> <em>= ODDS of [this category type vs.&nbsp;reference category type] response in CONTROL condition</em></li>
<li><span class="math inline">\(\beta_{1}\)</span> <em>=</em> <span class="math inline">\(\beta_{1impasse}\)</span> <em>Log Odds (Log OR; change in odds for [this category] type response in impasse (vs) control [log scale])</em></li>
<li><span class="math inline">\(e^{\beta_{1}}\)</span> <em>= ODDS RATIO of [this. vs reference category type] response in IMPASSE (vs) CONTROL</em></li>
<li>Two-tailed NHST <em>Null hypothesis:</em> <span class="math inline">\(\beta_{impasse} = 0\)</span> <em>the odds for [this category of response vs.&nbsp;reference] are not different for IMPASSE condition</em></li>
<li><em>Alternative hypothesis:</em> <span class="math inline">\(\beta_{impasse} \ne 0\)</span> <em>the odds of [this category of response vs.&nbsp;reference] increases or decreases for IMPASSE condition</em></li>
</ul></li>
</ul>
<section id="fit-model-2" class="level5">
<h5 class="anchored" data-anchor-id="fit-model-2">Fit Model</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categories (first is reference)"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "orthogonal" "other"      "angular"    "triangular"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  8 (3 variable)
initial  value 174.673090 
iter  10 value 141.745541
final  value 141.745401 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>catm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  12 (6 variable)
initial  value 174.673090 
iter  10 value 121.936407
final  value 121.916800 
converged</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm)</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, catm<span class="fl">.0</span><span class="sc">$</span>AIC <span class="sc">&gt;</span> catm<span class="sc">$</span>AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIC wth predictor is lower than empty model? TRUE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name   |    Model | df | df_diff |  Chi2 |      p
-------------------------------------------------
catm.0 | multinom |  3 |         |       |       
catm   | multinom |  6 |       3 | 39.66 | &lt; .001</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state2 ~ pretty_condition, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat)</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state2 ~ pretty_condition , data = df)</span></span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.</em></p>
</section>
<section id="describe-7" class="level5">
<h5 class="anchored" data-anchor-id="describe-7">Describe</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> catm</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL SUMMARY"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = state ~ pretty_condition, data = df, model = TRUE)

Coefficients:
           (Intercept) pretty_conditionimpasse
other            -3.91                    3.81
angular          -3.91                    2.86
triangular       -1.61                    1.56

Std. Errors:
           (Intercept) pretty_conditionimpasse
other            1.009                   1.060
angular          1.010                   1.101
triangular       0.346                   0.472

Residual Deviance: 244 
AIC: 256 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  8 (3 variable)
initial  value 174.673090 
iter  10 value 141.745541
final  value 141.745401 
converged</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: state
                 LR Chisq Df Pr(&gt;Chisq)    
pretty_condition     39.7  3    1.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(m)<span class="sc">$</span>standard.errors</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a>(p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           p..Intercept. p.pretty_conditionimpasse
other           1.07e-04                  0.000332
angular         1.07e-04                  0.009354
triangular      3.38e-06                  0.000959</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ODDS RATIOS"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>coefficients))</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           OR..Intercept. OR.pretty_conditionimpasse p..Intercept.
other                0.02                      44.96    0.00010690
angular              0.02                      17.51    0.00010746
triangular           0.20                       4.75    0.00000338
           p.pretty_conditionimpasse
other                       0.000332
angular                     0.009354
triangular                  0.000959</code></pre>
</div>
</div>
</section>
<section id="inference-4" class="level5">
<h5 class="anchored" data-anchor-id="inference-4">Inference</h5>
<ul>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 45 (z = 3.81, p &lt; 0.001) . <strong>Participants in the impasse condition were 45x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving triangle-like response rather than an orthogonal (or satisficing) response by a factor of 17.5 (z = 2.60, p &lt; 0.001 ). <strong>Participants in the impasse condition were almost 6x as likely to give an a triangular response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>Being in the IMPASSE condition <em>increases</em> the odds of giving triangle-like response rather than an orthogonal (or satisficing) response by a factor of 4.8 (z = 3.30, p &lt; 0.001 ). <strong>Participants in the impasse condition were almost 6x as likely to give an a triangular response rather than an orthogonal response compared to participants in control</strong>.</p></li>
<li><p>As with the (binary) logistic regression on accuracy ~ condition, significant model intercepts indicate that the odds of being in any particular response state (vs) orthogonal are significantly different than 1 <em>in the control condition.</em> (i.e.&nbsp;not 1:1 odds or 50% chance of being in that response state. Orthogonal is a much more probable response state in control)</p></li>
<li><p>[need to to double check interpretation, but I <em>think</em> that the OR intercepts converted to probabilities equate to the marginal probability of being in each state in the control condition. which makes sense. I think.?]</p></li>
<li><p>IF I change reference category for condition then the intercepts should no longer be significant. The b1 coefficients should still be significant, but with changed sign (much less likely) [Yup! this works!]</p></li>
</ul>
</section>
<section id="visualize-6" class="level5">
<h5 class="anchored" data-anchor-id="visualize-6">Visualize</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggcoefstats(m, output = "plot", </span></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a><span class="co">#               # conf.level = 0.90,</span></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="co">#               exclude.intercept = FALSE) + </span></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "Log Odds Estimate", </span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "LOGODDS | Q1 State ~ condition",</span></span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "(p is for two tailed test)")</span></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a><span class="co">#PARAMETERS | MODEL | SIMULATED PARAMETERS</span></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a><span class="co"># similar to bayesian dist of estimate</span></span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- simulate_parameters(m)</span></span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, show_intercept = TRUE, stack=FALSE)</span></span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-17"><a href="#cb267-17" aria-hidden="true" tabindex="-1"></a><span class="co">#PARAMETERS | MODEL | ODDS RATIO </span></span>
<span id="cb267-18"><a href="#cb267-18" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m1,exponentiate = TRUE)</span></span>
<span id="cb267-19"><a href="#cb267-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #rename params </span></span>
<span id="cb267-20"><a href="#cb267-20" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[1] &lt;- "condition [control]"</span></span>
<span id="cb267-21"><a href="#cb267-21" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[2] &lt;- "condition [impasse]"</span></span>
<span id="cb267-22"><a href="#cb267-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result,   show_intercept = TRUE) +  labs(</span></span>
<span id="cb267-23"><a href="#cb267-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   title = "Model Parameter Estimates"</span></span>
<span id="cb267-24"><a href="#cb267-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean() + theme(legend.position="blank")</span></span>
<span id="cb267-25"><a href="#cb267-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-26"><a href="#cb267-26" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb267-27"><a href="#cb267-27" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb267-28"><a href="#cb267-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb267-29"><a href="#cb267-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb267-30"><a href="#cb267-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb267-31"><a href="#cb267-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb267-32"><a href="#cb267-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb267-33"><a href="#cb267-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb267-34"><a href="#cb267-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() + #remove to put on log scale x axis </span></span>
<span id="cb267-35"><a href="#cb267-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"control"</span>,<span class="st">"impasse"</span>))<span class="sc">+</span></span>
<span id="cb267-36"><a href="#cb267-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb267-37"><a href="#cb267-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb267-38"><a href="#cb267-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'x' is already present. Adding another scale for 'x', which will
replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-Q1STATE-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL PREDICTION  | Q1 State ~ condition"</span>,</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of more accurate response states Q1"</span>,</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'y' is already present. Adding another scale for 'y', which will
replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-Q1STATE-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MANUALLY BUILD PREDICTION PLOT FACET BY CONDITION RATHER THAN STATE</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(p)[[<span class="dv">1</span>]]  </span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>points <span class="ot">&lt;-</span> d[[<span class="dv">2</span>]]</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>points <span class="ot">&lt;-</span> points <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">recode</span>(PANEL, <span class="st">"1"</span> <span class="ot">=</span><span class="st">"orth"</span>, <span class="st">"2"</span><span class="ot">=</span><span class="st">"other"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"trilike"</span>, <span class="st">"4"</span><span class="ot">=</span><span class="st">"tri"</span>),</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">recode</span>(x, <span class="st">"1"</span><span class="ot">=</span><span class="st">"control"</span>,<span class="st">"2"</span><span class="ot">=</span><span class="st">"impasse"</span>),</span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> y</span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>( prob <span class="sc">~</span> state, <span class="at">group =</span> <span class="sc">~</span>x, <span class="at">data =</span> points) <span class="sc">+</span> </span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>( <span class="at">x =</span> state, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax)) <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>condition) <span class="sc">+</span><span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4_sgc3A_lab_hypotesting_files/figure-html/MODEL-VIS-Q1STATE-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">state</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Response</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;&nbsp;0.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">44.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.51&nbsp;&nbsp;366.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">other</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;&nbsp;0.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">angular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">17.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.98&nbsp;&nbsp;155.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.011</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">angular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.10&nbsp;&nbsp;0.40</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">pretty condition<br>[impasse]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.75</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.87&nbsp;&nbsp;12.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">triangular</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">126</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.140 / 0.133</td>
</tr>

</tbody></table>

</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb273-16"><a href="#cb273-16" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb273-17"><a href="#cb273-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb273-18"><a href="#cb273-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb273-19"><a href="#cb273-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb273-20"><a href="#cb273-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-21"><a href="#cb273-21" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(mixcat.1, s)</span></span>
<span id="cb273-22"><a href="#cb273-22" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb273-23"><a href="#cb273-23" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diagnostics-4" class="level5">
<h5 class="anchored" data-anchor-id="diagnostics-4">Diagnostics</h5>
<div class="cell">
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pretty_condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))</span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(catm, <span class="at">newdata =</span> test, <span class="st">"probs"</span>)</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Predicted Probability of Being in Each State"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Predicted Probability of Being in Each State"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>( x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test, pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  pretty_condition orthogonal  other angular triangular
1          control      0.806 0.0161  0.0161      0.161
2          impasse      0.313 0.2813  0.1094      0.297</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MODEL PERFORMANCE"</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(catm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Can't calculate log-loss.
Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma
-----------------------------------------------------
255.834 | 272.851 | 0.140 |     0.133 | 0.363 | 1.425</code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(catm, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  McFadden   CoxSnell Nagelkerke 
     0.140      0.270      0.302 </code></pre>
</div>
<details>
<summary>CODE</summary>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(generalhoslem)</span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="co">#logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.test(df$state, predict(catm)) #actual states VS predicted states</span></span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The chi-square test tests the decrease in unexplained variance from the baseline model to the final model</span></span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL DIAGNOSTICS")</span></span>
<span id="cb285-10"><a href="#cb285-10" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m) can't do overall diagnostics, have to do them on individual model equations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="todo" class="level5">
<h5 class="anchored" data-anchor-id="todo">TODO</h5>
<ul>
<li>interpretation/reporting of model fit?</li>
<li>sanity check correct interpretation of coefficients &amp; reporting</li>
<li>diagnostics on individual model equations</li>
<li>calculate 1-tailed p values to match directional hypothesis</li>
</ul>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../analysis/SGC3A/3_sgc3A_description.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Description</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../analysis/SGC3A/4_sgc3A_replication_hypotesting.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">(Lab) Hypothesis Testing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb286" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'Study SGC3A | (Lab) Hypothesis Testing'</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="co"># YAML FOR generating modelsummary tables</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment to run those  cells only </span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co"># \usepackage{booktabs}</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a><span class="co"># \usepackage{siunitx}</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a><span class="co"># \newcolumntype{d}{S[input-symbols = ()]}</span></span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a><span class="fu"># (Lab) Hypothesis Testing {#sec-SGC3A-lab-hypotesting}</span></span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true" tabindex="-1"></a>*The purpose of this notebook is test the hypotheses that determined the design of the SGC3A study.*</span>
<span id="cb286-15"><a href="#cb286-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-18"><a href="#cb286-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-19"><a href="#cb286-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP</span></span>
<span id="cb286-20"><a href="#cb286-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb286-21"><a href="#cb286-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb286-22"><a href="#cb286-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-23"><a href="#cb286-23" aria-hidden="true" tabindex="-1"></a><span class="co">#UTILITIES</span></span>
<span id="cb286-24"><a href="#cb286-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># %nin% operator</span></span>
<span id="cb286-25"><a href="#cb286-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#tidy model output</span></span>
<span id="cb286-26"><a href="#cb286-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#tidy mixed models</span></span>
<span id="cb286-27"><a href="#cb286-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic) <span class="co">#favstats</span></span>
<span id="cb286-28"><a href="#cb286-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite) <span class="co">#saving plots as svg</span></span>
<span id="cb286-29"><a href="#cb286-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb286-30"><a href="#cb286-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-31"><a href="#cb286-31" aria-hidden="true" tabindex="-1"></a><span class="co">#VISUALIZATION</span></span>
<span id="cb286-32"><a href="#cb286-32" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr) #arrange plots</span></span>
<span id="cb286-33"><a href="#cb286-33" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cowplot) #arrange shift function plots</span></span>
<span id="cb286-34"><a href="#cb286-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula) <span class="co">#easy graphs</span></span>
<span id="cb286-35"><a href="#cb286-35" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcd) #mosaic plots</span></span>
<span id="cb286-36"><a href="#cb286-36" aria-hidden="true" tabindex="-1"></a><span class="co"># # library(vcdExtra) #mosaic plots</span></span>
<span id="cb286-37"><a href="#cb286-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#printing tables</span></span>
<span id="cb286-38"><a href="#cb286-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co">#visualize model coefficients</span></span>
<span id="cb286-39"><a href="#cb286-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist) <span class="co">#uncertainty viz</span></span>
<span id="cb286-40"><a href="#cb286-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves) <span class="co"># plots. in half</span></span>
<span id="cb286-41"><a href="#cb286-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># violin plot stuffs</span></span>
<span id="cb286-42"><a href="#cb286-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsExpressions)</span>
<span id="cb286-43"><a href="#cb286-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#plots with stats</span></span>
<span id="cb286-44"><a href="#cb286-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary) <span class="co">#latex tables for models!</span></span>
<span id="cb286-45"><a href="#cb286-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-46"><a href="#cb286-46" aria-hidden="true" tabindex="-1"></a><span class="co">#MODELLING</span></span>
<span id="cb286-47"><a href="#cb286-47" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rstatix) #helpful testing functions incl wilcoxon, etc</span></span>
<span id="cb286-48"><a href="#cb286-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report) <span class="co">#easystats reporting</span></span>
<span id="cb286-49"><a href="#cb286-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see) <span class="co">#easystats visualization</span></span>
<span id="cb286-50"><a href="#cb286-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#easystats model diagnostics</span></span>
<span id="cb286-51"><a href="#cb286-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co">#easystats model summary and vis</span></span>
<span id="cb286-52"><a href="#cb286-52" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qqplotr) #confint on qq plot</span></span>
<span id="cb286-53"><a href="#cb286-53" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gmodels) #contingency table and CHISQR</span></span>
<span id="cb286-54"><a href="#cb286-54" aria-hidden="true" tabindex="-1"></a><span class="co"># library(equatiomatic) #extract model equation</span></span>
<span id="cb286-55"><a href="#cb286-55" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pscl) #zeroinfl / hurdle models </span></span>
<span id="cb286-56"><a href="#cb286-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed effects models</span></span>
<span id="cb286-57"><a href="#cb286-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co">#for CIs in glmer</span></span>
<span id="cb286-58"><a href="#cb286-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools) <span class="co">#prediction intervalus for glmers </span></span>
<span id="cb286-59"><a href="#cb286-59" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggeffects) #visualization log regr models</span></span>
<span id="cb286-60"><a href="#cb286-60" aria-hidden="true" tabindex="-1"></a><span class="co">#MULTINOMIAL </span></span>
<span id="cb286-61"><a href="#cb286-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co">#multinomial logistic regression [not mixed] #no p values</span></span>
<span id="cb286-62"><a href="#cb286-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit) <span class="co">#frequentist mixed multinomial logistic regression [mblogit] #gives p values</span></span>
<span id="cb286-63"><a href="#cb286-63" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN</span></span>
<span id="cb286-64"><a href="#cb286-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr) <span class="co">#executing stan</span></span>
<span id="cb286-65"><a href="#cb286-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#bayesian mixed multinomials [+ other bayesian reg models]</span></span>
<span id="cb286-66"><a href="#cb286-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) </span>
<span id="cb286-67"><a href="#cb286-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr) <span class="co">#helping with tidybayes</span></span>
<span id="cb286-68"><a href="#cb286-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb286-69"><a href="#cb286-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-70"><a href="#cb286-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb286-71"><a href="#cb286-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-72"><a href="#cb286-72" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT OPTIONS</span></span>
<span id="cb286-73"><a href="#cb286-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb286-74"><a href="#cb286-74" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb286-75"><a href="#cb286-75" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb286-76"><a href="#cb286-76" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb286-77"><a href="#cb286-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-78"><a href="#cb286-78" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH THEMEING</span></span>
<span id="cb286-79"><a href="#cb286-79" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_minimal()) </span></span>
<span id="cb286-80"><a href="#cb286-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-81"><a href="#cb286-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb286-82"><a href="#cb286-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed</span></span>
<span id="cb286-83"><a href="#cb286-83" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb286-84"><a href="#cb286-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Barlow Semi Condensed"</span>) <span class="sc">+</span></span>
<span id="cb286-85"><a href="#cb286-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb286-86"><a href="#cb286-86" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>),</span>
<span id="cb286-87"><a href="#cb286-87" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Medium"</span>),</span>
<span id="cb286-88"><a href="#cb286-88" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"BarlowSemiCondensed-Bold"</span>,</span>
<span id="cb286-89"><a href="#cb286-89" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb286-90"><a href="#cb286-90" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb286-91"><a href="#cb286-91" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb286-92"><a href="#cb286-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-93"><a href="#cb286-93" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_clean</span>())</span>
<span id="cb286-94"><a href="#cb286-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-95"><a href="#cb286-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-96"><a href="#cb286-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-97"><a href="#cb286-97" aria-hidden="true" tabindex="-1"></a>**Research Questions**</span>
<span id="cb286-98"><a href="#cb286-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-99"><a href="#cb286-99" aria-hidden="true" tabindex="-1"></a>In SGC3A we set out to answer the following question: Does posing a mental impasse improve performance on the interval graph comprehension task?</span>
<span id="cb286-100"><a href="#cb286-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-101"><a href="#cb286-101" aria-hidden="true" tabindex="-1"></a>**Experimental Hypothesis**\</span>
<span id="cb286-102"><a href="#cb286-102" aria-hidden="true" tabindex="-1"></a>*Learners posed with scenario designed to evoke a mental impasse will be more likely to correct interpret the graph.*</span>
<span id="cb286-103"><a href="#cb286-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-104"><a href="#cb286-104" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1A \| Learners in the IMPASSE condition will score higher overall than learners in CONTROL.</span>
<span id="cb286-105"><a href="#cb286-105" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1B \| Learners in the IMPASSE condition will be more likely to correctly answer the first question than learners in CONTROL.</span>
<span id="cb286-106"><a href="#cb286-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-107"><a href="#cb286-107" aria-hidden="true" tabindex="-1"></a>**Null Hypothesis**\</span>
<span id="cb286-108"><a href="#cb286-108" aria-hidden="true" tabindex="-1"></a>*No significant differences in performance will exist between learners in the IMPASSE and CONTROL conditions.*</span>
<span id="cb286-109"><a href="#cb286-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-112"><a href="#cb286-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-113"><a href="#cb286-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: IMPORT-DATA</span></span>
<span id="cb286-114"><a href="#cb286-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb286-115"><a href="#cb286-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| message : false</span></span>
<span id="cb286-116"><a href="#cb286-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-117"><a href="#cb286-117" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb286-118"><a href="#cb286-118" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_participants.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb286-119"><a href="#cb286-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mode <span class="sc">==</span> <span class="st">"lab-synch"</span>) <span class="sc">%&gt;%</span> <span class="co">#only get lab-run participants</span></span>
<span id="cb286-120"><a href="#cb286-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb286-121"><a href="#cb286-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">task_percent =</span> DV_percent_NABS</span>
<span id="cb286-122"><a href="#cb286-122" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb286-123"><a href="#cb286-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-124"><a href="#cb286-124" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3A/data/2-scored-data/sgc3a_scored_items.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb286-125"><a href="#cb286-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(subject <span class="sc">%in%</span> df_subjects<span class="sc">$</span>subject) <span class="sc">%&gt;%</span> <span class="co">#only get lab-run participants</span></span>
<span id="cb286-126"><a href="#cb286-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (</span>
<span id="cb286-127"><a href="#cb286-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.factor</span>(q), </span>
<span id="cb286-128"><a href="#cb286-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.factor</span>(subject),</span>
<span id="cb286-129"><a href="#cb286-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">recode_factor</span>(score_niceABS, <span class="st">"0"</span> <span class="ot">=</span><span class="st">"incorrect"</span>,<span class="st">"1"</span><span class="ot">=</span><span class="st">"correct"</span>),</span>
<span id="cb286-130"><a href="#cb286-130" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS TRI-LIKE</span></span>
<span id="cb286-131"><a href="#cb286-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state = recode_factor(score_SCALED, #for ordinal</span></span>
<span id="cb286-132"><a href="#cb286-132" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-1" = "orth-like",</span></span>
<span id="cb286-133"><a href="#cb286-133" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "-0.5" = "unknown",</span></span>
<span id="cb286-134"><a href="#cb286-134" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0" = "unknown",</span></span>
<span id="cb286-135"><a href="#cb286-135" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "0.5" = "tri-like",</span></span>
<span id="cb286-136"><a href="#cb286-136" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                      "1" = "tri-like"),</span></span>
<span id="cb286-137"><a href="#cb286-137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CODES TVERSKY AS OTHER</span></span>
<span id="cb286-138"><a href="#cb286-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">recode_factor</span>(score_SCALED, <span class="co">#for ordinal</span></span>
<span id="cb286-139"><a href="#cb286-139" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"orthogonal"</span>,</span>
<span id="cb286-140"><a href="#cb286-140" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"-0.5"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb286-141"><a href="#cb286-141" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb286-142"><a href="#cb286-142" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"0.5"</span> <span class="ot">=</span> <span class="st">"angular"</span>,</span>
<span id="cb286-143"><a href="#cb286-143" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"triangular"</span>),</span>
<span id="cb286-144"><a href="#cb286-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="fu">as.ordered</span>(state)) </span>
<span id="cb286-145"><a href="#cb286-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-146"><a href="#cb286-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-147"><a href="#cb286-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-148"><a href="#cb286-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-149"><a href="#cb286-149" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1A \| OVERALL ACCURACY</span></span>
<span id="cb286-150"><a href="#cb286-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-151"><a href="#cb286-151" aria-hidden="true" tabindex="-1"></a>+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-152"><a href="#cb286-152" aria-hidden="true" tabindex="-1"></a>| Research Question     | Do Ss in the IMPASSE condition score higher across the entire task than those in the CONTROL group?                                                                                                                                                                                |</span>
<span id="cb286-153"><a href="#cb286-153" aria-hidden="true" tabindex="-1"></a>+=======================+====================================================================================================================================================================================================================================================================================+</span>
<span id="cb286-154"><a href="#cb286-154" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | (H1) Participants in the IMPASSE condition will be more likely to correctly interpret the graph than those in the CONTROL condition.                                                                                                                                               |</span>
<span id="cb286-155"><a href="#cb286-155" aria-hidden="true" tabindex="-1"></a>+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-156"><a href="#cb286-156" aria-hidden="true" tabindex="-1"></a>| **Data**              | **data**: <span class="in">`df_items`</span> where <span class="in">`q nin 6,9`</span> (the 13 discriminating Qs ), <span class="in">`df_subjects`</span>                                                                                                                                                                                                  |</span>
<span id="cb286-157"><a href="#cb286-157" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                    |</span>
<span id="cb286-158"><a href="#cb286-158" aria-hidden="true" tabindex="-1"></a>|                       | **outcome**:                                                                                                                                                                                                                                                                       |</span>
<span id="cb286-159"><a href="#cb286-159" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                    |</span>
<span id="cb286-160"><a href="#cb286-160" aria-hidden="true" tabindex="-1"></a>|                       | -   <span class="sc">\[</span>at item level<span class="sc">\]</span> : *accuracy* ( factor(incorrect/correct) from <span class="in">`score_niceABS`</span> <span class="sc">\[</span>absolute score<span class="sc">\]</span>                                                                                                                                                                             |</span>
<span id="cb286-161"><a href="#cb286-161" aria-hidden="true" tabindex="-1"></a>|                       | -   <span class="sc">\[</span>subject level<span class="sc">\]</span>: accuracy (number of test phase qs correct from total <span class="in">`s_NABS`</span>)                                                                                                                                                                                              |</span>
<span id="cb286-162"><a href="#cb286-162" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                    |</span>
<span id="cb286-163"><a href="#cb286-163" aria-hidden="true" tabindex="-1"></a>|                       | **predictor**: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                                                                                                                                             |</span>
<span id="cb286-164"><a href="#cb286-164" aria-hidden="true" tabindex="-1"></a>+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-165"><a href="#cb286-165" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Wilcoxon-Rank Sum (Mann-Whitney) test on subject-level total accuracy of test phase (<span class="in">`s_NABS`</span>)                                                                                                                                                                                 |</span>
<span id="cb286-166"><a href="#cb286-166" aria-hidden="true" tabindex="-1"></a>|                       | 2.  Mixed Logistic Regression\                                                                                                                                                                                                                                                     |</span>
<span id="cb286-167"><a href="#cb286-167" aria-hidden="true" tabindex="-1"></a>|                       |     <span class="in">`accuracy`</span> \~ <span class="in">`condition`</span> + (1 \| <span class="in">`subject`</span> ) + (1 \| <span class="in">`question`</span>)\                                                                                                                                                                                                             |</span>
<span id="cb286-168"><a href="#cb286-168" aria-hidden="true" tabindex="-1"></a>|                       |     model effect of condition on probability of correct response <span class="sc">\[</span>during test phase<span class="sc">\]</span> while accounting for subject (and item-level?) effects                                                                                                                                      |</span>
<span id="cb286-169"><a href="#cb286-169" aria-hidden="true" tabindex="-1"></a>+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-170"><a href="#cb286-170" aria-hidden="true" tabindex="-1"></a>| **Alternatives**      | -   Ordinal Mixed Logistic Regression on <span class="in">`scaled_score`</span>                                                                                                                                                                                                                            |</span>
<span id="cb286-171"><a href="#cb286-171" aria-hidden="true" tabindex="-1"></a>|                       | -   OLS Linear Regression: bimodal distribution at tails makes the mean a poor predictor; LMs violate assumptions of normally distributed residuals; both absolute and scaled scores yield non-normal residuals; no transformation of the outcome variables yield normal residuals |</span>
<span id="cb286-172"><a href="#cb286-172" aria-hidden="true" tabindex="-1"></a>+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-173"><a href="#cb286-173" aria-hidden="true" tabindex="-1"></a>| **Notes**             | **Also exploring:**                                                                                                                                                                                                                                                                |</span>
<span id="cb286-174"><a href="#cb286-174" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                    |</span>
<span id="cb286-175"><a href="#cb286-175" aria-hidden="true" tabindex="-1"></a>|                       | -   Hurdle model (mixture model w/ binomial + <span class="sc">\[</span>poisson or negbinom count; 0s from 1 DGP)                                                                                                                                                                                          |</span>
<span id="cb286-176"><a href="#cb286-176" aria-hidden="true" tabindex="-1"></a>|                       | -   Zero Inflated model (mixture model w/ binomial + poisson or negbinom count; 0s from 2 DGPs)                                                                                                                                                                                    |</span>
<span id="cb286-177"><a href="#cb286-177" aria-hidden="true" tabindex="-1"></a>|                       | -   Beta regression hurdle model? (mixture with location and scale parameters <span class="sc">\[</span>mean, variance<span class="sc">\]</span> and hurdles for floor and ceiling effects)                                                                                                                                        |</span>
<span id="cb286-178"><a href="#cb286-178" aria-hidden="true" tabindex="-1"></a>|                       | -   Other way to account for the severe bimodality?                                                                                                                                                                                                                                |</span>
<span id="cb286-179"><a href="#cb286-179" aria-hidden="true" tabindex="-1"></a>+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-180"><a href="#cb286-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-181"><a href="#cb286-181" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb286-184"><a href="#cb286-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-185"><a href="#cb286-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-ACC</span></span>
<span id="cb286-186"><a href="#cb286-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-187"><a href="#cb286-187" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb286-188"><a href="#cb286-188" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, accuracy, subject,q)</span>
<span id="cb286-189"><a href="#cb286-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-190"><a href="#cb286-190" aria-hidden="true" tabindex="-1"></a>df_s <span class="ot">&lt;-</span> df_subjects <span class="sc">%&gt;%</span> </span>
<span id="cb286-191"><a href="#cb286-191" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, task_percent)</span>
<span id="cb286-192"><a href="#cb286-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-193"><a href="#cb286-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-194"><a href="#cb286-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-195"><a href="#cb286-195" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize</span></span>
<span id="cb286-198"><a href="#cb286-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-199"><a href="#cb286-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-ACC</span></span>
<span id="cb286-200"><a href="#cb286-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-201"><a href="#cb286-201" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED PROPORTIONAL BAR CHART</span></span>
<span id="cb286-202"><a href="#cb286-202" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb286-203"><a href="#cb286-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb286-204"><a href="#cb286-204" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb286-205"><a href="#cb286-205" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb286-206"><a href="#cb286-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb286-207"><a href="#cb286-207" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = paletteer::paletteer_d("ggthemes::calc", 2))+</span></span>
<span id="cb286-208"><a href="#cb286-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb286-209"><a href="#cb286-209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb286-210"><a href="#cb286-210" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb286-211"><a href="#cb286-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb286-212"><a href="#cb286-212" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION | Question Accuracy"</span>,</span>
<span id="cb286-213"><a href="#cb286-213" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb286-214"><a href="#cb286-214" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb286-215"><a href="#cb286-215" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb286-216"><a href="#cb286-216" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb286-217"><a href="#cb286-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-218"><a href="#cb286-218" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART BY QUESTION</span></span>
<span id="cb286-219"><a href="#cb286-219" aria-hidden="true" tabindex="-1"></a>df_items <span class="sc">%&gt;%</span> </span>
<span id="cb286-220"><a href="#cb286-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb286-221"><a href="#cb286-221" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb286-222"><a href="#cb286-222" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb286-223"><a href="#cb286-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb286-224"><a href="#cb286-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb286-225"><a href="#cb286-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>q) <span class="sc">+</span></span>
<span id="cb286-226"><a href="#cb286-226" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION | Accuracy by Question"</span>,</span>
<span id="cb286-227"><a href="#cb286-227" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb286-228"><a href="#cb286-228" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb286-229"><a href="#cb286-229" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Q6 and Q9 are non-discriminative"</span>)</span>
<span id="cb286-230"><a href="#cb286-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-231"><a href="#cb286-231" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: FACETED HISTOGRAM</span></span>
<span id="cb286-232"><a href="#cb286-232" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> df_s <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(task_percent))</span>
<span id="cb286-233"><a href="#cb286-233" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_props</span>(<span class="sc">~</span>task_percent,</span>
<span id="cb286-234"><a href="#cb286-234" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="sc">~</span>pretty_condition, <span class="at">data =</span> df_s) <span class="sc">%&gt;%</span></span>
<span id="cb286-235"><a href="#cb286-235" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gf_facet_grid(pretty_condition ~ pretty_mode) %&gt;%</span></span>
<span id="cb286-236"><a href="#cb286-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span>pretty_condition) <span class="sc">%&gt;%</span></span>
<span id="cb286-237"><a href="#cb286-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">data =</span> stats, <span class="at">xintercept =</span> <span class="sc">~</span>mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb286-238"><a href="#cb286-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Correct"</span>,</span>
<span id="cb286-239"><a href="#cb286-239" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"proportion of subjects"</span>,</span>
<span id="cb286-240"><a href="#cb286-240" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"DISTRIBUTION | Total Absolute Score (% Correct)"</span>,</span>
<span id="cb286-241"><a href="#cb286-241" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb286-242"><a href="#cb286-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-243"><a href="#cb286-243" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: RAINCLOUD WITH STATS</span></span>
<span id="cb286-244"><a href="#cb286-244" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb286-245"><a href="#cb286-245" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_s <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">task_percent =</span> task_percent<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb286-246"><a href="#cb286-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-247"><a href="#cb286-247" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span>   <span class="fu">ggbetweenstats</span>(<span class="at">data =</span> df, <span class="at">x =</span> pretty_condition, <span class="at">y =</span> task_percent,</span>
<span id="cb286-248"><a href="#cb286-248" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot.type =</span> <span class="st">"box"</span>, <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb286-249"><a href="#cb286-249" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb286-250"><a href="#cb286-250" aria-hidden="true" tabindex="-1"></a>               <span class="co"># package = "RColorBrewer",</span></span>
<span id="cb286-251"><a href="#cb286-251" aria-hidden="true" tabindex="-1"></a>               <span class="co"># palette = "PRGn",</span></span>
<span id="cb286-252"><a href="#cb286-252" aria-hidden="true" tabindex="-1"></a>               <span class="at">centrality.point.args =</span> <span class="fu">list</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">1</span>),</span>
<span id="cb286-253"><a href="#cb286-253" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.args =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="dv">0</span>), <span class="co">#suppress points</span></span>
<span id="cb286-254"><a href="#cb286-254" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggplot.component =</span> <span class="do">## modify further with `{ggplot2}` functions</span></span>
<span id="cb286-255"><a href="#cb286-255" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(</span>
<span id="cb286-256"><a href="#cb286-256" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># aes(color = pretty_condition, fill = pretty_condition),</span></span>
<span id="cb286-257"><a href="#cb286-257" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_colour_manual(values = paletteer::paletteer_c("viridis::viridis", 3)),</span></span>
<span id="cb286-258"><a href="#cb286-258" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># scale_fill_manual(values = paletteer::paletteer_c("viridis::viridis", 3)),</span></span>
<span id="cb286-259"><a href="#cb286-259" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)))</span>
<span id="cb286-260"><a href="#cb286-260" aria-hidden="true" tabindex="-1"></a>               ) <span class="sc">+</span></span>
<span id="cb286-261"><a href="#cb286-261" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb286-262"><a href="#cb286-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb286-263"><a href="#cb286-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span>,</span>
<span id="cb286-264"><a href="#cb286-264" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>, </span>
<span id="cb286-265"><a href="#cb286-265" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">5</span>, <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb286-266"><a href="#cb286-266" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb286-267"><a href="#cb286-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb286-268"><a href="#cb286-268" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.1</span>,</span>
<span id="cb286-269"><a href="#cb286-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">2</span>, </span>
<span id="cb286-270"><a href="#cb286-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb286-271"><a href="#cb286-271" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb286-272"><a href="#cb286-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb286-273"><a href="#cb286-273" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb286-274"><a href="#cb286-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb286-275"><a href="#cb286-275" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>(</span>
<span id="cb286-276"><a href="#cb286-276" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">width =</span> .<span class="dv">08</span>, <span class="at">height =</span> <span class="fl">1.5</span></span>
<span id="cb286-277"><a href="#cb286-277" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb286-278"><a href="#cb286-278" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb286-279"><a href="#cb286-279" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span>
<span id="cb286-280"><a href="#cb286-280" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>layers[[<span class="dv">3</span>]]<span class="ot">=</span><span class="cn">NULL</span> <span class="co">#remove default boxplot</span></span>
<span id="cb286-281"><a href="#cb286-281" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> statsExpressions<span class="sc">::</span><span class="fu">two_sample_test</span>(<span class="at">y =</span> task_percent, <span class="at">x =</span> pretty_condition, <span class="at">data =</span> df,</span>
<span id="cb286-282"><a href="#cb286-282" aria-hidden="true" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">alternative =</span> <span class="st">"less"</span>,</span>
<span id="cb286-283"><a href="#cb286-283" aria-hidden="true" tabindex="-1"></a>                                <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb286-284"><a href="#cb286-284" aria-hidden="true" tabindex="-1"></a><span class="co">#labels are layer 4</span></span>
<span id="cb286-285"><a href="#cb286-285" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION of Total Score"</span>,</span>
<span id="cb286-286"><a href="#cb286-286" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Percentage of correct responses across task"</span>, <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb286-287"><a href="#cb286-287" aria-hidden="true" tabindex="-1"></a>         <span class="co"># caption=e$expression[[1]],</span></span>
<span id="cb286-288"><a href="#cb286-288" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Impasse condition yields greater variance and more high scores"</span>)</span>
<span id="cb286-289"><a href="#cb286-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-290"><a href="#cb286-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-291"><a href="#cb286-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-292"><a href="#cb286-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-293"><a href="#cb286-293" aria-hidden="true" tabindex="-1"></a><span class="fu">### Describe</span></span>
<span id="cb286-296"><a href="#cb286-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-297"><a href="#cb286-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC2-ACC</span></span>
<span id="cb286-298"><a href="#cb286-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-299"><a href="#cb286-299" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct)"</span></span>
<span id="cb286-300"><a href="#cb286-300" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span>task_percent, <span class="at">data =</span> df_s) </span>
<span id="cb286-301"><a href="#cb286-301" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb286-302"><a href="#cb286-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-303"><a href="#cb286-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-304"><a href="#cb286-304" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION"</span></span>
<span id="cb286-305"><a href="#cb286-305" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">favstats</span>(task_percent <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df_s) </span>
<span id="cb286-306"><a href="#cb286-306" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="sc">%&gt;%</span> <span class="fu">kbl</span> (<span class="at">caption =</span> title) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span>
<span id="cb286-307"><a href="#cb286-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-308"><a href="#cb286-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-309"><a href="#cb286-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-310"><a href="#cb286-310" aria-hidden="true" tabindex="-1"></a><span class="fu">#### WILCOXON RANK SUM (Mann-Whitney Test) </span></span>
<span id="cb286-311"><a href="#cb286-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-312"><a href="#cb286-312" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Non parametric alternative** to t-test; compares median rather than mean by ranking data</span>
<span id="cb286-313"><a href="#cb286-313" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume normality</span>
<span id="cb286-314"><a href="#cb286-314" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does not assume equal variance of samples (homogeneity of variance)</span>
<span id="cb286-315"><a href="#cb286-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-316"><a href="#cb286-316" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Test</span></span>
<span id="cb286-317"><a href="#cb286-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-320"><a href="#cb286-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-321"><a href="#cb286-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: </span><span class="al">TEST</span><span class="co">-ACC</span></span>
<span id="cb286-322"><a href="#cb286-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-323"><a href="#cb286-323" aria-hidden="true" tabindex="-1"></a>(w <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(df_s<span class="sc">$</span>task_percent <span class="sc">~</span> df_s<span class="sc">$</span>pretty_condition,</span>
<span id="cb286-324"><a href="#cb286-324" aria-hidden="true" tabindex="-1"></a>                 <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)) <span class="co">#less, greater</span></span>
<span id="cb286-325"><a href="#cb286-325" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(w)</span>
<span id="cb286-326"><a href="#cb286-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-327"><a href="#cb286-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-328"><a href="#cb286-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-329"><a href="#cb286-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-330"><a href="#cb286-330" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb286-331"><a href="#cb286-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-332"><a href="#cb286-332" aria-hidden="true" tabindex="-1"></a>**(not reported)**</span>
<span id="cb286-333"><a href="#cb286-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-334"><a href="#cb286-334" aria-hidden="true" tabindex="-1"></a>Because the distribution of the outcome variable is not normally distributed, we evaluate the effect of CONDITION on ACCURACY via a non-parametric test. Consistent with our hypothesis, a Wilcoxon rank sum test (with continuity correction) on ACCURACY by CONDITION indicates that data in each condition likely come from different population distributions (W = 1243, p &lt; 0.001; one-tailed), and that the distribution of the control condition is less (i.e. shifted to the left/ lower scores) than the impasse condition (\^{r} = -0.37, 95% CI <span class="sc">\[</span>-1.00, -0.22<span class="sc">\]</span>), a large-sized effect.</span>
<span id="cb286-335"><a href="#cb286-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-336"><a href="#cb286-336" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb286-339"><a href="#cb286-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-340"><a href="#cb286-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIZ-</span><span class="al">TEST</span><span class="co">-ACC</span></span>
<span id="cb286-341"><a href="#cb286-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-342"><a href="#cb286-342" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>( <span class="at">x =</span> pretty_condition, <span class="at">y =</span> task_percent, <span class="at">data =</span> df_s,</span>
<span id="cb286-343"><a href="#cb286-343" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"nonparametric"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb286-344"><a href="#cb286-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-345"><a href="#cb286-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-346"><a href="#cb286-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-347"><a href="#cb286-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-348"><a href="#cb286-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-349"><a href="#cb286-349" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MIXED LOGISTIC REGRESSION</span></span>
<span id="cb286-350"><a href="#cb286-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-351"><a href="#cb286-351" aria-hidden="true" tabindex="-1"></a>*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.*</span>
<span id="cb286-352"><a href="#cb286-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-353"><a href="#cb286-353" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb286-354"><a href="#cb286-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-357"><a href="#cb286-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-358"><a href="#cb286-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-FIT-ACC</span></span>
<span id="cb286-359"><a href="#cb286-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-360"><a href="#cb286-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-361"><a href="#cb286-361" aria-hidden="true" tabindex="-1"></a><span class="do">## 0 | SETUP</span></span>
<span id="cb286-362"><a href="#cb286-362" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm 13 items [all discriminating items]</span></span>
<span id="cb286-363"><a href="#cb286-363" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_i) <span class="sc">/</span> <span class="fu">nrow</span>(df_s) <span class="sc">==</span> <span class="dv">13</span></span>
<span id="cb286-364"><a href="#cb286-364" aria-hidden="true" tabindex="-1"></a><span class="co">#confirm all factors </span></span>
<span id="cb286-365"><a href="#cb286-365" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(df_i<span class="sc">$</span>q) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>subject) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>pretty_condition) <span class="sc">&amp;&amp;</span> <span class="fu">is.factor</span>(df_i<span class="sc">$</span>accuracy)</span>
<span id="cb286-366"><a href="#cb286-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-367"><a href="#cb286-367" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 | SETUP RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb286-368"><a href="#cb286-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-369"><a href="#cb286-369" aria-hidden="true" tabindex="-1"></a><span class="co">#:: EMPTY MODEL (baseline, no random effect)</span></span>
<span id="cb286-370"><a href="#cb286-370" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Empty fixed model"</span>)</span>
<span id="cb286-371"><a href="#cb286-371" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df_i) </span>
<span id="cb286-372"><a href="#cb286-372" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb286-373"><a href="#cb286-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-374"><a href="#cb286-374" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT</span></span>
<span id="cb286-375"><a href="#cb286-375" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject intercept random model"</span>)</span>
<span id="cb286-376"><a href="#cb286-376" aria-hidden="true" tabindex="-1"></a>mm.rS <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb286-377"><a href="#cb286-377" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.rS)</span></span>
<span id="cb286-378"><a href="#cb286-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-379"><a href="#cb286-379" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb286-380"><a href="#cb286-380" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)))</span>
<span id="cb286-381"><a href="#cb286-381" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,mm.rS) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb286-382"><a href="#cb286-382" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,mm.rS))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb286-383"><a href="#cb286-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-384"><a href="#cb286-384" aria-hidden="true" tabindex="-1"></a><span class="co">#:: RANDOM INTERCEPT SUBJECT + ITEM</span></span>
<span id="cb286-385"><a href="#cb286-385" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subject Intercept + Item intercept random model"</span>)</span>
<span id="cb286-386"><a href="#cb286-386" aria-hidden="true" tabindex="-1"></a>mm.rSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb286-387"><a href="#cb286-387" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.rSQ)</span></span>
<span id="cb286-388"><a href="#cb286-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-389"><a href="#cb286-389" aria-hidden="true" tabindex="-1"></a><span class="co"># :: </span><span class="al">TEST</span><span class="co"> random effect</span></span>
<span id="cb286-390"><a href="#cb286-390" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model?"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rS)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)))</span>
<span id="cb286-391"><a href="#cb286-391" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rS, mm.rSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb286-392"><a href="#cb286-392" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rS, mm.rSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb286-393"><a href="#cb286-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-394"><a href="#cb286-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-395"><a href="#cb286-395" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 | ADD FIXED EFFECT CONDITION</span></span>
<span id="cb286-396"><a href="#cb286-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-397"><a href="#cb286-397" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"FIXED Condition + Subject &amp; Item random intercepts"</span>)</span>
<span id="cb286-398"><a href="#cb286-398" aria-hidden="true" tabindex="-1"></a>mm.CrSQ <span class="ot">&lt;-</span> <span class="fu">glmer</span>(accuracy <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q) ,</span>
<span id="cb286-399"><a href="#cb286-399" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_i, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb286-400"><a href="#cb286-400" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.CrSQ)</span></span>
<span id="cb286-401"><a href="#cb286-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-402"><a href="#cb286-402" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC decreases w/ new model"</span>, <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.rSQ)) <span class="sc">&gt;</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(mm.CrSQ)) )</span>
<span id="cb286-403"><a href="#cb286-403" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb286-404"><a href="#cb286-404" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(mm.rSQ,mm.CrSQ))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb286-405"><a href="#cb286-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-406"><a href="#cb286-406" aria-hidden="true" tabindex="-1"></a><span class="co"># control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))</span></span>
<span id="cb286-407"><a href="#cb286-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-408"><a href="#cb286-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-409"><a href="#cb286-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-410"><a href="#cb286-410" aria-hidden="true" tabindex="-1"></a>*A likelihood ratio test indicates adding CONDITION as a fixed effect to a logistic regression model including a fixed effect random intercepts for SUBJECT and QUESTION explains more variance in the data than random-effects only model.*</span>
<span id="cb286-411"><a href="#cb286-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-412"><a href="#cb286-412" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb286-413"><a href="#cb286-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-416"><a href="#cb286-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-417"><a href="#cb286-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-ACC</span></span>
<span id="cb286-418"><a href="#cb286-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-419"><a href="#cb286-419" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: SETUP</span></span>
<span id="cb286-420"><a href="#cb286-420" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.CrSQ</span>
<span id="cb286-421"><a href="#cb286-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-422"><a href="#cb286-422" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb286-423"><a href="#cb286-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-424"><a href="#cb286-424" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb286-425"><a href="#cb286-425" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb286-426"><a href="#cb286-426" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"SIGNIFICANCE TEST [non directional]"</span>)</span>
<span id="cb286-427"><a href="#cb286-427" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m)</span>
<span id="cb286-428"><a href="#cb286-428" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL INFO"</span>)</span>
<span id="cb286-429"><a href="#cb286-429" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m)</span>
<span id="cb286-430"><a href="#cb286-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-431"><a href="#cb286-431" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: MANUAL ONE-SIDED SIGTEST </span></span>
<span id="cb286-432"><a href="#cb286-432" aria-hidden="true" tabindex="-1"></a><span class="co">#note: anova and chi square are always one-tailed, but that is independent of being one-sided</span></span>
<span id="cb286-433"><a href="#cb286-433" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half</span></span>
<span id="cb286-434"><a href="#cb286-434" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb286-435"><a href="#cb286-435" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb286-436"><a href="#cb286-436" aria-hidden="true" tabindex="-1"></a><span class="co"># tt &lt;- 2*pnorm(summary(m)$coefficients[2,3], lower.tail = F)</span></span>
<span id="cb286-437"><a href="#cb286-437" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("p value for two-tailed test, null B = 0 : ",round(tt,5))</span></span>
<span id="cb286-438"><a href="#cb286-438" aria-hidden="true" tabindex="-1"></a><span class="co"># ot &lt;- pnorm(summary(m)$coefficients[2,3], lower.tail = F)</span></span>
<span id="cb286-439"><a href="#cb286-439" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("BUT we want a one  directional, null: B &lt;= 0: ",round(ot,5))</span></span>
<span id="cb286-440"><a href="#cb286-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-441"><a href="#cb286-441" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb286-442"><a href="#cb286-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-443"><a href="#cb286-443" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span>
<span id="cb286-444"><a href="#cb286-444" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb286-445"><a href="#cb286-445" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m),</span></span>
<span id="cb286-446"><a href="#cb286-446" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se,</span></span>
<span id="cb286-447"><a href="#cb286-447" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb286-448"><a href="#cb286-448" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>)</span>
<span id="cb286-449"><a href="#cb286-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-450"><a href="#cb286-450" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb286-451"><a href="#cb286-451" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- exp(tab))</span></span>
<span id="cb286-452"><a href="#cb286-452" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-453"><a href="#cb286-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-454"><a href="#cb286-454" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span>
<span id="cb286-455"><a href="#cb286-455" aria-hidden="true" tabindex="-1"></a><span class="co">#probability control = plogis(intercept)</span></span>
<span id="cb286-456"><a href="#cb286-456" aria-hidden="true" tabindex="-1"></a><span class="co">#probability impasse = plogis(intercept + coefficient)</span></span>
<span id="cb286-457"><a href="#cb286-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-458"><a href="#cb286-458" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM predict()</span></span>
<span id="cb286-459"><a href="#cb286-459" aria-hidden="true" tabindex="-1"></a><span class="co"># newdata &lt;- df_i %&gt;% dplyr::select(pretty_condition, subject, q)</span></span>
<span id="cb286-460"><a href="#cb286-460" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- predict(m, newdata = newdata, type = "response")</span></span>
<span id="cb286-461"><a href="#cb286-461" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- cbind(newdata, preds)</span></span>
<span id="cb286-462"><a href="#cb286-462" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- preds %&gt;% </span></span>
<span id="cb286-463"><a href="#cb286-463" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, preds) %&gt;% </span></span>
<span id="cb286-464"><a href="#cb286-464" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition) %&gt;% </span></span>
<span id="cb286-465"><a href="#cb286-465" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(</span></span>
<span id="cb286-466"><a href="#cb286-466" aria-hidden="true" tabindex="-1"></a><span class="co">#     median = median(preds),</span></span>
<span id="cb286-467"><a href="#cb286-467" aria-hidden="true" tabindex="-1"></a><span class="co">#     se = sd(preds)/sqrt(n()),</span></span>
<span id="cb286-468"><a href="#cb286-468" aria-hidden="true" tabindex="-1"></a><span class="co">#     lwr = median - 1.96*se,</span></span>
<span id="cb286-469"><a href="#cb286-469" aria-hidden="true" tabindex="-1"></a><span class="co">#     upr = median + 1.96*se)</span></span>
<span id="cb286-470"><a href="#cb286-470" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb286-471"><a href="#cb286-471" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb286-472"><a href="#cb286-472" aria-hidden="true" tabindex="-1"></a><span class="co">#FROM merTools</span></span>
<span id="cb286-473"><a href="#cb286-473" aria-hidden="true" tabindex="-1"></a><span class="co">#setup df </span></span>
<span id="cb286-474"><a href="#cb286-474" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, subject, q)</span>
<span id="cb286-475"><a href="#cb286-475" aria-hidden="true" tabindex="-1"></a><span class="co">#make predictions</span></span>
<span id="cb286-476"><a href="#cb286-476" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predictInterval</span>(m, <span class="at">newdata =</span> newdata,</span>
<span id="cb286-477"><a href="#cb286-477" aria-hidden="true" tabindex="-1"></a>                              <span class="at">which =</span> <span class="st">"fixed"</span>, <span class="co">#full, fixed or random for those only</span></span>
<span id="cb286-478"><a href="#cb286-478" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"probability"</span>, <span class="co">#linear.prediction</span></span>
<span id="cb286-479"><a href="#cb286-479" aria-hidden="true" tabindex="-1"></a>                              <span class="at">stat =</span> <span class="st">"median"</span>,</span>
<span id="cb286-480"><a href="#cb286-480" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n.sims =</span> <span class="dv">1000</span>,</span>
<span id="cb286-481"><a href="#cb286-481" aria-hidden="true" tabindex="-1"></a>                              <span class="at">level =</span> <span class="fl">0.80</span>) <span class="co">#width of prediction interval</span></span>
<span id="cb286-482"><a href="#cb286-482" aria-hidden="true" tabindex="-1"></a><span class="co">#join predictions to the new dataframe</span></span>
<span id="cb286-483"><a href="#cb286-483" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb286-484"><a href="#cb286-484" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize</span></span>
<span id="cb286-485"><a href="#cb286-485" aria-hidden="true" tabindex="-1"></a>(summ_preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb286-486"><a href="#cb286-486" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, fit, lwr, upr) <span class="sc">%&gt;%</span> </span>
<span id="cb286-487"><a href="#cb286-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pretty_condition) <span class="sc">%&gt;%</span> </span>
<span id="cb286-488"><a href="#cb286-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb286-489"><a href="#cb286-489" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(fit),</span>
<span id="cb286-490"><a href="#cb286-490" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">median</span>(lwr),</span>
<span id="cb286-491"><a href="#cb286-491" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">median</span>(upr)</span>
<span id="cb286-492"><a href="#cb286-492" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb286-493"><a href="#cb286-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-494"><a href="#cb286-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-495"><a href="#cb286-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-496"><a href="#cb286-496" aria-hidden="true" tabindex="-1"></a><span class="fu">##### INFERENCE</span></span>
<span id="cb286-497"><a href="#cb286-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-498"><a href="#cb286-498" aria-hidden="true" tabindex="-1"></a>***(In Dissertation)***</span>
<span id="cb286-499"><a href="#cb286-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-500"><a href="#cb286-500" aria-hidden="true" tabindex="-1"></a>We fit a mixed effects binomial logistic regression model with random intercepts for subjects and questions.  Note that we choose to model these data at the item (i.e. question) rather than than subject (i.e. total score) level because the structure of a mixed effects model allows us to differentiate between random variance introduced by individual subjects and questions, versus the expected systematic variance of CONDITION. A likelihood ratio test indicates that a model including a fixed effect of CONDITION explains significantly more variance in the data than an intercepts-only baseline model ($\chi^2 (3) = 18.66, p &lt; 0.001$). The explanatory power of the entire model is substantial ($conditional \ R^2 = 0.89$) and the part related to the fixed effect CONDITION ($marginal \ R^2$) explains 15\% of variance. **Consistent with our hypothesis, the impasse condition substantially increases the odds of a correct response.** Across the entire task participants in the impasse condition were 75 times more likely to offer a correct response, compared with those in the control condition ( $e^{\beta_1} = 75.51, p &lt; 0.001$, $95 \% \  CI <span class="co">[</span><span class="ot">8.46, 674</span><span class="co">]</span>$). Based on the fixed effect of CONDITION, The model predicts that the probability of a correct response in the control condition is effectively 0% (95% CI <span class="co">[</span><span class="ot">6.8e-4, 0.02</span><span class="co">]</span>), and the probability of a correct response in the impasse condition increases to 24% (95% CI <span class="co">[</span><span class="ot">0.06, 0.60</span><span class="co">]</span>). </span>
<span id="cb286-501"><a href="#cb286-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-504"><a href="#cb286-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-505"><a href="#cb286-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-ACC</span></span>
<span id="cb286-506"><a href="#cb286-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-507"><a href="#cb286-507" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb286-508"><a href="#cb286-508" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb286-509"><a href="#cb286-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-510"><a href="#cb286-510" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb286-511"><a href="#cb286-511" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb286-512"><a href="#cb286-512" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb286-513"><a href="#cb286-513" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb286-514"><a href="#cb286-514" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb286-515"><a href="#cb286-515" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-516"><a href="#cb286-516" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb286-517"><a href="#cb286-517" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb286-518"><a href="#cb286-518" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb286-519"><a href="#cb286-519" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb286-520"><a href="#cb286-520" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb286-521"><a href="#cb286-521" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb286-522"><a href="#cb286-522" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb286-523"><a href="#cb286-523" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb286-524"><a href="#cb286-524" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb286-525"><a href="#cb286-525" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',</span></span>
<span id="cb286-526"><a href="#cb286-526" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes)</span></span>
<span id="cb286-527"><a href="#cb286-527" aria-hidden="true" tabindex="-1"></a><span class="co">#              # output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb286-528"><a href="#cb286-528" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb286-529"><a href="#cb286-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-530"><a href="#cb286-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-531"><a href="#cb286-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-532"><a href="#cb286-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-533"><a href="#cb286-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-534"><a href="#cb286-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-535"><a href="#cb286-535" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb286-536"><a href="#cb286-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-539"><a href="#cb286-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-540"><a href="#cb286-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-ACC</span></span>
<span id="cb286-541"><a href="#cb286-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-542"><a href="#cb286-542" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb286-543"><a href="#cb286-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-544"><a href="#cb286-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-545"><a href="#cb286-545" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | lOG ODDS</span></span>
<span id="cb286-546"><a href="#cb286-546" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">transform =</span> <span class="cn">NULL</span>,</span>
<span id="cb286-547"><a href="#cb286-547" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb286-548"><a href="#cb286-548" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb286-549"><a href="#cb286-549" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb286-550"><a href="#cb286-550" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.05</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb286-551"><a href="#cb286-551" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.95</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb286-552"><a href="#cb286-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model ESTIMATE | Odds Ratio"</span>,</span>
<span id="cb286-553"><a href="#cb286-553" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb286-554"><a href="#cb286-554" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb286-555"><a href="#cb286-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-556"><a href="#cb286-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-557"><a href="#cb286-557" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb286-558"><a href="#cb286-558" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">transform =</span> <span class="st">"exp"</span>,</span>
<span id="cb286-559"><a href="#cb286-559" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb286-560"><a href="#cb286-560" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb286-561"><a href="#cb286-561" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb286-562"><a href="#cb286-562" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.05</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb286-563"><a href="#cb286-563" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.95</span> ) <span class="sc">+</span> <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb286-564"><a href="#cb286-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model ESTIMATE | Log Odds"</span>,</span>
<span id="cb286-565"><a href="#cb286-565" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb286-566"><a href="#cb286-566" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>)</span>
<span id="cb286-567"><a href="#cb286-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-568"><a href="#cb286-568" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb286-569"><a href="#cb286-569" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m, exponentiate = TRUE, component = "all")</span></span>
<span id="cb286-570"><a href="#cb286-570" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result) + labs(</span></span>
<span id="cb286-571"><a href="#cb286-571" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model ESTIMATE | ODDS RATIO"</span></span>
<span id="cb286-572"><a href="#cb286-572" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb286-573"><a href="#cb286-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-574"><a href="#cb286-574" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb286-575"><a href="#cb286-575" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- equivalence_test(m, rule = "classic", ci=0.9) #classic[tost], , bayes</span></span>
<span id="cb286-576"><a href="#cb286-576" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result)</span></span>
<span id="cb286-577"><a href="#cb286-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-578"><a href="#cb286-578" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb286-579"><a href="#cb286-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-580"><a href="#cb286-580" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb286-581"><a href="#cb286-581" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="eff",</span></span>
<span id="cb286-582"><a href="#cb286-582" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb286-583"><a href="#cb286-583" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb286-584"><a href="#cb286-584" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb286-585"><a href="#cb286-585" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb286-586"><a href="#cb286-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-587"><a href="#cb286-587" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb286-588"><a href="#cb286-588" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)[[<span class="dv">1</span>]]  <span class="sc">+</span></span>
<span id="cb286-589"><a href="#cb286-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb286-590"><a href="#cb286-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb286-591"><a href="#cb286-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model PREDICTION | Probability of Accurate Response"</span>,</span>
<span id="cb286-592"><a href="#cb286-592" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of correct response"</span>,</span>
<span id="cb286-593"><a href="#cb286-593" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability of Correct Response"</span>, <span class="at">x =</span> <span class="st">"Condition"</span></span>
<span id="cb286-594"><a href="#cb286-594" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb286-595"><a href="#cb286-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-596"><a href="#cb286-596" aria-hidden="true" tabindex="-1"></a><span class="co">#GGDIST | MODEL | PREDICTED PROBABILITIES</span></span>
<span id="cb286-597"><a href="#cb286-597" aria-hidden="true" tabindex="-1"></a>preds <span class="sc">%&gt;%</span> </span>
<span id="cb286-598"><a href="#cb286-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">x =</span> fit, <span class="at">y =</span> pretty_condition, <span class="at">fill =</span> pretty_condition)) <span class="sc">+</span> </span>
<span id="cb286-599"><a href="#cb286-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">normalize =</span> <span class="st">"xy"</span>) <span class="sc">+</span> </span>
<span id="cb286-600"><a href="#cb286-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>() <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb286-601"><a href="#cb286-601" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model PREDICTION | Probability of Accurate Response"</span>,</span>
<span id="cb286-602"><a href="#cb286-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"TODO check preds to see if fixed or includes random"</span></span>
<span id="cb286-603"><a href="#cb286-603" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb286-604"><a href="#cb286-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-605"><a href="#cb286-605" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMULATE FIXED EFFECTS</span></span>
<span id="cb286-606"><a href="#cb286-606" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate values of fixed effects </span></span>
<span id="cb286-607"><a href="#cb286-607" aria-hidden="true" tabindex="-1"></a><span class="co"># (feEx &lt;- FEsim(m,  oddsRatio = FALSE, n.sims = 1000))</span></span>
<span id="cb286-608"><a href="#cb286-608" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT estimates of fixed effects</span></span>
<span id="cb286-609"><a href="#cb286-609" aria-hidden="true" tabindex="-1"></a><span class="co"># plotFEsim(feEx) +</span></span>
<span id="cb286-610"><a href="#cb286-610" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() + labs(title = "Coefficient Plot of InstEval Model",</span></span>
<span id="cb286-611"><a href="#cb286-611" aria-hidden="true" tabindex="-1"></a><span class="co">#                     x = "Median Effect Estimate")</span></span>
<span id="cb286-612"><a href="#cb286-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-613"><a href="#cb286-613" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMULATE RANDOM EFFECTS</span></span>
<span id="cb286-614"><a href="#cb286-614" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate values of random effects</span></span>
<span id="cb286-615"><a href="#cb286-615" aria-hidden="true" tabindex="-1"></a><span class="co"># reEx &lt;- REsim(m)</span></span>
<span id="cb286-616"><a href="#cb286-616" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT estimates of random effects</span></span>
<span id="cb286-617"><a href="#cb286-617" aria-hidden="true" tabindex="-1"></a><span class="co"># plotREsim(reEx)</span></span>
<span id="cb286-618"><a href="#cb286-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-619"><a href="#cb286-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-620"><a href="#cb286-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-621"><a href="#cb286-621" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb286-622"><a href="#cb286-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-625"><a href="#cb286-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-626"><a href="#cb286-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DIAG-ACC</span></span>
<span id="cb286-627"><a href="#cb286-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb286-628"><a href="#cb286-628" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb286-629"><a href="#cb286-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-630"><a href="#cb286-630" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb286-631"><a href="#cb286-631" aria-hidden="true" tabindex="-1"></a><span class="co"># report(m)</span></span>
<span id="cb286-632"><a href="#cb286-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-633"><a href="#cb286-633" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL PERFORMANCE")</span></span>
<span id="cb286-634"><a href="#cb286-634" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m)</span></span>
<span id="cb286-635"><a href="#cb286-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-636"><a href="#cb286-636" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DIAGNOSTICS"</span>)</span>
<span id="cb286-637"><a href="#cb286-637" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m)</span>
<span id="cb286-638"><a href="#cb286-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-639"><a href="#cb286-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-640"><a href="#cb286-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-641"><a href="#cb286-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-642"><a href="#cb286-642" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Sanity Check :: Bayesian</span></span>
<span id="cb286-643"><a href="#cb286-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-646"><a href="#cb286-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-647"><a href="#cb286-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: BAYES-MODEL-FIT-ACC</span></span>
<span id="cb286-648"><a href="#cb286-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-649"><a href="#cb286-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-650"><a href="#cb286-650" aria-hidden="true" tabindex="-1"></a><span class="co"># ## 0 | SETUP</span></span>
<span id="cb286-651"><a href="#cb286-651" aria-hidden="true" tabindex="-1"></a><span class="co"># #confirm 13 items [all discriminating items]</span></span>
<span id="cb286-652"><a href="#cb286-652" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow(df_i) / nrow(df_s) == 13</span></span>
<span id="cb286-653"><a href="#cb286-653" aria-hidden="true" tabindex="-1"></a><span class="co"># #confirm all factors </span></span>
<span id="cb286-654"><a href="#cb286-654" aria-hidden="true" tabindex="-1"></a><span class="co"># is.factor(df_i$q) &amp;&amp; is.factor(df_i$subject) &amp;&amp; is.factor(df_i$pretty_condition) &amp;&amp; is.factor(df_i$accuracy)</span></span>
<span id="cb286-655"><a href="#cb286-655" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-656"><a href="#cb286-656" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb286-657"><a href="#cb286-657" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-658"><a href="#cb286-658" aria-hidden="true" tabindex="-1"></a><span class="co"># print("FIXED Condition + Subject &amp; Item random intercepts")</span></span>
<span id="cb286-659"><a href="#cb286-659" aria-hidden="true" tabindex="-1"></a><span class="co"># Bmm.CrSQ &lt;- brm( accuracy ~ pretty_condition + (1|subject) + (1|q), </span></span>
<span id="cb286-660"><a href="#cb286-660" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = df_i, </span></span>
<span id="cb286-661"><a href="#cb286-661" aria-hidden="true" tabindex="-1"></a><span class="co">#                  family = "bernoulli",</span></span>
<span id="cb286-662"><a href="#cb286-662" aria-hidden="true" tabindex="-1"></a><span class="co">#                  chains = 4, iter = 2000, warmup = 1000,</span></span>
<span id="cb286-663"><a href="#cb286-663" aria-hidden="true" tabindex="-1"></a><span class="co">#                  cores = 4, seed = 1234,</span></span>
<span id="cb286-664"><a href="#cb286-664" aria-hidden="true" tabindex="-1"></a><span class="co">#                  backend = "cmdstanr",</span></span>
<span id="cb286-665"><a href="#cb286-665" aria-hidden="true" tabindex="-1"></a><span class="co">#                  file ="analysis/SGC3A/models/sgc3a_brms_acc_Bmm.CrSQ_LAB.rds")</span></span>
<span id="cb286-666"><a href="#cb286-666" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-667"><a href="#cb286-667" aria-hidden="true" tabindex="-1"></a><span class="co"># #get Priors </span></span>
<span id="cb286-668"><a href="#cb286-668" aria-hidden="true" tabindex="-1"></a><span class="co"># # describe_priors(Bmm.CrSQ)</span></span>
<span id="cb286-669"><a href="#cb286-669" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-670"><a href="#cb286-670" aria-hidden="true" tabindex="-1"></a><span class="co"># #GRAPHICAL POSTERIOR PREDICTION CHECKS</span></span>
<span id="cb286-671"><a href="#cb286-671" aria-hidden="true" tabindex="-1"></a><span class="co"># pp_check(Bmm.CrSQ)</span></span>
<span id="cb286-672"><a href="#cb286-672" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-673"><a href="#cb286-673" aria-hidden="true" tabindex="-1"></a><span class="co"># #DESCRIBE MODEL</span></span>
<span id="cb286-674"><a href="#cb286-674" aria-hidden="true" tabindex="-1"></a><span class="co"># (d &lt;- describe_posterior(ci=.95, Bmm.CrSQ))</span></span>
<span id="cb286-675"><a href="#cb286-675" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-676"><a href="#cb286-676" aria-hidden="true" tabindex="-1"></a><span class="co"># #SEE MODEL</span></span>
<span id="cb286-677"><a href="#cb286-677" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(pd(Bmm.CrSQ))</span></span>
<span id="cb286-678"><a href="#cb286-678" aria-hidden="true" tabindex="-1"></a><span class="co"># #convert to a pd value</span></span>
<span id="cb286-679"><a href="#cb286-679" aria-hidden="true" tabindex="-1"></a><span class="co"># (pds &lt;- pd_to_p(d$pd))</span></span>
<span id="cb286-680"><a href="#cb286-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-681"><a href="#cb286-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-682"><a href="#cb286-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-683"><a href="#cb286-683" aria-hidden="true" tabindex="-1"></a>*A likelihood ratio test indicates adding CONDITION as a fixed effect to a logistic regression model including a fixed effect random intercepts for SUBJECT and QUESTION explains more variance in the data than random-effects only model.*</span>
<span id="cb286-684"><a href="#cb286-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-685"><a href="#cb286-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-688"><a href="#cb286-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-689"><a href="#cb286-689" aria-hidden="true" tabindex="-1"></a><span class="co"># #::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE</span></span>
<span id="cb286-690"><a href="#cb286-690" aria-hidden="true" tabindex="-1"></a><span class="co"># ##WORKING</span></span>
<span id="cb286-691"><a href="#cb286-691" aria-hidden="true" tabindex="-1"></a><span class="co"># ## VIS probability of correct response</span></span>
<span id="cb286-692"><a href="#cb286-692" aria-hidden="true" tabindex="-1"></a><span class="co"># #TAKES A REALLY LONG TIME</span></span>
<span id="cb286-693"><a href="#cb286-693" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-694"><a href="#cb286-694" aria-hidden="true" tabindex="-1"></a><span class="co"># #1 | get draws</span></span>
<span id="cb286-695"><a href="#cb286-695" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb286-696"><a href="#cb286-696" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;%</span></span>
<span id="cb286-697"><a href="#cb286-697" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.CrSQ,</span></span>
<span id="cb286-698"><a href="#cb286-698" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb286-699"><a href="#cb286-699" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb286-700"><a href="#cb286-700" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb286-701"><a href="#cb286-701" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb286-702"><a href="#cb286-702" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb286-703"><a href="#cb286-703" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-704"><a href="#cb286-704" aria-hidden="true" tabindex="-1"></a><span class="co"># #OR load from file</span></span>
<span id="cb286-705"><a href="#cb286-705" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws &lt;- read_rds("analysis/SGC3A/models/draws_BB.catCrSQ.rds")</span></span>
<span id="cb286-706"><a href="#cb286-706" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-707"><a href="#cb286-707" aria-hidden="true" tabindex="-1"></a><span class="co"># #2| VISUALIZE PREDICTIONS | GGDIST</span></span>
<span id="cb286-708"><a href="#cb286-708" aria-hidden="true" tabindex="-1"></a><span class="co"># ##TODO figure out height normalization.</span></span>
<span id="cb286-709"><a href="#cb286-709" aria-hidden="true" tabindex="-1"></a><span class="co"># ##do it with much smaller number of draws </span></span>
<span id="cb286-710"><a href="#cb286-710" aria-hidden="true" tabindex="-1"></a><span class="co"># #TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb286-711"><a href="#cb286-711" aria-hidden="true" tabindex="-1"></a><span class="co"># #TAKES A REAAALY LONG TIME</span></span>
<span id="cb286-712"><a href="#cb286-712" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% sample_n(1000) %&gt;% </span></span>
<span id="cb286-713"><a href="#cb286-713" aria-hidden="true" tabindex="-1"></a><span class="co"># #   ggplot(aes(x = .value,  y = 0, fill = pretty_condition)) +</span></span>
<span id="cb286-714"><a href="#cb286-714" aria-hidden="true" tabindex="-1"></a><span class="co"># #   stat_slab(width = c(.95), alpha = 1, normalize="xy") +</span></span>
<span id="cb286-715"><a href="#cb286-715" aria-hidden="true" tabindex="-1"></a><span class="co"># #   #normalize = all, panels, xy, groups, none</span></span>
<span id="cb286-716"><a href="#cb286-716" aria-hidden="true" tabindex="-1"></a><span class="co"># #   xlim(0,1) + labs(</span></span>
<span id="cb286-717"><a href="#cb286-717" aria-hidden="true" tabindex="-1"></a><span class="co"># #     title = "Model Predicted Probability of Correct Response",</span></span>
<span id="cb286-718"><a href="#cb286-718" aria-hidden="true" tabindex="-1"></a><span class="co"># #     x = "probability of correct response",</span></span>
<span id="cb286-719"><a href="#cb286-719" aria-hidden="true" tabindex="-1"></a><span class="co"># #     y = "Interpretation"</span></span>
<span id="cb286-720"><a href="#cb286-720" aria-hidden="true" tabindex="-1"></a><span class="co"># #   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb286-721"><a href="#cb286-721" aria-hidden="true" tabindex="-1"></a><span class="co"># # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb286-722"><a href="#cb286-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-723"><a href="#cb286-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-724"><a href="#cb286-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-725"><a href="#cb286-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-726"><a href="#cb286-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-727"><a href="#cb286-727" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1A \| OVERALL INTERPRETATION STATE</span></span>
<span id="cb286-728"><a href="#cb286-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-729"><a href="#cb286-729" aria-hidden="true" tabindex="-1"></a>**Do Ss in the IMPASSE condition offer less-orthogonal interpretations across the test phase questions?**</span>
<span id="cb286-730"><a href="#cb286-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-731"><a href="#cb286-731" aria-hidden="true" tabindex="-1"></a>While absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesn't allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subject's response, and determine if these interpretations differ by experimental condition. State is a 3-category variable that groups the following interpretations:</span>
<span id="cb286-732"><a href="#cb286-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-733"><a href="#cb286-733" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"orthogonal"** <span class="sc">\[</span>reference category<span class="sc">\]</span> includes orthogonal and satisficing responses ==<span class="sc">\&gt;</span> indicates a primarily *orthogonal* state of coordinate system understanding</span>
<span id="cb286-734"><a href="#cb286-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-735"><a href="#cb286-735" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"other"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =<span class="sc">\&gt;</span> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular</span>
<span id="cb286-736"><a href="#cb286-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-737"><a href="#cb286-737" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"angular"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb286-738"><a href="#cb286-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-739"><a href="#cb286-739" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"triangular"** includes correct triangular and 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb286-740"><a href="#cb286-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-741"><a href="#cb286-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-742"><a href="#cb286-742" aria-hidden="true" tabindex="-1"></a>+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-743"><a href="#cb286-743" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does Ss in the impasse condition produce less orthogonal responses across questions?                                          |</span>
<span id="cb286-744"><a href="#cb286-744" aria-hidden="true" tabindex="-1"></a>+=======================+=================================================================================================================================================+</span>
<span id="cb286-745"><a href="#cb286-745" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the IMPASSE condition will have a higher likelihood of producing unknown and triangle-like response states across all items |</span>
<span id="cb286-746"><a href="#cb286-746" aria-hidden="true" tabindex="-1"></a>+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-747"><a href="#cb286-747" aria-hidden="true" tabindex="-1"></a>| **Data**              | -   data: <span class="in">`df_items`</span> where <span class="in">`q nin 6,9`</span> (13 discriminant test phase items)                                                              |</span>
<span id="cb286-748"><a href="#cb286-748" aria-hidden="true" tabindex="-1"></a>|                       | -   outcome: <span class="in">`state`</span> ( 3 level factor from high_interpretation )                                                                                |</span>
<span id="cb286-749"><a href="#cb286-749" aria-hidden="true" tabindex="-1"></a>|                       | -   predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                          |</span>
<span id="cb286-750"><a href="#cb286-750" aria-hidden="true" tabindex="-1"></a>+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-751"><a href="#cb286-751" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  MIXED Multinomial (Logistic) Regression on state predicted by condition                                                                     |</span>
<span id="cb286-752"><a href="#cb286-752" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                 |</span>
<span id="cb286-753"><a href="#cb286-753" aria-hidden="true" tabindex="-1"></a>|                       | Alternative:                                                                                                                                    |</span>
<span id="cb286-754"><a href="#cb286-754" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                 |</span>
<span id="cb286-755"><a href="#cb286-755" aria-hidden="true" tabindex="-1"></a>|                       | -   MIXED Ordinal regression on state (doesn't meet proportional odds assumption-I think)                                                       |</span>
<span id="cb286-756"><a href="#cb286-756" aria-hidden="true" tabindex="-1"></a>|                       | -   MIXED Multinomial or Ordinal regression on high_interpretation (some cells are 0, produces problems)                                        |</span>
<span id="cb286-757"><a href="#cb286-757" aria-hidden="true" tabindex="-1"></a>+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-758"><a href="#cb286-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-759"><a href="#cb286-759" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb286-760"><a href="#cb286-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-763"><a href="#cb286-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-764"><a href="#cb286-764" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-STATE</span></span>
<span id="cb286-765"><a href="#cb286-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-766"><a href="#cb286-766" aria-hidden="true" tabindex="-1"></a>df_i <span class="ot">=</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,subject,state,pretty_condition)</span>
<span id="cb286-767"><a href="#cb286-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-768"><a href="#cb286-768" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-769"><a href="#cb286-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-772"><a href="#cb286-772" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-773"><a href="#cb286-773" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb286-774"><a href="#cb286-774" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb286-775"><a href="#cb286-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb286-776"><a href="#cb286-776" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb286-777"><a href="#cb286-777" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb286-778"><a href="#cb286-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb286-779"><a href="#cb286-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb286-780"><a href="#cb286-780" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb286-781"><a href="#cb286-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb286-782"><a href="#cb286-782" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DISTRIBUTION of Interpretation"</span>,</span>
<span id="cb286-783"><a href="#cb286-783" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb286-784"><a href="#cb286-784" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Questions"</span>,</span>
<span id="cb286-785"><a href="#cb286-785" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb286-786"><a href="#cb286-786" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb286-787"><a href="#cb286-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-788"><a href="#cb286-788" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb286-789"><a href="#cb286-789" aria-hidden="true" tabindex="-1"></a>df_i <span class="sc">%&gt;%</span> </span>
<span id="cb286-790"><a href="#cb286-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb286-791"><a href="#cb286-791" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb286-792"><a href="#cb286-792" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb286-793"><a href="#cb286-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb286-794"><a href="#cb286-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_d</span>(<span class="st">"ggthemes::calc"</span>, <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb286-795"><a href="#cb286-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>q) <span class="sc">+</span></span>
<span id="cb286-796"><a href="#cb286-796" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interpretation by Question"</span>,</span>
<span id="cb286-797"><a href="#cb286-797" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb286-798"><a href="#cb286-798" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb286-799"><a href="#cb286-799" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb286-800"><a href="#cb286-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-801"><a href="#cb286-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-802"><a href="#cb286-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-803"><a href="#cb286-803" aria-hidden="true" tabindex="-1"></a>A proportional bar chart visualizing the proportion of each interpretations type by condition for each data collection modality (left/right facet) reveals that the pattern of responses are similar regardless of the data collection modality, by differ by condition. In the impasse condition, there are more triangular responses than in control. In the impasse condition, there are also more positive transition (i.e. triangle-like) and neutral (ie. blank or uncertain response types) than in the control condition.</span>
<span id="cb286-804"><a href="#cb286-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-807"><a href="#cb286-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-808"><a href="#cb286-808" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb286-809"><a href="#cb286-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-810"><a href="#cb286-810" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb286-811"><a href="#cb286-811" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb286-812"><a href="#cb286-812" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb286-813"><a href="#cb286-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-814"><a href="#cb286-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-815"><a href="#cb286-815" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df_i<span class="sc">$</span>state, df_i<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb286-816"><a href="#cb286-816" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb286-817"><a href="#cb286-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-818"><a href="#cb286-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-819"><a href="#cb286-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-820"><a href="#cb286-820" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MIXED MULTINOMIAL REGRESSION</span></span>
<span id="cb286-821"><a href="#cb286-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-822"><a href="#cb286-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-823"><a href="#cb286-823" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of of items across the task?*</span>
<span id="cb286-824"><a href="#cb286-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-825"><a href="#cb286-825" aria-hidden="true" tabindex="-1"></a>*Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).*</span>
<span id="cb286-826"><a href="#cb286-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-827"><a href="#cb286-827" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can use mclogit mblogit() with random effect *or* bayesian brms package b/c nlme, lme4 don't support random effects on multinomial (ie no categorical family on glmer())</span>
<span id="cb286-828"><a href="#cb286-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-829"><a href="#cb286-829" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative would be to manually run <span class="co">[</span><span class="ot">k-1</span><span class="co">]</span> X binomial mixed models <span class="sc">\[</span>should compare outcomes<span class="sc">\]</span></span>
<span id="cb286-830"><a href="#cb286-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-831"><a href="#cb286-831" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">k-1</span><span class="co">]</span> equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) <span class="sc">\[</span>essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing <span class="sc">\[</span>reference category<span class="sc">\]</span> vs <span class="sc">\[</span>this category<span class="sc">\]</span>)</span>
<span id="cb286-832"><a href="#cb286-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-833"><a href="#cb286-833" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For *each* equation:</span>
<span id="cb286-834"><a href="#cb286-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-835"><a href="#cb286-835" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{0}$ *= Log Odds of \[this category type vs. reference category type) response in CONTROL condition*</span>
<span id="cb286-836"><a href="#cb286-836" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{0}}$ *= ODDS of \[this category type vs. reference category type\] response in CONTROL condition*</span>
<span id="cb286-837"><a href="#cb286-837" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{1}$ *=* $\beta_{1impasse}$ *Log Odds (Log OR; change in odds for \[this category\] type response in impasse (vs) control \[log scale\])*</span>
<span id="cb286-838"><a href="#cb286-838" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{1}}$ *= ODDS RATIO of \[this. vs reference category type\] response in IMPASSE (vs) CONTROL*</span>
<span id="cb286-839"><a href="#cb286-839" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Two-tailed NHST *Null hypothesis:* $\beta_{impasse} = 0$ *the odds for \[this category of response vs. reference\] are not different for IMPASSE condition*</span>
<span id="cb286-840"><a href="#cb286-840" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*Alternative hypothesis:* $\beta_{impasse} \ne 0$ *the odds of \[this category of response vs. reference\] increases or decreases for IMPASSE condition*</span>
<span id="cb286-841"><a href="#cb286-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-842"><a href="#cb286-842" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model \[mblogit\]</span></span>
<span id="cb286-843"><a href="#cb286-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-846"><a href="#cb286-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-847"><a href="#cb286-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-MBLOGIT-STATE</span></span>
<span id="cb286-848"><a href="#cb286-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-849"><a href="#cb286-849" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb286-850"><a href="#cb286-850" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline category logit" model matches multinom()</span></span>
<span id="cb286-851"><a href="#cb286-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-852"><a href="#cb286-852" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb286-853"><a href="#cb286-853" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span>
<span id="cb286-854"><a href="#cb286-854" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_i<span class="sc">$</span>state)</span>
<span id="cb286-855"><a href="#cb286-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-856"><a href="#cb286-856" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb286-857"><a href="#cb286-857" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb286-858"><a href="#cb286-858" aria-hidden="true" tabindex="-1"></a>mm.cat.rSQ <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> <span class="dv">1</span> , </span>
<span id="cb286-859"><a href="#cb286-859" aria-hidden="true" tabindex="-1"></a>                      <span class="at">random =</span> <span class="fu">list</span>( <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>subject, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb286-860"><a href="#cb286-860" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> df_i)</span>
<span id="cb286-861"><a href="#cb286-861" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mm.cat.rSQ)</span></span>
<span id="cb286-862"><a href="#cb286-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-863"><a href="#cb286-863" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb286-864"><a href="#cb286-864" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb286-865"><a href="#cb286-865" aria-hidden="true" tabindex="-1"></a>mm.cat.CrSQ <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(state <span class="sc">~</span> pretty_condition , </span>
<span id="cb286-866"><a href="#cb286-866" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>( <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>subject, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb286-867"><a href="#cb286-867" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> df_i)</span>
<span id="cb286-868"><a href="#cb286-868" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mm.cat.CrSQ)</span></span>
<span id="cb286-869"><a href="#cb286-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-870"><a href="#cb286-870" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb286-871"><a href="#cb286-871" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, <span class="fu">AIC</span>(mm.cat.rSQ) <span class="sc">&gt;</span> <span class="fu">AIC</span>(mm.cat.CrSQ))</span>
<span id="cb286-872"><a href="#cb286-872" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(mm.cat.rSQ, mm.cat.CrSQ)</span>
<span id="cb286-873"><a href="#cb286-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-874"><a href="#cb286-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-875"><a href="#cb286-875" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb286-876"><a href="#cb286-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-879"><a href="#cb286-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-880"><a href="#cb286-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-MBLOGIT-STATE</span></span>
<span id="cb286-881"><a href="#cb286-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-882"><a href="#cb286-882" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mm.cat.CrSQ</span>
<span id="cb286-883"><a href="#cb286-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-884"><a href="#cb286-884" aria-hidden="true" tabindex="-1"></a><span class="co">#DESCRIBE MODEL</span></span>
<span id="cb286-885"><a href="#cb286-885" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb286-886"><a href="#cb286-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-887"><a href="#cb286-887" aria-hidden="true" tabindex="-1"></a><span class="co">#INTERPRET COEFFICIENTS</span></span>
<span id="cb286-888"><a href="#cb286-888" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span>
<span id="cb286-889"><a href="#cb286-889" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>)</span>
<span id="cb286-890"><a href="#cb286-890" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb286-891"><a href="#cb286-891" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m,   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">conf.method =</span> <span class="st">"Wald"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-892"><a href="#cb286-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-893"><a href="#cb286-893" aria-hidden="true" tabindex="-1"></a><span class="co"># paste("MODEL INFO")</span></span>
<span id="cb286-894"><a href="#cb286-894" aria-hidden="true" tabindex="-1"></a><span class="co"># glance(m)</span></span>
<span id="cb286-895"><a href="#cb286-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-896"><a href="#cb286-896" aria-hidden="true" tabindex="-1"></a><span class="co">#PERFORMANCE</span></span>
<span id="cb286-897"><a href="#cb286-897" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m)</span>
<span id="cb286-898"><a href="#cb286-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-899"><a href="#cb286-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-900"><a href="#cb286-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-901"><a href="#cb286-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-902"><a href="#cb286-902" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO Inference</span></span>
<span id="cb286-903"><a href="#cb286-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-904"><a href="#cb286-904" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 12 (z = 6.48, p \&lt; 0.001) . **Participants in the impasse condition were 12x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb286-905"><a href="#cb286-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-906"><a href="#cb286-906" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving 'triangle-like' response rather than an orthogonal (or satisficing) response by a factor of 29 (z = 4.63, p \&lt; 0.001 ). **Participants in the impasse condition were more than 29x as likely to give an a triangular response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb286-907"><a href="#cb286-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-908"><a href="#cb286-908" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As with the (binary) logistic regression on accuracy \~ condition, significant model intercepts indicate that the odds of being in any particular response state (vs) orthogonal are significantly different than 1 *in the control condition.* (i.e. not 1:1 odds or 50% chance of being in that response state. Orthogonal is a much more probable response state in control)</span>
<span id="cb286-909"><a href="#cb286-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-912"><a href="#cb286-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-913"><a href="#cb286-913" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-MBLOGIT-STATE</span></span>
<span id="cb286-914"><a href="#cb286-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-915"><a href="#cb286-915" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb286-916"><a href="#cb286-916" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb286-917"><a href="#cb286-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-918"><a href="#cb286-918" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb286-919"><a href="#cb286-919" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb286-920"><a href="#cb286-920" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb286-921"><a href="#cb286-921" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb286-922"><a href="#cb286-922" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb286-923"><a href="#cb286-923" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-924"><a href="#cb286-924" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb286-925"><a href="#cb286-925" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb286-926"><a href="#cb286-926" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb286-927"><a href="#cb286-927" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb286-928"><a href="#cb286-928" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb286-929"><a href="#cb286-929" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb286-930"><a href="#cb286-930" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb286-931"><a href="#cb286-931" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb286-932"><a href="#cb286-932" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb286-933"><a href="#cb286-933" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',</span></span>
<span id="cb286-934"><a href="#cb286-934" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes)</span></span>
<span id="cb286-935"><a href="#cb286-935" aria-hidden="true" tabindex="-1"></a><span class="co">#              # output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb286-936"><a href="#cb286-936" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb286-937"><a href="#cb286-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-938"><a href="#cb286-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-939"><a href="#cb286-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-940"><a href="#cb286-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-941"><a href="#cb286-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-942"><a href="#cb286-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-943"><a href="#cb286-943" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb286-944"><a href="#cb286-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-947"><a href="#cb286-947" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-948"><a href="#cb286-948" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-MBLOGIT-STATE</span></span>
<span id="cb286-949"><a href="#cb286-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-950"><a href="#cb286-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-951"><a href="#cb286-951" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb286-952"><a href="#cb286-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-953"><a href="#cb286-953" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb286-954"><a href="#cb286-954" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, </span>
<span id="cb286-955"><a href="#cb286-955" aria-hidden="true" tabindex="-1"></a>           <span class="at">transform =</span> <span class="st">"exp"</span>,</span>
<span id="cb286-956"><a href="#cb286-956" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb286-957"><a href="#cb286-957" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb286-958"><a href="#cb286-958" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-959"><a href="#cb286-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-960"><a href="#cb286-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-961"><a href="#cb286-961" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO SEPARATE THIS BY EQUATION </span></span>
<span id="cb286-962"><a href="#cb286-962" aria-hidden="true" tabindex="-1"></a><span class="co"># ms &lt;- model_parameters(Bmm.cat.CrSQ, component = "conditional")</span></span>
<span id="cb286-963"><a href="#cb286-963" aria-hidden="true" tabindex="-1"></a><span class="co"># m1 &lt;- ms %&gt;% filter(str_detect(Parameter, "muother"))</span></span>
<span id="cb286-964"><a href="#cb286-964" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(m1)</span></span>
<span id="cb286-965"><a href="#cb286-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-966"><a href="#cb286-966" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb286-967"><a href="#cb286-967" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb286-968"><a href="#cb286-968" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_labels =</span> <span class="cn">TRUE</span>, <span class="at">n_columns =</span> <span class="dv">3</span>)</span>
<span id="cb286-969"><a href="#cb286-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-970"><a href="#cb286-970" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- simulate_parameters(m)</span></span>
<span id="cb286-971"><a href="#cb286-971" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, stack = FALSE)</span></span>
<span id="cb286-972"><a href="#cb286-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-973"><a href="#cb286-973" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb286-974"><a href="#cb286-974" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb286-975"><a href="#cb286-975" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb286-976"><a href="#cb286-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-977"><a href="#cb286-977" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb286-978"><a href="#cb286-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-979"><a href="#cb286-979" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb286-980"><a href="#cb286-980" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="eff",</span></span>
<span id="cb286-981"><a href="#cb286-981" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb286-982"><a href="#cb286-982" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb286-983"><a href="#cb286-983" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb286-984"><a href="#cb286-984" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb286-985"><a href="#cb286-985" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-986"><a href="#cb286-986" aria-hidden="true" tabindex="-1"></a><span class="co"># #PLOT MODEL PREDICTION</span></span>
<span id="cb286-987"><a href="#cb286-987" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type = "pred")[[1]] + </span></span>
<span id="cb286-988"><a href="#cb286-988" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0,1) + labs(</span></span>
<span id="cb286-989"><a href="#cb286-989" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb286-990"><a href="#cb286-990" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "Impasse increases Probability of Correct Response"</span></span>
<span id="cb286-991"><a href="#cb286-991" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb286-992"><a href="#cb286-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-993"><a href="#cb286-993" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO EMMEANS for the estimated marginal means</span></span>
<span id="cb286-994"><a href="#cb286-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-995"><a href="#cb286-995" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-996"><a href="#cb286-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-997"><a href="#cb286-997" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb286-998"><a href="#cb286-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1001"><a href="#cb286-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1002"><a href="#cb286-1002" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m)</span></span>
<span id="cb286-1003"><a href="#cb286-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1004"><a href="#cb286-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1005"><a href="#cb286-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1006"><a href="#cb286-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1007"><a href="#cb286-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1008"><a href="#cb286-1008" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model \[brms\]</span></span>
<span id="cb286-1009"><a href="#cb286-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1012"><a href="#cb286-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1013"><a href="#cb286-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: FIT-BRMS-STATE</span></span>
<span id="cb286-1014"><a href="#cb286-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1015"><a href="#cb286-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#BAYESIAN RANDOM ONLY</span></span>
<span id="cb286-1016"><a href="#cb286-1016" aria-hidden="true" tabindex="-1"></a>Bmm.cat.rSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb286-1017"><a href="#cb286-1017" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb286-1018"><a href="#cb286-1018" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb286-1019"><a href="#cb286-1019" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb286-1020"><a href="#cb286-1020" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb286-1021"><a href="#cb286-1021" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb286-1022"><a href="#cb286-1022" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb286-1023"><a href="#cb286-1023" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.rSQ_LAB.rds"</span>)</span>
<span id="cb286-1024"><a href="#cb286-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1025"><a href="#cb286-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1026"><a href="#cb286-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#UNINFORMATIVE PRIOR BAYESIAN MIXED VERSION</span></span>
<span id="cb286-1027"><a href="#cb286-1027" aria-hidden="true" tabindex="-1"></a><span class="co"># flat_Bmm.cat.CrSQ &lt;- brm( state ~ pretty_condition + (1|subject) + (1|q), </span></span>
<span id="cb286-1028"><a href="#cb286-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = df_i, </span></span>
<span id="cb286-1029"><a href="#cb286-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#                  family = "categorical",</span></span>
<span id="cb286-1030"><a href="#cb286-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#                  chains = 4, iter = 2500, warmup = 1000,</span></span>
<span id="cb286-1031"><a href="#cb286-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#                  cores = 4, seed = 1234,</span></span>
<span id="cb286-1032"><a href="#cb286-1032" aria-hidden="true" tabindex="-1"></a><span class="co">#                  save_pars = save_pars(all = TRUE),</span></span>
<span id="cb286-1033"><a href="#cb286-1033" aria-hidden="true" tabindex="-1"></a><span class="co">#                  # backend = "cmdstanr",</span></span>
<span id="cb286-1034"><a href="#cb286-1034" aria-hidden="true" tabindex="-1"></a><span class="co">#                  file ="analysis/SGC3A/models/sgc3a_brms_state_FLAT_Bmm.cat.CrSQ_LAB.rds")</span></span>
<span id="cb286-1035"><a href="#cb286-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1036"><a href="#cb286-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1037"><a href="#cb286-1037" aria-hidden="true" tabindex="-1"></a><span class="co"># determine default priors </span></span>
<span id="cb286-1038"><a href="#cb286-1038" aria-hidden="true" tabindex="-1"></a><span class="co"># prior_summary(flat_Bmm.cat.CrSQ)</span></span>
<span id="cb286-1039"><a href="#cb286-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1040"><a href="#cb286-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#set priors [see justification, below]</span></span>
<span id="cb286-1041"><a href="#cb286-1041" aria-hidden="true" tabindex="-1"></a>inf_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb286-1042"><a href="#cb286-1042" aria-hidden="true" tabindex="-1"></a>  <span class="co"># too strong?</span></span>
<span id="cb286-1043"><a href="#cb286-1043" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prior(normal(-6.91, 0.201),  class = "Intercept", dpar = "muangular"),</span></span>
<span id="cb286-1044"><a href="#cb286-1044" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prior(normal(-6.91, 0.201),  class = "Intercept", dpar = "muother"),</span></span>
<span id="cb286-1045"><a href="#cb286-1045" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prior(normal(-6.91, 0.201),  class = "Intercept", dpar = "mutriangular"),</span></span>
<span id="cb286-1046"><a href="#cb286-1046" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on INTERCEPTS </span></span>
<span id="cb286-1047"><a href="#cb286-1047" aria-hidden="true" tabindex="-1"></a>  <span class="co">#25% chance of each answer in control, scale = from 0.01 to 62%</span></span>
<span id="cb286-1048"><a href="#cb286-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb286-1049"><a href="#cb286-1049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb286-1050"><a href="#cb286-1050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.5</span>),  <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>),</span>
<span id="cb286-1051"><a href="#cb286-1051" aria-hidden="true" tabindex="-1"></a>  <span class="co">#prior on COEFFICIENT</span></span>
<span id="cb286-1052"><a href="#cb286-1052" aria-hidden="true" tabindex="-1"></a>  <span class="co">#likely to change odds between 0 and 2.4</span></span>
<span id="cb286-1053"><a href="#cb286-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muangular"</span>),</span>
<span id="cb286-1054"><a href="#cb286-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"muother"</span>),</span>
<span id="cb286-1055"><a href="#cb286-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.42</span>), <span class="at">class =</span> b, <span class="at">coef=</span><span class="st">"pretty_conditionimpasse"</span>, <span class="at">dpar =</span> <span class="st">"mutriangular"</span>)</span>
<span id="cb286-1056"><a href="#cb286-1056" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb286-1057"><a href="#cb286-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1058"><a href="#cb286-1058" aria-hidden="true" tabindex="-1"></a><span class="co">#INFORMATIVE PRIORS</span></span>
<span id="cb286-1059"><a href="#cb286-1059" aria-hidden="true" tabindex="-1"></a>Bmm.cat.CrSQ <span class="ot">&lt;-</span> <span class="fu">brm</span>( state <span class="sc">~</span> pretty_condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q), </span>
<span id="cb286-1060"><a href="#cb286-1060" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_i, </span>
<span id="cb286-1061"><a href="#cb286-1061" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"categorical"</span>,</span>
<span id="cb286-1062"><a href="#cb286-1062" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> inf_priors,</span>
<span id="cb286-1063"><a href="#cb286-1063" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb286-1064"><a href="#cb286-1064" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb286-1065"><a href="#cb286-1065" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb286-1066"><a href="#cb286-1066" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.98</span>),  <span class="co"># to deal with divergent transitions</span></span>
<span id="cb286-1067"><a href="#cb286-1067" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># backend = "cmdstanr",</span></span>
<span id="cb286-1068"><a href="#cb286-1068" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span><span class="st">"analysis/SGC3A/models/sgc3a_brms_state_Bmm.cat.CrSQ_LAB.rds"</span></span>
<span id="cb286-1069"><a href="#cb286-1069" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb286-1070"><a href="#cb286-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1071"><a href="#cb286-1071" aria-hidden="true" tabindex="-1"></a><span class="co">#a bayes factor model comparison of the flat vs informative prior models suggest convicing evidence that </span></span>
<span id="cb286-1072"><a href="#cb286-1072" aria-hidden="true" tabindex="-1"></a><span class="co">#informative prior model is a better fit</span></span>
<span id="cb286-1073"><a href="#cb286-1073" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesfactor(Bmm.cat.CrSQ, flat_Bmm.cat.CrSQ)</span></span>
<span id="cb286-1074"><a href="#cb286-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1075"><a href="#cb286-1075" aria-hidden="true" tabindex="-1"></a><span class="co"># PRIORS LOGIC </span></span>
<span id="cb286-1076"><a href="#cb286-1076" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.bayesrulesbook.com/chapter-13.html#building-the-logistic-regression-model</span></span>
<span id="cb286-1077"><a href="#cb286-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1078"><a href="#cb286-1078" aria-hidden="true" tabindex="-1"></a><span class="co">#expectation for probability of _better_ response [in control]?</span></span>
<span id="cb286-1079"><a href="#cb286-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#very low probability center: 0.1% [very low]; as logodds = logit(0.001) = -6.91</span></span>
<span id="cb286-1080"><a href="#cb286-1080" aria-hidden="true" tabindex="-1"></a><span class="co">#range from 0 to 55%  logit(0.55) = 0.201</span></span>
<span id="cb286-1081"><a href="#cb286-1081" aria-hidden="true" tabindex="-1"></a><span class="co">#probability of 0.1 to 55% is equivalent to [logodds] -6.91 +/ 2* 0.201</span></span>
<span id="cb286-1082"><a href="#cb286-1082" aria-hidden="true" tabindex="-1"></a><span class="co">#therefore... prior for intercept =&gt; Normal(6.91, 0)</span></span>
<span id="cb286-1083"><a href="#cb286-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1084"><a href="#cb286-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1085"><a href="#cb286-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#expectation for probability of _better_ response [in impasse]?</span></span>
<span id="cb286-1086"><a href="#cb286-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#increases probablity from 0 % </span></span>
<span id="cb286-1087"><a href="#cb286-1087" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 [very low]; as OR  = exp(0) = 1</span></span>
<span id="cb286-1088"><a href="#cb286-1088" aria-hidden="true" tabindex="-1"></a><span class="co">#range from 0 to 90%  exp(0.9) = 2.46</span></span>
<span id="cb286-1089"><a href="#cb286-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#probability of 0 to 90% is equivalent to [ODDS scale] 1 +/ 2* 2.42</span></span>
<span id="cb286-1090"><a href="#cb286-1090" aria-hidden="true" tabindex="-1"></a><span class="co">#on log odds scale ? [0, ]</span></span>
<span id="cb286-1091"><a href="#cb286-1091" aria-hidden="true" tabindex="-1"></a><span class="co">#therefore... prior for intercept =&gt; Normal(1, 2.42)</span></span>
<span id="cb286-1092"><a href="#cb286-1092" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># prior = normal(0.07, 0.035),</span></span>
<span id="cb286-1093"><a href="#cb286-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1094"><a href="#cb286-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1095"><a href="#cb286-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1096"><a href="#cb286-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1097"><a href="#cb286-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1098"><a href="#cb286-1098" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb286-1099"><a href="#cb286-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1102"><a href="#cb286-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1103"><a href="#cb286-1103" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-BRMS-STATE</span></span>
<span id="cb286-1104"><a href="#cb286-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1105"><a href="#cb286-1105" aria-hidden="true" tabindex="-1"></a><span class="co"># best model</span></span>
<span id="cb286-1106"><a href="#cb286-1106" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> Bmm.cat.CrSQ</span>
<span id="cb286-1107"><a href="#cb286-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1108"><a href="#cb286-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::: PRINT MODEL </span></span>
<span id="cb286-1109"><a href="#cb286-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1110"><a href="#cb286-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL"</span>)</span>
<span id="cb286-1111"><a href="#cb286-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb286-1112"><a href="#cb286-1112" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(<span class="at">ci=</span>.<span class="dv">95</span>, Bmm.cat.CrSQ))</span>
<span id="cb286-1113"><a href="#cb286-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1114"><a href="#cb286-1114" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"BAYES FACTOR [comparison to null]"</span>)</span>
<span id="cb286-1115"><a href="#cb286-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#think of this like the anova(model) to get p values for each predictor</span></span>
<span id="cb286-1116"><a href="#cb286-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#has to recompile the models with rstan. total drag</span></span>
<span id="cb286-1117"><a href="#cb286-1117" aria-hidden="true" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">bayesfactor</span>(Bmm.cat.rSQ, m))</span>
<span id="cb286-1118"><a href="#cb286-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1119"><a href="#cb286-1119" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"DESCRIBE POSTERIOR"</span>)</span>
<span id="cb286-1120"><a href="#cb286-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1121"><a href="#cb286-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb286-1122"><a href="#cb286-1122" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(diag(stats::vcov(m)))</span></span>
<span id="cb286-1123"><a href="#cb286-1123" aria-hidden="true" tabindex="-1"></a><span class="co"># # table of estimates with 95% CI</span></span>
<span id="cb286-1124"><a href="#cb286-1124" aria-hidden="true" tabindex="-1"></a><span class="co"># (tab &lt;- cbind(Est = fixef(m),</span></span>
<span id="cb286-1125"><a href="#cb286-1125" aria-hidden="true" tabindex="-1"></a><span class="co">#               LL = fixef(m) - 1.96 * se,</span></span>
<span id="cb286-1126"><a href="#cb286-1126" aria-hidden="true" tabindex="-1"></a><span class="co">#               UL = fixef(m) + 1.96 * se))</span></span>
<span id="cb286-1127"><a href="#cb286-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1128"><a href="#cb286-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"LOG ODDS"</span>)</span>
<span id="cb286-1129"><a href="#cb286-1129" aria-hidden="true" tabindex="-1"></a>(l <span class="ot">&lt;-</span> <span class="fu">describe_posterior</span>(m))</span>
<span id="cb286-1130"><a href="#cb286-1130" aria-hidden="true" tabindex="-1"></a><span class="co"># (tm &lt;- tidy(m,   conf.int = TRUE))</span></span>
<span id="cb286-1131"><a href="#cb286-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1132"><a href="#cb286-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb286-1133"><a href="#cb286-1133" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(m, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>))</span>
<span id="cb286-1134"><a href="#cb286-1134" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy(m,   conf.int = TRUE, exponentiate = TRUE)</span></span>
<span id="cb286-1135"><a href="#cb286-1135" aria-hidden="true" tabindex="-1"></a><span class="co"># tm %&gt;% mutate(</span></span>
<span id="cb286-1136"><a href="#cb286-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#   OR.est = exp(estimate),</span></span>
<span id="cb286-1137"><a href="#cb286-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#   exp.low = exp(conf.low),</span></span>
<span id="cb286-1138"><a href="#cb286-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#   exp.high = exp(conf.high)</span></span>
<span id="cb286-1139"><a href="#cb286-1139" aria-hidden="true" tabindex="-1"></a><span class="co"># ) %&gt;% dplyr::select(effect, component, group, term, OR.est, exp.low, exp.high)</span></span>
<span id="cb286-1140"><a href="#cb286-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1141"><a href="#cb286-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"PROBABILITIES"</span>)</span>
<span id="cb286-1142"><a href="#cb286-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1143"><a href="#cb286-1143" aria-hidden="true" tabindex="-1"></a><span class="co">#PREDICT METHOD</span></span>
<span id="cb286-1144"><a href="#cb286-1144" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> df_i <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, subject, q)</span>
<span id="cb286-1145"><a href="#cb286-1145" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">newdata =</span> newdata, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb286-1146"><a href="#cb286-1146" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(newdata, preds)</span>
<span id="cb286-1147"><a href="#cb286-1147" aria-hidden="true" tabindex="-1"></a><span class="co">#lengthen data frame to handle multinomial</span></span>
<span id="cb286-1148"><a href="#cb286-1148" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb286-1149"><a href="#cb286-1149" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>subject, <span class="sc">-</span>q) <span class="sc">%&gt;%</span> <span class="co">#marginalize over subject and q</span></span>
<span id="cb286-1150"><a href="#cb286-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb286-1151"><a href="#cb286-1151" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>pretty_condition,</span>
<span id="cb286-1152"><a href="#cb286-1152" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"preds"</span>,</span>
<span id="cb286-1153"><a href="#cb286-1153" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"state"</span>,</span>
<span id="cb286-1154"><a href="#cb286-1154" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb286-1155"><a href="#cb286-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1156"><a href="#cb286-1156" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> </span>
<span id="cb286-1157"><a href="#cb286-1157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pretty_condition, state ) <span class="sc">%&gt;%</span></span>
<span id="cb286-1158"><a href="#cb286-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb286-1159"><a href="#cb286-1159" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(preds),</span>
<span id="cb286-1160"><a href="#cb286-1160" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(preds)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb286-1161"><a href="#cb286-1161" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwr =</span> median <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb286-1162"><a href="#cb286-1162" aria-hidden="true" tabindex="-1"></a>    <span class="at">upr =</span> median <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se))</span>
<span id="cb286-1163"><a href="#cb286-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1164"><a href="#cb286-1164" aria-hidden="true" tabindex="-1"></a><span class="do">##DRAWS METHOD</span></span>
<span id="cb286-1165"><a href="#cb286-1165" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE draws from model</span></span>
<span id="cb286-1166"><a href="#cb286-1166" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb286-1167"><a href="#cb286-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb286-1168"><a href="#cb286-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb286-1169"><a href="#cb286-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb286-1170"><a href="#cb286-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb286-1171"><a href="#cb286-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb286-1172"><a href="#cb286-1172" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb286-1173"><a href="#cb286-1173" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb286-1174"><a href="#cb286-1174" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1175"><a href="#cb286-1175" aria-hidden="true" tabindex="-1"></a><span class="co"># #OR load from file</span></span>
<span id="cb286-1176"><a href="#cb286-1176" aria-hidden="true" tabindex="-1"></a><span class="co"># # draws &lt;- read_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb286-1177"><a href="#cb286-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1178"><a href="#cb286-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># # SUMMARIZE draws from model</span></span>
<span id="cb286-1179"><a href="#cb286-1179" aria-hidden="true" tabindex="-1"></a><span class="co"># (k &lt;- kable(draws %&gt;%</span></span>
<span id="cb286-1180"><a href="#cb286-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb286-1181"><a href="#cb286-1181" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition, .category) %&gt;%</span></span>
<span id="cb286-1182"><a href="#cb286-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#   median_hdci(.value), digits = 4, col.names =</span></span>
<span id="cb286-1183"><a href="#cb286-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#     c("Condition","Category", "Probability","Lower Cred.I","Upper Cred.I", "CI Width", "Point Type", "Interval Type")) %&gt;%</span></span>
<span id="cb286-1184"><a href="#cb286-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#   kable_styling())</span></span>
<span id="cb286-1185"><a href="#cb286-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1186"><a href="#cb286-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1187"><a href="#cb286-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1188"><a href="#cb286-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1189"><a href="#cb286-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">##### INFERENCE</span></span>
<span id="cb286-1190"><a href="#cb286-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1191"><a href="#cb286-1191" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">REPORT POSTERIOR MEDIAN $\exp_{beta}$, 95 \% credible interval, \% probability of direction</span><span class="co">]</span></span>
<span id="cb286-1192"><a href="#cb286-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1193"><a href="#cb286-1193" aria-hidden="true" tabindex="-1"></a>We fit a (bayesian) multinomial logistic regression model with random intercepts for subjects and questions. A Bayes Factor model comparison (against a random intercepts-only model) indicates extreme evidence for a main effect of CONDITION (BF = 9.31e+15). </span>
<span id="cb286-1194"><a href="#cb286-1194" aria-hidden="true" tabindex="-1"></a>**Consistent with our hypothesis, the impasse condition substantially increases the odds of transitional interpretations.** </span>
<span id="cb286-1195"><a href="#cb286-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1196"><a href="#cb286-1196" aria-hidden="true" tabindex="-1"></a>Across the entire task participants in the impasse condition were 12 times more likely to offer an 'unknown' rather than orthogonal response compared with those in the control condition ( $e^{\beta_1} = 11.58, 95 \% CI <span class="co">[</span><span class="ot">6.03, 23.19</span><span class="co">]</span>, pd = 100\%$). Participants in the impasse condition were 15 times more likely to offer an 'angular' rather than orthogonal response compared with those in the control condition ( $e^{\beta_1} = 15.30, 95 \% CI <span class="co">[</span><span class="ot">4.89, 54.22</span><span class="co">]</span>, pd = 100\%$), and 35 times more likely to offer an 'triangular' rather than orthogonal response compared with those in the control condition ( $e^{\beta_1} = 34.71, 95 \% CI <span class="co">[</span><span class="ot">6.72, 223.29</span><span class="co">]</span>, pd = 100\%$). </span>
<span id="cb286-1197"><a href="#cb286-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1198"><a href="#cb286-1198" aria-hidden="true" tabindex="-1"></a>The model estimates that probability of an orthogonal response in the control condition is  92% vs only 38% in IMPASSE The probability of an unknown/uncertain response in the control condition is 4%, vs 20% in impasse</span>
<span id="cb286-1199"><a href="#cb286-1199" aria-hidden="true" tabindex="-1"></a>The probability of an angular response in the control condition is less than 1%, vs 2% in impasse.</span>
<span id="cb286-1200"><a href="#cb286-1200" aria-hidden="true" tabindex="-1"></a>The probability of an triangular response in the control condition is 3%, vs 40% in impasse. </span>
<span id="cb286-1201"><a href="#cb286-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1202"><a href="#cb286-1202" aria-hidden="true" tabindex="-1"></a>The impasse condition decreases the probability of an orthogonal response by 54%</span>
<span id="cb286-1203"><a href="#cb286-1203" aria-hidden="true" tabindex="-1"></a>The impasse condition increases the probability of an uknown/uncertain response by 16%</span>
<span id="cb286-1204"><a href="#cb286-1204" aria-hidden="true" tabindex="-1"></a>The impasse condition increases the probability of an angular response by 1%</span>
<span id="cb286-1205"><a href="#cb286-1205" aria-hidden="true" tabindex="-1"></a>the impasse condition increase the probability of a triangular response by 37%</span>
<span id="cb286-1206"><a href="#cb286-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1207"><a href="#cb286-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1210"><a href="#cb286-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1211"><a href="#cb286-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: TBL-BRMS-STATE</span></span>
<span id="cb286-1212"><a href="#cb286-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1213"><a href="#cb286-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb286-1214"><a href="#cb286-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb286-1215"><a href="#cb286-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1216"><a href="#cb286-1216" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb286-1217"><a href="#cb286-1217" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m, "(log odds)" = m)</span></span>
<span id="cb286-1218"><a href="#cb286-1218" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb286-1219"><a href="#cb286-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb286-1220"><a href="#cb286-1220" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb286-1221"><a href="#cb286-1221" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1222"><a href="#cb286-1222" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb286-1223"><a href="#cb286-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb286-1224"><a href="#cb286-1224" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb286-1225"><a href="#cb286-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb286-1226"><a href="#cb286-1226" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb286-1227"><a href="#cb286-1227" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb286-1228"><a href="#cb286-1228" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb286-1229"><a href="#cb286-1229" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb286-1230"><a href="#cb286-1230" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb286-1231"><a href="#cb286-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',</span></span>
<span id="cb286-1232"><a href="#cb286-1232" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes)</span></span>
<span id="cb286-1233"><a href="#cb286-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#              # output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb286-1234"><a href="#cb286-1234" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb286-1235"><a href="#cb286-1235" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1236"><a href="#cb286-1236" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1237"><a href="#cb286-1237" aria-hidden="true" tabindex="-1"></a><span class="co"># ## POINT ESTIMATES IN PROBABILITY</span></span>
<span id="cb286-1238"><a href="#cb286-1238" aria-hidden="true" tabindex="-1"></a><span class="co"># #1 | get draws</span></span>
<span id="cb286-1239"><a href="#cb286-1239" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb286-1240"><a href="#cb286-1240" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;%</span></span>
<span id="cb286-1241"><a href="#cb286-1241" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb286-1242"><a href="#cb286-1242" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb286-1243"><a href="#cb286-1243" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb286-1244"><a href="#cb286-1244" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb286-1245"><a href="#cb286-1245" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA)</span></span>
<span id="cb286-1246"><a href="#cb286-1246" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb286-1247"><a href="#cb286-1247" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1248"><a href="#cb286-1248" aria-hidden="true" tabindex="-1"></a><span class="co"># #2 | SUMMARIZE draws </span></span>
<span id="cb286-1249"><a href="#cb286-1249" aria-hidden="true" tabindex="-1"></a><span class="co"># k &lt;- kable(draws %&gt;%</span></span>
<span id="cb286-1250"><a href="#cb286-1250" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb286-1251"><a href="#cb286-1251" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(pretty_condition, .category) %&gt;%</span></span>
<span id="cb286-1252"><a href="#cb286-1252" aria-hidden="true" tabindex="-1"></a><span class="co">#   median_hdci(.value), digits = 2, col.names = </span></span>
<span id="cb286-1253"><a href="#cb286-1253" aria-hidden="true" tabindex="-1"></a><span class="co">#     c("Condition","Category", "Probability","Lower Cred.I","Upper Cred.I", "CI Width", "Point Type", "Interval Type")) %&gt;% </span></span>
<span id="cb286-1254"><a href="#cb286-1254" aria-hidden="true" tabindex="-1"></a><span class="co">#   kable_styling()</span></span>
<span id="cb286-1255"><a href="#cb286-1255" aria-hidden="true" tabindex="-1"></a><span class="co"># k</span></span>
<span id="cb286-1256"><a href="#cb286-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1257"><a href="#cb286-1257" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARISONS</span></span>
<span id="cb286-1258"><a href="#cb286-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># c &lt;- draws %&gt;% </span></span>
<span id="cb286-1259"><a href="#cb286-1259" aria-hidden="true" tabindex="-1"></a><span class="co">#   # dplyr::select(pretty_condition, .category, .value) %&gt;%</span></span>
<span id="cb286-1260"><a href="#cb286-1260" aria-hidden="true" tabindex="-1"></a><span class="co">#   compare_levels(variable = .value, by = pretty_condition, </span></span>
<span id="cb286-1261"><a href="#cb286-1261" aria-hidden="true" tabindex="-1"></a><span class="co">#                  comparison = list(c("control","impasse"))) </span></span>
<span id="cb286-1262"><a href="#cb286-1262" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("adots","interval"),</span></span>
<span id="cb286-1263"><a href="#cb286-1263" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("adots","mean"),</span></span>
<span id="cb286-1264"><a href="#cb286-1264" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("adots","text"),</span></span>
<span id="cb286-1265"><a href="#cb286-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("density","interval"),</span></span>
<span id="cb286-1266"><a href="#cb286-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("density","mean"),</span></span>
<span id="cb286-1267"><a href="#cb286-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("density","text"),</span></span>
<span id="cb286-1268"><a href="#cb286-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("interval","mean"),</span></span>
<span id="cb286-1269"><a href="#cb286-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("interval","text"),</span></span>
<span id="cb286-1270"><a href="#cb286-1270" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    # c("mean","text")</span></span>
<span id="cb286-1271"><a href="#cb286-1271" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    </span></span>
<span id="cb286-1272"><a href="#cb286-1272" aria-hidden="true" tabindex="-1"></a><span class="co"># c %&gt;%</span></span>
<span id="cb286-1273"><a href="#cb286-1273" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .value, y = reorder(x =pretty_condition, X = .value)))+</span></span>
<span id="cb286-1274"><a href="#cb286-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_interval(.width = .95, color = "black") +</span></span>
<span id="cb286-1275"><a href="#cb286-1275" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_vline(xintercept = 0)+</span></span>
<span id="cb286-1276"><a href="#cb286-1276" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw()+</span></span>
<span id="cb286-1277"><a href="#cb286-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#   # coord_cartesian(xlim = c(-.5,1)) +</span></span>
<span id="cb286-1278"><a href="#cb286-1278" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_tidybayes() </span></span>
<span id="cb286-1279"><a href="#cb286-1279" aria-hidden="true" tabindex="-1"></a><span class="co"># comps</span></span>
<span id="cb286-1280"><a href="#cb286-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1281"><a href="#cb286-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1282"><a href="#cb286-1282" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb286-1283"><a href="#cb286-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1286"><a href="#cb286-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1287"><a href="#cb286-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-BRMS-STATE</span></span>
<span id="cb286-1288"><a href="#cb286-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1289"><a href="#cb286-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1290"><a href="#cb286-1290" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PARAMETERS </span></span>
<span id="cb286-1291"><a href="#cb286-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1292"><a href="#cb286-1292" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb286-1293"><a href="#cb286-1293" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, vline.color = "red",</span></span>
<span id="cb286-1294"><a href="#cb286-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb286-1295"><a href="#cb286-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb286-1296"><a href="#cb286-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#            p.threshold = 0.1, #manually adjust to account for directional test</span></span>
<span id="cb286-1297"><a href="#cb286-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#            ci.lvl = 0.90 ) + #manually adjusted for directional test</span></span>
<span id="cb286-1298"><a href="#cb286-1298" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Model Estimate | Odds Ratio",</span></span>
<span id="cb286-1299"><a href="#cb286-1299" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "",</span></span>
<span id="cb286-1300"><a href="#cb286-1300" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Condition")</span></span>
<span id="cb286-1301"><a href="#cb286-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1302"><a href="#cb286-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1303"><a href="#cb286-1303" aria-hidden="true" tabindex="-1"></a><span class="co">#EASYSTATS | MODEL | ODDS RATIO</span></span>
<span id="cb286-1304"><a href="#cb286-1304" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(Bmm.cat.CrSQ, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">component =</span> <span class="st">"all"</span>)</span>
<span id="cb286-1305"><a href="#cb286-1305" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">TRUE</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>) </span>
<span id="cb286-1306"><a href="#cb286-1306" aria-hidden="true" tabindex="-1"></a><span class="co"># + theme_clean()</span></span>
<span id="cb286-1307"><a href="#cb286-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1308"><a href="#cb286-1308" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1309"><a href="#cb286-1309" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- estimate_density(m,exponentiate = TRUE)</span></span>
<span id="cb286-1310"><a href="#cb286-1310" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result,  stack = FALSE, priors = TRUE)</span></span>
<span id="cb286-1311"><a href="#cb286-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1312"><a href="#cb286-1312" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT TESTS</span></span>
<span id="cb286-1313"><a href="#cb286-1313" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">equivalence_test</span>(m, <span class="at">rule =</span> <span class="st">"classic"</span>, <span class="at">ci=</span><span class="fl">0.9</span>) <span class="co">#classic[tost], , bayes</span></span>
<span id="cb286-1314"><a href="#cb286-1314" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb286-1315"><a href="#cb286-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1316"><a href="#cb286-1316" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rope</span>(m)</span>
<span id="cb286-1317"><a href="#cb286-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result)</span>
<span id="cb286-1318"><a href="#cb286-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1319"><a href="#cb286-1319" aria-hidden="true" tabindex="-1"></a>(result <span class="ot">&lt;-</span> <span class="fu">pd</span>(m,<span class="at">exponentiate =</span> <span class="cn">TRUE</span>))</span>
<span id="cb286-1320"><a href="#cb286-1320" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">show_intercept =</span> <span class="cn">TRUE</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-1321"><a href="#cb286-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1322"><a href="#cb286-1322" aria-hidden="true" tabindex="-1"></a><span class="do">## | PLOT PREDICTIONS</span></span>
<span id="cb286-1323"><a href="#cb286-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1324"><a href="#cb286-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb286-1325"><a href="#cb286-1325" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(m, type="eff",</span></span>
<span id="cb286-1326"><a href="#cb286-1326" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.intercept = TRUE,</span></span>
<span id="cb286-1327"><a href="#cb286-1327" aria-hidden="true" tabindex="-1"></a><span class="co">#            show.values = TRUE,</span></span>
<span id="cb286-1328"><a href="#cb286-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#            title = "Model Prediction | Probability of Accurate Response",</span></span>
<span id="cb286-1329"><a href="#cb286-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title = c("Condition","Probability of Accurate Response"))</span></span>
<span id="cb286-1330"><a href="#cb286-1330" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1331"><a href="#cb286-1331" aria-hidden="true" tabindex="-1"></a><span class="co"># #PLOT MODEL PREDICTION</span></span>
<span id="cb286-1332"><a href="#cb286-1332" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"pred"</span>)</span>
<span id="cb286-1333"><a href="#cb286-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1334"><a href="#cb286-1334" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO EMMEANS for the estimated marginal means</span></span>
<span id="cb286-1335"><a href="#cb286-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1336"><a href="#cb286-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb286-1337"><a href="#cb286-1337" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb286-1338"><a href="#cb286-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(m)</span></span>
<span id="cb286-1339"><a href="#cb286-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1340"><a href="#cb286-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1341"><a href="#cb286-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1344"><a href="#cb286-1344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1345"><a href="#cb286-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE</span></span>
<span id="cb286-1346"><a href="#cb286-1346" aria-hidden="true" tabindex="-1"></a><span class="do">##WORKING</span></span>
<span id="cb286-1347"><a href="#cb286-1347" aria-hidden="true" tabindex="-1"></a><span class="co"># https://mjskay.github.io/ggdist/reference/stat_slab.html</span></span>
<span id="cb286-1348"><a href="#cb286-1348" aria-hidden="true" tabindex="-1"></a><span class="do">## VIS probability of correct response</span></span>
<span id="cb286-1349"><a href="#cb286-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REALLY LONG TIME</span></span>
<span id="cb286-1350"><a href="#cb286-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1351"><a href="#cb286-1351" aria-hidden="true" tabindex="-1"></a><span class="co">#1 | get draws</span></span>
<span id="cb286-1352"><a href="#cb286-1352" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- df_i %&gt;%</span></span>
<span id="cb286-1353"><a href="#cb286-1353" aria-hidden="true" tabindex="-1"></a><span class="co">#   data_grid(pretty_condition, subject, q) %&gt;% </span></span>
<span id="cb286-1354"><a href="#cb286-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_fitted_draws(Bmm.cat.CrSQ,</span></span>
<span id="cb286-1355"><a href="#cb286-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # n = 100,</span></span>
<span id="cb286-1356"><a href="#cb286-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # dpar = TRUE,</span></span>
<span id="cb286-1357"><a href="#cb286-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#                    # transform = TRUE, #gives prob%, otherwise OR</span></span>
<span id="cb286-1358"><a href="#cb286-1358" aria-hidden="true" tabindex="-1"></a><span class="co">#                    re_formula = NA) </span></span>
<span id="cb286-1359"><a href="#cb286-1359" aria-hidden="true" tabindex="-1"></a><span class="co"># draws %&gt;% write_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb286-1360"><a href="#cb286-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1361"><a href="#cb286-1361" aria-hidden="true" tabindex="-1"></a><span class="co">#OR load from file</span></span>
<span id="cb286-1362"><a href="#cb286-1362" aria-hidden="true" tabindex="-1"></a><span class="co"># draws &lt;- read_rds(file = "analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds")</span></span>
<span id="cb286-1363"><a href="#cb286-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1364"><a href="#cb286-1364" aria-hidden="true" tabindex="-1"></a><span class="co">#2| VISUALIZE PREDICTIONS | GGDIST</span></span>
<span id="cb286-1365"><a href="#cb286-1365" aria-hidden="true" tabindex="-1"></a><span class="do">##TODO figure out height normalization.</span></span>
<span id="cb286-1366"><a href="#cb286-1366" aria-hidden="true" tabindex="-1"></a><span class="do">##do it with much smaller number of draws </span></span>
<span id="cb286-1367"><a href="#cb286-1367" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO adjust bandwidth/smoothing? + put on same line + </span></span>
<span id="cb286-1368"><a href="#cb286-1368" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKES A REAAALY LONG TIME</span></span>
<span id="cb286-1369"><a href="#cb286-1369" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- draws %&gt;%</span></span>
<span id="cb286-1370"><a href="#cb286-1370" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = .value,  y = pretty_condition, fill = .category)) +</span></span>
<span id="cb286-1371"><a href="#cb286-1371" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_slab(width = c(.95), alpha = 1, normalize="xy") +</span></span>
<span id="cb286-1372"><a href="#cb286-1372" aria-hidden="true" tabindex="-1"></a><span class="co">#   #   #normalize = all, panels, xy, groups, none</span></span>
<span id="cb286-1373"><a href="#cb286-1373" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim(0,1) + labs(</span></span>
<span id="cb286-1374"><a href="#cb286-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Model Predicted Probability of Correct Response",</span></span>
<span id="cb286-1375"><a href="#cb286-1375" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "probability of correct response",</span></span>
<span id="cb286-1376"><a href="#cb286-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "Interpretation"</span></span>
<span id="cb286-1377"><a href="#cb286-1377" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()</span></span>
<span id="cb286-1378"><a href="#cb286-1378" aria-hidden="true" tabindex="-1"></a><span class="co"># # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()</span></span>
<span id="cb286-1379"><a href="#cb286-1379" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb286-1380"><a href="#cb286-1380" aria-hidden="true" tabindex="-1"></a><span class="co"># # ggsave(d, filename = "figures/sgc3a_BBm.cat.CrSQ_lab_posterior.svg", width = 6, height =4)</span></span>
<span id="cb286-1381"><a href="#cb286-1381" aria-hidden="true" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb286-1382"><a href="#cb286-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1383"><a href="#cb286-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1384"><a href="#cb286-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1385"><a href="#cb286-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1386"><a href="#cb286-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb286-1387"><a href="#cb286-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1390"><a href="#cb286-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1391"><a href="#cb286-1391" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK Fit of posterior predictive to data</span></span>
<span id="cb286-1392"><a href="#cb286-1392" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(Bmm.cat.CrSQ, <span class="at">ndraws=</span><span class="dv">1000</span>)</span>
<span id="cb286-1393"><a href="#cb286-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1394"><a href="#cb286-1394" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK posterior vs. priors</span></span>
<span id="cb286-1395"><a href="#cb286-1395" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">estimate_density</span>(Bmm.cat.CrSQ)</span>
<span id="cb286-1396"><a href="#cb286-1396" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">stack =</span> <span class="cn">FALSE</span>, <span class="at">priors=</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-1397"><a href="#cb286-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1398"><a href="#cb286-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#CHECK model</span></span>
<span id="cb286-1399"><a href="#cb286-1399" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Bmm.cat.CrSQ)</span>
<span id="cb286-1400"><a href="#cb286-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1401"><a href="#cb286-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1402"><a href="#cb286-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1403"><a href="#cb286-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1404"><a href="#cb286-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1405"><a href="#cb286-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1406"><a href="#cb286-1406" aria-hidden="true" tabindex="-1"></a><span class="fu">##### COMPARE MBLOGIT to BRMS</span></span>
<span id="cb286-1407"><a href="#cb286-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1410"><a href="#cb286-1410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1411"><a href="#cb286-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: COMPARE-STATE-MODELS</span></span>
<span id="cb286-1412"><a href="#cb286-1412" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(mm.cat.CrSQ, Bmm.cat.CrSQ)</span>
<span id="cb286-1413"><a href="#cb286-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1414"><a href="#cb286-1414" aria-hidden="true" tabindex="-1"></a>The predictions of the manual, frequentist mixed multinomial and bayesian mixed multinomial models are comparable. </span>
<span id="cb286-1415"><a href="#cb286-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1416"><a href="#cb286-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1417"><a href="#cb286-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1B \| Q1 ACCURACY</span></span>
<span id="cb286-1418"><a href="#cb286-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1419"><a href="#cb286-1419" aria-hidden="true" tabindex="-1"></a>**Do Ss in the IMPASSE condition have a higher likelihood of producing a correct response to the first question?**</span>
<span id="cb286-1420"><a href="#cb286-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1421"><a href="#cb286-1421" aria-hidden="true" tabindex="-1"></a>The graph comprehension task includes 15 questions completed in sequence. But the first question the reader encounters (Q1) is the most important, as it is their *first exposure* to the unconventional triangular coordinate system.</span>
<span id="cb286-1422"><a href="#cb286-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1423"><a href="#cb286-1423" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1424"><a href="#cb286-1424" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does the frequency of correct (vs) incorrect responses on the first question differ by condition? <span class="sc">\[</span>Is response accuracy independent of condition?<span class="sc">\]</span>                                                                                   |</span>
<span id="cb286-1425"><a href="#cb286-1425" aria-hidden="true" tabindex="-1"></a>+=======================+========================================================================================================================================================================================================================================+</span>
<span id="cb286-1426"><a href="#cb286-1426" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the IMPASSE condition will have a higher likelihood of correctly responding to the first question than those in the CONTROL condition                                                                                     |</span>
<span id="cb286-1427"><a href="#cb286-1427" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1428"><a href="#cb286-1428" aria-hidden="true" tabindex="-1"></a>| **Data**              | -   data: <span class="in">`df_items`</span> where <span class="in">`q == 1`</span>                                                                                                                                                                                                    |</span>
<span id="cb286-1429"><a href="#cb286-1429" aria-hidden="true" tabindex="-1"></a>|                       | -   outcome: *accuracy* ( factor(incorrect/correct) from <span class="in">`score_niceABS`</span> <span class="sc">\[</span>absolute score<span class="sc">\]</span>                                                                                                                                            |</span>
<span id="cb286-1430"><a href="#cb286-1430" aria-hidden="true" tabindex="-1"></a>|                       | -   predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                                                                                                 |</span>
<span id="cb286-1431"><a href="#cb286-1431" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1432"><a href="#cb286-1432" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Logistic Regression on <span class="in">`accuracy`</span> predicted by <span class="in">`condition`</span>                                                                                                                                                                         |</span>
<span id="cb286-1433"><a href="#cb286-1433" aria-hidden="true" tabindex="-1"></a>|                       |     -   account for difference in odds of correct score by condition                                                                                                                                                                   |</span>
<span id="cb286-1434"><a href="#cb286-1434" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb286-1435"><a href="#cb286-1435" aria-hidden="true" tabindex="-1"></a>|                       | Alternatives:                                                                                                                                                                                                                          |</span>
<span id="cb286-1436"><a href="#cb286-1436" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                        |</span>
<span id="cb286-1437"><a href="#cb286-1437" aria-hidden="true" tabindex="-1"></a>|                       | -   Chi-Square test of independence on outcome <span class="in">`accuracy`</span> by <span class="in">`condition`</span>                                                                                                                                                               |</span>
<span id="cb286-1438"><a href="#cb286-1438" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1439"><a href="#cb286-1439" aria-hidden="true" tabindex="-1"></a>| **Notes**             | -   CHIQ SQR is simplest method to examine independence of two categorical factors; LOGISTIC REGRESSION is recommended for binomial \~ continuous; though with regression we can quantify the size of the effect and overall model fit |</span>
<span id="cb286-1440"><a href="#cb286-1440" aria-hidden="true" tabindex="-1"></a>|                       | -   independence assumption : (CHI SQR) as we only consider responses on the first question, each observation corresponds to an individual subject, and are thus independent                                                           |</span>
<span id="cb286-1441"><a href="#cb286-1441" aria-hidden="true" tabindex="-1"></a>|                       | -   cell frequency : (CHI SQR) expected frequency in each cell of the contingency table is greater than 5 (more than 5 correct , more than 5 incorrect responses)                                                                      |</span>
<span id="cb286-1442"><a href="#cb286-1442" aria-hidden="true" tabindex="-1"></a>+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1443"><a href="#cb286-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1444"><a href="#cb286-1444" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup</span></span>
<span id="cb286-1447"><a href="#cb286-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1448"><a href="#cb286-1448" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1ACC</span></span>
<span id="cb286-1449"><a href="#cb286-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1450"><a href="#cb286-1450" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb286-1451"><a href="#cb286-1451" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(accuracy, pretty_condition)</span>
<span id="cb286-1452"><a href="#cb286-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1453"><a href="#cb286-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1454"><a href="#cb286-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1455"><a href="#cb286-1455" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe </span></span>
<span id="cb286-1458"><a href="#cb286-1458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1459"><a href="#cb286-1459" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-Q1ACC</span></span>
<span id="cb286-1460"><a href="#cb286-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1461"><a href="#cb286-1461" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb286-1462"><a href="#cb286-1462" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb286-1463"><a href="#cb286-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb286-1464"><a href="#cb286-1464" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb286-1465"><a href="#cb286-1465" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb286-1466"><a href="#cb286-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb286-1467"><a href="#cb286-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb286-1468"><a href="#cb286-1468" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb286-1469"><a href="#cb286-1469" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb286-1470"><a href="#cb286-1470" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Accuracy"</span>,</span>
<span id="cb286-1471"><a href="#cb286-1471" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb286-1472"><a href="#cb286-1472" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb286-1473"><a href="#cb286-1473" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Impasse Condition yields a greater proportion of correct responses"</span>)</span>
<span id="cb286-1474"><a href="#cb286-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1475"><a href="#cb286-1475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1476"><a href="#cb286-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1477"><a href="#cb286-1477" aria-hidden="true" tabindex="-1"></a>A proportional bar chart visualizing the proportion of incorrect (vs) correct responses in each condition for each data collection modality (left/right facet) reveals that the pattern of responses appear the same regardless of the data collection modality. In both data collection sessions, the proportion of incorrect responses is much greater than the proportion of correct responses, regardless of condition (marginal probability of incorrect). In the impasse condition, the difference in proportions is smaller than the control condition (conditional probability of success in impasse; (i.e) There are more correct responses in the impasse condition than the control condition).</span>
<span id="cb286-1478"><a href="#cb286-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1481"><a href="#cb286-1481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1482"><a href="#cb286-1482" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-Q1ACC</span></span>
<span id="cb286-1483"><a href="#cb286-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1484"><a href="#cb286-1484" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb286-1485"><a href="#cb286-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1486"><a href="#cb286-1486" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Proportions of Correct Responses by Condition"</span>)</span>
<span id="cb286-1487"><a href="#cb286-1487" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb286-1488"><a href="#cb286-1488" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb286-1489"><a href="#cb286-1489" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb286-1490"><a href="#cb286-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1491"><a href="#cb286-1491" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Number of Correct Responses by Condition"</span>)</span>
<span id="cb286-1492"><a href="#cb286-1492" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>accuracy, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb286-1493"><a href="#cb286-1493" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb286-1494"><a href="#cb286-1494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1495"><a href="#cb286-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1496"><a href="#cb286-1496" aria-hidden="true" tabindex="-1"></a><span class="fu">#### LOGISTIC REGRESSION</span></span>
<span id="cb286-1497"><a href="#cb286-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1498"><a href="#cb286-1498" aria-hidden="true" tabindex="-1"></a>Fit a logistic regression predicting accuracy (absolute score) (n = <span class="in">`r nrow(df)`</span>) by condition (k = 2).\</span>
<span id="cb286-1499"><a href="#cb286-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1500"><a href="#cb286-1500" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{0}$ = Log Odds of (correct) responses in CONTROL condition</span>
<span id="cb286-1501"><a href="#cb286-1501" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$e^{\beta_{0}}$ = ODDS of correct response in CONTROL condition</span>
<span id="cb286-1502"><a href="#cb286-1502" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter estimate: $\beta_{1}$ = $\beta_{1impasse}$ Log Odds (Log OR; change in odds for correct response in impasse (vs) control <span class="sc">\[</span>log scale<span class="sc">\]</span>)</span>
<span id="cb286-1503"><a href="#cb286-1503" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$e^{\beta_{1}}$ = ODDS RATIO of correct response in IMPASSE (vs) CONTROL</span>
<span id="cb286-1504"><a href="#cb286-1504" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Null hypothesis**:$\beta_{impasse} \le 0$ the odds for a correct response does not change, or decreases</span>
<span id="cb286-1505"><a href="#cb286-1505" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Alternative hypothesis:** $\beta_{impasse} \gt 0$ the odds of a correct response increases</span>
<span id="cb286-1506"><a href="#cb286-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1507"><a href="#cb286-1507" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb286-1508"><a href="#cb286-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1509"><a href="#cb286-1509" aria-hidden="true" tabindex="-1"></a>*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*</span>
<span id="cb286-1510"><a href="#cb286-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1513"><a href="#cb286-1513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1514"><a href="#cb286-1514" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-FIT-Q1ACC</span></span>
<span id="cb286-1515"><a href="#cb286-1515" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb286-1516"><a href="#cb286-1516" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb286-1517"><a href="#cb286-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1518"><a href="#cb286-1518" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL FITTING ::::::::</span></span>
<span id="cb286-1519"><a href="#cb286-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1520"><a href="#cb286-1520" aria-hidden="true" tabindex="-1"></a><span class="co">#: 1 EMPTY MODEL baseline glm model intercept only</span></span>
<span id="cb286-1521"><a href="#cb286-1521" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">glm</span>(accuracy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb286-1522"><a href="#cb286-1522" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb286-1523"><a href="#cb286-1523" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m0)</span></span>
<span id="cb286-1524"><a href="#cb286-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1525"><a href="#cb286-1525" aria-hidden="true" tabindex="-1"></a><span class="co">#: 2 CONDITION model</span></span>
<span id="cb286-1526"><a href="#cb286-1526" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>( accuracy <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb286-1527"><a href="#cb286-1527" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb286-1528"><a href="#cb286-1528" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb286-1529"><a href="#cb286-1529" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m1)</span>
<span id="cb286-1530"><a href="#cb286-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1531"><a href="#cb286-1531" aria-hidden="true" tabindex="-1"></a><span class="co">#: 3 </span><span class="al">TEST</span><span class="co"> SUPERIOR FIT</span></span>
<span id="cb286-1532"><a href="#cb286-1532" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, m0<span class="sc">$</span>aic <span class="sc">&gt;</span> m1<span class="sc">$</span>aic)</span>
<span id="cb286-1533"><a href="#cb286-1533" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(m0,m1) <span class="co">#same as anova(m0, m1, test = "Chi")</span></span>
<span id="cb286-1534"><a href="#cb286-1534" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Likelihood Ratio test is significant? p = "</span>,(<span class="fu">test_lrt</span>(m0,m1))<span class="sc">$</span>p[<span class="dv">2</span>])</span>
<span id="cb286-1535"><a href="#cb286-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1536"><a href="#cb286-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1537"><a href="#cb286-1537" aria-hidden="true" tabindex="-1"></a>*The Condition predictor decreases AIC, but the Likelihood Ratio Test is marginal. We proceed to examine the predictor model, as we plan to do a 1-tailed NHST .*</span>
<span id="cb286-1538"><a href="#cb286-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1539"><a href="#cb286-1539" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb286-1540"><a href="#cb286-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1543"><a href="#cb286-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1544"><a href="#cb286-1544" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-Q1ACC</span></span>
<span id="cb286-1545"><a href="#cb286-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1546"><a href="#cb286-1546" aria-hidden="true" tabindex="-1"></a><span class="co"># DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: </span></span>
<span id="cb286-1547"><a href="#cb286-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1548"><a href="#cb286-1548" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREDICTOR MODEL [default two-tailed sig test]"</span>)</span>
<span id="cb286-1549"><a href="#cb286-1549" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb286-1550"><a href="#cb286-1550" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m1)</span>
<span id="cb286-1551"><a href="#cb286-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1552"><a href="#cb286-1552" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: </span></span>
<span id="cb286-1553"><a href="#cb286-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1554"><a href="#cb286-1554" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sided (right tail) z test for B COEFFICIENT</span></span>
<span id="cb286-1555"><a href="#cb286-1555" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients</span></span>
<span id="cb286-1556"><a href="#cb286-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1557"><a href="#cb286-1557" aria-hidden="true" tabindex="-1"></a><span class="co">#SANITY CHECK 2-tailed test should match the model output</span></span>
<span id="cb286-1558"><a href="#cb286-1558" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb286-1559"><a href="#cb286-1559" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"p value for two-tailed test, null B = 0 : "</span>,<span class="fu">round</span>(tt,<span class="dv">3</span>))</span>
<span id="cb286-1560"><a href="#cb286-1560" aria-hidden="true" tabindex="-1"></a>ot <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>], <span class="at">lower.tail =</span> F)</span>
<span id="cb286-1561"><a href="#cb286-1561" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"BUT we want a one tailed directional, null: B &lt;= 0: "</span>,<span class="fu">round</span>(ot,<span class="dv">3</span>))</span>
<span id="cb286-1562"><a href="#cb286-1562" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"adjusted confint for directional hypothesis"</span>)</span>
<span id="cb286-1563"><a href="#cb286-1563" aria-hidden="true" tabindex="-1"></a>(dcint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1, <span class="at">level =</span> <span class="fl">0.90</span>)) <span class="co"># get 90% for right side))</span></span>
<span id="cb286-1564"><a href="#cb286-1564" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte</span></span>
<span id="cb286-1565"><a href="#cb286-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1566"><a href="#cb286-1566" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: INTERPRET COEFFICIENTS</span></span>
<span id="cb286-1567"><a href="#cb286-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1568"><a href="#cb286-1568" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confidence Interval - LOG ODDS")</span></span>
<span id="cb286-1569"><a href="#cb286-1569" aria-hidden="true" tabindex="-1"></a><span class="co"># confint(m1) #not adjusted for 1-tailed</span></span>
<span id="cb286-1570"><a href="#cb286-1570" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Coefficients - ODDS RATIOS"</span>)</span>
<span id="cb286-1571"><a href="#cb286-1571" aria-hidden="true" tabindex="-1"></a><span class="co"># (e &lt;- cbind( exp(coef(m1)), exp(confint(m1)))) #exponentiated, not adjusted</span></span>
<span id="cb286-1572"><a href="#cb286-1572" aria-hidden="true" tabindex="-1"></a>(e <span class="ot">&lt;-</span> <span class="fu">cbind</span>( <span class="fu">exp</span>(<span class="fu">coef</span>(m1)), <span class="fu">exp</span>(dcint))) <span class="co">#exponentiated, adjusted</span></span>
<span id="cb286-1573"><a href="#cb286-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1574"><a href="#cb286-1574" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PREDICTIONS"</span>)</span>
<span id="cb286-1575"><a href="#cb286-1575" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve predictions as probabilities </span></span>
<span id="cb286-1576"><a href="#cb286-1576" aria-hidden="true" tabindex="-1"></a><span class="co"># (for each level of the predictor)</span></span>
<span id="cb286-1577"><a href="#cb286-1577" aria-hidden="true" tabindex="-1"></a>pred.control <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"control"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb286-1578"><a href="#cb286-1578" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient)</span></span>
<span id="cb286-1579"><a href="#cb286-1579" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in control,"</span>, pred.control)</span>
<span id="cb286-1580"><a href="#cb286-1580" aria-hidden="true" tabindex="-1"></a>pred.impasse <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="fu">data.frame</span>(<span class="at">pretty_condition=</span><span class="st">"impasse"</span>),<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb286-1581"><a href="#cb286-1581" aria-hidden="true" tabindex="-1"></a><span class="co">#this should match : plogis(intercept coefficient + predictor coeff)</span></span>
<span id="cb286-1582"><a href="#cb286-1582" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Probability of success in impasse,"</span>, pred.impasse)</span>
<span id="cb286-1583"><a href="#cb286-1583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1584"><a href="#cb286-1584" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb286-1585"><a href="#cb286-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1586"><a href="#cb286-1586" aria-hidden="true" tabindex="-1"></a>**In Dissertation**</span>
<span id="cb286-1587"><a href="#cb286-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1588"><a href="#cb286-1588" aria-hidden="true" tabindex="-1"></a>**We fit a logistic regression model to explore the effect of experimental condition on probability of a correct answer on the first question. In this model, the effect of condition is statistically significant (z = 1.79, p = 0.04, one-tailed). The model predicts that the odds of a correct response on the first question in the impasse condition increase by nearly 120% ($e^{beta_{impasse}}$ = 2.19, 95% CI \[1.08, 4.63\]) over the control condition. The intercept** $\beta_{0}$ **parameter is also significant, ($e^{b_{0}}$ = 0.19, p \&lt; 0.001, 95% CI \[0.11, 0.33\]) indicating that the odds of a correct response in the control condition are significantly less than even (less than 50/50 chance of correct response in control condition).**</span>
<span id="cb286-1589"><a href="#cb286-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1590"><a href="#cb286-1590" aria-hidden="true" tabindex="-1"></a>*Equivalent statements:*</span>
<span id="cb286-1591"><a href="#cb286-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1592"><a href="#cb286-1592" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse condition increases log odds of correct response by 0.79 (over control)</span>
<span id="cb286-1593"><a href="#cb286-1593" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>being in impasse increases odds of correct response in impasse over control increases by factor of 2.19</span>
<span id="cb286-1594"><a href="#cb286-1594" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>probability of correct response in impasse predicted as 30%, vs only 16% in control condition</span>
<span id="cb286-1595"><a href="#cb286-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1596"><a href="#cb286-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1597"><a href="#cb286-1597" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb286-1598"><a href="#cb286-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1601"><a href="#cb286-1601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1602"><a href="#cb286-1602" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-Q1ACC</span></span>
<span id="cb286-1603"><a href="#cb286-1603" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb286-1604"><a href="#cb286-1604" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning : false</span></span>
<span id="cb286-1605"><a href="#cb286-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1606"><a href="#cb286-1606" aria-hidden="true" tabindex="-1"></a><span class="co">#SET MODEL</span></span>
<span id="cb286-1607"><a href="#cb286-1607" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m1</span>
<span id="cb286-1608"><a href="#cb286-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1609"><a href="#cb286-1609" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb286-1610"><a href="#cb286-1610" aria-hidden="true" tabindex="-1"></a><span class="co"># ggcoefstats(m1, output = "plot", </span></span>
<span id="cb286-1611"><a href="#cb286-1611" aria-hidden="true" tabindex="-1"></a><span class="co">#               conf.level = 0.90) + </span></span>
<span id="cb286-1612"><a href="#cb286-1612" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "Log Odds Estimate", </span></span>
<span id="cb286-1613"><a href="#cb286-1613" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "LOGODDS | Q1 Accuracy ~ condition",</span></span>
<span id="cb286-1614"><a href="#cb286-1614" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "(p is for two tailed test)")</span></span>
<span id="cb286-1615"><a href="#cb286-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1616"><a href="#cb286-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1617"><a href="#cb286-1617" aria-hidden="true" tabindex="-1"></a><span class="co">#PARAMETERS | MODEL | SIMULATED PARAMETERS</span></span>
<span id="cb286-1618"><a href="#cb286-1618" aria-hidden="true" tabindex="-1"></a><span class="co"># similar to bayesian dist of estimate</span></span>
<span id="cb286-1619"><a href="#cb286-1619" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- simulate_parameters(m1)</span></span>
<span id="cb286-1620"><a href="#cb286-1620" aria-hidden="true" tabindex="-1"></a><span class="co"># #rename params so intercept is plotted </span></span>
<span id="cb286-1621"><a href="#cb286-1621" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[1] &lt;- "condition [control]"</span></span>
<span id="cb286-1622"><a href="#cb286-1622" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[2] &lt;- "condition [impasse]"</span></span>
<span id="cb286-1623"><a href="#cb286-1623" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result) </span></span>
<span id="cb286-1624"><a href="#cb286-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1625"><a href="#cb286-1625" aria-hidden="true" tabindex="-1"></a><span class="co">#EQUIVALENCE </span><span class="al">TEST</span><span class="co"> [not sure if appropriate for log model?]</span></span>
<span id="cb286-1626"><a href="#cb286-1626" aria-hidden="true" tabindex="-1"></a><span class="co"># https://journals.sagepub.com/doi/10.1177/2515245918770963#:~:text=Consequently%2C%20when%20reporting%20an%20equivalence,values%20is%20smaller%20than%20alpha.</span></span>
<span id="cb286-1627"><a href="#cb286-1627" aria-hidden="true" tabindex="-1"></a><span class="co"># https://easystats.github.io/parameters/reference/equivalence_test.lm.html</span></span>
<span id="cb286-1628"><a href="#cb286-1628" aria-hidden="true" tabindex="-1"></a><span class="co"># (result &lt;- equivalence_test(m1, rule = "classic", component = c("all")))</span></span>
<span id="cb286-1629"><a href="#cb286-1629" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result,   show_intercept = TRUE) + </span></span>
<span id="cb286-1630"><a href="#cb286-1630" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_discrete(labels = c("impasse", "control")) + </span></span>
<span id="cb286-1631"><a href="#cb286-1631" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs( title = "Equivalence Test for Model Parameter Estimates")</span></span>
<span id="cb286-1632"><a href="#cb286-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1633"><a href="#cb286-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1634"><a href="#cb286-1634" aria-hidden="true" tabindex="-1"></a><span class="co">#PARAMETERS | MODEL | ODDS RATIO </span></span>
<span id="cb286-1635"><a href="#cb286-1635" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m1,exponentiate = TRUE)</span></span>
<span id="cb286-1636"><a href="#cb286-1636" aria-hidden="true" tabindex="-1"></a><span class="co"># #rename params </span></span>
<span id="cb286-1637"><a href="#cb286-1637" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[1] &lt;- "condition [control]"</span></span>
<span id="cb286-1638"><a href="#cb286-1638" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[2] &lt;- "condition [impasse]"</span></span>
<span id="cb286-1639"><a href="#cb286-1639" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result,   show_intercept = TRUE) +  labs(</span></span>
<span id="cb286-1640"><a href="#cb286-1640" aria-hidden="true" tabindex="-1"></a><span class="co">#   title = "Model Parameter Estimates"</span></span>
<span id="cb286-1641"><a href="#cb286-1641" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean() + theme(legend.position="blank")</span></span>
<span id="cb286-1642"><a href="#cb286-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1643"><a href="#cb286-1643" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb286-1644"><a href="#cb286-1644" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb286-1645"><a href="#cb286-1645" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb286-1646"><a href="#cb286-1646" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb286-1647"><a href="#cb286-1647" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb286-1648"><a href="#cb286-1648" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb286-1649"><a href="#cb286-1649" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb286-1650"><a href="#cb286-1650" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb286-1651"><a href="#cb286-1651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span> <span class="co">#remove to put on log scale x axis </span></span>
<span id="cb286-1652"><a href="#cb286-1652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"control"</span>,<span class="st">"impasse"</span>))<span class="sc">+</span></span>
<span id="cb286-1653"><a href="#cb286-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb286-1654"><a href="#cb286-1654" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb286-1655"><a href="#cb286-1655" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb286-1656"><a href="#cb286-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1657"><a href="#cb286-1657" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb286-1658"><a href="#cb286-1658" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb286-1659"><a href="#cb286-1659" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"pred"</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb286-1660"><a href="#cb286-1660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="co">#scale y axis to actual range</span></span>
<span id="cb286-1661"><a href="#cb286-1661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL PREDICTION  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb286-1662"><a href="#cb286-1662" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of correct response on Q1"</span>,</span>
<span id="cb286-1663"><a href="#cb286-1663" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb286-1664"><a href="#cb286-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1665"><a href="#cb286-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1666"><a href="#cb286-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1669"><a href="#cb286-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1670"><a href="#cb286-1670" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-Q1ACC</span></span>
<span id="cb286-1671"><a href="#cb286-1671" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb286-1672"><a href="#cb286-1672" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb286-1673"><a href="#cb286-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1674"><a href="#cb286-1674" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb286-1675"><a href="#cb286-1675" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb286-1676"><a href="#cb286-1676" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb286-1677"><a href="#cb286-1677" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb286-1678"><a href="#cb286-1678" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb286-1679"><a href="#cb286-1679" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1680"><a href="#cb286-1680" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb286-1681"><a href="#cb286-1681" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb286-1682"><a href="#cb286-1682" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb286-1683"><a href="#cb286-1683" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb286-1684"><a href="#cb286-1684" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb286-1685"><a href="#cb286-1685" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb286-1686"><a href="#cb286-1686" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb286-1687"><a href="#cb286-1687" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb286-1688"><a href="#cb286-1688" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb286-1689"><a href="#cb286-1689" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb286-1690"><a href="#cb286-1690" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb286-1691"><a href="#cb286-1691" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb286-1692"><a href="#cb286-1692" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb286-1693"><a href="#cb286-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1694"><a href="#cb286-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1695"><a href="#cb286-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1696"><a href="#cb286-1696" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb286-1697"><a href="#cb286-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1700"><a href="#cb286-1700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1701"><a href="#cb286-1701" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DIAG-Q1ACC</span></span>
<span id="cb286-1702"><a href="#cb286-1702" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb286-1703"><a href="#cb286-1703" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb286-1704"><a href="#cb286-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1705"><a href="#cb286-1705" aria-hidden="true" tabindex="-1"></a><span class="co"># print("SANITY CHECK REPORTING")</span></span>
<span id="cb286-1706"><a href="#cb286-1706" aria-hidden="true" tabindex="-1"></a><span class="co"># report::report(m1)</span></span>
<span id="cb286-1707"><a href="#cb286-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1708"><a href="#cb286-1708" aria-hidden="true" tabindex="-1"></a><span class="co">#print("MODEL PERFORMANCE")</span></span>
<span id="cb286-1709"><a href="#cb286-1709" aria-hidden="true" tabindex="-1"></a><span class="co"># performance(m1)</span></span>
<span id="cb286-1710"><a href="#cb286-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1711"><a href="#cb286-1711" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL DIAGNOSTICS"</span>)</span>
<span id="cb286-1712"><a href="#cb286-1712" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span>
<span id="cb286-1713"><a href="#cb286-1713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1714"><a href="#cb286-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1715"><a href="#cb286-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1716"><a href="#cb286-1716" aria-hidden="true" tabindex="-1"></a><span class="fu">## H1B \| Q1 INTERPRETATION STATE</span></span>
<span id="cb286-1717"><a href="#cb286-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1718"><a href="#cb286-1718" aria-hidden="true" tabindex="-1"></a>**Do Ss in the IMPASSE condition offer less-orthogonal interpretations on first question?**</span>
<span id="cb286-1719"><a href="#cb286-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1720"><a href="#cb286-1720" aria-hidden="true" tabindex="-1"></a>While absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesn't allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subject's response, and determine if these interpretations differ by experimental condition. State is a 3-category derived response variable that groups the following interpretations:</span>
<span id="cb286-1721"><a href="#cb286-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1722"><a href="#cb286-1722" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"orthogonal"** <span class="sc">\[</span>reference category<span class="sc">\]</span> includes orthogonal and satisficing responses ==<span class="sc">\&gt;</span> indicates a primarily *orthogonal* state of coordinate system understanding</span>
<span id="cb286-1723"><a href="#cb286-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1724"><a href="#cb286-1724" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"other"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =<span class="sc">\&gt;</span> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular</span>
<span id="cb286-1725"><a href="#cb286-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1726"><a href="#cb286-1726" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"angular"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb286-1727"><a href="#cb286-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1728"><a href="#cb286-1728" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**"triangular"** includes correct triangular and 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =<span class="sc">\&gt;</span> indicates some degree of angular/triangular coordinate understanding</span>
<span id="cb286-1729"><a href="#cb286-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1730"><a href="#cb286-1730" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1731"><a href="#cb286-1731" aria-hidden="true" tabindex="-1"></a>| Research Question     | Does Ss in the impasse condition produce less orthogonal responses on the first question?                                                                                                                                                                                                                                                                 |</span>
<span id="cb286-1732"><a href="#cb286-1732" aria-hidden="true" tabindex="-1"></a>+=======================+===========================================================================================================================================================================================================================================================================================================================================================+</span>
<span id="cb286-1733"><a href="#cb286-1733" aria-hidden="true" tabindex="-1"></a>| **Hypothesis**        | H1A \| Ss in the IMPASSE condition will have a higher likelihood of producing unknown and and triangle-like response states, relative to orthogonal response states, on the first question                                                                                                                                                                |</span>
<span id="cb286-1734"><a href="#cb286-1734" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1735"><a href="#cb286-1735" aria-hidden="true" tabindex="-1"></a>| **Data**              | -   data: <span class="in">`df_items`</span> where <span class="in">`q == 1`</span>                                                                                                                                                                                                                                                                                                                       |</span>
<span id="cb286-1736"><a href="#cb286-1736" aria-hidden="true" tabindex="-1"></a>|                       | -   outcome: <span class="in">`state`</span> ( 4 level factor from 5 level high_interpretation )                                                                                                                                                                                                                                                                                  |</span>
<span id="cb286-1737"><a href="#cb286-1737" aria-hidden="true" tabindex="-1"></a>|                       | -   predictor: <span class="in">`condition`</span> <span class="sc">\[</span>between-subjects factor<span class="sc">\]</span>                                                                                                                                                                                                                                                                                                    |</span>
<span id="cb286-1738"><a href="#cb286-1738" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1739"><a href="#cb286-1739" aria-hidden="true" tabindex="-1"></a>| **Analysis Strategy** | 1.  Multinomial (Logistic) Regression on state predicted by condition                                                                                                                                                                                                                                                                                     |</span>
<span id="cb286-1740"><a href="#cb286-1740" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                                                                                           |</span>
<span id="cb286-1741"><a href="#cb286-1741" aria-hidden="true" tabindex="-1"></a>|                       | Alternative:                                                                                                                                                                                                                                                                                                                                              |</span>
<span id="cb286-1742"><a href="#cb286-1742" aria-hidden="true" tabindex="-1"></a>|                       |                                                                                                                                                                                                                                                                                                                                                           |</span>
<span id="cb286-1743"><a href="#cb286-1743" aria-hidden="true" tabindex="-1"></a>|                       | -   Ordinal regression on state; but model doesn't satisfy proportional odds assumption (parallel slopes)                                                                                                                                                                                                                                                 |</span>
<span id="cb286-1744"><a href="#cb286-1744" aria-hidden="true" tabindex="-1"></a>|                       | -   Multinomial or Ordinal regression on high_interpretation (5 category interpretation state which distinguishes between uncertain (blank, reference) unclassifiable, triangle-like and true triangular.) There are some cells with zeros, however (no uncertain responses in control) which means the model can't accurately estimate those comparisons |</span>
<span id="cb286-1745"><a href="#cb286-1745" aria-hidden="true" tabindex="-1"></a>+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb286-1746"><a href="#cb286-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1747"><a href="#cb286-1747" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup </span></span>
<span id="cb286-1750"><a href="#cb286-1750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1751"><a href="#cb286-1751" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: SETUP-Q1STATE</span></span>
<span id="cb286-1752"><a href="#cb286-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1753"><a href="#cb286-1753" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PREP DATA</span></span>
<span id="cb286-1754"><a href="#cb286-1754" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(pretty_condition, state)</span>
<span id="cb286-1755"><a href="#cb286-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1756"><a href="#cb286-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1757"><a href="#cb286-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1758"><a href="#cb286-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1759"><a href="#cb286-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Describe </span></span>
<span id="cb286-1762"><a href="#cb286-1762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1763"><a href="#cb286-1763" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: VIS-Q1STATE</span></span>
<span id="cb286-1764"><a href="#cb286-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1765"><a href="#cb286-1765" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: STACKED BAR CHART</span></span>
<span id="cb286-1766"><a href="#cb286-1766" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb286-1767"><a href="#cb286-1767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb286-1768"><a href="#cb286-1768" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pretty_condition,</span>
<span id="cb286-1769"><a href="#cb286-1769" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> state)) <span class="sc">+</span></span>
<span id="cb286-1770"><a href="#cb286-1770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span> ) <span class="sc">+</span> <span class="co">#,color = "black") +</span></span>
<span id="cb286-1771"><a href="#cb286-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)  <span class="sc">+</span></span>
<span id="cb286-1772"><a href="#cb286-1772" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~pretty_mode) + </span></span>
<span id="cb286-1773"><a href="#cb286-1773" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="co">#y = "Correct Response on Q 1",</span></span>
<span id="cb286-1774"><a href="#cb286-1774" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Q1 Interpretation"</span>,</span>
<span id="cb286-1775"><a href="#cb286-1775" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb286-1776"><a href="#cb286-1776" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb286-1777"><a href="#cb286-1777" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">""</span>)</span>
<span id="cb286-1778"><a href="#cb286-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1779"><a href="#cb286-1779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1780"><a href="#cb286-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1781"><a href="#cb286-1781" aria-hidden="true" tabindex="-1"></a>A proportional bar chart visualizing the proportion of each interpretations type by condition for each data collection modality (left/right facet) reveals that the pattern of responses are similar regardless of the data collection modality, by differ by condition. In the impasse condition, there are more triangular responses than in control. We see that around half of the 'incorrect' (i.e. not triangular) responses in the impasse condition are not orthogonal-like, but "other/unknown".</span>
<span id="cb286-1782"><a href="#cb286-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1783"><a href="#cb286-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1786"><a href="#cb286-1786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1787"><a href="#cb286-1787" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DESC-Q1STATE</span></span>
<span id="cb286-1788"><a href="#cb286-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1789"><a href="#cb286-1789" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::::::DESCRIPTIVES</span></span>
<span id="cb286-1790"><a href="#cb286-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1791"><a href="#cb286-1791" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb286-1792"><a href="#cb286-1792" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co">#return proportion (of column)</span></span>
<span id="cb286-1793"><a href="#cb286-1793" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>) <span class="co">#sanity check sum of columns</span></span>
<span id="cb286-1794"><a href="#cb286-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1795"><a href="#cb286-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1796"><a href="#cb286-1796" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>state, df<span class="sc">$</span>pretty_condition) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co">#display sum for row</span></span>
<span id="cb286-1797"><a href="#cb286-1797" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addmargins</span>(<span class="dv">1</span>)) <span class="co">#sanity check sum of columns</span></span>
<span id="cb286-1798"><a href="#cb286-1798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1799"><a href="#cb286-1799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1800"><a href="#cb286-1800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1801"><a href="#cb286-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MULTINOMIAL REGRESSION</span></span>
<span id="cb286-1802"><a href="#cb286-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1803"><a href="#cb286-1803" aria-hidden="true" tabindex="-1"></a>*Does condition affect the response state of Q1?*</span>
<span id="cb286-1804"><a href="#cb286-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1805"><a href="#cb286-1805" aria-hidden="true" tabindex="-1"></a>*Fit a logistic regression predicting interpretation state (k=3) by condition(k = 2).*</span>
<span id="cb286-1806"><a href="#cb286-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1807"><a href="#cb286-1807" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>3 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) <span class="sc">\[</span>essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing <span class="sc">\[</span>reference category<span class="sc">\]</span> vs <span class="sc">\[</span>this category<span class="sc">\]</span>)</span>
<span id="cb286-1808"><a href="#cb286-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1809"><a href="#cb286-1809" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For *each* equation:</span>
<span id="cb286-1810"><a href="#cb286-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1811"><a href="#cb286-1811" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{0}$ *= Log Odds of \[this category type vs. reference category type) response in CONTROL condition*</span>
<span id="cb286-1812"><a href="#cb286-1812" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{0}}$ *= ODDS of \[this category type vs. reference category type\] response in CONTROL condition*</span>
<span id="cb286-1813"><a href="#cb286-1813" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_{1}$ *=* $\beta_{1impasse}$ *Log Odds (Log OR; change in odds for \[this category\] type response in impasse (vs) control \[log scale\])*</span>
<span id="cb286-1814"><a href="#cb286-1814" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$e^{\beta_{1}}$ *= ODDS RATIO of \[this. vs reference category type\] response in IMPASSE (vs) CONTROL*</span>
<span id="cb286-1815"><a href="#cb286-1815" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Two-tailed NHST *Null hypothesis:* $\beta_{impasse} = 0$ *the odds for \[this category of response vs. reference\] are not different for IMPASSE condition*</span>
<span id="cb286-1816"><a href="#cb286-1816" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*Alternative hypothesis:* $\beta_{impasse} \ne 0$ *the odds of \[this category of response vs. reference\] increases or decreases for IMPASSE condition*</span>
<span id="cb286-1817"><a href="#cb286-1817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1818"><a href="#cb286-1818" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fit Model</span></span>
<span id="cb286-1819"><a href="#cb286-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1822"><a href="#cb286-1822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1823"><a href="#cb286-1823" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-FIT-Q1STATE</span></span>
<span id="cb286-1824"><a href="#cb286-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1825"><a href="#cb286-1825" aria-hidden="true" tabindex="-1"></a><span class="co">#check reference level </span></span>
<span id="cb286-1826"><a href="#cb286-1826" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categories (first is reference)"</span>)</span>
<span id="cb286-1827"><a href="#cb286-1827" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>state)</span>
<span id="cb286-1828"><a href="#cb286-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1829"><a href="#cb286-1829" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT EMPTY MODEL</span></span>
<span id="cb286-1830"><a href="#cb286-1830" aria-hidden="true" tabindex="-1"></a><span class="co"># print("EMPTY MODEL")</span></span>
<span id="cb286-1831"><a href="#cb286-1831" aria-hidden="true" tabindex="-1"></a>catm<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">multinom</span>(state <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb286-1832"><a href="#cb286-1832" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm.0)</span></span>
<span id="cb286-1833"><a href="#cb286-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1834"><a href="#cb286-1834" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT PREDICTOR MODEL</span></span>
<span id="cb286-1835"><a href="#cb286-1835" aria-hidden="true" tabindex="-1"></a><span class="co"># print("PREDICTOR MODEL")</span></span>
<span id="cb286-1836"><a href="#cb286-1836" aria-hidden="true" tabindex="-1"></a>catm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula =</span> state <span class="sc">~</span> pretty_condition, <span class="at">data =</span> df, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-1837"><a href="#cb286-1837" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(catm)</span></span>
<span id="cb286-1838"><a href="#cb286-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1839"><a href="#cb286-1839" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE MODEL FIT</span></span>
<span id="cb286-1840"><a href="#cb286-1840" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"AIC wth predictor is lower than empty model?"</span>, catm<span class="fl">.0</span><span class="sc">$</span>AIC <span class="sc">&gt;</span> catm<span class="sc">$</span>AIC)</span>
<span id="cb286-1841"><a href="#cb286-1841" aria-hidden="true" tabindex="-1"></a><span class="fu">test_lrt</span>(catm<span class="fl">.0</span>, catm)</span>
<span id="cb286-1842"><a href="#cb286-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1843"><a href="#cb286-1843" aria-hidden="true" tabindex="-1"></a><span class="do">##compare bayesian version</span></span>
<span id="cb286-1844"><a href="#cb286-1844" aria-hidden="true" tabindex="-1"></a><span class="co">#library(brms)</span></span>
<span id="cb286-1845"><a href="#cb286-1845" aria-hidden="true" tabindex="-1"></a><span class="co"># b.cat &lt;- brm( state2 ~ pretty_condition, data = df, family = "categorical", backend = "cmdstanr")</span></span>
<span id="cb286-1846"><a href="#cb286-1846" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(b.cat)</span></span>
<span id="cb286-1847"><a href="#cb286-1847" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model(b.cat)</span></span>
<span id="cb286-1848"><a href="#cb286-1848" aria-hidden="true" tabindex="-1"></a><span class="co"># report(b.cat)</span></span>
<span id="cb286-1849"><a href="#cb286-1849" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficient estimates are very simliar to catm. super cool!</span></span>
<span id="cb286-1850"><a href="#cb286-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1851"><a href="#cb286-1851" aria-hidden="true" tabindex="-1"></a><span class="do">##compare mclogit version</span></span>
<span id="cb286-1852"><a href="#cb286-1852" aria-hidden="true" tabindex="-1"></a><span class="co">#"baseline-category logit model</span></span>
<span id="cb286-1853"><a href="#cb286-1853" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.elff.eu/software/mclogit/manual/mblogit/</span></span>
<span id="cb286-1854"><a href="#cb286-1854" aria-hidden="true" tabindex="-1"></a><span class="co"># blm1 &lt;- mblogit(state2 ~ pretty_condition , data = df)</span></span>
<span id="cb286-1855"><a href="#cb286-1855" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(blm1)</span></span>
<span id="cb286-1856"><a href="#cb286-1856" aria-hidden="true" tabindex="-1"></a><span class="co">#identical to catm. super cool!</span></span>
<span id="cb286-1857"><a href="#cb286-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1858"><a href="#cb286-1858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1859"><a href="#cb286-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1860"><a href="#cb286-1860" aria-hidden="true" tabindex="-1"></a>*AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*</span>
<span id="cb286-1861"><a href="#cb286-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1862"><a href="#cb286-1862" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Describe</span></span>
<span id="cb286-1863"><a href="#cb286-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1866"><a href="#cb286-1866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1867"><a href="#cb286-1867" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DESC-Q1STATE</span></span>
<span id="cb286-1868"><a href="#cb286-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1869"><a href="#cb286-1869" aria-hidden="true" tabindex="-1"></a><span class="co">#set model</span></span>
<span id="cb286-1870"><a href="#cb286-1870" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> catm</span>
<span id="cb286-1871"><a href="#cb286-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1872"><a href="#cb286-1872" aria-hidden="true" tabindex="-1"></a><span class="co">#::::::::INTERPRETATION</span></span>
<span id="cb286-1873"><a href="#cb286-1873" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"MODEL SUMMARY"</span>)</span>
<span id="cb286-1874"><a href="#cb286-1874" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb286-1875"><a href="#cb286-1875" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m)</span>
<span id="cb286-1876"><a href="#cb286-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1877"><a href="#cb286-1877" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate z-statistics of coefficients</span></span>
<span id="cb286-1878"><a href="#cb286-1878" aria-hidden="true" tabindex="-1"></a>z_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(m)<span class="sc">$</span>standard.errors</span>
<span id="cb286-1879"><a href="#cb286-1879" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to p-values</span></span>
<span id="cb286-1880"><a href="#cb286-1880" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stats)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb286-1881"><a href="#cb286-1881" aria-hidden="true" tabindex="-1"></a><span class="co"># display p-values in transposed data frame</span></span>
<span id="cb286-1882"><a href="#cb286-1882" aria-hidden="true" tabindex="-1"></a>(p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> (p_values)))</span>
<span id="cb286-1883"><a href="#cb286-1883" aria-hidden="true" tabindex="-1"></a><span class="co"># display odds ratios in transposed data frame</span></span>
<span id="cb286-1884"><a href="#cb286-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1885"><a href="#cb286-1885" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"ODDS RATIOS"</span>)</span>
<span id="cb286-1886"><a href="#cb286-1886" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>coefficients))</span>
<span id="cb286-1887"><a href="#cb286-1887" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb286-1888"><a href="#cb286-1888" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(odds_ratios, p_values))</span>
<span id="cb286-1889"><a href="#cb286-1889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1890"><a href="#cb286-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1891"><a href="#cb286-1891" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Inference</span></span>
<span id="cb286-1892"><a href="#cb286-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1893"><a href="#cb286-1893" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving an unknown (potentially nonsense) or blank/uncertain response rather than an orthogonal (or satisficing) response by a factor of 45 (z = 3.81, p \&lt; 0.001) . **Participants in the impasse condition were 45x as likely to give an unknown/uncertain response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb286-1894"><a href="#cb286-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1895"><a href="#cb286-1895" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving 'triangle-like' response rather than an orthogonal (or satisficing) response by a factor of 17.5 (z = 2.60, p \&lt; 0.001 ). **Participants in the impasse condition were almost 6x as likely to give an a triangular response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb286-1896"><a href="#cb286-1896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1897"><a href="#cb286-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1898"><a href="#cb286-1898" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Being in the IMPASSE condition *increases* the odds of giving 'triangle-like' response rather than an orthogonal (or satisficing) response by a factor of 4.8 (z = 3.30, p \&lt; 0.001 ). **Participants in the impasse condition were almost 6x as likely to give an a triangular response rather than an orthogonal response compared to participants in control**.</span>
<span id="cb286-1899"><a href="#cb286-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1900"><a href="#cb286-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1901"><a href="#cb286-1901" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As with the (binary) logistic regression on accuracy \~ condition, significant model intercepts indicate that the odds of being in any particular response state (vs) orthogonal are significantly different than 1 *in the control condition.* (i.e. not 1:1 odds or 50% chance of being in that response state. Orthogonal is a much more probable response state in control)</span>
<span id="cb286-1902"><a href="#cb286-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1903"><a href="#cb286-1903" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="sc">\[</span>need to to double check interpretation, but I *think* that the OR intercepts converted to probabilities equate to the marginal probability of being in each state in the control condition. which makes sense. I think.?<span class="sc">\]</span></span>
<span id="cb286-1904"><a href="#cb286-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1905"><a href="#cb286-1905" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>IF I change reference category for condition... then the intercepts should no longer be significant. The b1 coefficients should still be significant, but with changed sign (much less likely) <span class="sc">\[</span>Yup! this works!<span class="sc">\]</span></span>
<span id="cb286-1906"><a href="#cb286-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1907"><a href="#cb286-1907" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize</span></span>
<span id="cb286-1908"><a href="#cb286-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1911"><a href="#cb286-1911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1912"><a href="#cb286-1912" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-VIS-Q1STATE</span></span>
<span id="cb286-1913"><a href="#cb286-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1914"><a href="#cb286-1914" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb286-1915"><a href="#cb286-1915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1916"><a href="#cb286-1916" aria-hidden="true" tabindex="-1"></a><span class="co">#GGSTATS | MODEL | LOG ODDS </span></span>
<span id="cb286-1917"><a href="#cb286-1917" aria-hidden="true" tabindex="-1"></a><span class="co"># ggcoefstats(m, output = "plot", </span></span>
<span id="cb286-1918"><a href="#cb286-1918" aria-hidden="true" tabindex="-1"></a><span class="co">#               # conf.level = 0.90,</span></span>
<span id="cb286-1919"><a href="#cb286-1919" aria-hidden="true" tabindex="-1"></a><span class="co">#               exclude.intercept = FALSE) + </span></span>
<span id="cb286-1920"><a href="#cb286-1920" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "Log Odds Estimate", </span></span>
<span id="cb286-1921"><a href="#cb286-1921" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "LOGODDS | Q1 State ~ condition",</span></span>
<span id="cb286-1922"><a href="#cb286-1922" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle = "(p is for two tailed test)")</span></span>
<span id="cb286-1923"><a href="#cb286-1923" aria-hidden="true" tabindex="-1"></a><span class="co">#:::::::: PLOT</span></span>
<span id="cb286-1924"><a href="#cb286-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1925"><a href="#cb286-1925" aria-hidden="true" tabindex="-1"></a><span class="co">#PARAMETERS | MODEL | SIMULATED PARAMETERS</span></span>
<span id="cb286-1926"><a href="#cb286-1926" aria-hidden="true" tabindex="-1"></a><span class="co"># similar to bayesian dist of estimate</span></span>
<span id="cb286-1927"><a href="#cb286-1927" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- simulate_parameters(m)</span></span>
<span id="cb286-1928"><a href="#cb286-1928" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, show_intercept = TRUE, stack=FALSE)</span></span>
<span id="cb286-1929"><a href="#cb286-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1930"><a href="#cb286-1930" aria-hidden="true" tabindex="-1"></a><span class="co">#PARAMETERS | MODEL | ODDS RATIO </span></span>
<span id="cb286-1931"><a href="#cb286-1931" aria-hidden="true" tabindex="-1"></a><span class="co"># result &lt;- model_parameters(m1,exponentiate = TRUE)</span></span>
<span id="cb286-1932"><a href="#cb286-1932" aria-hidden="true" tabindex="-1"></a><span class="co"># #rename params </span></span>
<span id="cb286-1933"><a href="#cb286-1933" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[1] &lt;- "condition [control]"</span></span>
<span id="cb286-1934"><a href="#cb286-1934" aria-hidden="true" tabindex="-1"></a><span class="co"># result$Parameter[2] &lt;- "condition [impasse]"</span></span>
<span id="cb286-1935"><a href="#cb286-1935" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result,   show_intercept = TRUE) +  labs(</span></span>
<span id="cb286-1936"><a href="#cb286-1936" aria-hidden="true" tabindex="-1"></a><span class="co">#   title = "Model Parameter Estimates"</span></span>
<span id="cb286-1937"><a href="#cb286-1937" aria-hidden="true" tabindex="-1"></a><span class="co"># ) + theme_clean() + theme(legend.position="blank")</span></span>
<span id="cb286-1938"><a href="#cb286-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1939"><a href="#cb286-1939" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | ODDS RATIO</span></span>
<span id="cb286-1940"><a href="#cb286-1940" aria-hidden="true" tabindex="-1"></a><span class="co">#library(sjPlot)</span></span>
<span id="cb286-1941"><a href="#cb286-1941" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb286-1942"><a href="#cb286-1942" aria-hidden="true" tabindex="-1"></a>           <span class="at">vline.color =</span> <span class="st">"red"</span>, </span>
<span id="cb286-1943"><a href="#cb286-1943" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>, </span>
<span id="cb286-1944"><a href="#cb286-1944" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>,</span>
<span id="cb286-1945"><a href="#cb286-1945" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.threshold =</span> <span class="fl">0.1</span>, <span class="co">#manually adjust to account for directional test</span></span>
<span id="cb286-1946"><a href="#cb286-1946" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="fl">0.90</span> ) <span class="sc">+</span>  <span class="co">#manually adjusted for directional test   </span></span>
<span id="cb286-1947"><a href="#cb286-1947" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() + #remove to put on log scale x axis </span></span>
<span id="cb286-1948"><a href="#cb286-1948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"control"</span>,<span class="st">"impasse"</span>))<span class="sc">+</span></span>
<span id="cb286-1949"><a href="#cb286-1949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL ESTIMATE  | Q1 Accuracy ~ condition"</span>,</span>
<span id="cb286-1950"><a href="#cb286-1950" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases odds of correct response on Q1"</span>,</span>
<span id="cb286-1951"><a href="#cb286-1951" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb286-1952"><a href="#cb286-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1953"><a href="#cb286-1953" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb286-1954"><a href="#cb286-1954" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | PROBABILITIES</span></span>
<span id="cb286-1955"><a href="#cb286-1955" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb286-1956"><a href="#cb286-1956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb286-1957"><a href="#cb286-1957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MODEL PREDICTION  | Q1 State ~ condition"</span>,</span>
<span id="cb286-1958"><a href="#cb286-1958" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Impasse increases probability of more accurate response states Q1"</span>,</span>
<span id="cb286-1959"><a href="#cb286-1959" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb286-1960"><a href="#cb286-1960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1961"><a href="#cb286-1961" aria-hidden="true" tabindex="-1"></a><span class="co">#MANUALLY BUILD PREDICTION PLOT FACET BY CONDITION RATHER THAN STATE</span></span>
<span id="cb286-1962"><a href="#cb286-1962" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span><span class="fu">plot_model</span>(m, <span class="at">type=</span><span class="st">"eff"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb286-1963"><a href="#cb286-1963" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(p)[[<span class="dv">1</span>]]  </span>
<span id="cb286-1964"><a href="#cb286-1964" aria-hidden="true" tabindex="-1"></a>points <span class="ot">&lt;-</span> d[[<span class="dv">2</span>]]</span>
<span id="cb286-1965"><a href="#cb286-1965" aria-hidden="true" tabindex="-1"></a>points <span class="ot">&lt;-</span> points <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb286-1966"><a href="#cb286-1966" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">recode</span>(PANEL, <span class="st">"1"</span> <span class="ot">=</span><span class="st">"orth"</span>, <span class="st">"2"</span><span class="ot">=</span><span class="st">"other"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"trilike"</span>, <span class="st">"4"</span><span class="ot">=</span><span class="st">"tri"</span>),</span>
<span id="cb286-1967"><a href="#cb286-1967" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">recode</span>(x, <span class="st">"1"</span><span class="ot">=</span><span class="st">"control"</span>,<span class="st">"2"</span><span class="ot">=</span><span class="st">"impasse"</span>),</span>
<span id="cb286-1968"><a href="#cb286-1968" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> y</span>
<span id="cb286-1969"><a href="#cb286-1969" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb286-1970"><a href="#cb286-1970" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>( prob <span class="sc">~</span> state, <span class="at">group =</span> <span class="sc">~</span>x, <span class="at">data =</span> points) <span class="sc">+</span> </span>
<span id="cb286-1971"><a href="#cb286-1971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>( <span class="at">x =</span> state, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax)) <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>condition) <span class="sc">+</span><span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb286-1972"><a href="#cb286-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1973"><a href="#cb286-1973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-1974"><a href="#cb286-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1977"><a href="#cb286-1977" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-1978"><a href="#cb286-1978" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-TBL-Q1STATE</span></span>
<span id="cb286-1979"><a href="#cb286-1979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1980"><a href="#cb286-1980" aria-hidden="true" tabindex="-1"></a><span class="co">#SJPLOT | MODEL | TABLE</span></span>
<span id="cb286-1981"><a href="#cb286-1981" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m)</span>
<span id="cb286-1982"><a href="#cb286-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-1983"><a href="#cb286-1983" aria-hidden="true" tabindex="-1"></a><span class="co"># #MODEL SUMMARY | save latex table</span></span>
<span id="cb286-1984"><a href="#cb286-1984" aria-hidden="true" tabindex="-1"></a><span class="co"># models &lt;- list("odds ratios" = m1, "(log odds)" = m1)</span></span>
<span id="cb286-1985"><a href="#cb286-1985" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = list("* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001",</span></span>
<span id="cb286-1986"><a href="#cb286-1986" aria-hidden="true" tabindex="-1"></a><span class="co">#              '$sigma^{2}$ = 3.29" N(subject) = 126 $\tau_{00}$(subject) = 22.22 N(question) = 13 $\tau_{00}$(question) = 0.31'</span></span>
<span id="cb286-1987"><a href="#cb286-1987" aria-hidden="true" tabindex="-1"></a><span class="co">#                )</span></span>
<span id="cb286-1988"><a href="#cb286-1988" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb286-1989"><a href="#cb286-1989" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(models,</span></span>
<span id="cb286-1990"><a href="#cb286-1990" aria-hidden="true" tabindex="-1"></a><span class="co">#              exponentiate = c(TRUE, FALSE),</span></span>
<span id="cb286-1991"><a href="#cb286-1991" aria-hidden="true" tabindex="-1"></a><span class="co">#              shape = term ~ model + statistic,</span></span>
<span id="cb286-1992"><a href="#cb286-1992" aria-hidden="true" tabindex="-1"></a><span class="co">#              fmt = 2, #two digits w/ trailing zero</span></span>
<span id="cb286-1993"><a href="#cb286-1993" aria-hidden="true" tabindex="-1"></a><span class="co">#              estimate  = "{estimate} {stars}",</span></span>
<span id="cb286-1994"><a href="#cb286-1994" aria-hidden="true" tabindex="-1"></a><span class="co">#              statistic = "conf.int",</span></span>
<span id="cb286-1995"><a href="#cb286-1995" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_map = c("AIC", "sigma"),</span></span>
<span id="cb286-1996"><a href="#cb286-1996" aria-hidden="true" tabindex="-1"></a><span class="co">#              gof_omit = 'RMSE|ICC|BIC',</span></span>
<span id="cb286-1997"><a href="#cb286-1997" aria-hidden="true" tabindex="-1"></a><span class="co">#              coef_rename = c("pretty_conditionimpasse" = "Condition[impasse]"),</span></span>
<span id="cb286-1998"><a href="#cb286-1998" aria-hidden="true" tabindex="-1"></a><span class="co">#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', </span></span>
<span id="cb286-1999"><a href="#cb286-1999" aria-hidden="true" tabindex="-1"></a><span class="co">#              notes = notes,</span></span>
<span id="cb286-2000"><a href="#cb286-2000" aria-hidden="true" tabindex="-1"></a><span class="co">#              output = "analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex")</span></span>
<span id="cb286-2001"><a href="#cb286-2001" aria-hidden="true" tabindex="-1"></a><span class="co"># #              # coef_omit = "Intercept",</span></span>
<span id="cb286-2002"><a href="#cb286-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2003"><a href="#cb286-2003" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary(mixcat.1, s)</span></span>
<span id="cb286-2004"><a href="#cb286-2004" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO OUTPUT TABLE </span></span>
<span id="cb286-2005"><a href="#cb286-2005" aria-hidden="true" tabindex="-1"></a><span class="co">#https://arelbundock.com/posts/modelsummary_multinomial_logit/</span></span>
<span id="cb286-2006"><a href="#cb286-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2007"><a href="#cb286-2007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2008"><a href="#cb286-2008" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-2009"><a href="#cb286-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2010"><a href="#cb286-2010" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb286-2011"><a href="#cb286-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2014"><a href="#cb286-2014" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb286-2015"><a href="#cb286-2015" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: MODEL-DIAG-Q1STATE</span></span>
<span id="cb286-2016"><a href="#cb286-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2017"><a href="#cb286-2017" aria-hidden="true" tabindex="-1"></a><span class="co">#EXAMINE PREDICTIONS</span></span>
<span id="cb286-2018"><a href="#cb286-2018" aria-hidden="true" tabindex="-1"></a><span class="co">#create sample data frame</span></span>
<span id="cb286-2019"><a href="#cb286-2019" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pretty_condition =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"impasse"</span>))</span>
<span id="cb286-2020"><a href="#cb286-2020" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(catm, <span class="at">newdata =</span> test, <span class="st">"probs"</span>)</span>
<span id="cb286-2021"><a href="#cb286-2021" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Predicted Probability of Being in Each State"</span>)</span>
<span id="cb286-2022"><a href="#cb286-2022" aria-hidden="true" tabindex="-1"></a>( x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test, pred))</span>
<span id="cb286-2023"><a href="#cb286-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2024"><a href="#cb286-2024" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"MODEL PERFORMANCE"</span>)</span>
<span id="cb286-2025"><a href="#cb286-2025" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(catm)</span>
<span id="cb286-2026"><a href="#cb286-2026" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(catm, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span>))</span>
<span id="cb286-2027"><a href="#cb286-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2028"><a href="#cb286-2028" aria-hidden="true" tabindex="-1"></a><span class="co">#General Goodness of Fit</span></span>
<span id="cb286-2029"><a href="#cb286-2029" aria-hidden="true" tabindex="-1"></a><span class="co">#library(generalhoslem)</span></span>
<span id="cb286-2030"><a href="#cb286-2030" aria-hidden="true" tabindex="-1"></a><span class="co">#logitgof(df$state, catm$fitted.values, g = 3)</span></span>
<span id="cb286-2031"><a href="#cb286-2031" aria-hidden="true" tabindex="-1"></a><span class="co">#A non-significant p value indicates that there is no evidence that the observed and expected frequencies differ (i.e., evidence of good fit).</span></span>
<span id="cb286-2032"><a href="#cb286-2032" aria-hidden="true" tabindex="-1"></a><span class="co">#don't fret! this version of the hoslem-lem test is problematic with fewer than 10 input variables</span></span>
<span id="cb286-2033"><a href="#cb286-2033" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.test(df$state, predict(catm)) #actual states VS predicted states</span></span>
<span id="cb286-2034"><a href="#cb286-2034" aria-hidden="true" tabindex="-1"></a><span class="co"># The chi-square test tests the decrease in unexplained variance from the baseline model to the final model</span></span>
<span id="cb286-2035"><a href="#cb286-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2036"><a href="#cb286-2036" aria-hidden="true" tabindex="-1"></a><span class="co"># print("MODEL DIAGNOSTICS")</span></span>
<span id="cb286-2037"><a href="#cb286-2037" aria-hidden="true" tabindex="-1"></a><span class="co"># check_model(m) can't do overall diagnostics, have to do them on individual model equations</span></span>
<span id="cb286-2038"><a href="#cb286-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2039"><a href="#cb286-2039" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb286-2040"><a href="#cb286-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2041"><a href="#cb286-2041" aria-hidden="true" tabindex="-1"></a><span class="fu">##### TODO</span></span>
<span id="cb286-2042"><a href="#cb286-2042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-2043"><a href="#cb286-2043" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>interpretation/reporting of model fit?</span>
<span id="cb286-2044"><a href="#cb286-2044" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>sanity check correct interpretation of coefficients &amp; reporting</span>
<span id="cb286-2045"><a href="#cb286-2045" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>diagnostics on individual model equations</span>
<span id="cb286-2046"><a href="#cb286-2046" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>calculate 1-tailed p values to match directional hypothesis</span>
<span id="cb286-2047"><a href="#cb286-2047" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>