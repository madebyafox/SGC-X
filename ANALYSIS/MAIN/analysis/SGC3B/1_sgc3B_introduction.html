<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.328">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>sgc3b_introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="1_sgc3B_introduction_files/libs/clipboard/clipboard.min.js"></script>
<script src="1_sgc3B_introduction_files/libs/quarto-html/quarto.js"></script>
<script src="1_sgc3B_introduction_files/libs/quarto-html/popper.min.js"></script>
<script src="1_sgc3B_introduction_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="1_sgc3B_introduction_files/libs/quarto-html/anchor.min.js"></script>
<link href="1_sgc3B_introduction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="1_sgc3B_introduction_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="1_sgc3B_introduction_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="1_sgc3B_introduction_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="1_sgc3B_introduction_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="1_sgc3B_introduction_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="1_sgc3B_introduction_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<div style="page-break-after: always;"></div>
<p><strong>TODO UPDATE ALL</strong></p>
<section id="sec-SGC3B-introduction" class="level1">
<h1>Introduction</h1>
<p><strong>In Study 3B we compare the efficacy of the explicit [interaction] scaffold and the implicit [impasse] scaffold.</strong></p>
<table class="table">
<tbody>
<tr class="odd">
<td><img src="/analysis/utils/img/111.png" class="img-fluid"></td>
<td><strong>Control-Condition</strong><br>
Demo: <a href="https://limitless-plains-85018.herokuapp.com/?study=SGC3B&amp;condition=111&amp;session=WEB-DEMO">111</a></td>
</tr>
<tr class="even">
<td><img src="/analysis/utils/img/121.png" class="img-fluid"></td>
<td><strong>Impasse-Condition</strong><br>
Demo: <a href="https://limitless-plains-85018.herokuapp.com/?study=SGC3B&amp;condition=121&amp;session=WEB-DEMO">121</a></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(codebook) <span class="co">#data dictionary</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#ALL THE THINGS</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#tables</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#set some output options</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>imac <span class="ot">=</span> <span class="st">"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(imac)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT DATA </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">'analysis/SGC3B/data/1-study-level/sgc3b_participants.rds'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Participants by Condition and Data Collection Period"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"NONE-NONE"</span>,<span class="st">"NONE-Impasse"</span>,<span class="st">"IMG-NONE"</span>,<span class="st">"IMG-Impasse"</span>,<span class="st">"IXV-NONE"</span>,<span class="st">"IXV-Impasse"</span>,<span class="st">"Total for Period"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">table</span>(df_subjects<span class="sc">$</span>pretty_mode, df_subjects<span class="sc">$</span>condition)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>cont <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>() <span class="sc">%&gt;%</span> <span class="fu">kbl</span>(<span class="at">caption =</span> title, <span class="at">col.names =</span> cols) <span class="sc">%&gt;%</span>  <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Participants by Condition and Data Collection Period</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> NONE-NONE </th>
   <th style="text-align:right;"> NONE-Impasse </th>
   <th style="text-align:right;"> IMG-NONE </th>
   <th style="text-align:right;"> IMG-Impasse </th>
   <th style="text-align:right;"> IXV-NONE </th>
   <th style="text-align:right;"> IXV-Impasse </th>
   <th style="text-align:right;"> Total for Period </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> laboratory </td>
   <td style="text-align:right;"> 62 </td>
   <td style="text-align:right;"> 64 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 59 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 290 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> online-replication </td>
   <td style="text-align:right;"> 68 </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 170 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sum </td>
   <td style="text-align:right;"> 130 </td>
   <td style="text-align:right;"> 135 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> 42 </td>
   <td style="text-align:right;"> 62 </td>
   <td style="text-align:right;"> 41 </td>
   <td style="text-align:right;"> 460 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<section id="hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="hypotheses">Hypotheses</h3>
<p><strong>Experimental Hypothesis</strong><br>
<em>Learners posed with scenario designed to evoke a mental impasse will be more likely to correct interpret the graph.</em></p>
<ul>
<li>H1A | Learners in the IMPASSE condition will score higher on the TEST Phase than learners in CONTROL.</li>
<li>H1B | Learners in the IMPASSE condition will be more likely to correctly answer the first question than learners in CONTROL.</li>
<li>H1C | Learners in the IMPASSE condition will spend more time on the first question than learners in CONTROL.</li>
</ul>
<p><strong>Null Hypothesis</strong><br>
<em>No significant differences in performance will exist between learners in the IMPASSE and CONTROL conditions.</em></p>
<p><strong>Exploratory Questions</strong></p>
<ul>
<li>Consistency | How consistent are learners in their interpretation of the graph? Do they adopt an interpretation on the first question and hold constant? Or do they change interpretations from question to question? Are there any interpretations that serve as ‘absorbing states’ (i.e.&nbsp;once encountered, the learner does not exist this state).</li>
<li>Time Course of Exploration | What is the relationship between response accuracy (and interpretation) and time spent on each item?</li>
<li>Can exploration strategies be derived from mouse cursor activity?</li>
</ul>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">METHODS</h2>
<section id="design" class="level3">
<h3 class="anchored" data-anchor-id="design">Design</h3>
<p>We employed a mixed design with 1 between-subjects factor with 2 levels (Scaffold: control, impasse) and 15 items (within-subjects factor).</p>
<p>Independent Variables:</p>
<ul>
<li>B-S (Scaffold: control,impasse)</li>
<li>W-S (Item x 15)</li>
</ul>
<p>Dependent Variables:</p>
<ul>
<li>Response Accuracy : Is the response triangular-correct?</li>
<li>Response Interpretation : (derived) With which interpretation of the graph is the subject’s response on an individual question consistent?</li>
<li>Response Latency : Time from stimulus onset to clicking ‘Submit’ button: time in (s)</li>
</ul>
</section>
<section id="materials" class="level3">
<h3 class="anchored" data-anchor-id="materials">Materials</h3>
<p>Stimuli consisted of a series of 15 graph comprehension questions, each testing a different combination of time interval relations, to be read from a Triangular-Model graph. <a href="#fig-sample">Figure&nbsp;1</a>. The list of questions can be found <a href="static/stimuli/sgcx_questions.csv">here</a>.</p>
<div id="fig-sample" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="static/stimuli/sample_task.png" class="img-fluid figure-img" alt="picture of multiple select question on the left, accompanied by a triangular model graph on the right"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Sample Question (Q=1) for Graph Comprehension Task</figcaption><p></p>
</figure>
</div>
<p>Note that across both control and impasse conditions, both the question, response options and graph structure were identical. The experimental manipulation (posing a mental impasse) was accomplished by changing the position of datapoints in the impasse-condition graph, such that for any given question, there was no available response option if the reader were to interpret the graph as cartesian (making an orthogonal rather than diagonal projection from the x-axis.)</p>
<p><em>The green line indicates the ideal-scanpath to the correct (triangular) answer to the first question, and the red line indicates the (incorrect) orthogonal interpretation. In the IMPASSE figure (at right), there are no data points that intersect the red line. We hypothesize that this presents the reader with an obstacle, at which point they are forced to confront their interpretation of the coordinate system and (ideally) develop a new strategy.</em></p>
<div id="fig-conditions" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="static/stimuli/3B_conditions.png" class="img-fluid figure-img" alt="a triangle graph at left shows the correct (diagonal) path from the x-axis to the correct answer(datapoint f) in green, and an incorrect orthogonal projection from the x-axis to incorrect datapoint A.  At right, the same graph is depicted, but datapoint A no longer intersects the orthogonal projection from the xaxis."></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2: Sample Question (Q=1) graphs for each condition</figcaption><p></p>
</figure>
</div>
</section>
<section id="procedure" class="level3">
<h3 class="anchored" data-anchor-id="procedure">Procedure</h3>
<p>Participants completed the study via a web-browser.</p>
<p>(1) Upon starting, they submitted informed consent, before reading task instructions.</p>
<p>(2) Participants were introduced to a scenario in which they were to play the role of a project manager, scheduling shifts for a group of employees. The schedule of the employees was presented in a TriangularModel (TM) graph, and they would be answering question about the schedule.</p>
<p>(3) Then participants completed an experimental block of 15 items.</p>
<p>(3B) The first five items in the task are defined as the SCAFFOLDING block. In the IMPASSE condition, the first five questions included an IMPASSE problem state. For participants in the CONTROL condition, the dataset was structure such that there was always an available ‘orthogonal answer’ for the first 5 questions.</p>
<p>(3B) The remaining 10 items are defined as the TESTING block. In both conditions, these questions were not structured as impasse (i.e.&nbsp;contained an available orthogonal answer)</p>
<p>(4) Following the experimental block, participants answered a free-response question about their strategy for reading the graph, followed by a demographic questionnaire and debrief.</p>
</section>
<section id="sample" class="level3">
<h3 class="anchored" data-anchor-id="sample">Sample</h3>
<p>Data was collected by convenience sample of a university subject pool. Initial data (Fall 2017, Spring 2018) were collected in-person, with large groups of students simultaneously completing the study (independently) in a computer lab. In Fall 2021 and Winter 2022 we collected additional data to replicate results in a remote format (students completing the study asynchronously on their own computers).</p>
</section>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">ANALYSIS</h2>
<section id="sec-SGC3B-harmonize" class="level3">
<h3 class="anchored" data-anchor-id="sec-SGC3B-harmonize">Data Preparation</h3>
<p>Data were collected via a custom web application and stored in a NoSQL database. The following exclusion criteria were applied during data cleaning:</p>
<ul>
<li>completion status : “success” ; subject must have finished all parts of the study, including demographic questionnaire</li>
<li>session ID: [in list] ; subject must have been assigned to valid data collection session (discard testing and piloting data)</li>
<li>browser interaction violations &lt; 3; subject must have fewer than 3 violations of non-allowed browser interactions (i.e.&nbsp;resizing window, leaving browser tab or leaving fullscreen mode)</li>
<li>self-rated effort &gt; 2; subjects who reported, “not trying hard/rushing through questions” or “started out trying hard but giving up at some point” were excluded from analysis.</li>
<li>attention check ==TRUE ; subjects who failed to answer a mid-study attention check question (Graph Comprehension Task Question #6) are excluded</li>
</ul>
<p>Before analysis, data files from individual data collection periods are harmonized into a common data format.</p>
<table class="table">
<colgroup>
<col style="width: 83%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Pre-Requisite</th>
<th>Followed By</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>spring17_clean_data.Rmd <br> spring18_clean_data.Rmd <br> fall21_clean_data.Rmd <br> winter2022_clean_sgc3b.Rmd</td>
<td>2_sgc3B_scoring.qmd</td>
</tr>
</tbody>
</table>
<p>Data for study SGC_3B were collected across four time periods, interrupted by the Covid-19 pandemic.</p>
<table class="table">
<thead>
<tr class="header">
<th>Period</th>
<th>Modality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fall 2017</td>
<td>in person, SONA groups in computer lab</td>
</tr>
<tr class="even">
<td>Spring 2018</td>
<td>in person, SONA groups in computer lab</td>
</tr>
<tr class="odd">
<td>Fall 2021</td>
<td>asynchronous, online, SONA</td>
</tr>
</tbody>
</table>
<p>Data collected in Fall 2017, Spring 2018 constitute the original SGC_3B study, conducted in person. Data collected in Fall 2021 constitute the web-based replication, conducted online (asynchronously). In all cases, the experiment was administered via a web application.</p>
<p>The underlying data structure of the stimulus web application changed across the data collection period, resulting in slightly different data files (i.e.&nbsp;columns are not named consistently). In this section, we combine the files from each data collection period into a single <em>harmonized</em> data file for analysis (one for participants, one for items).</p>
<section id="participants" class="level4">
<h4 class="anchored" data-anchor-id="participants">Participants</h4>
<p>First we import participant-level data from each data collection period, selecting only the columns relevant for analysis, and renaming columns to be consistent across each file. The result is a single data frame <code>df_subjects</code> containing one row for each subject (across all periods). Note that we <em>are not</em> discarding any <em>response</em> data. Rather, we discard columns that are automatically recorded by the stimulus web application and help the application run.</p>
<p><em>Note that we discard some columns representing scores calculated in the stimulus engine. These scores were calculated differently across collection periods, and so we discard them and recalculate scores in the next analysis notebook. No raw data (responses and response times) are discarded, only algorithmically-derived scores for the responses.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#IMPORT PARTICIPANT DATA</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>imac <span class="ot">=</span> <span class="st">"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(imac)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#set datafiles</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>fall17 <span class="ot">&lt;-</span> <span class="st">"analysis/SGC3B/data/0-session-level/fall17_sgc3b_participants.csv"</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>spring18 <span class="ot">&lt;-</span> <span class="st">"analysis/SGC3B/data/0-session-level/spring18_sgc3b_participants.csv"</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>fall21 <span class="ot">&lt;-</span> <span class="st">"analysis/SGC3B/data/0-session-level/fall21_sgc3b_participants.csv"</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="st">"analysis/SGC3A/data/0-session-level/winter22_sgc3a_participants.csv"</span> <span class="co">#FOR SCHEMA ONLY</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#read datafiles, set mode and term</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>df_subjects_fall17 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(fall17) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mode =</span> <span class="st">"lab-synch"</span>, <span class="at">term =</span> <span class="st">"fall17"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>df_subjects_spring18 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(spring18) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mode =</span> <span class="st">"lab-synch"</span>, <span class="at">term =</span> <span class="st">"spring18"</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>df_subjects_fall21 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(fall21) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mode =</span> <span class="st">"asynch"</span>, <span class="at">term =</span> <span class="st">"fall21"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(meta)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#SAVE METADATA FROM SGC3A, but no rows </span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition<span class="sc">==</span><span class="st">'X'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  subject,condition,term,mode,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  gender,age,language, schoolyear, country,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  effort,difficulty,confidence,enjoyment,other,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  totaltime_m, </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># absolute_score, #drop absolute score as this is re-scored [though should be the same]</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#exploratory factors</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  violations, browser, width, height</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE COLS</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co"># janitor::compare_df_cols(df_subjects_fall17, df_subjects_spring18, df_subjects_fall21,meta)</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co">#reduce data collected using OLD webapp to useful columns</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>df_subjects_before <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_subjects_fall17, df_subjects_spring18, df_subjects_fall21) <span class="sc">%&gt;%</span> </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#rename and summarize some columns</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">totaltime_m =</span> totalTime <span class="sc">/</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">60</span>,  </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">absolute_score =</span> triangular_score,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">language =</span> native_language,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> sex,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">schoolyear =</span> year) <span class="sc">%&gt;%</span> </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create placeholders for cols not collected until NEW webapp [for later rbind]</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">effort =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">difficulty =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">confidence =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">enjoyment =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">other =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">disability =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">violations =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">browser =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="st">"NULL"</span>,</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="st">"NULL"</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select only columns we'll be analyzing, discard others</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(subject, condition, term, mode, </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>                <span class="co">#demographics</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>                gender, age, language, schoolyear, country,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>                <span class="co">#placeholder effort survey</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>                effort, difficulty, confidence, enjoyment, </span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>                <span class="co">#placeholder misc </span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>                other, disability,</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>                <span class="co">#response characteristics</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>                totaltime_m, </span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>                <span class="co"># absolute_score, #drop absolute score as this is re-scored [though should be the same]</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>                <span class="co">#exploratory factors</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>                violations, browser, width, height)</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>effort_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"I tried my best on each question"</span>, <span class="st">"I tried my best on most questions"</span>)</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="co">#combine dataframes from old and new webapps</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>df_subjects <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_subjects, df_subjects_before) <span class="sc">%&gt;%</span> </span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>  <span class="co">#refactor factors</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">factor</span>(subject),</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> <span class="fu">factor</span>(condition),</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">pretty_condition =</span> <span class="fu">recode_factor</span>(condition, <span class="st">"111"</span> <span class="ot">=</span> <span class="st">"control"</span>, <span class="st">"121"</span> <span class="ot">=</span>  <span class="st">"impasse"</span>),</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">pretty_mode =</span> <span class="fu">recode_factor</span>(mode, <span class="st">"lab-synch"</span> <span class="ot">=</span> <span class="st">"laboratory"</span>, <span class="st">"asynch"</span> <span class="ot">=</span>  <span class="st">"online-replication"</span>),</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">factor</span>(term, <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">"fall17"</span>,<span class="st">"spring18"</span>,<span class="st">"fall21"</span>,<span class="st">"winter22"</span>)),</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="fu">factor</span>(mode, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"lab-synch"</span>,<span class="st">"asynch"</span>)),</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">schoolyear =</span> <span class="fu">factor</span>(schoolyear, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"First"</span>,<span class="st">"Second"</span>,<span class="st">"Third"</span>,<span class="st">"Fourth"</span>,<span class="st">"Fifth"</span>,<span class="st">"Other"</span>))</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a><span class="co">#FIX METADATA</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a><span class="co">#Add metadata for columns that lost it [factors, for some reason!]</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_subjects<span class="sc">$</span>subject) <span class="ot">&lt;-</span> <span class="st">"ID of subject (randomly assigned in stimulus app)."</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_subjects<span class="sc">$</span>condition) <span class="ot">&lt;-</span> <span class="st">"ID indicates randomly assigned condition (111 -&gt; control, 121 -&gt; impasse)."</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_subjects<span class="sc">$</span>term) <span class="ot">&lt;-</span> <span class="st">"indicates if session was run with experimenter present or asynchronously"</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_subjects<span class="sc">$</span>mode) <span class="ot">&lt;-</span> <span class="st">"indicates mode in which the participant completed the study"</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_subjects<span class="sc">$</span>gender) <span class="ot">&lt;-</span> <span class="st">"What is your gender identity?"</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_subjects<span class="sc">$</span>schoolyear) <span class="ot">&lt;-</span> <span class="st">"What is your year in school?"</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a><span class="co">#CLEANUP</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(df_subjects_fall17,df_subjects_fall21, df_subjects_spring18, df_subjects_before)</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fall17,fall21,spring18,meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="items" class="level4">
<h4 class="anchored" data-anchor-id="items">Items</h4>
<p>Next we import item-level data from each data collection period, selecting only the columns relevant for analysis, and renaming columns to be consistent across each file. The result is a single data frame <code>df_items</code> containing one row for each <em>graph comprehension task question</em> (qs=15) (across all periods). A second data frame <code>df_freeresponse</code> contains one row for each free response strategy question (last question posed to participants in Winter2022) Note that we <em>do not</em> discard any <em>response</em> data. Rather, we <em>do</em> discard several columns representing accuracy scores for responses that were calculated in the stimulus engine. These scores were calculated differently across collection periods, and so we discard them and recalculate scores in the next analysis notebook. Original response data are always preserved.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>imac <span class="ot">=</span> <span class="st">"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(imac)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#set datafiles</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>fall17 <span class="ot">&lt;-</span> <span class="st">"analysis/SGC3B/data/0-session-level/fall17_sgc3b_blocks.csv"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>spring18 <span class="ot">&lt;-</span> <span class="st">"analysis/SGC3B/data/0-session-level/spring18_sgc3b_blocks.csv"</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>fall21 <span class="ot">&lt;-</span> <span class="st">"analysis/SGC3B/data/0-session-level/fall21_sgc3b_blocks.csv"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="st">"analysis/SGC3A/data/0-session-level/winter22_sgc3a_items.rds"</span> <span class="co">#FOR SCHEMA ONLY</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#read datafiles, set mode and term</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>df_items_fall17 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(fall17) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mode =</span> <span class="st">"lab-synch"</span>, <span class="at">term =</span> <span class="st">"fall17"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>df_items_spring18 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(spring18) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mode =</span> <span class="st">"lab-synch"</span>, <span class="at">term =</span> <span class="st">"spring18"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>df_items_fall21 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(fall21) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mode =</span> <span class="st">"asynch"</span>, <span class="at">term =</span> <span class="st">"fall21"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(meta) <span class="co">#use RDS file as it contains metadata</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#get mapping being question # and interval relation the question tests, that is encoded only in the winter22 data files</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>map_relations <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(q) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(q,relation) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#SAVE METADATA FROM WINTER, but no rows </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition<span class="sc">==</span><span class="st">'X'</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  subject,condition,term,mode,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  question, q, answer, correct, rt_s</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#reduce data collected using old webapp</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>df_items_before <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_items_fall17, df_items_spring18, df_items_fall21) <span class="sc">%&gt;%</span> </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_s =</span> rt <span class="sc">/</span> <span class="dv">1000</span>, <span class="at">correct =</span> <span class="fu">as.logical</span>(correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(subject, condition, term, mode, question, q, answer, correct, rt_s) </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPARE COLS</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">compare_df_cols</span>(df_items_before, df_items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  column_name df_items_before  df_items
1      answer       character character
2   condition         numeric    factor
3     correct         logical    factor
4        mode       character    factor
5           q         numeric    factor
6    question       character character
7        rt_s         numeric   numeric
8     subject       character    factor
9        term       character    factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#combine dataframes from old and new webapps</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_items, df_items_before) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#refactorize columns</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">factor</span>(subject),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> <span class="fu">factor</span>(condition),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">factor</span>(term, <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">"fall17"</span>,<span class="st">"spring18"</span>,<span class="st">"fall21"</span>,<span class="st">"winter22"</span>)),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="fu">factor</span>(mode, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"lab-synch"</span>,<span class="st">"asynch"</span>)),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">as.integer</span>(q)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#rename answer column to RESPONSE </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">response =</span> answer) <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#remove all commas and make as character string</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">response =</span> <span class="fu">str_remove_all</span>(<span class="fu">as.character</span>(response), <span class="st">","</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_o =</span> <span class="fu">str_length</span>(response)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># handle NA values (why are some empty responses blank and others NA?) </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">response =</span> <span class="fu">replace_na</span>(response, <span class="st">""</span>),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_o =</span> <span class="fu">replace_na</span>(num_o, <span class="dv">0</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#FIX METADATA</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Add metadata for columns that lost it [factors, for some reason!]</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_items<span class="sc">$</span>subject) <span class="ot">&lt;-</span> <span class="st">"ID of subject (randomly assigned in stimulus app)."</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_items<span class="sc">$</span>condition) <span class="ot">&lt;-</span> <span class="st">"ID indicates randomly assigned condition (111 -&gt; control, 121 -&gt; impasse)."</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_items<span class="sc">$</span>term) <span class="ot">&lt;-</span> <span class="st">"indicates if session was run with experimenter present or asynchronously"</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_items<span class="sc">$</span>mode) <span class="ot">&lt;-</span> <span class="st">"indicates mode in which the participant completed the study"</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_items<span class="sc">$</span>q) <span class="ot">&lt;-</span> <span class="st">"Question Number (in order)"</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_items<span class="sc">$</span>correct) <span class="ot">&lt;-</span> <span class="st">"Is the response (strictly) correct? [dichotomous scoring]"</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_items<span class="sc">$</span>response) <span class="ot">&lt;-</span> <span class="st">"options (datapoints) selected by the subject"</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df_items<span class="sc">$</span>num_o) <span class="ot">&lt;-</span> <span class="st">"number of options selected by the subject"</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#HANDLE FREE RESPONSE QUESTION #16 </span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#save `free response` Q#16 in its own dataframe</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>df_freeresponse <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span>(q <span class="sc">==</span> <span class="dv">16</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>question,<span class="sc">-</span>correct,<span class="sc">-</span>rt_s,<span class="sc">-</span>num_o)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#add question description</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>df_freeresponse <span class="ot">&lt;-</span> df_freeresponse <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">question =</span> <span class="st">"Please describe how to determine what event(s) start at 12pm?"</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">as.character</span>(response) <span class="co">#doesn't need to be factor</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co">#remove 'free response' Q#16 from df_items</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">filter</span> (q <span class="sc">!=</span> <span class="dv">16</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="co">#add back pretty condition </span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>df_items <span class="ot">&lt;-</span> df_items <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">pretty_condition =</span> <span class="fu">recode_factor</span>(condition, </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"111"</span> <span class="ot">=</span> <span class="st">"none-none"</span>, <span class="st">"121"</span> <span class="ot">=</span>  <span class="st">"none-impasse"</span>, </span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"211"</span> <span class="ot">=</span> <span class="st">"img-none"</span>, <span class="st">"221"</span> <span class="ot">=</span>  <span class="st">"img-impasse"</span>, </span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"311"</span> <span class="ot">=</span> <span class="st">"ixv-none"</span>, <span class="st">"321"</span> <span class="ot">=</span>  <span class="st">"ixv-impasse"</span>, </span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">pretty_mode =</span> <span class="fu">recode_factor</span>(mode, <span class="st">"lab-synch"</span> <span class="ot">=</span> <span class="st">"laboratory"</span>, <span class="st">"asynch"</span> <span class="ot">=</span>  <span class="st">"online-replication"</span>)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co">#CLEANUP</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(df_items_fall17,df_items_fall21, df_items_spring18, df_items_before)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fall17,fall21,spring18,meta, map_relations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="validation" class="level4">
<h4 class="anchored" data-anchor-id="validation">Validation</h4>
<p>Next, we validate that we have the complete number of item-level records based on the number of subject-level records</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the number of items should be equal to 15 x the number of subjects</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_items) <span class="sc">==</span> <span class="dv">15</span><span class="sc">*</span> <span class="fu">nrow</span>(df_subjects) <span class="co">#TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#each subject should have 15 items</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_items <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n <span class="sc">!=</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">==</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="export" class="level4">
<h4 class="anchored" data-anchor-id="export">Export</h4>
<p>Finally, we export the (session-harmonized) data for analysis, as CSVs, and .RDS (includes metadata)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">HACK</span><span class="co"> WD FOR LOCAL RUNNING?</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>imac <span class="ot">=</span> <span class="st">"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #mbp = "/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(imac)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#SAVE FILES</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_subjects,<span class="st">"analysis/SGC3B/data/1-study-level/sgc3b_participants.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_items,<span class="st">"analysis/SGC3B/data/1-study-level/sgc3b_items.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_freeresponse,<span class="st">"analysis/SGC3B/data/1-study-level/sgc3b_freeresponse.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#SAVE R Data Structures </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#export R DATA STRUCTURES (include codebook metadata)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(df_subjects, <span class="st">"analysis/SGC3B/data/1-study-level/sgc3b_participants.rds"</span>) <span class="co"># to R data structure file</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(df_items, <span class="st">"analysis/SGC3B/data/1-study-level/sgc3b_items.rds"</span>) <span class="co"># to R data structure file</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">RESOURCES</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.1 (2022-06-23)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur ... 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] kableExtra_1.3.4 forcats_0.5.1    stringr_1.4.0    dplyr_1.0.9     
 [5] purrr_0.3.4      readr_2.1.2      tidyr_1.2.0      tibble_3.1.7    
 [9] ggplot2_3.3.6    tidyverse_1.3.1  codebook_0.9.2  

loaded via a namespace (and not attached):
 [1] httr_1.4.3        bit64_4.0.5       vroom_1.5.7       jsonlite_1.8.0   
 [5] viridisLite_0.4.0 modelr_0.1.8      assertthat_0.2.1  highr_0.9        
 [9] cellranger_1.1.0  yaml_2.3.5        pillar_1.7.0      backports_1.4.1  
[13] glue_1.6.2        digest_0.6.29     rvest_1.0.2       snakecase_0.11.0 
[17] colorspace_2.0-3  htmltools_0.5.2   pkgconfig_2.0.3   broom_0.8.0      
[21] labelled_2.9.1    haven_2.5.0       scales_1.2.0      webshot_0.5.3    
[25] svglite_2.1.0     openxlsx_4.2.5    rio_0.5.29        tzdb_0.3.0       
[29] generics_0.1.2    ellipsis_0.3.2    withr_2.5.0       janitor_2.1.0    
[33] cli_3.3.0         magrittr_2.0.3    crayon_1.5.1      readxl_1.4.0     
[37] evaluate_0.15     fs_1.5.2          fansi_1.0.3       xml2_1.3.3       
[41] foreign_0.8-82    tools_4.2.1       data.table_1.14.2 hms_1.1.1        
[45] lifecycle_1.0.1   munsell_0.5.0     reprex_2.0.1      zip_2.2.0        
[49] compiler_4.2.1    systemfonts_1.0.4 rlang_1.0.3       grid_4.2.1       
[53] rstudioapi_0.13   htmlwidgets_1.5.4 rmarkdown_2.14    gtable_0.3.0     
[57] DBI_1.1.3         curl_4.3.2        R6_2.5.1          lubridate_1.8.0  
[61] knitr_1.39        fastmap_1.1.0     bit_4.0.4         utf8_1.2.2       
[65] stringi_1.7.6     parallel_4.2.1    Rcpp_1.0.8.3      vctrs_0.4.1      
[69] dbplyr_2.2.1      tidyselect_1.1.2  xfun_0.31        </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>