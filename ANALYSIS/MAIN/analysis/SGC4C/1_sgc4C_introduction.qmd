---
subtitle: 'Study SGC4C | 1 Introduction'
---

\newpage

# Introduction {#sec-SGC4C-introduction}

**In Study 4C we explore the extent to which the orientation of the axes in space influence how a reader interprets its underlying coordinate system.**

+---------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
|                                       | **Orthogonal --- 0 degree**\                                                                                                   |
|                                       |                                                                                                                                |
|                                       | **Demo Stimulus: [Q1](https://limitless-plains-85018.herokuapp.com/?q=1&condition=111&session=WEB-DEMO)\                       |
|                                       | Full Study : condition [111](https://limitless-plains-85018.herokuapp.com/?study=SGC4C&condition=111&session=WEB-DEMO)**       |
+=======================================+================================================================================================================================+
| ![](/analysis/utils/img/11111221.png) | **Orthogonal --- 45 degree**\                                                                                                  |
|                                       |                                                                                                                                |
|                                       | Demo Stimulus: [Q1](https://limitless-plains-85018.herokuapp.com/?q=1&condition=1111221&session=WEB-DEMO)\                     |
|                                       | Full Study : condition [1111221](https://limitless-plains-85018.herokuapp.com/?study=SGC4C&condition=1111221&session=WEB-DEMO) |
+---------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
| ![](/analysis/utils/img/11111331.png) | **Orthogonal --- 90 degree**                                                                                                   |
|                                       |                                                                                                                                |
|                                       | Demo Stimulus: [Q1](https://limitless-plains-85018.herokuapp.com/?q=1&condition=1111221&session=WEB-DEMO)\                     |
|                                       | Full Study : condition [1111331](https://limitless-plains-85018.herokuapp.com/?study=SGC4C&condition=1111331&session=WEB-DEMO) |
+---------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
| ![](/analysis/utils/img/113.png)      | **Triangular --- 0 degree**\                                                                                                   |
|                                       |                                                                                                                                |
|                                       | Demo Stimulus: [Q1](https://limitless-plains-85018.herokuapp.com/?q=1&condition=113&session=WEB-DEMO)\                         |
|                                       | Full Study : condition [113](https://limitless-plains-85018.herokuapp.com/?study=SGC4C&condition=113&session=WEB-DEMO)         |
+---------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
| ![](/analysis/utils/img/11311221.png) | **Triangular --- 45 degree**                                                                                                   |
|                                       |                                                                                                                                |
|                                       | Demo Stimulus: [Q1](https://limitless-plains-85018.herokuapp.com/?q=1&condition=1111221&session=WEB-DEMO)\                     |
|                                       | Full Study : condition [1131221](https://limitless-plains-85018.herokuapp.com/?study=SGC4C&condition=1131221&session=WEB-DEMO) |
+---------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
| ![](/analysis/utils/img/11311331.png) | **Triangular --- 0 degree**                                                                                                    |
|                                       |                                                                                                                                |
|                                       | Demo Stimulus: [Q1](https://limitless-plains-85018.herokuapp.com/?q=1&condition=1111221&session=WEB-DEMO)\                     |
|                                       | Full Study : condition [1131331](https://limitless-plains-85018.herokuapp.com/?study=SGC4C&condition=1131331&session=WEB-DEMO) |
+---------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+

: **SGC4C Study Conditions** {tbl-colwidths="\[40,60\]"}

```{r}
#| label: SETUP
#| warning: false
#| message : false

library(codebook) #data dictionary
library(tidyverse) #ALL THE THINGS
library(kableExtra) #tables

#set some output options
library(dplyr, warn.conflicts = FALSE)
options(dplyr.summarise.inform = FALSE)
options(scipen=1, digits=3)

```

```{r}
#| label: IMPORT-DATA
#| warning : false
#| message : false

# HACK WD FOR LOCAL RUNNING?
#imac = "/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN"
# mbp = "/Users/amyfox/Sites/RESEARCH/SGCâ€”Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN"
# setwd(mbp)

##PS... THIS cell loads the data file that is actually created by the harmonization at the bottom of the file. 
#Just put it at the top for quick readability. 
#IMPORT DATA 
df_subjects <- read_rds('analysis/SGC4C/data/1-study-level/sgc4c_participants.rds')
 
```

```{r}
#| label : INSPECT-DATA-COLLECTION

title = "Participants by Condition"
cols = c("Condition","n")
cont <- table(df_subjects$pretty_condition)
cont %>%  addmargins() %>% kbl(caption = title, col.names = cols) %>% kable_classic()
```

### Hypotheses

**Experimental Hypothesis:**\

## METHODS

### Design

We employed a mixed design with 2 between-subjects factors (Shape: ORTHOGONAL, TRIANGULAR), (ROTATION: 0degrees, 45 degrees, 90 degrees) and 15 items (within-subjects factor).

Dependent Variables:

-   Response Accuracy : Is the response triangular-correct?
-   Response Interpretation : (derived) With which interpretation of the graph is the subject's response on an individual question consistent?
-   Response Latency : Time from stimulus onset to clicking 'Submit' button: time in (s)

### Materials

Stimuli consisted of a series of 15 graph comprehension questions, each testing a different combination of time interval relations, to be read from a Triangular-Model graph. @fig-sample. The list of questions can be found [here](static/stimuli/sgcx_questions.csv).

![Sample Question (Q=1) for Graph Comprehension Task](/analysis/utils/img/sample_graphComprehensionTask.png){#fig-sample fig-alt="picture of multiple select question on the left, accompanied by a triangular model graph on the right" fig-align="center"}

In each experimental

### Procedure

Participants completed the study via a web-browser.

\(1\) Upon starting, they submitted informed consent, before reading task instructions.

\(2\) Participants were introduced to a scenario in which they were to play the role of a project manager, scheduling shifts for a group of employees. The schedule of the employees was presented in a Triangular Model (TM) graph, and they would be answering question about the schedule.

\(3\) Then participants completed an experimental block of 15 items: The Graph Comprehension Task.

\(4\) Following the experimental block, participants answered a free-response question about their strategy for reading the graph, followed by a demographic questionnaire and debrief.

### Sample

Data were collected by convenience sample of a university subject pool during the summer of 2022. Data for conditions 111 and 113 were joined from studies SGC3A online replication and SGC4D, along with rotation conditions collected specifically for SGC4C. Participants accessed the study via a web browser (asynchronously). The stimulus application required the participant stay in full-screen mode for the entirety of the study.

## ANALYSIS

### Data Preparation {#sec-SGC4C-harmonize}

Data were collected via a custom web application and stored in a NoSQL database. The following exclusion criteria were applied during data cleaning:

-   completion status : "success" ; subject must have finished all parts of the study, including demographic questionnaire
-   session ID: \[in list\] ; subject must have been assigned to valid data collection session (discard testing and piloting data)
-   browser interaction violations \< 3; subject must have fewer than 3 violations of non-allowed browser interactions (i.e. resizing window, leaving browser tab or leaving fullscreen mode)
-   self-rated effort \> 2; subjects who reported, "not trying hard/rushing through questions" or "started out trying hard but giving up at some point" were excluded from analysis.
-   attention check ==TRUE ; subjects who failed to answer a mid-study attention check question (Graph Comprehension Task Question #6) are excluded

|     |     |
|-----|-----|
|     |     |

The underlying data structure of the stimulus web application changed across the data collection period, resulting in slightly different data files (i.e. columns are not named consistently). In this section, we combine the files from each data collection period into a single *harmonized* data file for analysis (one for participants, one for items).

#### Participants

First we import participant-level data, selecting only the columns relevant for analysis. The result is a single data frame `df_subjects` containing one row for each subject (across all periods). Note that we *are not* discarding any *response* data. Rather, we discard columns that are automatically recorded by the stimulus web application and help the application run.

*Note that we discard some columns representing scores calculated in the stimulus engine. These scores were calculated differently across collection periods, and so we discard them and recalculate scores in the next analysis notebook. No raw data (responses and response times) are discarded, only algorithmically-derived scores for the responses.*

```{r}
#| label: IMPORT-SUBJECTS
#| message: false

#IMPORT PARTICIPANT DATA


#import rotation participants
df_rotated <- read_rds("analysis/SGC4D/data/0-session-level/sgc4c_participants.rds") #use RDS file as it contains metadata

#import control participants 111 from fall 21  (only online)
df_control <- read_rds("analysis/SGC3A/data/1-study-level/sgc3a_participants.rds") %>% 
  filter(condition==111) %>% filter(term == "fall21") %>% 
 dplyr::select(-pretty_mode) %>% droplevels() %>% mutate(
  study = "SGC3A"
)

#import triangular participants 113 (online online)
df_tri <- read_rds("analysis/SGC4A/data/1-study-level/sgc4a_participants.rds") %>% 
  filter(condition==113) %>% filter(term=="winter22") %>% 
  dplyr::select(-pretty_mode) %>% droplevels() %>% mutate(
  study = "SGC4D"
)

#reduce data collected using NEW webapp to useful columns
#drop absolute score because we rescore in 2_scoring
df_rotated <- df_rotated %>% 
  #select only columns we'll be analyzing, discard others
  dplyr::select( subject, condition, pretty_condition, study, term, mode, 
                 #demographics
                 gender, age, language, schoolyear, country,
                 #effort survey
                 effort, difficulty, confidence, enjoyment, 
                 #explanations
                 other,disability,
                 #response characteristics
                 totaltime_m,
                 #exploratory factors
                 violations, browser, width, height
                 )


effort_labels <- c("I tried my best on each question", "I tried my best on most questions")



# janitor::compare_df_cols(df_rotated, df_control)


df_subjects <- rbind(df_rotated, df_control, df_tri)

#set factors
df_subjects <- df_subjects %>% 
  #refactor factors
  mutate (
    subject = factor(subject),
    condition = factor(condition),
    term = factor(term),
    mode = factor(mode),
    gender = factor(gender),
    schoolyear = factor(schoolyear, levels=c("First","Second","Third","Fourth","Fifth","Other")),
    pretty_condition = recode_factor(pretty_condition,
                                     "control" = "ORTH-0",
                                     "Tri-Sparse" = "TRI-0",
                                     
                                     "ORTH-rotate-45" = "ORTH-45",
                                     "TRI-rotate-45" =  "TRI-45",
                                     "ORTH-rotate-90" = "ORTH-90",
                                     "TRI-rotate-90" = "TRI-90"),
    ROTATION = recode_factor(pretty_condition, 
                                     "ORTH-0" = "0",
                                     "TRI-0" = "0",
                                     "ORTH-45" = "45",
                                     "TRI-45" = "45",
                                     "ORTH-90" = "90",
                                     "TRI-90" = "90"),
    SHAPE = recode_factor(pretty_condition, 
                                   "ORTH-0" = "ORTH",
                                   "TRI-0" = "TRI",
                                   "ORTH-45" = "ORTH",
                                   "TRI-45" = "TRI",
                                   "ORTH-90" = "ORTH",
                                   "TRI-90" = "TRI"))


# table(df_subjects$condition)
rm(df_control, df_rotated, df_tri)
```



#### Items

Next we import item-level data from each data collection period, selecting only the columns relevant for analysis. The result is a single data frame `df_items` containing one row for each *graph comprehension task question* (qs=15) (across all periods). A second data frame `df_freeresponse` contains one row for each free response strategy question (last question posed to participants in Winter2022) Note that we *do not* discard any *response* data. Rather, we *do* discard several columns representing accuracy scores for responses that were calculated in the stimulus engine. These scores were calculated differently across collection periods, and so we discard them and recalculate scores in the next analysis notebook. Original response data are always preserved.

```{r}
#| label: IMPORT-ITEMS
#| message: false

#read datafiles
df_rotated <- read_rds("analysis/SGC4C/data/0-session-level/sgc4c_items.rds") #use RDS file as it contains metadata

#import control participants 111 from fall 21  (only online)
df_control <- read_rds("analysis/SGC3A/data/1-study-level/sgc3a_items.rds") %>% 
  filter(condition==111) %>% filter(term == "fall21") %>% 
 dplyr::select(-pretty_mode) %>% droplevels() %>% mutate(
  study = "SGC3A"
)

#import triangular participants 113 (online online)
df_tri <- read_rds("analysis/SGC4A/data/1-study-level/sgc4a_items.rds") %>% 
  filter(condition==113) %>% filter(term=="winter22") %>% 
  dplyr::select(-pretty_mode) %>% droplevels() %>% mutate(
  study = "SGC4D"
)

#reduce data collected using new webapp
df_rotated <- df_rotated %>% 
  select(subject, condition, pretty_condition, study, term, mode, q, question, answer, correct, rt_s) %>% #unfactor before combine
  mutate(
    subject = as.character(subject),
    condition = as.character(condition),
    term = as.character(term),
    mode = as.character(mode),
    q = as.integer(q),
    correct = as.logical(correct)
  ) %>% 
  mutate(
    response = str_remove_all(as.character(answer), ","),
    num_o = str_length(response)
  )%>% 
  # handle NA values (why are some empty responses blank and others NA?) 
  mutate(
    response = replace_na(response, ""),
    num_o = replace_na(num_o, 0)
  ) %>% dplyr::select(-answer)

#JOIN 
# janitor::compare_df_cols(df_rotated, df_control)
df_items <- rbind(df_rotated, df_control, df_tri)

#mutate condition names 
df_items <- df_items %>% mutate(
    subject = factor(subject),
    condition = factor(condition),
    term = factor(term),
    mode = factor(mode),
    pretty_condition = recode_factor(pretty_condition,
                                     "control" = "ORTH-0",
                                     "Tri-Sparse" = "TRI-0",
                                     "ORTH-rotate-45" = "ORTH-45",
                                     "TRI-rotate-45" =  "TRI-45",
                                     "ORTH-rotate-90" = "ORTH-90",
                                     "TRI-rotate-90" = "TRI-90"),
    ROTATION = recode_factor(pretty_condition, 
                                     "ORTH-0" = "0",
                                     "TRI-0" = "0",
                                     "ORTH-45" = "45",
                                     "TRI-45" = "45",
                                     "ORTH-90" = "90",
                                     "TRI-90" = "90"),
    SHAPE = recode_factor(pretty_condition, 
                                   "ORTH-0" = "ORTH",
                                   "TRI-0" = "TRI",
                                   "ORTH-45" = "ORTH",
                                   "TRI-45" = "TRI",
                                   "ORTH-90" = "ORTH",
                                   "TRI-90" = "TRI"
))

#cleanup
rm(df_control, df_rotated, df_tri)
```

#### Validation

Next, we validate that we have the complete number of item-level records based on the number of subject-level records

```{r}
#| label: RECONCILE

#confirm only have items for subjects in subjects
unique(df_items$subject %in% df_subjects$subject)

#the number of items should be equal to 15 x the number of subjects
nrow(df_items) == 15* nrow(df_subjects) #TRUE

#each subject should have 15 items
df_items %>% group_by(subject) %>% summarise(n = n()) %>% filter(n != 15) %>% nrow() == 0

```

#### Export

Finally, we export the (session-harmonized) data for analysis, as CSVs, and .RDS (includes metadata)

```{r}
#| label: EXPORT-FILES

#SAVE FILES
write.csv(df_subjects,"analysis/SGC4C/data/1-study-level/sgc4c_participants.csv", row.names = FALSE)
write.csv(df_items,"analysis/SGC4C/data/1-study-level/sgc4c_items.csv", row.names = FALSE)

#SAVE R Data Structures 
#export R DATA STRUCTURES (include codebook metadata)
rio::export(df_subjects, "analysis/SGC4C/data/1-study-level/sgc4c_participants.rds") # to R data structure file
rio::export(df_items, "analysis/SGC4C/data/1-study-level/sgc4c_items.rds") # to R data structure file

```

## RESOURCES

```{r}
#| label: SESSION

sessionInfo()
```
