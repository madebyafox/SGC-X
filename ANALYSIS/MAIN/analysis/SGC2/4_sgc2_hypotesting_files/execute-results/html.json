{
  "hash": "f822fca6f87c2f6f59e3cadb988a48eb",
  "result": {
    "markdown": "---\nsubtitle: 'Study SGC2 | Hypothesis Testing'\n---\n\n\n\\newpage\n\n# Hypothesis Testing {#sec-SGC2-hypotesting}\n\n\n## TODO\nQ3 looks nondiscriminant perhaps remove this from analysis\n\n\n*The purpose of this notebook is test the hypotheses that determined the design of the SGC2 study.*\n\n1.  **The Need for Scaffolding:** Learners without scaffolding (control) will perform better with the LM than TM\\\n2.  **The Effectiveness of Scaffolding:** Learners with (any form of) scaffolding will perform better with the TM than LM (replication of \\[12\\]).\\\n3.  **Graph-Order as Scaffolding:** Based on observations in Study One we expect that graph-order will act as a scaffold. Learners who solve problems with the LM graph first will perform better on the TM (relative to TM-first learners) as their attention will be drawn to the salient differences between the graphs.\\\n    <br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#UTILITIES\nlibrary(Hmisc) # %nin% operator\nlibrary(broom) #tidy model output\nlibrary(broom.mixed) #tidy mixed models\nlibrary(mosaic) #favstats\nlibrary(svglite) #saving plots as svg\nlibrary(distributional)\n\n#VISUALIZATION\n# library(ggpubr) #arrange plots\n# library(cowplot) #arrange shift function plots\nlibrary(ggformula) #easy graphs\n# # library(vcd) #mosaic plots\n# # library(vcdExtra) #mosaic plots\nlibrary(kableExtra) #printing tables\nlibrary(sjPlot) #visualize model coefficients\nlibrary(ggdist) #uncertainty viz\nlibrary(modelr) #needed for ggdist\nlibrary(gghalves) # plots. in half\nlibrary(ggbeeswarm) # violin plot stuffs\nlibrary(statsExpressions)\nlibrary(ggstatsplot) #plots with stats\nlibrary(modelsummary) #latex tables for models!\nlibrary(ggeasy) #shortcuts \n\n#MODELLING\n# library(rstatix) #helpful testing functions incl wilcoxon, etc\nlibrary(report) #easystats reporting\nlibrary(see) #easystats visualization\nlibrary(performance) #easystats model diagnostics\nlibrary(parameters) #easystats model summary and vis\n# library(qqplotr) #confint on qq plot\n# library(gmodels) #contingency table and CHISQR\n# library(equatiomatic) #extract model equation\n# library(pscl) #zeroinfl / hurdle models \nlibrary(lme4) #mixed effects models\nlibrary(lmerTest) #for CIs in glmer\nlibrary(merTools) #predictInterval\n# library(ggeffects) #visualization log regr models\n#MULTINOMIAL \nlibrary(nnet) #multinomial logistic regression [not mixed] #no p values\nlibrary(mclogit) #frequentist mixed multinomial logistic regression [mblogit] #gives p values\n#BAYESIAN\nlibrary(cmdstanr) #executing stan\nlibrary(brms) #bayesian mixed multinomials [+ other bayesian reg models]\nlibrary(bayestestR) \nlibrary(tidybayes)\nlibrary(posterior)\n\nlibrary(tidyverse) #ALL THE THINGS\n\n#OUTPUT OPTIONS\nlibrary(dplyr, warn.conflicts = FALSE)\noptions(dplyr.summarise.inform = FALSE)\noptions(ggplot2.summarise.inform = FALSE)\noptions(scipen=1, digits=3)\n\n#GRAPH THEMEING\n# theme_set(theme_minimal()) \n\n# Custom ggplot theme to make pretty plots\n# Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed\ntheme_clean <- function() {\n  theme_minimal(base_family = \"Barlow Semi Condensed\") +\n    theme(panel.grid.minor = element_blank(),\n          plot.title = element_text(family = \"BarlowSemiCondensed-Bold\"),\n          axis.title = element_text(family = \"BarlowSemiCondensed-Medium\"),\n          strip.text = element_text(family = \"BarlowSemiCondensed-Bold\",\n                                    size = rel(1), hjust = 0),\n          strip.background = element_rect(fill = \"grey80\", color = NA))\n}\n\nset_theme(base = theme_clean())\n```\n:::\n\n\n**Research Questions**\n\nIn SGC2 we compare learner performance on the linear and triangular model graphs by testing the effectiveness of 4 scaffolds and by seeking to replicate the Qiang et.al (2014) finding that after 20 minutes of video training, students perform faster and more accurately with the unconventional TM than the conventional Linear Model (LM). Will our participants show similar performance on the TM with scaffolds rather than formal instruction? Further, will engagement with the TM in a reading task be sufficient for students to reproduce the graph in a subsequent drawing task?\n\n**Hypotheses**\n\n1.  Learners without scaffolding (control) will perform better with the LM than TM\n2.  Learners with (any form of) scaffolding will perform better with the TM than LM (replication of \\[12\\]).\n3.  Based on observations in Study One we expect that graph-order will act as a scaffold. Learners who solve problems with the LM graph first will perform better on the TM (relative to TM-first learners) as their attention will be drawn to the salient differences between the graphs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# HACK WD FOR LOCAL RUNNING?\n# imac = \"/Users/amyraefox/Code/SGC-Scaffolding_Graph_Comprehension/SGC-X/ANALYSIS/MAIN\"\n# mbp = \"/Users/amyfox/Sites/RESEARCH/SGC—Scaffolding Graph Comprehension/SGC-X/ANALYSIS/MAIN\"\n# setwd(mbp)\n\n#IMPORT DATA \ndf_items <- read_rds('analysis/SGC2/data/2-scored-data/sgc2_items.rds') %>% dplyr::select(\n  subject,\n  pretty_condition,\n  order,\n  scenario,\n  graph,\n  rt_sec,\n  block,\n  q_order, \n  q,\n  score\n) %>% \n  mutate( subject = as.factor(subject),\n          accuracy = as.factor(score)) %>% \n  filter(block %nin% c(\"drawingTest\")) #discard drawing task questions (only two, not analyzing)\n\n\ndf_subjects <- read_rds('analysis/SGC2/data/2-scored-data/sgc2_participants.rds') %>% dplyr::select(\n  AGE, GENDER, \n  subject,\n  pretty_condition,\n  order, #order of graphs counterbalanced\n  lm_scenarios, #scenario for lm graph\n  tm_scenarios, #scenario for tm graph — counterbalanced with graphs\n  linear_score,\n  triangular_score,\n  score_diff, #triangular - linear \n  time_diff, #triangular time  - linear time\n  LM_T_M, #linear model time\n  TM_T_M, #traingular model time\n  DT_T_M, #drawing task time\n  draw_type,\n  ls_n, #linear scaffold phase score\n  lt_n, #linear test phase score\n  ts_n, #tri scaffold phase score\n  tt_n  #tri test phase score\n) %>%  mutate( subject = as.factor(subject)) \n```\n:::\n\n\n## SAMPLE\n\n### Data Collection\n\nData was collected in Spring 2017. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntitle = \"Participants by Condition and Data Collection Period\"\ncols = c(\"Control\",\"Text:What\", \"Text:How\", \"Img:Static\", \"Img:Ixv\")\ntable(df_subjects$pretty_condition) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n   control  text:what   text:how img:static    img:ixv \n        61         59         66         62         68 \n```\n:::\n:::\n\n\n### Participants\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Describe participants\nsubject.stats <-df_subjects %>% dplyr::select(AGE) %>% unlist() %>% favstats()\nsubject.stats$percent.male <- ((df_subjects %>% filter(GENDER==\"Male\") %>% count())/count(df_subjects))$n\nsubject.stats$percent.female <- ((df_subjects %>% filter(GENDER==\"Female\") %>% count())/count(df_subjects))$n\nsubject.stats$percent.other <- ((df_subjects %>% filter(GENDER %nin% c(\"Female\",\"Male\")) %>% count())/count(df_subjects))$n\n\n\ntitle = \"Descriptive Statistics of Participant Age and Gender\"\nsubject.stats %>% kbl (caption = title) %>% kable_classic()%>% \n  footnote(general = \"Age in Years\", \n           general_title = \"Note: \",footnote_as_chunk = T) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;'>\n<caption>Descriptive Statistics of Participant Age and Gender</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n   <th style=\"text-align:right;\"> percent.male </th>\n   <th style=\"text-align:right;\"> percent.female </th>\n   <th style=\"text-align:right;\"> percent.other </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 20.5 </td>\n   <td style=\"text-align:right;\"> 2.2 </td>\n   <td style=\"text-align:right;\"> 316 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.304 </td>\n   <td style=\"text-align:right;\"> 0.69 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> Age in Years</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n**Overall** 316 participants (30 % male, 69 % female, 1 % other)  undergraduate STEM majors at a public American University participated in exchange for course credit (age: 17 - 33 years).\n\n\n## H1 \\| The Need for Scaffolding (aka, Linear VS Triangular in CONTROL)\n\nDoes ACCURACY differ between _linear_ and _triangular_ graphs in the control condition?\n\n**Hypothesis** The TM graph is not *discoverable* and requires scaffolding for correct interpretation. We predict that learners without scaffolding (the control condition) will perform better with the LM than TM\n\n\n#### Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#FILTER THE DATASET\n#only control condition \ndf_s <- df_subjects %>% filter(pretty_condition == \"control\")\n\ndf_long <- df_s %>% dplyr::select(subject,pretty_condition,order,lm_scenarios,tm_scenarios,linear_score, triangular_score) %>% pivot_longer(\n  cols = ends_with(\"score\"),\n  names_to = \"graph\",\n  values_to = \"score\"\n)\n\ndf_i <- df_items %>% filter(pretty_condition == \"control\") %>% filter(q %nin% c(3))\n```\n:::\n\n \n#### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED PROPORTIONAL BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(order~graph) + \n   labs(title = \"Accuracy by Graph and Order\",\n       x = \"Condition\",\n       subtitle=\"Across graph orders, Accuracy is higher on the LINEAR than TRIANGULAR graph.\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-H1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED PROPORTIONAL BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(scenario ~ graph) + \n   labs(title = \"Accuracy by Graph and Scenario\",\n       x = \"Condition\",\n       subtitle=\"Accuracy is higher on the LINEAR than TRIANGULAR graph; much lower for TM = AXIS scenario.\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-H1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART BY QUESTION\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = score)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap( graph ~ q) +\n   labs(title = \"Accuracy by Question\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-H1-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: FACETED HISTOGRAM\ngf_props(~score,\n         fill = ~graph, data = df_long) %>%\n  gf_facet_grid(order ~ graph) +\n  labs(x = \"# Correct\",\n       y = \"proportion of subjects\",\n       title = \"Overall Absolute Score by Graph and Order\",\n       subtitle = \"\") + \n  theme(legend.position = \"blank\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-H1-4.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: FACETED HISTOGRAM\ngf_props(~score,\n         fill = ~graph, data = df_long) %>%\n  gf_facet_grid(tm_scenarios ~ graph) +\n  labs(x = \"# Correct\",\n       y = \"proportion of subjects\",\n       title = \"Overall Absolute Score by Graph and TM Scenario\",\n       subtitle = \"TM Scores are different by Scenario\") + \n  theme(legend.position = \"blank\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-H1-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# ##VERTICAL RAINCLOUD USING GGDISTR\n# ggplot(df_long, aes(x = graph, y = score,\n#                         fill = graph) ) + \n#   ggdist::stat_halfeye(\n#     side = \"left\",\n#     justification = 1.1,\n#     width = 1, \n#     point_colour = NA\n#    ) + \n#   geom_boxplot(\n#     inherit.aes = FALSE, #supress fill\n#     mapping = aes(x=graph, y = score),\n#     width = .15, \n#     outlier.shape = NA\n#   ) + \n#   geom_point(\n#     inherit.aes = FALSE, #supress fill\n#     mapping = aes(x=graph, y = score, color = graph),\n#     size = 1.3,\n#     alpha = .3,\n#     position = position_jitter( \n#       seed = 1, width = .05\n#   )) + labs( \n#     title = \"Distribution of scores in CONTROL condition\", \n#     x = \"Condition\", y = \"Score (# correct)\") +\n#   theme(legend.position = \"blank\") + \n#   coord_cartesian(xlim = c(0.5, NA), clip = \"off\")\n\n\n#DISTRIBUTION OF SCORE\ngf_dhistogram(~score_diff, data = df_s) %>% \n  gf_facet_grid(tm_scenarios ~ order) +\n  xlim(-13,5) + \n  labs(title = \"Distribution of paired score differences in CONTROL condition\") + \n  easy_remove_legend() \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 8 rows containing missing values (geom_bar).\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-H1-6.png){width=672}\n:::\n:::\n\n\n_Visualizations indicate it is likely that scores in he LM are infact higher than the TM in the control condition._\n\n#### Describe \n\n::: {.cell}\n\n```{.r .cell-code}\ntitle = \"Descriptive Statistics of Response Accuracy by Block (CONTROL Condition)\"\nabs.stats <- rbind(\n  \"linear.block\"= df_s %>% dplyr::select(linear_score) %>% unlist() %>% favstats(),\n  \"triangular.block\" = df_s %>% dplyr::select(triangular_score) %>% unlist() %>% favstats(),\n  \"block.differences\" = df_s %>% dplyr::select(score_diff) %>% unlist() %>% favstats()\n)\n\nabs.stats %>% kbl (caption = title) %>% kable_classic() %>%\n  footnote(general = \"block # questions correct [0,15]; DIFF = triangular - linear\",\n           general_title = \"Note: \",footnote_as_chunk = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;'>\n<caption>Descriptive Statistics of Response Accuracy by Block (CONTROL Condition)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> linear.block </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 10.98 </td>\n   <td style=\"text-align:right;\"> 2.33 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> triangular.block </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 6.90 </td>\n   <td style=\"text-align:right;\"> 4.51 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> block.differences </td>\n   <td style=\"text-align:right;\"> -13 </td>\n   <td style=\"text-align:right;\"> -8 </td>\n   <td style=\"text-align:right;\"> -4 </td>\n   <td style=\"text-align:right;\"> -1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> -4.08 </td>\n   <td style=\"text-align:right;\"> 4.51 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> block # questions correct [0,15]; DIFF = triangular - linear</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\nFor participants in the CONTROL condition, total absolute scores for the LINEAR graph (n = 61) range from 2 to 15 with a mean score of (M = 10.98, SD = 2.33).\n\nFor participants in the CONTROL condition, total absolute scores for the TRIANGULAR graph (n = 61) range from 0 to 14 with a mean score of (M = 6.9, SD = 4.51).\n\nVisual inspection of the distribution of scores for each block reveal that scores in on the triangular task were more variant than those in the linear graph. On average, scores on the triangular block were lower than those on the linear block.\n\n#### Test\n\n-   WILCOXON RANK SUM (Mann-Whitney Test)  **Non parametric alternative** to t-test; compares median rather than mean by ranking data\n-   Does not assume normality\n-   Does not assume equal variance of samples (homogeneity of variance)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#WILCOXON RANK SUM PAIRED T-TEST\nw <- wilcox.test(df_s$linear_score, df_s$triangular_score, \n            paired = TRUE, alternative = \"greater\", conf.int = TRUE)\nw\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  df_s$linear_score and df_s$triangular_score\nV = 1490, p-value = 7e-08\nalternative hypothesis: true location shift is greater than 0\n95 percent confidence interval:\n 3.5 Inf\nsample estimates:\n(pseudo)median \n           4.5 \n```\n:::\n\n```{.r .cell-code}\nreport(w)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in ranktransform.numeric(x, verbose = verbose, ...): Zeros detected.\nThese cannot be sign-rank transformed.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\nThe Wilcoxon signed rank test with continuity correction testing the difference\nin ranks between df_s$linear_score and df_s$triangular_score suggests that the\neffect is positive, statistically significant, and very large (W = 1490.00, p <\n.001; r (rank biserial) = 0.80, 95% CI [0.70, 1.00])\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#PLOT PAIRED DATA\ngrouped_ggwithinstats(\n  grouping.var = order,\n  data = df_long,\n  x    = graph,\n  y    = score, \n  annotation.args = list(title = \"Linear is better than Triangular regardless of Order\"),\n  type  = \"nonparametric\" #parametric, robust, bayes\n) \n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#PLOT PAIRED DATA\ngrouped_ggwithinstats(\n  grouping.var = tm_scenarios,\n  data = df_long,\n  x    = graph,\n  y    = score, \n  type  = \"nonparametric\", #parametric, robust, bayes\n  annotation.args = list(title = \"Linear is better than Triangular regardless of [triangle model] Scenario\"),\n)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n:::\n\n\n\nThe Wilcoxon signed rank test confirms that (for subjects in the control condition) scores on the **triangle graph** were significantly lower than those in the **linear graph** block. This provides evidence in support of our hypothesis that the Triangular model graph (though computationally efficient) is in fact unconventional and lacking in discoverablility. It needs to be augmented with scaffolding in order to be correctly interpreted by novice readers.\n\n#### MIXED EFFECTS LOGISTIC REGRESSION\n\n_Fit mixed effects logistic regression model to test effect of GRAPH, ORDER, and SCENARIO on probability of correct response [just in the control condition]_\n\n\n##### Fit Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 0 | SETUP\n#confirm 13 items [all discriminating items]\nnrow(df_i) / nrow(df_s) == 28 #removed nondiscrim Q3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n#confirm all factors \nis.factor(df_i$q) && is.factor(df_i$subject) && is.factor(df_i$graph) && is.factor(df_i$score) && is.factor(df_i$order) && is.factor(df_i$scenario)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n## 1 | SETUP RANDOM INTERCEPT SUBJECT\n\n#:: EMPTY MODEL (baseline, no random effect)\nprint(\"Empty fixed model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Empty fixed model\"\n```\n:::\n\n```{.r .cell-code}\nm0 = glm(accuracy ~ 1, family = \"binomial\", data = df_i) \n# summary(m0)\n\n#:: RANDOM INTERCEPT SUBJECT\nprint(\"Subject intercept random model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Subject intercept random model\"\n```\n:::\n\n```{.r .cell-code}\nmm.rS <- glmer(accuracy ~ (1|subject), data = df_i, family = \"binomial\")\n# summary(mm.rS)\n\n# :: TEST random effect\npaste(\"AIC decreases w/ new model?\", m0$aic > AIC(logLik(mm.rS)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model? TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(m0,mm.rS) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName  |    Model | df | df_diff |   Chi2 |      p\n-------------------------------------------------\nm0    |      glm |  1 |         |        |       \nmm.rS | glmerMod |  2 |       1 | 118.61 | < .001\n```\n:::\n\n```{.r .cell-code}\n#:: RANDOM INTERCEPT SUBJECT + ITEM\nprint(\"Subject Intercept + Item intercept random model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Subject Intercept + Item intercept random model\"\n```\n:::\n\n```{.r .cell-code}\nmm.rSQ <- glmer(accuracy ~ (1|subject) + (1|q), data = df_i, family = \"binomial\")\n#summary(mm.rSQ)\n\n# :: TEST random effect\npaste(\"AIC decreases w/ new model?\", AIC(logLik(mm.rS)) > AIC(logLik(mm.rSQ)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model? TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.rS, mm.rSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSome of the nested models seem to be identical and probably only vary in\n  their random effects.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName   |    Model | df | df_diff | Chi2 |     p\n-----------------------------------------------\nmm.rS  | glmerMod |  2 |         |      |      \nmm.rSQ | glmerMod |  3 |       1 | 2.69 | 0.101\n```\n:::\n\n```{.r .cell-code}\n## 2 | ADD FIXED EFFECT GRAPH\n\nprint(\"FIXED Condition + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"FIXED Condition + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.GrSQ <- glmer(accuracy ~ graph + (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\")\n# car::Anova(mm.GrSQ) #main effect graph\n\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.rSQ)) > AIC(logLik(mm.GrSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.rSQ,mm.GrSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName    |    Model | df | df_diff |   Chi2 |      p\n---------------------------------------------------\nmm.rSQ  | glmerMod |  3 |         |        |       \nmm.GrSQ | glmerMod |  4 |       1 | 178.38 | < .001\n```\n:::\n\n```{.r .cell-code}\n# NOT RELEVANT TO HYPOTHESIS \n# \n# ## 2 | ADD IXN GRAPH & ORDER EFFECT GRAPH ++ ORDER\n# \n# print(\"FIXED Graph + ORDER + Subject & Item random intercepts\")\n# mm.GOrSQ <- glmer(accuracy ~ graph * order + (1|subject) + (1|q) ,\n#                 data = df_i, family = \"binomial\")\n# # summary(mm.GOrSQ)\n# # car::Anova(mm.GOrSQ)\n# \n# paste(\"AIC decreases w/ new model\", AIC(logLik(mm.GrSQ)) > AIC(logLik(mm.GOrSQ)) )\n# test_lrt(mm.GrSQ,mm.GOrSQ) #same as anova(m0, m1, test = \"Chi\")\n# \n# \n# ## 2 | ADD FIXED EFFECT GRAPH + ORDER+ SCENARIO\n# \n# print(\"FIXED Graph * SCENARIO * ORDER + Subject & Item random intercepts\")\n# mm.GSOrSQ <- glmer(accuracy ~ graph*scenario*order + (1|subject) + (1|q) ,\n#                 data = df_i, family = \"binomial\",\n#                 control=glmerControl(optimizer=\"bobyqa\",\n#                                  optCtrl=list(maxfun=2e5)))\n# # summary(mm.GSOrSQ)\n# #car::Anova(mm.GSOrSQ)\n# \n# paste(\"AIC decreases w/ new model\", AIC(logLik(mm.GOrSQ)) > AIC(logLik(mm.GSOrSQ)) )\n# test_lrt(mm.GOrSQ,mm.GSOrSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n:::\n\n\n**TODO DESCRIBE FITTING**\n\n##### Describe\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# best model\nm <- mm.GrSQ\n\n#::::::::: PRINT MODEL \n\nprint(\"PREDICTOR MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PREDICTOR MODEL\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: accuracy ~ graph + (1 | subject) + (1 | q)\n   Data: df_i\n\n     AIC      BIC   logLik deviance df.resid \n    2033     2055    -1013     2025     1704 \n\nScaled residuals: \n   Min     1Q Median     3Q    Max \n-3.523 -0.718  0.365  0.736  2.611 \n\nRandom effects:\n Groups  Name        Variance Std.Dev.\n subject (Intercept) 0.7934   0.891   \n q       (Intercept) 0.0439   0.209   \nNumber of obs: 1708, groups:  subject, 61; q, 14\n\nFixed effects:\n                Estimate Std. Error z value Pr(>|z|)    \n(Intercept)        1.150      0.153    7.51  5.9e-14 ***\ngraphtriangular   -1.468      0.115  -12.76  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr)\ngraphtrnglr -0.421\n```\n:::\n\n```{.r .cell-code}\nprint(\"SIGNIFICANCE TEST [non directional]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"SIGNIFICANCE TEST [non directional]\"\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m, type=2) #TYPE 3 SS FOR IXNS\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: accuracy\n      Chisq Df Pr(>Chisq)    \ngraph   163  1     <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#:::::::: MANUAL ONE-SIDED SIGTEST \n#note: anova and chi square are always one-tailed, but that is independent of being one-sided\n#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half\n\n# one-sided (right tail) z test for B COEFFICIENT\n#SANITY CHECK 2-tailed test should match the model output\n#NOTE ... NEED TO DO THIS FOR _EACH_ COEFFICIENT\n# tt <- 2*pnorm(summary(m)$coefficients[2,3], lower.tail = F)\n# paste(\"p value for two-tailed test, null B = 0 : \",round(tt,5))\n# ot <- pnorm(summary(m)$coefficients[2,3], lower.tail = F)\n# paste(\"BUT we want a one  directional, null: B <= 0: \",round(ot,5))\n\n#:::::::: INTERPRET COEFFICIENTS\n# \n# se <- sqrt(diag(stats::vcov(m)))\n# # table of estimates with 95% CI\n# paste(\"LOG ODDS\")\n# (tab <- cbind(Est = fixef(m), LL = fixef(m) - 1.96 * se, UL = fixef(m) + 1.96 *\n#     se))\n# paste(\"ODDS RATIOS\")\n# (e <- exp(tab))\n\n#:::::::: INTERPRET COEFFICIENTS\n\npaste(\"LOG ODDS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"LOG ODDS\"\n```\n:::\n\n```{.r .cell-code}\n# se <- sqrt(diag(stats::vcov(m)))\n# (tab <- cbind(Est = fixef(m),\n#               LL = fixef(m) - 1.96 * se,\n#               UL = fixef(m) + 1.96 * se))\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 9\n  effect   group term  estimate std.error statistic   p.value conf.low conf.high\n  <chr>    <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 fixed    <NA>  (Int…    1.15      0.153      7.51  5.90e-14    0.850      1.45\n2 fixed    <NA>  grap…   -1.47      0.115    -12.8   2.89e-37   -1.69      -1.24\n3 ran_pars subj… sd__…    0.891    NA         NA    NA          NA         NA   \n4 ran_pars q     sd__…    0.209    NA         NA    NA          NA         NA   \n```\n:::\n\n```{.r .cell-code}\npaste(\"ODDS RATIOS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ODDS RATIOS\"\n```\n:::\n\n```{.r .cell-code}\n# (e <- exp(tab))\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\", exponentiate = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 9\n  effect   group term  estimate std.error statistic   p.value conf.low conf.high\n  <chr>    <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 fixed    <NA>  (Int…    3.16     0.484       7.51  5.90e-14    2.34      4.26 \n2 fixed    <NA>  grap…    0.230    0.0265    -12.8   2.89e-37    0.184     0.289\n3 ran_pars subj… sd__…    0.891   NA          NA    NA          NA        NA    \n4 ran_pars q     sd__…    0.209   NA          NA    NA          NA        NA    \n```\n:::\n\n```{.r .cell-code}\npaste(\"PROBABILITIES\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PROBABILITIES\"\n```\n:::\n\n```{.r .cell-code}\n#probability control = plogis(intercept)\n#probability impasse = plogis(intercept + coefficient)\n\n#FROM predict()\n# newdata <- df_i %>% dplyr::select(pretty_condition, subject, q)\n# preds <- predict(m, newdata = newdata, type = \"response\")\n# preds <- cbind(newdata, preds)\n# p <- preds %>% \n#   dplyr::select(pretty_condition, preds) %>% \n#   group_by(pretty_condition) %>% \n#   summarise(\n#     median = median(preds),\n#     se = sd(preds)/sqrt(n()),\n#     lwr = median - 1.96*se,\n#     upr = median + 1.96*se)\n    \n  \n#FROM merTools\n#setup df \nnewdata <- df_i %>% dplyr::select(graph, order, scenario, subject, q)\n#make predictions\npreds <- predictInterval(m, newdata = newdata,\n                              which = \"fixed\", #full, fixed or random for those only\n                              type = \"probability\", #linear.prediction\n                              stat = \"median\",\n                              n.sims = 1000,\n                              level = 0.80) #width of prediction interval\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in predictInterval(m, newdata = newdata, which = \"fixed\", type = \"probability\", : newdata is tbl_df or tbl object from dplyr package and has been\n              coerced to a data.frame\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: executing %dopar% sequentially: no parallel backend registered\n```\n:::\n\n```{.r .cell-code}\n#join predictions to the new dataframe\npreds <- cbind(newdata, preds)\n#summarize\n(summ_preds <- preds %>% \n  dplyr::select(graph, scenario, order, fit, lwr, upr) %>% \n  group_by(graph, scenario, order) %>% \n  dplyr::summarise(\n    median = median(fit),\n    lower = median(lwr),\n    upper = median(upr)\n  )) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 6\n# Groups:   graph, scenario [4]\n  graph      scenario order    median lower upper\n  <fct>      <fct>    <fct>     <dbl> <dbl> <dbl>\n1 linear     axis     LM-First  0.759 0.464 0.920\n2 linear     axis     TM-First  0.759 0.462 0.920\n3 linear     longmire LM-First  0.759 0.465 0.920\n4 linear     longmire TM-First  0.760 0.463 0.920\n5 triangular axis     LM-First  0.420 0.166 0.727\n6 triangular axis     TM-First  0.420 0.165 0.725\n7 triangular longmire LM-First  0.422 0.167 0.726\n8 triangular longmire TM-First  0.420 0.167 0.726\n```\n:::\n:::\n\n\n##### Inference TODO UPDATE\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">accuracy</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.16</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.34&nbsp;&ndash;&nbsp;4.26</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.23</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.18&nbsp;&ndash;&nbsp;0.29</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">3.29</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.79</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.04</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.20</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">61</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">14</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">1708</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.116 / 0.295</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m1, \"(log odds)\" = m1)\n# notes = list(\"* p < 0.05, ** p < 0.01, *** p < 0.001\",\n#              '$sigma^{2}$ = 3.29\" N(subject) = 126 $\\tau_{00}$(subject) = 22.22 N(question) = 13 $\\tau_{00}$(question) = 0.31'\n#                )\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', \n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex\")\n# #              # coef_omit = \"Intercept\",\n# \n# \n# \n```\n:::\n\n\n##### Visualize\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\nplot_model(m, vline.color = \"red\", \n           show.intercept = TRUE, \n           show.values = TRUE,\n           p.threshold = 0.1, #manually adjust to account for directional test\n           ci.lvl = 0.90 ) + #manually adjusted for directional test   \n  labs(title = \"Model Estimate | Odds Ratio\",\n       subtitle = \"\",\n       x = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/MODEL-VIS-CACC-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#EASYSTATS | MODEL | ODDS RATIO\n# result <- model_parameters(m, exponentiate = TRUE, component = \"all\")\n# plot(result)\n\n\n## | PLOT TESTS\n\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/MODEL-VIS-CACC-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#ONLY FOR BAYESIAN VERSION\n# result <- rope(m)\n# plot(result)\n# \n# result <- pd(m)\n# plot(result)\n\n\n## | PLOT PREDICTIONS\n\n#SJPLOT | MODEL | PROBABILITIES\n# plot_model(m, type=\"int\",\n#            show.intercept = TRUE,\n#            show.values = TRUE,\n#            title = \"Model Prediction | Probability of Accurate Response\",\n#            axis.title = c(\"Condition\",\"Probability of Accurate Response\"))\n\n#PLOT MODEL PREDICTION\nplot_model(m, type = \"pred\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$graph\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/MODEL-VIS-CACC-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_model(m, type = \"eff\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$graph\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/MODEL-VIS-CACC-4.png){width=672}\n:::\n\n```{.r .cell-code}\n  # ylim(0,1) + \n  # labs(\n  #   title = \"Model Prediction | Probability of Accurate Response\",\n  #   subtitle = \"Impasse increases Probability of Correct Response\"\n  # )\n\n#TODO EMMEANS for the estimated marginal means OR USE IXN PLOT\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">accuracy</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.16</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.34&nbsp;&ndash;&nbsp;4.26</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.23</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.18&nbsp;&ndash;&nbsp;0.29</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">3.29</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.79</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.04</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.20</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">61</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">14</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">1708</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.116 / 0.295</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m, \"(log odds)\" = m)\n# notes = list('\"* p < 0.05, ** p < 0.01, *** p < 0.001\"',\n#                'N(subject) = 133 $\\tau_{00}$(subject) = 34.85',\n#              'N(question) = 13 $\\tau_{00}$(question) = 1.14')\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',\n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_online.tex\")\n# # #              # coef_omit = \"Intercept\",\n```\n:::\n\n\n##### Diagnostics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# print(\"SANITY CHECK REPORTING\")\n# report(m)\n\n# print(\"MODEL PERFORMANCE\")\n# performance(m)\n\nprint(\"DIAGNOSTICS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"DIAGNOSTICS\"\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/MODEL-DIAG-ACC-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## H2 \\| Computational Efficiency\n\n**Hypothesis** Qiang et. al found that the TM graph was more computationally efficient than the LM graph. We expect that for learners that *do* correctly interpret the graph, they will have lower response times for the TM vs. LM graph.\n\n\n### H2 \\| Realizing Computational Efficiency -- SCORE DIFFERENCE\n\n#### Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#FILTER THE DATASET\n#only control condition \ndf_s <- df_subjects %>% dplyr::select(score_diff, time_diff, subject, order, tm_scenarios, pretty_condition)\n\ndf_i <- df_items %>% filter(q %nin% c(3))\n```\n:::\n\n \n#### Visualize\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box plots\n# ++++++++++++++++++++\n# Plot weight by group and color by group\nlibrary(\"ggpubr\")\nggboxplot(df_s, x = \"pretty_condition\", y = \"score_diff\", \n          color = \"pretty_condition\", \n          # palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n          # order = c(\"ctrl\", \"trt1\", \"trt2\"),\n          title = \"DIFFERENCE IN GRAPH scores by Condition\",\n          ylab = \"TRI - LINEAR Score [-15,15]\", xlab = \"Condition\") +\n  geom_hline(yintercept = 0, color = \"black\") + \n  geom_jitter( aes(color = pretty_condition), width = 0.15, alpha = 0.5) +\n  ylim(-15,15) + \n  # facet_wrap(order~ tm_scenarios) +\n  easy_remove_legend() + theme_clean()\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### H2 \\| Realizing Computational Efficiency —— TIME EFFICIENCY \n\n#### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\nggboxplot(df_s, x = \"pretty_condition\", y = \"time_diff\", \n          color = \"pretty_condition\", \n          # palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n          # order = c(\"ctrl\", \"trt1\", \"trt2\"),\n          title = \"DIFFERENCE IN TIME by Condition\",\n          ylab = \"TRI - LINEAR TIME (seconds)\", xlab = \"Condition\") +\n  geom_hline(yintercept = 0, color = \"black\") + \n  geom_jitter( aes(color = pretty_condition), width = 0.15, alpha = 0.5) +\n  # facet_wrap(order~ tm_scenarios) +\n  easy_remove_legend() + theme_clean()\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n#### Model Response time for CORRECT answers \n\n**Is the TRIANGULAR graph FASTER for correct answers? (i.e. computational efficiency)**\n\n::: {.cell}\n\n```{.r .cell-code}\n#GET ONLY CORRECT ITEMS in TEST phase \ndf <- df_items %>% filter(q %nin% c(1,2,3,4,5)) %>% filter(score == 1)\n\ntable (df$pretty_condition)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n   control  text:what   text:how img:static    img:ixv \n       677        754        827        777        934 \n```\n:::\n\n```{.r .cell-code}\n# Box plots\n# ++++++++++++++++++++\nggplot( data = df, aes( x = pretty_condition, y = rt_sec, color = graph )) + \n  geom_boxplot(position = position_dodge()) \n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  # geom_point( alpha = 0.2, position = position_dodge(width = 2))\n\n\n## Does GRAPH predict rt_sec for correct items?\nm <- lmer( log(rt_sec) ~ graph + (1|q), data = df)\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: log(rt_sec) ~ graph + (1 | q)\n   Data: df\n\nREML criterion at convergence: 6398\n\nScaled residuals: \n   Min     1Q Median     3Q    Max \n-2.995 -0.716  0.030  0.670  4.072 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n q        (Intercept) 0.000729 0.027   \n Residual             0.292173 0.541   \nNumber of obs: 3969, groups:  q, 10\n\nFixed effects:\n                Estimate Std. Error       df t value Pr(>|t|)    \n(Intercept)     3.43e+00   1.45e-02 1.82e+01  237.00   <2e-16 ***\ngraphtriangular 6.45e-03   1.72e-02 3.96e+03    0.37     0.71    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr)\ngraphtrnglr -0.548\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: log(rt_sec)\n      Chisq Df Pr(>Chisq)\ngraph  0.14  1       0.71\n```\n:::\n\n```{.r .cell-code}\nplot_model(m, type = \"pred\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nModel has log-transformed response. Back-transforming predictions to original response scale. Standard errors are still on the log-scale.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n$graph\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-19-2.png){width=672}\n:::\n:::\n\nA mixed log-linear model predicting response time by GRAPH for only CORRECT items in the test phase (i.e. without scaffolding text or images) indicates that there is not a significant difference between response times for linear and orthogonal graphs. \n\n\n#### Model Response time for by ACCURACY on TRIANGLE graph (Test Phase)\n\n**Are _correct_ answers FASTER than _incorrect_ answers for the TRIANGULAR graph? (i.e. computational inefficiency of mental projection/transformation)**\n\n::: {.cell}\n\n```{.r .cell-code}\n#GET ONLY CORRECT ITEMS in TEST phase \ndf <- df_items %>% filter(q %nin% c(1,2,3,4,5)) %>% filter(graph==\"triangular\")\n\ntable (df$pretty_condition)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n   control  text:what   text:how img:static    img:ixv \n       610        590        660        619        680 \n```\n:::\n\n```{.r .cell-code}\n# ++++++++++++++++++++\nggplot( data = df, aes( x = pretty_condition, y = rt_sec, color = score )) + \n  geom_boxplot(position = position_dodge()) \n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  # geom_point( alpha = 0.2, position = position_dodge(width = 2))\n\n\ngf_histogram(~log(rt_sec), data = df) %>% \n  gf_facet_grid(score ~ .)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n\n```{.r .cell-code}\n## Does ACCURACY predict rt_sec for correct items?\nm <- lmer( log(rt_sec) ~ accuracy + (1|q), data = df)\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: log(rt_sec) ~ accuracy + (1 | q)\n   Data: df\n\nREML criterion at convergence: 5920\n\nScaled residuals: \n   Min     1Q Median     3Q    Max \n-4.929 -0.656  0.028  0.683  3.680 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n q        (Intercept) 0.00515  0.0718  \n Residual             0.37835  0.6151  \nNumber of obs: 3159, groups:  q, 10\n\nFixed effects:\n             Estimate Std. Error        df t value Pr(>|t|)    \n(Intercept)    3.7155     0.0283   14.2947   131.3   <2e-16 ***\naccuracy1     -0.2773     0.0222 3149.8835   -12.5   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n          (Intr)\naccuracy1 -0.455\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: log(rt_sec)\n         Chisq Df Pr(>Chisq)    \naccuracy   156  1     <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nplot_model(m, type = \"pred\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nModel has log-transformed response. Back-transforming predictions to original response scale. Standard errors are still on the log-scale.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n$accuracy\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-20-3.png){width=672}\n:::\n:::\n\nA mixed log-linear model predicting response time by GRAPH for only CORRECT items in the test phase (i.e. without scaffolding text or images) indicates that there is not a significant difference between response times for linear and orthogonal graphs. \n\n\n\n\n\n## H3 \\| The Effectiveness of Scaffolding \n\n**Hypothesis** All of the designs offered by participants in Study 1 are promising. We expect that only a small amount of scaffolding (a little nudge) will be required to help readers correctly interpret the graph. We predict that learners with (any form of) scaffolding will perform better with the TM than readers in the CONTROL condition.\n\n#### Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#FILTER THE DATASET\n#only control condition \ndf_s <- df_subjects \n\ndf_long <- df_s %>% dplyr::select(subject,pretty_condition,order,lm_scenarios,tm_scenarios,linear_score, triangular_score) %>% pivot_longer(\n  cols = ends_with(\"score\"),\n  names_to = \"graph\",\n  values_to = \"score\"\n)\n\ndf_i <- df_items %>% filter(q %nin% c(3))\n```\n:::\n\n \n#### Visualize\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## HISTOGRAM\ngf_histogram( ~ triangular_score, fill = ~pretty_condition, binwidth = 1, data = df_s) %>%\n  gf_facet_grid(pretty_condition ~ .)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n\n```{.r .cell-code}\n## MEDIANS\nggbetweenstats( y = triangular_score, x = pretty_condition, data = df_s, \n                type = \"nonparametric\",   var.equal = FALSE,\n                pairwise.comparisons = TRUE,\n                pairwise.display = \"significant\",\n                p.adjust.method = \"none\"\n)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-22-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box plots\n# ++++++++++++++++++++\n# Plot weight by group and color by group\nlibrary(\"ggpubr\")\nggboxplot(df_s, x = \"pretty_condition\", y = \"linear_score\", \n          color = \"pretty_condition\", \n          # palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n          # order = c(\"ctrl\", \"trt1\", \"trt2\"),\n          title = \"LINEAR Graph Scores by Condition\",\n          subtitle = \"No effect of condition, order or scenario\",\n          ylab = \"Linear Score [0,15]\", xlab = \"Condition\") +\n  geom_jitter( aes(color = pretty_condition), width = 0.15, alpha = 0.5) +\n  facet_wrap(order~ tm_scenarios)+\n  easy_remove_legend() + theme_clean()\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box plots\n# ++++++++++++++++++++\n# Plot weight by group and color by group\nlibrary(\"ggpubr\")\nggboxplot(df_s, x = \"pretty_condition\", y = \"triangular_score\", \n          color = \"pretty_condition\", \n          # palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n          # order = c(\"ctrl\", \"trt1\", \"trt2\"),\n          title = \"TRIANGULE Graph Scores by Condition\",\n          subtitle = \"Clear effect of condition, possible ixn scenario\",\n          ylab = \"Triangular Score [0,15]\", xlab = \"Condition\") +\n  geom_jitter( aes(color = pretty_condition), width = 0.15, alpha = 0.5) +\n  facet_wrap(order~ tm_scenarios)+\n  easy_remove_legend() + theme_clean()\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED PROPORTIONAL BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(order~graph) + \n   labs(title = \"Accuracy by Graph and Order\",\n       x = \"Condition\",\n       subtitle=\"Across graph orders, Accuracy is higher on the LINEAR than TRIANGULAR graph.\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-acc-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED PROPORTIONAL BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(scenario ~ graph) + \n   labs(title = \"Accuracy by Graph and Scenario\",\n       x = \"Condition\",\n       subtitle=\"Accuracy is higher on the LINEAR than TRIANGULAR graph; much lower for TM = AXIS scenario.\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-acc-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# ##VERTICAL RAINCLOUD USING GGDISTR\n# ggplot(df_long, aes(x = graph, y = score,\n#                         fill = graph) ) + \n#   ggdist::stat_halfeye(\n#     side = \"left\",\n#     justification = 1.1,\n#     width = 1, \n#     point_colour = NA\n#    ) + \n#   geom_boxplot(\n#     inherit.aes = FALSE, #supress fill\n#     mapping = aes(x=graph, y = score),\n#     width = .15, \n#     outlier.shape = NA\n#   ) + \n#   geom_point(\n#     inherit.aes = FALSE, #supress fill\n#     mapping = aes(x=graph, y = score, color = graph),\n#     size = 1.3,\n#     alpha = .3,\n#     position = position_jitter( \n#       seed = 1, width = .05\n#   )) + labs( \n#     title = \"Distribution of scores in CONTROL condition\", \n#     x = \"Condition\", y = \"Score (# correct)\") +\n#   theme(legend.position = \"blank\") + \n#   coord_cartesian(xlim = c(0.5, NA), clip = \"off\")\n\n\n#DISTRIBUTION OF SCORE DIFFERENCE\ngf_dhistogram(~score_diff, fill = ~pretty_condition, data = df_s) %>% \n  gf_facet_grid(pretty_condition ~ order) +\n  xlim(-13,5) + \n  labs(title = \"Distribution of paired score differences by CONDITION and ORDER\") + \n  easy_remove_legend() \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 20 rows containing missing values (geom_bar).\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-acc-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#DISTRIBUTION OF SCORE DIFFERENCE\ngf_dhistogram(~score_diff, fill = ~pretty_condition, data = df_s) %>% \n  gf_facet_grid(pretty_condition ~ tm_scenarios) +\n  xlim(-13,5) + \n  labs(title = \"Distribution of paired score differences by CONDITION and TM SCENARIO\") + \n  easy_remove_legend() \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 20 rows containing missing values (geom_bar).\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-acc-4.png){width=672}\n:::\n:::\n\n\n\n#### Describe \n\n::: {.cell}\n\n```{.r .cell-code}\ntitle = \"Descriptive Statistics of Response Accuracy by Block (CONTROL Condition)\"\nabs.stats <- rbind(\n  \"linear.block\"= df_s %>% dplyr::select(linear_score) %>% unlist() %>% favstats(),\n  \"triangular.block\" = df_s %>% dplyr::select(triangular_score) %>% unlist() %>% favstats(),\n  \"block.differences\" = df_s %>% dplyr::select(score_diff) %>% unlist() %>% favstats()\n)\n\nabs.stats %>% kbl (caption = title) %>% kable_classic() %>%\n  footnote(general = \"block # questions correct [0,15]; DIFF = triangular - linear\",\n           general_title = \"Note: \",footnote_as_chunk = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;'>\n<caption>Descriptive Statistics of Response Accuracy by Block (CONTROL Condition)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> linear.block </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 10.95 </td>\n   <td style=\"text-align:right;\"> 2.13 </td>\n   <td style=\"text-align:right;\"> 316 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> triangular.block </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 8.77 </td>\n   <td style=\"text-align:right;\"> 4.45 </td>\n   <td style=\"text-align:right;\"> 316 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> block.differences </td>\n   <td style=\"text-align:right;\"> -13 </td>\n   <td style=\"text-align:right;\"> -5 </td>\n   <td style=\"text-align:right;\"> -1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> -2.18 </td>\n   <td style=\"text-align:right;\"> 4.11 </td>\n   <td style=\"text-align:right;\"> 316 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> block # questions correct [0,15]; DIFF = triangular - linear</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\nFor participants in the CONTROL condition, total absolute scores for the LINEAR graph (n = 316) range from 2 to 15 with a mean score of (M = 10.95, SD = 2.13).\n\nFor participants in the CONTROL condition, total absolute scores for the TRIANGULAR graph (n = 316) range from 0 to 15 with a mean score of (M = 8.77, SD = 4.45).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#PLOT PAIRED DATA\ngrouped_ggwithinstats(\n  grouping.var = pretty_condition,\n  data = df_long,\n  x    = graph,\n  y    = score, \n  type  = \"nonparametric\", #parametric, robust, bayes\n  annotation.args = list(title = \"Effect of Condition\"),\n)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n#### LINEAR REGRESSION --> SCORE DIFF\n\nPredict difference score by condition, order and tm_scenario\n\n##### Fit Model \n\n::: {.cell}\n\n```{.r .cell-code}\n# empty model \nm0 <- lm( score_diff ~ 1, data = df_s)\n\n# CONDITION model \nm.C <- lm( score_diff ~ pretty_condition, data = df_s)\npaste(\"Condition model better fit than empty?\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Condition model better fit than empty?\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(m0,m.C)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (OLS-estimator)\n\nName | Model | df | df_diff |  Chi2 |      p\n--------------------------------------------\nm0   |    lm |  2 |         |       |       \nm.C  |    lm |  6 |       4 | 31.10 | < .001\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m.C) #main effects condition, order\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnova Table (Type II tests)\n\nResponse: score_diff\n                 Sum Sq  Df F value  Pr(>F)    \npretty_condition    484   4    7.77 5.5e-06 ***\nResiduals          4840 311                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# CONDITION + ORDER model \nm.C.O <- lm( score_diff ~ pretty_condition + order, data = df_s)\npaste(\"Condition + Order model better fit than CONDITION?\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Condition + Order model better fit than CONDITION?\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(m.C.O,m.C)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (OLS-estimator)\n\nName  | Model | df | df_diff | Chi2 |     p\n-------------------------------------------\nm.C.O |    lm |  7 |         |      |      \nm.C   |    lm |  6 |      -1 | 4.07 | 0.044\n```\n:::\n\n```{.r .cell-code}\n# car::Anova(m.CO) #main effects condition, order\n\n# CONDITION + ORDER + SCENARIO model \nm.C.O.S <- lm( score_diff ~ pretty_condition + order + tm_scenarios, data = df_s)\npaste(\"Condition*Order + Scenario model better fit than interactions model?\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Condition*Order + Scenario model better fit than interactions model?\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(m.C.O.S,m.C.O)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (OLS-estimator)\n\nName    | Model | df | df_diff |  Chi2 |      p\n-----------------------------------------------\nm.C.O.S |    lm |  8 |         |       |       \nm.C.O   |    lm |  7 |      -1 | 34.73 | < .001\n```\n:::\n\n```{.r .cell-code}\n# car::Anova(m.C.O.S) #main effects condition, order scenario, scenario\n\n# CONDITION*ORDER*SCENARIO model \nm.COS <- lm( score_diff ~ pretty_condition*order*tm_scenarios, data = df_s)\npaste(\"Condition*Order*Scenario model better fit than CONDITION*ORDER + SCENARIO?\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Condition*Order*Scenario model better fit than CONDITION*ORDER + SCENARIO?\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(m.C.O.S,m.COS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (OLS-estimator)\n\nName    | Model | df | df_diff |  Chi2 |     p\n----------------------------------------------\nm.C.O.S |    lm |  8 |         |       |      \nm.COS   |    lm | 21 |      13 | 13.57 | 0.405\n```\n:::\n\n```{.r .cell-code}\n# car::Anova(m.COS, type = 3) #main effects condition, order scenario, IXN condition & order\n#interaction model is not a better fit than main effects only \n```\n:::\n\n_The best fitting model is one with condition + order + scenario._\n\n##### Describe\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# best model\nm <- m.C.O.S\n\n#::::::::: PRINT MODEL \n\nprint(\"PREDICTOR MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PREDICTOR MODEL\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = score_diff ~ pretty_condition + order + tm_scenarios, \n    data = df_s)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-10.326  -2.373   0.408   2.717   9.897 \n\nCoefficients:\n                           Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                  -4.897      0.569   -8.61  3.9e-16 ***\npretty_conditiontext:what     2.037      0.682    2.99   0.0031 ** \npretty_conditiontext:how      1.923      0.662    2.90   0.0039 ** \npretty_conditionimg:static    1.780      0.672    2.65   0.0085 ** \npretty_conditionimg:ixv       4.080      0.659    6.19  1.9e-09 ***\norderTM-First                -0.857      0.420   -2.04   0.0423 *  \ntm_scenarioslongmire          2.489      0.422    5.89  9.9e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.73 on 309 degrees of freedom\nMultiple R-squared:  0.193,\tAdjusted R-squared:  0.178 \nF-statistic: 12.3 on 6 and 309 DF,  p-value: 1.83e-12\n```\n:::\n\n```{.r .cell-code}\nprint(\"SIGNIFICANCE TEST [non directional]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"SIGNIFICANCE TEST [non directional]\"\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m, type=2) #TYPE 3 SS FOR IXNS\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnova Table (Type II tests)\n\nResponse: score_diff\n                 Sum Sq  Df F value  Pr(>F)    \npretty_condition    539   4    9.70 2.1e-07 ***\norder                58   1    4.16   0.042 *  \ntm_scenarios        483   1   34.73 9.9e-09 ***\nResiduals          4295 309                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#:::::::: MANUAL ONE-SIDED SIGTEST \n#note: anova and chi square are always one-tailed, but that is independent of being one-sided\n#https://www.ibm.com/support/pages/can-one-get-one-tailed-tests-logistic-regression-dividing-significance-levels-half\n\n# one-sided (right tail) z test for B COEFFICIENT\n#SANITY CHECK 2-tailed test should match the model output\n#NOTE ... NEED TO DO THIS FOR _EACH_ COEFFICIENT\n# tt <- 2*pnorm(summary(m)$coefficients[2,3], lower.tail = F)\n# paste(\"p value for two-tailed test, null B = 0 : \",round(tt,5))\n# ot <- pnorm(summary(m)$coefficients[2,3], lower.tail = F)\n# paste(\"BUT we want a one  directional, null: B <= 0: \",round(ot,5))\n\n#:::::::: INTERPRET COEFFICIENTS\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 7\n  term                  estimate std.error statistic  p.value conf.low conf.high\n  <chr>                    <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n1 (Intercept)             -4.90      0.569     -8.61 3.90e-16   -6.02    -3.78  \n2 pretty_conditiontext…    2.04      0.682      2.99 3.06e- 3    0.695    3.38  \n3 pretty_conditiontext…    1.92      0.662      2.90 3.95e- 3    0.620    3.23  \n4 pretty_conditionimg:…    1.78      0.672      2.65 8.52e- 3    0.457    3.10  \n5 pretty_conditionimg:…    4.08      0.659      6.19 1.87e- 9    2.78     5.38  \n6 orderTM-First           -0.857     0.420     -2.04 4.23e- 2   -1.68    -0.0301\n7 tm_scenarioslongmire     2.49      0.422      5.89 9.88e- 9    1.66     3.32  \n```\n:::\n\n```{.r .cell-code}\npaste(\"PROBABILITIES\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PROBABILITIES\"\n```\n:::\n\n```{.r .cell-code}\n#probability control = plogis(intercept)\n#probability impasse = plogis(intercept + coefficient)\n\n#FROM predict()\nnewdata <- df_s %>% dplyr::select(pretty_condition, order, tm_scenarios, subject)\npreds <- predict(m, newdata = newdata, type = \"response\")\npreds <- cbind(newdata, preds)\n(p <- preds %>%\n  group_by(pretty_condition, order, tm_scenarios) %>%\n  dplyr::summarise(\n    median = median(preds),\n    se = sd(preds)/sqrt(n()),\n    lwr = median - 1.96*se,\n    upr = median + 1.96*se))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 7\n# Groups:   pretty_condition, order [10]\n   pretty_condition order    tm_scenarios median    se    lwr    upr\n   <fct>            <fct>    <fct>         <dbl> <dbl>  <dbl>  <dbl>\n 1 control          LM-First axis         -4.90      0 -4.90  -4.90 \n 2 control          LM-First longmire     -2.41      0 -2.41  -2.41 \n 3 control          TM-First axis         -5.75      0 -5.75  -5.75 \n 4 control          TM-First longmire     -3.27      0 -3.27  -3.27 \n 5 text:what        LM-First axis         -2.86      0 -2.86  -2.86 \n 6 text:what        LM-First longmire     -0.371     0 -0.371 -0.371\n 7 text:what        TM-First axis         -3.72      0 -3.72  -3.72 \n 8 text:what        TM-First longmire     -1.23      0 -1.23  -1.23 \n 9 text:how         LM-First axis         -2.97      0 -2.97  -2.97 \n10 text:how         LM-First longmire     -0.485     0 -0.485 -0.485\n11 text:how         TM-First axis         -3.83      0 -3.83  -3.83 \n12 text:how         TM-First longmire     -1.34      0 -1.34  -1.34 \n13 img:static       LM-First axis         -3.12      0 -3.12  -3.12 \n14 img:static       LM-First longmire     -0.628     0 -0.628 -0.628\n15 img:static       TM-First axis         -3.97      0 -3.97  -3.97 \n16 img:static       TM-First longmire     -1.48      0 -1.48  -1.48 \n17 img:ixv          LM-First axis         -0.817     0 -0.817 -0.817\n18 img:ixv          LM-First longmire      1.67      0  1.67   1.67 \n19 img:ixv          TM-First axis         -1.67      0 -1.67  -1.67 \n20 img:ixv          TM-First longmire      0.815     0  0.815  0.815\n```\n:::\n:::\n\n\n\n\n\n##### Visualize\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\nplot_model(m, vline.color = \"red\", \n           show.intercept = TRUE, \n           show.values = TRUE,\n           p.threshold = 0.1, #manually adjust to account for directional test\n           ci.lvl = 0.90 ) + #manually adjusted for directional test   \n  labs(title = \"Model Estimate | Score Difference (TRI - LIN)\",\n       subtitle = \"\",\n       x = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#EASYSTATS | MODEL | ODDS RATIO\n# result <- model_parameters(m, exponentiate = TRUE, component = \"all\")\n# plot(result)\n\n\n## | PLOT TESTS\n\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-30-2.png){width=672}\n:::\n\n```{.r .cell-code}\n## | PLOT PREDICTIONS\n\n#SJPLOT | MODEL | PROBABILITIES\nplot_model(m, type=\"eff\",\n           show.intercept = TRUE,\n           show.values = TRUE,\n           title = \"Model Prediction | Probability of Accurate Response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$pretty_condition\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-30-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n$order\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-30-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n$tm_scenarios\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-30-5.png){width=672}\n:::\n\n```{.r .cell-code}\n#PLOT MODEL PREDICTION\n# plot_model(m, type = \"pred\")  \n# plot_model(m, type = \"eff\")  \n  # ylim(0,1) + \n  # labs(\n  #   title = \"Model Prediction | Probability of Accurate Response\",\n  #   subtitle = \"Impasse increases Probability of Correct Response\"\n  # )\n\n#TODO EMMEANS for the estimated marginal means OR USE IXN PLOT\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">score diff</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;4.90</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;6.02&nbsp;&ndash;&nbsp;-3.78</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>what</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.69&nbsp;&ndash;&nbsp;3.38</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.003</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>how</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.62&nbsp;&ndash;&nbsp;3.23</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.004</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg *<br>static</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.78</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.46&nbsp;&ndash;&nbsp;3.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.009</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg * ixv</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.78&nbsp;&ndash;&nbsp;5.38</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">order [TM-First]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.86</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.68&nbsp;&ndash;&nbsp;-0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.042</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">tm scenarios [longmire]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.66&nbsp;&ndash;&nbsp;3.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">316</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.193 / 0.178</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m, \"(log odds)\" = m)\n# notes = list('\"* p < 0.05, ** p < 0.01, *** p < 0.001\"',\n#                'N(subject) = 133 $\\tau_{00}$(subject) = 34.85',\n#              'N(question) = 13 $\\tau_{00}$(question) = 1.14')\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',\n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_online.tex\")\n# # #              # coef_omit = \"Intercept\",\n```\n:::\n\n\n\n#### MIXED EFFECTS LOGISTIC REGRESSION --> RAW SCORE\n\n_Fit mixed effects logistic regression model to test effect of GRAPH, ORDER, and SCENARIO on probability of correct response [just in the control condition]_\n\n\n##### Fit Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 0 | SETUP\n#confirm 13 items [all discriminating items]\nnrow(df_i) / nrow(df_s)  #removed nondiscrim Q3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 28\n```\n:::\n\n```{.r .cell-code}\n#confirm all factors \nis.factor(df_i$q) && is.factor(df_i$subject) && is.factor(df_i$graph) && is.factor(df_i$score) && is.factor(df_i$order) && is.factor(df_i$scenario)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n## 1 | SETUP RANDOM INTERCEPT SUBJECT\n\n#:: EMPTY MODEL (baseline, no random effect)\nprint(\"Empty fixed model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Empty fixed model\"\n```\n:::\n\n```{.r .cell-code}\nm0 = glm(accuracy ~ 1, family = \"binomial\", data = df_i) \n# summary(m0)\n\n#:: RANDOM INTERCEPT SUBJECT + ITEM\nprint(\"Subject Intercept + Item intercept random model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Subject Intercept + Item intercept random model\"\n```\n:::\n\n```{.r .cell-code}\nmm.rSQ <- glmer(accuracy ~ (1|subject) + (1|q), data = df_i, family = \"binomial\")\n#summary(mm.rSQ)\n\n## 2 | ADD FIXED EFFECT GRAPH\n\nprint(\"FIXED GRAPH + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"FIXED GRAPH + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.GrSQ <- glmer(accuracy ~ graph + (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\")\n# car::Anova(mm.GrSQ) #main effect graph\n\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.rSQ)) > AIC(logLik(mm.GrSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.rSQ,mm.GrSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName    |    Model | df | df_diff |   Chi2 |      p\n---------------------------------------------------\nmm.rSQ  | glmerMod |  3 |         |        |       \nmm.GrSQ | glmerMod |  4 |       1 | 274.61 | < .001\n```\n:::\n\n```{.r .cell-code}\n## 2 | ADD FIXED EFFECT CONDITION\n\nprint(\"IXN GRAPH*Condition + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"IXN GRAPH*Condition + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.GCrSQ <- glmer(accuracy ~ graph*pretty_condition + (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\", \n                control=glmerControl(optimizer=\"bobyqa\",\n                                 optCtrl=list(maxfun=2e5)))\n#car::Anova(mm.GCrSQ) #main effects graph + IXN graph*condition\n\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.rSQ)) > AIC(logLik(mm.GCrSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.rSQ,mm.GCrSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName     |    Model | df | df_diff |   Chi2 |      p\n----------------------------------------------------\nmm.rSQ   | glmerMod |  3 |         |        |       \nmm.GCrSQ | glmerMod | 12 |       9 | 368.36 | < .001\n```\n:::\n\n```{.r .cell-code}\n# 2 | ADD IXN ORDER\nprint(\"FIXED Graph + ORDER + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"FIXED Graph + ORDER + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.GC.COrSQ <- glmer(accuracy ~ graph*pretty_condition + graph*order + (1|subject) + (1|q),\n                   data = df_i, family = \"binomial\", \n                   control=glmerControl(optimizer=\"bobyqa\",\n                                 optCtrl=list(maxfun=2e5)))\n# summary(mm.GC.COrSQ)\ncar::Anova(mm.GC.COrSQ, type = 3) #IXN graphX condition, GRAPH*order\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: accuracy\n                        Chisq Df Pr(>Chisq)    \n(Intercept)             46.90  1    7.5e-12 ***\ngraph                  112.04  1    < 2e-16 ***\npretty_condition         0.57  4      0.966    \norder                    0.12  1      0.725    \ngraph:pretty_condition  78.68  4    3.3e-16 ***\ngraph:order              8.27  1      0.004 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#x <-  mm.GCOrSQ <- glmer(accuracy ~ graph*pretty_condition*order + (1|subject) + (1|q),\n#                    data = df_i, family = \"binomial\", \n#                    control=glmerControl(optimizer=\"bobyqa\",\n#                                  optCtrl=list(maxfun=2e5)))\n# car::Anova(x) # 3 way ixn graph,condition,order??\n\n\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.GCrSQ)) > AIC(logLik(mm.GC.COrSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.GCrSQ,mm.GC.COrSQ) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName        |    Model | df | df_diff | Chi2 |     p\n----------------------------------------------------\nmm.GCrSQ    | glmerMod | 12 |         |      |      \nmm.GC.COrSQ | glmerMod | 14 |       2 | 9.22 | 0.010\n```\n:::\n\n```{.r .cell-code}\n# 3 | ADD FIXED EFFECT SCENARIO\n\nprint(\"FIXED Graph * SCENARIO * ORDER + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"FIXED Graph * SCENARIO * ORDER + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.GC.CO.GSrSQ <- glmer(accuracy ~ graph*pretty_condition + graph*order + graph*scenario +  (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\",\n                control=glmerControl(optimizer=\"bobyqa\",\n                                 optCtrl=list(maxfun=2e5)))\nsummary(mm.GC.CO.GSrSQ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: accuracy ~ graph * pretty_condition + graph * order + graph *  \n    scenario + (1 | subject) + (1 | q)\n   Data: df_i\nControl: glmerControl(optimizer = \"bobyqa\", optCtrl = list(maxfun = 200000))\n\n     AIC      BIC   logLik deviance df.resid \n   10304    10418    -5136    10272     8831 \n\nScaled residuals: \n   Min     1Q Median     3Q    Max \n-3.518 -0.772  0.442  0.656  2.465 \n\nRandom effects:\n Groups  Name        Variance Std.Dev.\n subject (Intercept) 0.698    0.836   \n q       (Intercept) 0.050    0.224   \nNumber of obs: 8847, groups:  subject, 316; q, 14\n\nFixed effects:\n                                           Estimate Std. Error z value Pr(>|z|)\n(Intercept)                                 1.18720    0.17126    6.93  4.1e-12\ngraphtriangular                            -1.81987    0.16553  -10.99  < 2e-16\npretty_conditiontext:what                   0.06086    0.19422    0.31   0.7540\npretty_conditiontext:how                    0.00227    0.18841    0.01   0.9904\npretty_conditionimg:static                 -0.02087    0.19087   -0.11   0.9129\npretty_conditionimg:ixv                    -0.06727    0.18602   -0.36   0.7176\norderTM-First                               0.04564    0.11925    0.38   0.7019\nscenariolongmire                           -0.15336    0.11995   -1.28   0.2011\ngraphtriangular:pretty_conditiontext:what   0.68218    0.16229    4.20  2.6e-05\ngraphtriangular:pretty_conditiontext:how    0.65580    0.15738    4.17  3.1e-05\ngraphtriangular:pretty_conditionimg:static  0.66430    0.15922    4.17  3.0e-05\ngraphtriangular:pretty_conditionimg:ixv     1.45042    0.15680    9.25  < 2e-16\ngraphtriangular:orderTM-First              -0.28160    0.09951   -2.83   0.0047\ngraphtriangular:scenariolongmire            0.99750    0.21496    4.64  3.5e-06\n                                              \n(Intercept)                                ***\ngraphtriangular                            ***\npretty_conditiontext:what                     \npretty_conditiontext:how                      \npretty_conditionimg:static                    \npretty_conditionimg:ixv                       \norderTM-First                                 \nscenariolongmire                              \ngraphtriangular:pretty_conditiontext:what  ***\ngraphtriangular:pretty_conditiontext:how   ***\ngraphtriangular:pretty_conditionimg:static ***\ngraphtriangular:pretty_conditionimg:ixv    ***\ngraphtriangular:orderTM-First              ** \ngraphtriangular:scenariolongmire           ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nCorrelation matrix not shown by default, as p = 14 > 12.\nUse print(x, correlation=TRUE)  or\n    vcov(x)        if you need it\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(mm.GC.CO.GSrSQ, type = 3) #IXN graphXscenario, graphXorder, graphXcondition, \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: accuracy\n                        Chisq Df Pr(>Chisq)    \n(Intercept)             48.06  1    4.1e-12 ***\ngraph                  120.87  1    < 2e-16 ***\npretty_condition         0.48  4     0.9751    \norder                    0.15  1     0.7019    \nscenario                 1.63  1     0.2011    \ngraph:pretty_condition  86.58  4    < 2e-16 ***\ngraph:order              8.01  1     0.0047 ** \ngraph:scenario          21.53  1    3.5e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.GC.COrSQ)) > AIC(logLik(mm.GC.CO.GSrSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.GC.COrSQ,mm.GC.CO.GSrSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName           |    Model | df | df_diff |  Chi2 |      p\n---------------------------------------------------------\nmm.GC.COrSQ    | glmerMod | 14 |         |       |       \nmm.GC.CO.GSrSQ | glmerMod | 16 |       2 | 70.17 | < .001\n```\n:::\n:::\n\n\nThe best fitting model included interactions for graph X condition, graph X order, and graph X scenario\n\n##### Describe\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# best model\nm <- mm.GC.CO.GSrSQ\n\n#::::::::: PRINT MODEL \n\nprint(\"PREDICTOR MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PREDICTOR MODEL\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: accuracy ~ graph * pretty_condition + graph * order + graph *  \n    scenario + (1 | subject) + (1 | q)\n   Data: df_i\nControl: glmerControl(optimizer = \"bobyqa\", optCtrl = list(maxfun = 200000))\n\n     AIC      BIC   logLik deviance df.resid \n   10304    10418    -5136    10272     8831 \n\nScaled residuals: \n   Min     1Q Median     3Q    Max \n-3.518 -0.772  0.442  0.656  2.465 \n\nRandom effects:\n Groups  Name        Variance Std.Dev.\n subject (Intercept) 0.698    0.836   \n q       (Intercept) 0.050    0.224   \nNumber of obs: 8847, groups:  subject, 316; q, 14\n\nFixed effects:\n                                           Estimate Std. Error z value Pr(>|z|)\n(Intercept)                                 1.18720    0.17126    6.93  4.1e-12\ngraphtriangular                            -1.81987    0.16553  -10.99  < 2e-16\npretty_conditiontext:what                   0.06086    0.19422    0.31   0.7540\npretty_conditiontext:how                    0.00227    0.18841    0.01   0.9904\npretty_conditionimg:static                 -0.02087    0.19087   -0.11   0.9129\npretty_conditionimg:ixv                    -0.06727    0.18602   -0.36   0.7176\norderTM-First                               0.04564    0.11925    0.38   0.7019\nscenariolongmire                           -0.15336    0.11995   -1.28   0.2011\ngraphtriangular:pretty_conditiontext:what   0.68218    0.16229    4.20  2.6e-05\ngraphtriangular:pretty_conditiontext:how    0.65580    0.15738    4.17  3.1e-05\ngraphtriangular:pretty_conditionimg:static  0.66430    0.15922    4.17  3.0e-05\ngraphtriangular:pretty_conditionimg:ixv     1.45042    0.15680    9.25  < 2e-16\ngraphtriangular:orderTM-First              -0.28160    0.09951   -2.83   0.0047\ngraphtriangular:scenariolongmire            0.99750    0.21496    4.64  3.5e-06\n                                              \n(Intercept)                                ***\ngraphtriangular                            ***\npretty_conditiontext:what                     \npretty_conditiontext:how                      \npretty_conditionimg:static                    \npretty_conditionimg:ixv                       \norderTM-First                                 \nscenariolongmire                              \ngraphtriangular:pretty_conditiontext:what  ***\ngraphtriangular:pretty_conditiontext:how   ***\ngraphtriangular:pretty_conditionimg:static ***\ngraphtriangular:pretty_conditionimg:ixv    ***\ngraphtriangular:orderTM-First              ** \ngraphtriangular:scenariolongmire           ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nCorrelation matrix not shown by default, as p = 14 > 12.\nUse print(x, correlation=TRUE)  or\n    vcov(x)        if you need it\n```\n:::\n\n```{.r .cell-code}\nprint(\"SIGNIFICANCE TEST [non directional]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"SIGNIFICANCE TEST [non directional]\"\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m, type=3) #TYPE 3 SS FOR IXNS\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: accuracy\n                        Chisq Df Pr(>Chisq)    \n(Intercept)             48.06  1    4.1e-12 ***\ngraph                  120.87  1    < 2e-16 ***\npretty_condition         0.48  4     0.9751    \norder                    0.15  1     0.7019    \nscenario                 1.63  1     0.2011    \ngraph:pretty_condition  86.58  4    < 2e-16 ***\ngraph:order              8.01  1     0.0047 ** \ngraph:scenario          21.53  1    3.5e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#:::::::: INTERPRET COEFFICIENTS\n\npaste(\"LOG ODDS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"LOG ODDS\"\n```\n:::\n\n```{.r .cell-code}\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 16 × 9\n   effect  group term  estimate std.error statistic   p.value conf.low conf.high\n   <chr>   <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n 1 fixed   <NA>  (Int…  1.19       0.171     6.93    4.14e-12    0.852    1.52  \n 2 fixed   <NA>  grap… -1.82       0.166   -11.0     4.08e-28   -2.14    -1.50  \n 3 fixed   <NA>  pret…  0.0609     0.194     0.313   7.54e- 1   -0.320    0.442 \n 4 fixed   <NA>  pret…  0.00227    0.188     0.0120  9.90e- 1   -0.367    0.372 \n 5 fixed   <NA>  pret… -0.0209     0.191    -0.109   9.13e- 1   -0.395    0.353 \n 6 fixed   <NA>  pret… -0.0673     0.186    -0.362   7.18e- 1   -0.432    0.297 \n 7 fixed   <NA>  orde…  0.0456     0.119     0.383   7.02e- 1   -0.188    0.279 \n 8 fixed   <NA>  scen… -0.153      0.120    -1.28    2.01e- 1   -0.388    0.0817\n 9 fixed   <NA>  grap…  0.682      0.162     4.20    2.63e- 5    0.364    1.00  \n10 fixed   <NA>  grap…  0.656      0.157     4.17    3.09e- 5    0.347    0.964 \n11 fixed   <NA>  grap…  0.664      0.159     4.17    3.02e- 5    0.352    0.976 \n12 fixed   <NA>  grap…  1.45       0.157     9.25    2.25e-20    1.14     1.76  \n13 fixed   <NA>  grap… -0.282      0.0995   -2.83    4.66e- 3   -0.477   -0.0866\n14 fixed   <NA>  grap…  0.997      0.215     4.64    3.48e- 6    0.576    1.42  \n15 ran_pa… subj… sd__…  0.836     NA        NA      NA          NA       NA     \n16 ran_pa… q     sd__…  0.224     NA        NA      NA          NA       NA     \n```\n:::\n\n```{.r .cell-code}\npaste(\"ODDS RATIOS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ODDS RATIOS\"\n```\n:::\n\n```{.r .cell-code}\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\", exponentiate = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 16 × 9\n   effect  group term  estimate std.error statistic   p.value conf.low conf.high\n   <chr>   <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n 1 fixed   <NA>  (Int…    3.28     0.561     6.93    4.14e-12    2.34      4.59 \n 2 fixed   <NA>  grap…    0.162    0.0268  -11.0     4.08e-28    0.117     0.224\n 3 fixed   <NA>  pret…    1.06     0.206     0.313   7.54e- 1    0.726     1.56 \n 4 fixed   <NA>  pret…    1.00     0.189     0.0120  9.90e- 1    0.693     1.45 \n 5 fixed   <NA>  pret…    0.979    0.187    -0.109   9.13e- 1    0.674     1.42 \n 6 fixed   <NA>  pret…    0.935    0.174    -0.362   7.18e- 1    0.649     1.35 \n 7 fixed   <NA>  orde…    1.05     0.125     0.383   7.02e- 1    0.829     1.32 \n 8 fixed   <NA>  scen…    0.858    0.103    -1.28    2.01e- 1    0.678     1.09 \n 9 fixed   <NA>  grap…    1.98     0.321     4.20    2.63e- 5    1.44      2.72 \n10 fixed   <NA>  grap…    1.93     0.303     4.17    3.09e- 5    1.42      2.62 \n11 fixed   <NA>  grap…    1.94     0.309     4.17    3.02e- 5    1.42      2.65 \n12 fixed   <NA>  grap…    4.26     0.669     9.25    2.25e-20    3.14      5.80 \n13 fixed   <NA>  grap…    0.755    0.0751   -2.83    4.66e- 3    0.621     0.917\n14 fixed   <NA>  grap…    2.71     0.583     4.64    3.48e- 6    1.78      4.13 \n15 ran_pa… subj… sd__…    0.836   NA        NA      NA          NA        NA    \n16 ran_pa… q     sd__…    0.224   NA        NA      NA          NA        NA    \n```\n:::\n\n```{.r .cell-code}\npaste(\"PROBABILITIES\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PROBABILITIES\"\n```\n:::\n\n```{.r .cell-code}\n#probability control = plogis(intercept)\n#probability impasse = plogis(intercept + coefficient)\n\n#FROM merTools\n#setup empty df \nnewdata <- df_i %>% dplyr::select(graph, pretty_condition, order, scenario, subject, q)\n#make predictions\npreds <- predictInterval(m, newdata = newdata,\n                              which = \"fixed\", #full, fixed or random for those only\n                              type = \"probability\", #linear.prediction\n                              stat = \"median\",\n                              n.sims = 1000,\n                              level = 0.80) #width of prediction interval\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in predictInterval(m, newdata = newdata, which = \"fixed\", type = \"probability\", : newdata is tbl_df or tbl object from dplyr package and has been\n              coerced to a data.frame\n```\n:::\n\n```{.r .cell-code}\n#join predictions to the new dataframe\npreds <- cbind(newdata, preds)\n#summarize\n(summ_preds <- preds %>% \n  dplyr::select(graph, pretty_condition, scenario, order, fit, lwr, upr) %>% \n  group_by(graph, pretty_condition, scenario, order) %>% \n  dplyr::summarise(\n    median = median(fit),\n    lower = median(lwr),\n    upper = median(upr)\n  )) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 40 × 7\n# Groups:   graph, pretty_condition, scenario [20]\n   graph  pretty_condition scenario order    median lower upper\n   <fct>  <fct>            <fct>    <fct>     <dbl> <dbl> <dbl>\n 1 linear control          axis     LM-First  0.766 0.473 0.923\n 2 linear control          axis     TM-First  0.775 0.486 0.927\n 3 linear control          longmire LM-First  0.736 0.434 0.911\n 4 linear control          longmire TM-First  0.748 0.448 0.916\n 5 linear text:what        axis     LM-First  0.777 0.487 0.927\n 6 linear text:what        axis     TM-First  0.785 0.494 0.931\n 7 linear text:what        longmire LM-First  0.749 0.448 0.916\n 8 linear text:what        longmire TM-First  0.759 0.462 0.919\n 9 linear text:how         axis     LM-First  0.765 0.470 0.922\n10 linear text:how         axis     TM-First  0.774 0.484 0.926\n# … with 30 more rows\n```\n:::\n:::\n\n\n##### Inference TODO UPDATE\n\n\n##### Visualize\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\nplot_model(m, vline.color = \"red\", \n           show.intercept = TRUE, \n           show.values = TRUE,\n           p.threshold = 0.1, #manually adjust to account for directional test\n           ci.lvl = 0.90 ) + #manually adjusted for directional test   \n  labs(title = \"Model Estimate | Odds Ratio\",\n       subtitle = \"\",\n       x = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#EASYSTATS | MODEL | ODDS RATIO\n# result <- model_parameters(m, exponentiate = TRUE, component = \"all\")\n# plot(result)\n\n\n## | PLOT TESTS\n\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-34-2.png){width=672}\n:::\n\n```{.r .cell-code}\n## | PLOT PREDICTIONS\n\n#SJPLOT | MODEL | PROBABILITIES\nplot_model(m, type=\"int\",\n           show.intercept = TRUE,\n           show.values = TRUE,\n           title = \"Model Prediction | Probability of Accurate Response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-34-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n[[2]]\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-34-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n[[3]]\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-34-5.png){width=672}\n:::\n\n```{.r .cell-code}\n#PLOT MODEL PREDICTION\n# plot_model(m, type = \"pred\")  \n# plot_model(m, type = \"eff\")  \n  # ylim(0,1) + \n  # labs(\n  #   title = \"Model Prediction | Probability of Accurate Response\",\n  #   subtitle = \"Impasse increases Probability of Correct Response\"\n  # )\n\n#TODO EMMEANS for the estimated marginal means OR USE IXN PLOT\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">accuracy</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.28</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.34&nbsp;&ndash;&nbsp;4.59</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.16</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12&nbsp;&ndash;&nbsp;0.22</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>what</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.06</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.73&nbsp;&ndash;&nbsp;1.56</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.754</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>how</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.69&nbsp;&ndash;&nbsp;1.45</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.990</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg *<br>static</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.98</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.67&nbsp;&ndash;&nbsp;1.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.913</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg * ixv</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.65&nbsp;&ndash;&nbsp;1.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.718</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">order [TM-First]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.83&nbsp;&ndash;&nbsp;1.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.702</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">scenario [longmire]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.86</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.68&nbsp;&ndash;&nbsp;1.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.201</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular] *<br>pretty conditiontext *<br>what</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.98</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.44&nbsp;&ndash;&nbsp;2.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular] *<br>pretty conditiontext *<br>how</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.42&nbsp;&ndash;&nbsp;2.62</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular] *<br>pretty conditionimg *<br>static</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.94</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.42&nbsp;&ndash;&nbsp;2.65</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular] *<br>pretty conditionimg * ixv</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.26</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.14&nbsp;&ndash;&nbsp;5.80</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular] *<br>order [TM-First]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.75</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.62&nbsp;&ndash;&nbsp;0.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.005</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">graph [triangular] *<br>scenario [longmire]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.71</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.78&nbsp;&ndash;&nbsp;4.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">3.29</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.70</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.05</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.19</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">316</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">14</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">8847</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.078 / 0.249</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m, \"(log odds)\" = m)\n# notes = list('\"* p < 0.05, ** p < 0.01, *** p < 0.001\"',\n#                'N(subject) = 133 $\\tau_{00}$(subject) = 34.85',\n#              'N(question) = 13 $\\tau_{00}$(question) = 1.14')\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',\n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_online.tex\")\n# # #              # coef_omit = \"Intercept\",\n```\n:::\n\n\n##### Diagnostics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# print(\"SANITY CHECK REPORTING\")\n# report(m)\n\n# print(\"MODEL PERFORMANCE\")\n# performance(m)\n\nprint(\"DIAGNOSTICS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"DIAGNOSTICS\"\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m)\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n\n\n## DRAWING TASK\n\n### Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_s <- df_subjects\n```\n:::\n\n\n\n### Visualize\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbarstats( x = draw_type, y =pretty_condition , data = df_s,\n            title = \"Drawing Type by Condition\")\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#drawing type by order \ngrouped_ggbarstats( x = draw_type, y =pretty_condition , \n                    grouping.var = order, data = df_s,\n                    annotation.args = list(\n                      title = \"Drawing type BY ORDER\"\n                    ))\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-38-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#drawing type by tm-scenario \ngrouped_ggbarstats( x = draw_type, y =pretty_condition , \n                    grouping.var = tm_scenarios, data = df_s,\n                    annotation.args = list(\n                      title = \"Drawing type BY tm-scenario\"\n                    ))\n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/unnamed-chunk-38-3.png){width=672}\n:::\n:::\n\n\n### MULTINOMIAL REGRESSION\n\n\n*Does condition affect the type of drawing produced?*\n\n\n##### Fit Model \\[multinom\\]\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#https://www.elff.eu/software/mclogit/manual/mblogit/\n#\"baseline category logit\" model matches multinom()\n\n#check reference level \nprint(\"Categories (first is reference)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Categories (first is reference)\"\n```\n:::\n\n```{.r .cell-code}\nlevels(df_s$draw_type)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Linear Model\"             \"Scatterplot\"             \n[3] \"Triangular\"               \"Triangular (asymmetric)\" \n[5] \"Triangular (right angle)\"\n```\n:::\n\n```{.r .cell-code}\n#FIT EMPTY MODEL\n# print(\"EMPTY MODEL\")\nmm.cat.rSQ <- multinom(draw_type ~ 1 , data = df_s)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  10 (4 variable)\ninitial  value 508.582380 \niter  10 value 282.089320\nfinal  value 282.088557 \nconverged\n```\n:::\n\n```{.r .cell-code}\n# summary(mm.cat.rSQ)\n\n#FIT PREDICTOR MODEL\n# print(\"PREDICTOR MODEL\")\nmm.cat.CrSQ <- multinom(draw_type ~ pretty_condition , data = df_s)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  30 (20 variable)\ninitial  value 508.582380 \niter  10 value 265.311738\niter  20 value 262.186739\niter  30 value 262.064683\niter  40 value 262.063130\nfinal  value 262.063125 \nconverged\n```\n:::\n\n```{.r .cell-code}\nmb <- mblogit(draw_type ~ pretty_condition , data = df_s)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nIteration 1 - deviance = 548 - criterion = 0.0223\nIteration 2 - deviance = 529 - criterion = 0.0357\nIteration 3 - deviance = 526 - criterion = 0.00618\nIteration 4 - deviance = 525 - criterion = 0.0018\nIteration 5 - deviance = 524 - criterion = 0.000653\nIteration 6 - deviance = 524 - criterion = 0.00024\nIteration 7 - deviance = 524 - criterion = 0.0000882\nIteration 8 - deviance = 524 - criterion = 0.0000324\nIteration 9 - deviance = 524 - criterion = 0.0000119\nIteration 10 - deviance = 524 - criterion = 4.39e-06\nIteration 11 - deviance = 524 - criterion = 1.61e-06\nIteration 12 - deviance = 524 - criterion = 5.94e-07\nIteration 13 - deviance = 524 - criterion = 2.18e-07\nIteration 14 - deviance = 524 - criterion = 8.04e-08\nIteration 15 - deviance = 524 - criterion = 2.96e-08\nIteration 16 - deviance = 524 - criterion = 1.09e-08\nIteration 17 - deviance = 524 - criterion = 4e-09\nconverged\n```\n:::\n\n```{.r .cell-code}\n#COMPARE MODEL FIT\npaste(\"AIC wth predictor is lower than empty model?\", AIC(mm.cat.rSQ) > AIC(mm.cat.CrSQ))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC wth predictor is lower than empty model? TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.cat.rSQ, mm.cat.CrSQ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName        |    Model | df | df_diff |  Chi2 |      p\n------------------------------------------------------\nmm.cat.rSQ  | multinom |  4 |         |       |       \nmm.cat.CrSQ | multinom | 20 |      16 | 40.05 | < .001\n```\n:::\n:::\n\n\n\n##### Describe\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# best model\nm <- mm.cat.CrSQ\n\n#DESCRIBE MODEL\nsummary(mb) #use mblogit version to see estimate level p values\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nmblogit(formula = draw_type ~ pretty_condition, data = df_s)\n\nEquation for Scatterplot vs Linear Model:\n                           Estimate Std. Error z value Pr(>|z|)  \n(Intercept)                  -1.792      1.080   -1.66    0.097 .\npretty_conditiontext:what     1.792   3232.468    0.00    1.000  \npretty_conditiontext:how      0.693      1.581    0.44    0.661  \npretty_conditionimg:static  -15.450   2096.388   -0.01    0.994  \npretty_conditionimg:ixv       1.792      1.780    1.01    0.314  \n\nEquation for Triangular vs Linear Model:\n                            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                   1.7346     0.4428    3.92    9e-05 ***\npretty_conditiontext:what    17.6463  2285.7001    0.01    0.994    \npretty_conditiontext:how      1.0380     0.7418    1.40    0.162    \npretty_conditionimg:static    0.0331     0.6028    0.05    0.956    \npretty_conditionimg:ixv       2.3085     1.1016    2.10    0.036 *  \n\nEquation for Triangular (asymmetric) vs Linear Model:\n                                                   Estimate Std. Error z value\nTriangular (asymmetric)~(Intercept)                  -0.693      0.707   -0.98\nTriangular (asymmetric)~pretty_conditiontext:what    17.261   2285.700    0.01\nTriangular (asymmetric)~pretty_conditiontext:how      1.204      1.017    1.18\nTriangular (asymmetric)~pretty_conditionimg:static    0.134      0.945    0.14\nTriangular (asymmetric)~pretty_conditionimg:ixv       2.639      1.282    2.06\n                                                   Pr(>|z|)  \nTriangular (asymmetric)~(Intercept)                   0.327  \nTriangular (asymmetric)~pretty_conditiontext:what     0.994  \nTriangular (asymmetric)~pretty_conditiontext:how      0.236  \nTriangular (asymmetric)~pretty_conditionimg:static    0.888  \nTriangular (asymmetric)~pretty_conditionimg:ixv       0.039 *\n\nEquation for Triangular (right angle) vs Linear Model:\n                                                     Estimate Std. Error\nTriangular (right angle)~(Intercept)                   1.0415     0.4749\nTriangular (right angle)~pretty_conditiontext:what    16.2192  2285.7002\nTriangular (right angle)~pretty_conditiontext:how      0.0572     0.8185\nTriangular (right angle)~pretty_conditionimg:static   -0.6848     0.6844\nTriangular (right angle)~pretty_conditionimg:ixv      -0.3483     1.3136\n                                                    z value Pr(>|z|)  \nTriangular (right angle)~(Intercept)                   2.19    0.028 *\nTriangular (right angle)~pretty_conditiontext:what     0.01    0.994  \nTriangular (right angle)~pretty_conditiontext:how      0.07    0.944  \nTriangular (right angle)~pretty_conditionimg:static   -1.00    0.317  \nTriangular (right angle)~pretty_conditionimg:ixv      -0.27    0.791  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nNull Deviance:     1020 \nResidual Deviance: 524 \nNumber of Fisher Scoring iterations:  17 \nNumber of observations:  316 \n```\n:::\n\n```{.r .cell-code}\n#INTERPRET COEFFICIENTS\npaste(\"LOG ODDS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"LOG ODDS\"\n```\n:::\n\n```{.r .cell-code}\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 8\n   y.level       term  estimate std.error statistic   p.value conf.low conf.high\n   <chr>         <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n 1 Scatterplot   (Int…  -1.79     1.08e+0  -1.66e+0 9.72e-  2   -3.91      0.325\n 2 Scatterplot   pret…  -2.13     4.64e-8  -4.58e+7 0           -2.13     -2.13 \n 3 Scatterplot   pret…   0.693    1.58e+0   4.38e-1 6.61e-  1   -2.41      3.79 \n 4 Scatterplot   pret… -13.8      6.12e-6  -2.25e+6 0          -13.8     -13.8  \n 5 Scatterplot   pret…   1.79     1.78e+0   1.01e+0 3.14e-  1   -1.70      5.28 \n 6 Triangular    (Int…   1.73     4.43e-1   3.92e+0 8.95e-  5    0.867     2.60 \n 7 Triangular    pret…  16.4      3.48e-1   4.72e+1 0           15.7      17.1  \n 8 Triangular    pret…   1.04     7.42e-1   1.40e+0 1.62e-  1   -0.416     2.49 \n 9 Triangular    pret…   0.0329   6.03e-1   5.46e-2 9.56e-  1   -1.15      1.21 \n10 Triangular    pret…   2.31     1.10e+0   2.10e+0 3.61e-  2    0.149     4.47 \n11 Triangular (… (Int…  -0.693    7.07e-1  -9.80e-1 3.27e-  1   -2.08      0.693\n12 Triangular (… pret…  16.0      5.72e-1   2.81e+1 2.67e-173   14.9      17.2  \n13 Triangular (… pret…   1.20     1.02e+0   1.18e+0 2.36e-  1   -0.789     3.20 \n14 Triangular (… pret…   0.133    9.45e-1   1.41e-1 8.88e-  1   -1.72      1.99 \n15 Triangular (… pret…   2.64     1.28e+0   2.06e+0 3.95e-  2    0.127     5.15 \n16 Triangular (… (Int…   1.04     4.75e-1   2.19e+0 2.83e-  2    0.111     1.97 \n17 Triangular (… pret…  15.0      4.24e-1   3.54e+1 3.11e-274   14.2      15.8  \n18 Triangular (… pret…   0.0570   8.19e-1   6.96e-2 9.45e-  1   -1.55      1.66 \n19 Triangular (… pret…  -0.685    6.84e-1  -1.00e+0 3.17e-  1   -2.03      0.656\n20 Triangular (… pret…  -0.349    1.31e+0  -2.66e-1 7.91e-  1   -2.92      2.23 \n```\n:::\n\n```{.r .cell-code}\npaste(\"ODDS RATIOS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ODDS RATIOS\"\n```\n:::\n\n```{.r .cell-code}\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\", exponentiate = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 8\n   y.level       term  estimate std.error statistic   p.value conf.low conf.high\n   <chr>         <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n 1 Scatterplot   (Int…  1.67e-1   1.08e+0  -1.66e+0 9.72e-  2  2.01e-2   1.38e+0\n 2 Scatterplot   pret…  1.19e-1   4.64e-8  -4.58e+7 0          1.19e-1   1.19e-1\n 3 Scatterplot   pret…  2.00e+0   1.58e+0   4.38e-1 6.61e-  1  9.02e-2   4.44e+1\n 4 Scatterplot   pret…  1.05e-6   6.12e-6  -2.25e+6 0          1.05e-6   1.05e-6\n 5 Scatterplot   pret…  6.00e+0   1.78e+0   1.01e+0 3.14e-  1  1.83e-1   1.96e+2\n 6 Triangular    (Int…  5.67e+0   4.43e-1   3.92e+0 8.95e-  5  2.38e+0   1.35e+1\n 7 Triangular    pret…  1.37e+7   3.48e-1   4.72e+1 0          6.90e+6   2.70e+7\n 8 Triangular    pret…  2.82e+0   7.42e-1   1.40e+0 1.62e-  1  6.60e-1   1.21e+1\n 9 Triangular    pret…  1.03e+0   6.03e-1   5.46e-2 9.56e-  1  3.17e-1   3.37e+0\n10 Triangular    pret…  1.01e+1   1.10e+0   2.10e+0 3.61e-  2  1.16e+0   8.71e+1\n11 Triangular (… (Int…  5.00e-1   7.07e-1  -9.80e-1 3.27e-  1  1.25e-1   2.00e+0\n12 Triangular (… pret…  9.28e+6   5.72e-1   2.81e+1 2.67e-173  3.03e+6   2.85e+7\n13 Triangular (… pret…  3.33e+0   1.02e+0   1.18e+0 2.36e-  1  4.54e-1   2.44e+1\n14 Triangular (… pret…  1.14e+0   9.45e-1   1.41e-1 8.88e-  1  1.79e-1   7.28e+0\n15 Triangular (… pret…  1.40e+1   1.28e+0   2.06e+0 3.95e-  2  1.13e+0   1.73e+2\n16 Triangular (… (Int…  2.83e+0   4.75e-1   2.19e+0 2.83e-  2  1.12e+0   7.19e+0\n17 Triangular (… pret…  3.28e+6   4.24e-1   3.54e+1 3.11e-274  1.43e+6   7.52e+6\n18 Triangular (… pret…  1.06e+0   8.19e-1   6.96e-2 9.45e-  1  2.13e-1   5.27e+0\n19 Triangular (… pret…  5.04e-1   6.84e-1  -1.00e+0 3.17e-  1  1.32e-1   1.93e+0\n20 Triangular (… pret…  7.06e-1   1.31e+0  -2.66e-1 7.91e-  1  5.38e-2   9.26e+0\n```\n:::\n\n```{.r .cell-code}\n#PERFORMANCE\nperformance(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCan't calculate log-loss.\nCan't calculate proper scoring rules for ordinal, multinomial or cumulative link models.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# Indices of model performance\n\nAIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma\n-----------------------------------------------------\n564.126 | 639.241 | 0.071 |     0.067 | 0.291 | 1.331\n```\n:::\n\n```{.r .cell-code}\npaste(\"PROBABILITIES\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PROBABILITIES\"\n```\n:::\n\n```{.r .cell-code}\n#PREDICT METHOD\nnewdata <- df_i %>% dplyr::select(pretty_condition, subject)\npreds <- predict(m, newdata = newdata, type = \"probs\")\npreds <- cbind(newdata, preds)\n#lengthen data frame to handle multinomial\npreds <- preds %>%\n  dplyr::select(-subject) %>% #marginalize over subject and q\n  pivot_longer(\n  cols = !pretty_condition,\n  values_to = \"preds\",\n  names_to = \"drawing_type\",\n)\n\n(p <- preds %>%\n  group_by(pretty_condition, drawing_type ) %>%\n  dplyr::summarise(\n    median = median(preds),\n    se = sd(preds)/sqrt(n()),\n    lwr = median - 1.96*se,\n    upr = median + 1.96*se))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 25 × 6\n# Groups:   pretty_condition [5]\n   pretty_condition drawing_type               median    se      lwr      upr\n   <fct>            <chr>                       <dbl> <dbl>    <dbl>    <dbl>\n 1 control          Linear Model             9.83e- 2     0 9.83e- 2 9.83e- 2\n 2 control          Scatterplot              1.64e- 2     0 1.64e- 2 1.64e- 2\n 3 control          Triangular               5.57e- 1     0 5.57e- 1 5.57e- 1\n 4 control          Triangular (asymmetric)  4.92e- 2     0 4.92e- 2 4.92e- 2\n 5 control          Triangular (right angle) 2.79e- 1     0 2.79e- 1 2.79e- 1\n 6 text:what        Linear Model             1.10e- 8     0 1.10e- 8 1.10e- 8\n 7 text:what        Scatterplot              2.17e-10     0 2.17e-10 2.17e-10\n 8 text:what        Triangular               8.47e- 1     0 8.47e- 1 8.47e- 1\n 9 text:what        Triangular (asymmetric)  5.08e- 2     0 5.08e- 2 5.08e- 2\n10 text:what        Triangular (right angle) 1.02e- 1     0 1.02e- 1 1.02e- 1\n# … with 15 more rows\n```\n:::\n\n```{.r .cell-code}\n##DRAWS METHOD\n# GENERATE draws from model\n# draws <- df_i %>%\n#   data_grid(pretty_condition, subject, q) %>% \n#   add_fitted_draws(Bmm.cat.CrSQ,\n#                    # n = 100,\n#                    # dpar = TRUE,\n#                    # transform = TRUE, #gives prob%, otherwise OR\n#                    re_formula = NA)\n# # draws %>% write_rds(file = \"analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds\")\n# \n# #OR load from file\n# # draws <- read_rds(file = \"analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds\")\n# \n# # SUMMARIZE draws from model\n# (k <- kable(draws %>%\n#   dplyr::select(pretty_condition, .category, .value) %>%\n#   group_by(pretty_condition, .category) %>%\n#   median_hdci(.value), digits = 4, col.names =\n#     c(\"Condition\",\"Category\", \"Probability\",\"Lower Cred.I\",\"Upper Cred.I\", \"CI Width\", \"Point Type\", \"Interval Type\")) %>%\n#   kable_styling())\n```\n:::\n\n\n##### INFERENCE\n\n\n##### Visualize\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\n# plot_model(m, vline.color = \"red\", \n#            show.intercept = TRUE, \n#            show.values = TRUE,\n#            p.threshold = 0.1, #manually adjust to account for directional test\n#            ci.lvl = 0.90 ) + #manually adjusted for directional test   \n#   labs(title = \"Model Estimate | Odds Ratio\",\n#        subtitle = \"\",\n#        x = \"Condition\")\n\n\n#EASYSTATS | MODEL | ODDS RATIO\nresult <- model_parameters(m, exponentiate = TRUE, component = \"all\")\nplot(result, show_intercept = TRUE, show_labels = TRUE) \n```\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-BRMS-STATE-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# + theme_clean()\n\n\n## | PLOT PREDICTIONS\n\n#SJPLOT | MODEL | PROBABILITIES\nplot_model(m, type=\"eff\",\n           show.intercept = TRUE,\n           show.values = TRUE,\n           title = \"Model Prediction | Probability of Drawing Type\",\n           axis.title = c(\"Condition\",\"Probability of Drawing Type\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$pretty_condition\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc2_hypotesting_files/figure-html/VIS-BRMS-STATE-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE\n##WORKING\n# https://mjskay.github.io/ggdist/reference/stat_slab.html\n## VIS probability of correct response\n#TAKES A REALLY LONG TIME\n\n#1 | get draws\n# draws <- df_i %>%\n#   data_grid(pretty_condition, ospan_split, subject, q) %>%\n#   add_epred_draws(m,\n#                    # ndraws = 100, # n = 100,\n#                    # dpar = TRUE,\n#                    transform = TRUE, #gives prob%, otherwise OR\n#                    re_formula = NA)\n# # draws %>% write_rds(file = \"analysis/SGC3A/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds\")\n# \n# #OR load from file\n# # draws <- read_rds(file = \"analysis/SGC3A/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds\")\n# \n# #2| VISUALIZE PREDICTIONS | GGDIST\n# ##TODO figure out height normalization.\n# ##do it with much smaller number of draws \n# #TODO adjust bandwidth/smoothing? + put on same line + \n# #TAKES A REAAALY LONG TIME\n# # d <- \n# \n# d <- draws %>% sample_n(10) %>% \n#   ggplot(aes(x = .epred,  y = pretty_condition, fill = ospan_split)) +\n#   stat_slab(width = c(.95), alpha = 0.5, normalize=\"xy\") +\n#   facet_wrap(~.category) +\n#   #   #normalize = all, panels, xy, groups, none\n#   xlim(0,1) + labs(\n#     title = \"Model Predicted Probability of Correct Response\",\n#     x = \"probability of correct response\",\n#     y = \"Interpretation\"\n#   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()\n# # # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()\n# # # \n# # # ggsave(d, filename = \"figures/sgc3a_BBm.cat.CrSQ_lab_posterior.svg\", width = 6, height =4)\n# d\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#DISPLAY MODEL AS TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"4\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">draw type</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Response</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.02&nbsp;&ndash;&nbsp;1.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.098</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Scatterplot</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>what</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12&nbsp;&ndash;&nbsp;0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Scatterplot</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>how</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09&nbsp;&ndash;&nbsp;44.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.661</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Scatterplot</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg *<br>static</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00&nbsp;&ndash;&nbsp;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Scatterplot</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg * ixv</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.18&nbsp;&ndash;&nbsp;199.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.315</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Scatterplot</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.67</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.37&nbsp;&ndash;&nbsp;13.55</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>what</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">13653497.95</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6883935.96&nbsp;&ndash;&nbsp;27080148.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>how</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.66&nbsp;&ndash;&nbsp;12.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.163</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg *<br>static</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.32&nbsp;&ndash;&nbsp;3.38</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.957</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg * ixv</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">10.06</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.15&nbsp;&ndash;&nbsp;87.88</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.037</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.50</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12&nbsp;&ndash;&nbsp;2.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.328</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (asymmetric)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>what</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9282527.20</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3013413.27&nbsp;&ndash;&nbsp;28593924.39</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (asymmetric)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>how</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.33</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.45&nbsp;&ndash;&nbsp;24.63</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.237</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (asymmetric)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg *<br>static</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.18&nbsp;&ndash;&nbsp;7.34</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.888</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (asymmetric)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg * ixv</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">13.99</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.12&nbsp;&ndash;&nbsp;174.30</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.040</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (asymmetric)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.83</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.11&nbsp;&ndash;&nbsp;7.22</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.029</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (right angle)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>what</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3276712.70</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1422488.59&nbsp;&ndash;&nbsp;7547931.30</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (right angle)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditiontext *<br>how</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.06</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.21&nbsp;&ndash;&nbsp;5.30</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.945</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (right angle)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg *<br>static</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.50</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.13&nbsp;&ndash;&nbsp;1.94</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.318</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (right angle)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pretty conditionimg * ixv</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.71</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.05&nbsp;&ndash;&nbsp;9.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.791</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">Triangular (right angle)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"4\">316</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">0.071 / 0.067</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m, \"(log odds)\" = m)\n# notes = list('\"* p < 0.05, ** p < 0.01, *** p < 0.001\"',\n#                'N(subject) = 133 $\\tau_{00}$(subject) = 34.85',\n#              'N(question) = 13 $\\tau_{00}$(question) = 1.14')\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',\n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_online.tex\")\n# # #              # coef_omit = \"Intercept\",\n#TODO OUTPUT TABLE \n\n#https://arelbundock.com/posts/modelsummary_multinomial_logit/\n# modelsummary(m)\n```\n:::\n\n\n\n\n\n\n\n\n## DIAGRAMS 2018 PUBLICATION ANALYSIS\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}