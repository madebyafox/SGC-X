{
  "hash": "010c6b49d0c7eb9776ba4be99286ad32",
  "result": {
    "markdown": "---\nsubtitle: 'Study SGC3B | (Impasse * Explicit) Hypothesis Testing'\n# YAML FOR generating modelsummary tables\n# uncomment to run those  cells only \n# \\usepackage{booktabs}\n# \\usepackage{siunitx}\n# \\newcolumntype{d}{S[input-symbols = ()]}\n---\n\n\\newpage\n\n# SGC3B (Impasse * Explicit) Hypothesis Testing {#sec-SGC3B-hypotesting}\n\n*The purpose of this notebook is test the hypotheses that determined the design of the SGC3B factorial study.*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#UTILITIES\nlibrary(Hmisc) # %nin% operator\nlibrary(broom) #tidy model output\nlibrary(broom.mixed) #tidy mixed models\nlibrary(mosaic) #favstats\nlibrary(svglite) #saving plots as svg\nlibrary(distributional)\n\n#VISUALIZATION\n# library(ggpubr) #arrange plots\n# library(cowplot) #arrange shift function plots\nlibrary(ggformula) #easy graphs\n# # library(vcd) #mosaic plots\n# # library(vcdExtra) #mosaic plots\nlibrary(kableExtra) #printing tables\nlibrary(sjPlot) #visualize model coefficients\nlibrary(ggdist) #uncertainty viz\nlibrary(modelr) #needed for ggdist\nlibrary(gghalves) # plots. in half\nlibrary(ggbeeswarm) # violin plot stuffs\nlibrary(statsExpressions)\nlibrary(ggstatsplot) #plots with stats\nlibrary(modelsummary) #latex tables for models!\n\n#MODELLING\nlibrary(ARTool) #nonparametric anova\n# library(rstatix) #helpful testing functions incl wilcoxon, etc\nlibrary(report) #easystats reporting\nlibrary(see) #easystats visualization\nlibrary(performance) #easystats model diagnostics\nlibrary(parameters) #easystats model summary and vis\n# library(qqplotr) #confint on qq plot\n# library(gmodels) #contingency table and CHISQR\n# library(equatiomatic) #extract model equation\n# library(pscl) #zeroinfl / hurdle models \nlibrary(lme4) #mixed effects models\nlibrary(lmerTest) #for CIs in glmer\nlibrary(merTools) #predictInterval\n# library(ggeffects) #visualization log regr models\n#MULTINOMIAL \nlibrary(nnet) #multinomial logistic regression [not mixed] #no p values\nlibrary(mclogit) #frequentist mixed multinomial logistic regression [mblogit] #gives p values\n#BAYESIAN\nlibrary(cmdstanr) #executing stan\nlibrary(brms) #bayesian mixed multinomials [+ other bayesian reg models]\nlibrary(bayestestR) \nlibrary(tidybayes)\n\nlibrary(tidyverse) #ALL THE THINGS\n\n#OUTPUT OPTIONS\nlibrary(dplyr, warn.conflicts = FALSE)\noptions(dplyr.summarise.inform = FALSE)\noptions(ggplot2.summarise.inform = FALSE)\noptions(scipen=1, digits=3)\n\n#GRAPH THEMEING\n# theme_set(theme_minimal()) \n\n# Custom ggplot theme to make pretty plots\n# Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed\ntheme_clean <- function() {\n  theme_minimal(base_family = \"Barlow Semi Condensed\") +\n    theme(panel.grid.minor = element_blank(),\n          plot.title = element_text(family = \"BarlowSemiCondensed-Bold\"),\n          axis.title = element_text(family = \"BarlowSemiCondensed-Medium\"),\n          strip.text = element_text(family = \"BarlowSemiCondensed-Bold\",\n                                    size = rel(1), hjust = 0),\n          strip.background = element_rect(fill = \"grey80\", color = NA))\n}\n\nset_theme(base = theme_clean())\n```\n:::\n\n**TODO UPDATE Research Questions**\n\n\n**Experimental Hypothesis**\\\n\n\n\n**Null Hypothesis**\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#IMPORT DATA \n\ndf_subjects <- read_rds('analysis/SGC3B/data/2-scored-data/sgc3b_scored_participants.rds') %>% \n  # filter(mode == \"lab-synch\") %>% #filter out online sgc3as \n  mutate(\n  task_percent = DV_percent_NABS\n) %>% droplevels()\n\n#SEPARATE OUT EXTRA ONLINE FROM SGC3A\nfactorial <- df_subjects %>% filter(condition %nin% c(111,121))\nmains <- df_subjects %>% filter(condition %in% c(111,121) & mode == \"lab-synch\")\ndf_subjects <- rbind(factorial,mains) %>% \n  mutate(\n    EXPLICIT = as.factor(str_sub(condition, 1,1)),\n    IMPLICIT = as.factor(str_sub(condition, 2,2)),\n    EXPLICIT = recode_factor(EXPLICIT, \"1\" = \"none\", \"2\"=\"img\", \"3\"=\"ixn\"),\n    IMPLICIT = recode_factor(IMPLICIT, \"1\" = \"control\", \"2\"=\"impasse\")\n  ) %>% \n  mutate( pretty_condition = recode_factor(condition, \n          \"111\" = \"none-control\", \"121\" =  \"none-impasse\",\n          \"211\" = \"img-control\", \"221\" =  \"img-impasse\",\n          \"311\" = \"ixv-control\", \"321\" =  \"ixv-impasse\")\n  ) \n\ndf_items <- read_rds('analysis/SGC3B/data/2-scored-data/sgc3b_scored_items.rds') %>% \n   mutate (\n    q = as.factor(q), \n    subject = as.factor(subject),\n    accuracy = recode_factor(score_niceABS, \"0\" =\"incorrect\",\"1\"=\"correct\"),\n    # CODES TVERSKY AS TRI-LIKE\n    # state = recode_factor(score_SCALED, #for ordinal\n    #                      \"-1\" = \"orth-like\",\n    #                      \"-0.5\" = \"unknown\",\n    #                      \"0\" = \"unknown\",\n    #                      \"0.5\" = \"tri-like\",\n    #                      \"1\" = \"tri-like\"),\n    # CODES TVERSKY AS OTHER\n    state = recode_factor(score_SCALED, #for ordinal\n                         \"-1\" = \"orthogonal\",\n                         \"-0.5\" = \"other\",\n                         \"0\" = \"other\",\n                         \"0.5\" = \"angular\",\n                         \"1\" = \"triangular\"),\n    state = as.ordered(state),\n    EXPLICIT = as.factor(str_sub(condition, 1,1)),\n  IMPLICIT = as.factor(str_sub(condition, 2,2)),\n  EXPLICIT = recode_factor(EXPLICIT, \"1\" = \"none\", \"2\"=\"img\", \"3\"=\"ixn\"),\n  IMPLICIT = recode_factor(IMPLICIT, \"1\" = \"control\", \"2\"=\"impasse\")) %>% \n    mutate( pretty_condition = recode_factor(condition, \n          \"111\" = \"none-control\", \"121\" =  \"none-impasse\",\n          \"211\" = \"img-control\", \"221\" =  \"img-impasse\",\n          \"311\" = \"ixv-control\", \"321\" =  \"ixv-impasse\")\n  )\n```\n:::\n\n## SAMPLE\n\n### Data Collection\n\nData was collected ... \n\n::: {.cell}\n\n```{.r .cell-code}\ntitle = \"Participants by Condition and Data Collection Period\"\ncols = c(\"Control Condition\",\"Impasse Condition\", \"Control+Img\", \"Impasse + Img\", \"Control + IXN\", \"Impasse + IXN\", \"Total for Period\")\ncont <- table(df_subjects$term, df_subjects$pretty_condition)\ncont %>% addmargins() %>% kbl(caption = title, col.names = cols) %>%  kable_classic()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Participants by Condition and Data Collection Period</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Control Condition </th>\n   <th style=\"text-align:right;\"> Impasse Condition </th>\n   <th style=\"text-align:right;\"> Control+Img </th>\n   <th style=\"text-align:right;\"> Impasse + Img </th>\n   <th style=\"text-align:right;\"> Control + IXN </th>\n   <th style=\"text-align:right;\"> Impasse + IXN </th>\n   <th style=\"text-align:right;\"> Total for Period </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> fall17 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 174 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> spring18 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 37 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 116 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> fall21 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> summer22 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sum </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 64 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 373 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\ntable(df_subjects$IMPLICIT, df_subjects$EXPLICIT)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         \n          none img ixn\n  control   62  62  62\n  impasse   64  62  61\n```\n:::\n:::\n\n### Participants\n\n::: {.cell}\n\n```{.r .cell-code}\n#Describe participants\nsubject.stats <-df_subjects %>% dplyr::select(age) %>% unlist() %>% favstats()\nsubject.stats$percent.male <- ((df_subjects %>% filter(gender==\"Male\") %>% count())/count(df_subjects))$n\nsubject.stats$percent.female <- ((df_subjects %>% filter(gender==\"Female\") %>% count())/count(df_subjects))$n\nsubject.stats$percent.other <- ((df_subjects %>% filter(gender %nin% c(\"Female\",\"Male\")) %>% count())/count(df_subjects))$n\n\n\ntitle = \"Descriptive Statistics of Participant Age and Gender\"\nsubject.stats %>% kbl (caption = title) %>% kable_classic()%>% \n  footnote(general = \"Age in Years\", \n           general_title = \"Note: \",footnote_as_chunk = T) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;'>\n<caption>Descriptive Statistics of Participant Age and Gender</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n   <th style=\"text-align:right;\"> percent.male </th>\n   <th style=\"text-align:right;\"> percent.female </th>\n   <th style=\"text-align:right;\"> percent.other </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 66 </td>\n   <td style=\"text-align:right;\"> 21.6 </td>\n   <td style=\"text-align:right;\"> 5.55 </td>\n   <td style=\"text-align:right;\"> 373 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.389 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> Age in Years</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n**Overall** 373 participants (39 % male, 60 % female, 2 % other)  undergraduate STEM majors at a public American University participated in exchange for course credit (age: 18 - 66 years).\n\n\n\n\n\n\n## H1A \\| OVERALL ACCURACY\n\n+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Research Question     | Do Ss in the IMPASSE condition score higher across the entire task than those in the CONTROL group?                                                                                                                                                                                |\n+=======================+====================================================================================================================================================================================================================================================================================+\n| **Hypothesis**        | (H1) Participants in the IMPASSE condition will be more likely to correctly interpret the graph than those in the CONTROL condition.                                                                                                                                               |\n+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Data**              | **data**: `df_items` where `q nin 6,9` (the 13 discriminating Qs ), `df_subjects`                                                                                                                                                                                                  |\n|                       |                                                                                                                                                                                                                                                                                    |\n|                       | **outcome**:                                                                                                                                                                                                                                                                       |\n|                       |                                                                                                                                                                                                                                                                                    |\n|                       | -   \\[at item level\\] : *accuracy* ( factor(incorrect/correct) from `score_niceABS` \\[absolute score\\]                                                                                                                                                                             |\n|                       | -   \\[subject level\\]: accuracy (number of test phase qs correct from total `s_NABS`)                                                                                                                                                                                              |\n|                       |                                                                                                                                                                                                                                                                                    |\n|                       | **predictor**: `condition` \\[between-subjects factor\\]                                                                                                                                                                                                                             |\n+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Analysis Strategy** | 1.  Wilcoxon-Rank Sum (Mann-Whitney) test on subject-level total accuracy of test phase (`s_NABS`)                                                                                                                                                                                 |\n|                       | 2.  Mixed Logistic Regression\\                                                                                                                                                                                                                                                     |\n|                       |     `accuracy` \\~ `condition` + (1 \\| `subject` ) + (1 \\| `question`)\\                                                                                                                                                                                                             |\n|                       |     model effect of condition on probability of correct response \\[during test phase\\] while accounting for subject (and item-level?) effects                                                                                                                                      |\n+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Alternatives**      | -   Ordinal Mixed Logistic Regression on `scaled_score`                                                                                                                                                                                                                            |\n|                       | -   OLS Linear Regression: bimodal distribution at tails makes the mean a poor predictor; LMs violate assumptions of normally distributed residuals; both absolute and scaled scores yield non-normal residuals; no transformation of the outcome variables yield normal residuals |\n+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Notes**             | **Also exploring:**                                                                                                                                                                                                                                                                |\n|                       |                                                                                                                                                                                                                                                                                    |\n|                       | -   Hurdle model (mixture model w/ binomial + \\[poisson or negbinom count; 0s from 1 DGP)                                                                                                                                                                                          |\n|                       | -   Zero Inflated model (mixture model w/ binomial + poisson or negbinom count; 0s from 2 DGPs)                                                                                                                                                                                    |\n|                       | -   Beta regression hurdle model? (mixture with location and scale parameters \\[mean, variance\\] and hurdles for floor and ceiling effects)                                                                                                                                        |\n|                       | -   Other way to account for the severe bimodality?                                                                                                                                                                                                                                |\n+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n#### Setup\n::: {.cell}\n\n```{.r .cell-code}\ndf_i = df_items %>% filter(q %nin% c(6,9)) %>% \n  dplyr::select(pretty_condition, condition, accuracy, subject,q, IMPLICIT, EXPLICIT)\n\ndf_s <- df_subjects %>% \n  dplyr::select(pretty_condition, condition, task_percent, IMPLICIT, EXPLICIT)\n```\n:::\n\n#### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED PROPORTIONAL BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = IMPLICIT,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  facet_grid(~EXPLICIT) + \n  scale_fill_brewer(palette = \"Set1\")  +\n   labs(title = \"Overall Accuracy\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"Impasse Condition yields a greater proportion of correct responses for HIGH WM\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/DESC-ACC-FACTORIAL-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART BY QUESTION\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(~ q ) +\n   labs(title = \"Accuracy by Question\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"Q6 and Q9 are non-discriminative\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/DESC-ACC-FACTORIAL-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: FACETED HISTOGRAM\nstats = df_s %>% group_by(IMPLICIT, EXPLICIT) %>% dplyr::summarise(mean = mean(task_percent))\ngf_props(~task_percent,\n         fill = ~pretty_condition, data = df_s) %>%\n  gf_facet_grid(IMPLICIT~EXPLICIT) %>%\n  gf_vline(data = stats, xintercept = ~mean, color = \"red\") +\n  labs(x = \"% Correct\",\n       y = \"proportion of subjects\",\n       title = \"Overall Absolute Score (% Correct)\",\n       subtitle = \"\") + theme(legend.position = \"blank\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/DESC-ACC-FACTORIAL-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#TODO   \np <- grouped_ggbetweenstats(data = df_s,\n                       y = task_percent, x = IMPLICIT, grouping.var = EXPLICIT,\n               plot.type = \"box\", type = \"nonparametric\", var.equal = FALSE,\n               centrality.type = \"parametric\",\n               package = \"RColorBrewer\",\n               palette = \"PRGn\",\n               centrality.point.args = list(color=\"black\", size = 3, shape = 1),\n               # point.args = list(alpha=0), #suppress points\n               ggplot.component = ## modify further with `{ggplot2}` functions\n                list(\n                  # aes(color = IMPLICIT, fill = IMPLICIT),\n                  # scale_colour_manual(values = paletteer::paletteer_c(\"viridis::viridis\", 3)),\n                  # scale_fill_manual(values = paletteer::paletteer_c(\"viridis::viridis\", 3))\n                  # theme(axis.text.x = element_text(angle = 90)\n                )) \n\np[[1]] + coord_flip() + p[[2]] + coord_flip() + p[[3]] + coord_flip()\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# # ggplot(data = df_s, aes( x = pretty_condition, y = task_percent)) + \n#   ggdist::stat_halfeye(\n#     alpha = 0.7,\n#     point_colour = NA,\n#     adjust = .5,\n#     width = .5, .width = 0,\n#     justification = -.5) +\n#   geom_boxplot(\n#     alpha = 0.1,\n#     width = .2,\n#     outlier.shape = NA\n#   ) +\n#   geom_point(\n#     size = 2,\n#     alpha = .5,\n#     position = position_jitter(\n#       seed = 1, width = .05, height = .02\n#     )\n#   ) \n# coord_flip() + theme_clean() + theme(legend.position = \"blank\")\n# p$layers[[3]]=NULL #remove default boxplot\n# e <- statsExpressions::two_sample_test(y = task_percent, x = pretty_condition, data = df_s,\n#                                 type = \"nonparametric\", alternative = \"less\",\n#                                 var.equal = FALSE)\n# #labels are layer 4\n# p + labs(title = \"Distribution of Total Accuracy\",\n#          y = \"Proportion of correct responses across task\", x = \"\",\n#          subtitle = \"Impasse condition yields higher scores and greater variance\",\n#          caption=e$expression[[1]])\n```\n:::\n\n\n\n\n### Describe\n::: {.cell}\n\n```{.r .cell-code}\ntitle = \"Descriptive Statistics of Response Accuracy (Total % Correct)\"\ntbl1 <- mosaic::favstats(~task_percent, data = df_s) \ntbl1 %>% kbl (caption = title) %>% kable_classic()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Descriptive Statistics of Response Accuracy (Total % Correct)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n   <td style=\"text-align:right;\"> 0.846 </td>\n   <td style=\"text-align:right;\"> 0.923 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.614 </td>\n   <td style=\"text-align:right;\"> 0.397 </td>\n   <td style=\"text-align:right;\"> 373 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\ntitle = \"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION\"\ntbl2 <- mosaic::favstats(task_percent ~ pretty_condition, data = df_s) \ntbl2 %>% kbl (caption = title) %>% kable_classic()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> pretty_condition </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> none-control </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.211 </td>\n   <td style=\"text-align:right;\"> 0.370 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> none-impasse </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.346 </td>\n   <td style=\"text-align:right;\"> 0.846 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.425 </td>\n   <td style=\"text-align:right;\"> 0.389 </td>\n   <td style=\"text-align:right;\"> 64 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> img-control </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.308 </td>\n   <td style=\"text-align:right;\"> 0.769 </td>\n   <td style=\"text-align:right;\"> 0.923 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.620 </td>\n   <td style=\"text-align:right;\"> 0.371 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> img-impasse </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.635 </td>\n   <td style=\"text-align:right;\"> 0.923 </td>\n   <td style=\"text-align:right;\"> 0.923 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.777 </td>\n   <td style=\"text-align:right;\"> 0.278 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ixv-control </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.769 </td>\n   <td style=\"text-align:right;\"> 0.923 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.819 </td>\n   <td style=\"text-align:right;\"> 0.273 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ixv-impasse </td>\n   <td style=\"text-align:right;\"> 0.077 </td>\n   <td style=\"text-align:right;\"> 0.846 </td>\n   <td style=\"text-align:right;\"> 0.923 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.841 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\nAcross conditions, overall accuracy on the task ranges from 0 to 100 with a mean of 61.394. We see that the distribution of this outcome variable is clearly bimodal: with modes near the floor (0% correct) and ceiling (100% correct) of the scale. This bimodality is sensical considering the nature of the task, where each item in the task indexes a different information extraction operation over the same coordinate system.\n\nA score of 100% indicates that the participant correctly interpreted the interval-coordinate system throughout the task, *starting at the first question*. A score of 0% indicates the individual *never* correctly interpreted the coordinate system. A score somewhere inbetween indicates that an individual deciphered the coordinate system *sometime over the course the task*.\n\n#### TESTS\n\n##### Aligned Ranks Transformation\n<!-- https://rcompanion.org/handbook/F_16.html -->\n::: {.cell}\n\n```{.r .cell-code}\nm.art = art(task_percent ~ IMPLICIT*EXPLICIT, data = df_s)\nanova(m.art)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance of Aligned Rank Transformed Data\n\nTable Type: Anova Table (Type III tests) \nModel: No Repeated Measures (lm)\nResponse: art(task_percent)\n\n                    Df Df.res F value Pr(>F)    \n1 IMPLICIT           1    367 17.6390  3e-05 ***\n2 EXPLICIT           2    367 71.3269 <2e-16 ***\n3 IMPLICIT:EXPLICIT  2    367  5.8892  0.003  **\n---\nSignif. codes:   0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n```\n:::\n:::\n\n##### Kruskal Wallis Test\n::: {.cell}\n\n```{.r .cell-code}\n(k <- kruskal.test(df_s$task_percent ~ df_s$pretty_condition))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  df_s$task_percent by df_s$pretty_condition\nKruskal-Wallis chi-squared = 107, df = 5, p-value <2e-16\n```\n:::\n:::\n\n##### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STATSPLOT | VIOLIN\ngrouped_ggbetweenstats(y = task_percent, x = EXPLICIT, grouping.var = IMPLICIT,  \n               data = df_s, type = \"nonparametric\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/TEST-VIZ-ACC-1.png){width=672}\n:::\n\n```{.r .cell-code}\ngrouped_ggbetweenstats(y = task_percent, x = IMPLICIT, grouping.var = EXPLICIT,  \n               data = df_s, type = \"nonparametric\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/TEST-VIZ-ACC-2.png){width=672}\n:::\n:::\n\n\n#### MIXED LOGISTIC REGRESSION \n\n*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.*\n\n##### Fit Model\n\n::: {.cell}\n\n```{.r .cell-code}\n## 0 | SETUP\n#confirm 13 items [all discriminating items]\nnrow(df_i) / nrow(df_s) == 13\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n#confirm all factors \nis.factor(df_i$q) && is.factor(df_i$subject) && is.factor(df_i$pretty_condition) && is.factor(df_i$accuracy) && is.factor(df_i$ospan_split)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\n## 1 | SETUP RANDOM INTERCEPT SUBJECT\n\n#:: EMPTY MODEL (baseline, no random effect)\nprint(\"Empty fixed model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Empty fixed model\"\n```\n:::\n\n```{.r .cell-code}\nm0 = glm(accuracy ~ 1, family = \"binomial\", data = df_i) \n# summary(m0)\n\n#:: RANDOM INTERCEPT SUBJECT\nprint(\"Subject intercept random model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Subject intercept random model\"\n```\n:::\n\n```{.r .cell-code}\nmm.rS <- glmer(accuracy ~ (1|subject), data = df_i, family = \"binomial\")\n# summary(mm.rS)\n\n# :: TEST random effect\npaste(\"AIC decreases w/ new model?\", m0$aic > AIC(logLik(mm.rS)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model? TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(m0,mm.rS) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName  |    Model | df | df_diff |    Chi2 |      p\n--------------------------------------------------\nm0    |      glm |  1 |         |         |       \nmm.rS | glmerMod |  2 |       1 | 2794.94 | < .001\n```\n:::\n\n```{.r .cell-code}\npaste(\"Likelihood Ratio test is significant? p = \",(test_lrt(m0,mm.rS))$p[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Likelihood Ratio test is significant? p =  0\"\n```\n:::\n\n```{.r .cell-code}\n#:: RANDOM INTERCEPT SUBJECT + ITEM\nprint(\"Subject Intercept + Item intercept random model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Subject Intercept + Item intercept random model\"\n```\n:::\n\n```{.r .cell-code}\nmm.rSQ <- glmer(accuracy ~ (1|subject) + (1|q), data = df_i, family = \"binomial\")\n#summary(mm.rSQ)\n\n# :: TEST random effect\npaste(\"AIC decreases w/ new model?\", AIC(logLik(mm.rS)) > AIC(logLik(mm.rSQ)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model? TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.rS, mm.rSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSome of the nested models seem to be identical and probably only vary in\n  their random effects.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName   |    Model | df | df_diff |   Chi2 |      p\n--------------------------------------------------\nmm.rS  | glmerMod |  2 |         |        |       \nmm.rSQ | glmerMod |  3 |       1 | 216.39 | < .001\n```\n:::\n\n```{.r .cell-code}\npaste(\"Likelihood Ratio test is significant? p = \",(test_lrt(mm.rS, mm.rSQ))$p[2])\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSome of the nested models seem to be identical and probably only vary in\n  their random effects.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Likelihood Ratio test is significant? p =  5.55558295248529e-49\"\n```\n:::\n\n```{.r .cell-code}\n## 2 | ADD MAIN EFFECTS \n\nprint(\"MAIN FIXED  implicit*explicit + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"MAIN FIXED  implicit*explicit + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.IErSQ <- glmer(accuracy ~ IMPLICIT + EXPLICIT + (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\")\n# car::Anova(mm.IErSQ, type = 3)\n\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.rSQ)) > AIC(logLik(mm.IErSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.rSQ,mm.IErSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName     |    Model | df | df_diff |   Chi2 |      p\n----------------------------------------------------\nmm.rSQ   | glmerMod |  3 |         |        |       \nmm.IErSQ | glmerMod |  6 |       3 | 153.73 | < .001\n```\n:::\n\n```{.r .cell-code}\npaste(\"Likelihood Ratio test is significant? p = \",(test_lrt(mm.rSQ,mm.IErSQ))$p[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Likelihood Ratio test is significant? p =  4.1389548127204e-33\"\n```\n:::\n\n```{.r .cell-code}\n## 2 | ADD IXN FIXED EFFECT\n\nprint(\"MAIN IXN implicit*explicit + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"MAIN IXN implicit*explicit + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.I.ErSQ <- glmer(accuracy ~ IMPLICIT*EXPLICIT + (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\")\ncar::Anova(mm.I.ErSQ, type = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: accuracy\n                  Chisq Df Pr(>Chisq)    \n(Intercept)        43.9  1    3.5e-11 ***\nIMPLICIT           19.3  1    1.1e-05 ***\nEXPLICIT           95.2  2    < 2e-16 ***\nIMPLICIT:EXPLICIT   8.1  2      0.017 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.IErSQ)) > AIC(logLik(mm.I.ErSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.I.ErSQ,mm.IErSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName      |    Model | df | df_diff | Chi2 |     p\n--------------------------------------------------\nmm.I.ErSQ | glmerMod |  8 |         |      |      \nmm.IErSQ  | glmerMod |  6 |      -2 | 8.20 | 0.017\n```\n:::\n\n```{.r .cell-code}\npaste(\"Likelihood Ratio test is significant? p = \",(test_lrt(mm.I.ErSQ,mm.IErSQ))$p[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Likelihood Ratio test is significant? p =  0.0165804173438411\"\n```\n:::\n:::\n\n\n##### Describe\n\n::: {.cell}\n\n```{.r .cell-code}\n# best model\nm <- mm.I.ErSQ\n\n#::::::::: PRINT MODEL \n\nprint(\"PREDICTOR MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PREDICTOR MODEL\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: accuracy ~ IMPLICIT * EXPLICIT + (1 | subject) + (1 | q)\n   Data: df_i\n\n     AIC      BIC   logLik deviance df.resid \n    3311     3363    -1647     3295     4841 \n\nScaled residuals: \n   Min     1Q Median     3Q    Max \n-5.503 -0.140  0.110  0.297  7.569 \n\nRandom effects:\n Groups  Name        Variance Std.Dev.\n subject (Intercept) 9.390    3.06    \n q       (Intercept) 0.672    0.82    \nNumber of obs: 4849, groups:  subject, 373; q, 13\n\nFixed effects:\n                            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                   -3.704      0.559   -6.63  3.5e-11 ***\nIMPLICITimpasse                2.865      0.653    4.39  1.1e-05 ***\nEXPLICITimg                    4.632      0.668    6.93  4.2e-12 ***\nEXPLICITixn                    6.813      0.707    9.64  < 2e-16 ***\nIMPLICITimpasse:EXPLICITimg   -1.435      0.885   -1.62   0.1050    \nIMPLICITimpasse:EXPLICITixn   -2.591      0.912   -2.84   0.0045 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n                       (Intr) IMPLICITm EXPLICITm EXPLICITx\nIMPLICITmps            -0.699                              \nEXPLICITimg            -0.705  0.590                       \nEXPLICITixn            -0.697  0.578     0.592             \nIMPLICITmpss:EXPLICITm  0.505 -0.730    -0.729    -0.413   \nIMPLICITmpss:EXPLICITx  0.497 -0.713    -0.419    -0.721   \n                       IMPLICITmpss:EXPLICITm\nIMPLICITmps                                  \nEXPLICITimg                                  \nEXPLICITixn                                  \nIMPLICITmpss:EXPLICITm                       \nIMPLICITmpss:EXPLICITx  0.521                \n```\n:::\n\n```{.r .cell-code}\nprint(\"SIGNIFICANCE TEST [non directional]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"SIGNIFICANCE TEST [non directional]\"\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m, type=3) #TYPE 3 SS FOR IXNS\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: accuracy\n                  Chisq Df Pr(>Chisq)    \n(Intercept)        43.9  1    3.5e-11 ***\nIMPLICIT           19.3  1    1.1e-05 ***\nEXPLICIT           95.2  2    < 2e-16 ***\nIMPLICIT:EXPLICIT   8.1  2      0.017 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#:::::::: INTERPRET COEFFICIENTS\n\npaste(\"LOG ODDS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"LOG ODDS\"\n```\n:::\n\n```{.r .cell-code}\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 9\n  effect   group term  estimate std.error statistic   p.value conf.low conf.high\n  <chr>    <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 fixed    <NA>  (Int…   -3.70      0.559     -6.63  3.47e-11    -4.80    -2.61 \n2 fixed    <NA>  IMPL…    2.87      0.653      4.39  1.14e- 5     1.59     4.14 \n3 fixed    <NA>  EXPL…    4.63      0.668      6.93  4.20e-12     3.32     5.94 \n4 fixed    <NA>  EXPL…    6.81      0.707      9.64  5.49e-22     5.43     8.20 \n5 fixed    <NA>  IMPL…   -1.44      0.885     -1.62  1.05e- 1    -3.17     0.300\n6 fixed    <NA>  IMPL…   -2.59      0.912     -2.84  4.50e- 3    -4.38    -0.804\n7 ran_pars subj… sd__…    3.06     NA         NA    NA           NA       NA    \n8 ran_pars q     sd__…    0.820    NA         NA    NA           NA       NA    \n```\n:::\n\n```{.r .cell-code}\npaste(\"ODDS RATIOS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ODDS RATIOS\"\n```\n:::\n\n```{.r .cell-code}\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\", exponentiate = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 9\n  effect   group term  estimate std.error statistic   p.value conf.low conf.high\n  <chr>    <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 fixed    <NA>  (Int…   0.0246    0.0138     -6.63  3.47e-11  8.23e-3    0.0737\n2 fixed    <NA>  IMPL…  17.5      11.5         4.39  1.14e- 5  4.88e+0   63.1   \n3 fixed    <NA>  EXPL… 103.       68.7         6.93  4.20e-12  2.77e+1  381.    \n4 fixed    <NA>  EXPL… 910.      643.          9.64  5.49e-22  2.28e+2 3635.    \n5 fixed    <NA>  IMPL…   0.238     0.211      -1.62  1.05e- 1  4.20e-2    1.35  \n6 fixed    <NA>  IMPL…   0.0750    0.0684     -2.84  4.50e- 3  1.26e-2    0.448 \n7 ran_pars subj… sd__…   3.06     NA          NA    NA        NA         NA     \n8 ran_pars q     sd__…   0.820    NA          NA    NA        NA         NA     \n```\n:::\n\n```{.r .cell-code}\npaste(\"PROBABILITIES\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PROBABILITIES\"\n```\n:::\n\n```{.r .cell-code}\n#probability control = plogis(intercept)\n#probability impasse = plogis(intercept + coefficient)\n\n#FROM predict()\n# newdata <- df_i %>% dplyr::select(pretty_condition, subject, q)\n# preds <- predict(m, newdata = newdata, type = \"response\")\n# preds <- cbind(newdata, preds)\n# p <- preds %>% \n#   dplyr::select(pretty_condition, preds) %>% \n#   group_by(pretty_condition) %>% \n#   summarise(\n#     median = median(preds),\n#     se = sd(preds)/sqrt(n()),\n#     lwr = median - 1.96*se,\n#     upr = median + 1.96*se)\n    \n  \n#FROM merTools\n#setup df \nnewdata <- df_i %>% dplyr::select(IMPLICIT, EXPLICIT, subject, q)\n#make predictions\npreds <- predictInterval(m, newdata = newdata,\n                              which = \"fixed\", #full, fixed or random for those only\n                              type = \"probability\", #linear.prediction\n                              stat = \"median\",\n                              n.sims = 1000,\n                              level = 0.80) #width of prediction interval\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: executing %dopar% sequentially: no parallel backend registered\n```\n:::\n\n```{.r .cell-code}\n#join predictions to the new dataframe\npreds <- cbind(newdata, preds)\n#summarize\n(summ_preds <- preds %>% \n  dplyr::select(IMPLICIT, EXPLICIT, fit, lwr, upr) %>% \n  group_by(IMPLICIT,EXPLICIT) %>% \n  summarise(\n    median = median(fit),\n    lower = median(lwr),\n    upper = median(upr)\n  )) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n# Groups:   IMPLICIT [2]\n  IMPLICIT EXPLICIT median   lower  upper\n  <fct>    <fct>     <dbl>   <dbl>  <dbl>\n1 control  none     0.0240 0.00570 0.0956\n2 control  img      0.718  0.381   0.913 \n3 control  ixn      0.957  0.842   0.989 \n4 impasse  none     0.303  0.0959  0.641 \n5 impasse  img      0.913  0.717   0.978 \n6 impasse  ixn      0.968  0.875   0.992 \n```\n:::\n:::\n\n##### Inference TODO UPDATE\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">accuracy</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.02</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01&nbsp;&ndash;&nbsp;0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">17.55</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.88&nbsp;&ndash;&nbsp;63.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">102.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">27.72&nbsp;&ndash;&nbsp;380.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">909.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">227.60&nbsp;&ndash;&nbsp;3634.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04&nbsp;&ndash;&nbsp;1.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.105</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01&nbsp;&ndash;&nbsp;0.45</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.004</strong></td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">3.29</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">9.39</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.67</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.75</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">373</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">13</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">4849</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.318 / 0.832</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m1, \"(log odds)\" = m1)\n# notes = list(\"* p < 0.05, ** p < 0.01, *** p < 0.001\",\n#              '$sigma^{2}$ = 3.29\" N(subject) = 126 $\\tau_{00}$(subject) = 22.22 N(question) = 13 $\\tau_{00}$(question) = 0.31'\n#                )\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', \n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex\")\n# #              # coef_omit = \"Intercept\",\n# \n# \n# \n```\n:::\n\n##### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\nplot_model(m, vline.color = \"red\", \n           show.intercept = TRUE, \n           show.values = TRUE,\n           p.threshold = 0.1, #manually adjust to account for directional test\n           ci.lvl = 0.90 ) + #manually adjusted for directional test   \n  labs(title = \"Model Estimate | Odds Ratio\",\n       subtitle = \"\",\n       x = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#EASYSTATS | MODEL | ODDS RATIO\nresult <- model_parameters(m, exponentiate = TRUE, component = \"all\")\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-2.png){width=672}\n:::\n\n```{.r .cell-code}\n## | PLOT TESTS\n\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-3.png){width=672}\n:::\n\n```{.r .cell-code}\n## | PLOT TESTS\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-4.png){width=672}\n:::\n\n```{.r .cell-code}\n#ONLY FOR BAYESIAN VERSION\n# result <- rope(m)\n# plot(result)\n# \n# result <- pd(m)\n# plot(result)\n\n\n## | PLOT PREDICTIONS\n\n#SJPLOT | MODEL | PROBABILITIES\nplot_model(m, type=\"int\",\n           show.intercept = TRUE,\n           show.values = TRUE,\n           title = \"Model Prediction | Probability of Accurate Response\",\n           axis.title = c(\"Condition\",\"Probability of Accurate Response\"))\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-5.png){width=672}\n:::\n\n```{.r .cell-code}\n#PLOT MODEL PREDICTION\nplot_model(m, type = \"pred\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$IMPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n$EXPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-7.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_model(m, type = \"eff\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$IMPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-8.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n$EXPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-ACC-9.png){width=672}\n:::\n\n```{.r .cell-code}\n  # ylim(0,1) + \n  # labs(\n  #   title = \"Model Prediction | Probability of Accurate Response\",\n  #   subtitle = \"Impasse increases Probability of Correct Response\"\n  # )\n\n#TODO EMMEANS for the estimated marginal means OR USE IXN PLOT\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">accuracy</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.02</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01&nbsp;&ndash;&nbsp;0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">17.55</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.88&nbsp;&ndash;&nbsp;63.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">102.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">27.72&nbsp;&ndash;&nbsp;380.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">909.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">227.60&nbsp;&ndash;&nbsp;3634.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04&nbsp;&ndash;&nbsp;1.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.105</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01&nbsp;&ndash;&nbsp;0.45</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.004</strong></td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">3.29</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">9.39</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.67</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.75</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">373</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">13</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">4849</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.318 / 0.832</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m, \"(log odds)\" = m)\n# notes = list('\"* p < 0.05, ** p < 0.01, *** p < 0.001\"',\n#                'N(subject) = 133 $\\tau_{00}$(subject) = 34.85',\n#              'N(question) = 13 $\\tau_{00}$(question) = 1.14')\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',\n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_online.tex\")\n# # #              # coef_omit = \"Intercept\",\n```\n:::\n\n##### Diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\n# print(\"SANITY CHECK REPORTING\")\n# report(m)\n\n# print(\"MODEL PERFORMANCE\")\n# performance(m)\n\nprint(\"DIAGNOSTICS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"DIAGNOSTICS\"\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-DIAG-ACC-1.png){width=672}\n:::\n:::\n\n## H1A \\| OVERALL INTERPRETATION STATE\n\n**Do Ss in the IMPASSE condition offer less-orthogonal interpretations across the test phase questions?**\n\nWhile absolute accuracy score tells us whether a participant successfully interpreted the coordinate system, it doesn't allow us to differentiate between different kinds of incorrect interpretations. Here we examine the (categorical) interpretation state type based on the nature of subject's response, and determine if these interpretations differ by experimental condition. State is a 3-category variable that groups the following interpretations:\n\n-   **\"orthogonal\"** \\[reference category\\] includes orthogonal and satisficing responses ==\\> indicates a primarily *orthogonal* state of coordinate system understanding\n\n-   **\"other\"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =\\> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular\n\n-   **\"angular\"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =\\> indicates some degree of angular/triangular coordinate understanding\n\n-   **\"triangular\"** includes correct triangular and 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =\\> indicates some degree of angular/triangular coordinate understanding\n\n+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+\n| Research Question     | Does Ss in the impasse condition produce less orthogonal responses across questions?                                          |\n+=======================+=================================================================================================================================================+\n| **Hypothesis**        | H1A \\| Ss in the IMPASSE condition will have a higher likelihood of producing unknown and triangle-like response states across all items |\n+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Data**              | -   data: `df_items` where `q nin 6,9` (13 discriminant test phase items)                                                              |\n|                       | -   outcome: `state` ( 3 level factor from high_interpretation )                                                                                |\n|                       | -   predictor: `condition` \\[between-subjects factor\\]                                                                                          |\n+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Analysis Strategy** | 1.  MIXED Multinomial (Logistic) Regression on state predicted by condition                                                                     |\n|                       |                                                                                                                                                 |\n|                       | Alternative:                                                                                                                                    |\n|                       |                                                                                                                                                 |\n|                       | -   MIXED Ordinal regression on state (doesn't meet proportional odds assumption-I think)                                                       |\n|                       | -   MIXED Multinomial or Ordinal regression on high_interpretation (some cells are 0, produces problems)                                        |\n+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+\n\n\n#### Setup\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_i = df_items %>% filter(q %nin% c(6,9)) %>% dplyr::select(pretty_condition, q,subject,state,IMPLICIT, EXPLICIT) %>% droplevels()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = EXPLICIT,\n                       fill = state)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(~IMPLICIT) +\n   labs(title = \"Interpretation across all Questions\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = IMPLICIT,\n                       fill = state)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(~EXPLICIT) +\n   labs(title = \"Interpretation across all Questions\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-19-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = EXPLICIT,\n                       fill = state)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(q ~ IMPLICIT) +\n   labs(title = \"Interpretation by Question\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-19-3.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#::::::::::::DESCRIPTIVES\n\ntable(df_i$state, df_i$pretty_condition) %>% addmargins(2) %>% #display sum for row\n      prop.table(margin=2) %>%  #return proportion (of column)\n      addmargins(1) #sanity check sum of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            \n             none-control none-impasse img-control img-impasse ixv-control\n  orthogonal       0.6960       0.3281      0.2531      0.0620      0.1129\n  other            0.0682       0.1839      0.0844      0.1042      0.0459\n  angular          0.0248       0.0625      0.0409      0.0533      0.0223\n  triangular       0.2109       0.4255      0.6216      0.7804      0.8189\n  Sum              1.0000       1.0000      1.0000      1.0000      1.0000\n            \n             ixv-impasse    Sum\n  orthogonal      0.0593 0.2528\n  other           0.0517 0.0903\n  angular         0.0454 0.0417\n  triangular      0.8436 0.6152\n  Sum             1.0000 1.0000\n```\n:::\n\n```{.r .cell-code}\n(t <- table(df_i$state, df_i$EXPLICIT, df_i$IMPLICIT) %>% addmargins(2) %>% #display sum for row\n      addmargins(1)) #sanity check sum of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, ,  = control\n\n            \n             none  img  ixn  Sum\n  orthogonal  561  204   91  856\n  other        55   68   37  160\n  angular      20   33   18   71\n  triangular  170  501  660 1331\n  Sum         806  806  806 2418\n\n, ,  = impasse\n\n            \n             none  img  ixn  Sum\n  orthogonal  273   50   47  370\n  other       153   84   41  278\n  angular      52   43   36  131\n  triangular  354  629  669 1652\n  Sum         832  806  793 2431\n```\n:::\n:::\n\n#### MIXED MULTINOMIAL REGRESSION\n\n\n*Does condition affect the response state of of items across the task?*\n\n*Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).*\n\n\n##### Fit Model \\[brms\\]\n\n::: {.cell}\n\n```{.r .cell-code}\n# to set priors... create model with default priors\n# then run prior_summary to see what the defaults are and syntax for coefficients\n# prior_summary(flat)\n# then create lists with the new priors, and create a new model with the priors \n\ninf_priors <- c(\n  #prior on INTERCEPTS \n  #25% chance of each answer in control, scale = from 0.01 to 62%\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muangular\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muother\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"mutriangular\"),\n  \n  #prior on CONDITION COEFFICIENT\n  #likely to change odds between 0 and 2.4\n    \n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionimgMcontrol\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionimgMimpasse\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionixvMcontrol\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionixvMimpasse\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionnoneMimpasse\", dpar = \"muother\"),\n  \n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionimgMcontrol\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionimgMimpasse\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionixvMcontrol\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionixvMimpasse\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionnoneMimpasse\", dpar = \"muangular\"),\n  \n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionimgMcontrol\", dpar = \"mutriangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionimgMimpasse\", dpar = \"mutriangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionixvMcontrol\", dpar = \"mutriangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionixvMimpasse\", dpar = \"mutriangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"pretty_conditionnoneMimpasse\", dpar = \"mutriangular\")\n)\n\nme_priors <- c(\n  #prior on INTERCEPTS \n  #25% chance of each answer in control, scale = from 0.01 to 62%\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muangular\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muother\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"mutriangular\"),\n  \n  #prior on IMPLICIT COEFFICIENT\n  #likely to change odds between 0 and 2.4\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse\", dpar = \"mutriangular\"),\n  \n  #prior on EXPLICIT COEFFICIENT\n  #likely to change odds between 0 and 2.4\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITimg\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITimg\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITimg\", dpar = \"mutriangular\"),\n  \n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITixn\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITixn\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITixn\", dpar = \"mutriangular\")\n)\n\nixn_priors <- c(\n  #prior on INTERCEPTS \n  #25% chance of each answer in control, scale = from 0.01 to 62%\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muangular\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muother\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"mutriangular\"),\n  \n  #prior on IMPLICIT COEFFICIENT\n  #likely to change odds between 0 and 2.4\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse\", dpar = \"mutriangular\"),\n  \n  #prior on EXPLICIT COEFFICIENT\n  #likely to change odds between 0 and 2.4\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITimg\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITimg\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITimg\", dpar = \"mutriangular\"),\n  \n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITixn\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITixn\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"EXPLICITixn\", dpar = \"mutriangular\"),\n  \n  #prior on IXN COEFFICIENT\n  #likely to change odds between 0 and 2.4\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse:EXPLICITimg\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse:EXPLICITimg\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse:EXPLICITimg\", dpar = \"mutriangular\"),\n  \n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse:EXPLICITixn\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse:EXPLICITixn\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"IMPLICITimpasse:EXPLICITixn\", dpar = \"mutriangular\")\n)\n\n#BAYESIAN RANDOM ONLY\nBmm.cat.rSQ <- brm( state ~ 1 + (1|subject) + (1|q), \n                 data = df_i, \n                 family = \"categorical\",\n                 chains = 4, iter = 2500, warmup = 1000,\n                 cores = 4, seed = 1234,\n                 save_pars = save_pars(all = TRUE),\n                 # backend = \"cmdstanr\",\n                 file =\"analysis/SGC3B/models/sgc3b_brms_state_Bmm.cat.rSQ.rds\")\n\n# CONDITION (unravelled, not fatorial) EQUAL ONLY MODEL\nBmm.cat.CrSQ <- brm( state ~ pretty_condition + (1|subject) + (1|q), \n                 data = df_i, \n                 prior = inf_priors,\n                 family = \"categorical\",\n                 chains = 4, iter = 2000, warmup = 1000,\n                 cores = 4, seed = 1234,\n                 save_pars = save_pars(all = TRUE),\n                 control = list(adapt_delta = 0.98),  # to deal with divergent transitions\n                 backend = \"cmdstanr\",\n                 file =\"analysis/SGC3B/models/sgc3b_brms_state_Bmm.cat.CrSQ.rds\")\n\n##MODEL COMPARISON\n# print(\"MODEL COMPARISON: random effects (vs) CONDITION\")\n# bayesfactor(Bmm.cat.rSQ, Bmm.cat.CrSQ)\n#substantial evidence in favor of conditon model over random only BF 1.64e+16\n\n# CONDITION * OSPAN MODEL\nBmm.cat.IErSQ  <- brm( state ~ IMPLICIT + EXPLICIT + (1|subject) + (1|q), \n                 data = df_i, \n                 prior = me_priors,\n                 family = \"categorical\",\n                 chains = 4, iter = 2000, warmup = 1000,\n                 cores = 4, seed = 1234,\n                 save_pars = save_pars(all = TRUE),\n                 control = list(adapt_delta = 0.98),  # to deal with divergent transitions\n                 # backend = \"cmdstanr\",\n                 file =\"analysis/SGC3B/models/sgc3b_brms_state_Bmm.cat.IErSQ.rds\")\n\n\n\n# CONDITION * OSPAN MODEL\nBmm.cat.I.ErSQ  <- brm( state ~ IMPLICIT*EXPLICIT + (1|subject) + (1|q), \n                 data = df_i, \n                 prior = ixn_priors,\n                 family = \"categorical\",\n                 chains = 4, iter = 2500, warmup = 1000,\n                 cores = 4, seed = 1234,\n                 save_pars = save_pars(all = TRUE),\n                 control = list(adapt_delta = 0.98),  # to deal with divergent transitions\n                 # backend = \"cmdstanr\",\n                 file =\"analysis/SGC3B/models/sgc3b_brms_state_Bmm.cat.I.ErSQ.rds\")\n\n\n##MODEL COMPARISON\nprint(\"IS FACTORIAL better than MAIN EFFECTS model?\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"IS FACTORIAL better than MAIN EFFECTS model?\"\n```\n:::\n\n```{.r .cell-code}\nbayesfactor(Bmm.cat.I.ErSQ, Bmm.cat.IErSQ)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Bayes factors might not be precise.\nFor precise Bayes factors, sampling at least 40,000 posterior samples is recommended.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nComputation of Bayes factors: estimating marginal likelihood, please wait...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: logml could not be estimated within maxiter, rerunning with adjusted starting value. \nEstimate might be more variable than usual.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: logml could not be estimated within maxiter, rerunning with adjusted starting value. \nEstimate might be more variable than usual.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nBayes Factors for Model Comparison\n\n    Model                                                BF\n[2] IMPLICIT + EXPLICIT + (1 | subject) + (1 | q) 4.33e+120\n\n* Against Denominator: [1] IMPLICIT * EXPLICIT + (1 | subject) + (1 | q)\n*   Bayes Factor Type: marginal likelihoods (bridgesampling)\n```\n:::\n\n```{.r .cell-code}\ncompare_models(Bmm.cat.I.ErSQ, Bmm.cat.IErSQ)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muangular_IMPLICITimpasse:EXPLICITixn and b_muangular_EXPLICITixn (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nParameter                                |       Bmm.cat.I.ErSQ |        Bmm.cat.IErSQ\n--------------------------------------------------------------------------------------\nmuother_Intercept                        | -3.06 (-3.95, -2.25) | -2.84 (-3.68, -2.06)\nmuangular_Intercept                      | -4.57 (-5.74, -3.41) | -4.49 (-5.59, -3.47)\nmutriangular_Intercept                   | -3.02 (-4.16, -1.93) | -2.83 (-3.92, -1.84)\nmuother_IMPLICITimpasse                  |  2.30 ( 1.73,  2.88) |  1.93 ( 1.54,  2.36)\nmuother_EXPLICITimg                      |  1.57 ( 0.96,  2.21) |  1.41 ( 0.98,  1.89)\nmuother_EXPLICITixn                      |  1.84 ( 1.13,  2.57) |  1.18 ( 0.67,  1.68)\nmuangular_IMPLICITimpasse                |  2.17 ( 1.34,  3.02) |  2.10 ( 1.52,  2.68)\nmuangular_EXPLICITimg                    |  1.93 ( 1.05,  2.87) |  1.85 ( 1.19,  2.51)\nmuangular_EXPLICITixn                    |  1.93 ( 0.88,  2.99) |  1.91 ( 1.23,  2.62)\nmutriangular_IMPLICITimpasse             |  2.63 ( 1.42,  3.78) |  2.30 ( 1.58,  3.08)\nmutriangular_EXPLICITimg                 |  4.20 ( 2.96,  5.43) |  4.22 ( 3.28,  5.16)\nmutriangular_EXPLICITixn                 |  6.36 ( 5.14,  7.61) |  5.73 ( 4.76,  6.79)\nmuangular_IMPLICITimpasse:EXPLICITixn    | -0.20 (-1.59,  1.16) |                     \nmutriangular_IMPLICITimpasse:EXPLICITixn | -1.34 (-3.02,  0.36) |                     \nmuother_IMPLICITimpasse:EXPLICITimg      | -0.26 (-1.15,  0.67) |                     \nmuother_IMPLICITimpasse:EXPLICITixn      | -1.36 (-2.42, -0.37) |                     \nmutriangular_IMPLICITimpasse:EXPLICITimg |  0.09 (-1.56,  1.77) |                     \nmuangular_IMPLICITimpasse:EXPLICITimg    | -0.17 (-1.38,  1.06) |                     \n--------------------------------------------------------------------------------------\nObservations                             |                 4849 |                 4849\n```\n:::\n:::\n\n##### Describe\n\n::: {.cell}\n\n```{.r .cell-code}\n# best model\nm <- Bmm.cat.I.ErSQ\n\n#::::::::: PRINT MODEL \n\nprint(\"PREDICTOR MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PREDICTOR MODEL\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: categorical \n  Links: muother = logit; muangular = logit; mutriangular = logit \nFormula: state ~ IMPLICIT * EXPLICIT + (1 | subject) + (1 | q) \n   Data: df_i (Number of observations: 4849) \n  Draws: 4 chains, each with iter = 2500; warmup = 1000; thin = 1;\n         total post-warmup draws = 6000\n\nGroup-Level Effects: \n~q (Number of levels: 13) \n                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nsd(muother_Intercept)          1.36      0.33     0.87     2.15 1.00     2461\nsd(muangular_Intercept)        1.68      0.44     1.04     2.75 1.00     2371\nsd(mutriangular_Intercept)     1.19      0.29     0.78     1.92 1.00     2321\n                           Tail_ESS\nsd(muother_Intercept)          3697\nsd(muangular_Intercept)        3766\nsd(mutriangular_Intercept)     3852\n\n~subject (Number of levels: 373) \n                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nsd(muother_Intercept)          1.11      0.12     0.88     1.35 1.00     2221\nsd(muangular_Intercept)        1.58      0.18     1.24     1.96 1.00     2193\nsd(mutriangular_Intercept)     3.36      0.21     2.97     3.79 1.00     1945\n                           Tail_ESS\nsd(muother_Intercept)          3686\nsd(muangular_Intercept)        3675\nsd(mutriangular_Intercept)     3460\n\nPopulation-Level Effects: \n                                         Estimate Est.Error l-95% CI u-95% CI\nmuother_Intercept                           -3.07      0.43    -3.95    -2.25\nmuangular_Intercept                         -4.57      0.60    -5.74    -3.41\nmutriangular_Intercept                      -3.03      0.56    -4.16    -1.93\nmuother_IMPLICITimpasse                      2.30      0.30     1.73     2.88\nmuother_EXPLICITimg                          1.58      0.32     0.96     2.21\nmuother_EXPLICITixn                          1.84      0.37     1.13     2.57\nmuother_IMPLICITimpasse:EXPLICITimg         -0.26      0.46    -1.15     0.67\nmuother_IMPLICITimpasse:EXPLICITixn         -1.37      0.52    -2.42    -0.37\nmuangular_IMPLICITimpasse                    2.18      0.43     1.34     3.02\nmuangular_EXPLICITimg                        1.94      0.47     1.05     2.87\nmuangular_EXPLICITixn                        1.93      0.53     0.88     2.99\nmuangular_IMPLICITimpasse:EXPLICITimg       -0.18      0.62    -1.38     1.06\nmuangular_IMPLICITimpasse:EXPLICITixn       -0.21      0.69    -1.59     1.16\nmutriangular_IMPLICITimpasse                 2.63      0.61     1.42     3.78\nmutriangular_EXPLICITimg                     4.20      0.63     2.96     5.43\nmutriangular_EXPLICITixn                     6.36      0.64     5.14     7.61\nmutriangular_IMPLICITimpasse:EXPLICITimg     0.10      0.85    -1.56     1.77\nmutriangular_IMPLICITimpasse:EXPLICITixn    -1.34      0.86    -3.02     0.36\n                                         Rhat Bulk_ESS Tail_ESS\nmuother_Intercept                        1.00     1769     2895\nmuangular_Intercept                      1.00     1945     2830\nmutriangular_Intercept                   1.00     1575     3016\nmuother_IMPLICITimpasse                  1.00     3197     4077\nmuother_EXPLICITimg                      1.00     4010     4863\nmuother_EXPLICITixn                      1.00     3622     4471\nmuother_IMPLICITimpasse:EXPLICITimg      1.00     3492     4315\nmuother_IMPLICITimpasse:EXPLICITixn      1.00     3238     3904\nmuangular_IMPLICITimpasse                1.00     3505     4288\nmuangular_EXPLICITimg                    1.00     3321     4185\nmuangular_EXPLICITixn                    1.00     4057     4557\nmuangular_IMPLICITimpasse:EXPLICITimg    1.00     3668     4610\nmuangular_IMPLICITimpasse:EXPLICITixn    1.00     3742     4443\nmutriangular_IMPLICITimpasse             1.00     1648     2908\nmutriangular_EXPLICITimg                 1.00     1430     2451\nmutriangular_EXPLICITixn                 1.00     1801     2982\nmutriangular_IMPLICITimpasse:EXPLICITimg 1.00     1548     2657\nmutriangular_IMPLICITimpasse:EXPLICITixn 1.00     1335     2895\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n\n```{.r .cell-code}\n(d <- describe_posterior(ci=.95, m))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muangular_IMPLICITimpasse:EXPLICITixn and b_muangular_EXPLICITixn (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nSummary of Posterior Distribution\n\nParameter                                | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS\n-------------------------------------------------------------------------------------------------------------------------\nmuother_Intercept                        |  -3.06 | [-3.95, -2.25] |   100% | [-0.18, 0.18] |        0% | 1.005 | 1760.00\nmuangular_Intercept                      |  -4.57 | [-5.74, -3.41] |   100% | [-0.18, 0.18] |        0% | 1.003 | 1939.00\nmutriangular_Intercept                   |  -3.02 | [-4.16, -1.93] |   100% | [-0.18, 0.18] |        0% | 1.002 | 1570.00\nmuother_IMPLICITimpasse                  |   2.30 | [ 1.73,  2.88] |   100% | [-0.18, 0.18] |        0% | 1.001 | 3203.00\nmuother_EXPLICITimg                      |   1.57 | [ 0.96,  2.21] |   100% | [-0.18, 0.18] |        0% | 1.001 | 4001.00\nmuother_EXPLICITixn                      |   1.84 | [ 1.13,  2.57] |   100% | [-0.18, 0.18] |        0% | 1.001 | 3568.00\nmuother_IMPLICITimpasse:EXPLICITimg      |  -0.26 | [-1.15,  0.67] | 71.73% | [-0.18, 0.18] |    27.60% | 1.001 | 3486.00\nmuother_IMPLICITimpasse:EXPLICITixn      |  -1.36 | [-2.42, -0.37] | 99.73% | [-0.18, 0.18] |        0% | 1.000 | 3206.00\nmuangular_IMPLICITimpasse                |   2.17 | [ 1.34,  3.02] |   100% | [-0.18, 0.18] |        0% | 1.001 | 3486.00\nmuangular_EXPLICITimg                    |   1.93 | [ 1.05,  2.87] |   100% | [-0.18, 0.18] |        0% | 1.001 | 3301.00\nmuangular_EXPLICITixn                    |   1.93 | [ 0.88,  2.99] |   100% | [-0.18, 0.18] |        0% | 1.000 | 4044.00\nmuangular_IMPLICITimpasse:EXPLICITimg    |  -0.17 | [-1.38,  1.06] | 60.80% | [-0.18, 0.18] |    23.81% | 1.001 | 3670.00\nmuangular_IMPLICITimpasse:EXPLICITixn    |  -0.20 | [-1.59,  1.16] | 61.93% | [-0.18, 0.18] |    21.26% | 1.001 | 3736.00\nmutriangular_IMPLICITimpasse             |   2.63 | [ 1.42,  3.78] |   100% | [-0.18, 0.18] |        0% | 1.002 | 1631.00\nmutriangular_EXPLICITimg                 |   4.20 | [ 2.96,  5.43] |   100% | [-0.18, 0.18] |        0% | 1.004 | 1410.00\nmutriangular_EXPLICITixn                 |   6.36 | [ 5.14,  7.61] |   100% | [-0.18, 0.18] |        0% | 1.001 | 1784.00\nmutriangular_IMPLICITimpasse:EXPLICITimg |   0.09 | [-1.56,  1.77] | 54.57% | [-0.18, 0.18] |    17.68% | 1.003 | 1528.00\nmutriangular_IMPLICITimpasse:EXPLICITixn |  -1.34 | [-3.02,  0.36] | 93.65% | [-0.18, 0.18] |     5.28% | 1.004 | 1303.00\n```\n:::\n\n```{.r .cell-code}\nprint(\"BAYES FACTOR [SIGNIFICANCE TEST]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"BAYES FACTOR [SIGNIFICANCE TEST]\"\n```\n:::\n\n```{.r .cell-code}\n#think of this like the anova(model) to get p values for each predictor\n#has to recompile the models with rstan. total drag\n(b <- bayesfactor(m))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSampling priors, please wait...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Bayes factors might not be precise.\nFor precise Bayes factors, sampling at least 40,000 posterior samples is recommended.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nBayes Factor (Savage-Dickey density ratio)\n\nParameter                                |       BF\n---------------------------------------------------\nmuother_Intercept                        | 3.71e+04\nmuangular_Intercept                      | 2.11e+06\nmutriangular_Intercept                   | 3.76e+04\nmuother_IMPLICITimpasse                  | 1.91e+06\nmuother_EXPLICITimg                      |   965.84\nmuother_EXPLICITixn                      | 1.76e+03\nmuother_IMPLICITimpasse:EXPLICITimg      |    0.228\nmuother_IMPLICITimpasse:EXPLICITixn      |     8.65\nmuangular_IMPLICITimpasse                | 4.24e+03\nmuangular_EXPLICITimg                    |   168.15\nmuangular_EXPLICITixn                    |    62.10\nmuangular_IMPLICITimpasse:EXPLICITimg    |    0.282\nmuangular_IMPLICITimpasse:EXPLICITixn    |    0.287\nmutriangular_IMPLICITimpasse             |   582.59\nmutriangular_EXPLICITimg                 | 1.41e+06\nmutriangular_EXPLICITixn                 | 3.16e+09\nmutriangular_IMPLICITimpasse:EXPLICITimg |    0.349\nmutriangular_IMPLICITimpasse:EXPLICITixn |     1.23\n\n* Evidence Against The Null: 0\n```\n:::\n\n```{.r .cell-code}\nprint(\"DESCRIBE POSTERIOR\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"DESCRIBE POSTERIOR\"\n```\n:::\n\n```{.r .cell-code}\n#:::::::: INTERPRET COEFFICIENTS\n\npaste(\"LOG ODDS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"LOG ODDS\"\n```\n:::\n\n```{.r .cell-code}\n(l <- describe_posterior(m))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muangular_IMPLICITimpasse:EXPLICITixn and b_muangular_EXPLICITixn (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nSummary of Posterior Distribution\n\nParameter                                | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS\n-------------------------------------------------------------------------------------------------------------------------\nmuother_Intercept                        |  -3.06 | [-3.95, -2.25] |   100% | [-0.18, 0.18] |        0% | 1.005 | 1760.00\nmuangular_Intercept                      |  -4.57 | [-5.74, -3.41] |   100% | [-0.18, 0.18] |        0% | 1.003 | 1939.00\nmutriangular_Intercept                   |  -3.02 | [-4.16, -1.93] |   100% | [-0.18, 0.18] |        0% | 1.002 | 1570.00\nmuother_IMPLICITimpasse                  |   2.30 | [ 1.73,  2.88] |   100% | [-0.18, 0.18] |        0% | 1.001 | 3203.00\nmuother_EXPLICITimg                      |   1.57 | [ 0.96,  2.21] |   100% | [-0.18, 0.18] |        0% | 1.001 | 4001.00\nmuother_EXPLICITixn                      |   1.84 | [ 1.13,  2.57] |   100% | [-0.18, 0.18] |        0% | 1.001 | 3568.00\nmuother_IMPLICITimpasse:EXPLICITimg      |  -0.26 | [-1.15,  0.67] | 71.73% | [-0.18, 0.18] |    27.60% | 1.001 | 3486.00\nmuother_IMPLICITimpasse:EXPLICITixn      |  -1.36 | [-2.42, -0.37] | 99.73% | [-0.18, 0.18] |        0% | 1.000 | 3206.00\nmuangular_IMPLICITimpasse                |   2.17 | [ 1.34,  3.02] |   100% | [-0.18, 0.18] |        0% | 1.001 | 3486.00\nmuangular_EXPLICITimg                    |   1.93 | [ 1.05,  2.87] |   100% | [-0.18, 0.18] |        0% | 1.001 | 3301.00\nmuangular_EXPLICITixn                    |   1.93 | [ 0.88,  2.99] |   100% | [-0.18, 0.18] |        0% | 1.000 | 4044.00\nmuangular_IMPLICITimpasse:EXPLICITimg    |  -0.17 | [-1.38,  1.06] | 60.80% | [-0.18, 0.18] |    23.81% | 1.001 | 3670.00\nmuangular_IMPLICITimpasse:EXPLICITixn    |  -0.20 | [-1.59,  1.16] | 61.93% | [-0.18, 0.18] |    21.26% | 1.001 | 3736.00\nmutriangular_IMPLICITimpasse             |   2.63 | [ 1.42,  3.78] |   100% | [-0.18, 0.18] |        0% | 1.002 | 1631.00\nmutriangular_EXPLICITimg                 |   4.20 | [ 2.96,  5.43] |   100% | [-0.18, 0.18] |        0% | 1.004 | 1410.00\nmutriangular_EXPLICITixn                 |   6.36 | [ 5.14,  7.61] |   100% | [-0.18, 0.18] |        0% | 1.001 | 1784.00\nmutriangular_IMPLICITimpasse:EXPLICITimg |   0.09 | [-1.56,  1.77] | 54.57% | [-0.18, 0.18] |    17.68% | 1.003 | 1528.00\nmutriangular_IMPLICITimpasse:EXPLICITixn |  -1.34 | [-3.02,  0.36] | 93.65% | [-0.18, 0.18] |     5.28% | 1.004 | 1303.00\n```\n:::\n\n```{.r .cell-code}\n# (tm <- tidy(m,   conf.int = TRUE))\n\npaste(\"ODDS RATIOS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ODDS RATIOS\"\n```\n:::\n\n```{.r .cell-code}\n(e <- model_parameters(m, exponentiate = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muangular_IMPLICITimpasse:EXPLICITixn and b_muangular_EXPLICITixn (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nParameter                                | Median |            95% CI |     pd | % in ROPE |  Rhat |     ESS\n------------------------------------------------------------------------------------------------------------\nmuother_Intercept                        |   0.05 | [  0.02,    0.11] |   100% |        0% | 1.005 | 1760.00\nmuangular_Intercept                      |   0.01 | [  0.00,    0.03] |   100% |        0% | 1.003 | 1939.00\nmutriangular_Intercept                   |   0.05 | [  0.02,    0.15] |   100% |        0% | 1.002 | 1570.00\nmuother_IMPLICITimpasse                  |   9.94 | [  5.65,   17.76] |   100% |        0% | 1.001 | 3203.00\nmuother_EXPLICITimg                      |   4.82 | [  2.60,    9.09] |   100% |        0% | 1.001 | 4001.00\nmuother_EXPLICITixn                      |   6.32 | [  3.08,   13.03] |   100% |        0% | 1.001 | 3568.00\nmuother_IMPLICITimpasse:EXPLICITimg      |   0.77 | [  0.32,    1.96] | 71.73% |    27.60% | 1.001 | 3486.00\nmuother_IMPLICITimpasse:EXPLICITixn      |   0.26 | [  0.09,    0.69] | 99.73% |        0% | 1.000 | 3206.00\nmuangular_IMPLICITimpasse                |   8.77 | [  3.83,   20.57] |   100% |        0% | 1.001 | 3486.00\nmuangular_EXPLICITimg                    |   6.92 | [  2.85,   17.60] |   100% |        0% | 1.001 | 3301.00\nmuangular_EXPLICITixn                    |   6.92 | [  2.41,   19.96] |   100% |        0% | 1.000 | 4044.00\nmuangular_IMPLICITimpasse:EXPLICITimg    |   0.84 | [  0.25,    2.90] | 60.80% |    23.81% | 1.001 | 3670.00\nmuangular_IMPLICITimpasse:EXPLICITixn    |   0.82 | [  0.20,    3.18] | 61.93% |    21.26% | 1.001 | 3736.00\nmutriangular_IMPLICITimpasse             |  13.83 | [  4.13,   43.88] |   100% |        0% | 1.002 | 1631.00\nmutriangular_EXPLICITimg                 |  66.94 | [ 19.39,  227.71] |   100% |        0% | 1.004 | 1410.00\nmutriangular_EXPLICITixn                 | 576.65 | [170.58, 2027.99] |   100% |        0% | 1.001 | 1784.00\nmutriangular_IMPLICITimpasse:EXPLICITimg |   1.09 | [  0.21,    5.85] | 54.57% |    17.68% | 1.003 | 1528.00\nmutriangular_IMPLICITimpasse:EXPLICITixn |   0.26 | [  0.05,    1.43] | 93.65% |     5.28% | 1.004 | 1303.00\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nUncertainty intervals (equal-tailed) and p-values (two-tailed) computed\n  using a MCMC distribution approximation.\n```\n:::\n\n```{.r .cell-code}\npaste(\"PROBABILITIES\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PROBABILITIES\"\n```\n:::\n\n```{.r .cell-code}\n#PREDICT METHOD\nnewdata <- df_i %>% dplyr::select(IMPLICIT, EXPLICIT, subject, q)\npreds <- predict(m, newdata = newdata, type = \"response\")\npreds <- cbind(newdata, preds)\n# lengthen data frame to handle multinomial\npreds <- preds %>%\n  dplyr::select(-subject, -q) %>% #marginalize over subject and q\n  pivot_longer(\n  cols = ! IMPLICIT & !EXPLICIT,\n  values_to = \"preds\",\n  names_to = \"state\",\n)\n\n(p <- preds %>%\n  group_by(IMPLICIT, EXPLICIT , state ) %>%\n  summarise(\n    median = median(preds),\n    se = sd(preds)/sqrt(n()),\n    lwr = median - 1.96*se,\n    upr = median + 1.96*se))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 24 × 7\n# Groups:   IMPLICIT, EXPLICIT [6]\n   IMPLICIT EXPLICIT state              median      se     lwr     upr\n   <fct>    <fct>    <chr>               <dbl>   <dbl>   <dbl>   <dbl>\n 1 control  none     P(Y = angular)    0.0102  0.00145 0.00732 0.0130 \n 2 control  none     P(Y = orthogonal) 0.855   0.0118  0.832   0.878  \n 3 control  none     P(Y = other)      0.0497  0.00309 0.0436  0.0557 \n 4 control  none     P(Y = triangular) 0.0315  0.0123  0.00748 0.0555 \n 5 control  img      P(Y = angular)    0.0144  0.00228 0.00995 0.0189 \n 6 control  img      P(Y = orthogonal) 0.129   0.00986 0.110   0.149  \n 7 control  img      P(Y = other)      0.0344  0.00420 0.0262  0.0426 \n 8 control  img      P(Y = triangular) 0.779   0.0128  0.753   0.804  \n 9 control  ixn      P(Y = angular)    0.00467 0.00160 0.00153 0.00780\n10 control  ixn      P(Y = orthogonal) 0.032   0.00685 0.0186  0.0454 \n# … with 14 more rows\n```\n:::\n\n```{.r .cell-code}\n##DRAWS METHOD\n# GENERATE draws from model\n# draws <- df_i %>%\n#   data_grid(pretty_condition, subject, q) %>% \n#   add_fitted_draws(Bmm.cat.CrSQ,\n#                    # n = 100,\n#                    # dpar = TRUE,\n#                    # transform = TRUE, #gives prob%, otherwise OR\n#                    re_formula = NA)\n# # draws %>% write_rds(file = \"analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds\")\n# \n# #OR load from file\n# # draws <- read_rds(file = \"analysis/SGC3A/models/draws/draws_BB.catCrSQ.rds\")\n# \n# # SUMMARIZE draws from model\n# (k <- kable(draws %>%\n#   dplyr::select(pretty_condition, .category, .value) %>%\n#   group_by(pretty_condition, .category) %>%\n#   median_hdci(.value), digits = 4, col.names =\n#     c(\"Condition\",\"Category\", \"Probability\",\"Lower Cred.I\",\"Upper Cred.I\", \"CI Width\", \"Point Type\", \"Interval Type\")) %>%\n#   kable_styling())\n```\n:::\n\n##### INFERENCE\n\n\n##### Visualize\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\n# plot_model(m, vline.color = \"red\",\n#            show.intercept = TRUE,\n#            show.values = TRUE,\n#            p.threshold = 0.1, #manually adjust to account for directional test\n#            ci.lvl = 0.90 ) + #manually adjusted for directional test\n#   labs(title = \"Model Estimate | Odds Ratio\",\n#        subtitle = \"\",\n#        x = \"Condition\")\n\n\n#EASYSTATS | MODEL | LOG ODDS RATIO\nresult <- model_parameters(m, exponentiate = FALSE, component = \"all\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muangular_IMPLICITimpasse:EXPLICITixn and b_muangular_EXPLICITixn (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.\n```\n:::\n\n```{.r .cell-code}\nplot(result, show_intercept = TRUE, show_labels = TRUE) \n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-BRMS-STATE-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#EASYSTATS | MODEL | ODDS RATIO\nresult <- model_parameters(m, exponentiate = TRUE, component = \"all\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muangular_IMPLICITimpasse:EXPLICITixn and b_muangular_EXPLICITixn (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.\n```\n:::\n\n```{.r .cell-code}\nplot(result, show_intercept = TRUE, show_labels = TRUE) \n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-BRMS-STATE-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# + theme_clean()\n\n## | PLOT TESTS\n\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muangular_IMPLICITimpasse:EXPLICITixn and b_muangular_EXPLICITixn (r = 0.72). This might lead to inappropriate results. See 'Details' in '?equivalence_test'.\n```\n:::\n\n```{.r .cell-code}\nplot(result)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.0694\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 10800 rows containing non-finite values (stat_density_ridges).\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-BRMS-STATE-3.png){width=672}\n:::\n\n```{.r .cell-code}\nresult <- rope(m)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muangular_IMPLICITimpasse:EXPLICITixn and b_muangular_EXPLICITixn (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.\n```\n:::\n\n```{.r .cell-code}\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-BRMS-STATE-4.png){width=672}\n:::\n\n```{.r .cell-code}\nresult <- pd(m) \nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-BRMS-STATE-5.png){width=672}\n:::\n\n```{.r .cell-code}\n## | PLOT PREDICTIONS\n\n#SJPLOT | MODEL | PROBABILITIES\nplot_model(m, type=\"int\",\n           show.intercept = TRUE,\n           show.values = TRUE,\n           title = \"Model Prediction | Probability of Accurate Response\",\n           axis.title = c(\"Condition\",\"Probability of Accurate Response\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-BRMS-STATE-6.png){width=672}\n:::\n\n```{.r .cell-code}\n#PLOT MODEL PREDICTION\n# plot_model(m, type = \"pred\")  \n# plot_model(m, type = \"eff\")  \n  # ylim(0,1) + \n  # labs(\n  #   title = \"Model Prediction | Probability of Accurate Response\",\n  #   subtitle = \"Impasse increases Probability of Correct Response\"\n  # )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE\n##WORKING\n# https://mjskay.github.io/ggdist/reference/stat_slab.html\n## VIS probability of correct response\n#TAKES A REALLY LONG TIME\n\n#1 | get draws\n# draws <- df_i %>%\n#   data_grid(pretty_condition, ospan_split, subject, q) %>%\n#   add_epred_draws(m,\n#                    # ndraws = 100, # n = 100,\n#                    # dpar = TRUE,\n#                    transform = TRUE, #gives prob%, otherwise OR\n#                    re_formula = NA)\n# draws %>% write_rds(file = \"analysis/SGC3A/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds\")\n\n#OR load from file\n# draws <- read_rds(file = \"analysis/SGC3A/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds\")\n\n#2| VISUALIZE PREDICTIONS | GGDIST\n##TODO figure out height normalization.\n##do it with much smaller number of draws \n#TODO adjust bandwidth/smoothing? + put on same line + \n#TAKES A REAAALY LONG TIME\n# d <- \n\n# d <- draws %>% sample_n(10) %>% \n#   ggplot(aes(x = .epred,  y = pretty_condition, fill = ospan_split)) +\n#   stat_slab(width = c(.95), alpha = 0.5, normalize=\"xy\") +\n#   facet_wrap(~.category) +\n#   #   #normalize = all, panels, xy, groups, none\n#   xlim(0,1) + labs(\n#     title = \"Model Predicted Probability of Correct Response\",\n#     x = \"probability of correct response\",\n#     y = \"Interpretation\"\n#   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()\n# # # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()\n# # # \n# # # ggsave(d, filename = \"figures/sgc3a_BBm.cat.CrSQ_lab_posterior.svg\", width = 6, height =4)\n# d\n\n\n#USING PREDS\n\npreds %>% \n  ggplot(aes (x = preds, y = EXPLICIT, fill = IMPLICIT)) +\n  stat_slab( normalize = \"xy\", alpha = 0.5) +\n  facet_grid(~ state)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#DISPLAY MODEL AS TABLE\ntab_model(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'bayes_R2' is not defined for unordered categorical models.\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"2\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">state: other</th>\n<th colspan=\"2\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">state: angular</th>\n<th colspan=\"2\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">state: triangular</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI (95%)</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI (95%)</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7\">CI (95%)</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00&nbsp;&ndash;&nbsp;0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.02&nbsp;&ndash;&nbsp;0.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">0.02&nbsp;&ndash;&nbsp;0.15</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT: impasse</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">8.77</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.83&nbsp;&ndash;&nbsp;20.57</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.94</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.65&nbsp;&ndash;&nbsp;17.76</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">13.83</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">4.13&nbsp;&ndash;&nbsp;43.88</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT: img</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.85&nbsp;&ndash;&nbsp;17.60</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.60&nbsp;&ndash;&nbsp;9.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">66.94</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">19.39&nbsp;&ndash;&nbsp;227.71</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT: ixn</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.41&nbsp;&ndash;&nbsp;19.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.08&nbsp;&ndash;&nbsp;13.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">576.65</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">170.58&nbsp;&ndash;&nbsp;2027.99</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICITimpasse:EXPLICITimg</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.84</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.25&nbsp;&ndash;&nbsp;2.90</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.77</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.32&nbsp;&ndash;&nbsp;1.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">0.21&nbsp;&ndash;&nbsp;5.85</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICITimpasse:EXPLICITixn</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.20&nbsp;&ndash;&nbsp;3.18</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.26</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09&nbsp;&ndash;&nbsp;0.69</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.26</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">0.05&nbsp;&ndash;&nbsp;1.43</td>\n</tr>\n<tr>\n<td colspan=\"7\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"6\">-0.08</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"6\">1.79</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"6\">-0.05</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>subject</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"6\">373</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>q</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"6\">13</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"6\">4849</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m, \"(log odds)\" = m)\n# notes = list('\"* p < 0.05, ** p < 0.01, *** p < 0.001\"',\n#                'N(subject) = 133 $\\tau_{00}$(subject) = 34.85',\n#              'N(question) = 13 $\\tau_{00}$(question) = 1.14')\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)',\n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_online.tex\")\n# # #              # coef_omit = \"Intercept\",\n#TODO OUTPUT TABLE \n\n#https://arelbundock.com/posts/modelsummary_multinomial_logit/\n# modelsummary(m)\n```\n:::\n\n##### Diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\n#CHECK Fit of posterior predictive to data\npp_check(m, ndraws=1000)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#CHECK posterior vs. priors\nresult <- estimate_density(m)\nplot(result, stack = FALSE, priors= TRUE)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-26-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#CHECK model\nplot(m)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-26-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-26-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-26-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-26-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-26-7.png){width=672}\n:::\n:::\n\n## H1B \\| Q1 ACCURACY\n\n\n\n#### Setup\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df_items %>% filter(q==1) %>% dplyr::select(accuracy, pretty_condition, IMPLICIT, EXPLICIT)\n```\n:::\n\n#### Describe \n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\ndf %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n   labs(#y = \"Correct Response on Q 1\",\n       title = \"Q1 Accuracy\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-Q1ACC-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\ndf %>% \n  ggplot(data = .,\n         mapping = aes(x = IMPLICIT,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(~EXPLICIT) +\n   labs(#y = \"Correct Response on Q 1\",\n       title = \"Q1 Accuracy\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-Q1ACC-2.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#::::::::::::DESCRIPTIVES\n\npaste(\"Proportions of Correct Responses by Condition\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Proportions of Correct Responses by Condition\"\n```\n:::\n\n```{.r .cell-code}\ntable(df$accuracy, df$pretty_condition) %>% addmargins(2) %>% #display sum for row\n      prop.table(margin=2) %>%  #return proportion (of column)\n      addmargins(1) #sanity check sum of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           \n            none-control none-impasse img-control img-impasse ixv-control\n  incorrect        0.839        0.703       0.677       0.371       0.355\n  correct          0.161        0.297       0.323       0.629       0.645\n  Sum              1.000        1.000       1.000       1.000       1.000\n           \n            ixv-impasse   Sum\n  incorrect       0.246 0.534\n  correct         0.754 0.466\n  Sum             1.000 1.000\n```\n:::\n\n```{.r .cell-code}\npaste(\"Number of Correct Responses by Condition\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Number of Correct Responses by Condition\"\n```\n:::\n\n```{.r .cell-code}\ntable(df$accuracy, df$IMPLICIT, df$EXPLICIT) %>% addmargins(2) %>% #display sum for row\n      addmargins(1) #sanity check sum of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, ,  = none\n\n           \n            control impasse Sum\n  incorrect      52      45  97\n  correct        10      19  29\n  Sum            62      64 126\n\n, ,  = img\n\n           \n            control impasse Sum\n  incorrect      42      23  65\n  correct        20      39  59\n  Sum            62      62 124\n\n, ,  = ixn\n\n           \n            control impasse Sum\n  incorrect      22      15  37\n  correct        40      46  86\n  Sum            62      61 123\n```\n:::\n:::\n\n#### TESTS\n\n::: {.cell}\n\n```{.r .cell-code}\n#CHI SQUARE ON ACCURACY X OSPAN-SPLIT in LOW WORKING MEMORY\n# df_low <- df %>% filter(ospan_split == \"low-memory\")\n# # table(df_low$pretty_condition, df_low$accuracy)\n# chisq.test( x = df_low$pretty_condition, y = df_low$accuracy, correct = TRUE)\n# \n# #CHI SQUARE ON ACCURACY X OSPAN-SPLIT in HIGH WORKING MEMORY\n# df_high <- df %>% filter(ospan_split == \"high-memory\")\n# #table(df_high$pretty_condition, df_high$accuracy)\n# chisq.test( x = df_high$pretty_condition, y = df_high$accuracy,correct = TRUE)\n# #significant if correct = FALSE\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# INTERACTION (IMPLICIT (VS) EXPLICIT)\ngrouped_ggbarstats( data = df, x = IMPLICIT, y = accuracy, \n                    grouping.var = EXPLICIT,\n                    type = \"nonparametric\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# MAIN EFFECT CONDITION (yes)\nggbarstats( data = df, x = accuracy, y = pretty_condition,\n                    type = \"nonparametric\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/unnamed-chunk-31-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# MAIN EFFECT OSPAN (none)\n# ggbarstats( data = df, x = accuracy, y = ospan_split, \n#                     type = \"nonparametric\")\n```\n:::\n\n\n\n\n#### LOGISTIC REGRESSION (MAIN EFFECT CONDITION)\n\nFit a logistic regression predicting accuracy (absolute score) (n = 373) by condition (k = 2).\\\n\n-   Parameter estimate: $\\beta_{0}$ = Log Odds of (correct) responses in CONTROL condition\n-   $e^{\\beta_{0}}$ = ODDS of correct response in CONTROL condition\n-   Parameter estimate: $\\beta_{1}$ = $\\beta_{1impasse}$ Log Odds (Log OR; change in odds for correct response in impasse (vs) control \\[log scale\\])\n-   $e^{\\beta_{1}}$ = ODDS RATIO of correct response in IMPASSE (vs) CONTROL\n-   **Null hypothesis**:$\\beta_{impasse} \\le 0$ the odds for a correct response does not change, or decreases\n-   **Alternative hypothesis:** $\\beta_{impasse} \\gt 0$ the odds of a correct response increases\n\n##### Fit CONDITION Model\n\n*First, we fit a logistic regression with condition as predictor, and compare its fit to an empty (intercept-only) model.*\n\n::: {.cell}\n\n```{.r .cell-code}\n# MODEL FITTING ::::::::\n\n#: 1 EMPTY MODEL baseline glm model intercept only\nm.0 = glm(accuracy ~ 1, data = df, family = \"binomial\")\n# print(\"EMPTY MODEL\")\n# summary(m0)\n\n#: 2 CONDITION model\nm.C <- glm( accuracy ~ pretty_condition, data = df, family = \"binomial\")\n# print(\"PREDICTOR MODEL\")\n# summary(m1)\n\n#: 2 TEST SUPERIOR FIT\npaste(\"AIC wth predictor is lower than empty model?\", m.0$aic > m.C$aic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC wth predictor is lower than empty model? TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(m.0,m.C) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName | Model | df | df_diff |  Chi2 |      p\n--------------------------------------------\nm.0  |   glm |  1 |         |       |       \nm.C  |   glm |  6 |       5 | 74.33 | < .001\n```\n:::\n\n```{.r .cell-code}\npaste(\"Likelihood Ratio test is significant? p = \",(test_lrt(m.0,m.C))$p[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Likelihood Ratio test is significant? p =  1.28060386240202e-14\"\n```\n:::\n\n```{.r .cell-code}\n# summary(m.C)\n\n\n#: 4 FACTORIAL model\nm.IE <- glm( accuracy ~ IMPLICIT*EXPLICIT, data = df, family = \"binomial\")\n# print(\"PREDICTOR MODEL\")\n# summary(m.IE)\n# car::Anova(m.IE, type=3)\n\n#: 4 TEST SUPERIOR FIT\npaste(\"AIC with FACTORIAL lower than FLAT CONDITION only model?\", m.C$aic > m.IE$aic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC with FACTORIAL lower than FLAT CONDITION only model? TRUE\"\n```\n:::\n\n```{.r .cell-code}\n#can't do lrt ... not nested models\n```\n:::\n\n\n##### Describe\n\n::: {.cell}\n\n```{.r .cell-code}\n#set model\nm <- m.IE\n\n# DESCRIBE MODEL ::::::::::::::::::::::::::::::::::::: \n\nprint(\"PREDICTOR MODEL [default two-tailed sig test]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PREDICTOR MODEL [default two-tailed sig test]\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = accuracy ~ IMPLICIT * EXPLICIT, family = \"binomial\", \n    data = df)\n\nDeviance Residuals: \n   Min      1Q  Median      3Q     Max  \n-1.675  -0.883  -0.593   0.936   1.910  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                   -1.649      0.345   -4.77  1.8e-06 ***\nIMPLICITimpasse                0.786      0.441    1.79    0.074 .  \nEXPLICITimg                    0.907      0.439    2.06    0.039 *  \nEXPLICITixn                    2.246      0.436    5.16  2.5e-07 ***\nIMPLICITimpasse:EXPLICITimg    0.484      0.581    0.83    0.405    \nIMPLICITimpasse:EXPLICITixn   -0.264      0.594   -0.44    0.657    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 515.41  on 372  degrees of freedom\nResidual deviance: 441.08  on 367  degrees of freedom\nAIC: 453.1\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\nprint(\"SIGNIFIGANCE TEST\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"SIGNIFIGANCE TEST\"\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m, type=3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type III tests)\n\nResponse: accuracy\n                  LR Chisq Df Pr(>Chisq)    \nIMPLICIT               3.3  1      0.069 .  \nEXPLICIT              33.0  2      7e-08 ***\nIMPLICIT:EXPLICIT      1.9  2      0.383    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# MANUAL ONE-SIDED SIGTEST ::::::::::::::::::::::::::: \n\n# one-sided (right tail) z test for B COEFFICIENT\n#https://stats.stackexchange.com/questions/330655/strategy-for-a-one-sided-test-of-glms-coefficients\n\n#SANITY CHECK 2-tailed test should match the model output\n# tt <- 2*pnorm(summary(m)$coefficients[2:4], lower.tail = F)\n# paste(\"p value for two-tailed test, null B = 0 : \",round(tt,3))\n# ot <- pnorm(summary(m)$coefficients[2:4], lower.tail = F)\n# paste(\"BUT we want a one tailed directional, null: B <= 0: \",round(ot,3))\n# paste(\"adjusted confint for directional hypothesis\")\n# (dcint <- confint(m, level = 0.90)) # get 90% for right side))\n# # https://stats.stackexchange.com/questions/20734/is-a-1-sided-90-prediction-interval-equivalent-to-a-2-sided-95-prediction-inte\n\n#:::::::: INTERPRET COEFFICIENTS\n\n# print(\"Confidence Interval —- LOG ODDS\")\n# confint(m1) #not adjusted for 1-tailed\n# print(\"Coefficients —- ODDS RATIOS\")\n# (e <- cbind( exp(coef(m)), exp(confint(m)))) #exponentiated, not adjusted\n# (e <- cbind( exp(coef(m)), exp(dcint))) #exponentiated, adjusted\n\n#TODO INTERACTIONS & ESTIMATED MARGINAL MEANS \n# print(\"MODEL PREDICTIONS\")\n# Retrieve predictions as probabilities \n# (for each level of the predictor)\n# pred.control <- predict(m,data.frame(pretty_condition=\"control\"),type=\"response\")\n#this should match : plogis(intercept coefficient)\n# paste(\"Probability of success in control,\", pred.control)\n# pred.impasse <- predict(m,data.frame(pretty_condition=\"impasse\"),type=\"response\")\n#this should match : plogis(intercept coefficient + predictor coeff)\n# paste(\"Probability of success in impasse,\", pred.impasse)\n```\n:::\n\n##### Inference\n\n\n##### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\nplot_model(m, vline.color = \"red\", \n           show.intercept = TRUE, \n           show.values = TRUE,\n           p.threshold = 0.1, #manually adjust to account for directional test\n           ci.lvl = 0.90 ) + #manually adjusted for directional test   \n  labs(title = \"Model Estimate | Odds Ratio\",\n       subtitle = \"\",\n       x = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#EASYSTATS | MODEL | ODDS RATIO\n# result <- model_parameters(m, exponentiate = TRUE, component = \"all\")\n# plot(result)\n\n\n\n## | PLOT TESTS\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#ONLY FOR BAYESIAN VERSION\n# result <- rope(m)\n# plot(result)\n# \n# result <- pd(m)\n# plot(result)\n\n\n## | PLOT PREDICTIONS\n\n#SJPLOT | MODEL | PROBABILITIES\nplot_model(m, type=\"int\",\n           show.intercept = TRUE,\n           show.values = TRUE,\n           title = \"Model Prediction | Probability of Accurate Response\",\n           axis.title = c(\"Condition\",\"Probability of Accurate Response\"))\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#PLOT MODEL PREDICTION\nplot_model(m, type = \"pred\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$IMPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n$EXPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-5.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_model(m, type = \"eff\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$IMPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n$EXPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/MODEL-VIS-Q1ACC-7.png){width=672}\n:::\n\n```{.r .cell-code}\n  # ylim(0,1) + \n  # labs(\n  #   title = \"Model Prediction | Probability of Accurate Response\",\n  #   subtitle = \"Impasse increases Probability of Correct Response\"\n  # )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">accuracy</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09&nbsp;&ndash;&nbsp;0.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.20</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.94&nbsp;&ndash;&nbsp;5.38</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.074</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.48</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.07&nbsp;&ndash;&nbsp;6.06</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.039</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.45</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.16&nbsp;&ndash;&nbsp;23.18</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.62</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.51&nbsp;&ndash;&nbsp;5.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.405</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.77</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.24&nbsp;&ndash;&nbsp;2.45</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.657</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">373</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> Tjur</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.189</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m1, \"(log odds)\" = m1)\n# notes = list(\"* p < 0.05, ** p < 0.01, *** p < 0.001\",\n#              '$sigma^{2}$ = 3.29\" N(subject) = 126 $\\tau_{00}$(subject) = 22.22 N(question) = 13 $\\tau_{00}$(question) = 0.31'\n#                )\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', \n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex\")\n# #              # coef_omit = \"Intercept\",\n```\n:::\n\n##### Diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\n# print(\"SANITY CHECK REPORTING\")\n# report::report(m)\n\n#print(\"MODEL PERFORMANCE\")\n# performance(m)\n\nprint(\"MODEL DIAGNOSTICS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"MODEL DIAGNOSTICS\"\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m)\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/DIAG-MODEL-Q1ACC-1.png){width=672}\n:::\n:::\n\n\n## H1B \\| Q1 INTERPRETATION STATE\n\n-   **\"orthogonal\"** \\[reference category\\] includes orthogonal and satisficing responses ==\\> indicates a primarily *orthogonal* state of coordinate system understanding\n\n-   **\"other\"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =\\> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular\n\n-   **\"angular\"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =\\> indicates some degree of angular/triangular coordinate understanding\n\n-   **\"triangular\"** includes correct triangular and 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =\\> indicates some degree of angular/triangular coordinate understanding\n\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Research Question     | Does Ss in the impasse condition produce less orthogonal responses on the first question?                                                                                                                                                                                                                                                                 |\n+=======================+===========================================================================================================================================================================================================================================================================================================================================================+\n| **Hypothesis**        | H1A \\| Ss in the IMPASSE condition will have a higher likelihood of producing unknown and and triangle-like response states, relative to orthogonal response states, on the first question                                                                                                                                                                |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Data**              | -   data: `df_items` where `q == 1`                                                                                                                                                                                                                                                                                                                       |\n|                       | -   outcome: `state` ( 4 level factor from 5 level high_interpretation )                                                                                                                                                                                                                                                                                  |\n|                       | -   predictor: `condition` \\[between-subjects factor\\]                                                                                                                                                                                                                                                                                                    |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Analysis Strategy** | 1.  Multinomial (Logistic) Regression on state predicted by condition                                                                                                                                                                                                                                                                                     |\n|                       |                                                                                                                                                                                                                                                                                                                                                           |\n|                       | Alternative:                                                                                                                                                                                                                                                                                                                                              |\n|                       |                                                                                                                                                                                                                                                                                                                                                           |\n|                       | -   Ordinal regression on state; but model doesn't satisfy proportional odds assumption (parallel slopes)                                                                                                                                                                                                                                                 |\n|                       | -   Multinomial or Ordinal regression on high_interpretation (5 category interpretation state which distinguishes between uncertain (blank, reference) unclassifiable, triangle-like and true triangular.) There are some cells with zeros, however (no uncertain responses in control) which means the model can't accurately estimate those comparisons |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n#### Setup \n::: {.cell}\n\n```{.r .cell-code}\ndf <- df_items %>% filter(q==1) %>% \n  dplyr::select(pretty_condition, IMPLICIT, EXPLICIT, state)\n```\n:::\n\n\n#### Describe \n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\ndf %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = state)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n   labs(#y = \"Correct Response on Q 1\",\n       title = \"Q1 Interpretation\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-Q1STATE-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\ndf %>% \n  ggplot(data = .,\n         mapping = aes(x = IMPLICIT,\n                       fill = state)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(~EXPLICIT) +\n   labs(#y = \"Correct Response on Q 1\",\n       title = \"Q1 Interpretation\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-Q1STATE-2.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#::::::::::::DESCRIPTIVES\n\ntable(df$state, df$pretty_condition) %>% addmargins(2) %>% #display sum for row\n      prop.table(margin=2) %>%  #return proportion (of column)\n      addmargins(1) #sanity check sum of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            \n             none-control none-impasse img-control img-impasse ixv-control\n  orthogonal       0.8065       0.3125      0.6452      0.1290      0.2581\n  other            0.0000       0.2812      0.0161      0.1452      0.0000\n  angular          0.0323       0.1094      0.0161      0.0968      0.0968\n  triangular       0.1613       0.2969      0.3226      0.6290      0.6452\n  Sum              1.0000       1.0000      1.0000      1.0000      1.0000\n            \n             ixv-impasse    Sum\n  orthogonal      0.0820 0.3727\n  other           0.0164 0.0777\n  angular         0.1475 0.0831\n  triangular      0.7541 0.4665\n  Sum             1.0000 1.0000\n```\n:::\n\n```{.r .cell-code}\n(t <- table(df$state, df$IMPLICIT, df$EXPLICIT) %>% addmargins(2) %>% #display sum for row\n      addmargins(1)) #sanity check sum of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, ,  = none\n\n            \n             control impasse Sum\n  orthogonal      50      20  70\n  other            0      18  18\n  angular          2       7   9\n  triangular      10      19  29\n  Sum             62      64 126\n\n, ,  = img\n\n            \n             control impasse Sum\n  orthogonal      40       8  48\n  other            1       9  10\n  angular          1       6   7\n  triangular      20      39  59\n  Sum             62      62 124\n\n, ,  = ixn\n\n            \n             control impasse Sum\n  orthogonal      16       5  21\n  other            0       1   1\n  angular          6       9  15\n  triangular      40      46  86\n  Sum             62      61 123\n```\n:::\n:::\n\n#### MULTINOMIAL REGRESSION\n\n\n*Does condition affect the response state of Q1?*\n\n*Fit a logistic regression predicting interpretation state (k=3) by condition(k = 2).*\n\n-   3 equations will be estimated (# categories - 1); each representing the odds of answering in that particular interpretation (vs) the reference category (orthogonal answer) \\[essentially a series of binary logistic regressions, but instead of incorrect/correct, comparing \\[reference category\\] vs \\[this category\\])\n\n-   For *each* equation:\n\n    -   $\\beta_{0}$ *= Log Odds of \\[this category type vs. reference category type) response in CONTROL condition*\n    -   $e^{\\beta_{0}}$ *= ODDS of \\[this category type vs. reference category type\\] response in CONTROL condition*\n    -   $\\beta_{1}$ *=* $\\beta_{1impasse}$ *Log Odds (Log OR; change in odds for \\[this category\\] type response in impasse (vs) control \\[log scale\\])*\n    -   $e^{\\beta_{1}}$ *= ODDS RATIO of \\[this. vs reference category type\\] response in IMPASSE (vs) CONTROL*\n    -   Two-tailed NHST *Null hypothesis:* $\\beta_{impasse} = 0$ *the odds for \\[this category of response vs. reference\\] are not different for IMPASSE condition*\n    -   *Alternative hypothesis:* $\\beta_{impasse} \\ne 0$ *the odds of \\[this category of response vs. reference\\] increases or decreases for IMPASSE condition*\n\n##### Fit CONDITION Model\n\n::: {.cell}\n\n```{.r .cell-code}\n#check reference level \nprint(\"Categories (first is reference)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Categories (first is reference)\"\n```\n:::\n\n```{.r .cell-code}\nlevels(df$state)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"orthogonal\" \"other\"      \"angular\"    \"triangular\"\n```\n:::\n\n```{.r .cell-code}\n#FIT EMPTY MODEL\nprint(\"EMPTY MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"EMPTY MODEL\"\n```\n:::\n\n```{.r .cell-code}\ncatm.0 <- multinom(state ~ 1, data = df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  8 (3 variable)\ninitial  value 517.087797 \nfinal  value 421.076070 \nconverged\n```\n:::\n\n```{.r .cell-code}\n# summary(catm.0)\n\n#FIT PREDICTOR MODEL\nprint(\"CONDITION MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"CONDITION MODEL\"\n```\n:::\n\n```{.r .cell-code}\ncatm.C <- multinom(formula = state ~ pretty_condition, data = df, model = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  28 (18 variable)\ninitial  value 517.087797 \niter  10 value 342.627778\niter  20 value 334.991914\niter  30 value 334.824433\nfinal  value 334.824100 \nconverged\n```\n:::\n\n```{.r .cell-code}\n# summary(catm.C)\n\n#COMPARE MODEL FIT\npaste(\"AIC wth CONDITION predictor is lower than empty model?\", catm.0$AIC > catm.C$AIC)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC wth CONDITION predictor is lower than empty model? TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(catm.0, catm.C)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName   |    Model | df | df_diff |   Chi2 |      p\n--------------------------------------------------\ncatm.0 | multinom |  3 |         |        |       \ncatm.C | multinom | 18 |      15 | 172.50 | < .001\n```\n:::\n\n```{.r .cell-code}\n#FIT PREDICTOR MODEL\nprint(\"FACTORIAL MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"FACTORIAL MODEL\"\n```\n:::\n\n```{.r .cell-code}\ncatm.IE <- multinom(formula = state ~ IMPLICIT*EXPLICIT, data = df, model = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  28 (18 variable)\ninitial  value 517.087797 \niter  10 value 338.418971\niter  20 value 334.948654\niter  30 value 334.824378\nfinal  value 334.824101 \nconverged\n```\n:::\n\n```{.r .cell-code}\n# summary(catm.IE)\n# car::Anova(catm.IE)\n\n#COMPARE MODEL FIT\npaste(\"AIC wth FACTORIAL predictor is lower than empty model?\", catm.IE$AIC > catm.0$AIC)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC wth FACTORIAL predictor is lower than empty model? FALSE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(catm.0, catm.IE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName    |    Model | df | df_diff |   Chi2 |      p\n---------------------------------------------------\ncatm.0  | multinom |  3 |         |        |       \ncatm.IE | multinom | 18 |      15 | 172.50 | < .001\n```\n:::\n:::\n\n*AIC in predictor model is less than empty model, and likelihood ratio test indicates predictor model is significantly better fit to the sample data than the empty (intercept only) model.*\n\n\n\n##### Describe\n\n::: {.cell}\n\n```{.r .cell-code}\n#set model\nm <- catm.IE\n\n#::::::::INTERPRETATION\npaste(\"MODEL SUMMARY\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"MODEL SUMMARY\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\nmultinom(formula = state ~ IMPLICIT * EXPLICIT, data = df, model = TRUE)\n\nCoefficients:\n           (Intercept) IMPLICITimpasse EXPLICITimg EXPLICITixn\nother           -17.00           16.90      13.316      -0.328\nangular          -3.22            2.17      -0.471       2.238\ntriangular       -1.61            1.56       0.916       2.526\n           IMPLICITimpasse:EXPLICITimg IMPLICITimpasse:EXPLICITixn\nother                          -13.093                      -1.177\nangular                          1.233                      -0.600\ntriangular                       0.719                      -0.255\n\nStd. Errors:\n           (Intercept) IMPLICITimpasse EXPLICITimg EXPLICITixn\nother            0.545           0.545       0.545       0.571\nangular          0.721           0.844       1.243       0.865\ntriangular       0.346           0.472       0.442       0.456\n           IMPLICITimpasse:EXPLICITimg IMPLICITimpasse:EXPLICITixn\nother                            0.645                       0.571\nangular                          1.425                       1.119\ntriangular                       0.670                       0.729\n\nResidual Deviance: 670 \nAIC: 706 \n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m, type =3) #always type 3 for ixns \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type III tests)\n\nResponse: state\n                  LR Chisq Df Pr(>Chisq)    \nIMPLICIT              44.0  3    1.5e-09 ***\nEXPLICIT              46.0  6    3.0e-08 ***\nIMPLICIT:EXPLICIT      4.8  6       0.56    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\npaste(\"LOG ODDS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"LOG ODDS\"\n```\n:::\n\n```{.r .cell-code}\ntidy(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 18 × 6\n   y.level    term                        estimate std.error statistic   p.value\n   <chr>      <chr>                          <dbl>     <dbl>     <dbl>     <dbl>\n 1 other      (Intercept)                  -17.0       0.545   -31.2   2.12e-213\n 2 other      IMPLICITimpasse               16.9       0.545    31.0   8.65e-211\n 3 other      EXPLICITimg                   13.3       0.545    24.4   1.22e-131\n 4 other      EXPLICITixn                   -0.328     0.571    -0.574 5.66e-  1\n 5 other      IMPLICITimpasse:EXPLICITimg  -13.1       0.645   -20.3   1.04e- 91\n 6 other      IMPLICITimpasse:EXPLICITixn   -1.18      0.571    -2.06  3.95e-  2\n 7 angular    (Intercept)                   -3.22      0.721    -4.46  8.05e-  6\n 8 angular    IMPLICITimpasse                2.17      0.844     2.57  1.02e-  2\n 9 angular    EXPLICITimg                   -0.471     1.24     -0.379 7.05e-  1\n10 angular    EXPLICITixn                    2.24      0.865     2.59  9.72e-  3\n11 angular    IMPLICITimpasse:EXPLICITimg    1.23      1.42      0.865 3.87e-  1\n12 angular    IMPLICITimpasse:EXPLICITixn   -0.600     1.12     -0.536 5.92e-  1\n13 triangular (Intercept)                   -1.61      0.346    -4.65  3.38e-  6\n14 triangular IMPLICITimpasse                1.56      0.472     3.30  9.59e-  4\n15 triangular EXPLICITimg                    0.916     0.442     2.07  3.80e-  2\n16 triangular EXPLICITixn                    2.53      0.456     5.54  2.94e-  8\n17 triangular IMPLICITimpasse:EXPLICITimg    0.719     0.670     1.07  2.83e-  1\n18 triangular IMPLICITimpasse:EXPLICITixn   -0.255     0.729    -0.350 7.26e-  1\n```\n:::\n\n```{.r .cell-code}\npaste(\"ODDS RATIO\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ODDS RATIO\"\n```\n:::\n\n```{.r .cell-code}\ntidy(m, exponentiate = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 18 × 6\n   y.level    term                        estimate std.error statistic   p.value\n   <chr>      <chr>                          <dbl>     <dbl>     <dbl>     <dbl>\n 1 other      (Intercept)                  4.12e-8     0.545   -31.2   2.12e-213\n 2 other      IMPLICITimpasse              2.18e+7     0.545    31.0   8.65e-211\n 3 other      EXPLICITimg                  6.07e+5     0.545    24.4   1.22e-131\n 4 other      EXPLICITixn                  7.20e-1     0.571    -0.574 5.66e-  1\n 5 other      IMPLICITimpasse:EXPLICITimg  2.06e-6     0.645   -20.3   1.04e- 91\n 6 other      IMPLICITimpasse:EXPLICITixn  3.08e-1     0.571    -2.06  3.95e-  2\n 7 angular    (Intercept)                  4.00e-2     0.721    -4.46  8.05e-  6\n 8 angular    IMPLICITimpasse              8.75e+0     0.844     2.57  1.02e-  2\n 9 angular    EXPLICITimg                  6.25e-1     1.24     -0.379 7.05e-  1\n10 angular    EXPLICITixn                  9.37e+0     0.865     2.59  9.72e-  3\n11 angular    IMPLICITimpasse:EXPLICITimg  3.43e+0     1.42      0.865 3.87e-  1\n12 angular    IMPLICITimpasse:EXPLICITixn  5.49e-1     1.12     -0.536 5.92e-  1\n13 triangular (Intercept)                  2.00e-1     0.346    -4.65  3.38e-  6\n14 triangular IMPLICITimpasse              4.75e+0     0.472     3.30  9.59e-  4\n15 triangular EXPLICITimg                  2.50e+0     0.442     2.07  3.80e-  2\n16 triangular EXPLICITixn                  1.25e+1     0.456     5.54  2.94e-  8\n17 triangular IMPLICITimpasse:EXPLICITimg  2.05e+0     0.670     1.07  2.83e-  1\n18 triangular IMPLICITimpasse:EXPLICITixn  7.75e-1     0.729    -0.350 7.26e-  1\n```\n:::\n:::\n\n##### INFERENCE\n\n\n\n##### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: PLOT\n\n#SJPLOT | MODEL | ODDS RATIO\n#library(sjPlot)\nplot_model(m, type = \"est\",\n           vline.color = \"red\", \n           show.intercept = TRUE, \n           show.values = TRUE,\n           p.threshold = 0.1, #manually adjust to account for directional test\n           ci.lvl = 0.90 ) +  #manually adjusted for directional test   \n  # scale_y_continuous() + #remove to put on log scale x axis \n  # scale_x_discrete(labels=c(\"control\",\"impasse\"))+\n  labs(title = \"MODEL ESTIMATE  | Q1 Accuracy ~ condition\",\n       subtitle = \"Impasse increases odds of correct response on Q1\",\n       x = \"Condition\") + theme_clean()\n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-Q1INTERPRETATION-LAB-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#SJPLOT | MODEL | PROBABILITIES\nplot_model(m, type = \"int\") \n```\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-Q1INTERPRETATION-LAB-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_model(m, type=\"eff\", ci.lvl = 0.95) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$IMPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-Q1INTERPRETATION-LAB-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n$EXPLICIT\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc3B_hypotesting_files/figure-html/VIS-Q1INTERPRETATION-LAB-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# +  ylim(0,1) +\n#   labs(title = \"MODEL PREDICTION  | Q1 State ~ condition\",\n#        subtitle = \"Impasse increases probability of more accurate response states Q1\",\n#        x = \"Condition\") + theme_clean()\n\n#TODO ESTIMAED MARGINALS AND IXN PLOTS \n# https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\ntab_model(m)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"4\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">state</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Response</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00&nbsp;&ndash;&nbsp;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">other</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">21844852.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">7473167.96&nbsp;&ndash;&nbsp;63854789.87</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">other</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">606607.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">207522.04&nbsp;&ndash;&nbsp;1773176.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">other</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.23&nbsp;&ndash;&nbsp;2.22</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.567</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">other</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00&nbsp;&ndash;&nbsp;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">other</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.31</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10&nbsp;&ndash;&nbsp;0.95</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.040</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">other</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01&nbsp;&ndash;&nbsp;0.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">angular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">8.75</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.66&nbsp;&ndash;&nbsp;46.02</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.011</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">angular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.62</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.05&nbsp;&ndash;&nbsp;7.20</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.705</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">angular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.37</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.71&nbsp;&ndash;&nbsp;51.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.010</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">angular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.43</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.21&nbsp;&ndash;&nbsp;56.52</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.388</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">angular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.55</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.06&nbsp;&ndash;&nbsp;4.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.592</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">angular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.20</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10&nbsp;&ndash;&nbsp;0.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.75</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.88&nbsp;&ndash;&nbsp;12.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.50</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.05&nbsp;&ndash;&nbsp;5.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.039</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">12.50</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.10&nbsp;&ndash;&nbsp;30.62</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [img]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.55&nbsp;&ndash;&nbsp;7.66</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.284</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">IMPLICIT [impasse] *<br>EXPLICIT [ixn]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.77</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.18&nbsp;&ndash;&nbsp;3.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.727</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">triangular</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"4\">373</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">0.205 / 0.202</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# #MODEL SUMMARY | save latex table\n# models <- list(\"odds ratios\" = m1, \"(log odds)\" = m1)\n# notes = list(\"* p < 0.05, ** p < 0.01, *** p < 0.001\",\n#              '$sigma^{2}$ = 3.29\" N(subject) = 126 $\\tau_{00}$(subject) = 22.22 N(question) = 13 $\\tau_{00}$(question) = 0.31'\n#                )\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = 'Accuracy ~ Condition (Mixed Logistic Regression)', \n#              notes = notes,\n#              output = \"analysis/SGC3A/models/tables/GLMER_OverallAccuracy_lab.tex\")\n# #              # coef_omit = \"Intercept\",\n\n# modelsummary(mixcat.1, s)\n#TODO OUTPUT TABLE \n#https://arelbundock.com/posts/modelsummary_multinomial_logit/\n```\n:::\n\n##### Diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\n#EXAMINE PREDICTIONS\n#create sample data frame\n# test <- data.frame(pretty_condition = c(\"control\", \"impasse\"))\n# pred <- predict(m, newdata = test, \"probs\")\n# paste(\"Predicted Probability of Being in Each State\")\n# ( x <- cbind(test, pred))\n# \n# print(\"MODEL PERFORMANCE\")\n# performance(m)\n# DescTools::PseudoR2(m, which = c(\"McFadden\", \"CoxSnell\", \"Nagelkerke\"))\n```\n:::\n\n## EXPLORE specific question \n\n::: {.cell}\n\n```{.r .cell-code}\n# \n# df <- df_items %>% filter(q==10)\n# grouped_ggbarstats( data = df, x = accuracy, y = pretty_condition, grouping.var = ospan_split)\n```\n:::",
    "supporting": [
      "4_sgc3B_hypotesting_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}