{
  "hash": "f182f49abb138f921042045691273b19",
  "result": {
    "markdown": "---\nsubtitle: 'Study SGC4C | Hypothesis Testing'\n# YAML FOR generating modelsummary tables\n# uncomment to run those  cells only \n# \\usepackage{booktabs}\n# \\usepackage{siunitx}\n# \\newcolumntype{d}{S[input-symbols = ()]}\n---\n\n\\newpage\n\n# Hypothesis Testing {#sec-SGC4C-hypotesting}\n\n*The purpose of this notebook is test the hypotheses that determined the design of the SGC4C study.*\n\n::: {.cell}\n\n```{.r .cell-code}\n#UTILITIES\nlibrary(Hmisc) # %nin% operator\nlibrary(broom) #tidy model output\nlibrary(broom.mixed) #tidy mixed models\nlibrary(mosaic) #favstats\nlibrary(svglite) #saving plots as svg\nlibrary(distributional)\n\n#VISUALIZATION\n# library(ggpubr) #arrange plots\n# library(cowplot) #arrange shift function plots\nlibrary(ggformula) #easy graphs\nlibrary(scales) \n# # library(vcd) #mosaic plots\n# # library(vcdExtra) #mosaic plots\nlibrary(kableExtra) #printing tables\nlibrary(sjPlot) #visualize model coefficients\nlibrary(ggdist) #uncertainty viz\nlibrary(modelr) #needed for ggdist\nlibrary(gghalves) # plots. in half\nlibrary(ggbeeswarm) # violin plot stuffs\nlibrary(statsExpressions)\nlibrary(ggstatsplot) #plots with stats\nlibrary(modelsummary) #latex tables for models!\nlibrary(cowplot) #arrange plots\n\n#MODELLING\n# library(rstatix) #helpful testing functions incl wilcoxon, etc\nlibrary(report) #easystats reporting\nlibrary(see) #easystats visualization\nlibrary(performance) #easystats model diagnostics\nlibrary(parameters) #easystats model summary and vis\nlibrary(marginaleffects) #contrasts on brms multinomials \n# library(qqplotr) #confint on qq plot\n# library(gmodels) #contingency table and CHISQR\n# library(equatiomatic) #extract model equation\n# library(pscl) #zeroinfl / hurdle models \nlibrary(lme4) #mixed effects models\nlibrary(lmerTest) #for CIs in glmer\nlibrary(merTools) #predictInterval\nlibrary(emmeans) #estimated marginal effects and posthocs on interactions\n# library(ggeffects) #visualization log regr models\n#MULTINOMIAL \nlibrary(nnet) #multinomial logistic regression [not mixed] #no p values\nlibrary(mclogit) #frequentist mixed multinomial logistic regression [mblogit] #gives p values\n#BAYESIAN\nlibrary(cmdstanr) #executing stan\nlibrary(brms) #bayesian mixed multinomials [+ other bayesian reg models]\nlibrary(bayestestR) \nlibrary(tidybayes)\nlibrary(posterior)\n\nlibrary(tidyverse) #ALL THE THINGS\n\n#OUTPUT OPTIONS\nlibrary(dplyr, warn.conflicts = FALSE)\noptions(dplyr.summarise.inform = FALSE)\noptions(ggplot2.summarise.inform = FALSE)\noptions(scipen=1, digits=3)\n\n#GRAPH THEMEING\n# theme_set(theme_minimal()) \n\n# Custom ggplot theme to make pretty plots\n# Get the font at https://fonts.google.com/specimen/Barlow+Semi+Condensed\ntheme_clean <- function() {\n  theme_minimal(base_family = \"Barlow Semi Condensed\") +\n    theme(panel.grid.minor = element_blank(),\n          plot.title = element_text(family = \"BarlowSemiCondensed-Bold\"),\n          axis.title = element_text(family = \"BarlowSemiCondensed-Medium\"),\n          strip.text = element_text(family = \"BarlowSemiCondensed-Bold\",\n                                    size = rel(1), hjust = 0),\n          strip.background = element_rect(fill = \"grey80\", color = NA))\n}\n\nset_theme(base = theme_clean())\n\n##IMPORT CUSTOM COLOR PALETTES\nsource(\"analysis/utils/foxy_palettes.R\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/SETUP-1.png){width=672}\n:::\n\n```{.r .cell-code}\nset.seed(12345)\n```\n:::\n\nIn SGC4C we set out to answer the following question: Does ROTATING the TM graph improve performance on the interval graph comprehension task? We test this hypothesis on both the orthogonal and triangular axes versions of the graph. \n\n::: {.cell}\n\n```{.r .cell-code}\n#IMPORT DATA \n\ndf_subjects <- read_rds('analysis/SGC4C/data/2-scored-data/sgc4c_scored_participants.rds') %>% mutate(\n  task_percent = DV_percent_NABS\n)\n\n\ndf_items <- read_rds('analysis/SGC4C/data/2-scored-data/sgc4c_scored_items.rds') %>% \n   mutate (\n    q = as.factor(q), \n    subject = as.factor(subject),\n    accuracy = recode_factor(score_niceABS, \"0\" =\"incorrect\",\"1\"=\"correct\"),\n    # CODES TVERSKY AS TRI-LIKE\n    # state = recode_factor(score_SCALED, #for ordinal\n    #                      \"-1\" = \"orth-like\",\n    #                      \"-0.5\" = \"unknown\",\n    #                      \"0\" = \"unknown\",\n    #                      \"0.5\" = \"tri-like\",\n    #                      \"1\" = \"tri-like\"),\n    # CODES TVERSKY AS OTHER\n    state = recode_factor(score_SCALED, #for ordinal\n                         \"-1\" = \"orthogonal\",\n                         \"-0.5\" = \"other\",\n                         \"0\" = \"other\",\n                         \"0.5\" = \"angular\",\n                         \"1\" = \"triangular\"),\n    state = as.ordered(state))\n\n#validations\nnrow(df_items)/15 == nrow(df_subjects)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nunique(df_items$subject %in% df_subjects$subject)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n## SAMPLE\n\n### Data Collection\n\nData was collected (online, via PROLIFIC) in Summer 2022. Data from the rotation (45, 90) conditions were joined with previously collected (online) data for for non-rotation conditions.\n\n::: {.cell}\n\n```{.r .cell-code}\ntitle = \"Participants by Condition and Data Collection Period\"\ncols = c(\"Condition\",\"Total for Period\")\ncont <- table(df_subjects$pretty_condition)\ncont %>% addmargins() %>% kbl(caption = title, col.names = cols ) %>%  kable_classic()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Participants by Condition and Data Collection Period</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Condition </th>\n   <th style=\"text-align:right;\"> Total for Period </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ORTH-0 </td>\n   <td style=\"text-align:right;\"> 68 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TRI-0 </td>\n   <td style=\"text-align:right;\"> 86 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ORTH-45 </td>\n   <td style=\"text-align:right;\"> 69 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TRI-45 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ORTH-90 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TRI-90 </td>\n   <td style=\"text-align:right;\"> 67 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sum </td>\n   <td style=\"text-align:right;\"> 412 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n### Participants\n\n::: {.cell}\n\n```{.r .cell-code}\n#Describe participants\nsubject.stats <-df_subjects %>% dplyr::select(age) %>% unlist() %>% favstats()\nsubject.stats$percent.male <- ((df_subjects %>% filter(gender==\"Male\") %>% count())/count(df_subjects))$n\nsubject.stats$percent.female <- ((df_subjects %>% filter(gender==\"Female\") %>% count())/count(df_subjects))$n\nsubject.stats$percent.other <- ((df_subjects %>% filter(gender %nin% c(\"Female\",\"Male\")) %>% count())/count(df_subjects))$n\n\n\ntitle = \"Descriptive Statistics of Participant Age and Gender\"\nsubject.stats %>% kbl (caption = title) %>% kable_classic()%>% \n  footnote(general = \"Age in Years\", \n           general_title = \"Note: \",footnote_as_chunk = T) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;'>\n<caption>Descriptive Statistics of Participant Age and Gender</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n   <th style=\"text-align:right;\"> percent.male </th>\n   <th style=\"text-align:right;\"> percent.female </th>\n   <th style=\"text-align:right;\"> percent.other </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 37 </td>\n   <td style=\"text-align:right;\"> 79 </td>\n   <td style=\"text-align:right;\"> 30.3 </td>\n   <td style=\"text-align:right;\"> 13.9 </td>\n   <td style=\"text-align:right;\"> 412 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.408 </td>\n   <td style=\"text-align:right;\"> 0.563 </td>\n   <td style=\"text-align:right;\"> 0.029 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> Age in Years</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n**TODO**\n\n**Overall** 412 participants (41 % male, 56 % female, 3 % other) undergraduate STEM majors at a public American University participated in exchange for course credit (age: 18 - 79 years).\n\n## OVERALL ACCURACY\n\n#### Setup\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_i = df_items %>% filter(q %nin% c(6,9)) %>% \n  dplyr::select(pretty_condition, accuracy, subject, q, SHAPE, ROTATION )\n\ndf_s <- df_subjects %>% \n  dplyr::select(pretty_condition, task_percent, SHAPE, ROTATION)\n```\n:::\n\n#### Visualize\n\n##### Explore\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART BY QUESTION\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = pretty_condition,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap( q ~ SHAPE) +\n   labs(title = \"Accuracy by Question\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"Q6 and Q9 are non-discriminative\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: FACETED HISTOGRAM\ngf_props(~task_percent,\n         fill = ~pretty_condition, data = df_s) %>%\n  gf_facet_grid(SHAPE ~ ROTATION) +\n  labs(x = \"% Correct\",\n       y = \"proportion of subjects\",\n       title = \"Overall Absolute Score (% Correct)\",\n       subtitle = \"\") + theme(legend.position = \"blank\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n##### Present\n\n::: {.cell}\n\n```{.r .cell-code}\np <- grouped_ggbetweenstats(data = df_s,\n                       y = task_percent, x = SHAPE, grouping.var = ROTATION,\n               plot.type = \"box\", type = \"nonparametric\", var.equal = FALSE,\n               centrality.type = \"parametric\",\n               results.subtitle = FALSE,\n               centrality.point.args = list(color=\"black\", size = 3, shape = 1),\n               # point.args = list(alpha=0), #suppress points\n               ggplot.component = ## modify further with `{ggplot2}` functions\n                list(\n                  labs(y = \"Percentage of correct responses across task\", x = \"\"),\n                  # aes(color = pretty_condition, fill = pretty_condition),\n                  scale_fill_grey(), scale_color_grey()\n                  # scale_colour_manual(values = paletteer::paletteer_c(\"viridis::viridis\", 3)),\n                  # scale_fill_manual(values = paletteer::paletteer_c(\"viridis::viridis\", 3))\n                  # theme(axis.text.x = element_text(angle = 90)\n                )) \n\np1 <- p[[1]] + coord_flip() + theme_clean() +\n   ggeasy::easy_remove_legend()\n\np2 <- p[[2]] + coord_flip() + theme_clean() +\n   ggeasy::easy_remove_legend()\n\np3 <- p[[3]] + coord_flip() + \n  labs(\n       subtitle = \"Across both Graph Shapes, Partial Rotation improves performance\") + \n  theme_clean() + ggeasy::easy_remove_axes(which = \"x\") + ggeasy::easy_remove_legend()\n\n\npg <- plot_grid(p3, p2, p1, ncol=1)\npg\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED PROPORTIONAL BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = SHAPE,\n                       fill = accuracy)) +\n  geom_bar(position = \"fill\", width = 0.75 ) + #,color = \"black\") +\n  scale_fill_foxy(discrete = TRUE, \"accuracy\")  +\n  # scale_fill_manual(values = paletteer::paletteer_d(\"lisa::FridaKahlo\", 2))+\n  facet_wrap(~ROTATION)+\n  theme(legend.position=\"bottom\")+\n   labs(title = \"DISTRIBUTION | Question Accuracy\",\n       x = \"Condition\",\n       y = \"Proportion of Questions\",\n       fill = \"\",\n       subtitle=\"Across both Graph Shapes, Partial Rotation improves performance\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/DESC-ACC-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: LABELLED \n# \n# temp <- df_i %>% mutate(\n#   accuracy = fct_rev(accuracy)\n# )  \n# \n# #CREATE PLOT WITH LABELS\n# p <- grouped_ggbarstats(data = temp, x = accuracy, y = pretty_condition,\n#                grouping.var = ospan_split,\n#                results.subtitle = FALSE,\n#                ggplot.component = ## modify further with `{ggplot2}` functions\n#                 list(\n#                   scale_fill_manual(values = paletteer::paletteer_d(\"lisa::FridaKahlo\", 2))\n#                   # theme(axis.text.x = element_text(angle = 90)))\n#                ))  + theme_clean() \n# \n# #FIX LABELS\n# p1 <- p[[1]] +  labs(\n#   subtitle = \"Impasse is particularly effective for subjects with high-working memory\",\n#     x = \"Condition\", y = \"Probability of Response\"\n#   ) + theme_clean() + theme(legend.position = \"blank\") \n#  \n# p2 <-   p[[2]] + labs(\n#     x = \"Condition\", y = \"Probability of Response\",\n#     subtitle = \"   \"\n#   ) + theme_clean() + theme(legend.position = \"blank\") +\n#   ggeasy::easy_remove_axes(which=\"y\", what=c(\"text\",\"title\"))\n#   # ggeasy::easy_remove_axes(which=\"y\", what= \"\"))\n# \n# #CREATE ROW\n# \n# plot_row <- plot_grid(p1,p2, rel_widths = c(1,0.85))\n# \n# title <- ggdraw() + \n#   draw_label(\n#     \"DISTRIBUTION | Question Accuracy\",\n#     fontface = 'bold',\n#     x = 0,\n#     hjust = 0\n#   ) +\n#   theme(\n#     # add margin on the left of the drawing canvas,\n#     # so title is aligned with left edge of first plot\n#     plot.margin = margin(0, 0, 0, 7)\n#   )\n# \n# \n# pg <- plot_grid(\n#   title,\n#   plot_row,\n#   ncol = 1,\n#   # rel_heights values control vertical title margins\n#   rel_heights = c(0.1, 1)\n# ) + theme_clean()\n#   \n# pg\n# ggsave(pg, filename = \"figures/SGC4C_OSPAN_Accuracy.png\", width = 6, height =4)\n```\n:::\n\n### Describe\n\n::: {.cell}\n\n```{.r .cell-code}\ntitle = \"Descriptive Statistics of Response Accuracy (Total % Correct)\"\ntbl1 <- mosaic::favstats(~task_percent, data = df_s) \ntbl1 %>% kbl (caption = title) %>% kable_classic()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Descriptive Statistics of Response Accuracy (Total % Correct)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n   <td style=\"text-align:right;\"> 0.692 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.33 </td>\n   <td style=\"text-align:right;\"> 0.368 </td>\n   <td style=\"text-align:right;\"> 412 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\ntitle = \"Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION\"\ntbl2 <- mosaic::favstats(task_percent ~ pretty_condition, data = df_s) \ntbl2 %>% kbl (caption = title) %>% kable_classic()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Descriptive Statistics of Response Accuracy (Total % Correct) BY CONDITION</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> pretty_condition </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> Q1 </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> Q3 </th>\n   <th style=\"text-align:right;\"> max </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> missing </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ORTH-0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.163 </td>\n   <td style=\"text-align:right;\"> 0.315 </td>\n   <td style=\"text-align:right;\"> 68 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TRI-0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.077 </td>\n   <td style=\"text-align:right;\"> 0.596 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.257 </td>\n   <td style=\"text-align:right;\"> 0.355 </td>\n   <td style=\"text-align:right;\"> 86 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ORTH-45 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.231 </td>\n   <td style=\"text-align:right;\"> 0.538 </td>\n   <td style=\"text-align:right;\"> 0.846 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.507 </td>\n   <td style=\"text-align:right;\"> 0.348 </td>\n   <td style=\"text-align:right;\"> 69 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TRI-45 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.692 </td>\n   <td style=\"text-align:right;\"> 0.846 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.644 </td>\n   <td style=\"text-align:right;\"> 0.297 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ORTH-90 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.173 </td>\n   <td style=\"text-align:right;\"> 0.298 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TRI-90 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.077 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.266 </td>\n   <td style=\"text-align:right;\"> 0.327 </td>\n   <td style=\"text-align:right;\"> 67 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n**TODO**\n\nAcross both conditions, overall accuracy on the task ranges from 0 to 100 with a mean of 32.972. \n\n\nTask level accuracy on the graph comprehension task follows the same pattern of behaviour observed in Study 4C: the distribution is bimodal. Total scores were higher in the impasse condition (M = 35%, SD = 41%, n = 65) than control condition (M = 15%, SD = 30%, n = 68), implying a likely main effect of scaffold condition. Comparing total scores across the median split on the OSPAN task (high working memory (vs) low working memory), we see readers with high working memory (M = 31 %, SD = 41%, n = 66) performed better than readers with low working memory (M = 19 %, SD = 31%, n = 67). In Figure \\ref{fig_3C_ospan_raw_accuracy} we see that while readers in the impasse condition performed consistently better than those in the control condition, the effect is particularly pronounced for readers with high-working memory, implying a potential interaction between condition and working memory.\n\n\n#### TESTS\n\n##### Aligned Ranks Transformation\n\n<!-- https://rcompanion.org/handbook/F_16.html -->\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ARTool)\nm.art = art(task_percent ~ SHAPE*ROTATION, data = df_s)\nanova(m.art)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance of Aligned Rank Transformed Data\n\nTable Type: Anova Table (Type III tests) \nModel: No Repeated Measures (lm)\nResponse: art(task_percent)\n\n                 Df Df.res F value Pr(>F)    \n1 SHAPE           1    406  4.0864   0.04   *\n2 ROTATION        2    406 57.6235 <2e-16 ***\n3 SHAPE:ROTATION  2    406  3.7072   0.03   *\n---\nSignif. codes:   0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n```\n:::\n:::\n\n##### Kruskal Wallis Test\n\n::: {.cell}\n\n```{.r .cell-code}\n(k <- kruskal.test(df_s$task_percent ~ df_s$pretty_condition))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  df_s$task_percent by df_s$pretty_condition\nKruskal-Wallis chi-squared = 95, df = 5, p-value <2e-16\n```\n:::\n:::\n\n##### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STATSPLOT | VIOLIN\ngrouped_ggbetweenstats(y = task_percent, x = SHAPE, grouping.var = ROTATION,  \n               data = df_s, type = \"nonparametric\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/TEST-VIZ-ACC-1.png){width=672}\n:::\n\n```{.r .cell-code}\ngrouped_ggbetweenstats(y = task_percent, x = ROTATION, grouping.var = SHAPE,  \n               data = df_s, type = \"nonparametric\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/TEST-VIZ-ACC-2.png){width=672}\n:::\n:::\n\n\n\n#### MIXED LOGISTIC REGRESSION \n\n*Fit a mixed logistic regression (at the item level), predicting accuracy (absolute score) on all discriminating questions by condition; accounting for random effects of subject and item.*\n\n##### Fit Model\n\n::: {.cell}\n\n```{.r .cell-code}\n## 0 | SETUP\n#confirm 13 items [all discriminating items]\nnrow(df_i) / nrow(df_s) == 13\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n#confirm all factors \nis.factor(df_i$q) && is.factor(df_i$subject) && is.factor(df_i$pretty_condition) && is.factor(df_i$accuracy) && is.factor(df_i$ROTATION) && is.factor(df_i$SHAPE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n## 1 | SETUP RANDOM EFFECTS\n\n#:: RANDOM INTERCEPT SUBJECT + ITEM\nprint(\"Subject Intercept + Item intercept random model\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Subject Intercept + Item intercept random model\"\n```\n:::\n\n```{.r .cell-code}\nmm.rSQ <- glmer(accuracy ~ (1|subject) + (1|q), data = df_i, family = \"binomial\")\n#summary(mm.rSQ)\n\n## 0 | SIMPLE FLAT CONDITION MODEL\n\nprint(\"FIXED Condition + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"FIXED Condition + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.CrSQ <- glmer(accuracy ~ pretty_condition + (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\")\n#summary(mm.CrSQ)\n# car::Anova(mm.CrSQ)\n\n## 2 | ADD MAIN EFFECTS  SHAPE\n\nprint(\"FIXED Rotation + FIXED Shape + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"FIXED Rotation + FIXED Shape + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.R.S.rSQ <- glmer(accuracy ~ ROTATION + SHAPE + (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\")\n#summary(mm.R.S.rSQ)\n# car::Anova(mm.R.S.rSQ)\n\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.rSQ)) > AIC(logLik(mm.R.S.rSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model TRUE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.rSQ,mm.R.S.rSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName       |    Model | df | df_diff |   Chi2 |      p\n------------------------------------------------------\nmm.rSQ     | glmerMod |  3 |         |        |       \nmm.R.S.rSQ | glmerMod |  6 |       3 | 105.93 | < .001\n```\n:::\n\n```{.r .cell-code}\npaste(\"Likelihood Ratio test is significant? p = \",(test_lrt(mm.rSQ,mm.R.S.rSQ))$p[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Likelihood Ratio test is significant? p =  8.24713063077672e-23\"\n```\n:::\n\n```{.r .cell-code}\n#adding shape predictor improves fit\n\n## 3 | ADD INTERACTION TERM,\n\nprint(\"FIXED Rotation * Shape + Subject & Item random intercepts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"FIXED Rotation * Shape + Subject & Item random intercepts\"\n```\n:::\n\n```{.r .cell-code}\nmm.RSrSQ <- glmer(accuracy ~ ROTATION * SHAPE  + (1|subject) + (1|q) ,\n                data = df_i, family = \"binomial\")\n# summary(mm.RSrSQ)\n# car::Anova(mm.RSrSQ)\n#INTERACTION TERM IS NOT SIGNIFICANT. \n\npaste(\"AIC decreases w/ new model\", AIC(logLik(mm.R.S.rSQ)) > AIC(logLik(mm.RSrSQ)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AIC decreases w/ new model FALSE\"\n```\n:::\n\n```{.r .cell-code}\ntest_lrt(mm.R.S.rSQ,mm.RSrSQ) #same as anova(m0, m1, test = \"Chi\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName       |    Model | df | df_diff | Chi2 |     p\n---------------------------------------------------\nmm.R.S.rSQ | glmerMod |  6 |         |      |      \nmm.RSrSQ   | glmerMod |  8 |       2 | 0.18 | 0.914\n```\n:::\n\n```{.r .cell-code}\npaste(\"Likelihood Ratio test is significant? p = \",(test_lrt(mm.R.S.rSQ,mm.RSrSQ))$p[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Likelihood Ratio test is significant? p =  0.913980259095259\"\n```\n:::\n\n```{.r .cell-code}\npaste(\"Likelihood ratio and AIC indicate that adding interaction term is not justified\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Likelihood ratio and AIC indicate that adding interaction term is not justified\"\n```\n:::\n\n```{.r .cell-code}\npaste(\"Model Performance\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Model Performance\"\n```\n:::\n\n```{.r .cell-code}\nperformance(mm.R.S.rSQ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Indices of model performance\n\nAIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma | Log_loss | Score_log | Score_spherical\n-------------------------------------------------------------------------------------------------------------------------\n3867.070 | 3867.086 | 3906.586 |      0.796 |      0.195 | 0.746 | 0.280 | 1.000 |    0.253 |      -Inf |           0.002\n```\n:::\n:::\n\n**ADD TO DISSERTATION**\n\nTo explore the effect of working memory capacity on ACCURACY, we fit a mixed effects logistic regression model with random intercepts for subjects and questions, with SHAPE AND ROTATION as  fixed effects A likelihood ratio test indicates that a model including these main effects explains significantly more variance in the data than an intercepts-only baseline model ($\\chi^2 (3,6) = 105.93, p < 0.001$). We also fit a model including an interaction term between SHAPE and ROTATION, however a likelihood ratio test indicated that adding the interaction term did not improve model fit ($\\chi^2 (6,8) = 0.18, p = 0.91$) Therefore we chose the simple main effects model (with random intercepts) as the final model. \n\n The explanatory power of the entire model is substantial ($conditional \\ R^2 = 0.80$) and the part related to the fixed effects SHAPE and ROTATION ($marginal \\ R^2$) explains 20% of variance.\n\n##### Describe\n\n::: {.cell}\n\n```{.r .cell-code}\n# best model\nm <- mm.R.S.rSQ #MAIN EFFECTS MODEL\nm %>% write_rds(file = \"analysis/SGC4C/models/sgc4c_glmer_acc_mm.R.S.rSQ.rds\")\n\n#::::::::: PRINT MODEL \n\nprint(\"PREDICTOR MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PREDICTOR MODEL\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: accuracy ~ ROTATION + SHAPE + (1 | subject) + (1 | q)\n   Data: df_i\n\n     AIC      BIC   logLik deviance df.resid \n    3867     3907    -1928     3855     5350 \n\nScaled residuals: \n   Min     1Q Median     3Q    Max \n-4.947 -0.252 -0.100  0.281  4.443 \n\nRandom effects:\n Groups  Name        Variance Std.Dev.\n subject (Intercept) 9.25     3.04    \n q       (Intercept) 0.41     0.64    \nNumber of obs: 5356, groups:  subject, 412; q, 13\n\nFixed effects:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)   -4.004      0.431   -9.29   <2e-16 ***\nROTATION45     3.900      0.435    8.97   <2e-16 ***\nROTATION90     0.504      0.436    1.16    0.248    \nSHAPETRI       1.145      0.349    3.28    0.001 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n           (Intr) ROTATION4 ROTATION9\nROTATION45 -0.629                    \nROTATION90 -0.517  0.497             \nSHAPETRI   -0.511  0.124     0.040   \n```\n:::\n\n```{.r .cell-code}\nprint(\"SIGNIFICANCE TEST [non directional]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"SIGNIFICANCE TEST [non directional]\"\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(m, type=2) #TYPE 3 SS FOR main effects\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: accuracy\n         Chisq Df Pr(>Chisq)    \nROTATION  94.9  2     <2e-16 ***\nSHAPE     10.8  1      0.001 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#:::::::: INTERPRET COEFFICIENTS\n\npaste(\"LOG ODDS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"LOG ODDS\"\n```\n:::\n\n```{.r .cell-code}\n# se <- sqrt(diag(stats::vcov(m)))\n# (tab <- cbind(Est = fixef(m),\n#               LL = fixef(m) - 1.96 * se,\n#               UL = fixef(m) + 1.96 * se))\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 9\n  effect   group term  estimate std.error statistic   p.value conf.low conf.high\n  <chr>    <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 fixed    <NA>  (Int…   -4.00      0.431     -9.29  1.49e-20   -4.85      -3.16\n2 fixed    <NA>  ROTA…    3.90      0.435      8.97  3.04e-19    3.05       4.75\n3 fixed    <NA>  ROTA…    0.504     0.436      1.16  2.48e- 1   -0.350      1.36\n4 fixed    <NA>  SHAP…    1.15      0.349      3.28  1.02e- 3    0.462      1.83\n5 ran_pars subj… sd__…    3.04     NA         NA    NA          NA         NA   \n6 ran_pars q     sd__…    0.640    NA         NA    NA          NA         NA   \n```\n:::\n\n```{.r .cell-code}\npaste(\"ODDS RATIOS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ODDS RATIOS\"\n```\n:::\n\n```{.r .cell-code}\n# (e <- exp(tab))\ntidy(m,   conf.int = TRUE, conf.level = 0.95, conf.method = \"Wald\", exponentiate = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 9\n  effect   group term  estimate std.error statistic   p.value conf.low conf.high\n  <chr>    <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 fixed    <NA>  (Int…   0.0182   0.00786     -9.29  1.49e-20  0.00784    0.0424\n2 fixed    <NA>  ROTA…  49.4     21.5          8.97  3.04e-19 21.1      116.    \n3 fixed    <NA>  ROTA…   1.66     0.722        1.16  2.48e- 1  0.704      3.89  \n4 fixed    <NA>  SHAP…   3.14     1.10         3.28  1.02e- 3  1.59       6.22  \n5 ran_pars subj… sd__…   3.04    NA           NA    NA        NA         NA     \n6 ran_pars q     sd__…   0.640   NA           NA    NA        NA         NA     \n```\n:::\n\n```{.r .cell-code}\npaste(\"PROBABILITIES\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PROBABILITIES\"\n```\n:::\n\n```{.r .cell-code}\n#sanity check\n#probability control = plogis(intercept)\n#probability impasse = plogis(intercept + coefficient)\n\n#FROM predict()\n# newdata <- df_i %>% dplyr::select(pretty_condition, subject, q)\n# preds <- predict(m, newdata = newdata, type = \"response\")\n# preds <- cbind(newdata, preds)\n# p <- preds %>% \n#   dplyr::select(pretty_condition, preds) %>% \n#   group_by(pretty_condition) %>% \n#   summarise(\n#     median = median(preds),\n#     se = sd(preds)/sqrt(n()),\n#     lwr = median - 1.96*se,\n#     upr = median + 1.96*se)\n    \n  \n#FROM merTools\nnewdata <- df_i %>% dplyr::select(ROTATION, SHAPE, subject, q)\n#make predictions\npreds <- predictInterval(m, newdata = newdata,\n                              which = \"fixed\", #full, fixed or random for those only\n                              type = \"probability\", #linear.prediction\n                              stat = \"median\",\n                              n.sims = 1000,\n                              level = 0.80) #width of prediction interval\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: executing %dopar% sequentially: no parallel backend registered\n```\n:::\n\n```{.r .cell-code}\n#join predictions to the new dataframe\npreds <- cbind(newdata, preds)\n#summarize\n(summ_preds <- preds %>% \n  dplyr::select(ROTATION, SHAPE, fit, lwr, upr) %>% \n  group_by(ROTATION, SHAPE) %>% \n  summarise(\n    median = median(fit),\n    lower = median(lwr),\n    upper = median(upr)\n  )) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n# Groups:   ROTATION [3]\n  ROTATION SHAPE median   lower  upper\n  <fct>    <fct>  <dbl>   <dbl>  <dbl>\n1 0        ORTH  0.0177 0.00450 0.0672\n2 0        TRI   0.0544 0.0145  0.185 \n3 45       ORTH  0.473  0.187   0.780 \n4 45       TRI   0.743  0.423   0.918 \n5 90       ORTH  0.0293 0.00748 0.108 \n6 90       TRI   0.0877 0.0237  0.275 \n```\n:::\n:::\n\n##### INFERENCE\n\n**ADD TO DISSERTATION**\n\nAlthough Wald Chi-Square tests revealed significant main effects of both SHAPE ($\\chi^2 (1) = 10.8, p < 0.001$) and ROTATION ($\\chi^2 (1) = 94.9, p < 0.001$). \n\nThe model predicts that, for ORTHOGONAL shaped graphs, rotating the graph from 0 to 45 degrees increases the probability of a correct response from 1% to 47%. Further rotating the graph to 90 degrees however, results in a probability of only 3%.  Posthoc comparisons indicate that the difference between 0 and 90 degree rotation is not significant (OR = 0.60, SE = 0.26 , p = 0.24)\n\nThe model predicts that, for TRIANGULAR shaped graphs, rotating the graph from 0 to 45 degrees increases the probability of a correct response from 5% to 74%. Further rotating the graph to 90 degrees however, results in a probability of only 9%. Posthoc comparisons indicate that the difference between 0 and 90 degree rotation is not significant (OR = 0.60, SE = 0.26 = 0.25).\n\nAcross both graph shapes, rotating the graph from 0 to 90 degrees results in a minor improvement in accuracy, while rotating the graph halfway between results in a substantial improvement in accuracy. Posthoc comparisons also reveal that across all levels of rotation, the triangular shape was significantly better than the orthogonal shape. \n\n\n##### Marginal Effects\n\n::: {.cell}\n\n```{.r .cell-code}\n# https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html#simple\n# https://stats.oarc.ucla.edu/stata/faq/how-can-i-understand-a-categorical-by-categorical-interaction-in-logistic-regression-stata-12/\n# https://stats.oarc.ucla.edu/stata/seminars/deciphering-interactions-in-logistic-regression/\n  \nlibrary(emmeans)\n\n#sanity check reference grid\nref_grid(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'emmGrid' object with variables:\n    ROTATION = 0, 45, 90\n    SHAPE = ORTH, TRI\nTransformation: \"logit\" \n```\n:::\n\n```{.r .cell-code}\n#PRINT ESTIMATED MARGINAL MEANS\n#should be same as summ_preds\nemmeans(m,  ~ ROTATION + SHAPE, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n ROTATION SHAPE  prob     SE  df asymp.LCL asymp.UCL\n 0        ORTH  0.018 0.0076 Inf     0.008     0.041\n 45       ORTH  0.474 0.0930 Inf     0.302     0.652\n 90       ORTH  0.029 0.0121 Inf     0.013     0.065\n 0        TRI   0.054 0.0201 Inf     0.026     0.110\n 45       TRI   0.739 0.0734 Inf     0.573     0.857\n 90       TRI   0.087 0.0318 Inf     0.041     0.173\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the logit scale \n```\n:::\n\n```{.r .cell-code}\n##POST-HOC COMPARISONS\nprint(\"POSTHOC COMPARISONS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"POSTHOC COMPARISONS\"\n```\n:::\n\n```{.r .cell-code}\nemmeans(m,  pairwise ~ ROTATION + SHAPE, \n        type = \"response\" , adjust = \"none\") #sidak, tukey\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$emmeans\n ROTATION SHAPE  prob     SE  df asymp.LCL asymp.UCL\n 0        ORTH  0.018 0.0076 Inf     0.008     0.041\n 45       ORTH  0.474 0.0930 Inf     0.302     0.652\n 90       ORTH  0.029 0.0121 Inf     0.013     0.065\n 0        TRI   0.054 0.0201 Inf     0.026     0.110\n 45       TRI   0.739 0.0734 Inf     0.573     0.857\n 90       TRI   0.087 0.0318 Inf     0.041     0.173\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the logit scale \n\n$contrasts\n contrast                          odds.ratio    SE  df null z.ratio p.value\n ROTATION0 ORTH / ROTATION45 ORTH        0.02  0.01 Inf    1  -8.970  <.0001\n ROTATION0 ORTH / ROTATION90 ORTH        0.60  0.26 Inf    1  -1.160  0.2475\n ROTATION0 ORTH / ROTATION0 TRI          0.32  0.11 Inf    1  -3.280  0.0010\n ROTATION0 ORTH / ROTATION45 TRI         0.01  0.00 Inf    1  -8.550  <.0001\n ROTATION0 ORTH / ROTATION90 TRI         0.19  0.11 Inf    1  -2.900  0.0038\n ROTATION45 ORTH / ROTATION90 ORTH      29.83 13.03 Inf    1   7.780  <.0001\n ROTATION45 ORTH / ROTATION0 TRI        15.71  8.21 Inf    1   5.270  <.0001\n ROTATION45 ORTH / ROTATION45 TRI        0.32  0.11 Inf    1  -3.280  0.0010\n ROTATION45 ORTH / ROTATION90 TRI        9.49  5.08 Inf    1   4.200  <.0001\n ROTATION90 ORTH / ROTATION0 TRI         0.53  0.29 Inf    1  -1.170  0.2413\n ROTATION90 ORTH / ROTATION45 TRI        0.01  0.01 Inf    1  -7.820  <.0001\n ROTATION90 ORTH / ROTATION90 TRI        0.32  0.11 Inf    1  -3.280  0.0010\n ROTATION0 TRI / ROTATION45 TRI          0.02  0.01 Inf    1  -8.970  <.0001\n ROTATION0 TRI / ROTATION90 TRI          0.60  0.26 Inf    1  -1.160  0.2475\n ROTATION45 TRI / ROTATION90 TRI        29.83 13.03 Inf    1   7.780  <.0001\n\nTests are performed on the log odds ratio scale \n```\n:::\n\n```{.r .cell-code}\n##PLOT INTERACTION\n#equivalent to plot_model, type = \"int\"\n# emmip(m, SHAPE * ROTATION ,\n#       type = \"response\",\n#       CIs = TRUE,\n#       linearg = list(linetype = \"dashed\"),\n#       engine = \"ggplot\")\n\n\n##PLOT PROBABILITY\nplot(ref_grid(m), by = \"SHAPE\", type = \"response\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n##### TODO Print\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\n# tab_model(m)\n\n# #MODEL SUMMARY | save latex table\n\n# models <- list(\"odds ratios\" = m, \"(log odds)\" = m)\n# title = \"Study 4C | Question Accuracy | Mixed Logistic Regression\"\n# notes = list(\"* p < 0.05, ** p < 0.01, *** p < 0.001\",\n#              paste(\"n = \",n_obs(m), \"R^2(Conditional) =\", round(r2(m)[[1]],2),\n#                    \"R^2(Marginal) =\", round(r2(m)[[2]],2)),\n#              \"Accuracy  ~ Condition * OSPAN +  (1 | subject) + (1 | q)\")\n# \n# modelsummary(models,\n#              exponentiate = c(TRUE, FALSE),\n#              shape = term ~ model + statistic,\n#              fmt = 2, #two digits w/ trailing zero\n#              estimate  = \"{estimate} {stars}\",\n#              statistic = \"conf.int\",\n#              gof_map = c(\"AIC\", \"sigma\"),\n#              gof_omit = 'RMSE|ICC|BIC',\n#              coef_rename = c(\"pretty_conditionimpasse\" = \"Condition[impasse]\"),\n#              title = title,\n#              notes = notes,\n#              output = \"tables/SGC3C_OSPAN_GLMER_OverallAccuracy.tex\")\n#              # coef_omit = \"Intercept\",\n\n# extract_eq(m, use_coefs = TRUE, wrap = TRUE)\n```\n:::\n\n##### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\nplot_model(m, vline.color = \"red\", \n           show.intercept = TRUE, \n           show.values = TRUE,\n           p.threshold = 0.1, #manually adjust to account for directional test\n           ci.lvl = 0.90 ) + #manually adjusted for directional test   \n  labs(title = \"Model Estimate | Odds Ratio\",\n       subtitle = \"\",\n       x = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/MODEL-VIS-ACC-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#EASYSTATS | MODEL | ODDS RATIO\n# result <- model_parameters(m, exponentiate = TRUE, component = \"all\")\n# plot(result)\n\n\n## | PLOT TESTS\n\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/MODEL-VIS-ACC-2.png){width=672}\n:::\n\n```{.r .cell-code}\n## | PLOT PREDICTIONS\n\n# #SJPLOT | MODEL | PROBABILITIES\n# plot_model(m, type=\"int\",\n#            show.intercept = TRUE,\n#            show.values = TRUE,\n#            title = \"Model Prediction | Probability of Accurate Response\",\n#            axis.title = c(\"Condition\",\"Probability of Accurate Response\"))\n\n#PLOT MODEL PREDICTION\nplot_model(m, type = \"pred\", terms = c(\"SHAPE\", \"ROTATION\"))  \n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/MODEL-VIS-ACC-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_model(m, type = \"eff\",  terms = c(\"SHAPE\", \"ROTATION\"))  \n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/MODEL-VIS-ACC-4.png){width=672}\n:::\n\n```{.r .cell-code}\n  # ylim(0,1) + \n  # labs(\n  #   title = \"Model Prediction | Probability of Accurate Response\",\n  #   subtitle = \"Impasse increases Probability of Correct Response\"\n  # )\n\n\n#GGDIST | MODEL | PREDICTED PROBABILITIES\n# preds %>% \n#   ggplot(aes( x = fit, y = ROTATION, fill = SHAPE)) + \n#   stat_halfeye(alpha = 0.5, normalize = \"panels\") + \n#   xlim(0,0.3) + theme_clean() + labs(\n#     title = \"Model PREDICTION | Probability of Accurate Response\",\n#     subtitle = \"TODO check preds to see if fixed or includes random\"\n#   )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## PLOT INTERACTION\nlibrary(ggeffects)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'ggeffects'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:cowplot':\n\n    get_title\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:modelr':\n\n    data_grid\n```\n:::\n\n```{.r .cell-code}\nggpredict(m, terms = c(\"ROTATION\",\"SHAPE\")) %>% \n  plot(connect.lines = TRUE) + \n  scale_color_manual(values = fct_rev(paletteer::paletteer_d(\"nbapalettes::bulls\")))+\n  # scale_color_manual(values = paletteer::paletteer_d(\"awtools::gpalette\",3))+\n  # scale_color_manual(values = paletteer::paletteer_d(\"lisa::FridaKahlo\", 3))+\n  # scale_colour_manual(values = paletteer::paletteer_c(\"viridis::viridis\", 2)) + \n  theme_clean() + labs(\n  title = \"MODEL | Predicted probability of correct response\",\n  x = \"ROTATION\"\n) + theme(legend.position=\"bottom\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nScale for 'colour' is already present. Adding another scale for 'colour',\nwhich will replace the existing scale.\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n##### Diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\n# print(\"SANITY CHECK REPORTING\")\n# report(m)\n\n# print(\"MODEL PERFORMANCE\")\n# performance(m)\n\nprint(\"DIAGNOSTICS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"DIAGNOSTICS\"\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/MODEL-DIAG-ACC-1.png){width=672}\n:::\n:::\n\n## OVERALL INTERPRETATION STATE\n\n-   **\"orthogonal\"** \\[reference category\\] includes orthogonal and satisficing responses ==\\> indicates a primarily *orthogonal* state of coordinate system understanding\n\n-   **\"other\"** includes: blank, reference point, responses that can't be classified (including selecting all datapoints), =\\> indicates an uncertain or unidentifiable state of coordinate system understanding, but one that is distinctly *not* orthogonal nor triangular\n\n-   **\"angular\"** includes 'lines connecting' responses as well as responses that include both orthogonal *and* triangular answers =\\> indicates some degree of angular/triangular coordinate understanding\n\n-   **\"triangular\"** includes correct triangular =\\> indicates a correct triangular coordinate understanding\n\n#### Setup\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_i = df_items %>% filter(q %nin% c(6,9)) %>% dplyr::select(q,subject,state,pretty_condition, ROTATION, SHAPE) %>% droplevels()\n```\n:::\n\n#### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = ROTATION,\n                       fill = state)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_manual(values = paletteer::paletteer_d(\"ggthemes::calc\", 4))+\n  facet_wrap(~SHAPE) +\n   labs(title = \"Interpretation across all Questions\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART BY QUESTION\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = ROTATION,\n                       fill = state)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_manual(values = paletteer::paletteer_d(\"ggthemes::calc\", 4))+\n  # scale_fill_brewer(palette = \"Set1\")  +\n  facet_wrap(q ~ SHAPE) +\n   labs(title = \"Interpretation by Question\",\n       x = \"Condition\",\n       fill = \"\",\n       subtitle=\"\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-21-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: STACKED BAR CHART\n\ndf_i %>% \n  ggplot(data = .,\n         mapping = aes(x = ROTATION,\n                       fill = state)) +\n  geom_bar(position = \"fill\" ) + #,color = \"black\") +\n  scale_fill_foxy(discrete = TRUE, \"state\")  +\n  facet_wrap(~SHAPE) +\n  labs(title = \"DISTRIBUTION | Interpretation\",\n       x = \"Condition\", y = \"Proportion of Questions\",\n       fill = \"\",\n       subtitle=\"\") + theme_clean()\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#:::::::: LABELLED \n\n# temp <- df_i %>% mutate(\n#   state = fct_rev(state)\n# )  \n# \n# p <-   grouped_ggbarstats(data = temp, x = state, y = pretty_condition,\n#                           grouping.var = ospan_split,\n#                results.subtitle = FALSE,\n#                ggplot.component = ## modify further with `{ggplot2}` functions\n#                 list(\n#                   scale_fill_manual(values = paletteer::paletteer_d(\"ggthemes::calc\", 4))\n#                   # theme(axis.text.x = element_text(angle = 90)))\n#                ))  + theme_clean() + theme(legend.position = \"bottom\")\n# \n# p <- p + labs(title = \"DISTRIBUTION | Question Accuracy\",\n#          y = \"Proportion of Questions\", x = \"Condition\",\n#          subtitle = \"Impasse condition yields more correct responses\")\n# \n# p\n# # ggsave(p, filename = \"figures/SGC4C_LAB_Accuracy.png\", width = 6, height =4)\n\n\n#:::::::: LABELLED \n# \n# temp <- df_i \n# # %>% mutate(\n# #   accuracy = fct_rev(accuracy)\n# # )\n# \n# #CREATE PLOT WITH LABELS\n# p <- grouped_ggbarstats(data = temp, x = state, y = pretty_condition,\n#                grouping.var = ospan_split,\n#                results.subtitle = FALSE,\n#                ggplot.component = ## modify further with `{ggplot2}` functions\n#                 list(\n#                   scale_fill_manual(values = paletteer::paletteer_d(\"ggthemes::calc\", 4))\n#                   # theme(axis.text.x = element_text(angle = 90)))\n#                )) \n# \n# #FIX LABELS\n# p1 <- p[[1]] +  labs(\n#   subtitle = \"Impasse is particularly effective for subjects with high-working memory\",\n#     x = \"Condition\", y = \"Probability of Response\"\n#   ) + theme_clean() + theme(legend.position = \"blank\") \n#  \n# p2 <-   p[[2]] + labs(\n#     x = \"Condition\", y = \"Probability of Response\",\n#     subtitle = \"   \"\n#   ) + theme_clean() + theme(legend.position = \"blank\") +\n#   ggeasy::easy_remove_axes(which=\"y\", what=c(\"text\",\"title\"))\n#   # ggeasy::easy_remove_axes(which=\"y\", what= \"\"))\n# \n# #CREATE ROW\n# \n# plot_row <- plot_grid(p1,p2, rel_widths = c(1,0.85))\n# \n# title <- ggdraw() + \n#   draw_label(\n#     \"DISTRIBUTION | Question Accuracy\",\n#     fontface = 'bold',\n#     x = 0,\n#     hjust = 0\n#   ) +\n#   theme(\n#     # add margin on the left of the drawing canvas,\n#     # so title is aligned with left edge of first plot\n#     plot.margin = margin(0, 0, 0, 7)\n#   )\n# \n# \n# pg <- plot_grid(\n#   title,\n#   plot_row,\n#   ncol = 1,\n#   # rel_heights values control vertical title margins\n#   rel_heights = c(0.1, 1)\n# ) + theme_clean()\n#   \n# \n# update_geom_defaults(\"text\", list(colour = \"grey20\", family = theme_get()$text$family))\n# \n# \n# pg\n\n\n# ggsave(pg, filename = \"figures/SGC4C_OSPAN_Accuracy.png\", width = 6, height =4)\n```\n:::\n\n#### Describe\n\n::: {.cell}\n\n```{.r .cell-code}\n#::::::::::::DESCRIPTIVES\n\ntable(df_i$state, df_i$pretty_condition) %>% addmargins(2) %>% #display sum for row\n      prop.table(margin=2) %>%  #return proportion (of column)\n      addmargins(1) #sanity check sum of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            \n             ORTH-0  TRI-0 ORTH-45 TRI-45 ORTH-90 TRI-90    Sum\n  orthogonal 0.6640 0.5572  0.2274 0.0908  0.5195 0.3720 0.4149\n  other      0.1324 0.1351  0.1605 0.1639  0.2106 0.2342 0.1705\n  angular    0.0407 0.0510  0.1048 0.1009  0.0971 0.1274 0.0850\n  triangular 0.1629 0.2567  0.5072 0.6444  0.1728 0.2664 0.3297\n  Sum        1.0000 1.0000  1.0000 1.0000  1.0000 1.0000 1.0000\n```\n:::\n\n```{.r .cell-code}\n(t <- table(df_i$state, df_i$ROTATION, df_i$SHAPE) %>% addmargins(2) %>% #display sum for row\n      addmargins(1)) #sanity check sum of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, ,  = ORTH\n\n            \n                0   45   90  Sum\n  orthogonal  587  204  412 1203\n  other       117  144  167  428\n  angular      36   94   77  207\n  triangular  144  455  137  736\n  Sum         884  897  793 2574\n\n, ,  = TRI\n\n            \n                0   45   90  Sum\n  orthogonal  623   72  324 1019\n  other       151  130  204  485\n  angular      57   80  111  248\n  triangular  287  511  232 1030\n  Sum        1118  793  871 2782\n```\n:::\n:::\n\n#### MIXED MULTINOMIAL REGRESSION\n\n*Does condition affect the response state of of items across the task?*\n\n*Fit a MIXED logistic regression predicting interpretation state (k=3) by condition(k = 2).*\n\n##### Fit Model \\[brms\\]\n\n::: {.cell}\n\n```{.r .cell-code}\n##1. In order to set priors, first fit default priors model, then get prior description\n## in order to get class and dpar names \n\n# FLAT MODEL\n# flat <- brm( state ~ ROTATION+SHAPE + (1|subject) + (1|q),\n#                  data = df_i,\n#                  family = \"categorical\",\n#                  chains = 4, iter = 2000, warmup = 1000,\n#                  cores = 4, seed = 1234,\n#                  save_pars = save_pars(all = TRUE),\n# control = list(adapt_delta = 0.98),  # to deal with divergent transitions\n#                  backend = \"cmdstanr\")\n                 \n# prior_summary(flat)\n\ninf_priors_maineffects <- c(\n  #prior on INTERCEPTS \n  #25% chance of each answer in control, scale = from 0.01 to 62%\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muangular\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muother\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"mutriangular\"),\n  #prior on COEFFICIENT\n  #likely to change odds between 0 and 2.4\n  #coefficient level rotation 45\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45\", dpar = \"mutriangular\"),\n  # coefficient level rotation 90\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90\", dpar = \"mutriangular\"),\n  #coeficient level shape tri\n  prior(normal(0, 2.42), class = b, coef=\"SHAPETRI\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"SHAPETRI\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"SHAPETRI\", dpar = \"mutriangular\")\n)\n\n\ninf_priors_ixn <- c(\n  #prior on INTERCEPTS\n  #25% chance of each answer in control, scale = from 0.01 to 62%\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muangular\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"muother\"),\n  prior(normal(-1.1, 1.5),  class = \"Intercept\", dpar = \"mutriangular\"),\n  #prior on CONDITION COEFFICIENT\n   #coefficient level rotation 45\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45\", dpar = \"mutriangular\"),\n  # coefficient level rotation 90\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90\", dpar = \"mutriangular\"),\n  #coeficient level shape tri\n  prior(normal(0, 2.42), class = b, coef=\"SHAPETRI\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"SHAPETRI\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"SHAPETRI\", dpar = \"mutriangular\"),\n  #prior on IXN COEFFICIENT\n  #likely to change odds between 0 and 2.4\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45:SHAPETRI\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45:SHAPETRI\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION45:SHAPETRI\", dpar = \"mutriangular\"),\n  \n  #prior on IXN COEFFICIENT\n  #likely to change odds between 0 and 2.4\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90:SHAPETRI\", dpar = \"muangular\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90:SHAPETRI\", dpar = \"muother\"),\n  prior(normal(0, 2.42), class = b, coef=\"ROTATION90:SHAPETRI\", dpar = \"mutriangular\")\n)\n\n\n#BAYESIAN RANDOM ONLY\nBmm.cat.rSQ <- brm( state ~ 1 + (1|subject) + (1|q), \n                 data = df_i, \n                 family = \"categorical\",\n                 chains = 4, iter = 2500, warmup = 1000,\n                 cores = 4, seed = 1234,\n                 save_pars = save_pars(all = TRUE),\n                 # backend = \"cmdstanr\",\n                 file =\"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.rSQ.rds\")\n\n\n# MAIN EFFECTSONLY MODEL\nBmm.cat.R.SrSQ <- brm( state ~ ROTATION + SHAPE + (1|subject) + (1|q), \n                 data = df_i, \n                 prior = inf_priors_maineffects,\n                 family = \"categorical\",\n                 chains = 4, iter = 4000, warmup = 1000,\n                 cores = 4, seed = 1234,\n                 save_pars = save_pars(all = TRUE),\n                 control = list(adapt_delta = 0.98),  # to deal with divergent transitions\n                 backend = \"cmdstanr\",\n                 file =\"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.R.S.rSQ.rds\")\n\n\n##MODEL COMPARISON\n# print(\"MODEL COMPARISON: random effects (vs) CONDITION\")\n(bf1 <-  bayesfactor(Bmm.cat.rSQ, Bmm.cat.R.SrSQ))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Bayes factors might not be precise.\nFor precise Bayes factors, sampling at least 40,000 posterior samples is recommended.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nComputation of Bayes factors: estimating marginal likelihood, please wait...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: logml could not be estimated within maxiter, rerunning with adjusted starting value. \nEstimate might be more variable than usual.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRecompiling the model with 'rstan'\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nRunning /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c\nclang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o\nIn file included from <built-in>:1:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Dense:1:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Core:88:\n/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace'\nnamespace Eigen {\n^\n/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator\nnamespace Eigen {\n               ^\n               ;\nIn file included from <built-in>:1:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Dense:1:\n/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found\n#include <complex>\n         ^~~~~~~~~\n3 errors generated.\nmake: *** [foo.o] Error 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRecompilation done\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: logml could not be estimated within maxiter, rerunning with adjusted starting value. \nEstimate might be more variable than usual.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nBayes Factors for Model Comparison\n\n    Model                                            BF\n[2] ROTATION + SHAPE + (1 | subject) + (1 | q) 2.96e+55\n\n* Against Denominator: [1] 1 + (1 | subject) + (1 | q)\n*   Bayes Factor Type: marginal likelihoods (bridgesampling)\n```\n:::\n\n```{.r .cell-code}\n#substantial evidence in favor of conditon model over random only BF 1.64e+16\n\n\n# # INTERACTION MODEL\nBmm.cat.RSrSQ <- brm( state ~ ROTATION*SHAPE + (1|subject) + (1|q),\n                 data = df_i,\n                 prior = inf_priors_ixn,\n                 family = \"categorical\",\n                 chains = 4, iter = 4000, warmup = 1000,\n                 cores = 4, seed = 1234,\n                 save_pars = save_pars(all = TRUE),\n                 control = list(adapt_delta = 0.98),  # to deal with divergent transitions\n                 # backend = \"cmdstanr\",\n                 file =\"analysis/SGC4C/models/sgc4c_brms_state_Bmm.cat.RSrSQ.rds\")\n# describe_posterior(Bmm.cat.RSrSQ)\n\n\n##MODEL COMPARISON\nprint(\"IS FACTORIAL better than MAIN EFFECTS model?\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"IS FACTORIAL better than MAIN EFFECTS model?\"\n```\n:::\n\n```{.r .cell-code}\n(bf2 <- bayesfactor(Bmm.cat.R.SrSQ, Bmm.cat.RSrSQ))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Bayes factors might not be precise.\nFor precise Bayes factors, sampling at least 40,000 posterior samples is recommended.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nComputation of Bayes factors: estimating marginal likelihood, please wait...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRecompiling the model with 'rstan'\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nRunning /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c\nclang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o\nIn file included from <built-in>:1:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Dense:1:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Core:88:\n/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace'\nnamespace Eigen {\n^\n/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator\nnamespace Eigen {\n               ^\n               ;\nIn file included from <built-in>:1:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:\nIn file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Dense:1:\n/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found\n#include <complex>\n         ^~~~~~~~~\n3 errors generated.\nmake: *** [foo.o] Error 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRecompilation done\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: logml could not be estimated within maxiter, rerunning with adjusted starting value. \nEstimate might be more variable than usual.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: logml could not be estimated within maxiter, rerunning with adjusted starting value. \nEstimate might be more variable than usual.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nBayes Factors for Model Comparison\n\n    Model                                            BF\n[2] ROTATION * SHAPE + (1 | subject) + (1 | q) 5.19e-18\n\n* Against Denominator: [1] ROTATION + SHAPE + (1 | subject) + (1 | q)\n*   Bayes Factor Type: marginal likelihoods (bridgesampling)\n```\n:::\n\n```{.r .cell-code}\ncompare_models(Bmm.cat.R.SrSQ, Bmm.cat.RSrSQ)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPossible multicollinearity between b_muother_ROTATION90:SHAPETRI and b_muother_ROTATION90 (r = 0.71), b_muangular_ROTATION90:SHAPETRI and b_muangular_ROTATION90 (r = 0.72). This might lead to inappropriate results. See 'Details' in '?rope'.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nParameter                        |       Bmm.cat.R.SrSQ |        Bmm.cat.RSrSQ\n------------------------------------------------------------------------------\nmuother_Intercept                | -2.61 (-3.51, -1.71) | -2.40 (-3.30, -1.49)\nmuangular_Intercept              | -4.18 (-5.23, -3.14) | -4.06 (-5.18, -2.96)\nmutriangular_Intercept           | -3.72 (-4.66, -2.84) | -3.56 (-4.63, -2.57)\nmuother_ROTATION45               |  2.15 ( 1.71,  2.61) |  1.73 ( 1.13,  2.34)\nmuother_ROTATION90               |  1.23 ( 0.83,  1.65) |  0.95 ( 0.38,  1.55)\nmuother_SHAPETRI                 |  0.66 ( 0.32,  1.01) |  0.26 (-0.31,  0.81)\nmuangular_ROTATION45             |  2.99 ( 2.40,  3.60) |  2.73 ( 1.92,  3.59)\nmuangular_ROTATION90             |  1.58 ( 1.02,  2.16) |  1.40 ( 0.57,  2.25)\nmuangular_SHAPETRI               |  0.92 ( 0.45,  1.41) |  0.67 (-0.13,  1.47)\nmutriangular_ROTATION45          |  4.85 ( 3.95,  5.79) |  4.56 ( 3.33,  5.86)\nmutriangular_ROTATION90          |  0.84 (-0.09,  1.76) |  0.66 (-0.61,  1.97)\nmutriangular_SHAPETRI            |  1.49 ( 0.69,  2.28) |  1.18 (-0.02,  2.35)\nmuangular_ROTATION90:SHAPETRI    |                      |  0.34 (-0.75,  1.45)\nmutriangular_ROTATION90:SHAPETRI |                      |  0.39 (-1.30,  2.05)\nmuother_ROTATION45:SHAPETRI      |                      |  0.94 ( 0.05,  1.84)\nmuother_ROTATION90:SHAPETRI      |                      |  0.53 (-0.28,  1.32)\nmutriangular_ROTATION45:SHAPETRI |                      |  0.76 (-0.95,  2.41)\nmuangular_ROTATION45:SHAPETRI    |                      |  0.59 (-0.56,  1.75)\n------------------------------------------------------------------------------\nObservations                     |                 5356 |                 5356\n```\n:::\n:::\n\n**TODO**\n\nTo quantify the effect of working memory capacity on INTERPRETATION, we fit a (bayesian) mixed multinomial regression model with random intercepts for subjects and questions.\n\nA Bayes Factor model comparison (against a random intercepts only model) indicates extreme evidence for the final model including fixed (main) effects of ROTATION, SHAPE (BF = 1.99e+54). A Bayes Factor model comparison (against a model including an interaction term) indicates extreme evidence in favor of the final model including main effects only (BF = 2.10e-24). \n\n(note, the BF may change as it is estimated via simulation each time)\n\n##### Describe\n\n::: {.cell}\n\n```{.r .cell-code}\n# best model\nm <- Bmm.cat.R.SrSQ #main effects model\n\n#::::::::: PRINT MODEL \n\nprint(\"PREDICTOR MODEL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PREDICTOR MODEL\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: categorical \n  Links: muother = logit; muangular = logit; mutriangular = logit \nFormula: state ~ ROTATION + SHAPE + (1 | subject) + (1 | q) \n   Data: df_i (Number of observations: 5356) \n  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;\n         total post-warmup draws = 12000\n\nGroup-Level Effects: \n~q (Number of levels: 13) \n                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nsd(muother_Intercept)          1.50      0.35     0.99     2.32 1.00     3402\nsd(muangular_Intercept)        1.66      0.41     1.05     2.63 1.00     4270\nsd(mutriangular_Intercept)     0.72      0.18     0.45     1.16 1.00     4157\n                           Tail_ESS\nsd(muother_Intercept)          6170\nsd(muangular_Intercept)        6662\nsd(mutriangular_Intercept)     6629\n\n~subject (Number of levels: 412) \n                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nsd(muother_Intercept)          1.39      0.09     1.21     1.58 1.00     4720\nsd(muangular_Intercept)        1.83      0.14     1.57     2.12 1.00     4015\nsd(mutriangular_Intercept)     3.49      0.20     3.12     3.91 1.00     3756\n                           Tail_ESS\nsd(muother_Intercept)          7878\nsd(muangular_Intercept)        7252\nsd(mutriangular_Intercept)     6881\n\nPopulation-Level Effects: \n                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nmuother_Intercept          -2.61      0.45    -3.51    -1.71 1.00     2074\nmuangular_Intercept        -4.18      0.53    -5.23    -3.14 1.00     2924\nmutriangular_Intercept     -3.73      0.46    -4.66    -2.84 1.00     2581\nmuother_ROTATION45          2.15      0.23     1.71     2.61 1.00     6650\nmuother_ROTATION90          1.23      0.21     0.83     1.65 1.00     5407\nmuother_SHAPETRI            0.67      0.18     0.32     1.01 1.00     6596\nmuangular_ROTATION45        2.99      0.31     2.40     3.60 1.00     6161\nmuangular_ROTATION90        1.58      0.29     1.02     2.16 1.00     6286\nmuangular_SHAPETRI          0.93      0.24     0.45     1.41 1.00     6395\nmutriangular_ROTATION45     4.85      0.47     3.95     5.79 1.00     2285\nmutriangular_ROTATION90     0.84      0.48    -0.09     1.76 1.00     2432\nmutriangular_SHAPETRI       1.49      0.40     0.69     2.28 1.00     2012\n                        Tail_ESS\nmuother_Intercept           4022\nmuangular_Intercept         4812\nmutriangular_Intercept      4958\nmuother_ROTATION45          8893\nmuother_ROTATION90          8250\nmuother_SHAPETRI            8720\nmuangular_ROTATION45        8189\nmuangular_ROTATION90        8377\nmuangular_SHAPETRI          8544\nmutriangular_ROTATION45     4547\nmutriangular_ROTATION90     4222\nmutriangular_SHAPETRI       3853\n\nDraws were sampled using sample(hmc). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n\n```{.r .cell-code}\n(d <- describe_posterior(ci=.95, m))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSummary of Posterior Distribution\n\nParameter               | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS\n--------------------------------------------------------------------------------------------------------\nmuother_Intercept       |  -2.61 | [-3.51, -1.71] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2036.00\nmuangular_Intercept     |  -4.18 | [-5.23, -3.14] |   100% | [-0.18, 0.18] |        0% | 1.000 | 2922.00\nmutriangular_Intercept  |  -3.72 | [-4.66, -2.84] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2578.00\nmuother_ROTATION45      |   2.15 | [ 1.71,  2.61] |   100% | [-0.18, 0.18] |        0% | 1.001 | 6637.00\nmuother_ROTATION90      |   1.23 | [ 0.83,  1.65] |   100% | [-0.18, 0.18] |        0% | 1.001 | 5393.00\nmuother_SHAPETRI        |   0.66 | [ 0.32,  1.01] | 99.98% | [-0.18, 0.18] |        0% | 1.000 | 6588.00\nmuangular_ROTATION45    |   2.99 | [ 2.40,  3.60] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6152.00\nmuangular_ROTATION90    |   1.58 | [ 1.02,  2.16] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6263.00\nmuangular_SHAPETRI      |   0.92 | [ 0.45,  1.41] | 99.99% | [-0.18, 0.18] |        0% | 1.000 | 6382.00\nmutriangular_ROTATION45 |   4.85 | [ 3.95,  5.79] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2276.00\nmutriangular_ROTATION90 |   0.84 | [-0.09,  1.76] | 96.17% | [-0.18, 0.18] |     6.10% | 1.002 | 2427.00\nmutriangular_SHAPETRI   |   1.49 | [ 0.69,  2.28] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2000.00\n```\n:::\n\n```{.r .cell-code}\nprint(\"BAYES FACTOR [comparison to RANDOM ONLY model]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"BAYES FACTOR [comparison to RANDOM ONLY model]\"\n```\n:::\n\n```{.r .cell-code}\n#think of this like the anova(model) to get p values for each predictor\n#has to recompile the models with rstan. total drag\n#already calculated bayes factor above, this just interprets it\neffectsize::interpret_bf(exp(bf1$log_BF), include_value = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"no evidence (BF = 1.00) against or in favour of\"\n[2] \"extreme evidence (BF = 2.96e+55) in favour of\"  \n(Rules: jeffreys1961)\n```\n:::\n\n```{.r .cell-code}\nprint(\"DESCRIBE POSTERIOR\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"DESCRIBE POSTERIOR\"\n```\n:::\n\n```{.r .cell-code}\n#:::::::: INTERPRET COEFFICIENTS\n\npaste(\"LOG ODDS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"LOG ODDS\"\n```\n:::\n\n```{.r .cell-code}\n(l <- describe_posterior(m))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSummary of Posterior Distribution\n\nParameter               | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS\n--------------------------------------------------------------------------------------------------------\nmuother_Intercept       |  -2.61 | [-3.51, -1.71] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2036.00\nmuangular_Intercept     |  -4.18 | [-5.23, -3.14] |   100% | [-0.18, 0.18] |        0% | 1.000 | 2922.00\nmutriangular_Intercept  |  -3.72 | [-4.66, -2.84] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2578.00\nmuother_ROTATION45      |   2.15 | [ 1.71,  2.61] |   100% | [-0.18, 0.18] |        0% | 1.001 | 6637.00\nmuother_ROTATION90      |   1.23 | [ 0.83,  1.65] |   100% | [-0.18, 0.18] |        0% | 1.001 | 5393.00\nmuother_SHAPETRI        |   0.66 | [ 0.32,  1.01] | 99.98% | [-0.18, 0.18] |        0% | 1.000 | 6588.00\nmuangular_ROTATION45    |   2.99 | [ 2.40,  3.60] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6152.00\nmuangular_ROTATION90    |   1.58 | [ 1.02,  2.16] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6263.00\nmuangular_SHAPETRI      |   0.92 | [ 0.45,  1.41] | 99.99% | [-0.18, 0.18] |        0% | 1.000 | 6382.00\nmutriangular_ROTATION45 |   4.85 | [ 3.95,  5.79] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2276.00\nmutriangular_ROTATION90 |   0.84 | [-0.09,  1.76] | 96.17% | [-0.18, 0.18] |     6.10% | 1.002 | 2427.00\nmutriangular_SHAPETRI   |   1.49 | [ 0.69,  2.28] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2000.00\n```\n:::\n\n```{.r .cell-code}\n# (tm <- tidy(m,   conf.int = TRUE))\n\npaste(\"ODDS RATIOS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ODDS RATIOS\"\n```\n:::\n\n```{.r .cell-code}\n(e <- model_parameters(m, exponentiate = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nParameter               | Median |          95% CI |     pd | % in ROPE |  Rhat |     ESS\n-----------------------------------------------------------------------------------------\nmuother_Intercept       |   0.07 | [ 0.03,   0.18] |   100% |        0% | 1.003 | 2036.00\nmuangular_Intercept     |   0.02 | [ 0.01,   0.04] |   100% |        0% | 1.000 | 2922.00\nmutriangular_Intercept  |   0.02 | [ 0.01,   0.06] |   100% |        0% | 1.003 | 2578.00\nmuother_ROTATION45      |   8.59 | [ 5.51,  13.54] |   100% |        0% | 1.001 | 6637.00\nmuother_ROTATION90      |   3.43 | [ 2.28,   5.23] |   100% |        0% | 1.001 | 5393.00\nmuother_SHAPETRI        |   1.94 | [ 1.37,   2.75] | 99.98% |        0% | 1.000 | 6588.00\nmuangular_ROTATION45    |  19.84 | [10.99,  36.70] |   100% |        0% | 1.000 | 6152.00\nmuangular_ROTATION90    |   4.88 | [ 2.77,   8.66] |   100% |        0% | 1.000 | 6263.00\nmuangular_SHAPETRI      |   2.52 | [ 1.57,   4.10] | 99.99% |        0% | 1.000 | 6382.00\nmutriangular_ROTATION45 | 127.28 | [51.81, 326.93] |   100% |        0% | 1.002 | 2276.00\nmutriangular_ROTATION90 |   2.33 | [ 0.91,   5.78] | 96.17% |     6.10% | 1.002 | 2427.00\nmutriangular_SHAPETRI   |   4.42 | [ 1.99,   9.77] |   100% |        0% | 1.002 | 2000.00\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nUncertainty intervals (equal-tailed) and p-values (two-tailed) computed\n  using a MCMC distribution approximation.\n```\n:::\n\n```{.r .cell-code}\npaste(\"PROBABILITIES\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"PROBABILITIES\"\n```\n:::\n\n```{.r .cell-code}\n#PREDICT METHOD\nnewdata <- df_i %>% dplyr::select(ROTATION, SHAPE, subject, q)\npreds <- predict(m, newdata = newdata, type = \"response\")\npreds <- cbind(newdata, preds)\n# lengthen data frame to handle multinomial\npreds <- preds %>%\n  dplyr::select(-subject, -q) %>% #marginalize over subject and q\n  pivot_longer(\n  cols = !ROTATION & !SHAPE,\n  values_to = \"preds\",\n  names_to = \"state\",\n)\n\n(p <- preds %>%\n  group_by(ROTATION, SHAPE, state ) %>%\n  summarise(\n    median = median(preds),\n    se = sd(preds)/sqrt(n()),\n    lwr = median - 1.96*se,\n    upr = median + 1.96*se))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 24 × 7\n# Groups:   ROTATION, SHAPE [6]\n   ROTATION SHAPE state             median      se       lwr    upr\n   <fct>    <fct> <chr>              <dbl>   <dbl>     <dbl>  <dbl>\n 1 0        ORTH  P(Y = angular)    0.0160 0.00219  0.0117   0.0202\n 2 0        ORTH  P(Y = orthogonal) 0.783  0.00995  0.763    0.802 \n 3 0        ORTH  P(Y = other)      0.0741 0.00486  0.0646   0.0836\n 4 0        ORTH  P(Y = triangular) 0.0193 0.00997 -0.000204 0.0389\n 5 0        TRI   P(Y = angular)    0.0237 0.00214  0.0195   0.0279\n 6 0        TRI   P(Y = orthogonal) 0.654  0.00976  0.635    0.673 \n 7 0        TRI   P(Y = other)      0.0820 0.00469  0.0729   0.0912\n 8 0        TRI   P(Y = triangular) 0.0383 0.0101   0.0184   0.0581\n 9 45       ORTH  P(Y = angular)    0.0452 0.00455  0.0363   0.0542\n10 45       ORTH  P(Y = orthogonal) 0.113  0.00853  0.0962   0.130 \n# … with 14 more rows\n```\n:::\n\n```{.r .cell-code}\n##DRAWS METHOD\n# GENERATE draws from model\n# draws <- df_i %>%\n#   data_grid(pretty_condition, subject, q) %>% \n#   add_fitted_draws(Bmm.cat.CrSQ,\n#                    # n = 100,\n#                    # dpar = TRUE,\n#                    # transform = TRUE, #gives prob%, otherwise OR\n#                    re_formula = NA)\n# # draws %>% write_rds(file = \"analysis/SGC4C/models/draws/draws_BB.catCrSQ.rds\")\n# \n# #OR load from file\n# # draws <- read_rds(file = \"analysis/SGC4C/models/draws/draws_BB.catCrSQ.rds\")\n# \n# # SUMMARIZE draws from model\n# (k <- kable(draws %>%\n#   dplyr::select(pretty_condition, .category, .value) %>%\n#   group_by(pretty_condition, .category) %>%\n#   median_hdci(.value), digits = 4, col.names =\n#     c(\"Condition\",\"Category\", \"Probability\",\"Lower Cred.I\",\"Upper Cred.I\", \"CI Width\", \"Point Type\", \"Interval Type\")) %>%\n#   kable_styling())\n```\n:::\n\n##### TODO INFERENCE\n\n##### Bayes Factor\n\n-   https://easystats.github.io/bayestestR/articles/bayes_factors.html\n\nCompute bayes factor for model parameters\n\n::: {.cell}\n\n```{.r .cell-code}\n#define null on the log odds scale as the range from -0.4 to 0.4, a 1.5X increase or decrease in odds \n(coef_bf <- bayesfactor(m, null = c(-0.4, 0.4)))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSampling priors, please wait...\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nBayes Factor (Null-Interval)\n\nParameter               |       BF\n----------------------------------\nmuother_Intercept       | 3.27e+03\nmuangular_Intercept     | 3.34e+05\nmutriangular_Intercept  | 1.68e+07\nmuother_ROTATION45      | 3.85e+07\nmuother_ROTATION90      | 1.56e+03\nmuother_SHAPETRI        |     2.04\nmuangular_ROTATION45    | 7.83e+09\nmuangular_ROTATION90    | 1.71e+03\nmuangular_SHAPETRI      |     9.60\nmutriangular_ROTATION45 | 1.65e+10\nmutriangular_ROTATION90 |    0.719\nmutriangular_SHAPETRI   |    40.73\n\n* Evidence Against The Null: [-0.400, 0.400]\n```\n:::\n\n```{.r .cell-code}\n#plot bayes factors\nplot(coef_bf)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#interpretation guidelines\neffectsize::interpret_bf(exp(coef_bf$log_BF), include_value = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"extreme evidence (BF = 3.27e+03) in favour of\" \n [2] \"extreme evidence (BF = 3.34e+05) in favour of\" \n [3] \"extreme evidence (BF = 1.68e+07) in favour of\" \n [4] \"extreme evidence (BF = 3.85e+07) in favour of\" \n [5] \"extreme evidence (BF = 1.56e+03) in favour of\" \n [6] \"anecdotal evidence (BF = 2.04) in favour of\"   \n [7] \"extreme evidence (BF = 7.83e+09) in favour of\" \n [8] \"extreme evidence (BF = 1.71e+03) in favour of\" \n [9] \"moderate evidence (BF = 9.60) in favour of\"    \n[10] \"extreme evidence (BF = 1.65e+10) in favour of\" \n[11] \"anecdotal evidence (BF = 1/1.39) against\"      \n[12] \"very strong evidence (BF = 40.73) in favour of\"\n(Rules: jeffreys1961)\n```\n:::\n:::\n\n**TODO**\n\nThe model predicts similar probabilities for orthogonal, other, and angular interpretations by high vs. low working memory participants. It is only the (correct) triangular interpretation in which we have evidence for a reliable interaction between OSPAN and CONDITION.\n\nIt is only the (correct) triangular interpretation in which we have moderate evidence for a reliable interaction between OSPAN and CONDITION (\\$e\\^{\\beta\\_{interaction}} = 15.73,   95 %  CI   \\[0.89, 249.91\\],  pd = 97.3%, BF = 3.86 \\$)\n\nMuch like the pattern of results for accuracy, it is high working memory participants with higher probability of triangular responses, but only in impasse condition.\n\n##### Interactions\n\n::: {.cell}\n\n```{.r .cell-code}\n#EMMEANS doesn't support multinomial brms models. BUMMER\n#BUT brms has some built in stuffs. \n\n# FOR MAIN EFFECTS PLOTS \nprint(\"MAIN EFFECTS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"MAIN EFFECTS\"\n```\n:::\n\n```{.r .cell-code}\nconditional_effects(m, categorical = TRUE)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-28-2.png){width=672}\n:::\n\n```{.r .cell-code}\nprint(\"INTERACTION PLOT\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"INTERACTION PLOT\"\n```\n:::\n\n```{.r .cell-code}\nconditions <- make_conditions(m, vars = c(\"SHAPE\"))\nconditional_effects(m, \"ROTATION\", conditions = conditions,\n                    categorical = TRUE)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-28-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# print(\"INTERACTION PLOT\")\n# plot_model(m, type=\"int\")\n\n## MARGINAL EFFECTS\n\n# from easystats \n# library(modelbased)\n# uses emmeans, doesn't support brms categorical \n# estimate_contrasts(m, test = \"bf\", bf_prior = m)\n\n# library(marginaleffects)\n# https://vincentarelbundock.github.io/marginaleffects/articles/brms.html\n## takes a really long time... maybe hangs machine??\n# (mfx <- marginaleffects::marginaleffects(m))\n# summary(mfx)\n```\n:::\n\n##### Print\n\n::: {.cell}\n\n```{.r .cell-code}\n#SJPLOT | MODEL | TABLE\n# tab_model(m)\n\n# #MODEL SUMMARY | save latex table\n#model summary doesn't work for brms multinomial\n\n# DOESN'T WORK FOR BRMS\n# extract_eq(m, use_coefs = TRUE, wrap = TRUE)\n# \n# \n# #GET MODEL ESTIMATES\n# t <- as.data.frame(model_parameters(m, exponentiate = TRUE))\n# # \n# # #REFORMAT\n# x <- t %>%\n#   mutate(\n#     Parameter = str_remove_all(Parameter,\"_pretty\"),\n#     Parameter = str_remove_all(Parameter,\"b_mu\"),\n#     Interpretation = word(Parameter, 1, sep = \"_\"),\n#     Interpretation = fct_relevel(Interpretation, levels = c(\"other\",\"angular\",\"triangular\")),\n#     Factor = word(Parameter, 2, sep = \"_\"),\n#     Factor = recode_factor(Factor,\n#                          \"Intercept\" = \"(Intercept)\",\n#                          \"conditionimpasse\" = \"Condition[impasse]\",\n#                          \"ospan\" = \"OSPAN[high-memory]\",\n#                          \"conditionimpasse:ospan\" = \"Condition:OSPAN\"),\n#     Median = round(Median,2),\n#     CI_low = round(CI_low,2),\n#     CI_high = round(CI_high,2),\n#     pd = round(pd,2),\n#     ROPE_Percentage = round(ROPE_Percentage,2)) %>%\n#   arrange(Interpretation) %>%\n#   dplyr::select(-CI, -Rhat, -ESS) %>%\n#   rename( \"%_in_ROPE\"=\"ROPE_Percentage\",\n#   \"(Odds Ratio)\" = \"Median\") %>%\n#   dplyr::select(Interpretation, Factor, `(Odds Ratio)`, CI_low, CI_high, pd, `%_in_ROPE`)\n# \n# # #KNIT\n# title = \"Study 3C (OSPAN) | Question Interpretation | Mixed Multinomial Regression\"\n# tab <- kbl(x, format = \"latex\", caption = title,\n#            booktabs = FALSE) %>% kable_classic() %>%\n# footnote(general = paste(\"Model Interpretation ~ \",b$Model[2], \"Bayes Factor \", format( exp(b$log_BF[2]), digits =2 ) ), footnote_as_chunk = T, general_title = \"\")\n# writeLines(tab, \"tables/SGC3C_OSPAN_BRMS_state.tex\")\n```\n:::\n\n##### Visualize\n\n::: {.cell}\n\n```{.r .cell-code}\n## PLOT INTERACTION\nlibrary(ggeffects)\nggpredict(m, terms = c(\"ROTATION\",\"SHAPE\")) %>% \n  plot(connect.lines = TRUE) + \n  scale_color_manual(values = fct_rev(paletteer::paletteer_d(\"nbapalettes::bulls\")))+\n  # scale_color_manual(values = paletteer::paletteer_d(\"awtools::gpalette\",3))+\n  # scale_color_manual(values = paletteer::paletteer_d(\"lisa::FridaKahlo\", 3))+\n  # scale_colour_manual(values = paletteer::paletteer_c(\"viridis::viridis\", 2)) + \n  theme_clean() + labs(\n  title = \"MODEL | Predicted probability of correct response\",\n  x = \"Condition\"\n) + theme(legend.position=\"bottom\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: uncertainty of error terms are not taken into account. You may want to use `rstantools::posterior_predict()`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nScale for 'colour' is already present. Adding another scale for 'colour',\nwhich will replace the existing scale.\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## | PLOT PARAMETERS \n\n#SJPLOT | MODEL | ODDS RATIO\n# plot_model(m, vline.color = \"red\", \n#            show.intercept = TRUE, \n#            show.values = TRUE,\n#            p.threshold = 0.1, #manually adjust to account for directional test\n#            ci.lvl = 0.90 ) + #manually adjusted for directional test   \n#   labs(title = \"Model Estimate | Odds Ratio\",\n#        subtitle = \"\",\n#        x = \"Condition\")\n\n\n#EASYSTATS | MODEL | ODDS RATIO\nresult <- model_parameters(m, exponentiate = TRUE, component = \"all\")\nplot(result, show_intercept = TRUE, show_labels = TRUE) \n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/VIS-BRMS-STATE-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# + theme_clean()\n\n## | PLOT TESTS\n\nresult <- equivalence_test(m, rule = \"classic\", ci=0.9) #classic[tost], , bayes\nplot(result)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.0392\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 14400 rows containing non-finite values (stat_density_ridges).\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/VIS-BRMS-STATE-2.png){width=672}\n:::\n\n```{.r .cell-code}\nresult <- rope(m)\nplot(result)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/VIS-BRMS-STATE-3.png){width=672}\n:::\n\n```{.r .cell-code}\n##TODO see documentation for removing, reorganizing parameters\nresult <- pd(m, effects = \"fixed\", component = \"all\")\nplot(result, show_intercept = FALSE,\n     n_columns = 3)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/VIS-BRMS-STATE-4.png){width=672}\n:::\n\n```{.r .cell-code}\n## | PLOT PREDICTIONS\n\n#SJPLOT | MODEL | PROBABILITIES\n# plot_model(m, type=\"int\",\n#            show.intercept = TRUE,\n#            show.values = TRUE,\n#            title = \"Model Prediction | Probability of Accurate Response\",\n#            axis.title = c(\"Condition\",\"Probability of Accurate Response\"))\n\n#PLOT MODEL PREDICTION\n# plot_model(m, type = \"pred\")  \n# plot_model(m, type = \"eff\")  \n  # ylim(0,1) + \n  # labs(\n  #   title = \"Model Prediction | Probability of Accurate Response\",\n  #   subtitle = \"Impasse increases Probability of Correct Response\"\n  # )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#::::: GGDIST POSTERIOR PROBABILITY OF RESPONSE\n##WORKING\n# https://mjskay.github.io/ggdist/reference/stat_slab.html\n## VIS probability of correct response\n#TAKES A REALLY LONG TIME\n\n#1 | get draws\n# draws <- df_i %>%\n#   data_grid(pretty_condition, ospan_split, subject, q) %>%\n#   add_epred_draws(m,\n#                    # ndraws = 100, # n = 100,\n#                    # dpar = TRUE,\n#                    transform = TRUE, #gives prob%, otherwise OR\n#                    re_formula = NA)\n\n\n# draws %>% write_rds(file = \"analysis/SGC4C/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds\")\n\n#OR load from file\n# draws <- read_rds(file = \"analysis/SGC4C/models/draws/draws_Bmm.catCOrSQ_OPSAN.rds\")\n\n#2| VISUALIZE PREDICTIONS | GGDIST\n##TODO figure out height normalization.\n##do it with much smaller number of draws \n#TODO adjust bandwidth/smoothing? + put on same line + \n#TAKES A REAAALY LONG TIME\n# d <- \n\n# d <- draws %>% sample_n(10) %>% \n#   ggplot(aes(x = .epred,  y = pretty_condition, fill = ospan_split)) +\n#   stat_slab(width = c(.95), alpha = 0.5, normalize=\"xy\") +\n#   facet_wrap(~.category) +\n#   #   #normalize = all, panels, xy, groups, none\n#   xlim(0,1) + labs(\n#     title = \"Model Predicted Probability of Correct Response\",\n#     x = \"probability of correct response\",\n#     y = \"Interpretation\"\n#   ) +  theme_clean() #+ ggeasy::easy_remove_legend() + ggeasy::easy_remove_y_axis()\n# # #TO PLOT ON THE SAME LINE, INCLUDE Y = 0 in aes and ggeasy::remove_y_axis()\n# # \n# # ggsave(d, filename = \"figures/sgc4c_BBm.cat.CrSQ_lab_posterior.svg\", width = 6, height =4)\nd\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSummary of Posterior Distribution\n\nParameter               | Median |         95% CI |     pd |          ROPE | % in ROPE |  Rhat |     ESS\n--------------------------------------------------------------------------------------------------------\nmuother_Intercept       |  -2.61 | [-3.51, -1.71] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2036.00\nmuangular_Intercept     |  -4.18 | [-5.23, -3.14] |   100% | [-0.18, 0.18] |        0% | 1.000 | 2922.00\nmutriangular_Intercept  |  -3.72 | [-4.66, -2.84] |   100% | [-0.18, 0.18] |        0% | 1.003 | 2578.00\nmuother_ROTATION45      |   2.15 | [ 1.71,  2.61] |   100% | [-0.18, 0.18] |        0% | 1.001 | 6637.00\nmuother_ROTATION90      |   1.23 | [ 0.83,  1.65] |   100% | [-0.18, 0.18] |        0% | 1.001 | 5393.00\nmuother_SHAPETRI        |   0.66 | [ 0.32,  1.01] | 99.98% | [-0.18, 0.18] |        0% | 1.000 | 6588.00\nmuangular_ROTATION45    |   2.99 | [ 2.40,  3.60] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6152.00\nmuangular_ROTATION90    |   1.58 | [ 1.02,  2.16] |   100% | [-0.18, 0.18] |        0% | 1.000 | 6263.00\nmuangular_SHAPETRI      |   0.92 | [ 0.45,  1.41] | 99.99% | [-0.18, 0.18] |        0% | 1.000 | 6382.00\nmutriangular_ROTATION45 |   4.85 | [ 3.95,  5.79] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2276.00\nmutriangular_ROTATION90 |   0.84 | [-0.09,  1.76] | 96.17% | [-0.18, 0.18] |     6.10% | 1.002 | 2427.00\nmutriangular_SHAPETRI   |   1.49 | [ 0.69,  2.28] |   100% | [-0.18, 0.18] |        0% | 1.002 | 2000.00\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n###VISUALIZE\n#make predictions\npred <- predictions(m)\n\n#get draws\ndraws <- posteriordraws(pred)\n\n#plot draws\n\n##PLOT ANGULAR\nggplot(draws %>% sample_n(1000), aes(x = draw, fill = group)) +\n    geom_density(alpha = 0.8, color = \"white\", trim = TRUE) +\n    facet_grid(SHAPE ~ ROTATION) +\n    labs(x = \"Predicted probability\",\n         y = \"Density\",\n         fill = \"INTERPRETATION\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n\n```{.r .cell-code}\n## AS DENSITY RIDGES\nggplot(draws %>% sample(100000), aes(x = draw, y = ROTATION, fill = SHAPE)) +\n    geom_density_ridges(alpha = 0.5, rel_min_height = 0.01) +\n    facet_grid(group ~ .) +\n    labs(x = \"Predicted probability\",\n         y = \"Density\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.0136\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.0448\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.0296\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.0451\n```\n:::\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-33-2.png){width=672}\n:::\n:::\n\n##### Diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\n#CHECK Fit of posterior predictive to data\npp_check(m, ndraws=1000)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#CHECK posterior vs. priors\nresult <- estimate_density(m)\nplot(result, stack = FALSE, priors= TRUE)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#CHECK model\nplot(m)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-34-6.png){width=672}\n:::\n:::\n\n## CUMULATIVE PROGRESS\n\n::: {.cell}\n\n```{.r .cell-code}\n#SETUP\ndf_scaled <- read_csv('analysis/SGC4C/data/2-scored-data/sgc4c_scaled_progress.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 5356 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): subject, mode, pretty_condition, SHAPE\ndbl (3): question, score, ROTATION\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ndf_absolute <- read_csv('analysis/SGC4C/data/2-scored-data/sgc4c_absolute_progress.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 5356 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): subject, mode, pretty_condition, SHAPE\ndbl (3): question, score, ROTATION\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n### Visualize Progress over Task\n\n::: {.cell}\n\n```{.r .cell-code}\n#VISUALIZE progress over time SCALED score \nggplot(data = df_scaled, aes(x = question, y = score, group = subject, alpha = 0.01, color = pretty_condition)) + \n geom_line(position=position_jitter(w=0.10, h=0.0), size=0.25) +\n # geom_line( size=1) +\n facet_wrap(SHAPE ~ ROTATION) + \n labs (title = \"Cumulative Scaled Score over sequence of task\", x = \"Question\" , y = \"Cumulative Scaled Score\") + \n scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12,13)) +\n # scale_y_continuous(lim=c(-13,13))+\n theme_minimal() + theme(legend.position = \"blank\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#VISUALIZE progress over time SCALED score \nggplot(data = df_absolute, aes(x = question, y = score, group = subject, alpha = 0.1, color = pretty_condition)) + \n # geom_line(position=position_jitter(w=0.15, h=0.15), size=0.5) +\n geom_line(position=position_jitter(w=0.15, h=0.15), size=0.25) +\n # geom_line( size=1) +\n facet_wrap(SHAPE ~ ROTATION) + \n labs (title = \"Cumulative Scaled Score over sequence of task\", x = \"Question\" , y = \"Cumulative Scaled Score\") + \n scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12,13)) +\n # scale_y_continuous(lim=c(0,13))+\n theme_minimal() + theme(legend.position = \"blank\")\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-36-2.png){width=672}\n:::\n:::\n\n\n## EXPLORE specific question (e.g. Q 10)\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df_items %>% filter(q==10)\n\ngrouped_ggbarstats( data = df, x = accuracy, y = SHAPE, grouping.var = ROTATION)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n\n```{.r .cell-code}\ngrouped_ggbarstats( data = df, x = state, y = SHAPE, grouping.var = ROTATION)\n```\n\n::: {.cell-output-display}\n![](4_sgc4C_hypotesting_files/figure-html/unnamed-chunk-37-2.png){width=672}\n:::\n:::",
    "supporting": [
      "4_sgc4C_hypotesting_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}